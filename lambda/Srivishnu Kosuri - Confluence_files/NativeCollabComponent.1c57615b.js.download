function e(e){return e&&e.__esModule?e.default:e}var t=globalThis.parcelRequired477,r=t.register;r("dYcT6",function(r,a){var s=t("42omo"),n=t("601vk");let o=e(s).createContext({showEditorFlag:()=>{}}),i=({contentId:t,children:r})=>{let[a,i]=(0,s.useState)(void 0),l=(0,s.useCallback)(e=>{i(e)},[i]),c=(0,s.useMemo)(()=>a?.errorName?{[a.errorName]:!0}:void 0,[a]),u=(0,s.useMemo)(()=>({showEditorFlag:l}),[l]);return e(s).createElement(o.Provider,{value:u},r,e(s).createElement(n.EditorErrorFlags,{contentId:t,statusCode:a?.statusCode,errorData:c,lastPublisher:a?.lastPublisher,collabService:a?.collabService,isUnpublishedDraft:a?.isUnpublishedDraft}))};r.exports.withEditorFlagsContext=function(t){return r=>e(s).createElement(i,{contentId:r.contentId},e(s).createElement(t,r))},r.exports.useEditorFlagsContext=()=>e(s).useContext(o)}),r("601vk",function(r,a){var s=t("42omo"),n=t("j1Ss3"),o=t("kyKWe"),i=t("b3j2Y");let l=(0,t("gmMgo").default)(({flags:r,nextTryIn:a,statusCode:l,flagData:c,errorData:u,intl:{formatMessage:d},lastPublisher:p,parentPageId:g,collabService:f,isUnpublishedDraft:E})=>{let[{contentSlug:h,contentId:b,spaceKey:m,contentType:y}]=(0,t("ep3mz").usePageState)(),S=(0,t("3jwuS").useIsCurrentPageLive)(),{createAnalyticsEvent:v}=(0,t("inPa6").useAnalyticsEvents)(),{triggerPageConflictAnalytics:I}=(0,t("gQojb").usePageConflictAnalytics)({contentId:b,contentType:y,collabService:f,source:"EditorFlags",actionSubjectId:"editor.flag"}),T=(0,n.useQuery)((0,t("eSUdr").default)`query EditorFlagsUserPersonalInformationQuery($accountId:ID!){user:confluence_atlassianUser(id:$accountId){id displayName}}`,{variables:{accountId:p||""},skip:!p||!u||!u[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_PUBLISH]&&!u[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_RESTORE]}),_=!!g||!b||!u||!u[t("1mHQU").ALLOWED_FLAG_MESSAGES.PARENT_NOT_PUBLISHED],P=(0,n.useQuery)((0,t("eSUdr").default)`query EditorFlagsContentAncestorsQuery($contentId:ID!){content(id:$contentId status:["current" "draft"]){nodes{id ancestors{id}}}}`,{variables:{contentId:b},skip:_}),[C,w]=(0,s.useState)(g);(0,s.useEffect)(()=>{_||P.loading||w(P.data?.content?.nodes?.[0]?.ancestors?.slice(-1)[0]?.id||g||"")},[g,P,_]),(0,s.useEffect)(()=>()=>void r.hideAllFlags(),[r]),(0,s.useEffect)(()=>{if(!(u?.[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_PUBLISH]||u?.[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_RESTORE]||u?.[t("1mHQU").ALLOWED_FLAG_MESSAGES.PARENT_NOT_PUBLISHED]&&void 0===C)&&!c){let n=(0,t("cHfGW").buildEditorFlagMessage)({errorData:u,spaceKey:m,statusCode:l,formatMessage:d,nextTryIn:a,parentPageId:C,isUnpublishedDraft:E,isLivePage:S});if(n){let i=e(o)();r.showErrorFlag({id:i,title:n.title,description:e(s).createElement(t("03Xmw").FlagDescription,{flags:r,flagContent:n,flagId:i,nextTryIn:a})}),409===l&&I(Object.keys(u??{}).filter(e=>e.startsWith("com.atlassian.confluence.api.service.exceptions.ecosystem.ConflictException")),{})}else r.hideAllFlags()}},[E,r,c,a,m,l,u,p,C,b,d,I,S]);let x=(0,s.useCallback)(()=>(0,t("fb79u").initializeInfoFlag)(r,d,{contentType:y,spaceKey:m,contentId:b,contentSlug:h},S),[d]);(0,s.useEffect)(()=>{u&&(u[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_PUBLISH]||u[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_RESTORE])&&x()(T,{...u})},[T,u,x]);let O=(0,s.useCallback)(()=>{(0,t("6jB9o").initializeSuccessFlag)(r,d,{attributes:{contentType:y,spaceKey:m,contentId:b,contentSlug:h},flagData:c},v)},[d]);return(0,s.useEffect)(()=>{c&&O()},[c,O]),P?.error?e(s).createElement(i.ErrorDisplay,{error:P.error}):null}),c=(0,t("7aRa9").withFlags)(l);r.exports.EditorFlags=l,r.exports.EditorErrorFlags=c}),r("03Xmw",function(r,a){var s=t("42omo");r.exports.FlagDescription=({flagContent:t,nextTryIn:r,flagId:a,flags:n})=>{let[o,i]=(0,s.useState)(r?Math.max(Math.round(r/1e3),0):0),l="function"==typeof t.description?t.description(o):t.description;return(0,s.useEffect)(()=>{if(r){let e=setInterval(()=>i(e=>e-1),1e3);return()=>clearInterval(e)}},[r]),r&&o<0&&n.hideFlag(a),e(s).createElement("div",{"data-testid":"flag-description"},l,t.details&&e(s).createElement("div",{"data-testid":"flag-details"},t.details))}}),r("fb79u",function(r,a){var s=t("42omo");let n={publishTitle:{id:"editor-flags.publish-page.title",defaultMessage:"New version published",description:"Title for flag that appears when a new version of the page is published"},publishMessage:{id:"editor-flags.publish-page.known.user.message",defaultMessage:"{user} just published a new version of this page, which includes the changes you’ve made so far",description:"Message for flag that appears when a new version of the page is published"},restoreTitle:{id:"editor-flags.restore-page.title",defaultMessage:"Previous version restored",description:"Title for flag that appears when another user restores a previous version of the page"},restoreOtherMessage:{id:"editor-flags.restore-page.known.user.message",defaultMessage:"{user} just restored a prior version of this {contentType}. Recent changes may have been lost. Check the <alink>page history</alink> for details.",description:"Message for flag that apprears when another user restores a previous version of the page"},unknownUser:{id:"editor-flags.publish-page.known.user.name",defaultMessage:"Another user",description:"Alternate name when the user responsible for publish is not known"},anonymousUser:{id:"editor-flags.publish-page.anonymous.user.name",defaultMessage:"An anonymous user",description:"Alternate name when anonymous user is responsible for publish"},reloadButton:{id:"editor-flags.publish-page.actions.reload",description:"Button label for button that causes a page reload",defaultMessage:"Reload"}},o=()=>window.location.reload(),i=(t,r,a)=>{t.showCustomFlag({title:r(n.publishTitle),description:r(n.publishMessage,{user:a}),actions:[{content:e(s).createElement("div",{"data-testid":"quick-reload-reload-button"},r(n.reloadButton)),onClick:o}]})},l=(e,t)=>{let r,a=t?.data?.user?.displayName;return t.error?e(n.unknownUser):a||e(n.anonymousUser)},c=(e,t,r,a)=>{r?i(e,t,a):e.showInfoFlag({title:t(n.publishTitle),description:t(n.publishMessage,{user:a})})};r.exports.initializeInfoFlag=(e,r,a,s=!1)=>(o,i)=>{if(!o.loading){let u=l(r,o);if(i[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_PUBLISH])return void c(e,r,s,u);i[t("1mHQU").ALLOWED_FLAG_MESSAGES.OTHER_RESTORE]&&e.showInfoFlag({title:r(n.restoreTitle),description:r(n.restoreOtherMessage,{user:u,alink:(0,t("4iY7F").getPageHistoryLink)(a),contentType:a.contentType??"page"})})}return null}}),r("4iY7F",function(r,a){var s=t("42omo");r.exports.getPageHistoryLink=r=>{let{spaceKey:a,contentId:n,contentSlug:o}=r;return(...r)=>(0,t("9wGTI").fg)("dst-a11y__replace-anchor-with-link__page-experienc")?e(s).createElement(t("2Nwuj").default,{target:"_blank",href:t("1NBp8").CONTENT_HISTORY.toUrl({spaceKey:a,contentId:n,contentSlug:o})},r):e(s).createElement("a",{target:"_blank",href:t("1NBp8").CONTENT_HISTORY.toUrl({spaceKey:a,contentId:n,contentSlug:o})},r)}}),r("6jB9o",function(r,a){var s=t("42omo");let n={blogifySuccessTitle:{id:"editor-flags.blogify.blogpost.success.title",defaultMessage:"Page converted to a blog post",description:"The title of the flag shown in the editor when someone convert a page to blogpost"},blogifySuccessMessage:{id:"editor-flags.blogify.blogpost.success.message",defaultMessage:"{displayName} just converted this page to a <alink>blog post</alink>, which includes the changes you’ve made so far.",description:"The body of the flag shown in the editor when someone convert a page to blogpost"},restoreTitle:{id:"editor-flags.restore-page.title",defaultMessage:"Previous version restored",description:"Title for flag that appears when another user restores a previous version of the page"},restoreMessage:{id:"editor-flags.restore.page.success.message",defaultMessage:"Recent changes may have been overwritten. Check the <alink>page history</alink> for details.",description:"The body of the flag shown in the editor when someone revert the page/blogpost to previous version in page history"},extensionCreateTitle:{id:"editor-flags.extension-create.title",defaultMessage:"New draft created",description:"Title for flag that appears when a draft is created by the /create Confluence page extension from another page"},extensionCreateMessage:{id:"editor-flags.extension-create.message",defaultMessage:"There’s now a link to this draft on <alink>{parentPage}</alink>. All of your changes have been saved.",description:"The body of the flag shown in the editor when a draft is created by the /create Confluence page extension from another page"},extensionCreateParentPage:{id:"editor-flags.extension-create.parent-page",defaultMessage:"the previous page",description:"Placeholder text for {parentPage} in `editor-flags.extension-create.message` when the parent page does not have a title"}};r.exports.initializeSuccessFlag=(r,a,{attributes:o,flagData:i},l)=>{let{contentType:c,spaceKey:u,contentId:d}=o;if(i){if(i[t("1mHQU").ALLOWED_FLAG_MESSAGES.RESTORE_CONTENT_SUCCESS])r.showFlag({type:"success-circle",title:a(n.restoreTitle),description:e(s).createElement(t("gtD4K").default,{...n.restoreMessage,values:{contentType:c,alink:(0,t("4iY7F").getPageHistoryLink)(o)}}),messageType:"transactional",messageId:"editor-flags-version-restore-success"});else if(i[t("1mHQU").ALLOWED_FLAG_MESSAGES.BLOGIFY_BLOGPOST_SUCCESS]){let o=i?.converterDisplayName;r.showFlag({type:"success-circle",title:a(n.blogifySuccessTitle),description:e(s).createElement(t("gtD4K").default,{...n.blogifySuccessMessage,values:{displayName:o||a({id:"editor.page.moved.message.unknown.mover"}),alink:(...r)=>(0,t("9wGTI").fg)("dst-a11y__replace-anchor-with-link__page-experienc")?e(s).createElement(t("2Nwuj").default,{target:"_blank",href:t("1NBp8").EDIT_BLOG_V2.toUrl({spaceKey:u,contentId:d,contentType:"blog"},{query:{draftShareId:(0,t("7PLO8").getDraftShareIdFromQueryParam)()}})},r):e(s).createElement("a",{target:"_blank",href:t("1NBp8").EDIT_BLOG_V2.toUrl({spaceKey:u,contentId:d,contentType:"blog"},{query:{draftShareId:(0,t("7PLO8").getDraftShareIdFromQueryParam)()}})},r)}}),messageType:"transactional",messageId:"editor-flags-blogify-success"})}else if(i[t("1mHQU").ALLOWED_FLAG_MESSAGES.CREATED_FROM_EXTENSION]){let{parentContentId:o,parentTitle:p}=i,g=t("1NBp8").EDIT_PAGE_V2.toUrl({contentType:"pages",spaceKey:u,contentId:o}),f=e=>{e.preventDefault();let t=window.open("",o);t?.focus(),t&&!t.location.host&&t.location.assign(g),l&&l({type:"sendUIEvent",data:{action:"clicked",actionSubject:"parentPageLink",actionSubjectId:"inlineCreateOneStepExperiment",source:"SuccessFlag",attributes:{contentId:d,contentType:c,parentContentId:o}}}).fire()};r.showFlag({type:"success-circle",title:a(n.extensionCreateTitle),description:e(s).createElement(t("gtD4K").default,{...n.extensionCreateMessage,values:{parentPage:p||a(n.extensionCreateParentPage),alink:(...r)=>(0,t("9wGTI").fg)("dst-a11y__replace-anchor-with-link__page-experienc")?e(s).createElement(t("2Nwuj").default,{href:g,target:o,onClick:f},r):e(s).createElement("a",{href:g,target:o,onClick:f},r)}}),messageType:"transactional",messageId:"editor-flags-create-from-extension-success"})}}},r.exports.getParentContentId=()=>{let e=new URLSearchParams(window.location.search),t=e.get("createdFrom");if(t){e.delete("createdFrom");let r=e.size>0?`?${e.toString()}`:"";if(window.history.pushState({},"",`${window.location.pathname}${r}`),/^\d+$/.test(t)&&document.referrer)return t}return null}}),r("gQojb",function(e,r){var a=t("42omo");let s=(e,t,r,a)=>{a&&a({type:"sendTrackEvent",data:{source:e,action:"error",actionSubject:"pageConflict",actionSubjectId:t,attributes:r}}).fire()};e.exports.usePageConflictAnalytics=({source:e,actionSubjectId:r,contentId:n,contentType:o,collabService:i,version:l})=>{let{createAnalyticsEvent:c}=(0,t("inPa6").useAnalyticsEvents)();return{triggerPageConflictAnalytics:(0,a.useCallback)((t,a={})=>{s(e,r,{contentId:n,contentType:o,collabService:i,version:l,errorMessage:t,...a},c)},[c,e,r,n,o,i,l])}}}),r("5MyXJ",function(e,r){var a=t("42omo");class s extends Error{constructor(e,t){super(e),this.message=e,this.reason=t,this.reason=t}}let n=e=>e?.reason==="unauthorised"||e?.reason==="UNAUTHORIZED";e.exports.isPermissionError=n,e.exports.useEditorHeartbeat=({contentId:e,contentType:r,collabEditInitialized:o,viewMode:i})=>{let{createAnalyticsEvent:l}=(0,t("inPa6").useAnalyticsEvents)(),{userId:c}=(0,t("bQm3c").useSessionData)(),u=(0,a.useRef)(null),d=(0,a.useRef)(null),[p,g]=(0,a.useState)(!1),[f,E]=(0,a.useState)(void 0),h=(0,a.useRef)(void 0!==i?i:null),b=(0,a.useRef)(!1),[m,y]=(0,a.useState)(null),S=(0,t("3jwuS").useIsCurrentPageLive)(),[v,I]=(0,a.useState)(!1),[T,_]=(0,a.useState)(!1),[P,C]=(0,a.useState)(!1),[w,x]=(0,a.useState)(),O=t("4VJDS").default.getNumber("confluence_frontend_collab_ncs_max_participants",12),R=t("4VJDS").default.getString("confluence_frontend_collab_live_pages_limits",""),{viewLimit:L,editLimit:M}=(0,a.useMemo)(()=>{let e={editLimit:12,viewLimit:100};if("string"==typeof R)try{let t=JSON.parse(R);if(!("viewLimit"in t)||!("editLimit"in t))return e;return t}catch{}return e},[R]);S&&(O=M);let[A]=(0,t("loOZe").useExperimentalEditorStartHeartbeatMutation)({variables:{contentId:e,contentType:r,collabService:"ncs",heartbeatUserType:i?t("8MyKT").ExperimentalHeartbeatUserType.VIEW:t("8MyKT").ExperimentalHeartbeatUserType.EDIT}}),[k]=(0,t("9y3bP").useExperimentalEditorStopHeartbeatMutation)({variables:{contentId:e,contentType:r,heartbeatUserType:i?t("jKP0k").ExperimentalHeartbeatUserType.VIEW:t("jKP0k").ExperimentalHeartbeatUserType.EDIT}}),U=(0,a.useCallback)((t,a)=>{l({type:"sendOperationalEvent",data:{action:"error",actionSubject:"heartbeat",source:"useEditorHeartbeat",objectId:e,objectType:r,attributes:{error:{reason:t instanceof s?t.reason:"Error",message:t.message},activeUsersSize:a?.experimentalEditorStartHeartbeat?.orderedUsers?.length}}}).fire(),x(t)},[e,r,l]),D=(0,a.useCallback)(()=>{u?.current&&clearInterval(u.current),k().catch(e=>{U(e)})},[k,U]),H=(0,a.useCallback)(e=>{E(e),g(S&&"live"!==e||!S&&null!==e)},[S,E,g]),F=(0,a.useCallback)(()=>{A().then(e=>{let{data:r}=e;if(b.current&&(b.current=!1),!r||!r.experimentalEditorStartHeartbeat)return void U(new s("Missing response data",!r?"No data":"No heartbeat data"));let{error:a,message:o,orderedUsers:i,editorSessionId:l,subtype:c}=r.experimentalEditorStartHeartbeat;if(d.current=l,(0,t("9wGTI").fg)("confluence_ncs_disconnect_idle_tabs_pubsub")&&H(c),a){let e=new s(o??"Heartbeat failed",a);if(S&&n(e))return;U(e,r)}i&&y(i)}).catch(e=>{U(e)})},[A,U,S,H]);return(0,a.useEffect)(()=>{if(!m||b.current)return;let e=({activeUsers:e,limit:t})=>{if(e.length<t)return!1;let r=!!c&&e.slice(0,t).includes(c);return!c&&e.length>t||!!c&&!r},r=m.filter(e=>e.heartbeatUserType===t("8MyKT").ExperimentalHeartbeatUserType.EDIT).map(e=>e.accountId)??[],a=e({activeUsers:r,limit:O});if(!S)return void I(a);let s=r.slice(0,O),n=e({activeUsers:m.filter(e=>!s.includes(e.accountId)).map(e=>e.accountId)??[],limit:L});a&&!(h.current||n)?_(!0):_(!1),n&&(h.current||a)?C(!0):C(!1)},[m,O,c,S,L]),(0,a.useEffect)(()=>{void 0!==i&&i!==h.current&&(b.current=!0,F(),h.current=i)},[i,F]),(0,a.useEffect)(()=>{if(o)return F(),u.current=setInterval(F,6e4),()=>D()},[o,e,r]),{collabLimitReached:v,liveEditLimitReached:T,liveViewLimitReached:P,heartbeatError:w,stopHeartbeatCallback:D,editorSessionId:d.current,subtypeMismatch:p,heartbeatSubtype:f}}}),r("8MyKT",function(e,t){var r,a=((r={}).EDIT="EDIT",r.VIEW="VIEW",r);e.exports.ExperimentalHeartbeatUserType=a}),r("jKP0k",function(e,t){var r,a=((r={}).EDIT="EDIT",r.VIEW="VIEW",r);e.exports.ExperimentalHeartbeatUserType=a}),r("loOZe",function(e,r){e.exports.useExperimentalEditorStartHeartbeatMutation=({variables:e})=>(0,t("9o40q").useExperimentalMutation)({url:"/wiki/api/v2/editor/heartbeat/start",method:"POST",headers:{"Content-Type":t("aBfpe").MediaType.JSON,Accept:t("aBfpe").MediaType.JSON},variables:e,body:({contentId:e,contentType:t,collabService:r,heartbeatUserType:a})=>JSON.stringify({dataType:"json",contentId:e,draftType:t??"",collabService:r,editorVersion:"v2",heartbeatUserType:a}),parseResponseOnError:async e=>{let r,a;if(e instanceof t("hBkCm").BadStatusError)try{let t=await e.response.json();t?.errorMessage==="Site temporarily unavailable"?(r="tenant-unavailable",a="Site temporarily unavailable"):(r=t?.errors[0].code,a=t?.errors[0].title)}catch{r=e.response.statusText,a=e.message}else r=e.name,a=e.message;return{orderedUsers:null,editorSessionId:null,error:r,message:a,subtype:null}},parseResult:({orderedUsers:e,editorSessionId:t,subtype:r,error:a,message:s})=>({experimentalEditorStartHeartbeat:{orderedUsers:e,editorSessionId:t,error:a,message:s,subtype:r}})})}),r("9y3bP",function(e,r){e.exports.useExperimentalEditorStopHeartbeatMutation=({variables:e})=>(0,t("9o40q").useExperimentalMutation)({url:"/wiki/api/v2/editor/heartbeat/stop",method:"POST",variables:e,headers:{Accept:t("aBfpe").MediaType.JSON,"Content-Type":t("aBfpe").MediaType.JSON},body:({contentId:e,contentType:t,heartbeatUserType:r})=>JSON.stringify({dataType:"json",contentId:e,draftType:t??"",heartbeatUserType:r}),parseResponseOnError:()=>!1,parseResult:e=>({experimentalEditorStopHeartbeat:!!e})})}),r("S6mif",function(e,r){var a=t("42omo");class s extends Error{constructor(e,t,r){super(e),this.message=e,this.status=t,this.traceId=r,this.status=t,this.traceId=r}}let n=e=>e.code===t("h3X17").PROVIDER_ERROR_CODE.NO_PERMISSION_ERROR&&"EXPIRED_TOKEN"!==e.reason||e.code===t("h3X17").PROVIDER_ERROR_CODE.DOCUMENT_NOT_FOUND,o=e=>!e.recoverable&&t("h3X17").PROVIDER_ERROR_CODE.INTERNAL_SERVICE_ERROR!==e.code,i=e=>(0,t("422HI").isApolloError)(e)&&t("hBkCm").BadStatusError.isBadStatusError(e?.graphQLErrors?.[0]?.originalError)?Number((0,t("aMcHK").getStatusCodeError)(e.graphQLErrors[0].originalError)):null,l=e=>423===e.status;e.exports.CollabRecoveryErrorType=s,e.exports.isUnrecoverableError=o,e.exports.useError=(e,r,c,u)=>{let[d,p]=(0,a.useState)(null),[g,f]=(0,a.useState)(null),E=(0,a.useRef)({resetInProgress:!1,resetCount:0}),h=(0,a.useContext)(t("1kHsc").ExperienceTrackerContext),{createAnalyticsEvent:b}=(0,t("inPa6").useAnalyticsEvents)(),m=(0,t("3jwuS").useIsCurrentPageLive)(),y=m?t("irVI7").VIEW_PAGE_EXPERIENCE:t("irVI7").EDIT_PAGE_LOAD_EXPERIENCE,{livePageReleasePhase:S}=(0,t("gTyTP").useIsLivePagesFeatureEnabled)(),v=(0,a.useCallback)(e=>{if(e?.status&&e?.status<500)return void h.abort({name:y,reason:`Recovery failed with error status ${e.status}`,attributes:{errorStatus:e?.status,traceId:e?.traceId,objectId:c,objectType:u,isLivePage:m,...m?{livePageReleasePhase:S}:{}}});h.stopOnError({name:y,error:e,attributes:{...e?.status?{errorStatus:e.status}:{},errorType:"Recovery failed",traceId:e?.traceId,objectId:c,objectType:u,isLivePage:m,...m?{livePageReleasePhase:S}:{}}})},[c,u,h,y,m,S]),I=(0,a.useCallback)(r=>{(n(r)||o(r)||l(r))&&p(r);let a=h.getExperienceState(y);if(!a||a.hasStopped){n(r)||(o(r)?h.stopOnError({name:t("irVI7").EDIT_PAGE_EXPERIENCE,error:{name:r.code,message:r.message},attributes:{errorStatus:r.status,objectId:c,objectType:u,isLivePage:m}}):b({type:"sendOperationalEvent",data:{action:"error",actionSubject:"nativeEditor",source:"confluenceFrontend",objectId:c,objectType:u,attributes:{errorName:r.code,errorMessage:r.message,errorStatus:r.status,isRecoverable:!0,reason:"reason"in r?r.reason:"unknown",isLivePage:m}}}).fire());return}if(n(r)){let t;"reason"in r&&(t=r.reason),e.disconnect(),h.abort({name:y,reason:t??"page restricted or deleted",attributes:{errorStatus:r.status,errorName:r.code,errorMessage:r.message,objectId:c,objectType:u,isLivePage:m,...m?{livePageReleasePhase:S}:{}}})}else o(r)&&h.stopOnError({name:y,error:{name:r.code,message:r.message},attributes:{errorStatus:r.status,objectId:c,objectType:u,isLivePage:m,...m?{livePageReleasePhase:S}:{}}})},[e,h,b,c,u,y,m,S]),T=(0,a.useCallback)(async()=>{if(E.current.resetInProgress)return;if(E.current.resetCount>0){let e=new s("Collab recovery unsuccessful");f(e),v(e);return}E.current={resetInProgress:!0,resetCount:E.current.resetCount+=1};let e=async e=>{let t=i(e);return!!t&&t>=500};try{await (0,t("bMmYR").retry)(r,{maxAttempts:2,timeout:2e3},e),E.current.resetInProgress=!1}catch(a){let e=a,r=i(a);r&&(e=new s(`Collab recovery responded with ${r}`,r,(0,t("fJlJm").getTraceIdFromApolloError)(a)??void 0)),f(e),v(e),E.current.resetInProgress=!1}},[r,v]);return(0,a.useEffect)(()=>{if(!e)return;let t=e=>{404==e.status?T():I(e)};return e.on("error",t),()=>{e.off("error",t)}},[e,r]),{error:d,recoveryError:g}}}),r("2wSyg",function(r,a){var s=t("42omo");let n=(0,s.createContext)({getIsPublishing:()=>!1,setIsPublishing:e=>{},isPublishing:!1}),o=()=>(0,s.useContext)(n);r.exports.DraftSyncAndPublishContextProvider=({children:t})=>{let r=(0,s.useRef)(!1),[a,o]=e(s).useState(!1),i=(0,s.useCallback)(()=>r.current,[]),l=(0,s.useCallback)(e=>{r.current=e,o(e)},[]),c=(0,s.useMemo)(()=>({getIsPublishing:i,setIsPublishing:l,isPublishing:a}),[i,l,a]);return e(s).createElement(n.Provider,{value:c},t)},r.exports.DraftSyncAndPublishContextConsumer=({children:e})=>e(o()),r.exports.useDraftSyncAndPublishContext=o});
//# sourceMappingURL=NativeCollabComponent.1c57615b.js.map
