function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var n=globalThis,a={},r={},i=n.parcelRequired477;null==i&&((i=function(e){var t=a[e];if(void 0!==t)return t.exports;var n=r[e];if(void 0!==n){delete r[e];var i={id:e,exports:{}};return a[e]=i,n.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},n.parcelRequired477=i);var o=i.register;n.lb||(n.lb=new Set,n.bq=[],n.rlb=e=>{n.lb.add(e),n.pq()},n.rwr=(e,t,a)=>{n.bq.push({b:e,r:t,d:a}),n.pq()},n.pq=()=>{var e=n.bq.find(e=>e.d.every(e=>n.lb.has(e)));e&&(n.bq=n.bq.filter(t=>t.b!==e.b),e.r(),n.pq())}),o("8Ss4E",function(t,n){var a=i("5qzNs"),r=i("kyKWe");let o=[i("irVI7").NOT_FOUND_EXPERIENCE,i("irVI7").RESTRICTED_PAGE_EXPERIENCE,i("irVI7").RESTRICTED_SPACE_EXPERIENCE,i("irVI7").RESTRICTED_SPACE_FOR_GUEST_EXPERIENCE],s=(0,i("1A7bE").collectAny)(o),E=(0,i("1A7bE").collectAny)([i("irVI7").CONNECT_ADDON_EXPERIENCE]),m=[],c={[i("irVI7").CREATE_PAGE_EXPERIENCE]:[i("1NBp8").EDIT_PAGE_V2.name,i("1NBp8").EDIT_BLOG_V2.name,i("1NBp8").EDIT_PAGE.name,i("1NBp8").EDIT_BLOG.name,i("1NBp8").VIEW_PAGE.name],[i("irVI7").CREATE_WHITEBOARD_EXPERIENCE]:[i("1NBp8").WHITEBOARD_BOARD.name],[i("irVI7").CREATE_DATABASE_EXPERIENCE]:[i("1NBp8").DATABASE_VIEW.name],[i("irVI7").CREATE_EMBED_EXPERIENCE]:[i("1NBp8").EMBED_VIEW.name]},d=[i("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE],l={[i("1NBp8").SPACE_OVERVIEW.name]:"space",[i("1NBp8").COMPANY_HUB.name]:"space",[i("1NBp8").EDIT_PAGE_EMBED.name]:"page",[i("1NBp8").EDIT_PAGE_V2.name]:"page",[i("1NBp8").EDIT_BLOG_V2.name]:"blog",[i("1NBp8").VIEW_PAGE.name]:"page",[i("1NBp8").VIEW_BLOG.name]:"blog",[i("1NBp8").VIEW_BLOG_DATE_LEGACY.name]:"blog"},p=e=>{switch(e){case i("1NBp8").EDIT_BLOG.name:case i("1NBp8").EDIT_PAGE.name:case i("1NBp8").CREATE_PAGE.name:return"TINY";default:return"FABRIC"}};function u(t,n,a){let o=(0,i("fGzMp").getExperienceTracker)(),s=e(r)(),E={...t.attributes,compoundTaskId:s};o.start({...t,id:s,attributes:E,collect:(e,r)=>{r.stopOn(e.find(({action:e,name:t})=>"taskFail"===e&&t===n.name)),r.stopOn(e.find(({action:e,name:t})=>("taskSuccess"===e||"taskFail"===e)&&t===a.name)),t.collect&&t.collect(e,r)}}),o.start({...n,id:n.id||t.id,timeout:n.timeout||i("aJPUt").ExperienceTimeout.EDITOR_LOAD,attributes:E,collect:n.collect})}let I=(e,t,n,a)=>{let r=e.find(e=>e.name===n&&(0,i("gykrH").isStop)(e)),o=e.find(e=>e.name===a&&(0,i("gykrH").isStop)(e));o&&(r&&"taskSuccess"===r.action||"taskSuccess"!==o.action?t.stopOn(o):t.abort({reason:"Editor closed before load completed",attributes:{loadExperienceState:r?.action??"incomplete"}}))};function _(e,t,n,a,r,o){let m=!!(a&&a.atlOrigin);(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").VIEW_CONTENT_EXPERIENCE,id:e,startTime:0===t?0:void 0,timeout:i("aJPUt").ExperienceTimeout.PAGE_LOAD,attributes:{contentType:n,isFromExternal:m,edition:r?.edition,shard:r?.shard,...o},collect:(e,t)=>{s(e,t),E(e,t)}})}function C(e,t){u({name:i("irVI7").TEMPLATE_EDIT_PAGE_EXPERIENCE,id:e,startTime:0===t?0:void 0,collect:(e,t)=>{t.stopOn(e.find(e=>(0,i("gykrH").isStop)(e)&&e.name===i("irVI7").TEMPLATE_EDIT_PAGE_CLOSE_EXPERIENCE))}},{name:i("irVI7").TEMPLATE_EDIT_PAGE_LOAD_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.TEMPLATE_EDITOR_LOAD},{name:i("irVI7").TEMPLATE_EDIT_PAGE_PUBLISH_EXPERIENCE})}function T(e,t,n){(0,i("fGzMp").getExperienceTracker)().start({name:t,collect:(e,t)=>{(0,i("1A7bE").collectAll)(n)(e,t),s(e,t)},id:e,timeout:i("aJPUt").ExperienceTimeout.DEFAULT}),n.forEach(t=>{(0,i("fGzMp").getExperienceTracker)().start({name:t,id:e})})}t.exports.routeNameToContentTypeMap=l,t.exports.startExperienceForRoute=function(t,n,r){if(!t)return;let E=(0,i("fGzMp").getExperienceTracker)();(0,i("fGzMp").captureRouteChange)(t.name),function(){let e=(0,i("fGzMp").getExperienceTracker)();[i("irVI7").EDIT_PAGE_EXPERIENCE,i("irVI7").LIVE_PAGE_SESSION_EXPERIENCE].forEach(t=>{let n=e.getExperienceState(t);n&&!n?.hasStopped&&n?.attributes?.isLivePage&&e.succeed({name:t})})}(),m.forEach(e=>{let n=c[e];if(!(n&&n.includes(t.name))){if(e===i("irVI7").EDIT_PAGE_EXPERIENCE&&(0,i("7v9li").hasHealthyRunningEditPageExperience)()||e===i("irVI7").COMPANY_HUB_EDITOR_EXPERIENCE&&(0,i("7v9li").hasHealthyRunningCompanyHubEditExperience)()||e===i("irVI7").VIEW_PAGE_SESSION_EXPERIENCE&&(0,i("949zl").hasHealthyRunningViewPageExperience)())return void E.succeed({name:e});E.abort({name:e,reason:"Aborted due to SPA started a new experience"})}}),m.length=0;let N=E.subscribe(e=>{"taskStart"===e.action&&m.push(e.name)});switch((0,i("9wGTI").fg)("confluence_frontend_abort_exp_on_route_change")&&d.forEach(e=>{m.push(e)}),t.name){case i("1NBp8").COMPANY_HUB_EDIT.name:A=n,S=r,u({name:i("irVI7").COMPANY_HUB_EDITOR_EXPERIENCE,startTime:0===A?0:void 0,attributes:{editor:"FABRIC",contentType:"space",edition:S?.edition,shard:S?.shard,isCompanyHub:!0},collect:(e,t)=>{s(e,t),I(e,t,i("irVI7").COMPANY_HUB_EDITOR_LOAD_EXPERIENCE,i("irVI7").COMPANY_HUB_EDITOR_CLOSE_EXPERIENCE)}},{name:i("irVI7").COMPANY_HUB_EDITOR_LOAD_EXPERIENCE,collect:(e,t)=>{s(e,t)}},{name:i("irVI7").FRONT_COVER_PUBLISH_EXPERIENCE});break;case i("1NBp8").EDIT_PAGE_EMBED.name:case i("1NBp8").EDIT_PAGE_V2.name:case i("1NBp8").EDIT_BLOG_V2.name:case i("1NBp8").EDIT_PAGE.name:case i("1NBp8").EDIT_BLOG.name:case i("1NBp8").CREATE_PAGE.name:case i("1NBp8").HUB_EDIT.name:var A,S,g,P,f,R,h,y,L,D=t,k=n,b=r;let M="TINY"===p(D?.name??""),O=i("irVI7").EDIT_PAGE_EXPERIENCE;D.name===i("1NBp8").EDIT_PAGE_EMBED.name?O=i("irVI7").EDIT_PAGE_EMBED_EXPERIENCE:M&&(O=i("irVI7").EDIT_LEGACY_PAGE_EXPERIENCE),u({name:O,id:D.params.contentId,startTime:0===k?0:void 0,attributes:{editor:p(D.name),contentType:l[D.name],edition:b?.edition,shard:b?.shard,isCompanyHub:D?.name===i("1NBp8").COMPANY_HUB_EDIT.name||D?.name===i("1NBp8").HUB_EDIT.name,contentId:D.params.contentId},collect:(e,t)=>{s(e,t),I(e,t,M?i("irVI7").EDIT_LEGACY_PAGE_LOAD_EXPERIENCE:i("irVI7").EDIT_PAGE_LOAD_EXPERIENCE,M?i("irVI7").EDIT_LEGACY_PAGE_CLOSE_EXPERIENCE:i("irVI7").EDIT_PAGE_CLOSE_EXPERIENCE)}},{name:M?i("irVI7").EDIT_LEGACY_PAGE_LOAD_EXPERIENCE:i("irVI7").EDIT_PAGE_LOAD_EXPERIENCE,collect:(e,t)=>{s(e,t);let n=M?i("irVI7").EDIT_LEGACY_PAGE_CLOSE_EXPERIENCE:i("irVI7").EDIT_PAGE_CLOSE_EXPERIENCE,a=e.find(e=>(0,i("gykrH").isStop)(e)&&e.name===n);a&&t.abort({reason:"Editor closed before load completed",attributes:{closeExperienceState:a?.action??"incomplete"}})}},{name:M?i("irVI7").EDIT_LEGACY_PAGE_PUBLISH_EXPERIENCE:i("irVI7").EDIT_PAGE_PUBLISH_EXPERIENCE});break;case i("1NBp8").VIEW_PAGE.name:case i("1NBp8").VIEW_BLOG.name:case i("1NBp8").VIEW_BLOG_DATE_LEGACY.name:_(t.params.contentId,n,l[t.name],t.query,r);break;case i("1NBp8").EDIT_PAGE_SMART_CREATE.name:g=t,(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").EDIT_PAGE_SMART_CREATE_LOAD_EXPERIENCE,id:g.params.contentId,timeout:i("aJPUt").ExperienceTimeout.DEFAULT,collect:(e,t)=>{let n=e.find(e=>(0,i("gykrH").isStop)(e)&&(0,i("gykrH").hasName)(e,...o));n&&t.fail({error:Error(`${n.name} experience resulted in ${n.action} - unexpected for the smart create editor`)})}});break;case i("1NBp8").ADMIN_NEW_GLOBAL_PERMISSIONS.name:P=t.query.tab,f=t.query.space,R=n,"public-links"!==P||f||(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").VIEW_PUBLIC_LINK_SITE_SETTINGS_EXPERIENCE,id:"public-links",startTime:0===R?0:void 0,timeout:i("aJPUt").ExperienceTimeout.PAGE_LOAD});break;case i("1NBp8").EXTERNAL_SHARE.name:h=t.params.id,y=n,(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").VIEW_PUBLIC_LINK_SHARED_PAGE_EXPERIENCE,id:h,startTime:0===y?0:void 0,timeout:i("aJPUt").ExperienceTimeout.PAGE_LOAD});break;case i("1NBp8").SPACE_OVERVIEW.name:_(t.params.spaceKey,n,l[t.name],t.query,r,{spaceKey:t.params.spaceKey,isLandingPage:"?mode=global"===t.search});break;case i("1NBp8").COMPANY_HUB.name:let v=(0,i("cEgMD").getCompanyHubSpaceKey)(r)||"";_(v,n,l[t.name],t.query,r,{spaceKey:v});break;case i("1NBp8").HOME.name:(0,i("h10mo").startHome)();break;case i("1NBp8").EDIT_TEMPLATE_SPACE.name:case i("1NBp8").EDIT_TEMPLATE.name:C(t.params.contentId,n);break;case i("1NBp8").CREATE_TEMPLATE_SPACE.name:case i("1NBp8").CREATE_TEMPLATE.name:C(void 0,n);break;case i("1NBp8").ADVANCED_SEARCH.name:L=t,(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").ADVANCED_SEARCH_EXPERIENCE,id:(0,i("hukUK").objectHash)(e(a)(L.query,["search_id"]))});break;case i("1NBp8").SPACE_ARCHIVED_PAGES.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").SPACE_ARCHIVED_PAGES_EXPERIENCE});break;case i("1NBp8").SPACE_BULK_TOOLS.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").CONTENT_MANAGER_EXPERIENCE});break;case i("1NBp8").SPACE_DIRECTORY.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").SPACE_DIRECTORY_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.SPACE_DIRECTORY});break;case i("1NBp8").TEMPLATE_GALLERY.name:let V=[i("irVI7").TEMPLATE_GALLERY_CATEGORIES_EXPERIENCE,i("irVI7").TEMPLATE_GALLERY_SPACE_SELECTOR_EXPERIENCE,i("irVI7").TEMPLATE_GALLERY_CARDS_EXPERIENCE,i("irVI7").TEMPLATE_GALLERY_TEMPLATE_DETAIL_EXPERIENCE],x=(e,t)=>{(0,i("1A7bE").collectAll)(V)(e,t)},U=(0,i("1A7bE").collectAll)([i("irVI7").RESTRICTED_PAGE_EXPERIENCE]);(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").TEMPLATE_GALLERY_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.DEFAULT,collect:(e,t)=>{x(e,t),U(e,t)}});break;case i("1NBp8").SPACE_PAGES.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").SPACE_PAGES_EXPERIENCE});break;case i("1NBp8").WHITEBOARD_BOARD.name:!function(e){let t=[i("irVI7").WHITEBOARD_CONTENT_EXPERIENCE],n=[i("irVI7").WHITEBOARD_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE,i("irVI7").VIEW_PAGE_FAVORITE_BUTTON_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_WATCH_EXPERIENCE],a=[i("irVI7").WHITEBOARD_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE],r=(0,i("9wGTI").fg)("confluence_frontend_content_wrapper")?a:n,o=(0,i("1iSzD").isEmbeddedConfluence_DO_NOT_USE)();T(e.params.contentId,i("irVI7").WHITEBOARD_EXPERIENCE,o?t:r)}(t);break;case i("1NBp8").DATABASE_VIEW.name:!function(e){let t=[i("irVI7").DATABASE_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE,i("irVI7").VIEW_PAGE_FAVORITE_BUTTON_EXPERIENCE],n=[i("irVI7").DATABASE_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE],a=(0,i("9wGTI").fg)("confluence_frontend_content_wrapper")?n:t,r=[i("irVI7").DATABASE_CONTENT_EXPERIENCE],o=(0,i("1iSzD").isEmbeddedConfluence_DO_NOT_USE)();T(e,i("irVI7").DATABASE_EXPERIENCE,o?r:a)}(t.params.contentId);break;case i("1NBp8").EMBED_VIEW.name:!function(e){let t=[i("irVI7").EMBED_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE,i("irVI7").VIEW_PAGE_FAVORITE_BUTTON_EXPERIENCE],n=[i("irVI7").EMBED_CONTENT_EXPERIENCE,i("irVI7").CONTENT_TYPES_HEADER_EXPERIENCE],a=(0,i("9wGTI").fg)("confluence_frontend_content_wrapper")?n:t;(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").EMBED_EXPERIENCE,collect:(e,t)=>{(0,i("1A7bE").collectAll)(a)(e,t),s(e,t)},id:e,timeout:i("aJPUt").ExperienceTimeout.DEFAULT}),t.forEach(t=>{(0,i("fGzMp").getExperienceTracker)().start({name:t,id:e})})}(t.params.contentId);break;case i("1NBp8").FOLDER_VIEW.name:var G=t.params.contentId;let B=[i("irVI7").FOLDER_CONTENT_EXPERIENCE];(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").FOLDER_EXPERIENCE,collect:(e,t)=>{(0,i("1A7bE").collectAll)(B)(e,t),s(e,t)},id:G,timeout:i("aJPUt").ExperienceTimeout.DEFAULT}),B.forEach(e=>{(0,i("fGzMp").getExperienceTracker)().start({name:e,id:G})});break;case i("1NBp8").SPACE_PERMISSIONS_SETTINGS.name:"public-links"===t.params.tab&&(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").VIEW_PUBLIC_LINKS_SPACE_SETTINGS_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.PAGE_LOAD});break;case i("1NBp8").ADMIN_ANNOUNCEMENT_BANNER_RENDERER.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").ADMIN_ANNOUNCEMENT_BANNER_SETTINGS_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.DEFAULT});break;case i("1NBp8").SPACE_MANAGER.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").SPACE_MANAGER_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.DEFAULT});break;case i("1NBp8").ADMIN_COMPANY_HOME_BUILDER.name:case i("1NBp8").ADMIN_CUSTOMIZE_NAVIGATION.name:(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").COMPANY_HOME_BUILDER_LOAD_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.DEFAULT})}let F="string"==typeof t?.query?.subType?t.query.subType:null;t.name===i("1NBp8").CREATE_CONTENT.name?function(e,t,n){let a=e.query,r=a.spaceKey?.[0]!==void 0?("~"===a.spaceKey[0]).toString():"unknown",o=(0,i("c3Qwv").getSingleParam)(a,"source")||"createContentRoute";"whiteboard"===e.params.contentType?(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").CREATE_WHITEBOARD_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.CREATE_CONTENT,attributes:{flow:o,isPersonalSpace:r},collect:(e,t)=>{e.find(e=>"taskStart"===e.action&&e.name===i("irVI7").WHITEBOARD_EXPERIENCE)&&t.succeed()}}):"database"===e.params.contentType?(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").CREATE_DATABASE_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.CREATE_CONTENT,attributes:{flow:o,isPersonalSpace:r},collect:(e,t)=>{e.find(e=>"taskStart"===e.action&&e.name===i("irVI7").DATABASE_EXPERIENCE)&&t.succeed()}}):"smartLinkEmbed"===e.params.contentType?(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").CREATE_EMBED_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.CREATE_CONTENT,attributes:{flow:o,isPersonalSpace:r},collect:(e,t)=>{e.find(e=>"taskStart"===e.action&&e.name===i("irVI7").EMBED_EXPERIENCE)&&t.succeed()}}):["page","blog"].includes(e.params.contentType)&&(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").CREATE_PAGE_EXPERIENCE,timeout:i("aJPUt").ExperienceTimeout.CREATE_CONTENT,attributes:{contentType:e.params.contentType,flow:o,isCreateContentRoute:!0,isPersonalSpace:r,edition:t?.edition,shard:t?.shard,isLivePage:n?.toLowerCase()==="live"},collect:(e,t)=>{e.find(e=>"taskStart"===e.action&&(e.name===i("irVI7").EDIT_PAGE_EXPERIENCE||e.name===i("irVI7").EDIT_LEGACY_PAGE_EXPERIENCE))&&t.succeed()}})}(t,r,F):t.query.createDialog&&(function(e,t,n){let a=(0,i("fGzMp").getExperienceTracker)();a.start({name:i("irVI7").CREATE_PAGE_EXPERIENCE,id:e,attributes:{isLivePage:n?.toLowerCase()==="live"},startTime:0===t?0:void 0,collect(e,t){t.stopOn(e.find(e=>"taskFail"===e.action&&(0,i("gykrH").hasName)(e,i("irVI7").CREATE_PAGE_LOAD_DIALOG_EXPERIENCE,i("irVI7").CREATE_PAGE_TEMPLATE_VARIABLES_EXPERIENCE))),t.stopOn(e.find(e=>"taskSuccess"===e.action&&(0,i("gykrH").hasName)(e,i("irVI7").CREATE_PAGE_TEMPLATE_VARIABLES_EXPERIENCE))),t.stopOn(e.find(e=>"taskAbort"===e.action&&(0,i("gykrH").hasName)(e,i("irVI7").CREATE_PAGE_TEMPLATE_VARIABLES_EXPERIENCE)))}}),a.start({name:i("irVI7").CREATE_PAGE_LOAD_DIALOG_EXPERIENCE,id:e,timeout:i("aJPUt").ExperienceTimeout.CREATE_DIALOG_LOAD})}(String(n),n,F),(0,i("7v9li").startCreateAndEditPage)()),N()},t.exports.startUFOPressTrace=function(e){(0,i("lMdlY").getActiveTrace)()||(0,i("4TXTZ").default)(e.replace(/\//g,"-"))},t.exports.startEditorExperiences=u,t.exports.startEditorSubExperience=function(e){let t=(0,i("fGzMp").getExperienceTracker)(),n={...e.attributes},a=e.name.split("/");if(a.length>1){let e=a[0],r=t.getExperienceState(e);r&&r.attributes?.compoundTaskId&&(n.compoundTaskId=r.attributes.compoundTaskId)}t.start({...e,attributes:n})}}),o("1A7bE",function(e,t){e.exports.collectAll=e=>{let t=new Set(e);return(e,n)=>{n.stopOn(e.find(e=>t.has(e.name)&&("taskFail"===e.action||"taskAbort"===e.action)),{incompleteSubExperiences:[...t].join(", ")}),e.forEach(e=>{(0,i("gykrH").isStop)(e)&&t.delete(e.name)}),0===t.size&&n.succeed()}},e.exports.collectAny=e=>(t,n)=>n.stopOn(t.find(t=>(0,i("gykrH").isStop)(t)&&(0,i("gykrH").hasName)(t,...e)))}),o("h10mo",function(e,t){let n=[i("irVI7").HOME_OVERVIEW_EXPERIENCE,i("irVI7").HOME_RECENT_EXPERIENCE,i("irVI7").HOME_STARRED_EXPERIENCE,i("irVI7").HOME_WATCHING_EXPERIENCE,i("irVI7").HOME_DRAFTS_EXPERIENCE];function a(e,t){let a=new Set(n);t.stopOn(e.find(e=>("taskFail"===e.action||"taskAbort"===e.action)&&(a.has(e.name)||e.name===i("irVI7").HOME_SPACES_EXPERIENCE)));let r=!1,o=!1;e.forEach(e=>{(0,i("gykrH").isStop)(e)&&(a.has(e.name)&&(r=!0),e.name===i("irVI7").HOME_SPACES_EXPERIENCE&&"taskSuccess"===e.action&&(o=!0))}),r&&o&&t.succeed()}e.exports.startHome=function(){let e=(0,i("1dnxO").getIsNav4Enabled)();(0,i("fGzMp").getExperienceTracker)().start({name:i("irVI7").HOME_EXPERIENCE,collect:e?(0,i("1A7bE").collectAny)(n):a})}}),o("b1hSc",function(e,t){var n,a,r,i,o,s,E,m,c,d,l,p,u,I,_,C,T,N,A,S,g,P,f,R,h,y,L,D,k,b,M,O,v,V,x,U,G;let B=(n={defaultValue:null,kind:"LocalArgument",name:"contentStatus"},a={defaultValue:null,kind:"LocalArgument",name:"first"},r={defaultValue:null,kind:"LocalArgument",name:"pageId"},i={defaultValue:null,kind:"LocalArgument",name:"type"},s=[{fields:[{kind:"Literal",name:"commentState",value:"UNRESOLVED"},{kind:"Variable",name:"commentType",variableName:"type"}],kind:"ObjectValue",name:"confluenceCommentFilter"},{kind:"Variable",name:"contentStatus",variableName:"contentStatus"},{kind:"Literal",name:"depth",value:"ROOT"},{kind:"Variable",name:"first",variableName:"first"},o={kind:"Variable",name:"pageId",variableName:"pageId"},{kind:"Literal",name:"singleThreaded",value:!0},{kind:"Variable",name:"type",variableName:"type"}],m={kind:"ScalarField",name:"id"},u={kind:"LinkedField",name:"author",plural:!1,selections:[c={kind:"ScalarField",name:"displayName"},d={concreteType:"Icon",kind:"LinkedField",name:"profilePicture",plural:!1,selections:[{kind:"ScalarField",name:"path"}]},l={kind:"ScalarField",name:"permissionType"},{kind:"InlineFragment",selections:[E={kind:"ScalarField",name:"__typename"},p={kind:"ScalarField",name:"accountId"}],type:"KnownUser"}]},_={args:[{kind:"Literal",name:"representation",value:"ATLAS_DOC_FORMAT"}],concreteType:"DocumentBody",kind:"LinkedField",name:"body",plural:!1,selections:I=[{kind:"ScalarField",name:"value"}],storageKey:'body(representation:"ATLAS_DOC_FORMAT")'},C={kind:"ScalarField",name:"contentStatus"},T={concreteType:"ConfluenceDate",kind:"LinkedField",name:"createdAt",plural:!1,selections:I},N={kind:"ScalarField",name:"createdAtNonLocalized"},A={concreteType:"Map_LinkType_String",kind:"LinkedField",name:"links",plural:!1,selections:[{kind:"ScalarField",name:"webui"},{kind:"ScalarField",name:"editui"}]},L={kind:"LinkedField",name:"location",plural:!1,selections:[S={kind:"ScalarField",name:"type"},h={kind:"InlineFragment",selections:[{kind:"ScalarField",name:"inlineMarkerRef"},{kind:"ScalarField",name:"inlineText"},{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"inlineResolveProperties",plural:!1,selections:[{kind:"ScalarField",name:"isDangling"},g={kind:"ScalarField",name:"resolvedTime"},P={kind:"ScalarField",name:"resolvedFriendlyDate"},f={kind:"ScalarField",name:"resolvedUser"},R={kind:"ScalarField",name:"resolved"}]}],type:"InlineComment"},y={kind:"InlineFragment",selections:[{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"commentResolveProperties",plural:!1,selections:[R,P,g,f]}],type:"FooterComment"}]},D={kind:"ScalarField",name:"parentId"},k={concreteType:"CommentPermissions",kind:"LinkedField",name:"permissions",plural:!1,selections:[{kind:"ScalarField",name:"isEditable"},{kind:"ScalarField",name:"isRemovable"},{kind:"ScalarField",name:"isResolvable"}]},O={concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[c]},b={kind:"ScalarField",name:"when"},M={kind:"ScalarField",name:"number"}]},v={args:[{kind:"Literal",name:"childType",value:"comment"},{kind:"Literal",name:"contentType",value:"page"},o],concreteType:"ReactionsSummaryResponse",kind:"LinkedField",name:"reactionsSummary",plural:!1,selections:[{kind:"ScalarField",name:"ari"},{kind:"ScalarField",name:"containerAri"},{kind:"ScalarField",name:"reactionsCount"},{concreteType:"ReactionsSummaryForEmoji",kind:"LinkedField",name:"reactionsSummaryForEmoji",plural:!0,selections:[m,{kind:"ScalarField",name:"emojiId"},{kind:"ScalarField",name:"count"},{kind:"ScalarField",name:"reacted"}]}]},V={kind:"ScalarField",name:"totalCount"},x={kind:"LinkedField",name:"author",plural:!1,selections:[E,c,d,l,{kind:"InlineFragment",selections:[p],type:"KnownUser"}]},U={kind:"LinkedField",name:"location",plural:!1,selections:[E,S,h,y]},G={concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[E,c]},b,M]},{fragment:{argumentDefinitions:[n,a,r,i],kind:"Fragment",name:"ActiveCommentsQuery",selections:[{args:s,concreteType:"PaginatedCommentList",kind:"LinkedField",name:"comments",plural:!1,selections:[E,{concreteType:"Comment",kind:"LinkedField",name:"nodes",plural:!0,selections:[m,u,_,C,T,N,A,L,D,k,O,v,{concreteType:"Comment",kind:"LinkedField",name:"replies",plural:!0,selections:[m,u,_,C,T,N,A,L,D,k,O,v]}]},V]}],type:"Query"},kind:"Request",operation:{argumentDefinitions:[r,n,i,a],kind:"Operation",name:"ActiveCommentsQuery",selections:[{args:s,concreteType:"PaginatedCommentList",kind:"LinkedField",name:"comments",plural:!1,selections:[E,{concreteType:"Comment",kind:"LinkedField",name:"nodes",plural:!0,selections:[m,x,_,C,T,N,A,U,D,k,G,v,{concreteType:"Comment",kind:"LinkedField",name:"replies",plural:!0,selections:[m,x,_,C,T,N,A,U,D,k,G,v]}]},V]}]},params:{cacheID:"51e15b77790c5d8cdaef4df99503fbf3",id:"3ec4e8503cac8503ab97b9d5696225ef01a65c63685ff47bcda76917fd8a9386",metadata:{},name:"ActiveCommentsQuery",operationKind:"query",text:'query ActiveCommentsQuery($pageId:ID!,$contentStatus:[GraphQLContentStatus],$type:[CommentType],$first:Long)@allowHigherTimeout{comments(pageId:$pageId,contentStatus:$contentStatus,depth:ROOT,confluenceCommentFilter:{commentState:UNRESOLVED,commentType:$type},singleThreaded:true,type:$type,first:$first){__typename,nodes{id,author{__typename,displayName,profilePicture{path},permissionType,...on KnownUser{__typename,accountId}},body(representation:ATLAS_DOC_FORMAT){value},contentStatus,createdAt{value},createdAtNonLocalized,links{webui,editui},location{__typename,type,...on InlineComment{inlineMarkerRef,inlineText,inlineResolveProperties{isDangling,resolvedTime,resolvedFriendlyDate,resolvedUser,resolved}},...on FooterComment{commentResolveProperties{resolved,resolvedFriendlyDate,resolvedTime,resolvedUser}}},parentId,permissions{isEditable,isRemovable,isResolvable},version{by{__typename,displayName},when,number},reactionsSummary(pageId:$pageId,contentType:"page",childType:"comment"){ari,containerAri,reactionsCount,reactionsSummaryForEmoji{id,emojiId,count,reacted}},replies{id,author{__typename,displayName,profilePicture{path},permissionType,...on KnownUser{__typename,accountId}},body(representation:ATLAS_DOC_FORMAT){value},contentStatus,createdAt{value},createdAtNonLocalized,links{webui,editui},location{__typename,type,...on InlineComment{inlineMarkerRef,inlineText,inlineResolveProperties{isDangling,resolvedTime,resolvedFriendlyDate,resolvedUser,resolved}},...on FooterComment{commentResolveProperties{resolved,resolvedFriendlyDate,resolvedTime,resolvedUser}}},parentId,permissions{isEditable,isRemovable,isResolvable},version{by{__typename,displayName},when,number},reactionsSummary(pageId:$pageId,contentType:"page",childType:"comment"){ari,containerAri,reactionsCount,reactionsSummaryForEmoji{id,emojiId,count,reacted}}}},totalCount}}'}});B.hash="37d97577cf19b12ed92bf7d36576353c",e.exports.default=B}),o("9rE3H",function(e,t){e.exports.ACTIVE_COMMENTS_QUERY_PRELOAD_LOADING_FLAG=-1,e.exports.buildConsistentActiveCommentsQueryPreloadVariables=(e,t)=>({pageId:e,contentStatus:[t?"ARCHIVED":"CURRENT","DRAFT"],type:["FOOTER"],first:3}),e.exports.buildConsistentActiveCommentsQueryVariables=({pageId:e,type:t,isArchived:n=!1})=>({pageId:e,contentStatus:[n?"ARCHIVED":"CURRENT","DRAFT"],first:2e3,...(0,i("9wGTI").fg)("confluence_frontend_content_wrapper")&&t&&{type:[t]}})}),o("cD1qu",function(e,t){var n,a,r=((n={}).EDIT="edit",n.VIEW="view",n.LIVE="live",n),i=((a={}).CURRENT="current",a.DRAFT="draft",a.ARCHIVED="archived",a);e.exports.PageMode=r,e.exports.ContentStatus=i,e.exports.DRAFT_STATUS=["draft"],e.exports.CURRENT_STATUS=["current"]}),o("gtj7V",function(e,t){e.exports.getCommentsDataManagerExperimentAttributes=()=>({newDataManagerEnabled:(0,i("6mKj3").UNSAFE_expValNoExposure)("cc_comments_new_comments_data_manager","isEnabled",!1)})}),o("fHAwL",function(e,t){let n={unreadCommentsListState:[],readCommentsListState:new Set,shouldUpdateUnreadComments:!1,shouldUpdateUnreadCommentsOnFirstRender:!0,threadKeyToCommentIdMap:{},allComments:[],isUnreadQueryLoading:!1,unreadCommentIDSet:new Set,shouldClearVisibleThreads:!1},a=(0,i("1P1Tu").createStore)({initialState:n,actions:{updateUnreadCommentsListState:e=>({setState:t,getState:n})=>{let{unreadCommentsListState:a,threadKeyToCommentIdMap:r}=n();t({unreadCommentsListState:e(a,r)})},updateReadCommentsListState:e=>({setState:t,getState:n})=>{let{readCommentsListState:a}=n();t({readCommentsListState:e(a)})},updateUnreadComments:e=>({setState:t})=>{t({shouldUpdateUnreadComments:e})},updateUnreadCommentsOnFirstRender:e=>({setState:t})=>{t({shouldUpdateUnreadCommentsOnFirstRender:e})},updateThreadKeyToCommentIdMap:e=>({setState:t,getState:n})=>{let{threadKeyToCommentIdMap:a}=n();t({threadKeyToCommentIdMap:e(a)})},updateAllComments:e=>({setState:t})=>{t({allComments:e})},setIsUnreadQueryLoading:e=>({setState:t})=>{t({isUnreadQueryLoading:e})},updateUnreadCommentIDSet:(e,t="initialize")=>({setState:n,getState:a})=>{let{unreadCommentIDSet:r}=a();switch(t){case"initialize":n({unreadCommentIDSet:e});break;case"add":n({unreadCommentIDSet:new Set([...r,...e])});break;case"remove":let i=new Set(r);e.forEach(e=>i.delete(e)),n({unreadCommentIDSet:i});break;case"removeAll":n({unreadCommentIDSet:new Set})}},setShouldClearVisibleThreads:e=>({setState:t})=>{t({shouldClearVisibleThreads:e})}},name:"UnreadCommentsStore"}),r=(0,i("9zUhf").createHook)(a),o=(0,i("9zUhf").createActionsHook)(a),s=(0,i("9zUhf").createStateHook)(a);e.exports.useUnreadComments=r,e.exports.useUnreadCommentsActions=o,e.exports.useUnreadCommentsState=s}),o("8i27m",function(t,n){var a,r,o,s,E=i("a4TK8");let m=(0,i("7W8i8").getLogger)("comments-data");var c=((a={}).INLINE="inline",a.GENERAL="general",a),d=((r={})[r.READ=0]="READ",r[r.UNREAD=1]="UNREAD",r),l=((o={}).CREATE_COMMENT="created",o.DELETE_COMMENT="deleted",o.RESOLVE_COMMENT_THREAD="resolved",o.REOPEN_COMMENT_THREAD="reopened",o.REATTACH_COMMENT="reattach",o),p=((s={}).NOT_LOADED="not_loaded",s.PRELOADING="preloading",s.PARTIALLY_LOADED="partially_loaded",s.FULLY_LOADED="fully_loaded",s);let u=()=>({orderedActiveAnnotationIdList:[],commentsDataMap:{inline:{},general:{}},removedThreadsMap:{inline:{},general:{}},commentThreadsRemovedByOtherUsers:{},hasNestedComments:!1,cacheUpdateFailed:!1,footerCommentsLoadingState:"not_loaded"}),I=(0,i("1P1Tu").createStore)({initialState:u(),actions:{setCommentsDataMap:e=>({getState:t,setState:n})=>{let{orderedActiveAnnotationIdList:a}=t(),r=new Set(Object.keys(e.inline)),o=a.map(e=>({...e,isLoaded:r.has(e.threadKey)})),s=(0,i("3ZsvI").parseHasNestedComments)(e);n({commentsDataMap:e,orderedActiveAnnotationIdList:o,hasNestedComments:s})},setOrderedActiveAnnotationIdList:t=>({getState:n,setState:a})=>{let{orderedActiveAnnotationIdList:r}=n();if(!t||0===t.length){r.length>0&&a({orderedActiveAnnotationIdList:[]});return}let i=new Map(r.map(({threadKey:e,isLoaded:t})=>[e,t])),o=Array.from(new Set(t)).map(e=>({threadKey:e,isLoaded:i.get(e)??!1}));e(E)(r,o)||a({orderedActiveAnnotationIdList:o})},updateReactionsSummary:(e,t,n,a,r,o,s,E,c)=>({setState:d,getState:l})=>{let p,u=(e,t,n)=>{let{reactionsSummary:a}=e||{};if(!a)return;let r=a?.ari||"",i=a?.containerAri||"",o=[...a?.reactionsSummaryForEmoji||[]],s={...a};if("add"===n){let e=o.find(e=>e?.emojiId===t);e&&!e.reacted?(e.count++,e.reacted=!0):e||o.push({emojiId:t,count:1,reacted:!0,id:`${i}|${r}|${t}`})}else if("delete"===n){let e=o.findIndex(e=>e?.emojiId===t);if(-1!==e){let t=o[e];t&&t.reacted&&(t.count--,t.reacted=!1),t&&t.count<=0&&o.splice(e,1)}}s.reactionsSummaryForEmoji=o,s.reactionsCount=o.reduce((e,t)=>e+(t?.count||0),0),e&&(e.reactionsSummary=s)};try{if((0,i("6mKj3").expValEquals)("remove_usages_of_cache_read_write","isEnabled",!0)){let a=`$Comment:${n}.reactionsSummary(${JSON.stringify({childType:"comment",contentType:"page",pageId:s})})`,i=r({id:a});if(i){let n={...i};u(n,e,t),o({fragmentId:a,data:n})}let E=`$Comment:${n}.replies.reactionsSummary(${JSON.stringify({childType:"comment",contentType:"page",pageId:s})})`,m=r({id:E});m&&(u(m,e,t),o({fragmentId:E,data:{reactionsSummary:m}}))}else{let r=(0,i("9rE3H").buildConsistentActiveCommentsQueryVariables)({pageId:s,type:"general"===a?"FOOTER":void 0}),o=c?.readQuery({query:(0,i("86okN").toDocumentNode)(i("eg9xl").ActiveCommentsQuery),variables:r});if(o){let s,m=(o.comments?.nodes||[]).find(e=>"general"===a?e?.id===E:e?.location?.inlineMarkerRef===E);if(m){if(m.id!==n&&!(s=m.replies.find(e=>e.id===n)))return;u(s||m,e,t),c?.writeQuery({query:(0,i("86okN").toDocumentNode)(i("eg9xl").ActiveCommentsQuery),variables:r,data:o})}}}}catch(e){m.error`An error occurred when updating comments panel cache - ${e}`}let{commentsDataMap:I}=l(),_={...I};if(!E)return;let C=_[a][E];if(C){if(C.id!==n&&!(p=C.replies.find(e=>e.id===n)))return;u(p||C,e,t),d({commentsDataMap:_})}},updateUnreadStatus:(e,t)=>({setState:n,getState:a})=>{let{commentsDataMap:r}=a(),i={...r},o=e=>([n,a])=>{let r=i[e][n];if(r){let o=a.has(r.id);i[e][n]={...r,isUnread:o?1===t:r.isUnread,replies:r.replies?.map(e=>a.has(e.id)?{...e,isUnread:1===t}:e),wasRemovedByAnotherUser:!1}}};Object.entries(e.inline).forEach(o("inline")),Object.entries(e.general).forEach(o("general")),n({commentsDataMap:i})},addNewCommentThreads:e=>({setState:t,getState:n})=>{let{commentsDataMap:a,orderedActiveAnnotationIdList:r,hasNestedComments:o}=n(),s={...a};for(let t in e.inline){let n=e.inline[t];s.inline[t]=n}for(let t in e.general){let n=e.general[t];s.general[t]=n}let E=r.map(t=>({...t,isLoaded:!!Object.keys(e).includes(t.threadKey)||t.isLoaded})),m=o||(0,i("3ZsvI").parseHasNestedComments)(s);t({commentsDataMap:s,orderedActiveAnnotationIdList:E,hasNestedComments:m})},addReplyToCommentThread:(e,t,n)=>({setState:a,getState:r})=>{let{commentsDataMap:i}=r(),o={...i},s=o[n][e];if(s){let r=s.replies||[];if(!r.some(e=>e.id===t.id)){let i=[...r,t],E={...s,replies:i};o[n][e]=E,a({commentsDataMap:o})}}},getCurrentCommentsPanelState:()=>({getState:e})=>e(),setFooterCommentsLoadingState:e=>({setState:t})=>{t({footerCommentsLoadingState:e})},updateCommentBody:(e,t,n,a,r=null)=>({setState:i,getState:o})=>{let{commentsDataMap:s}=o(),E={...s},m=E[a][t];if(m)if(m.id===e){let e={...m,body:{value:n},version:{...m.version,by:{...m.version?.by,displayName:r},number:(m.version?.number??0)+1,when:new Date().toISOString()}};E[a][t]=e,i({commentsDataMap:E})}else for(let o=0;o<m.replies.length;o++){let s=m.replies[o];if(s.id===e){let e={...s,body:{value:n},version:{...s.version,by:{...s.version?.by,displayName:r},number:(s.version?.number??0)+1,when:new Date().toISOString()}},c={...m,replies:[...m.replies]};c.replies[o]=e,E[a][t]=c,i({commentsDataMap:E});break}}},updateRemovedCommentIdsMap:({threadKey:e,commentId:t,commentActionType:n,isReply:a,commentType:r,resolvedProperties:o})=>({setState:s,getState:E})=>{let{commentThreadsRemovedByOtherUsers:m}=E();if(!(0,i("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)){let{commentsDataMap:m,orderedActiveAnnotationIdList:c,removedThreadsMap:d}=E(),l={...m},p=l[r][e];if(p){if(a){let a=p.replies.map(e=>e.id===t?{...e,wasRemovedByAnotherUser:n}:e);l[r][e]={...p,replies:a}}else o?("inline"===r||!(0,i("9wGTI").fg)("confluence_gen_comments_resolve_pubsub"))&&o.inlineResolveProperties?l[r][e]={...p,location:{type:"INLINE",inlineMarkerRef:e,inlineResolveProperties:o.inlineResolveProperties,inlineText:o.inlineText||""},isOpen:!1,wasRemovedByAnotherUser:n}:l[r][e]={...p,location:{commentResolveProperties:{resolved:o.resolved||!1,resolvedFriendlyDate:o.resolvedFriendlyDate||"",resolvedTime:o.resolvedTime||0,resolvedUser:o.resolvedUser||""},type:"GENERAL"},isOpen:!1,wasRemovedByAnotherUser:n}:l[r][e]={...p,isOpen:!1,wasRemovedByAnotherUser:n};"resolved"===n&&(l[r][e]={...l[r][e],isUnread:!1,replies:p.replies.map(e=>({...e,isUnread:!1}))});let E={...d},u=-1;if("inline"===r){let t=[...c.map(e=>e.threadKey)];Object.entries(E.inline).forEach(([e,n])=>{let a=parseInt(e,10);t.splice(a,0,n)}),u=t.findIndex(t=>t===e)}else u=Object.keys(m.general).findIndex(t=>t===e);-1!==u&&(E[r][u]=e),s({commentsDataMap:l,removedThreadsMap:E})}}let c={...m};c[t]=n,s({commentThreadsRemovedByOtherUsers:c})},handleRemovingComments:({threadKey:e,commentId:t,action:n,commentType:a})=>({setState:r,getState:i})=>{let{commentsDataMap:o}=i(),s={...o},E=s[a][e];if(E){if("resolved"===n&&E.id===t)delete s[a][e],r({commentsDataMap:s});else if("deleted"===n){let n=E.replies.filter(e=>e.id!==t);s[a][e]={...E,replies:n},r({commentsDataMap:s})}}},resolveParentComment:({threadKey:e,commentType:t})=>({setState:n,getState:a})=>{let{commentsDataMap:r}=a(),i={...r},o=i[t][e];o&&(o.isOpen=!1,n({commentsDataMap:i}))},reopenParentComment:({threadKey:e,commentType:t})=>({setState:n,getState:a})=>{let{commentsDataMap:r,commentThreadsRemovedByOtherUsers:i}=a(),o={...r},s=o[t][e];if(s){s.isOpen=!0;let e={...i};delete e[s.id],n({commentsDataMap:o,commentThreadsRemovedByOtherUsers:e})}},deleteParentComment:({threadKey:e,commentType:t})=>({setState:n,getState:a})=>{let{commentsDataMap:r}=a(),i={...r};i[t][e]&&(delete i[t][e],n({commentsDataMap:i}))},clearRemovedComments:()=>({getState:e,setState:t})=>{let{commentsDataMap:n}=e(),a={...n};t({removedThreadsMap:{inline:{},general:{}},commentThreadsRemovedByOtherUsers:{},commentsDataMap:{inline:Object.fromEntries(Object.entries(a.inline).filter(([e,t])=>!t.wasRemovedByAnotherUser).map(([e,t])=>[e,{...t,replies:(t.replies||[]).filter(e=>!e.wasRemovedByAnotherUser)}])),general:Object.fromEntries(Object.entries(a.general).filter(([e,t])=>!t.wasRemovedByAnotherUser).map(([e,t])=>[e,{...t,replies:(t.replies||[]).filter(e=>!e.wasRemovedByAnotherUser)}]))}})},clearCommentsData:()=>({setState:e})=>{e(u())},setCacheUpdateFailed:e=>({setState:t})=>{t({cacheUpdateFailed:e})}},name:"CommentsDataStore"}),_=(0,i("9zUhf").createHook)(I),C=(0,i("9zUhf").createActionsHook)(I),T=(0,i("9zUhf").createStateHook)(I);t.exports.CommentType=c,t.exports.UnreadAction=d,t.exports.CommentActionType=l,t.exports.FooterCommentsLoadingStateType=p,t.exports.useCommentsData=_,t.exports.useCommentsDataActions=C,t.exports.useCommentsDataState=T}),o("eg9xl",function(e,t){let n=i("b1hSc").default;e.exports.ActiveCommentsQuery=n}),o("3ZsvI",function(e,t){let n=({comment:e,readCommentsListState:t,currentUserId:n,annotationsInEditorDoc:a,pageMode:r,isOpen:o,type:s})=>{let E=!!(0,i("2GXr2").isValidUnreadComment)({comment:e,viewedComments:t,userId:n,annotationsInEditorDoc:a,pageMode:r});return{...e,isUnread:E,wasRemovedByAnotherUser:!1,isOpen:o,type:s,replies:e.replies?.map(e=>{e.reactionsSummary||(e.reactionsSummary=null);let o=!!(0,i("2GXr2").isValidUnreadComment)({comment:e,viewedComments:t,userId:n,annotationsInEditorDoc:a,pageMode:r});return{...e,type:s,isUnread:o,wasRemovedByAnotherUser:!1}})}};e.exports.normalizeCommentData=n,e.exports.updateCommentsDataState=({data:e,readCommentsListState:t,annotationsInEditorDoc:a,pageMode:r,currentUserId:o,updateData:s,isOpen:E=!0})=>{let m={},c={},d=!(0,i("9wGTI").fg)("confluence_comment_footercomments_editpage")||r!==i("cD1qu").PageMode.EDIT;e?.comments?.nodes?.forEach(e=>{if(e&&!e.parentId){if(e.reactionsSummary||(e.reactionsSummary=null),e.contentStatus===i("cD1qu").ContentStatus.DRAFT&&r===i("cD1qu").PageMode.VIEW&&(0,i("9wGTI").fg)("confluence_frontend_content_wrapper"))return;let s=e.location.type;if("INLINE"===s){let s=e.location.inlineMarkerRef;s&&(m[s]=n({comment:e,readCommentsListState:t,currentUserId:o,annotationsInEditorDoc:a,pageMode:r,isOpen:E,type:i("8i27m").CommentType.INLINE}))}else"FOOTER"===s&&d&&(c[e.id]=n({comment:e,readCommentsListState:t,currentUserId:o,pageMode:r,isOpen:E,type:i("8i27m").CommentType.GENERAL}))}}),s({inline:m,general:c})},e.exports.parseHasNestedComments=e=>{try{return Object.values(e.general).some(e=>e?.replies?.some(t=>t.parentId!==e.id))}catch{return!1}},e.exports.updateFooterCommentsLoadingState=(e,t)=>{if(e?.comments?.totalCount===void 0)return void t(i("8i27m").FooterCommentsLoadingStateType.NOT_LOADED);t((e?.comments?.nodes?.reduce((e,t)=>e+(t?.replies?.length||0)+1,0)??0)===e?.comments?.totalCount?i("8i27m").FooterCommentsLoadingStateType.FULLY_LOADED:i("8i27m").FooterCommentsLoadingStateType.PARTIALLY_LOADED)}}),o("2GXr2",function(e,t){var n;(n={}).INLINE="inline",n.GENERAL="general";let a=({comment:e,viewedComments:t,userId:n,annotationsInEditorDoc:a,pageMode:r="view"})=>{let i=!t.has(e.id),o=e?.location,s=!o?.inlineResolveProperties?.resolved,E="accountId"in e.author&&e.author?.accountId!==n,m=new Date(e.createdAt?.value)>new Date(Date.now()-2592e6),c=o?.inlineMarkerRef,d="edit"!==r||c&&a?.has(c),l=e?.location.type==="FOOTER";return i&&s&&E&&m&&(l||c&&d)},r=async({allComments:e,updateUnreadCommentsListState:t,userId:n,pageId:r,updateReadCommentsListState:o,updateThreadKeyToCommentIdMap:s,resetStates:E,pageMode:m="view",annotationsInEditorDoc:c})=>{if(e&&e.some(e=>!e?.location?.inlineResolveProperties?.resolved)&&r)try{let d=await (0,i("hp2SH").getApolloClient)().query({query:i("kaMMU").ContentAnalyticsViewedComments,variables:{contentId:r},fetchPolicy:"network-only"}),l=new Set(d?.data?.contentAnalyticsViewedComments?.commentIds);o(()=>l);let p=[],u={};e.forEach(e=>{if(!e)return;let t="INLINE"===e.location.type?"inline":"general",r="inline"===t?e.location?.inlineMarkerRef:e.id;n&&r&&(a({comment:e,viewedComments:l,userId:n,annotationsInEditorDoc:c,pageMode:m})&&p.push({id:e.id,threadKey:r??"",commentType:t}),e.replies&&e.replies.forEach(e=>{e&&(a({comment:e,viewedComments:l,userId:n,annotationsInEditorDoc:c,pageMode:m})&&p.push({id:e.id,threadKey:r??"",commentType:t}),u[r]?u[r]&&u[r].add(e.id):u[r]=new Set([e.id]))}))}),s(e=>{let t={...e};return Object.keys(u).forEach(e=>{t[e]?t[e]=new Set([...t[e],...u[e]]):t[e]=u[e]}),t}),t(()=>p),E()}catch{E()}};e.exports.isValidUnreadComment=a,e.exports.createUnreadCommentList=r}),o("kaMMU",function(e,t){let n=(0,i("eSUdr").default)`query ContentAnalyticsViewedComments($contentId:ID!){contentAnalyticsViewedComments(contentId:$contentId){commentIds}}`;e.exports.ContentAnalyticsViewedComments=n}),o("gczDe",function(e,t){let n;e.exports.getRendererAnnotationEventEmitter=()=>(n||(n=new(0,i("cVw8q").AnnotationUpdateEmitter)),n)}),o("cVw8q",function(e,t){var n=i("5rDjV");class a extends n.EventEmitter{on(e,t){return super.on(e,t)}off(e,t){return super.removeListener(e,t)}}e.exports.AnnotationUpdateEmitter=a,e.exports.createAnnotationManager=function(){return new(0,i("fdq1c").SharedAnnotationManager)}}),o("fdq1c",function(e,t){var n=i("5rDjV");e.exports.SharedAnnotationManager=class{setPreemptiveGate(e){return this.preemptiveGate=e,this}checkPreemptiveGate(){return this.activePreemptiveGate?Promise.resolve(this.activePreemptiveGate):this.activePreemptiveGate=this.preemptiveGate().then(e=>(this.activePreemptiveGate=void 0,e))}onDraftAnnotationStarted(e){return this.emitter.on("draftAnnotationStarted",e),this}offDraftAnnotationStarted(e){return this.emitter.off("draftAnnotationStarted",e),this}onAnnotationSelectionChange(e){return this.emitter.on("annotationSelectionChanged",e),this}offAnnotationSelectionChange(e){return this.emitter.off("annotationSelectionChanged",e),this}emit(e){return this.emitter.emit(e.name,e.data),this}hook(e,t){return this.hooks.set(e,t),this}unhook(e,t){return this.hooks.has(e)&&this.hooks.get(e)===t&&this.hooks.delete(e),this}allowAnnotation(){let e=this.hooks.get("allowAnnotation");if(!e)return!1;try{return e()}catch(e){return!1}}startDraft(){let e=this.hooks.get("startDraft");if(!e)return{success:!1,reason:"manager-not-initialized"};try{return e()}catch(e){return{success:!1,reason:"hook-execution-error"}}}clearDraft(){let e=this.hooks.get("clearDraft");if(!e)return{success:!1,reason:"manager-not-initialized"};try{return e()}catch(e){return{success:!1,reason:"hook-execution-error"}}}applyDraft(e){let t=this.hooks.get("applyDraft");if(!t)return{success:!1,reason:"manager-not-initialized"};try{return t(e)}catch(e){return{success:!1,reason:"hook-execution-error"}}}getDraft(){let e=this.hooks.get("getDraft");if(!e)return{success:!1,reason:"manager-not-initialized"};try{return e()}catch(e){return{success:!1,reason:"hook-execution-error"}}}setIsAnnotationSelected(e,t){let n=this.hooks.get("setIsAnnotationSelected");if(!n)return{success:!1,reason:"manager-not-initialized"};try{return n(e,t)}catch(e){return{success:!1,reason:"hook-execution-error"}}}setIsAnnotationHovered(e,t){let n=this.hooks.get("setIsAnnotationHovered");if(!n)return{success:!1,reason:"manager-not-initialized"};try{return n(e,t)}catch(e){return{success:!1,reason:"hook-execution-error"}}}clearAnnotation(e){let t=this.hooks.get("clearAnnotation");if(!t)return{success:!1,reason:"manager-not-initialized"};try{return t(e)}catch(e){return{success:!1,reason:"hook-execution-error"}}}constructor(){this.emitter=new(0,n.EventEmitter),this.hooks=new Map,this.preemptiveGate=()=>Promise.resolve(!0),this.activePreemptiveGate=void 0}}}),o("gfqXk",function(e,t){let n;e.exports.getEditorAnnotationEventEmitter=()=>(n||(n=new(0,i("cVw8q").AnnotationUpdateEmitter)),n)}),o("htsj6",function(e,t){let n=({skip:e=!1}={},t=!0)=>{let n,[a]=(0,i("ep3mz").usePageContentId)(),r=i("2PDpU").default,o={skip:e||!a,variables:{contentId:a??""}},{data:s,loading:E,error:m}=n=t?(0,i("jMyy4").useQueryInterop)(r,o):(0,i("jtuBN").useQueryNoFurtherUpdateInterop)(r,o),c=s?.content?.nodes?.[0];return{contentStatus:c?.status,loading:E,error:m,refetch:n.refetch,type:c?.type}};e.exports.useContentStatus=(e={})=>(0,i("9wGTI").fg)("stop_watching_more_queries")?n(e,!1):n(e,!0),e.exports.useContentStatusWithRefetch=n}),o("2PDpU",function(e,t){var n,a;let r={fragment:{argumentDefinitions:n=[{defaultValue:null,kind:"LocalArgument",name:"contentId"}],kind:"Fragment",name:"useContentStatusContentStatusQuery",selections:a=[{args:[{kind:"Variable",name:"id",variableName:"contentId"},{kind:"Literal",name:"status",value:["current","draft","archived"]}],concreteType:"PaginatedContentListWithChild",kind:"LinkedField",name:"content",plural:!1,selections:[{concreteType:"Content",kind:"LinkedField",name:"nodes",plural:!0,selections:[{kind:"ScalarField",name:"id"},{kind:"ScalarField",name:"status"},{kind:"ScalarField",name:"type"}]}]}],type:"Query"},kind:"Request",operation:{argumentDefinitions:n,kind:"Operation",name:"useContentStatusContentStatusQuery",selections:a},params:{cacheID:"11ef6cf70fe5a26f89cf732fe25cb27f",id:"3f9fb295906ce3d568914d192655c22003c1f01326d83359089f2ceb66026cc5",metadata:{},name:"useContentStatusContentStatusQuery",operationKind:"query",text:'query useContentStatusContentStatusQuery($contentId:ID!){content(id:$contentId,status:["current","draft","archived"]){nodes{id,status,type}}}'}};r.hash="42fd7c46b2fddcc220c48467ae805b6e",e.exports.default=r}),o("4EKKB",function(e,t){let n={};function a(e,t){return function({error:e,createAnalyticsEvent:a,extraAttributes:r}){(0,i("fGzMp").getExperienceTracker)().attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`Legacy select debug message: ${e.message||String(e)}`,attributes:{...n,...r,experienceStage:t}})}}var r,o=((r=o||{}).DOCUMENT="document",r.DOCUMENT_WITH_PANEL="documentWithPanel",r.PANEL="panel",r);let s={_start:(e,t)=>{if("not-page-or-doc"===e.pageClass)return;let a=(0,i("fGzMp").getExperienceTracker)(),r=a.getExperienceState(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE),o=r?.attributes;if(!r?.hasStopped&&o?.annotationId!==void 0&&o?.annotationId===e.annotationId){o?.entryPoint?.startsWith("unknown")&&!e.entryPoint.startsWith("unknown")&&(s.addCommonAttributes({entryPoint:e.entryPoint}),a.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`After starting from ${o.entryPoint}, received signal from ${e.entryPoint}`}));return}if("unknown:CommentsPanelList"===e.entryPoint&&o?.entryPoint==="keyboard-navigation"&&o?.annotationId===void 0){s.addCommonAttributes({annotationId:e.annotationId}),a.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`After starting from ${o.entryPoint}, received signal from ${e.entryPoint} with annotationId ${e.annotationId}`});return}let E={pageClass:e.pageClass,commentType:e.commentType,annotationId:"annotationId"in e?e.annotationId:void 0,entryPoint:e.entryPoint,version:"single-experience"};E.sidebarOpenAtStart=null!==document.querySelector('[data-testid="object-sidebar-panel-body"]'),E.experienceType=function(e,t){switch(e){case"create-comment":case"comment-navigation":case"unknown:InlineComment":default:return"document";case"annotation-change":case"keyboard-navigation":case"unknown:RendererFocus":return t?"documentWithPanel":"document";case"sidebar":case"unknown:CommentsPanelList":return"panel"}}(e.entryPoint,E.sidebarOpenAtStart);let m=a.getExperienceState(i("irVI7").CREATE_INLINE_COMMENT_EXPERIENCE);m&&!m.hasStopped&&(E.linkedCompoundTaskId=m.attributes?.compoundTaskId),a.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`Restarted from ${e.entryPoint} with annotationId: ${e.annotationId} (sidebarOpenAtStart: ${E.sidebarOpenAtStart})`}),(0,i("8Ss4E").startUFOPressTrace)(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE),a.start({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:{...E,...(0,i("gtj7V").getCommentsDataManagerExperimentAttributes)()},timeout:i("aJPUt").ExperienceTimeout.SELECT_INLINE_COMMMENT,collect:e=>{let t=e=>e.name===i("irVI7").RESOLVE_INLINE_COMMENT_EXPERIENCE&&"taskStart"===e.action&&(0,i("gykrH").hasAttribute)(e,"annotationId",n.annotationId);e.forEach(e=>{t(e)&&s.abort({abortReason:"Comment being resolved"})})}}),void 0===e.annotationId?a.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`selectInlineCommentCompoundExperience._start started from ${e.entryPoint} with unknown annotationId`}):a.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:`selectInlineCommentCompoundExperience._start started from ${e.entryPoint} with annotationId ${e.annotationId}`}),n={...E,...(0,i("gtj7V").getCommentsDataManagerExperimentAttributes)()};let c=a.getExperienceState(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE)?.attributes?.contentId;n.originalContentId=c,a.updateAttributes({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:{originalContentId:c}})},debugPoint:(e,t)=>{let n=(0,i("fGzMp").getExperienceTracker)();n.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:e,attributes:t}),n.attachDebugPoint({name:i("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,message:e,attributes:t})},addCommonAttributes:e=>{let t=(0,i("fGzMp").getExperienceTracker)();n={...n,...e},t.updateAttributes({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:e})},abort:({abortReason:e})=>{(0,i("fGzMp").getExperienceTracker)().abort({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,reason:e,checkForTimeout:!0}),n={}},selectAnnotation:{debug:a(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,"selectAnnotation"),start:e=>{if("keyboard-navigation"===e.entryPoint||"comment-navigation"===e.entryPoint)return void s._start(e,{annotationUnknown:!0});s._start(e)},abort:({abortReason:e})=>{s.abort({abortReason:e}),n={}},complete:e=>{let t=(0,i("fGzMp").getExperienceTracker)();null===t.getExperienceState(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE)&&(t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"selectAnnotation completed from no experience - no explicit start point",attributes:e}),s._start(e))}},showComment:{debug:a(i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,"showComment"),debugPoint:(e,t)=>{(0,i("fGzMp").getExperienceTracker)().attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:e,attributes:t})},start:e=>{let t=(0,i("fGzMp").getExperienceTracker)();s._start(e),t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"showComment start triggered",attributes:e})},abort:({abortReason:e})=>{(0,i("fGzMp").getExperienceTracker)().abort({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,reason:e}),n={}},fail:(e,t)=>{(0,i("fGzMp").getExperienceTracker)().fail({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,error:e,attributes:{...n,...t}}),n={}},complete:e=>{(0,i("fGzMp").getExperienceTracker)().succeed({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:{completedFrom:e,...n}}),n={}},standaloneSidebarComplete:e=>{let t=(0,i("fGzMp").getExperienceTracker)();if(t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"standaloneSidebarComplete triggered"}),e>40&&t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"Comment UI is misaligned by >40px pixels",attributes:{misalignedBy:e}}),"string"!=typeof n.annotationId)return void t.fail({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,error:Error("selectInlineCommentCompoundExperience.standaloneSidebarComplete called when no annotationId was known"),attributes:n});E(n.annotationId)||t.fail({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,error:Error("selectInlineCommentCompoundExperience.standaloneSidebarComplete ended without a focused and in viewport annotation."),attributes:n}),t.succeed({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:{completedFrom:"Standalone sidebar inline comment selection completed",...n}})},sidePanelComplete:()=>{let e=(0,i("fGzMp").getExperienceTracker)();if(e.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"sidePanelComplete triggered"}),"string"!=typeof n.annotationId)return void e.fail({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,error:Error("selectInlineCommentCompoundExperience.sidePanelComplete called when no annotationId was known"),attributes:n});E(n.annotationId)||e.fail({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,error:Error("selectInlineCommentCompoundExperience.sidePanelComplete did not result in a visible and focused annotation"),attributes:n}),e.succeed({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,attributes:{completedFrom:"Side Panel inline comment selection completed",...n}})}}};function E(e){let t=(0,i("fGzMp").getExperienceTracker)(),n=document.querySelectorAll(`[data-id="${e}"][data-mark-annotation-type="inlineComment"][data-has-focus="true"],
		[data-id="${e}"][data-mark-annotation-type="inlineComment"] .ak-editor-annotation-focus`);if(0===n.length)return t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"No annotation element found"}),!1;for(let e=0;e<n.length;e++){let a=n[e];if(a instanceof HTMLElement){if(!a.checkVisibility()){t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"Annotation element had a hidden focused element, skipping to next element"});continue}let e=a.getBoundingClientRect();if(e.top>=0&&e.left>=0&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth))return!0;t.attachDebugPoint({name:i("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE,message:"Annotation element found - but not in viewport"});break}}return!1}let m={debug:s.debugPoint};e.exports.selectInlineCommentCompoundExperience=s,e.exports.selectInlineComment=m}),o("cMvMc",function(e,t){let n=(0,i("jmjWc").LoadableBackground)({__loadable_id__:"_Vqh0",name:"CommentWarningDialog",loader:async()=>(await i("8FCWK")).CommentWarningDialog});e.exports.CommentWarningDialog=n}),o("8FCWK",function(e,t){let n=i("4mJKd")(5);e.exports=Promise.all([n("hhss7"),n("cqNU4")]).then(()=>i("9c4UU"))}),o("4mJKd",function(e,t){e.exports=e=>t=>import(i("8tirZ").shardUrl(i("02nRr").resolve(t),e))}),o("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=o,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=a,e.exports.shardUrl=function(e,t){return globalThis[n]?s(e,t):e},e.exports.shardUrlUnchecked=s;let n="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function a(e,t){let n=t+1,a=e.split("").reduce((e,t)=>{let a=(e<<n)-e+t.charCodeAt(0);return a&a},0);return(a%=n)<0&&(a+=n),a}let r=/-\d+$/;function i(e){if(!r.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function o(e,t){let n=e.indexOf("."),a=0===t?"":`-${t-1}`;if(-1===n)return`${i(e)}${a}`;let r=i(e.slice(0,n));return`${r}${a}${e.slice(n)}`}function s(e,t){let n=new URL(e),r=a(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(n.pathname),t);return n.hostname=o(n.hostname,r),n.toString()}e.exports.domainShardingKey=n}),o("02nRr",function(e,n){t(e.exports,"register",()=>a,e=>a=e),t(e.exports,"resolve",()=>r,e=>r=e);var a,r,i=new Map;a=function(e,t){for(var n=0;n<t.length-1;n+=2)i.set(t[n],{baseUrl:e,path:t[n+1]})},r=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),o("bSvtO",function(e,t){let n=(0,i("1P1Tu").createStore)({initialState:{hasContentChanged:!1,isCommentContentReady:!1},actions:{onChange:e=>({setState:t})=>{t({hasContentChanged:e})},resetContentChanged:()=>({setState:e})=>{e({hasContentChanged:!1})},onCommentContentReady:()=>({setState:e})=>{e({isCommentContentReady:!0})}},name:"CommentsContentStore"});(0,i("9zUhf").createHook)(n);let a=(0,i("9zUhf").createActionsHook)(n),r=(0,i("9zUhf").createStateHook)(n);e.exports.useCommentsContentActions=a,e.exports.useCommentsContentState=r}),n.rlb("dLx08");
//# sourceMappingURL=CommentEditor.7978db81.js.map
