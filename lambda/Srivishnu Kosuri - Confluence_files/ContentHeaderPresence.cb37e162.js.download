function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,a){Object.defineProperty(e,t,{get:n,set:a,enumerable:!0,configurable:!0})}var n=globalThis.parcelRequired477,a=n.register;a("bLtXM",function(t,a){var o,r=n("3u0dr"),i=n("frIzR"),s=n("42omo"),l=n("4PPzL"),c=n("9HkI0");let d=e=>e?(0,n("jyw2s").getParticipantColor)(e).color:n("aFUXX").participantColors[0],u=()=>({textColor:"var(--ds-text-inverse, #FFFFFF)",backgroundColor:"var(--ds-background-accent-blue-bolder, #1868DB)",svgBackgroundColor:"var(--ds-background-accent-blue-subtler, #CFE1FD)"}),p=(e,t)=>{if(t)return[...e.values()].find(e=>e.sessions[t])},f=(e,t,n)=>t?e[t]?.activity??n??"viewer":Object.keys(e).find(t=>e[t]?.activity==="editor")?"editor":"viewer",g=()=>{let e="collab-presence-confluence";if("localhost"===window.location.hostname){let t=window.__backendOriginHost;return`https://${t}/${e}`}return`${window.location.origin}/${e}`},m=(e,t)=>{let a="";return((0,n("T9xHm").isIsolatedCloud)()&&(0,n("6mKj3").expVal)("platform_editor_use_pmr_for_collab_presence_in_ic","isEnabled",!1)||!(0,n("T9xHm").isIsolatedCloud)()&&(0,n("6mKj3").expVal)("platform_editor_use_pmr_for_collab_presence_non_ic","isEnabled",!1))&&(a=`/ncs-presence/${e}/${t}/confluence`),a},h=["database","whiteboard"],E=e=>h.includes(e),v=()=>`presence-${(0,c.v4)()}`,b="dummy-session-id",y="unidentified",I=(0,n("1P1Tu").createStore)({initialState:{participants:new Map,telepointers:new Map},actions:{add:e=>({getState:t,setState:n})=>{let{participants:a}=t(),{presenceId:o}=e,r=new Map(a);if(o){let t=r.get(o),a={id:o,userId:e.userId,presenceId:e.presenceId,name:e.name,isGuest:e.isGuest,isCurrentUser:!!t?.isCurrentUser,src:e.avatar,sessions:{...t?.sessions,[e.sessionId]:{activity:e.presenceActivity??"viewer"}}};r.set(o,a),n({participants:r})}else console.error("presenceId is null for participant when it shouldn't be for ",e)},remove:e=>({getState:t,setState:n})=>{let{participants:a}=t(),o=new Map(a),r=p(a,e);r?(1===Object.keys(r.sessions).length?o.delete(r.id):(delete r.sessions[e],o.set(r.id,r)),n({participants:o})):console.error("Could not remove participant with sessionId of ",e)},addTelepointerData:e=>({setState:t,getState:n})=>{let a=n(),o=p(a.participants,e.sessionId);if(o?.isCurrentUser)return;let r=new Map(a.telepointers);r.set(e.sessionId,{...e,timestamp:Date.now()}),t({telepointers:r})}},name:"PresenceStore"});(0,n("9zUhf").createHook)(I);let C=(0,n("9zUhf").createActionsHook)(I),S=(0,n("9zUhf").createStateHook)(I,{selector:e=>e.participants}),T=(0,n("9zUhf").createStateHook)(I,{selector:(e,t)=>{let{participants:a}=e,o=p(a,t.sessionId),r=[...a.values()].filter(e=>e.presenceId!==o?.presenceId);return o&&r.unshift(o),r.map(e=>{let a=e.userId===y,r=a?e.name||t.anonymousName:e.name;return{...e,participantColor:a?(0,n("jyw2s").getParticipantColor)(e.id).color.backgroundColor:void 0,isCurrentUser:e.isCurrentUser||e.id===o?.id,name:r,activity:e.isCurrentUser&&o?f(e.sessions,t.sessionId,t.activity):f(e.sessions)}})}}),_=(0,n("9zUhf").createHook)(I,{selector:(e,t)=>Object.keys(t).map(t=>e.telepointers.get(t)).filter(e=>!!e).sort((e,t)=>t?.timestamp-e?.timestamp)?.[0]}),x=(0,n("FOT9i").createContainer)(I,{onInit:()=>({setState:e},{participant:t,fetchAnonymousAsset:n,onError:a})=>{if(t){let o=new Map;t.userId===y?n(t.presenceId).then(e=>{o.set(t.id,{...t,src:e?.src||t.src,name:e?.name||t.name})}).catch(a).finally(()=>{e({participants:o})}):(o.set(t.id,{...t}),e({participants:o}))}else e({participants:new Map})}});var k=n("5ig3T");function A(){return(A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)t.indexOf(n=r[a])>=0||(o[n]=e[n]);return o}var D=(0,s.createContext)({}),P=(0,s.createContext)("portal"),O=function(t){function n(){for(var e,n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))||this).inProgressAnimations={},e.flipCallbacks={},e.el=void 0,e}n.prototype=Object.create(t.prototype),n.prototype.constructor=n,w(n,t);var a=n.prototype;return a.getSnapshotBeforeUpdate=function(e){return e.flipKey!==this.props.flipKey&&this.el?(0,k.getFlippedElementPositionsBeforeUpdate)({element:this.el,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations,portalKey:this.props.portalKey}):null},a.componentDidUpdate=function(e,t,n){this.props.flipKey!==e.flipKey&&this.el&&(0,k.onFlipKeyUpdate)({flippedElementPositionsBeforeUpdate:n.flippedElementPositions,cachedOrderedFlipIds:n.cachedOrderedFlipIds,containerEl:this.el,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.props.applyTransformOrigin,spring:this.props.spring,debug:this.props.debug,portalKey:this.props.portalKey,staggerConfig:this.props.staggerConfig,handleEnterUpdateDelete:this.props.handleEnterUpdateDelete,decisionData:{previous:e.decisionData,current:this.props.decisionData},onComplete:this.props.onComplete,onStart:this.props.onStart})},a.render=function(){var t=this,n=this.props,a=n.portalKey,o=e(s).createElement(D.Provider,{value:this.flipCallbacks},e(s).createElement(n.element,{className:n.className,ref:function(e){return t.el=e}},this.props.children));return a&&(o=e(s).createElement(P.Provider,{value:a},o)),o},n}(s.Component);O.defaultProps={applyTransformOrigin:!0,element:"div"};var R=["children","flipId","inverseFlipId","portalKey"],L=["children","flipId","shouldFlip","shouldInvert","onAppear","onStart","onStartImmediate","onComplete","onExit","onSpringUpdate"],B=function(e){var t,n=e.children,a=e.flipId,o=e.inverseFlipId,r=e.portalKey,i=M(e,R),l=n,c="function"==typeof l;if(!c)try{l=s.Children.only(n)}catch(e){throw Error("Each Flipped component must wrap a single child")}i.scale||i.translate||i.opacity||k.utilities.assign(i,{translate:!0,scale:!0,opacity:!0});var d=((t={})[k.constants.DATA_FLIP_CONFIG]=JSON.stringify(i),t);return void 0!==a?d[k.constants.DATA_FLIP_ID]=String(a):o&&(d[k.constants.DATA_INVERSE_FLIP_ID]=String(o)),void 0!==r&&(d[k.constants.DATA_PORTAL_KEY]=r),c?l(d):(0,s.cloneElement)(l,d)},U=function(t){var n=t.children,a=t.flipId,o=t.shouldFlip,r=t.shouldInvert,i=t.onAppear,l=t.onStart,c=t.onStartImmediate,d=t.onComplete,u=t.onExit,p=t.onSpringUpdate,f=M(t,L);return n?f.inverseFlipId?e(s).createElement(B,A({},f),n):e(s).createElement(P.Consumer,null,function(t){return e(s).createElement(D.Consumer,null,function(g){return k.utilities.isObject(g)&&a&&(g[a]={shouldFlip:o,shouldInvert:r,onAppear:i,onStart:l,onStartImmediate:c,onComplete:d,onExit:u,onSpringUpdate:p}),e(s).createElement(B,A({flipId:a},f,{portalKey:t}),n)})}):null};U.displayName="Flipped";var N=n("lgKMU");let F=(e,t,a,o)=>!!t&&!a&&!(e.length>=4)&&!o&&!!(0,n("6mKj3").expValEquals)("collab_in_team_presence_exp","cohort","variation"),V=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u=(0,i.c)(24),{contentId:p,contentMode:f,contentType:g,pageMode:m,spaceKey:h,copyLinkButtonLabel:E,shareButtonLabel:v,isShareButtonDisabled:b,onShareClick:y}=t,{createAnalyticsEvent:I}=(0,n("inPa6").useAnalyticsEvents)();u[0]!==y?(a=e=>{y&&y("noCollaboratorsDialog")},u[0]=y,u[1]=a):a=u[1];let C=a;return u[2]!==f||u[3]!==g||u[4]!==I?(o=()=>{I({type:"sendScreenEvent",data:{name:"noCollaboratorsDialogShareOptions",attributes:{contentMode:f,contentType:g}}}).fire()},u[2]=f,u[3]=g,u[4]=I,u[5]=o):o=u[5],u[6]!==f||u[7]!==g||u[8]!==I||u[9]!==m?(r=[I,f,g,m],u[6]=f,u[7]=g,u[8]=I,u[9]=m,u[10]=r):r=u[10],(0,s.useEffect)(o,r),u[11]!==p||u[12]!==g||u[13]!==E||u[14]!==m||u[15]!==h?(l=e(s).createElement(n("hkzol").CopyLinkButton,{buttonAppearance:"subtle",buttonText:E,contentId:p,contentType:g,pageMode:m,spaceKey:h,source:"noCollaboratorsDialog"}),u[11]=p,u[12]=g,u[13]=E,u[14]=m,u[15]=h,u[16]=l):l=u[16],u[17]!==b||u[18]!==C||u[19]!==v?(c=e(s).createElement(n("ccHMk").default,{testId:"open-share-dialog",appearance:"default",onClick:C,isDisabled:b},v),u[17]=b,u[18]=C,u[19]=v,u[20]=c):c=u[20],u[21]!==l||u[22]!==c?(d=e(s).createElement(n("gdv5Z").default,{padding:"space.200",paddingBlockStart:"space.400"},e(s).createElement(n("u9agA").default,{alignInline:"end"},e(s).createElement(n("hArLp").default,null,l,c))),u[21]=l,u[22]=c,u[23]=d):d=u[23],d}:({contentId:t,contentMode:a,contentType:o,pageMode:r,spaceKey:i,copyLinkButtonLabel:l,shareButtonLabel:c,isShareButtonDisabled:d,onShareClick:u})=>{let{createAnalyticsEvent:p}=(0,n("inPa6").useAnalyticsEvents)(),f=(0,s.useCallback)(e=>{u&&u("noCollaboratorsDialog")},[u]);return(0,s.useEffect)(()=>{p({type:"sendScreenEvent",data:{name:"noCollaboratorsDialogShareOptions",attributes:{contentMode:a,contentType:o}}}).fire()},[p,a,o,r]),e(s).createElement(n("gdv5Z").default,{padding:"space.200",paddingBlockStart:"space.400"},e(s).createElement(n("u9agA").default,{alignInline:"end"},e(s).createElement(n("hArLp").default,null,e(s).createElement(n("hkzol").CopyLinkButton,{buttonAppearance:"subtle",buttonText:l,contentId:t,contentType:o,pageMode:r,spaceKey:i,source:"noCollaboratorsDialog"}),e(s).createElement(n("ccHMk").default,{testId:"open-share-dialog",appearance:"default",onClick:f,isDisabled:d},c))))},j=(0,n("cgtv4").defineMessages)({blogpostViewing:{id:"team-presence.menu.empty-state.blogpost.viewing",defaultMessage:"You’re the only one viewing this blog post."},blogpostEditing:{id:"team-presence.menu.empty-state.blogpost.editing",defaultMessage:"You’re the only one editing this blog post."},pageViewing:{id:"team-presence.menu.empty-state.page.viewing",defaultMessage:"You’re the only one viewing this page."},pageEditing:{id:"team-presence.menu.empty-state.page.editing",defaultMessage:"You’re the only one editing this page."},shareItWithOthersText:{id:"team-presence.menu.empty-state.share-it-with-others",defaultMessage:"Share it with others who might be interested."},publishToShareItWithOthersText:{id:"team-presence.menu.empty-state.publish-to-share-it-with-others",defaultMessage:"Publish it to share with others who might be interested."},copyLinkButtonText:{id:"team-presence.menu.empty-state.copy-button",defaultMessage:"Copy link"},sharePageButtonText:{id:"team-presence.menu.empty-state.page.share-button",defaultMessage:"Share page"},shareBlogPostButtonText:{id:"team-presence.menu.empty-state.blogpost.share-button",defaultMessage:"Share blog post"},sharePageButtonClickedText:{id:"team-presence.menu.empty-state.page.share-button.clicked",defaultMessage:"Page shared"},shareBlogPostButtonClickedText:{id:"team-presence.menu.empty-state.blogpost.share-button.clicked",defaultMessage:"Blog post shared"},whiteboardModalDescription:{id:"team-presence.menu.empty-state.whiteboard",defaultMessage:"You’re the only one on this whiteboard."},shareWhiteboardButtonText:{id:"team-presence.menu.empty-state.whiteboard.share-button",defaultMessage:"Share whiteboard"},shareWhiteboardButtonClickedText:{id:"team-presence.menu.empty-state.whiteboard.share-button.clicked",defaultMessage:"Whiteboard shared"},databaseModalDescription:{id:"team-presence.menu.empty-state.database",defaultMessage:"You’re the only one on this database."},shareDatabaseButtonText:{id:"team-presence.menu.empty-state.database.share-button",defaultMessage:"Share database"},shareDatabaseButtonClickedText:{id:"team-presence.menu.empty-state.database.share-button.clicked",defaultMessage:"Database shared"},liveDocViewingModalDescription:{id:"team-presence.menu.empty-state.live-doc.viewing",defaultMessage:"You’re the only one viewing this live doc."},liveDocEditingModalDescription:{id:"team-presence.menu.empty-state.live-doc.editing",defaultMessage:"You’re the only one editing this live doc."},shareLiveDocButtonText:{id:"team-presence.menu.empty-state.live-doc.share-button",defaultMessage:"Share live doc"},shareLiveDocButtonClickedText:{id:"team-presence.menu.empty-state.live-doc.share-button.clicked",defaultMessage:"Live doc shared"}}),K=(e,t,n)=>({blogpost:{modalDescriptionLineOne:e("edit"===t?j.blogpostEditing:j.blogpostViewing),modalDescriptionLineTwo:e(n?j.publishToShareItWithOthersText:j.shareItWithOthersText),shareButtonText:e(j.shareBlogPostButtonText),shareButtonClickedText:e(j.shareBlogPostButtonClickedText)},page:{modalDescriptionLineOne:e("edit"===t?j.pageEditing:j.pageViewing),modalDescriptionLineTwo:e(n?j.publishToShareItWithOthersText:j.shareItWithOthersText),shareButtonText:e(j.sharePageButtonText),shareButtonClickedText:e(j.sharePageButtonClickedText)},whiteboard:{modalDescriptionLineOne:e(j.whiteboardModalDescription),modalDescriptionLineTwo:e(j.shareItWithOthersText),shareButtonText:e(j.shareWhiteboardButtonText),shareButtonClickedText:e(j.shareWhiteboardButtonClickedText)},database:{modalDescriptionLineOne:e(j.databaseModalDescription),modalDescriptionLineTwo:e(j.shareItWithOthersText),shareButtonText:e(j.shareDatabaseButtonText),shareButtonClickedText:e(j.shareDatabaseButtonClickedText)},live:{modalDescriptionLineOne:e("edit"===t?j.liveDocEditingModalDescription:j.liveDocViewingModalDescription),modalDescriptionLineTwo:e(j.shareItWithOthersText),shareButtonText:e(j.shareLiveDocButtonText),shareButtonClickedText:e(j.shareLiveDocButtonClickedText)}}),W=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u=(0,i.c)(25),{contentMode:p,onShareClick:f,contentId:g,contentType:m,spaceKey:h,testId:E}=t,{formatMessage:v}=(0,n("8C5kA").default)(),[b]=(0,n("kM55L").useCollabNetworkStatus)(),{isCollabOffline:y}=b;u[0]!==y?(a=y&&(0,n("6mKj3").expVal)("platform_editor_offline_editing_web","isEnabled",!1)&&!(0,n("9wGTI").fg)("platform_editor_offline_editing_wrapper_override"),u[0]=y,u[1]=a):a=u[1];let I=a,[C]=(0,n("efvKr").useLivePageMode)(),{isEditMode:S}=C,T="edit"===p||"live"===p&&S?"edit":"view";u[2]!==v||u[3]!==I||u[4]!==T?(o=K(v,T,I),u[2]=v,u[3]=I,u[4]=T,u[5]=o):o=u[5];let _=o["page"===m&&"live"===p?"live":m];return u[6]!==_.modalDescriptionLineOne||u[7]!==_.modalDescriptionLineTwo?(r=e(s).createElement(n("gdv5Z").default,{paddingInline:"space.200",paddingBlockStart:"space.200"},_.modalDescriptionLineOne," ",_.modalDescriptionLineTwo),u[6]=_.modalDescriptionLineOne,u[7]=_.modalDescriptionLineTwo,u[8]=r):r=u[8],u[9]!==v?(l=v(j.copyLinkButtonText),u[9]=v,u[10]=l):l=u[10],u[11]!==g||u[12]!==p||u[13]!==m||u[14]!==I||u[15]!==f||u[16]!==T||u[17]!==h||u[18]!==l||u[19]!==_.shareButtonText?(c=e(s).createElement(V,{contentId:g,contentMode:p,contentType:m,pageMode:T,spaceKey:h,copyLinkButtonLabel:l,shareButtonLabel:_.shareButtonText,isShareButtonDisabled:I,onShareClick:f}),u[11]=g,u[12]=p,u[13]=m,u[14]=I,u[15]=f,u[16]=T,u[17]=h,u[18]=l,u[19]=_.shareButtonText,u[20]=c):c=u[20],u[21]!==r||u[22]!==c||u[23]!==E?(d=e(s).createElement(n("eyWa4").default,{testId:E},r,c),u[21]=r,u[22]=c,u[23]=E,u[24]=d):d=u[24],d}:({contentMode:t,onShareClick:a,contentId:o,contentType:r,spaceKey:i,testId:l})=>{let{formatMessage:c}=(0,n("8C5kA").default)(),[{isCollabOffline:d}]=(0,n("kM55L").useCollabNetworkStatus)(),u=d&&(0,n("6mKj3").expVal)("platform_editor_offline_editing_web","isEnabled",!1)&&!(0,n("9wGTI").fg)("platform_editor_offline_editing_wrapper_override"),[{isEditMode:p}]=(0,n("efvKr").useLivePageMode)(),f="edit"===t||"live"===t&&p?"edit":"view",g=K(c,f,u)["page"===r&&"live"===t?"live":r];return e(s).createElement(n("eyWa4").default,{testId:l},e(s).createElement(n("gdv5Z").default,{paddingInline:"space.200",paddingBlockStart:"space.200"},g.modalDescriptionLineOne," ",g.modalDescriptionLineTwo),e(s).createElement(V,{contentId:o,contentMode:t,contentType:r,pageMode:f,spaceKey:i,copyLinkButtonLabel:c(j.copyLinkButtonText),shareButtonLabel:g.shareButtonText,isShareButtonDisabled:u,onShareClick:a}))};var z=n("b3j2Y"),G=n("59MXn");let H=(0,r.isReactCompilerActiveV1)()?e=>{let t,a,o=(0,i.c)(5),{variables:r,skip:s}=e,l=`/gateway/api/v3/invitations/capabilities?resource=${r.resourceARI}`;return o[0]===Symbol.for("react.memo_cache_sentinel")?(t={"Content-Type":n("aBfpe").MediaType.JSON},o[0]=t):t=o[0],o[1]!==s||o[2]!==l||o[3]!==r?(a={url:l,method:"GET",credentials:"include",headers:t,parseResult:Y,variables:r,skip:s},o[1]=s,o[2]=l,o[3]=r,o[4]=a):a=o[4],(0,n("dK51B").useExperimentalQuery)(a)}:({variables:e,skip:t})=>(0,n("dK51B").useExperimentalQuery)({url:`/gateway/api/v3/invitations/capabilities?resource=${e.resourceARI}`,method:"GET",credentials:"include",headers:{"Content-Type":n("aBfpe").MediaType.JSON},parseResult:e=>{for(let t of e)if(t?.resourceARI?.includes("confluence"))return{experimentalInvitePermissions:{directInviteMode:t?.directInvite?.mode??null,invitePendingApprovalMode:t?.invitePendingApproval?.mode??null}};return{experimentalInvitePermissions:{directInviteMode:null,invitePendingApprovalMode:null}}},variables:e,skip:t});function Y(e){for(let t of e)if(t?.resourceARI?.includes("confluence"))return{experimentalInvitePermissions:{directInviteMode:t?.directInvite?.mode??null,invitePendingApprovalMode:t?.invitePendingApproval?.mode??null}};return{experimentalInvitePermissions:{directInviteMode:null,invitePendingApprovalMode:null}}}var q=n("ihDPC");n("cVfpT");var X=n("9WYR7");let Q=(0,n("cgtv4").defineMessages)({shareButtonText:{id:"team-presence.menu.empty-state.suggestions-dialog.share-button",defaultMessage:"Share"},shareButtonClickedText:{id:"team-presence.menu.empty-state.suggestions-dialog.share-button.clicked",defaultMessage:"Sent"}}),J=(0,n("ecnYn").xcss)({flexGrow:"1",minWidth:"0"}),$=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r=(0,i.c)(15),{suggestedUser:l,onHandleShare:c,contentId:d,contentType:u,contentMode:p}=t,{formatMessage:f}=(0,n("8C5kA").default)(),[g,m]=(0,s.useState)(!1),{createAnalyticsEvent:h}=(0,n("inPa6").useAnalyticsEvents)();r[0]!==d||r[1]!==p||r[2]!==u||r[3]!==h||r[4]!==c?(a=()=>{m(!0),c(),h({type:"sendScreenEvent",data:{name:"sentText",attributes:{contentId:d,contentType:u,contentMode:p}}}).fire()},r[0]=d,r[1]=p,r[2]=u,r[3]=h,r[4]=c,r[5]=a):a=r[5];let E=a;return r[6]!==d||r[7]!==p||r[8]!==u||r[9]!==f||r[10]!==E||r[11]!==g||r[12]!==l.name||r[13]!==l.picture?(o=e(s).createElement(n("d77M1").default,{component:()=>e(s).createElement(n("6f0Oj").default,{paddingInline:"space.200",paddingBlock:"space.100"},e(s).createElement(n("bUlM5").default,{gap:"space.150",alignItems:"center"},e(s).createElement(n("esRft").default,{size:"small",src:l.picture}),e(s).createElement(n("6f0Oj").default,{xcss:J},l.name),g?e(s).createElement(n("6f0Oj").default,{paddingInline:"space.200",paddingBlock:"space.025"},e(s).createElement(n("bUlM5").default,{gap:"space.075",alignItems:"center"},e(s).createElement(e(n("cvXh8")),{label:"share-success",color:"var(--ds-icon-success, #6A9A23)"}),e(s).createElement(n("5dK2X").default,{weight:"medium",color:"color.text.subtle"},f(Q.shareButtonClickedText)))):e(s).createElement(n("ccHMk").default,{iconBefore:e(n("4fdTR")),testId:"share-with-people",onClick:E,spacing:"compact",analyticsContext:{contentId:d,contentType:u,contentMode:p,source:"shareWithPeopleButton"}},f(Q.shareButtonText))))}),r[6]=d,r[7]=p,r[8]=u,r[9]=f,r[10]=E,r[11]=g,r[12]=l.name,r[13]=l.picture,r[14]=o):o=r[14],o}:({suggestedUser:t,onHandleShare:a,contentId:o,contentType:r,contentMode:i})=>{let{formatMessage:l}=(0,n("8C5kA").default)(),[c,d]=(0,s.useState)(!1),{createAnalyticsEvent:u}=(0,n("inPa6").useAnalyticsEvents)(),p=()=>{d(!0),a(),u({type:"sendScreenEvent",data:{name:"sentText",attributes:{contentId:o,contentType:r,contentMode:i}}}).fire()};return e(s).createElement(n("d77M1").default,{component:()=>e(s).createElement(n("6f0Oj").default,{paddingInline:"space.200",paddingBlock:"space.100"},e(s).createElement(n("bUlM5").default,{gap:"space.150",alignItems:"center"},e(s).createElement(n("esRft").default,{size:"small",src:t.picture}),e(s).createElement(n("6f0Oj").default,{xcss:J},t.name),c?e(s).createElement(n("6f0Oj").default,{paddingInline:"space.200",paddingBlock:"space.025"},e(s).createElement(n("bUlM5").default,{gap:"space.075",alignItems:"center"},e(s).createElement(e(n("cvXh8")),{label:"share-success",color:"var(--ds-icon-success, #6A9A23)"}),e(s).createElement(n("5dK2X").default,{weight:"medium",color:"color.text.subtle"},l(Q.shareButtonClickedText)))):e(s).createElement(n("ccHMk").default,{iconBefore:e(n("4fdTR")),testId:"share-with-people",onClick:p,spacing:"compact",analyticsContext:{contentId:o,contentType:r,contentMode:i,source:"shareWithPeopleButton"}},l(Q.shareButtonText))))})},Z=(0,n("cgtv4").defineMessages)({sharedFlag:{id:"team-presence.menu.empty-state.shared.flag",defaultMessage:"Content shared"}}),ee=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r=(0,i.c)(19),{contentId:l,contentType:c,contentMode:d,pageMode:u,suggestedUsers:p,flags:f}=t,{formatMessage:g}=(0,n("8C5kA").default)(),m="edit"===u,{shareToEntities:h}=(0,q.useShareToEntities)(l,"suggestedCollaboratorsDialog",m?X.PAGE_MODE.EDIT:X.PAGE_MODE.VIEW);if(r[0]!==l||r[1]!==d||r[2]!==c||r[3]!==f||r[4]!==g||r[5]!==m||r[6]!==h||r[7]!==p){let t;r[9]!==l||r[10]!==d||r[11]!==c||r[12]!==f||r[13]!==g||r[14]!==m||r[15]!==h?(t=t=>{let n=async()=>{(await h([{id:t.id,type:"user"}],m)).success&&f.showSuccessCircleFlag({id:"team-presence-share-completed-flag",title:g(Z.sharedFlag),isAutoDismiss:!0})};return e(s).createElement($,{key:t.id,suggestedUser:t,onHandleShare:n,contentId:l,contentType:c,contentMode:d})},r[9]=l,r[10]=d,r[11]=c,r[12]=f,r[13]=g,r[14]=m,r[15]=h,r[16]=t):t=r[16],a=p.map(t),r[0]=l,r[1]=d,r[2]=c,r[3]=f,r[4]=g,r[5]=m,r[6]=h,r[7]=p,r[8]=a}else a=r[8];return r[17]!==a?(o=e(s).createElement(n("2SlZp").default,{maxHeight:232},e(s).createElement(n("7rvPL").default,{isScrollable:!0},a)),r[17]=a,r[18]=o):o=r[18],o}:({contentId:t,contentType:a,contentMode:o,pageMode:r,suggestedUsers:i,flags:l})=>{let{formatMessage:c}=(0,n("8C5kA").default)(),d="edit"===r,{shareToEntities:u}=(0,q.useShareToEntities)(t,"suggestedCollaboratorsDialog",d?X.PAGE_MODE.EDIT:X.PAGE_MODE.VIEW);return e(s).createElement(n("2SlZp").default,{maxHeight:232},e(s).createElement(n("7rvPL").default,{isScrollable:!0},i.map(n=>{let r=async()=>{(await u([{id:n.id,type:"user"}],d)).success&&l.showSuccessCircleFlag({id:"team-presence-share-completed-flag",title:c(Z.sharedFlag),isAutoDismiss:!0})};return e(s).createElement($,{key:n.id,suggestedUser:n,onHandleShare:r,contentId:t,contentType:a,contentMode:o})})))},et=(0,n("7aRa9").withFlags)(ee),en=(0,n("cgtv4").defineMessages)({suggestedCollaboratorsDescription:{id:"team-presence.menu.empty-state.suggestions-dialog.description",defaultMessage:"You often work together"},copyLinkButtonText:{id:"team-presence.menu.empty-state.suggested-collaborators.footer.copy-button",defaultMessage:"Copy link"},moreShareOptionsButtonText:{id:"team-presence.menu.empty-state.suggested-collaborators.footer.more-share-options-button",defaultMessage:"More share options"},noCollaboratorsCanInviteOnPageDescription:{id:"team-presence.menu.empty-state.no-collaborators.with-invite-permissions.on-page.description",defaultMessage:"Want to loop in others? Invite teammates to check this page out."},noCollaboratorsCanInviteOnBlogpostDescription:{id:"team-presence.menu.empty-state.no-collaborators.with-invite-permissions.on-blogpost.description",defaultMessage:"Want to loop in others? Invite teammates to check this blog post out."},noCollaboratorsCanInviteOnDatabaseDescription:{id:"team-presence.menu.empty-state.no-collaborators.with-invite-permissions.on-database.description",defaultMessage:"Want to loop in others? Invite teammates to check this database out."},noCollaboratorsCanInviteOnWhiteboardDescription:{id:"team-presence.menu.empty-state.no-collaborators.with-invite-permissions.on-whiteboard.description",defaultMessage:"Want to loop in others? Invite teammates to check this whiteboard out."},noCollaboratorsCanInviteLiveDocDescription:{id:"team-presence.menu.empty-state.no-collaborators.with-invite-permissions.on-live-doc.description",defaultMessage:"Want to loop in others? Invite teammates to check this live doc out."},inviteTeammatesButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.invite-teammates-button",defaultMessage:"Add people to Confluence"},noCollaboratorsCannotInviteDescription:{id:"team-presence.menu.empty-state.no-collaborators.without-invite-permissions.description",defaultMessage:"Want to loop in others? Quickly share this with relevant teammates."},sharePageButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.share-page-button",defaultMessage:"Share page"},shareBlogpostButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.share-blogpost-button",defaultMessage:"Share blog post"},shareDatabaseButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.share-database-button",defaultMessage:"Share database"},shareWhiteboardButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.share-whiteboard-button",defaultMessage:"Share whiteboard"},shareLiveDocButtonText:{id:"team-presence.menu.empty-state.no-collaborators.footer.share-live-doc-button",defaultMessage:"Share live doc"},noCollaboratorsCannotInviteCannotShareDescription:{id:"team-presence.menu.empty-state.no-collaborators.without-invite-permissions.share-not-available.description",defaultMessage:"Want to loop in others? Copy the link to share this with relevant teammates."}}),ea="team-presence:suggested-collaborators-list:suggested-share-users",eo="collabInTeamPresenceExperiment",er={suggestedUsersDialogHeaderStyles:"_19pkv47k _otyr12x7",generalHeaderStyles:"_18zrpxbi _1q51pxbi",suggestedUsersDialogFooterStyles:"_1yt4u2gc _x3doia51",generalDialogFooterStyles:"_1yt4pxbi"},ei=e=>({blogpost:{modalDescription:e(en.noCollaboratorsCanInviteOnBlogpostDescription),buttonName:e(en.shareBlogpostButtonText)},page:{modalDescription:e(en.noCollaboratorsCanInviteOnPageDescription),buttonName:e(en.sharePageButtonText)},live:{modalDescription:e(en.noCollaboratorsCanInviteLiveDocDescription),buttonName:e(en.shareLiveDocButtonText)},whiteboard:{modalDescription:e(en.noCollaboratorsCanInviteOnWhiteboardDescription),buttonName:e(en.shareWhiteboardButtonText)},database:{modalDescription:e(en.noCollaboratorsCanInviteOnDatabaseDescription),buttonName:e(en.shareDatabaseButtonText)}}),es=(0,n("eSUdr").default)`query SuggestedCollaboratorsDialogsViewRestrictionsQuery($contentId:ID!){singleContent(id:$contentId){id hasViewRestrictions ancestors{id hasViewRestrictions}}}`,el=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u,p,f,g,m,h,E,v,b,y,I=(0,i.c)(79),{contentMode:C,contentId:S,contentType:T,onShareClick:_,spaceKey:x,flags:k,testId:A}=t,{formatMessage:w}=(0,n("8C5kA").default)(),{cloudId:M,orgId:D,userId:P}=(0,n("bQm3c").useSessionData)(),[O]=(0,n("kM55L").useCollabNetworkStatus)(),{isCollabOffline:R}=O;I[0]!==R?(a=R&&(0,n("6mKj3").expVal)("platform_editor_offline_editing_web","isEnabled",!1)&&!(0,n("9wGTI").fg)("platform_editor_offline_editing_wrapper_override"),I[0]=R,I[1]=a):a=I[1];let L=a,[B]=(0,n("efvKr").useLivePageMode)(),{isEditMode:U}=B,{createAnalyticsEvent:N}=(0,n("inPa6").useAnalyticsEvents)(),F=P??"";I[2]!==F?(o=[F],I[2]=F,I[3]=o):o=I[3];let V=o;I[4]!==M||I[5]!==V||I[6]!==D?(r={currentPickedPrincipalIds:V,maxDisplayResults:10,shouldFetchMoreResults:!1,contextType:ea,siteId:M,orgId:D,source:eo},I[4]=M,I[5]=V,I[6]=D,I[7]=r):r=I[7];let{suggestedUsers:j,loading:K,error:W}=(0,G.useUserSuggestions)(r);I[8]!==S?(l={variables:{contentId:S}},I[8]=S,I[9]=l):l=I[9];let{data:Y,error:q,loading:X}=(0,n("jMyy4").useQueryInterop)(es,l);I[10]!==Y?.singleContent?.ancestors||I[11]!==Y?.singleContent?.hasViewRestrictions?(c=Y?.singleContent?.hasViewRestrictions||Y?.singleContent?.ancestors?.some(ed),I[10]=Y?.singleContent?.ancestors,I[11]=Y?.singleContent?.hasViewRestrictions,I[12]=c):c=I[12];let Q=!!c,J=!!j?.length&&!L||Q,$=`ari:cloud:platform::site/${M}`;I[13]!==$?(d={resourceARI:$},I[13]=$,I[14]=d):d=I[14],I[15]!==J||I[16]!==d?(u={variables:d,skip:J},I[15]=J,I[16]=d,I[17]=u):u=I[17];let{data:Z,error:ee,loading:el}=H(u);I[18]!==j?(p=(j||[]).map(eu).filter(ep),I[18]=j,I[19]=p):p=I[19];let ec=p,eg="edit"===C||"live"===C&&U?"edit":"view",em=ei(w)["page"===T&&"live"===C?"live":T],eh=!L&&!!ec?.length&&!Q,eE=eh?"subtle":"default",ev=!ee&&Z?.experimentalInvitePermissions?.directInviteMode==="ANYONE";I[20]!==L||I[21]!==ev||I[22]!==eh?(f=()=>eh?"suggestedCollaboratorsDialog":ev?"noCollaboratorsInviteDialog":L?"noCollaboratorsDefaultDialog":"noCollaboratorsShareDialog",I[20]=L,I[21]=ev,I[22]=eh,I[23]=f):f=I[23];let eb=f();I[24]!==S||I[25]!==C||I[26]!==T||I[27]!==N||I[28]!==eb||I[29]!==_?(g=e=>{_&&(_("suggestedCollaboratorsDialog"),N({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"shareWithCollaboratorsButton",source:eb,attributes:{contentId:S,contentType:T,contentMode:C}}}).fire())},I[24]=S,I[25]=C,I[26]=T,I[27]=N,I[28]=eb,I[29]=_,I[30]=g):g=I[30];let ey=g,eI=()=>eh?w(en.suggestedCollaboratorsDescription):ev?em.modalDescription:L?w(en.noCollaboratorsCannotInviteCannotShareDescription):w(en.noCollaboratorsCannotInviteDescription);if(I[31]!==S||I[32]!==C||I[33]!==T||I[34]!==N||I[35]!==eb||I[36]!==el||I[37]!==K||I[38]!==X||I[39]!==ec?.length?(m=()=>{K||el||X||N({type:"sendScreenEvent",data:{name:eb,attributes:{contentMode:C,contentType:T,contentId:S,suggestedUsersCount:ec?.length}}}).fire()},I[31]=S,I[32]=C,I[33]=T,I[34]=N,I[35]=eb,I[36]=el,I[37]=K,I[38]=X,I[39]=ec?.length,I[40]=m):m=I[40],I[41]!==S||I[42]!==C||I[43]!==T||I[44]!==N||I[45]!==eb||I[46]!==el||I[47]!==K||I[48]!==X||I[49]!==ec?(h=[K,el,X,C,T,S,ec,N,eb],I[41]=S,I[42]=C,I[43]=T,I[44]=N,I[45]=eb,I[46]=el,I[47]=K,I[48]=X,I[49]=ec,I[50]=h):h=I[50],(0,s.useEffect)(m,h),K||el||X){let t;return I[51]===Symbol.for("react.memo_cache_sentinel")?(t=e(s).createElement(n("7rvPL").default,null,e(s).createElement(n("3MKHu").default,{isShimmering:!0}),Array.from({length:5}).map(ef)),I[51]=t):t=I[51],t}let eC=W||ee||q;ee&&N({type:"sendOperationalEvent",data:{source:eo,action:"errored",actionSubject:"suggestedCollaboratorsDialogInviteQuery",attributes:{contentId:S,contentMode:C,contentType:T,error:ee,message:ee?.message}}}).fire();let eS=n("eyWa4").default;I[52]!==eC?(E=eC&&e(s).createElement(z.ErrorDisplay,{error:eC}),I[52]=eC,I[53]=E):E=I[53];let eT=eh?e(s).createElement(e(s).Fragment,null,e(s).createElement(n("gdv5Z").default,{xcss:er.suggestedUsersDialogHeaderStyles},e(s).createElement(n("gBbsI").default,null,eI())),e(s).createElement(et,{contentId:S,contentType:T,contentMode:eg,pageMode:eg,suggestedUsers:ec})):e(s).createElement(n("gdv5Z").default,{xcss:er.generalHeaderStyles,id:"suggested-collaborators-modal-description"},eI()),e_=eh?er.suggestedUsersDialogFooterStyles:er.generalDialogFooterStyles,ex=eh?"start":"end";return I[54]!==eE||I[55]!==S||I[56]!==C||I[57]!==T||I[58]!==eb||I[59]!==k||I[60]!==w||I[61]!==L||I[62]!==ey||I[63]!==eg||I[64]!==ev||I[65]!==eh||I[66]!==x||I[67]!==em?(v=eh||!ev?e(s).createElement(n("u9agA").default,{space:"space.100"},e(s).createElement(n("hkzol").CopyLinkButton,{buttonAppearance:eE,buttonText:w(en.copyLinkButtonText),contentId:S,contentType:T,pageMode:eg,spaceKey:x,source:"suggestedCollaboratorsDialog",onClickAttributes:{contentId:S,contentMode:C,contentType:T,dialogSelected:eb}}),!L&&e(s).createElement(n("ccHMk").default,{iconBefore:e(n("9M4aB")),testId:"open-share-dialog",onClick:ey,appearance:eE},eh?w(en.moreShareOptionsButtonText):em.buttonName)):e(s).createElement(n("3Fgla").GlobalInviteWithLazyLoadedRelayProvider,{product:"confluence",showFlag:k.showFlag},e(s).createElement(n("u9agA").default,{space:"space.075",alignBlock:"center"},e(s).createElement(e(n("g5gZt")),{label:"invite-button-icon"}),w(en.inviteTeammatesButtonText))),I[54]=eE,I[55]=S,I[56]=C,I[57]=T,I[58]=eb,I[59]=k,I[60]=w,I[61]=L,I[62]=ey,I[63]=eg,I[64]=ev,I[65]=eh,I[66]=x,I[67]=em,I[68]=v):v=I[68],I[69]!==e_||I[70]!==ex||I[71]!==v?(b=e(s).createElement(n("u9agA").default,{xcss:e_,alignInline:ex},v),I[69]=e_,I[70]=ex,I[71]=v,I[72]=b):b=I[72],I[73]!==eS||I[74]!==E||I[75]!==eT||I[76]!==b||I[77]!==A?(y=e(s).createElement(eS,{role:"dialog","aria-label":"suggested-collaborators-dialog","aria-describedby":"suggested-collaborators-modal-description",testId:A},E,eT,b),I[73]=eS,I[74]=E,I[75]=eT,I[76]=b,I[77]=A,I[78]=y):y=I[78],y}:({contentMode:t,contentId:a,contentType:o,onShareClick:r,spaceKey:i,flags:l,testId:c})=>{let{formatMessage:d}=(0,n("8C5kA").default)(),{cloudId:u,orgId:p,userId:f}=(0,n("bQm3c").useSessionData)(),[{isCollabOffline:g}]=(0,n("kM55L").useCollabNetworkStatus)(),m=g&&(0,n("6mKj3").expVal)("platform_editor_offline_editing_web","isEnabled",!1)&&!(0,n("9wGTI").fg)("platform_editor_offline_editing_wrapper_override"),[{isEditMode:h}]=(0,n("efvKr").useLivePageMode)(),{createAnalyticsEvent:E}=(0,n("inPa6").useAnalyticsEvents)(),v=(0,s.useMemo)(()=>[f??""],[f]),{suggestedUsers:b,loading:y,error:I}=(0,G.useUserSuggestions)({currentPickedPrincipalIds:v,maxDisplayResults:10,shouldFetchMoreResults:!1,contextType:ea,siteId:u,orgId:p,source:eo}),{data:C,error:S,loading:T}=(0,n("jMyy4").useQueryInterop)(es,{variables:{contentId:a}}),_=!!(C?.singleContent?.hasViewRestrictions||C?.singleContent?.ancestors?.some(e=>e?.hasViewRestrictions===!0)),{data:x,error:k,loading:A}=H({variables:{resourceARI:`ari:cloud:platform::site/${u}`},skip:!!b?.length&&!m||_}),w=(b||[]).map(e=>{if(null!==e)return{id:e.id,name:e.name,status:e.type||"",picture:e.avatarUrl||""}}).filter(e=>void 0!==e),M="edit"===t||"live"===t&&h?"edit":"view",D=ei(d)["page"===o&&"live"===t?"live":o],P=!m&&!!w?.length&&!_,O=P?"subtle":"default",R=!k&&x?.experimentalInvitePermissions?.directInviteMode==="ANYONE",L=P?"suggestedCollaboratorsDialog":R?"noCollaboratorsInviteDialog":m?"noCollaboratorsDefaultDialog":"noCollaboratorsShareDialog",B=(0,s.useCallback)(e=>{r&&(r("suggestedCollaboratorsDialog"),E({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"shareWithCollaboratorsButton",source:L,attributes:{contentId:a,contentType:o,contentMode:t}}}).fire())},[r,a,o,t,E,L]),U=()=>P?d(en.suggestedCollaboratorsDescription):R?D.modalDescription:m?d(en.noCollaboratorsCannotInviteCannotShareDescription):d(en.noCollaboratorsCannotInviteDescription);if((0,s.useEffect)(()=>{y||A||T||E({type:"sendScreenEvent",data:{name:L,attributes:{contentMode:t,contentType:o,contentId:a,suggestedUsersCount:w?.length}}}).fire()},[y,A,T,t,o,a,w,E,L]),y||A||T)return e(s).createElement(n("7rvPL").default,null,e(s).createElement(n("3MKHu").default,{isShimmering:!0}),Array.from({length:5}).map((t,a)=>e(s).createElement(n("cQDYl").default,{key:`skeleton-item-${a}`,testId:`skeleton-item-${a}`,hasAvatar:!0,isShimmering:!0})));let N=I||k||S;return k&&E({type:"sendOperationalEvent",data:{source:eo,action:"errored",actionSubject:"suggestedCollaboratorsDialogInviteQuery",attributes:{contentId:a,contentMode:t,contentType:o,error:k,message:k?.message}}}).fire(),e(s).createElement(n("eyWa4").default,{role:"dialog","aria-label":"suggested-collaborators-dialog","aria-describedby":"suggested-collaborators-modal-description",testId:c},N&&e(s).createElement(z.ErrorDisplay,{error:N}),P?e(s).createElement(e(s).Fragment,null,e(s).createElement(n("gdv5Z").default,{xcss:er.suggestedUsersDialogHeaderStyles},e(s).createElement(n("gBbsI").default,null,U())),e(s).createElement(et,{contentId:a,contentType:o,contentMode:M,pageMode:M,suggestedUsers:w})):e(s).createElement(n("gdv5Z").default,{xcss:er.generalHeaderStyles,id:"suggested-collaborators-modal-description"},U()),e(s).createElement(n("u9agA").default,{xcss:P?er.suggestedUsersDialogFooterStyles:er.generalDialogFooterStyles,alignInline:P?"start":"end"},P||!R?e(s).createElement(n("u9agA").default,{space:"space.100"},e(s).createElement(n("hkzol").CopyLinkButton,{buttonAppearance:O,buttonText:d(en.copyLinkButtonText),contentId:a,contentType:o,pageMode:M,spaceKey:i,source:"suggestedCollaboratorsDialog",onClickAttributes:{contentId:a,contentMode:t,contentType:o,dialogSelected:L}}),!m&&e(s).createElement(n("ccHMk").default,{iconBefore:e(n("9M4aB")),testId:"open-share-dialog",onClick:B,appearance:O},P?d(en.moreShareOptionsButtonText):D.buttonName)):e(s).createElement(n("3Fgla").GlobalInviteWithLazyLoadedRelayProvider,{product:"confluence",showFlag:l.showFlag},e(s).createElement(n("u9agA").default,{space:"space.075",alignBlock:"center"},e(s).createElement(e(n("g5gZt")),{label:"invite-button-icon"}),d(en.inviteTeammatesButtonText)))))},ec=(0,n("7aRa9").withFlags)(el);function ed(e){return e?.hasViewRestrictions===!0}function eu(e){if(null!==e)return{id:e.id,name:e.name,status:e.type||"",picture:e.avatarUrl||""}}function ep(e){return void 0!==e}function ef(t,a){return e(s).createElement(n("cQDYl").default,{key:`skeleton-item-${a}`,testId:`skeleton-item-${a}`,hasAvatar:!0,isShimmering:!0})}let eg=e=>document.querySelector(`[${n("h3X17").TELEPOINTER_DATA_SESSION_ID_ATTR}="${e}"]`),em=({contentType:e,contentMode:t,participant:a})=>{let o=(0,s.useContext)(n("1kHsc").ExperienceTrackerContext),r=(0,n("e4o8D").useRenderServerPlaceholder)(!0),[{fullPageEditorPresetAPI:i}]=(0,n("kDhla").useFullPageEditorApi)(),l=a?.sessions??{},[c]=_(l),d=c?.selection.head,u=c?.sessionId,p=l[u],f=r?null:eg(u),g=p?.activity,m=(("page"===e||"blogpost"===e)&&"edit"===t||"live"===t&&"viewer"!==g)&&!a?.isCurrentUser,h=m&&void 0!==d&&void 0!==u&&null!==f,E=(0,s.useRef)(null),v=(0,s.useRef)(null),b=()=>{E.current&&(E.current.disconnect(),E.current=null),v.current&&(clearTimeout(v.current),v.current=null)};(0,s.useEffect)(()=>()=>{let e=o.getExperienceState(n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE);e?.attributes?.sessionId!==u||e?.hasStopped||o.abort({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE,reason:"useScrollToTelepointer unmounted"})},[u,o]),(0,s.useEffect)(()=>()=>{b()},[]);let y=(0,s.useCallback)(()=>{o.start({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE,attributes:{contentType:e,contentMode:t,sessionId:u,activity:g}});try{b();let e=i?.core.actions.scrollToPos,t=i?.collabEdit?.commands.nudgeTelepointer;if(!h||!e)return o.fail({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE,error:Error("Eligibility checks failed"),attributes:{isEligibleToScroll:h,isScrollToPosDefined:void 0!==e}}),!1;let a=e(Number(d),{behavior:"smooth",block:"center"});return a&&t&&null!==f&&(E.current=new IntersectionObserver(([e])=>{e.isIntersecting&&(i?.core.actions.execute(t(u)),b())}),E.current.observe(f),v.current=setTimeout(()=>{b()},5e3)),a?o.succeed({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE}):o.fail({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE,error:Error("Scroll is not successful"),attributes:{isNudgeTelepointerDefined:void 0!==t,hasValidTelepointerElement:null!==f}}),a}catch(e){return o.fail({name:n("irVI7").TEAM_PRESENCE_CLICK_TO_FIND_EXPERIENCE,error:e}),!1}},[u,d,g,t,e,i,o,h,f]);return{isScrollToFeatureEnabled:m,isEligibleToScroll:h,scrollToTelepointer:y}},eh=(0,n("cgtv4").defineMessages)({editing:{id:"team-presence.menu.editing",defaultMessage:"Editing"},viewing:{id:"team-presence.menu.viewing",defaultMessage:"Viewing"},clickToFind:{id:"team-presence.menu.click-to-find",defaultMessage:"Click to find"},clickToFindNotAvailable:{id:"team-presence.menu.click-to-find-not-available",defaultMessage:"Inactive"},clickToFollow:{id:"team-presence.menu.click-to-follow",defaultMessage:"Click to follow"}}),eE=(0,n("ecnYn").xcss)({position:"relative"}),ev=(0,n("ecnYn").xcss)({position:"absolute",bottom:"-2px",right:"-2px",height:"12px",width:"12px",borderRadius:"radius.small",color:"color.text.inverse",boxShadow:"elevation.shadow.overflow",fontWeight:"font.weight.semibold",fontSize:"10px",zIndex:"card",userSelect:"none"}),eb=(0,n("ecnYn").xcss)({textAlign:"center"}),ey=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d=(0,i.c)(12),{borderColor:u,badgeTextColor:p,name:f}=t;d[0]!==f?(a=f?.substring(0,1),d[0]=f,d[1]=a):a=d[1];let g=a;return d[2]!==u||d[3]!==p?(o=(0,n("ecnYn").xcss)({backgroundColor:u,color:p}),d[2]=u,d[3]=p,d[4]=o):o=d[4],d[5]!==o?(r=[ev,o],d[5]=o,d[6]=r):r=d[6],d[7]!==g?(l=e(s).createElement(n("6f0Oj").default,{testId:"editor-avatar-badge-initial",as:"span"},g),d[7]=g,d[8]=l):l=d[8],d[9]!==r||d[10]!==l?(c=e(s).createElement(n("bUlM5").default,{testId:"editor-avatar-badge",alignItems:"center",justifyContent:"center",xcss:r},l),d[9]=r,d[10]=l,d[11]=c):c=d[11],c}:({borderColor:t,badgeTextColor:a,name:o})=>{let r=o?.substring(0,1);return e(s).createElement(n("bUlM5").default,{testId:"editor-avatar-badge",alignItems:"center",justifyContent:"center",xcss:[ev,(0,n("ecnYn").xcss)({backgroundColor:t,color:a})]},e(s).createElement(n("6f0Oj").default,{testId:"editor-avatar-badge-initial",as:"span"},r))},eI=(0,r.isReactCompilerActiveV1)()?t=>{let a,o=(0,i.c)(2),{children:r}=t;return o[0]!==r?(a=e(s).createElement(n("6f0Oj").default,{xcss:eb},r),o[0]=r,o[1]=a):a=o[1],a}:({children:t})=>e(s).createElement(n("6f0Oj").default,{xcss:eb},t),eC=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,p,f,g,m,h,v,b,y,I,C,S,T=(0,i.c)(44);if(T[0]!==t){let{contentMode:e,contentId:n,contentType:i,isEligibleToScroll:s,isScrollToFeatureEnabled:d,participant:u,...p}=t;o=i,r=s,l=d,c=u,a=p,T[0]=t,T[1]=a,T[2]=o,T[3]=r,T[4]=l,T[5]=c}else a=T[1],o=T[2],r=T[3],l=T[4],c=T[5];let{formatMessage:_}=(0,n("8C5kA").default)(),{activity:x,color:k,isCurrentUser:A,name:w,src:M}=c;T[6]!==x||T[7]!==_?(p=_("editor"===x?eh.editing:eh.viewing),T[6]=x,T[7]=_,T[8]=p):p=T[8];let D=p;T[9]!==D||T[10]!==o||T[11]!==w?(f=E(o)?w:`${w} (${D})`,T[9]=D,T[10]=o,T[11]=w,T[12]=f):f=T[12];let P=f;T[13]!==A||T[14]!==c.id?(g=A?u():d(c.id),T[13]=A,T[14]=c.id,T[15]=g):g=T[15];let O=g,R=k??O.backgroundColor,L=!A&&"whiteboard"===o&&c.followCursor,B=!!l&&"viewer"!==c.activity;return T[16]!==P?(m=e(s).createElement(eI,null,P),T[16]=P,T[17]=m):m=T[17],T[18]!==L?(h=L&&e(s).createElement(eI,null,e(s).createElement(n("gtD4K").default,eh.clickToFollow)),T[18]=L,T[19]=h):h=T[19],T[20]!==r||T[21]!==B?(v=B&&e(s).createElement(n("bUlM5").default,{justifyContent:"center"},r?e(s).createElement(n("gtD4K").default,eh.clickToFind):e(s).createElement(n("gtD4K").default,eh.clickToFindNotAvailable)),T[20]=r,T[21]=B,T[22]=v):v=T[22],T[23]!==m||T[24]!==h||T[25]!==v?(b=e(s).createElement(e(s).Fragment,null,m,h,v),T[23]=m,T[24]=h,T[25]=v,T[26]=b):b=T[26],T[27]!==a||T[28]!==R||T[29]!==P||T[30]!==w||T[31]!==M?(y=e(s).createElement(n("esRft").default,{...a,appearance:"circle",borderColor:R,label:P,name:w,size:"small",src:M}),T[27]=a,T[28]=R,T[29]=P,T[30]=w,T[31]=M,T[32]=y):y=T[32],T[33]!==x||T[34]!==R||T[35]!==O||T[36]!==w?(I="editor"===x&&e(s).createElement(ey,{borderColor:R,badgeTextColor:O.textColor,name:w}),T[33]=x,T[34]=R,T[35]=O,T[36]=w,T[37]=I):I=T[37],T[38]!==y||T[39]!==I?(C=e(s).createElement(n("bUlM5").default,{direction:"column",alignItems:"center",gap:"space.0",xcss:eE},y,I),T[38]=y,T[39]=I,T[40]=C):C=T[40],T[41]!==C||T[42]!==b?(S=e(s).createElement(n("3gadb").default,{content:b},C),T[41]=C,T[42]=b,T[43]=S):S=T[43],S}:({contentMode:t,contentId:a,contentType:o,isEligibleToScroll:r,isScrollToFeatureEnabled:i,participant:l,...c})=>{let{formatMessage:p}=(0,n("8C5kA").default)(),{activity:f,color:g,isCurrentUser:m,name:h,src:v}=l,b=p("editor"===f?eh.editing:eh.viewing),y=E(o)?h:`${h} (${b})`,I=m?u():d(l.id),C=g??I.backgroundColor,S=!m&&"whiteboard"===o&&l.followCursor,T=!!i&&"viewer"!==l.activity;return e(s).createElement(n("3gadb").default,{content:e(s).createElement(e(s).Fragment,null,e(s).createElement(eI,null,y),S&&e(s).createElement(eI,null,e(s).createElement(n("gtD4K").default,eh.clickToFollow)),T&&e(s).createElement(n("bUlM5").default,{justifyContent:"center"},r?e(s).createElement(n("gtD4K").default,eh.clickToFind):e(s).createElement(n("gtD4K").default,eh.clickToFindNotAvailable)))},e(s).createElement(n("bUlM5").default,{direction:"column",alignItems:"center",gap:"space.0",xcss:eE},e(s).createElement(n("esRft").default,{...c,appearance:"circle",borderColor:C,label:y,name:h,size:"small",src:v}),"editor"===f&&e(s).createElement(ey,{borderColor:C,badgeTextColor:I.textColor,name:h})))},eS=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d=(0,i.c)(34),{index:u,participant:p,contentMode:f,contentType:g,contentId:m,isSingleParticipant:h,isEligibleForEmptyPresenceDialog:E,toggleEmptyPresenceDialog:v,avatarProps:b,analyticSource:y}=t,{id:I}=p,{createAnalyticsEvent:C}=(0,n("inPa6").useAnalyticsEvents)();d[0]!==f||d[1]!==g||d[2]!==p?(a={contentType:g,contentMode:f,participant:p},d[0]=f,d[1]=g,d[2]=p,d[3]=a):a=d[3];let{isScrollToFeatureEnabled:S,isEligibleToScroll:T,scrollToTelepointer:_}=em(a);d[4]!==y||d[5]!==m||d[6]!==f||d[7]!==g||d[8]!==C||d[9]!==E||d[10]!==T||d[11]!==S||d[12]!==h||d[13]!==p.onClick||d[14]!==_||d[15]!==v?(o=()=>h?E?v:void 0:T?()=>{C({type:"sendUIEvent",data:{source:y,action:"clicked",actionSubject:"button",actionSubjectId:"presenceAvatarButton",product:"confluence",attributes:{contentId:m,contentType:g,contentMode:f,isScrollToFeatureEnabled:S,isEligibleToScroll:T,isScrollSuccessful:_()}}}).fire()}:p?.onClick,d[4]=y,d[5]=m,d[6]=f,d[7]=g,d[8]=C,d[9]=E,d[10]=T,d[11]=S,d[12]=h,d[13]=p.onClick,d[14]=_,d[15]=v,d[16]=o):o=d[16];let x=o,k=`box-${I}`,A=`avatar-${I}`,w=4-u,M=`team-presence-avatar-${u}`;return d[17]!==x?(r=x(),d[17]=x,d[18]=r):r=d[18],d[19]!==b||d[20]!==m||d[21]!==f||d[22]!==g||d[23]!==T||d[24]!==S||d[25]!==p||d[26]!==A||d[27]!==w||d[28]!==M||d[29]!==r?(l=e(s).createElement(eC,{...b,participant:p,contentId:m,contentMode:f,contentType:g,key:A,stackIndex:w,testId:M,onClick:r,isEligibleToScroll:T,isScrollToFeatureEnabled:S}),d[19]=b,d[20]=m,d[21]=f,d[22]=g,d[23]=T,d[24]=S,d[25]=p,d[26]=A,d[27]=w,d[28]=M,d[29]=r,d[30]=l):l=d[30],d[31]!==k||d[32]!==l?(c=e(s).createElement(n("gdv5Z").default,{padding:(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")?"space.0":"space.025",key:k,"data-vc":"presence-avatar"},l),d[31]=k,d[32]=l,d[33]=c):c=d[33],c}:({index:t,participant:a,contentMode:o,contentType:r,contentId:i,isSingleParticipant:l,isEligibleForEmptyPresenceDialog:c,toggleEmptyPresenceDialog:d,avatarProps:u,analyticSource:p})=>{let{id:f}=a,{createAnalyticsEvent:g}=(0,n("inPa6").useAnalyticsEvents)(),{isScrollToFeatureEnabled:m,isEligibleToScroll:h,scrollToTelepointer:E}=em({contentType:r,contentMode:o,participant:a});return e(s).createElement(n("gdv5Z").default,{padding:(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")?"space.0":"space.025",key:`box-${f}`,"data-vc":"presence-avatar"},e(s).createElement(eC,{...u,participant:a,contentId:i,contentMode:o,contentType:r,key:`avatar-${f}`,stackIndex:4-t,testId:`team-presence-avatar-${t}`,onClick:l?c?d:void 0:h?()=>{g({type:"sendUIEvent",data:{source:p,action:"clicked",actionSubject:"button",actionSubjectId:"presenceAvatarButton",product:"confluence",attributes:{contentId:i,contentType:r,contentMode:o,isScrollToFeatureEnabled:m,isEligibleToScroll:h,isScrollSuccessful:E()}}}).fire()}:a?.onClick,isEligibleToScroll:h,isScrollToFeatureEnabled:m}))},eT=(0,n("cgtv4").defineMessages)({editing:{id:"team-presence.menu.editing",defaultMessage:"Editing"},viewing:{id:"team-presence.menu.viewing",defaultMessage:"Viewing"},you:{id:"team-presence.menu.current-user.marker",defaultMessage:"You"},clickToFind:{id:"team-presence.menu-item.click-to-find",defaultMessage:"Click to find"},clickToFindNotAvailable:{id:"team-presence.menu-item.click-to-find-not-available",defaultMessage:"Inactive"},clickToFollow:{id:"team-presence.menu-item.click-to-follow",defaultMessage:"Click to follow"}}),e_=(0,n("ecnYn").xcss)({visibility:"hidden"}),ex=(0,n("ecnYn").xcss)({visibility:"visible"}),ek=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u,p,f,g,m,h,v,b,y,I=(0,i.c)(59),{participant:C,contentMode:S,contentId:T,contentType:_,isCurrentUser:x}=t,{createAnalyticsEvent:k}=(0,n("inPa6").useAnalyticsEvents)();I[0]!==S||I[1]!==_||I[2]!==C?(a={contentType:_,contentMode:S,participant:C},I[0]=S,I[1]=_,I[2]=C,I[3]=a):a=I[3];let{isScrollToFeatureEnabled:A,isEligibleToScroll:w,scrollToTelepointer:M}=em(a),D="unidentified"===C.userId,P=w||!!C.onClick,[O,R]=(0,s.useState)(!1),L=A&&"viewer"!==C.activity,B="whiteboard"===_&&C.followCursor&&O;I[4]!==T||I[5]!==S||I[6]!==_||I[7]!==k||I[8]!==P||I[9]!==w||I[10]!==A||I[11]!==C||I[12]!==M?(o=()=>{let e=!1;w&&(e=M()),C.onClick&&C.onClick(),P&&k({type:"sendUIEvent",data:{product:"confluence",source:"presenceMenu",action:"clicked",actionSubject:"button",actionSubjectId:"presenceMenuItem",attributes:{contentId:T,contentType:_,contentMode:S,isScrollToFeatureEnabled:A,isEligibleToScroll:w,isScrollSuccessful:e}}}).fire()},I[4]=T,I[5]=S,I[6]=_,I[7]=k,I[8]=P,I[9]=w,I[10]=A,I[11]=C,I[12]=M,I[13]=o):o=I[13];let U=o;I[14]!==_||I[15]!==A?(r=()=>{(A||"whiteboard"===_)&&R(!0)},I[14]=_,I[15]=A,I[16]=r):r=I[16];let N=r;I[17]!==_||I[18]!==A?(l=()=>{(A||"whiteboard"===_)&&R(!1)},I[17]=_,I[18]=A,I[19]=l):l=I[19];let F=l;return I[20]!==T||I[21]!==S||I[22]!==_||I[23]!==w||I[24]!==C?(c=e(s).createElement(eC,{testId:"team-presence-menu-item-avatar",participant:C,contentMode:S,contentId:T,contentType:_,isEligibleToScroll:w}),I[20]=T,I[21]=S,I[22]=_,I[23]=w,I[24]=C,I[25]=c):c=I[25],I[26]!==_||I[27]!==C.activity?(d=!E(_)&&("editor"===C.activity?e(s).createElement(n("gtD4K").default,eT.editing):e(s).createElement(n("gtD4K").default,eT.viewing)),I[26]=_,I[27]=C.activity,I[28]=d):d=I[28],I[29]!==B?(u=B&&e(s).createElement(n("6f0Oj").default,{as:"span"},e(s).createElement(n("gtD4K").default,eT.clickToFollow)),I[29]=B,I[30]=u):u=I[30],I[31]!==w||I[32]!==O||I[33]!==L?(p=L&&e(s).createElement(n("6f0Oj").default,{as:"span",xcss:O?ex:e_},e(s).createElement("span",{"aria-hidden":"true"}," - "),w?e(s).createElement(n("gtD4K").default,eT.clickToFind):e(s).createElement(n("gtD4K").default,eT.clickToFindNotAvailable)),I[31]=w,I[32]=O,I[33]=L,I[34]=p):p=I[34],I[35]!==d||I[36]!==u||I[37]!==p?(f=e(s).createElement(e(s).Fragment,null,d,u,p),I[35]=d,I[36]=u,I[37]=p,I[38]=f):f=I[38],I[39]===Symbol.for("react.memo_cache_sentinel")?(g=(0,n("gMc0m").default)(["_4t3i1ex1"]),I[39]=g):g=I[39],I[40]!==C.isGuest?(m=C.isGuest&&e(s).createElement(n("9fywD").ExternalUserLozenge,null),I[40]=C.isGuest,I[41]=m):m=I[41],I[42]!==_||I[43]!==D||I[44]!==x?(h=x&&D&&"whiteboard"!==_&&e(s).createElement(n("5nBzc").default,{appearance:"inprogress"},e(s).createElement(n("gtD4K").default,eT.you)),I[42]=_,I[43]=D,I[44]=x,I[45]=h):h=I[45],I[46]!==C.name||I[47]!==m||I[48]!==h?(v=e(s).createElement(n("bUlM5").default,{alignItems:"baseline",gap:"space.050",direction:"row"},C.name,m,h),I[46]=C.name,I[47]=m,I[48]=h,I[49]=v):v=I[49],I[50]!==U||I[51]!==f||I[52]!==v||I[53]!==c?(b=e(s).createElement(n("56M4r").default,{onClick:U,testId:"team-presence-menu-item","data-vc":"team-presence-menu-item",iconBefore:c,description:f,className:g},v),I[50]=U,I[51]=f,I[52]=v,I[53]=c,I[54]=b):b=I[54],I[55]!==F||I[56]!==N||I[57]!==b?(y=e(s).createElement(n("6f0Oj").default,{onMouseEnter:N,onFocus:N,onMouseLeave:F,onBlur:F},b),I[55]=F,I[56]=N,I[57]=b,I[58]=y):y=I[58],y}:({participant:t,contentMode:a,contentId:o,contentType:r,isCurrentUser:i})=>{let{createAnalyticsEvent:l}=(0,n("inPa6").useAnalyticsEvents)(),{isScrollToFeatureEnabled:c,isEligibleToScroll:d,scrollToTelepointer:u}=em({contentType:r,contentMode:a,participant:t}),p="unidentified"===t.userId,f=d||!!t.onClick,[g,m]=(0,s.useState)(!1),h=c&&"viewer"!==t.activity,v="whiteboard"===r&&t.followCursor&&g,b=(0,s.useCallback)(()=>{let e=!1;d&&(e=u()),t.onClick&&t.onClick(),f&&l({type:"sendUIEvent",data:{product:"confluence",source:"presenceMenu",action:"clicked",actionSubject:"button",actionSubjectId:"presenceMenuItem",attributes:{contentId:o,contentType:r,contentMode:a,isScrollToFeatureEnabled:c,isEligibleToScroll:d,isScrollSuccessful:e}}}).fire()},[t,o,r,a,c,d,f,u,l]),y=()=>{(c||"whiteboard"===r)&&m(!0)},I=()=>{(c||"whiteboard"===r)&&m(!1)};return e(s).createElement(n("6f0Oj").default,{onMouseEnter:y,onFocus:y,onMouseLeave:I,onBlur:I},e(s).createElement(n("56M4r").default,{onClick:b,testId:"team-presence-menu-item","data-vc":"team-presence-menu-item",iconBefore:e(s).createElement(eC,{testId:"team-presence-menu-item-avatar",participant:t,contentMode:a,contentId:o,contentType:r,isEligibleToScroll:d}),description:e(s).createElement(e(s).Fragment,null,!E(r)&&("editor"===t.activity?e(s).createElement(n("gtD4K").default,eT.editing):e(s).createElement(n("gtD4K").default,eT.viewing)),v&&e(s).createElement(n("6f0Oj").default,{as:"span"},e(s).createElement(n("gtD4K").default,eT.clickToFollow)),h&&e(s).createElement(n("6f0Oj").default,{as:"span",xcss:g?ex:e_},e(s).createElement("span",{"aria-hidden":"true"}," - "),d?e(s).createElement(n("gtD4K").default,eT.clickToFind):e(s).createElement(n("gtD4K").default,eT.clickToFindNotAvailable))),className:(0,n("gMc0m").default)(["_4t3i1ex1"])},e(s).createElement(n("bUlM5").default,{alignItems:"baseline",gap:"space.050",direction:"row"},t.name,t.isGuest&&e(s).createElement(n("9fywD").ExternalUserLozenge,null),i&&p&&"whiteboard"!==r&&e(s).createElement(n("5nBzc").default,{appearance:"inprogress"},e(s).createElement(n("gtD4K").default,eT.you)))))};var eA=((o={}).ANONYMOUS="ANONYMOUS",o.APP="APP",o.EXTERNAL="EXTERNAL",o.INTERNAL="INTERNAL",o.JSD="JSD",o);let ew=e=>(0,n("hp2SH").getApolloClient)().query({query:(0,n("eSUdr").default)`query fetchPresenceUsersGuestStatusQuery($accountIds:[String]){confluenceUsers(accountIds:$accountIds){nodes{...on KnownUser{accountId}...on UnknownUser{accountId}permissionType}}}`,variables:{accountIds:e}}).then(({data:e})=>e?.confluenceUsers?.nodes?.filter(e=>e?.accountId).map(e=>({userId:e?.accountId??"",isGuest:(e?.permissionType===eA.EXTERNAL)??void 0}))??[]),eM=(0,n("cgtv4").defineMessages)({activeNowTitle:{id:"team-presence.presence-menu.active.title",defaultMessage:"{count, plural, =0 {Active now ({count})} one {Active now ({count})} other {Active now ({count})}}"},viewingNowTitle:{id:"team-presence.presence-menu.viewing.title",defaultMessage:"{count, plural, =0 {Viewing now ({count})} one {Viewing now ({count})} other {Viewing now ({count})}}"},editingNowTitle:{id:"team-presence.presence-menu.editing.title",defaultMessage:"{count, plural, =0 {Editing now ({count})} one {Editing now ({count})} other {Editing now ({count})}}"},loadMore:{id:"team-presence.presence-menu.load-more",defaultMessage:"Load More"}}),eD=({max:t,next:a})=>Array.from({length:Math.min(t,a)}).map((t,a)=>e(s).createElement(n("cQDYl").default,{key:`skeleton-item-${a}`,testId:"skeleton-item",hasAvatar:!0,isShimmering:!0})),eP=({contentId:t,contentMode:a,contentType:o,participants:r,totalParticipants:i})=>{let{formatMessage:l}=(0,n("8C5kA").default)(),{createAnalyticsEvent:c}=(0,n("inPa6").useAnalyticsEvents)(),{isLoggedIn:d}=(0,n("bQm3c").useSessionData)(),u=(0,n("8Lx5S").useIsLicensed)(),p=(0,n("8Lx5S").useIsGuest)(),[f,g]=e(s).useState(!0),[m,h]=e(s).useState(!1),[E,v]=e(s).useState(!1),b=(0,s.useRef)(new Map),y=r.filter(e=>b.current.has(e.id)),I=r.filter(e=>!b.current.has(e.id)),C=I.length>0;(0,s.useEffect)(()=>{c({type:"sendScreenEvent",data:{name:"presenceMenu",attributes:{contentId:t,contentType:o,contentMode:a}}}).fire()},[c,t,o,a]),(0,s.useEffect)(()=>{let e=async({next:e})=>{v(!0);let t=[],n=[];I.slice(0,e).forEach(e=>{b.current.has(e.id)||("unidentified"===e.userId?n.push(e.id):t.push(e.userId.replace("ari:cloud:identity::user/","")))}),t.length>0&&(d&&u&&!p?(await ew(t)).forEach(e=>{let t=e.userId,n=`ari:cloud:identity::user/${t}`;r.filter(e=>e.userId===t||e.userId===n).forEach(t=>b.current.set(t.id,e.isGuest))}):t.forEach(e=>{let t=`ari:cloud:identity::user/${e}`;r.filter(n=>n.userId===e||n.userId===t).forEach(e=>b.current.set(e.id,!1))})),n.forEach(e=>b.current.set(e,!1)),v(!1),g(!1)};(f||m)&&!E&&(h(!1),e({next:f?10:25}))},[p,f,u,m,E,d,r,I]);let S=(0,s.useCallback)(()=>{c({type:"sendUIEvent",data:{action:"clicked",actionSubject:"presenceMenuWithGuestLoadMore",source:"presenceMenuWithGuest",attributes:{shown:y.length,total:i}}}).fire(),h(!0)},[c,y,i]),T=(0,s.useCallback)(e=>"edit"===a&&("page"===o||"blogpost"===o)?l(eM.editingNowTitle,{count:e}):"view"===a&&("page"===o||"blogpost"===o)?l(eM.viewingNowTitle,{count:e}):l(eM.activeNowTitle,{count:e}),[a,o,l]);return e(s).createElement(n("2SlZp").default,{maxHeight:480,minWidth:360,maxWidth:360,testId:"presence-menu-group"},y.length>0?e(s).createElement(n("7rvPL").default,{isScrollable:!0,title:T(i),testId:"presence-menu-group-guest"},y.map((n,r)=>{let i={...n,isGuest:b.current.get(n.id)??!1};return e(s).createElement(ek,{contentId:t,contentType:o,contentMode:a,key:`menu-item-${i.id.slice(6)}`,participant:i,isCurrentUser:i.isCurrentUser||0===r})}),C&&!E&&e(s).createElement(n("56M4r").default,{onClick:S},l(eM.loadMore)),C&&E&&e(s).createElement(eD,{max:25,next:I.length})):e(s).createElement(n("7rvPL").default,null,e(s).createElement(n("3MKHu").default,{isShimmering:!0}),e(s).createElement(eD,{max:10,next:I.length})))},eO=(0,n("cgtv4").defineMessages)({addPeopleLabel:{id:"team-presence.avatar-button.add-people-label",defaultMessage:"Add people to this {contentType}"},contentTypeLabel:{id:"team-presence.avatar-button.content-type-label",defaultMessage:"{contentType, select, page {page} blogpost {blog post} whiteboard {whiteboard} livepage {live doc} database {database} other {content}}"}}),eR=(0,n("ecnYn").xcss)({marginInlineEnd:"space.0",marginInlineStart:"space.negative.050"}),eL=(0,n("ecnYn").xcss)({marginInlineEnd:"space.025",marginInlineStart:"space.negative.075"}),eB=(0,n("ecnYn").xcss)({backgroundColor:"color.background.selected",":hover":{backgroundColor:"color.background.selected.hovered"},":active":{backgroundColor:"color.background.selected.pressed"}}),eU=(0,n("ecnYn").xcss)({height:"28px",width:"28px",borderRadius:"radius.full",color:"color.text.subtle",fontWeight:"font.weight.medium",backgroundColor:"color.background.accent.gray.subtlest",padding:"space.050",display:"flex",alignItems:"center",justifyContent:"center",":hover":{textDecoration:"underline",backgroundColor:"color.background.accent.gray.subtlest.hovered"},":active":{color:"color.link.pressed",backgroundColor:"color.background.accent.gray.subtlest.pressed"}}),eN=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d=(0,i.c)(19),{contentType:u,contentMode:p,contentId:f,analyticsTriggerSource:g,toggleEmptyPresenceDialog:m,isPopupOpen:h}=t,E=void 0===g?"PresenceAvatarGroup":g,{formatMessage:v}=(0,n("8C5kA").default)(),{createAnalyticsEvent:b}=(0,n("inPa6").useAnalyticsEvents)();d[0]!==E||d[1]!==f||d[2]!==p||d[3]!==u||d[4]!==b||d[5]!==m?(a=()=>(b({type:"sendUIEvent",data:{source:E,product:"confluence",action:"clicked",actionSubject:"button",actionSubjectId:"addCollaboratorsButton",attributes:{contentId:f,contentMode:p,contentType:u}}}).fire(),m()),d[0]=E,d[1]=f,d[2]=p,d[3]=u,d[4]=b,d[5]=m,d[6]=a):a=d[6];let y=a;if(d[7]!==p||d[8]!==u||d[9]!==v){let e=v(eO.contentTypeLabel,{contentType:"page"===u&&"live"===p?"livepage":u});o=v(eO.addPeopleLabel,{contentType:e}),d[7]=p,d[8]=u,d[9]=v,d[10]=o}else o=d[10];let I=o;return d[11]===Symbol.for("react.memo_cache_sentinel")?(r=[eR,!(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")&&eL],d[11]=r):r=d[11],d[12]!==I||d[13]!==y||d[14]!==h?(l=t=>e(s).createElement(n("2W0qg").default,{...t,xcss:[eU,h&&eB],"aria-label":I,testId:"team-presence-avatar-add-people-button",onClick:y},e(s).createElement(e(n("cDMVr")),{label:"",testId:"team-presence-avatar-add-people-icon",color:h?"var(--ds-icon-selected, #1868DB)":"var(--ds-icon-subtle, #505258)"})),d[12]=I,d[13]=y,d[14]=h,d[15]=l):l=d[15],d[16]!==I||d[17]!==l?(c=e(s).createElement(n("6f0Oj").default,{xcss:r},e(s).createElement(n("3gadb").default,{content:I},l)),d[16]=I,d[17]=l,d[18]=c):c=d[18],c}:({contentType:t,contentMode:a,contentId:o,analyticsTriggerSource:r="PresenceAvatarGroup",toggleEmptyPresenceDialog:i,isPopupOpen:l})=>{let{formatMessage:c}=(0,n("8C5kA").default)(),{createAnalyticsEvent:d}=(0,n("inPa6").useAnalyticsEvents)(),u=()=>(d({type:"sendUIEvent",data:{source:r,product:"confluence",action:"clicked",actionSubject:"button",actionSubjectId:"addCollaboratorsButton",attributes:{contentId:o,contentMode:a,contentType:t}}}).fire(),i()),p=c(eO.contentTypeLabel,{contentType:"page"===t&&"live"===a?"livepage":t}),f=c(eO.addPeopleLabel,{contentType:p});return e(s).createElement(n("6f0Oj").default,{xcss:[eR,!(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")&&eL]},e(s).createElement(n("3gadb").default,{content:f},t=>e(s).createElement(n("2W0qg").default,{...t,xcss:[eU,l&&eB],"aria-label":f,testId:"team-presence-avatar-add-people-button",onClick:u},e(s).createElement(e(n("cDMVr")),{label:"",testId:"team-presence-avatar-add-people-icon",color:l?"var(--ds-icon-selected, #1868DB)":"var(--ds-icon-subtle, #505258)"}))))},eF={slideInFromTop:(e,t=300)=>(e.style.transform="translateY(-20px)",e.style.opacity="0",e.animate([{transform:"translateY(-20px)",opacity:0},{transform:"translateY(0)",opacity:1}],{duration:t,easing:"cubic-bezier(.2, 0, 0, 1)",fill:"forwards"})),slideOutToBottom:(e,t=250)=>e.animate([{transform:"translateY(0)",opacity:1},{transform:"translateY(20px)",opacity:0}],{duration:t,easing:"ease-in"})},eV=(0,r.isReactCompilerActiveV1)()?t=>{let a,o=(0,i.c)(7),{children:r,flipId:l}=t;if((0,n("6mKj3").expValEquals)("cc-motion-survey-experiment","cohort","experiment")){let t,n;return o[0]!==r?(t=e(s).createElement("div",null,r),o[0]=r,o[1]=t):t=o[1],o[2]!==l||o[3]!==t?(n=e(s).createElement(U,{flipId:l,stagger:!0,onAppear:ej,onExit:eK},t),o[2]=l,o[3]=t,o[4]=n):n=o[4],n}return o[5]!==r?(a=e(s).createElement(e(s).Fragment,null,r),o[5]=r,o[6]=a):a=o[6],a}:({children:t,flipId:a})=>(0,n("6mKj3").expValEquals)("cc-motion-survey-experiment","cohort","experiment")?e(s).createElement(U,{flipId:a,stagger:!0,onAppear:e=>{let t=eF.slideInFromTop(e,400),n=()=>{e.style.transform="",e.style.opacity="",t.removeEventListener("finish",n)};t.addEventListener("finish",n)},onExit:(e,t,n)=>{eF.slideOutToBottom(e).addEventListener("finish",n)}},e(s).createElement("div",null,t)):e(s).createElement(e(s).Fragment,null,t);function ej(e){let t=eF.slideInFromTop(e,400),n=()=>{e.style.transform="",e.style.opacity="",t.removeEventListener("finish",n)};t.addEventListener("finish",n)}function eK(e,t,n){eF.slideOutToBottom(e).addEventListener("finish",n)}let eW=(0,n("cgtv4").defineMessages)({overflowLabel:{id:"team-presence.avatar-group.overflow-label",defaultMessage:"Overflow menu"},blogpostLandmark:{id:"team-presence.avatar-group.blogpost-landmark",defaultMessage:"Active people on blog post"},pageLandmark:{id:"team-presence.avatar-group.page-landmark",defaultMessage:"Active people on page"}}),ez=(0,n("ecnYn").xcss)({backgroundColor:"elevation.surface.overlay",boxShadow:"elevation.shadow.overlay",borderRadius:"radius.small",position:"relative",width:"360px"}),eG=(0,n("ecnYn").xcss)({paddingTop:"space.0",paddingBottom:"space.0"}),eH=(0,n("ecnYn").xcss)({padding:"space.075",backgroundColor:"color.background.accent.gray.subtler",borderRadius:"radius.full",color:"color.text.subtle",font:"font.heading.xxsmall",":hover":{backgroundColor:"color.background.accent.gray.subtler.hovered"},":active":{backgroundColor:"color.background.accent.gray.subtler.pressed"}}),eY=(0,n("ecnYn").xcss)({backgroundColor:"color.background.selected",color:"color.text.selected",":hover":{backgroundColor:"color.background.selected.hovered"},":active":{backgroundColor:"color.background.selected.pressed"}}),eq=(0,n("ecnYn").xcss)({minWidth:"28px",backgroundColor:"color.background.neutral.subtle",padding:"space.0",borderRadius:"radius.small",":focus-visible":{outlineColor:"color.border.focused",outlineStyle:"solid",outlineWidth:"border.width.focused",outlineOffset:"space.050"}}),eX=(0,n("ecnYn").xcss)({margin:"space.025"}),eQ=(0,n("ecnYn").xcss)({minWidth:"35px",maxWidth:"35px"}),eJ=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u,p,f,g,m,h,E,v,b,y,I,C,S,T,_,x,k,A=(0,i.c)(106),{contentId:w,contentMode:M,contentType:D,analyticSource:P,popupOpen:O,participants:R,totalParticipants:L}=t,{formatMessage:B}=(0,n("8C5kA").default)(),{createAnalyticsEvent:U}=(0,n("inPa6").useAnalyticsEvents)(),{isLoggedIn:V}=(0,n("bQm3c").useSessionData)(),j=(0,n("8Lx5S").useIsGuest)();A[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,n("6S5EB").isExternalShareRequest)(),A[0]=a):a=A[0];let K=a,[z]=(0,n("ep3mz").usePageSpaceKey)(),[G,H]=(0,s.useState)(O||!1),[Y,q]=(0,s.useState)(!1),X=F(R,V,j,K);A[1]!==X||A[2]!==j||A[3]!==V||A[4]!==R.length?(o=()=>1===R.length&&V&&!j&&!K&&!X,A[1]=X,A[2]=j,A[3]=V,A[4]=R.length,A[5]=o):o=A[5];let Q=o;A[6]!==X||A[7]!==G||A[8]!==R.length?(r=()=>{G&&R.length>1&&R.length<=4&&!X&&H(!1)},A[6]=X,A[7]=G,A[8]=R.length,A[9]=r):r=A[9],A[10]!==X||A[11]!==G||A[12]!==R?(l=[G,R,X],A[10]=X,A[11]=G,A[12]=R,A[13]=l):l=A[13],(0,s.useEffect)(r,l),A[14]!==w||A[15]!==M||A[16]!==D||A[17]!==U?(c=e=>{H(!1),q(!0),U({type:"sendUIEvent",data:{source:e,action:"clicked",actionSubject:"button",actionSubjectId:"presenceShare",attributes:{contentId:w,contentMode:M,contentType:D,shareDialog:"v2"}}}).fire()},A[14]=w,A[15]=M,A[16]=D,A[17]=U,A[18]=c):c=A[18];let J=c;A[19]!==P||A[20]!==w||A[21]!==M||A[22]!==D||A[23]!==U||A[24]!==G?(d=()=>{H(e$),U({type:"sendUIEvent",data:{source:P,action:"clicked",actionSubject:"button",actionSubjectId:"singlePresenceAvatarGroup",product:"confluence",attributes:{contentId:w,contentMode:M,contentType:D,toggle:G?"close":"open"}}}).fire()},A[19]=P,A[20]=w,A[21]=M,A[22]=D,A[23]=U,A[24]=G,A[25]=d):d=A[25];let $=d,Z=!!(R&&1===L);A[26]!==P||A[27]!==w||A[28]!==M||A[29]!==D||A[30]!==U?(u=(e,t)=>{U({type:"sendUIEvent",data:{source:P,action:"clicked",actionSubject:"button",actionSubjectId:"presenceAvatarGroupMoreButton",product:"confluence",attributes:{contentId:w,contentType:D,contentMode:M,number:t}}}).fire(),H(eZ),e.stopPropagation()},A[26]=P,A[27]=w,A[28]=M,A[29]=D,A[30]=U,A[31]=u):u=A[31];let ee=u;A[32]!==X||A[33]!==Z?(p=()=>X?"suggested-collaborators-dialog":Z?"no-collaborators-dialog":"presence-menu",A[32]=X,A[33]=Z,A[34]=p):p=A[34];let et=p();A[35]!==w||A[36]!==M||A[37]!==D||A[38]!==J||A[39]!==z||A[40]!==et?(f=()=>e(s).createElement(ec,{contentMode:M,contentId:w,contentType:D,onShareClick:J,spaceKey:z||"",testId:et}),A[35]=w,A[36]=M,A[37]=D,A[38]=J,A[39]=z,A[40]=et,A[41]=f):f=A[41];let en=f;A[42]!==w||A[43]!==M||A[44]!==D||A[45]!==J||A[46]!==z||A[47]!==et?(g=()=>e(s).createElement(W,{contentId:w,contentMode:M,contentType:D,spaceKey:z||"",onShareClick:J,testId:et}),A[42]=w,A[43]=M,A[44]=D,A[45]=J,A[46]=z,A[47]=et,A[48]=g):g=A[48];let ea=g;A[49]!==w||A[50]!==M||A[51]!==D||A[52]!==R||A[53]!==L?(m=()=>e(s).createElement(eP,{contentId:w,contentType:D,contentMode:M,participants:R,totalParticipants:L}),A[49]=w,A[50]=M,A[51]=D,A[52]=R,A[53]=L,A[54]=m):m=A[54];let eo=m;A[55]!==X||A[56]!==Z||A[57]!==ea||A[58]!==eo||A[59]!==en?(h=X?en():Z?ea():eo(),A[55]=X,A[56]=Z,A[57]=ea,A[58]=eo,A[59]=en,A[60]=h):h=A[60];let er=h,ei=L-4+1,es=X&&ei<=0;A[61]!==w||A[62]!==M||A[63]!==D||A[64]!==U||A[65]!==es?(E=()=>{es&&U({type:"sendScreenEvent",data:{name:"addCollaboratorsButton",attributes:{contentId:w,contentType:D,contentMode:M}}}).fire()},v=[es,w,D,M,U],A[61]=w,A[62]=M,A[63]=D,A[64]=U,A[65]=es,A[66]=E,A[67]=v):(E=A[66],v=A[67]),(0,s.useEffect)(E,v),A[68]!==D||A[69]!==B?(b="blogpost"===D?B(eW.blogpostLandmark):B(eW.pageLandmark),A[68]=D,A[69]=B,A[70]=b):b=A[70];let el=b;A[71]!==M?(y=(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&("edit"===M||"live"===M),A[71]=M,A[72]=y):y=A[72];let ed=y;return A[73]===Symbol.for("react.memo_cache_sentinel")?(I=e(s).createElement(n("1eaCJ").ExperienceSuccess,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE}),A[73]=I):I=A[73],A[74]!==w||A[75]!==D||A[76]!==Y||A[77]!==R.length||A[78]!==es?(C=(1===R.length||es)&&Y&&e(s).createElement(N.ShareAndRestrictDialogController,{contentId:w,contentType:D,allowRestrictions:!0,pageModes:"view",refetchButtonData:e0,onClose:()=>{q(!1)},isUnpublishedDraft:!1}),A[74]=w,A[75]=D,A[76]=Y,A[77]=R.length,A[78]=es,A[79]=C):C=A[79],A[80]===Symbol.for("react.memo_cache_sentinel")?(S=()=>H(!1),A[80]=S):S=A[80],A[81]!==er?(T=()=>e(s).createElement(n("6f0Oj").default,{xcss:ez},er),A[81]=er,A[82]=T):T=A[82],A[83]!==P||A[84]!==w||A[85]!==M||A[86]!==D||A[87]!==B||A[88]!==ed||A[89]!==Q||A[90]!==G||A[91]!==Z||A[92]!==el||A[93]!==ee||A[94]!==ei||A[95]!==R||A[96]!==es||A[97]!==$?(_=t=>e(s).createElement(n("6f0Oj").default,{...t,paddingInline:"space.050",paddingBlock:"space.025","aria-label":el,role:"region",xcss:ed&&eG,"data-vc":"presence-avatar-group"},e(s).createElement(n("2Pg7f").default,{appearance:"stack",size:"small",maxCount:4,data:R,testId:"presence-avatar-group",label:el,borderColor:"var(--ds-background-neutral, #0515240F)",onMoreClick:e=>ee(e,ei),shouldPopupRenderToParent:!1,isTooltipDisabled:!0,overrides:{Avatar:{render:(t,a,o)=>e(s).createElement(eV,{flipId:`PresenceAvatarButton-${o}`},e(s).createElement(n("bUlM5").default,{alignItems:"center"},e(s).createElement(eS,{key:`PresenceAvatarButton-${o}`,index:o,participant:R[o],contentMode:M,contentType:D,contentId:w,isSingleParticipant:Z,isEligibleForEmptyPresenceDialog:Q(),toggleEmptyPresenceDialog:$,avatarProps:a,analyticSource:P}),es&&o===R.length-1&&e(s).createElement(eN,{contentType:D,contentMode:M,contentId:w,toggleEmptyPresenceDialog:$,isPopupOpen:G,analyticsTriggerSource:P})))},MoreIndicator:{render:(t,a)=>{let{buttonProps:o,isActive:r,borderColor:i,...l}=a;return e(s).createElement(eV,{flipId:"more-indicator"},e(s).createElement(n("2W0qg").default,{type:"submit",...o,...l,padding:(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")?"space.0":"space.025",onClick:l.onClick,xcss:[eq,!(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")&&eX,ei>100&&eQ],testId:l.testId,"data-vc":"presence-overflow","aria-label":B(eW.overflowLabel)},e(s).createElement(n("6f0Oj").default,{xcss:[eH,G&&eY]},ei)))}}}})),A[83]=P,A[84]=w,A[85]=M,A[86]=D,A[87]=B,A[88]=ed,A[89]=Q,A[90]=G,A[91]=Z,A[92]=el,A[93]=ee,A[94]=ei,A[95]=R,A[96]=es,A[97]=$,A[98]=_):_=A[98],A[99]!==G||A[100]!==T||A[101]!==_?(x=e(s).createElement(n("lGgRw").default,{isOpen:G,onClose:S,placement:"bottom-end",content:T,trigger:_}),A[99]=G,A[100]=T,A[101]=_,A[102]=x):x=A[102],A[103]!==C||A[104]!==x?(k=e(s).createElement(e(s).Fragment,null,I,C,x),A[103]=C,A[104]=x,A[105]=k):k=A[105],k}:({contentId:t,contentMode:a,contentType:o,analyticSource:r,popupOpen:i,participants:l,totalParticipants:c})=>{let{formatMessage:d}=(0,n("8C5kA").default)(),{createAnalyticsEvent:u}=(0,n("inPa6").useAnalyticsEvents)(),{isLoggedIn:p}=(0,n("bQm3c").useSessionData)(),f=(0,n("8Lx5S").useIsGuest)(),g=(0,n("6S5EB").isExternalShareRequest)(),[m]=(0,n("ep3mz").usePageSpaceKey)(),[h,E]=(0,s.useState)(i||!1),[v,b]=(0,s.useState)(!1),y=F(l,p,f,g),I=(0,s.useCallback)(()=>1===l.length&&p&&!f&&!g&&!y,[l,p,f,g,y]);(0,s.useEffect)(()=>{h&&l.length>1&&l.length<=4&&!y&&E(!1)},[h,l,y]);let C=(0,s.useCallback)(e=>{E(!1),b(!0),u({type:"sendUIEvent",data:{source:e,action:"clicked",actionSubject:"button",actionSubjectId:"presenceShare",attributes:{contentId:t,contentMode:a,contentType:o,shareDialog:"v2"}}}).fire()},[t,a,o,u]),S=(0,s.useCallback)(()=>{E(e=>!e),u({type:"sendUIEvent",data:{source:r,action:"clicked",actionSubject:"button",actionSubjectId:"singlePresenceAvatarGroup",product:"confluence",attributes:{contentId:t,contentMode:a,contentType:o,toggle:h?"close":"open"}}}).fire()},[t,a,o,r,u,h]),T=!!(l&&1===c),_=(0,s.useCallback)((e,n)=>{u({type:"sendUIEvent",data:{source:r,action:"clicked",actionSubject:"button",actionSubjectId:"presenceAvatarGroupMoreButton",product:"confluence",attributes:{contentId:t,contentType:o,contentMode:a,number:n}}}).fire(),E(e=>!e),e.stopPropagation()},[t,o,a,r,u]),x=y?"suggested-collaborators-dialog":T?"no-collaborators-dialog":"presence-menu",k=y?e(s).createElement(ec,{contentMode:a,contentId:t,contentType:o,onShareClick:C,spaceKey:m||"",testId:x}):T?e(s).createElement(W,{contentId:t,contentMode:a,contentType:o,spaceKey:m||"",onShareClick:C,testId:x}):e(s).createElement(eP,{contentId:t,contentType:o,contentMode:a,participants:l,totalParticipants:c}),A=c-4+1,w=y&&A<=0;(0,s.useEffect)(()=>{w&&u({type:"sendScreenEvent",data:{name:"addCollaboratorsButton",attributes:{contentId:t,contentType:o,contentMode:a}}}).fire()},[w,t,o,a,u]);let M="blogpost"===o?d(eW.blogpostLandmark):d(eW.pageLandmark),D=(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&("edit"===a||"live"===a);return e(s).createElement(e(s).Fragment,null,e(s).createElement(n("1eaCJ").ExperienceSuccess,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE}),(1===l.length||w)&&v&&e(s).createElement(N.ShareAndRestrictDialogController,{contentId:t,contentType:o,allowRestrictions:!0,pageModes:"view",refetchButtonData:()=>{},onClose:()=>{b(!1)},isUnpublishedDraft:!1}),e(s).createElement(n("lGgRw").default,{isOpen:h,onClose:()=>E(!1),placement:"bottom-end",content:()=>e(s).createElement(n("6f0Oj").default,{xcss:ez},k),trigger:i=>e(s).createElement(n("6f0Oj").default,{...i,paddingInline:"space.050",paddingBlock:"space.025","aria-label":M,role:"region",xcss:D&&eG,"data-vc":"presence-avatar-group"},e(s).createElement(n("2Pg7f").default,{appearance:"stack",size:"small",maxCount:4,data:l,testId:"presence-avatar-group",label:M,borderColor:"var(--ds-background-neutral, #0515240F)",onMoreClick:e=>_(e,A),shouldPopupRenderToParent:!1,isTooltipDisabled:!0,overrides:{Avatar:{render:(i,c,d)=>e(s).createElement(eV,{flipId:`PresenceAvatarButton-${d}`},e(s).createElement(n("bUlM5").default,{alignItems:"center"},e(s).createElement(eS,{key:`PresenceAvatarButton-${d}`,index:d,participant:l[d],contentMode:a,contentType:o,contentId:t,isSingleParticipant:T,isEligibleForEmptyPresenceDialog:I(),toggleEmptyPresenceDialog:S,avatarProps:c,analyticSource:r}),w&&d===l.length-1&&e(s).createElement(eN,{contentType:o,contentMode:a,contentId:t,toggleEmptyPresenceDialog:S,isPopupOpen:h,analyticsTriggerSource:r})))},MoreIndicator:{render:(t,{buttonProps:a,isActive:o,borderColor:r,...i})=>e(s).createElement(eV,{flipId:"more-indicator"},e(s).createElement(n("2W0qg").default,{type:"submit",...a,...i,padding:(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")?"space.0":"space.025",onClick:i.onClick,xcss:[eq,!(0,n("9wGTI").fg)("platform-avatar-group-spacing-fix")&&eX,A>100&&eQ],testId:i.testId,"data-vc":"presence-overflow","aria-label":d(eW.overflowLabel)},e(s).createElement(n("6f0Oj").default,{xcss:[eH,h&&eY]},A)))}}}))}))};function e$(e){return!e}function eZ(e){return!e}function e0(){}let e1=(0,r.isReactCompilerActiveV1)()?e=>{let t,a,o,r,l,c,d,u=(0,i.c)(20),{contentId:p,contentMode:f,contentType:g,participants:m,provider:h}=e,{userId:E}=(0,n("bQm3c").useSessionData)(),{createAnalyticsEvent:v}=(0,n("inPa6").useAnalyticsEvents)();u[0]!==m||u[1]!==E?(t=()=>m.get(E??"unidentified"),u[0]=m,u[1]=E,u[2]=t):t=u[2];let b=t;u[3]!==h?(a=()=>h?.getParticipants().length??0,u[3]=h,u[4]=a):a=u[4];let y=a;u[5]!==f||u[6]!==g?(o=()=>["blogpost","page"].includes(g)&&"view"===f,u[5]=f,u[6]=g,u[7]=o):o=u[7];let I=o;u[8]!==p||u[9]!==g||u[10]!==v||u[11]!==h?(r=(e,t)=>{let n=e&&Object.keys(e.sessions).length>50;(n||t>1e3)&&(h?.destroy(),v({type:"sendTrackEvent",data:{source:"presenceAvatarGroup",action:"destroyConnection",actionSubject:"presenceAvatarGroupConnection",attributes:{sessionLimitType:n?"currentUser":"totalSessions",contentId:p,contentType:g}}}).fire())},u[8]=p,u[9]=g,u[10]=v,u[11]=h,u[12]=r):r=u[12];let C=r;return u[13]!==C||u[14]!==b||u[15]!==y||u[16]!==I?(l=()=>{I()&&C(b(),y())},c=[C,b,y,I],u[13]=C,u[14]=b,u[15]=y,u[16]=I,u[17]=l,u[18]=c):(l=u[17],c=u[18]),(0,s.useEffect)(l,c),u[19]===Symbol.for("react.memo_cache_sentinel")?(d={},u[19]=d):d=u[19],d}:({contentId:e,contentMode:t,contentType:a,participants:o,provider:r})=>{let{userId:i}=(0,n("bQm3c").useSessionData)(),{createAnalyticsEvent:l}=(0,n("inPa6").useAnalyticsEvents)(),c=(0,s.useCallback)(()=>o.get(i??"unidentified"),[o,i]),d=(0,s.useCallback)(()=>r?.getParticipants().length??0,[r]),u=(0,s.useCallback)(()=>["blogpost","page"].includes(a)&&"view"===t,[a,t]),p=(0,s.useCallback)((t,n)=>{let o=t&&Object.keys(t.sessions).length>50;(o||n>1e3)&&(r?.destroy(),l({type:"sendTrackEvent",data:{source:"presenceAvatarGroup",action:"destroyConnection",actionSubject:"presenceAvatarGroupConnection",attributes:{sessionLimitType:o?"currentUser":"totalSessions",contentId:e,contentType:a}}}).fire())},[e,a,l,r]);return(0,s.useEffect)(()=>{u()&&p(c(),d())},[p,c,d,u]),{}},e2=e=>(0,n("gKr8t").getAGGClient)().query({query:(0,n("eSUdr").default)`query fetchPresenceAGGUsersQuery($accountIds:[ID!]!){users(accountIds:$accountIds){accountId name picture}}`,variables:{accountIds:e}}).then(({data:e})=>e?.users?.filter(e=>e?.accountId).map(e=>({avatar:e.picture??"",email:"",name:e.name??"",userId:e.accountId||""}))??[]),e5=e=>(0,n("hp2SH").getApolloClient)().query({query:(0,n("eSUdr").default)`query fetchPresenceConfluenceUsersQuery($accountIds:[String]){confluenceUsers(accountIds:$accountIds){nodes{profilePicture{isDefault path(type:RELATIVE)}...on KnownUser{accountId}...on UnknownUser{accountId}displayName}}}`,variables:{accountIds:e}}).then(({data:e})=>e?.confluenceUsers?.nodes?.filter(e=>e?.accountId).map(e=>({avatar:e?.profilePicture?.path??"",email:"",isGuest:void 0,name:e?.displayName??"",userId:e?.accountId??""}))??[]),e4=(0,r.isReactCompilerActiveV1)()?()=>{let e,t=(0,i.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e={fetchAnonymousAsset:e3},t[0]=e):e=t[0],e}:()=>({fetchAnonymousAsset:(0,s.useCallback)(e=>{let t=e?(0,n("jyw2s").getHashCode)(e):0,a=d(e).svgBackgroundColor;return(0,n("83Vfg").getAnonymousAvatarWithStyling)({styleProperties:{"background-color":a},index:t})},[])});function e3(e){let t=e?(0,n("jyw2s").getHashCode)(e):0,a=d(e).svgBackgroundColor;return(0,n("83Vfg").getAnonymousAvatarWithStyling)({styleProperties:{"background-color":a},index:t})}let e6=(e,t,a,o)=>{let r="view"===a,[{collabEditInitialized:i,collabEditProvider:l}]=(0,n("hYoU4").useNativeCollabState)(),[{presenceId:c}]=(0,n("2VZOl").useNativeCollabPresenceState)(),{add:d,remove:u,addTelepointerData:p}=C(),f=S(),{cloudId:h,activationId:E,userId:y,isLoggedIn:I}=(0,n("bQm3c").useSessionData)(),T=(0,n("8Lx5S").useIsLicensed)(),_=(0,n("8Lx5S").useIsGuest)(),{fetchAnonymousAsset:x}=e4(),k=(0,s.useRef)(new Set),A=(0,s.useRef)(l),w=(0,s.useRef)(c),[M,D]=(0,s.useState)(!1),[P,O]=(0,s.useState)(void 0);e1({contentId:e,contentType:t,contentMode:a,participants:f,provider:A.current});let R=(0,s.useCallback)(e=>!_&&I&&T?e5(e):e2(e),[_,I,T]),L=(0,s.useCallback)(async e=>{try{return await x(e)}catch(e){B(e)}},[x]),B=e=>{O(e),(0,n("7Sm4c").markErrorAsHandled)(e)},U=(0,s.useCallback)(()=>{let e=A.current?.getParticipants().filter(e=>e.isHydrated);e?.forEach(e=>{k.current.add(e.sessionId),d(e)});let t=e?.map(e=>e.sessionId)??[];k.current.forEach(e=>{t.includes(e)||(u(e),k.current.delete(e))})},[d,u]),N=(0,s.useCallback)(()=>{let a=(0,n("8KbKw").fetchCollabPermissionToken)(e,void 0),o=`ari:cloud:confluence:${h}:${t}/${e}`,r=y??w.current,i=(0,n("hvdlr").createSocketIOCollabProvider)({url:g(),path:m(h,E),documentAri:o,permissionTokenRefresh:a,need404:!0,isPresenceOnly:!0,productInfo:{product:"confluence",subProduct:"team-presence"},batchProps:{batchSize:25,participantsLimit:void 0,getUsers:R,onError:B},fetchAnonymousAsset:L,presenceId:r,presenceActivity:"viewer"});i.setupForPresenceOnly(v()),A.current=i,D(!0)},[h,E,e,t,L,R,y]);return(0,s.useEffect)(()=>(r?N():D(!0),!A.current&&l&&(A.current=l),A.current?.on("presence",U),A.current?.on("presence:changed",U),A.current?.on("telepointer",p),()=>{A.current?.off("presence",U),A.current?.off("presence:changed",U),A.current?.off("telepointer",p),r&&A.current?.destroy()}),[p,l,r,N,U]),(0,s.useEffect)(()=>{!r&&i&&A.current?.sendMessage({type:"participant:activity",activity:o})},[o,i,r]),(0,s.useEffect)(()=>{w.current=c},[c]),{isInitialized:M,provider:A.current,presenceId:c,sessionId:A.current?.getSessionId()??b,networkError:P,totalParticipants:(()=>{let e=new Set;return f.forEach(t=>e.add(t.presenceId)),A.current?.getParticipants().forEach(t=>e.add(t.presenceId)),e.size})()}},e8=(0,n("cgtv4").defineMessages)({anonymousUser:{id:"team-presence.avatar-group.anonymous-user",defaultMessage:"Anonymous Person"}}),e7=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c,d,u,p,f=(0,i.c)(28),{contentId:g,contentMode:m,contentType:h,activity:E,analyticSource:v}=t,{formatMessage:b}=(0,n("8C5kA").default)(),{sessionId:y,networkError:I,totalParticipants:C}=e6(g,h,m,E);f[0]!==b?(a=b(e8.anonymousUser),f[0]=b,f[1]=a):a=f[1],f[2]!==E||f[3]!==y||f[4]!==a?(o={activity:E,sessionId:y,anonymousName:a},f[2]=E,f[3]=y,f[4]=a,f[5]=o):o=f[5];let S=T(o);if(I){let t;return f[6]!==I?(t=e(s).createElement(n("gfIPU").ExperienceFailure,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE,error:I}),f[6]=I,f[7]=t):t=f[7],t}f[8]!==S?(r=S.some(te),f[8]=S,f[9]=r):r=f[9];let _=r;f[10]!==S?(l=S.some(tt),f[10]=S,f[11]=l):l=f[11];let x=l;return f[12]!==_||f[13]!==x?(c=e(s).createElement(n("cbc8g").default,{data:{nonGuestShowsDefaultProfile:_,showsDefaultProfile:x}}),f[12]=_,f[13]=x,f[14]=c):c=f[14],f[15]!==v||f[16]!==g||f[17]!==m||f[18]!==h||f[19]!==S||f[20]!==C?(d=e(s).createElement(eJ,{contentId:g,contentMode:m,contentType:h,analyticSource:v,participants:S,totalParticipants:C}),f[15]=v,f[16]=g,f[17]=m,f[18]=h,f[19]=S,f[20]=C,f[21]=d):d=f[21],f[22]!==d||f[23]!==C?(u=e(s).createElement(e9,{flipKey:C},d),f[22]=d,f[23]=C,f[24]=u):u=f[24],f[25]!==c||f[26]!==u?(p=e(s).createElement(e(s).Fragment,null,c,u),f[25]=c,f[26]=u,f[27]=p):p=f[27],p}:({contentId:t,contentMode:a,contentType:o,activity:r,analyticSource:i})=>{let{formatMessage:l}=(0,n("8C5kA").default)(),{sessionId:c,networkError:d,totalParticipants:u}=e6(t,o,a,r),p=T({activity:r,sessionId:c,anonymousName:l(e8.anonymousUser)});if(d)return e(s).createElement(n("gfIPU").ExperienceFailure,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE,error:d});let f=p.some(e=>""===e.src&&!e.isGuest),g=p.some(e=>""===e.src);return e(s).createElement(e(s).Fragment,null,e(s).createElement(n("cbc8g").default,{data:{nonGuestShowsDefaultProfile:f,showsDefaultProfile:g}}),e(s).createElement(e9,{flipKey:u},e(s).createElement(eJ,{contentId:t,contentMode:a,contentType:o,analyticSource:i,participants:p,totalParticipants:u})))},e9=(0,r.isReactCompilerActiveV1)()?t=>{let a,o=(0,i.c)(7),{children:r,flipKey:l}=t;if((0,n("6mKj3").expValEquals)("cc-motion-survey-experiment","cohort","experiment")){let t,n,a;return o[0]===Symbol.for("react.memo_cache_sentinel")?(t={stiffness:200,damping:28},n={default:{speed:.3}},o[0]=t,o[1]=n):(t=o[0],n=o[1]),o[2]!==r||o[3]!==l?(a=e(s).createElement(O,{flipKey:l,spring:t,staggerConfig:n},r),o[2]=r,o[3]=l,o[4]=a):a=o[4],a}return o[5]!==r?(a=e(s).createElement(e(s).Fragment,null,r),o[5]=r,o[6]=a):a=o[6],a}:({children:t,flipKey:a})=>(0,n("6mKj3").expValEquals)("cc-motion-survey-experiment","cohort","experiment")?e(s).createElement(O,{flipKey:a,spring:{stiffness:200,damping:28},staggerConfig:{default:{speed:.3}}},t):e(s).createElement(e(s).Fragment,null,t);function te(e){return""===e.src&&!e.isGuest}function tt(e){return""===e.src}let tn="viewer",ta="view",to=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,l,c=(0,i.c)(14),{collaborators:d,contentId:u,contentType:p,analyticSource:f}=t,g=S(),[m]=(0,n("2VZOl").useNativeCollabPresenceState)(),{presenceId:h}=m;c[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,n("6S5EB").isExternalShareRequest)(),c[0]=a):a=c[0];let E=a,{userId:v}=(0,n("bQm3c").useSessionData)(),b="database"===p&&!E,y=tr;c[1]!==g||c[2]!==h||c[3]!==b||c[4]!==v?(o=e=>{if(!b&&e?.me){let{me:t}=e;return{activity:tn,color:t.color,followCursor:t.followCursor,id:t.userId,isCurrentUser:!0,name:t.name,onClick:y(t),src:t.avatar.src??"",userId:t.userId}}if(b){let e=v??h,t=e?g.get(e):void 0;if(t)return{activity:tn,id:t.id,isCurrentUser:!0,isGuest:t.isGuest,name:t.name,src:t.src,userId:t.userId}}},c[1]=g,c[2]=h,c[3]=b,c[4]=v,c[5]=o):o=c[5];let I=o;if(c[6]!==d||c[7]!==I){r=[];let e=I(d);e&&r.push(e),d?.collaborators?.forEach(e=>{let t=e.userId;r.push({id:t,userId:t,name:e.name,color:e.color,src:e.avatar.src??"",activity:tn,onClick:y(e),followCursor:e.followCursor})}),c[6]=d,c[7]=I,c[8]=r}else r=c[8];let C=r;return c[9]!==f||c[10]!==u||c[11]!==p||c[12]!==C?(l=e(s).createElement(eJ,{contentId:u,contentMode:ta,contentType:p,analyticSource:f,participants:C,totalParticipants:C.length}),c[9]=f,c[10]=u,c[11]=p,c[12]=C,c[13]=l):l=c[13],l}:({collaborators:t,contentId:a,contentType:o,analyticSource:r})=>{let i=S(),[{presenceId:l}]=(0,n("2VZOl").useNativeCollabPresenceState)(),c=(0,n("6S5EB").isExternalShareRequest)(),{userId:d}=(0,n("bQm3c").useSessionData)(),u="database"===o&&!c,p=e=>!0===e.followCursor?()=>{e.onClick?.()}:e.onClick,f=(0,s.useCallback)(e=>{if(!u&&e?.me){let{me:t}=e;return{activity:tn,color:t.color,followCursor:t.followCursor,id:t.userId,isCurrentUser:!0,name:t.name,onClick:p(t),src:t.avatar.src??"",userId:t.userId}}if(u){let e=d??l,t=e?i.get(e):void 0;if(t)return{activity:tn,id:t.id,isCurrentUser:!0,isGuest:t.isGuest,name:t.name,src:t.src,userId:t.userId}}},[i,l,u,d]),g=(0,s.useMemo)(()=>{let e=[],n=f(t);return n&&e.push(n),t?.collaborators?.forEach(t=>{let n=t.userId;e.push({id:n,userId:n,name:t.name,color:t.color,src:t.avatar.src??"",activity:tn,onClick:p(t),followCursor:t.followCursor})}),e},[t,f]);return e(s).createElement(eJ,{contentId:a,contentMode:ta,contentType:o,analyticSource:r,participants:g,totalParticipants:g.length})};function tr(e){return!0===e.followCursor?()=>{e.onClick?.()}:e.onClick}let ti=({presenceId:e,activity:t,user:n,isGuest:a})=>{if(!n)return;let o=n?.id??e;return{id:o,userId:n?.id??"unidentified",presenceId:o,name:n?.displayName??"",src:n?.photos?.[0]?.value??"",isCurrentUser:!0,isGuest:a,sessions:{[b]:{activity:t}}}},ts="content-header-presence",tl=({collaborators:t,contentId:a,contentType:o,isViewMode:r,analyticSource:i})=>{let l=(0,s.useContext)(n("1kHsc").ExperienceTrackerContext),{cloudId:c}=(0,n("bQm3c").useSessionData)(),d=(0,n("8Lx5S").useIsGuest)(),u=(0,n("cLo2u").useSpaceKey)(),p=(0,n("de2j9").useIsEditorPage)(),f=(0,n("3jwuS").useIsCurrentPageLive)(),[{isEditMode:g}]=(0,n("efvKr").useLivePageMode)(),{fetchAnonymousAsset:m}=e4(),h="whiteboard"===o||"database"===o,{data:E,error:v}=(0,n("xQxzY").useQuery)((0,n("eSUdr").default)`query ContentHeaderPresenceUserQuery{user:confluence_atlassianUser(current:true){id displayName photos{value isPrimary}}}`),[{presenceId:b}]=(0,n("2VZOl").useNativeCollabPresenceState)(),y=(0,s.useRef)(b),I="view";f?I="live":p&&(I="edit");let C="edit"===I||"live"===I&&(g||!r)?"editor":"viewer",{data:S,error:T}=(0,n("xQxzY").useQuery)((0,n("eSUdr").default)`query ContentHeaderPresenceContentSettingsQuery($cloudId:ID!$spaceKey:String!){confluence_teamPresenceContentSetting(cloudId:$cloudId spaceKey:$spaceKey){isEnabledOnContentView}}`,{variables:{cloudId:c,spaceKey:u??""},skip:h||"view"!==I}),_=v||T,k=(0,s.useCallback)(()=>h||S?.confluence_teamPresenceContentSetting?.isEnabledOnContentView===!0,[h,S]),A=e=>(l.fail({name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE,error:e}),(0,n("7Sm4c").markErrorAsHandled)(e),null);return o?(_&&A(_),"view"!==I||k())?e(s).createElement(x,{participant:ti({presenceId:y.current,activity:C,user:E?.user,isGuest:d}),fetchAnonymousAsset:m,onError:A},h?e(s).createElement(to,{collaborators:t,contentId:a,contentType:o,analyticSource:i}):e(s).createElement(e7,{contentId:a,contentMode:I,contentType:o,activity:C,analyticSource:i})):(l.abort({name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE,reason:"Real-time visibility is disabled on view mode"}),null):null},tc=(0,r.isReactCompilerActiveV1)()?t=>{let a,o,r,c=(0,i.c)(6);return c[0]===Symbol.for("react.memo_cache_sentinel")?(a=e(s).createElement(n("ln0hx").ExperienceStart,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE}),c[0]=a):a=c[0],c[1]!==t?(o=e(s).createElement(tl,t),c[1]=t,c[2]=o):o=c[2],c[3]!==t.contentId||c[4]!==o?(r=e(s).createElement(l.ErrorBoundary,{attribution:n("3IBnw").Attribution.COLLABORATION_PRESENCE},e(s).createElement(n("hnvzE").default,{name:ts},e(s).createElement(n("2VZOl").NativeCollabPresenceStateContainer,{scope:t.contentId},a,o))),c[3]=t.contentId,c[4]=o,c[5]=r):r=c[5],r}:t=>e(s).createElement(l.ErrorBoundary,{attribution:n("3IBnw").Attribution.COLLABORATION_PRESENCE},e(s).createElement(n("hnvzE").default,{name:ts},e(s).createElement(n("2VZOl").NativeCollabPresenceStateContainer,{scope:t.contentId},e(s).createElement(n("ln0hx").ExperienceStart,{name:n("irVI7").TEAM_PRESENCE_AVATAR_GROUP_VIEW_EXPERIENCE}),e(s).createElement(tl,t))));t.exports.ContentHeaderPresenceComponent=tl,t.exports.ContentHeaderPresence=tc}),a("2VZOl",function(e,t){var a=n("9HkI0");let o=(0,n("FOT9i").createContainer)(),r=(0,n("1P1Tu").createStore)({containedBy:o,initialState:{presenceId:""},actions:{},handlers:{onInit:()=>({setState:e})=>{e({presenceId:(0,a.v4)()})}}}),i=(0,n("9zUhf").createHook)(r);e.exports.NativeCollabPresenceStateContainer=o,e.exports.useNativeCollabPresenceState=i}),a("de2j9",function(e,t){var a=n("3u0dr");let o={selector:e=>e===n("1NBp8").EDIT_PAGE_V2.name||e===n("1NBp8").EDIT_BLOG_V2.name||e===n("1NBp8").EDIT_PAGE_EMBED.name||e===n("1NBp8").COMPANY_HUB_EDIT.name||e===n("1NBp8").HUB_EDIT.name||e===n("1NBp8").EDIT_PAGE_SMART_CREATE.name},r=((0,a.isReactCompilerActiveV1)(),()=>(0,n("dPJCf").useRouteName)(o));e.exports.useIsEditorPage=r}),a("jyw2s",function(e,t){function a(e){let t=0;for(let n=0;n<e.length;n++)t=((t=(t<<5)-t+e.charCodeAt(n))&t)>>>0;return t}e.exports.getHashCode=a,e.exports.getParticipantColor=function(e){let t=a(e)%n("aFUXX").participantColors.length;return{index:t,color:n("aFUXX").participantColors[t]}}}),a("5ig3T",function(e,t){function n(e){if(e.constructor!==Array)throw TypeError("Expected array.");if(16===e.length)return e;if(6===e.length){var t=a();return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t}throw RangeError("Expected array with either 6 or 16 values.")}function a(){for(var e=[],t=0;t<16;t++)t%5==0?e.push(1):e.push(0);return e}function o(e,t){for(var a=n(e),o=n(t),r=[],i=0;i<4;i++)for(var s=[a[i],a[i+4],a[i+8],a[i+12]],l=0;l<4;l++){var c=4*l,d=[o[c],o[c+1],o[c+2],o[c+3]],u=s[0]*d[0]+s[1]*d[1]+s[2]*d[2]+s[3]*d[3];r[i+c]=u}return r}var r,i=function(e){return"number"==typeof e},s=function(e){return"function"==typeof e},l=function(e){return"[object Object]"===Object.prototype.toString.call(e)},c=function(e){return Array.prototype.slice.apply(e)},d=function(e){var t=e.reduce(function(e,t){return e[t]=(e[t]||0)+1,e},{});return Object.keys(t).filter(function(e){return t[e]>1})};function u(e){return[].slice.call(arguments,1).forEach(function(t){if(t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}),e}var p,f=function(e,t,n){return e+(t-e)*n},g="data-flip-id",m="data-inverse-flip-id",h="data-portal-key",E="data-exit-container",v={noWobble:{stiffness:200,damping:26},gentle:{stiffness:120,damping:14},veryGentle:{stiffness:130,damping:17},wobbly:{stiffness:180,damping:12},stiff:{stiffness:260,damping:26}},b=function(e){return l(e)?e:Object.keys(v).indexOf(e)>-1?v[e]:{}};"undefined"!=typeof window&&(p=window.requestAnimationFrame);var y=p=p||function(e){window.setTimeout(e,1e3/60)},I=Date.now(),C="object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:function(){return Date.now()-I};function S(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}var T=function(){function e(){}return e.prototype.run=function(){var e=this;y(function(){e.springSystem.loop(C())})},e}(),_=function(){this.position=0,this.velocity=0},x=0,k=function(){function e(e){this._id="s"+x++,this._springSystem=e,this.listeners=[],this._startValue=0,this._currentState=new _,this._displacementFromRestThreshold=.001,this._endValue=0,this._overshootClampingEnabled=!1,this._previousState=new _,this._restSpeedThreshold=.001,this._tempState=new _,this._timeAccumulator=0,this._wasAtRest=!0,this._cachedSpringConfig={}}var t=e.prototype;return t.getId=function(){return this._id},t.destroy=function(){this.listeners=[],this._springSystem.deregisterSpring(this)},t.setSpringConfig=function(e){return this._springConfig=e,this},t.getCurrentValue=function(){return this._currentState.position},t.getDisplacementDistanceForState=function(e){return Math.abs(this._endValue-e.position)},t.setEndValue=function(e){if(e===this._endValue||(this.prevEndValue=e,this._endValue===e&&this.isAtRest()))return this;this._startValue=this.getCurrentValue(),this._endValue=e,this._springSystem.activateSpring(this.getId());for(var t=0,n=this.listeners.length;t<n;t++){var a=this.listeners[t].onSpringEndStateChange;a&&a(this)}return this},t.setVelocity=function(e){return e===this._currentState.velocity||(this._currentState.velocity=e,this._springSystem.activateSpring(this.getId())),this},t.setCurrentValue=function(e){this._startValue=e,this._currentState.position=e;for(var t=0,n=this.listeners.length;t<n;t++){var a=this.listeners[t];a.onSpringUpdate&&a.onSpringUpdate(this)}return this},t.setAtRest=function(){return this._endValue=this._currentState.position,this._tempState.position=this._currentState.position,this._currentState.velocity=0,this},t.setOvershootClampingEnabled=function(e){return this._overshootClampingEnabled=e,this},t.isOvershooting=function(){var e=this._startValue,t=this._endValue;return this._springConfig.tension>0&&(e<t&&this.getCurrentValue()>t||e>t&&this.getCurrentValue()<t)},t.advance=function(e,t){var n=this.isAtRest();if(!n||!this._wasAtRest){var a=t;t>.064&&(a=.064),this._timeAccumulator+=a;for(var o,r,i,s,l,c,d=this._springConfig.tension,u=this._springConfig.friction,p=this._currentState.position,f=this._currentState.velocity,g=this._tempState.position,m=this._tempState.velocity;this._timeAccumulator>=.001;)this._timeAccumulator-=.001,this._timeAccumulator<.001&&(this._previousState.position=p,this._previousState.velocity=f),r=d*(this._endValue-g)-u*f,s=d*(this._endValue-(g=p+.001*(o=f)*.5))-u*(m=f+.001*r*.5),c=d*(this._endValue-(g=p+.001*(i=m)*.5))-u*(m=f+.001*s*.5),g=p+.001*(l=m),p+=1/6*(o+2*(i+l)+(m=f+.001*c))*.001,f+=1/6*(r+2*(s+c)+(d*(this._endValue-g)-u*m))*.001;this._tempState.position=g,this._tempState.velocity=m,this._currentState.position=p,this._currentState.velocity=f,this._timeAccumulator>0&&this._interpolate(this._timeAccumulator/.001),(this.isAtRest()||this._overshootClampingEnabled&&this.isOvershooting())&&(this._springConfig.tension>0?(this._startValue=this._endValue,this._currentState.position=this._endValue):(this._endValue=this._currentState.position,this._startValue=this._endValue),this.setVelocity(0),n=!0);var h=!1;this._wasAtRest&&(this._wasAtRest=!1,h=!0);var E=!1;n&&(this._wasAtRest=!0,E=!0),this.notifyPositionUpdated(h,E)}},t.notifyPositionUpdated=function(e,t){var n=this;this.listeners.filter(Boolean).forEach(function(a){e&&a.onSpringActivate&&!n._onActivateCalled&&(a.onSpringActivate(n),n._onActivateCalled=!0),a.onSpringUpdate&&a.onSpringUpdate(n),t&&a.onSpringAtRest&&a.onSpringAtRest(n)})},t.systemShouldAdvance=function(){return!this.isAtRest()||!this.wasAtRest()},t.wasAtRest=function(){return this._wasAtRest},t.isAtRest=function(){return Math.abs(this._currentState.velocity)<this._restSpeedThreshold&&(this.getDisplacementDistanceForState(this._currentState)<=this._displacementFromRestThreshold||0===this._springConfig.tension)},t._interpolate=function(e){this._currentState.position=this._currentState.position*e+this._previousState.position*(1-e),this._currentState.velocity=this._currentState.velocity*e+this._previousState.velocity*(1-e)},t.addListener=function(e){return this.listeners.push(e),this},t.addOneTimeListener=function(e){var t=this;return Object.keys(e).forEach(function(n){var a;e[n]=(a=e[n],function(){a.apply(void 0,[].slice.call(arguments)),t.removeListener(e)})}),this.listeners.push(e),this},t.removeListener=function(e){return S(this.listeners,e),this},e}(),A=function(){function e(e){this.looper=e||new T,this.looper.springSystem=this,this.listeners=[],this._activeSprings=[],this._idleSpringIndices=[],this._isIdle=!0,this._lastTimeMillis=-1,this._springRegistry={}}var t=e.prototype;return t.createSpring=function(e,t){return this.createSpringWithConfig({tension:e,friction:t})},t.createSpringWithConfig=function(e){var t=new k(this);return this.registerSpring(t),t.setSpringConfig(e),t},t.getIsIdle=function(){return this._isIdle},t.registerSpring=function(e){this._springRegistry[e.getId()]=e},t.deregisterSpring=function(e){S(this._activeSprings,e),delete this._springRegistry[e.getId()]},t.advance=function(e,t){for(var n=this;this._idleSpringIndices.length>0;)this._idleSpringIndices.pop();for(this._activeSprings.filter(Boolean).forEach(function(a){a.systemShouldAdvance()?a.advance(e/1e3,t/1e3):n._idleSpringIndices.push(n._activeSprings.indexOf(a))});this._idleSpringIndices.length>0;){var a=this._idleSpringIndices.pop();a>=0&&this._activeSprings.splice(a,1)}},t.loop=function(e){-1===this._lastTimeMillis&&(this._lastTimeMillis=e-1);var t,n=e-this._lastTimeMillis;this._lastTimeMillis=e;var a=0,o=this.listeners.length;for(a=0;a<o;a++)(t=this.listeners[a]).onBeforeIntegrate&&t.onBeforeIntegrate(this);for(this.advance(e,n),0===this._activeSprings.length&&(this._isIdle=!0,this._lastTimeMillis=-1),a=0;a<o;a++)(t=this.listeners[a]).onAfterIntegrate&&t.onAfterIntegrate(this);this._isIdle||this.looper.run()},t.activateSpring=function(e){var t=this._springRegistry[e];-1===this._activeSprings.indexOf(t)&&this._activeSprings.push(t),this.getIsIdle()&&(this._isIdle=!1,this.looper.run())},e}(),w=new A,M=function(e){var t=e.springConfig,n=t.overshootClamping,a=e.getOnUpdateFunc,o=e.onAnimationEnd,r=e.onSpringActivate,i=w.createSpring(t.stiffness,t.damping);i.setOvershootClampingEnabled(!!n);var s={onSpringActivate:r,onSpringAtRest:function(){i.destroy(),o()},onSpringUpdate:a({spring:i,onAnimationEnd:o})};return i.addListener(s),i},D=function(e){var t=M(e);return t.setEndValue(1),t},P=function(e,t){if(void 0===t&&(t={}),e&&e.length){t.reverse&&e.reverse();var n,a="number"!=typeof(n=t.speed)?1.1:1+Math.min(Math.max(5*n,0),5),o=1/Math.max(Math.min(e.length,100),10),r=e.map(function(e,t){var n=e.getOnUpdateFunc;return e.getOnUpdateFunc=function(e){var i=n(e);return function(e){var n=e.getCurrentValue();(n=n<.01?0:n>.99?1:n)>=o&&r[t+1]&&r[t+1](Math.max(Math.min(n*a,1),0)),i(e)}},e}).map(function(e){var t=M(e);if(t)return t.setEndValue.bind(t)}).filter(Boolean);r[0]&&r[0](1)}},O=function(e){return[0,1,4,5,12,13].map(function(t){return e[t]})},R=function(e){return e.top<window.innerHeight&&e.bottom>0&&e.left<window.innerWidth&&e.right>0};function L(e){return JSON.parse(e.dataset.flipConfig||"{}")}var B=function(e,t){var n;return u(e,((n={})[t[0]]=t[1],n))},U=function(e,t){return c(t?document.querySelectorAll("["+h+'="'+t+'"]'):e.querySelectorAll("["+g+"]"))},N=function(e){return e.map(function(e){return[e,e.getBoundingClientRect()]})},F=function(e){var t=e.cachedOrderedFlipIds,r=e.inProgressAnimations,l=e.flippedElementPositionsBeforeUpdate,p=void 0===l?{}:l,E=e.flipCallbacks,y=e.containerEl,I=e.applyTransformOrigin,C=e.spring,S=e.debug,T=e.portalKey,_=e.staggerConfig,x=e.decisionData,k=void 0===x?{}:x,A=e.handleEnterUpdateDelete,w=e.onComplete,M=e.onStart;if(!window.matchMedia("(prefers-reduced-motion: reduce)").matches){var F,V,j,K,W,z,G,H,Y,q,X,Q,J,$,Z,ee,et,en,ea,eo,er=N(U((eo={element:y,portalKey:T}).element,eo.portalKey)).map(function(e){var t=e[0],n=e[1],a=window.getComputedStyle(t);return[t.dataset.flipId,{element:t,rect:n,opacity:parseFloat(a.opacity),transform:a.transform}]}).reduce(B,{}),ei=(V=(F={containerEl:y,portalKey:T}).containerEl,(j=F.portalKey)?function(e){return c(document.querySelectorAll("["+h+'="'+j+'"]'+e))}:V?(K=Math.random().toFixed(5),V.dataset.flipperId=K,function(e){return c(V.querySelectorAll('[data-flipper-id="'+K+'"] '+e))}):function(){return[]}),es=function(e){return ei("["+g+'="'+e+'"]')[0]},el=function(e){return p[e]&&er[e]},ec=Object.keys(p).concat(Object.keys(er)).filter(function(e){return!el(e)}),ed={flipCallbacks:void 0===E?{}:E,getElement:es,flippedElementPositionsBeforeUpdate:p,flippedElementPositionsAfterUpdate:er,inProgressAnimations:void 0===r?{}:r,decisionData:k},eu=(G=(W=u({},ed,{unflippedIds:ec})).unflippedIds,H=W.flipCallbacks,Y=W.getElement,q=W.flippedElementPositionsBeforeUpdate,X=W.flippedElementPositionsAfterUpdate,Q=W.inProgressAnimations,J=W.decisionData,$=G.filter(function(e){return X[e]}).filter(function(e){return H[e]&&H[e].onAppear}),Z=G.filter(function(e){return q[e]&&H[e]&&H[e].onExit}),ee=new Promise(function(e){z=e}),et=[],en=0,ea=Z.map(function(e,t){var n=q[e].domDataForExitAnimations,a=n.element,o=n.parent,r=n.childPosition,i=r.top,s=r.left,l=r.width,c=r.height;"static"===getComputedStyle(o).position&&(o.style.position="relative"),a.style.transform="matrix(1, 0, 0, 1, 0, 0)",a.style.position="absolute",a.style.top=i+"px",a.style.left=s+"px",a.style.height=c+"px",a.style.width=l+"px";var d=et.filter(function(e){return e[0]===o})[0];d||(d=[o,document.createDocumentFragment()],et.push(d)),d[1].appendChild(a),en+=1;var u=function(){try{o.removeChild(a)}catch(e){}finally{0==(en-=1)&&z()}};return Q[e]={stop:u},function(){return H[e].onExit(a,t,u,J)}}),et.forEach(function(e){e[0].appendChild(e[1])}),ea.length||z(),{hideEnteringElements:function(){$.forEach(function(e){var t=Y(e);t&&(t.style.opacity="0")})},animateEnteringElements:function(){$.forEach(function(e,t){var n=Y(e);n&&H[e].onAppear(n,t,J)})},animateExitingElements:function(){return ea.forEach(function(e){return e()}),ee}}),ep=eu.hideEnteringElements,ef=eu.animateEnteringElements,eg=eu.animateExitingElements,em=u({},ed,{containerEl:y,flippedIds:(void 0===t?[]:t).filter(el),applyTransformOrigin:I,spring:C,debug:S,staggerConfig:void 0===_?{}:_,scopedSelector:ei,onComplete:w});M&&M(y,k);var eh=function(e){var t,r=e.flippedIds,l=e.flipCallbacks,p=e.inProgressAnimations,g=e.flippedElementPositionsBeforeUpdate,h=e.flippedElementPositionsAfterUpdate,E=e.applyTransformOrigin,y=e.spring,I=e.getElement,C=e.debug,S=e.staggerConfig,T=void 0===S?{}:S,_=e.decisionData,x=void 0===_?{}:_,k=e.onComplete,A=e.containerEl,w=new Promise(function(e){t=e});if(k&&w.then(function(){return k(A,x)}),!r.length)return function(){return t([]),w};var M=[],B=I(r[0]),U=B?B.ownerDocument.querySelector("body"):document.querySelector("body");d(r);var N=r.map(function(e){var r=g[e].rect,d=h[e].rect,I=g[e].opacity,C=h[e].opacity,S=d.width<1||d.height<1,T=h[e].element;if(!R(r)&&!R(d)||!T)return!1;var _,k,A=L(T),w=(k=(_={flipperSpring:y,flippedSpring:A.spring}).flippedSpring,u({},v.noWobble,b(_.flipperSpring),b(k))),D=!0===A.stagger?"default":A.stagger;if(l[e]&&l[e].shouldFlip&&!l[e].shouldFlip(x.previous,x.current))return!1;var P=Math.abs(r.left-d.left)+Math.abs(r.top-d.top),B=Math.abs(r.width-d.width)+Math.abs(r.height-d.height),F=Math.abs(C-I);if(0===r.height&&0===d.height||0===r.width&&0===d.width||P<.5&&B<.5&&F<.01)return!1;var V=function(e){if("string"==typeof e){var t=e.match(/matrix(3d)?\(([^)]+)\)/);if(t)return n(t[2].split(", ").map(parseFloat))}return a()}(h[e].transform),j={matrix:V},K={matrix:[]},W=[V];A.translate&&(W.push((G=r.left-d.left,(H=a())[12]=G,H)),W.push((Y=r.top-d.top,(q=a())[13]=Y,q))),A.scale&&(W.push((X=Math.max(r.width,1)/Math.max(d.width,1),(Q=a())[0]=X,Q)),W.push((J=Math.max(r.height,1)/Math.max(d.height,1),($=a())[5]=J,$))),A.opacity&&(K.opacity=I,j.opacity=C);var z=[];(!l[e]||!l[e].shouldInvert||l[e].shouldInvert(x.previous,x.current))&&(z=c(T.querySelectorAll("["+m+'="'+e+'"]')).map(function(e){return[e,L(e)]})),K.matrix=O(W.reduce(o)),j.matrix=O(j.matrix);var G,H,Y,q,X,Q,J,$,Z,ee,et,en,ea,eo=(ee=(Z={element:T,invertedChildren:z,body:U}).element,et=Z.invertedChildren,en=Z.body,function(e){var t=e.matrix,n=e.opacity,a=e.forceMinVals;if(i(n)&&(ee.style.opacity=n+""),a&&(ee.style.minHeight="1px",ee.style.minWidth="1px"),t){var o,r,s,l="matrix("+t.join(", ")+")";ee.style.transform=l,et&&(r=(o={invertedChildren:et,matrix:t,body:en}).matrix,s=o.body,o.invertedChildren.forEach(function(e){var t=e[0],n=e[1];if(s.contains(t)){var a=r[0],o=r[3],i=r[5],l={translateX:0,translateY:0,scaleX:1,scaleY:1},c="";n.translate&&(l.translateX=-r[4]/a,l.translateY=-i/o,c+="translate("+l.translateX+"px, "+l.translateY+"px)"),n.scale&&(l.scaleX=1/a,l.scaleY=1/o,c+=" scale("+l.scaleX+", "+l.scaleY+")"),t.style.transform=c}}))}});if(l[e]&&l[e].onComplete){var er=l[e].onComplete;ea=function(){return er(T,x)}}var ei=i(K.opacity)&&i(j.opacity)&&K.opacity!==j.opacity,es=!1;return u({},{element:T,id:e,stagger:D,springConfig:w},{stagger:D,springConfig:w,getOnUpdateFunc:function(t){var n=t.spring,a=t.onAnimationEnd;return p[e]={destroy:n.destroy.bind(n),onAnimationEnd:a},function(t){l[e]&&l[e].onSpringUpdate&&l[e].onSpringUpdate(t.getCurrentValue()),es||(es=!0,l[e]&&l[e].onStart&&l[e].onStart(T,x));var n=t.getCurrentValue();if(U.contains(T)){var a={matrix:[]};a.matrix=K.matrix.map(function(e,t){return f(e,j.matrix[t],n)}),ei&&(a.opacity=f(K.opacity,j.opacity,n)),eo(a)}else t.destroy()}},initializeFlip:function(){eo({matrix:K.matrix,opacity:ei?K.opacity:void 0,forceMinVals:S}),l[e]&&l[e].onStartImmediate&&l[e].onStartImmediate(T,x),A.transformOrigin?T.style.transformOrigin=A.transformOrigin:E&&(T.style.transformOrigin="0 0"),z.forEach(function(e){var t=e[0],n=e[1];n.transformOrigin?t.style.transformOrigin=n.transformOrigin:E&&(t.style.transformOrigin="0 0")})},onAnimationEnd:function(n){delete p[e],s(ea)&&ea(),T.style.transform="",z.forEach(function(e){e[0].style.transform=""}),S&&T&&(T.style.minHeight="",T.style.minWidth=""),n||(M.push(e),M.length>=N.length&&t(M))},delayUntil:A.delayUntil})}).filter(Boolean);if(N.forEach(function(e){return(0,e.initializeFlip)()}),C)return function(){};var F=N.filter(function(e){var t;return e.delayUntil&&(t=e.delayUntil,N.filter(function(e){return e.id===t}).length)}),V={},j={},K={};F.forEach(function(e){e.stagger?(K[e.stagger]=!0,j[e.delayUntil]?j[e.delayUntil].push(e.stagger):j[e.delayUntil]=[e.stagger]):V[e.delayUntil]?V[e.delayUntil].push(e):V[e.delayUntil]=[e]});var W=N.filter(function(e){return e.stagger}).reduce(function(e,t){return e[t.stagger]?e[t.stagger].push(t):e[t.stagger]=[t],e},{}),z=N.filter(function(e){return -1===F.indexOf(e)});return z.forEach(function(e){e.onSpringActivate=function(){V[e.id]&&V[e.id].forEach(D),j[e.id]&&Object.keys(j[e.id].reduce(function(e,t){var n;return u(e,((n={})[t]=!0,n))},{})).forEach(function(e){P(W[e],T[e])})}}),function(){return N.length||t([]),z.filter(function(e){return!e.stagger}).forEach(D),Object.keys(W).forEach(function(e){K[e]||P(W[e],T[e])}),w}}(em);A?A({hideEnteringElements:ep,animateEnteringElements:ef,animateExitingElements:eg,animateFlippedElements:eh}):(ep(),eg().then(ef),eh())}},V=function(e){var t,n,a=e.element,o=e.flipCallbacks,r=void 0===o?{}:o,i=e.inProgressAnimations,s=U(a,e.portalKey),l=c(a.querySelectorAll("["+m+"]")),d={},p=[],f={};s.filter(function(e){return r&&r[e.dataset.flipId]&&r[e.dataset.flipId].onExit}).forEach(function(e){var t=e.parentNode;if(e.closest){var n=e.closest("["+E+"]");n&&(t=n)}var a=p.findIndex(function(e){return e[0]===t});-1===a&&(p.push([t,t.getBoundingClientRect()]),a=p.length-1),d[e.dataset.flipId]=p[a][1],f[e.dataset.flipId]=t});var g=N(s),h=g.map(function(e){var t=e[0],n=e[1],a={};if(r&&r[t.dataset.flipId]&&r[t.dataset.flipId].onExit){var o=d[t.dataset.flipId];u(a,{element:t,parent:f[t.dataset.flipId],childPosition:{top:n.top-o.top,left:n.left-o.left,width:n.width,height:n.height}})}return[t.dataset.flipId,{rect:n,opacity:parseFloat(window.getComputedStyle(t).opacity||"1"),domDataForExitAnimations:a}]}).reduce(B,{});return t=void 0===i?{}:i,n=s.concat(l),Object.keys(t).forEach(function(e){t[e].destroy&&t[e].destroy(),t[e].onAnimationEnd&&t[e].onAnimationEnd(!0),delete t[e]}),n.forEach(function(e){e.style.transform="",e.style.opacity=""}),{flippedElementPositions:h,cachedOrderedFlipIds:g.map(function(e){return e[0].dataset.flipId})}};(r=(function(e){this.element=void 0,this.staggerConfig=void 0,this.applyTransformOrigin=!0,this.handleEnterUpdateDelete=void 0,this.debug=void 0,this.spring=void 0,this.inProgressAnimations=void 0,this.flipCallbacks=void 0,this.snapshot=void 0,this.onComplete=void 0,this.onStart=void 0,u(this,e),this.inProgressAnimations={},this.flipCallbacks={},this.recordBeforeUpdate=this.recordBeforeUpdate.bind(this),this.update=this.update.bind(this),this.addFlipped=this.addFlipped.bind(this),this.addInverted=this.addInverted.bind(this)}).prototype).recordBeforeUpdate=function(){this.snapshot=V({element:this.element,flipCallbacks:this.flipCallbacks,inProgressAnimations:this.inProgressAnimations})},r.update=function(e,t){this.snapshot&&(F({flippedElementPositionsBeforeUpdate:this.snapshot.flippedElementPositions,cachedOrderedFlipIds:this.snapshot.cachedOrderedFlipIds,containerEl:this.element,inProgressAnimations:this.inProgressAnimations,flipCallbacks:this.flipCallbacks,applyTransformOrigin:this.applyTransformOrigin,spring:this.spring,debug:this.debug,staggerConfig:this.staggerConfig,handleEnterUpdateDelete:this.handleEnterUpdateDelete,decisionData:{previous:e,current:t},onComplete:this.onComplete,onStart:this.onStart}),delete this.snapshot)},r.addFlipped=function(e){var t=e.element,n=e.flipId,a=e.opacity,o=e.translate,r=e.scale,i=e.transformOrigin,s=e.spring,l=e.stagger,c=e.delayUntil,d=e.onAppear,p=e.onStart,f=e.onSpringUpdate,g=e.onComplete,m=e.onExit,h=e.shouldFlip,E=e.shouldInvert;if(!t)throw Error("no element provided");if(!n)throw Error("No flipId provided");var v={scale:r,translate:o,opacity:a,transformOrigin:i,spring:s,stagger:l,delayUntil:c};v.scale||v.translate||v.opacity||u(v,{translate:!0,scale:!0,opacity:!0}),n&&(t.dataset.flipId=String(n)),t.dataset.flipConfig=JSON.stringify(v),this.flipCallbacks[n]={shouldFlip:h,shouldInvert:E,onAppear:d,onStart:p,onSpringUpdate:f,onComplete:g,onExit:m}},r.addInverted=function(e){var t=e.element,n=e.parent,a=e.opacity,o=e.translate,r=e.scale,i=e.transformOrigin;if(!t)throw Error("no element provided");if(!n)throw Error("parent must be provided");var s=n.dataset.flipId,l={scale:r,translate:o,opacity:a,transformOrigin:i};l.scale||l.translate||l.opacity||u(l,{translate:!0,scale:!0,opacity:!0}),t.dataset.inverseFlipId=s,t.dataset.flipConfig=JSON.stringify(l)},new A,e.exports.utilities={__proto__:null,isNumber:i,isFunction:s,isObject:l,toArray:c,getDuplicateValsAsStrings:d,assign:u,tweenProp:f},e.exports.constants={__proto__:null,DATA_FLIP_ID:g,DATA_INVERSE_FLIP_ID:m,DATA_FLIP_COMPONENT_ID:"data-flip-component-id",DATA_FLIP_CONFIG:"data-flip-config",DATA_PORTAL_KEY:h,DATA_EXIT_CONTAINER:E},e.exports.onFlipKeyUpdate=F,e.exports.getFlippedElementPositionsBeforeUpdate=V}),a("lgKMU",function(e,t){let a=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"2Q0Hi",name:"ShareAndRestrictDialogController",loader:async()=>(await Promise.resolve(n("4adOe"))).Controller});e.exports.ShareAndRestrictDialogController=a}),a("6S5EB",function(e,t){e.exports.isExternalShareRequest=()=>!!n("1NBp8").EXTERNAL_SHARE.match(window.location.pathname)}),a("9M4aB",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var a=r(n("42omo")),o=r(n("aSNrY"));function r(e){return e&&e.__esModule?e:{default:e}}let i=e=>a.default.createElement(o.default,Object.assign({name:"ShareIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M12 2.5a1 1 0 1 0 0 2 1 1 0 0 0 0-2m-2.5 1a2.5 2.5 0 1 1 .73 1.765L6.212 7.567a2.5 2.5 0 0 1 0 .866l4.016 2.302a2.5 2.5 0 1 1-.692 1.332L5.521 9.766a2.5 2.5 0 1 1 0-3.53l4.016-2.302A2.5 2.5 0 0 1 9.5 3.5M3.75 7a1 1 0 1 0 0 2 1 1 0 0 0 0-2M12 11.5a1 1 0 1 0 0 2 1 1 0 0 0 0-2" clip-rule="evenodd"/>'},e));i.displayName="ShareIcon",e.exports.default=i}),a("3MKHu",function(e,t){var a=n("l998X");n("42omo");let o={skeleton:"_1rjcze3t _18zrpxbi _14mj53f4 _1ywu1ule _z0ai1r5k _1qdgu2gc _1hfkizff _aetrb3bt",customWidth:"_z0airzut"};e.exports.default=({isShimmering:e=!1,testId:t,width:r,xcss:i})=>(0,a.jsx)("div",{className:(0,n("gMc0m").default)([o.skeleton,r&&o.customWidth,e&&"",e&&"_unfq1yy8 _9nev1yy8 _kwc012o8 _joxl12o8 _18f312c5 _evp612c5 _19oh1254 _10881254 _18lgp3kn _zo24p3kn _1hfkizff _1rusizff",i]),style:{"--width":r},"data-ds--menu--skeleton-heading-item":!0,"data-testid":t})}),a("cQDYl",function(e,t){var a=n("l998X");n("42omo");let o={root:"_1rjcze3t _18zrv47k _1e0c1txw _1tke1ylp _4cvr1h6o _lcxvglyw _14mj53f4 _1qdgrdoj _1hfkizff _aetrb3bt _3mxot94y",defaultWidth:"_sf1e1n8h _4rfy1ssb _baud1nrf _mr7o1vuk _69tq19wn _kt4d1n05",customWidth:"_11w8rzut",beforeElement:"_1mp4gktf _kfgtgktf _7bjqidpf _1rusizff _1kt9b3bt _1mbqdlk8 _1rhxv77o",avatar:"_rfx31rr0",icon:"_rfx3fajl",sideNavSkeleton:"_18zru2gc _kfgt1k8s _1mbqpxbi _1mp41k8s"};e.exports.default=({hasAvatar:e,hasIcon:t,isShimmering:r=!1,isSideNavSkeleton:i=!1,testId:s,width:l,xcss:c})=>(0,a.jsx)("div",{className:(0,n("gMc0m").default)([o.root,(e||t)&&o.beforeElement,e&&o.avatar,t&&o.icon,l?o.customWidth:o.defaultWidth,i&&o.sideNavSkeleton,r&&"",r&&"_unfq1yy8 _9nev1yy8 _kwc012o8 _joxl12o8 _18f312c5 _evp612c5 _19oh1254 _10881254 _18lgp3kn _zo24p3kn _1hfkizff _1rusizff",c]),style:{"--width":l},"data-testid":s})}),a("3Fgla",function(e,t){var a=n("l998X"),o=n("42omo");let r=(0,o.lazy)(()=>n("j5tdW").then(e=>({default:e.ModalDialogContentWithRelayProvider}))),i=(0,n("2UdT0").withModalDialog)(function(e){let t=(0,a.jsx)(n("lAJUP").ErrorBoundary,{fallback:(0,a.jsx)(n("d2vda").ErrorState,{}),children:(0,a.jsx)(o.Suspense,{fallback:(0,a.jsx)(n("f3So1").LoadingState,{}),children:(0,a.jsx)(r,{...e})})});return(0,a.jsx)(n("keVvA").default,{defaultMessages:n("141Kq").default,loaderFn:n("7lxQk").fetchMessages,children:t})});e.exports.GlobalInviteWithLazyLoadedRelayProvider=i}),a("keVvA",function(e,a){t(e.exports,"default",()=>i);var o=n("l998X"),r=n("42omo");function i({loaderFn:e,children:t,defaultMessages:a}){let i=(0,n("5cR9p").useSafeIntl)(),s=(0,n("e9OZ6").useMessages)(i.locale,e),l=(0,r.useMemo)(()=>({...a,...i.messages,...s}),[i,s,a]);return(0,o.jsx)(n("1e2E5").default,{defaultLocale:"en",locale:i.locale,onError:i.onError,messages:l,children:t})}}),a("e9OZ6",function(e,t){var a=n("42omo");e.exports.useMessages=(e,t)=>{let[o,r]=(0,a.useState)(n("hxPth").DEFAULT_LOCALE_STATE);return(0,a.useEffect)(()=>{if(!o.messages||e!==o.locale){let n=!0;return t(e).then(t=>{n&&r({locale:e,messages:t??{}})}),()=>{n=!1}}},[t,e,o]),o.messages}}),a("hxPth",function(e,t){e.exports.DEFAULT_LOCALE_STATE={locale:"en",messages:{}}}),a("5cR9p",function(e,t){var a=n("42omo");let o=(0,n("fI8ba").createIntlCache)();e.exports.useSafeIntl=()=>{let e=(0,a.useContext)(n("gmMgo").Context);return e||(0,n("1e2E5").createIntl)(n("hxPth").DEFAULT_LOCALE_STATE,o)}}),a("7lxQk",function(e,t){let a=async e=>{try{let t=e in n("fzzWl").asyncLanguages?e:e.replace(/-/g,"_")in n("fzzWl").asyncLanguages?e.replace(/-/g,"_"):e.split(/[-_]/)[0]||"",a=await n("fzzWl").asyncLanguages[t]?.();return a?.default??n("141Kq").default}catch(e){}return n("141Kq").default};e.exports.fetchMessages=a}),a("141Kq",function(e,a){Object.defineProperty(e.exports,"__esModule",{value:!0,configurable:!0}),t(e.exports,"default",()=>o);var o=n("333Q2").default}),a("333Q2",function(e,n){t(e.exports,"default",()=>a);var a={"navigation.global-invite.error-state-description":"Try refreshing the page or contact us if the problem persists.","navigation.global-invite.error-state-heading":"We can't load the invite list right now","navigation.global-invite.loading-visually-hidden-label":"Loading","navigation.global-invite.modal-dialog-label":"Invite people"}}),a("fzzWl",function(e,t){e.exports.asyncLanguages={cs:()=>n("6yQVJ"),da:()=>n("bzSID"),de:()=>n("2FP6T"),"en-GB":()=>n("25qh2"),"en-ZZ":()=>n("3tbTt"),en:()=>Promise.resolve(n("141Kq")),es:()=>n("5HmEI"),fi:()=>n("2JrHA"),fr:()=>n("7K1vi"),hu:()=>n("lvhk9"),it:()=>n("dolI8"),ja:()=>n("hqns1"),ko:()=>n("1vs1T"),nb:()=>n("BAT91"),nl:()=>n("l079O"),pl:()=>n("jEFBo"),"pt-BR":()=>n("gTjoB"),ru:()=>n("kq4sh"),sv:()=>n("bbLxs"),th:()=>n("gfPHN"),tr:()=>n("gMTmr"),uk:()=>n("6ZJsB"),vi:()=>n("dDMw7"),zh_TW:()=>n("bbzob"),zh:()=>n("c4U6C")}}),a("6yQVJ",function(e,t){e.exports=n("4mJKd")(5)("5iVCs").then(()=>n("5xx4Y"))}),a("bzSID",function(e,t){e.exports=n("4mJKd")(5)("k7RZQ").then(()=>n("hAVgU"))}),a("2FP6T",function(e,t){e.exports=n("4mJKd")(5)("9CFJc").then(()=>n("lk8G1"))}),a("25qh2",function(e,t){e.exports=n("4mJKd")(5)("3fPuK").then(()=>n("aR1vS"))}),a("3tbTt",function(e,t){e.exports=n("4mJKd")(5)("dUyEb").then(()=>n("cryKi"))}),a("5HmEI",function(e,t){e.exports=n("4mJKd")(5)("PAD2J").then(()=>n("6UEa7"))}),a("2JrHA",function(e,t){e.exports=n("4mJKd")(5)("GNuQo").then(()=>n("eMR6r"))}),a("7K1vi",function(e,t){e.exports=n("4mJKd")(5)("fvsAU").then(()=>n("lqRs8"))}),a("lvhk9",function(e,t){e.exports=n("4mJKd")(5)("h7dGJ").then(()=>n("abQPO"))}),a("dolI8",function(e,t){e.exports=n("4mJKd")(5)("kg6sH").then(()=>n("koNv9"))}),a("hqns1",function(e,t){e.exports=n("4mJKd")(5)("fqF5W").then(()=>n("lHGQG"))}),a("1vs1T",function(e,t){e.exports=n("4mJKd")(5)("1WNp5").then(()=>n("hfuHa"))}),a("BAT91",function(e,t){e.exports=n("4mJKd")(5)("iHPxa").then(()=>n("4M9Uw"))}),a("l079O",function(e,t){e.exports=n("4mJKd")(5)("Qf3VH").then(()=>n("8jbH9"))}),a("jEFBo",function(e,t){e.exports=n("4mJKd")(5)("79OEV").then(()=>n("4zJCj"))}),a("gTjoB",function(e,t){e.exports=n("4mJKd")(5)("27dMt").then(()=>n("h0wiX"))}),a("kq4sh",function(e,t){e.exports=n("4mJKd")(5)("bkVVv").then(()=>n("fARzr"))}),a("bbLxs",function(e,t){e.exports=n("4mJKd")(5)("MLhYA").then(()=>n("7wkkR"))}),a("gfPHN",function(e,t){e.exports=n("4mJKd")(5)("ap7kW").then(()=>n("7Ud5x"))}),a("gMTmr",function(e,t){e.exports=n("4mJKd")(5)("45YAR").then(()=>n("dyiwH"))}),a("6ZJsB",function(e,t){e.exports=n("4mJKd")(5)("kqhVG").then(()=>n("i54xW"))}),a("dDMw7",function(e,t){e.exports=n("4mJKd")(5)("1susf").then(()=>n("6kAMA"))}),a("bbzob",function(e,t){e.exports=n("4mJKd")(5)("dl3k2").then(()=>n("cIqRB"))}),a("c4U6C",function(e,t){e.exports=n("4mJKd")(5)("aquXY").then(()=>n("ffYaF"))}),a("d2vda",function(e,t){var a=n("l998X");n("42omo");let o=(0,n("ecnYn").xcss)({paddingBlock:"space.1000",paddingInline:"space.100",textAlign:"center"});e.exports.ErrorState=function(){let{formatMessage:e}=(0,n("8C5kA").default)();return(0,a.jsxs)(n("1GzhS").default,{space:"space.050",testId:"global-invite--error-state",xcss:o,children:[(0,a.jsx)(n("7hXDW").default,{size:"xsmall",children:e(n("dkLyX").messages.errorStateHeading)}),(0,a.jsx)(n("5dK2X").default,{size:"small",color:"color.text.subtle",children:e(n("dkLyX").messages.errorStateDescription)})]})}}),a("dkLyX",function(e,t){let a=(0,n("cgtv4").defineMessages)({errorStateHeading:{id:"navigation.global-invite.error-state-heading",defaultMessage:"We can't load the invite list right now"},errorStateDescription:{id:"navigation.global-invite.error-state-description",defaultMessage:"Try refreshing the page or contact us if the problem persists."}});e.exports.messages=a}),a("f3So1",function(e,t){var a=n("l998X");n("42omo");let o=(0,n("ecnYn").xcss)({paddingBlock:"space.500",paddingInline:"space.300"});e.exports.LoadingState=function(){let{formatMessage:e}=(0,n("8C5kA").default)(),t=Array.from({length:5},(e,t)=>(0,a.jsx)(n("kpYGL").default,{isShimmering:!0,width:"100%",height:"var(--ds-space-200, 16px)",testId:"skeleton-shimmering"},t));return(0,a.jsxs)(n("6f0Oj").default,{xcss:o,testId:"global-invite--loading-state",children:[(0,a.jsx)(n("6F6hl").default,{children:e(n("jtIsq").messages.loadingLabel)}),(0,a.jsx)(n("1GzhS").default,{space:"space.100",testId:"skeleton-group",children:t})]})}}),a("jtIsq",function(e,t){let a=(0,n("cgtv4").defineMessages)({loadingLabel:{id:"navigation.global-invite.loading-visually-hidden-label",defaultMessage:"Loading"}});e.exports.messages=a}),a("2UdT0",function(e,t){var a=n("l998X"),o=n("42omo"),r=n("7TH2w");e.exports.withModalDialog=function(e){return function({testId:t=n("hqHXQ").DEFAULT_TEST_ID,triggerElement:i,children:s,...l}){let{createAnalyticsEvent:c}=(0,n("inPa6").useAnalyticsEvents)(),{formatMessage:d}=(0,n("8C5kA").default)(),[u,p]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!1),m=(0,o.useCallback)(()=>{c({eventType:r.UI_EVENT_TYPE,action:"clicked",actionSubject:"button",actionSubjectId:"globalInviteButton",attributes:{componentName:"globalInvite",product:l.product}}).fire(n("hqHXQ").ANALYTICS_CHANNEL),p(!0)},[c,l.product]),h=(0,o.useCallback)(e=>{let t=e?.target?.tagName==="A"?e?.target:e?.target?.closest("a");t&&(t?.getAttribute("target")==="new"||t?.getAttribute("target")==="_blank")&&g(!0)},[]),E=(0,o.useCallback)(()=>{c({eventType:r.UI_EVENT_TYPE,action:f?"closed":"cancelled",actionSubject:"modalDialog",actionSubjectId:"globalInviteModal",attributes:{componentName:"globalInvite",product:l.product}}).fire(n("hqHXQ").ANALYTICS_CHANNEL),p(!1)},[c,l.product,f]),v=(0,o.useCallback)(()=>{c({eventType:r.UI_EVENT_TYPE,action:"completed",actionSubject:"modalDialog",actionSubjectId:"globalInviteModal",attributes:{componentName:"globalInvite",product:l.product}}).fire(n("hqHXQ").ANALYTICS_CHANNEL),p(!1)},[c,l.product]),b=(0,o.useCallback)(e=>{e.focus()},[]);return(0,a.jsx)(n("8m1UD").AnalyticsContextWrapper,{product:l.product,children:(0,a.jsxs)("div",{"data-testid":t,children:[i?(0,a.jsx)(i,{onClick:m}):(0,a.jsx)(n("ccHMk").default,{shouldFitContainer:!0,onClick:m,testId:`${t}--${n("hqHXQ").TRIGGER_ELEMENT_TEST_ID}`,children:s}),(0,a.jsx)(n("6xdDU").default,{children:u?(0,a.jsx)(n("8CZUH").default,{width:"small",shouldScrollInViewport:!0,shouldReturnFocus:!0,onClose:E,onOpenComplete:b,label:d(n("7VhND").messages.modalDialogLabel),testId:`${t}--${n("hqHXQ").MODAL_DIALOG_TEST_ID}`,children:(0,a.jsx)(n("1DHa6").default,{children:(0,a.jsx)(e,{onAdminMenuItemClick:h,onCancel:E,onInviteCompleted:v,...l})})}):null})]})})}}}),a("hqHXQ",function(e,t){e.exports.DEFAULT_TEST_ID="global-invite",e.exports.MODAL_DIALOG_TEST_ID="modal-dialog",e.exports.TRIGGER_ELEMENT_TEST_ID="trigger-element",e.exports.ANALYTICS_CHANNEL="navigation"}),a("8m1UD",function(e,t){var a=n("l998X");n("42omo");var o=n("ffCOo");e.exports.AnalyticsContextWrapper=function({product:e,children:t}){return(0,a.jsx)(o.NavigationAnalyticsContext,{data:{componentName:"globalInvite",source:"globalInviteButton",product:e},children:t})}}),a("7VhND",function(e,t){let a=(0,n("cgtv4").defineMessages)({modalDialogLabel:{id:"navigation.global-invite.modal-dialog-label",defaultMessage:"Invite people"}});e.exports.messages=a}),a("j5tdW",function(e,t){let a=n("4mJKd")(5);e.exports=Promise.all([a("9XYQ9"),a("lXGg9"),a("hy3sK"),a("hRUX7"),a("g4oYs"),a("jSdjl"),a("l2EUC"),a("6vyHt"),a("8JZKd"),a("6wr18"),a("aL59j"),a("7EorR"),a("2spqH"),a("gWSdF"),a("5uN9h"),a("1TOYq"),a("7Q5vz"),a("ffEVr"),a("Wowvf"),a("kHOMt"),a("hhss7"),a("let0D"),a("gY1B8")]).then(()=>n("gFKFJ"))}),a("7aRa9",function(t,a){var o=n("42omo"),r=n("T1bCI");t.exports.withFlags=function(t){var a;return(a=class extends o.Component{render(){return e(o).createElement(r.Subscribe,{to:[n("gqqjz").FlagsStateContainer]},n=>e(o).createElement(t,{...this.props,flags:n}))}}).displayName=`withFlags(${t.displayName||t.name})`,a}}),a("aBfpe",function(e,t){var n,a=((n={}).JSON="application/json",n.X_WWW_FORM_URLENCODED="application/x-www-form-urlencoded",n);e.exports.MediaType=a}),a("ihDPC",function(e,t){var a=n("42omo"),o=n("3WXN2");let r=(0,n("cgtv4").defineMessages)({emptyTitleDefault:{id:"share.default.title",defaultMessage:"Untitled"}}),i=({routesContext:e,contentType:t,contentId:a,spaceKey:o,isEditMode:r,getCopyContentLink:i})=>{let s=i();if(r&&s)return s;let l=e.match,c=(0,n("c3Qwv").getSingleParam)(e.getQueryParams(),"draftShareId");if(l&&(0,n("gEtAQ").isEditPage)(String(l))&&!c){let e=o??l?.params.spaceKey;return"blog"===t?new URL(n("1NBp8").VIEW_BLOG.toUrl({spaceKey:e,contentId:a}),document.baseURI).toString():new URL(n("1NBp8").VIEW_PAGE.toUrl({spaceKey:e,contentId:a}),document.baseURI).toString()}return s||(s=(0,n("lI2Uj").getViewContentShareUrl)(),void 0!==c&&(s=(0,n("cb6fO").addQueryParams)(s,{draftShareId:c}))),s},s=["page","blogpost","whiteboard"];e.exports.useShareToEntities=(e,t,l)=>{let{createAnalyticsEvent:c}=(0,n("inPa6").useAnalyticsEvents)(),d=(0,n("8C5kA").default)(),{activationId:u,cloudId:p}=(0,n("bQm3c").useSessionData)(),[f]=(0,n("ep3mz").useContentType)(),[g]=(0,n("ep3mz").usePageSpaceKey)(),{getCopyContentLink:m}=(0,o.useCopyContentLink)({pageMode:l,contentType:f??"",contentId:e,spaceKey:g,source:"useShareToEntities"}),{data:h,error:E}=(0,n("xQxzY").useQuery)(n("dbAK7").ShareToEntitiesContentQuery,{variables:{contentId:e}});E&&(0,n("7Sm4c").markErrorAsHandled)(E);let[v]=(0,n("h29WE").useExperimentalShareMutation)({onCompleted:n=>{c({type:"sendOperationalEvent",data:{source:t??"useShareToEntities",actionSubject:"notify",action:"completed",attributes:{contentId:e,success:!!n?.experimentalShare?.success,status:n?.experimentalShare?.status}}}).fire()}}),b=(0,a.useContext)(n("7zgzO").RoutesContext),y=h?.singleContent?.type??f??"",I=h?.singleContent?.title,C=(0,a.useCallback)(()=>new(0,n("6Co6F").default)({product:"confluence"}),[]);return{shareToEntities:async(t,a)=>{if(!s.includes(y))throw Error("Not a supported content type");if(!e)throw Error("No content ID");let o=t.map(e=>({id:e.id,type:e.type})),l={content:{link:i({routesContext:b,contentType:y,contentId:e,spaceKey:g,isEditMode:a,getCopyContentLink:m}),ari:(0,n("1N269").getContentAri)({activationId:u,contentId:e,cloudId:p,contentType:y}),title:I||d.formatMessage(r.emptyTitleDefault),type:y},recipients:o,metadata:{productId:"confluence",atlOriginId:String(C().id),shareeAction:a?"edit":"view"}},c=await v({variables:{requestBody:l}});return{success:!!c?.data?.experimentalShare?.success}}}}}),a("dbAK7",function(e,t){let a=(0,n("eSUdr").default)`query ShareToEntitiesContentQuery($contentId:ID!){singleContent(id:$contentId){title type id}}`;e.exports.ShareToEntitiesContentQuery=a}),a("h29WE",function(e,t){e.exports.useExperimentalShareMutation=e=>(0,n("9o40q").useExperimentalMutation)({url:"/gateway/api/share",method:"POST",headers:{"Content-Type":n("aBfpe").MediaType.JSON},parseResult:e=>({experimentalShare:{status:String(e.status),success:!!e.ok,__typename:"ExperimentalShareResponse"}}),parseResponseOnSuccess:e=>({status:e.status,ok:e.ok}),parseResponseOnError:e=>{if("response"in e&&e.response?.status)return{status:e.response.status,ok:!1};throw e},onCompleted:e?.onCompleted})}),a("9o40q",function(e,t){var a=n("42omo");function o({fetchData:e,onCompleted:t,onError:a,transformError:o,update:r,optimisticResponse:i}){let s=async e=>(0,n("bjeS8").convertToApolloError)(await o?.(e)||e);return(0,n("5JnOJ").useApolloCompatibleMutation)({fetchData:e,onCompleted:t,onError:a,update:r,optimisticResponse:i,convertToApolloError:s})}e.exports.useExperimentalMutation=function({url:e,method:t,headers:r,body:i,credentials:s,parseResult:l,parseResponseOnSuccess:c,parseResponseOnError:d,onCompleted:u,onError:p,transformError:f,maxRetries:g=0,variables:m,update:h,optimisticResponse:E}){if(!(0,n("6mKj3").expValEquals)("cc_move_legacy-schema-bridge-code-into-interops","isEnabled",!0))return(0,n("hNILR").useExperimentalMutationLegacy)({url:e,method:t,headers:r,body:i,credentials:s,parseResult:l,parseResponseOnSuccess:c,parseResponseOnError:d,onCompleted:u,onError:p,transformError:f,maxRetries:g,variables:m,update:h,optimisticResponse:E});let{fetchData:v}=(0,n("1GTIR").useFetchData)({url:e,method:t,headers:r,body:i,credentials:s,parseResult:l,parseResponseOnSuccess:c,parseResponseOnError:d,variables:m}),b=(0,a.useCallback)(async(e,t=0)=>{try{return await v(e)}catch(n){if(t<g&&n?.response?.status===409)return b(e,++t);throw n}},[g,v]);return o({fetchData:b,onCompleted:u,onError:p,transformError:f,update:h,optimisticResponse:E})},e.exports.useExperimentalMutationBase=o}),a("5JnOJ",function(e,t){var a=n("42omo");e.exports.useApolloCompatibleMutation=function({fetchData:e,onCompleted:t,onError:o,update:r,optimisticResponse:i,convertToApolloError:s}){let[l,c]=(0,a.useState)({data:void 0,loading:!1,error:void 0,called:!1});return[(0,n("26Yfd").useStableCallback)(async(a={})=>{let{variables:l,update:d,optimisticResponse:u}=a,p=d??r;c({data:void 0,loading:!0,error:void 0,called:!0});let f=u??i;if(f){let e="function"==typeof f?f(l??{}):f;p?.(null,{data:e})}try{let n=await e(l);p?.(null,{data:n});let a={data:n,loading:!1,error:void 0,called:!0};return c(a),await t?.(n),{data:a.data}}catch(a){f&&p&&p(null,{data:void 0});let e=await Promise.resolve(s(a));e.graphQLErrors?.length&&e.graphQLErrors.forEach(e=>{(0,n("7Sm4c").processError)(e)}),o?.(e);let t={data:void 0,loading:!1,error:e,called:!0};if(c(t),!o)throw e;return{data:t.data}}}),l]}}),a("hNILR",function(e,t){var a=n("42omo");e.exports.useExperimentalMutationLegacy=function({url:e,method:t,headers:o,body:r,credentials:i,parseResult:s,parseResponseOnSuccess:l,parseResponseOnError:c,onCompleted:d,onError:u,transformError:p,maxRetries:f=0,variables:g,update:m,optimisticResponse:h}){let{fetchData:E}=(0,n("1GTIR").useFetchData)({url:e,method:t,headers:o,body:r,credentials:i,parseResult:s,parseResponseOnSuccess:l,parseResponseOnError:c,variables:g}),v=(0,a.useCallback)(async(e,t=0)=>{try{return await E(e)}catch(n){if(t<f&&n?.response?.status===409)return v(e,++t);throw n}},[f,E]);return function({fetchData:e,onCompleted:t,onError:o,transformError:r,update:i,optimisticResponse:s}){let[l,c]=(0,a.useState)({data:void 0,loading:!1,error:void 0,called:!1});return[(0,n("26Yfd").useStableCallback)(async(a={})=>{let{variables:l,update:d,optimisticResponse:u}=a,p=d??i;c({data:void 0,loading:!0,error:void 0,called:!0});let f=u??s;if(f){let e="function"==typeof f?f(l??{}):f;p?.(null,{data:e})}try{let n=await e(l);p?.(null,{data:n});let a={data:n,loading:!1,error:void 0,called:!0};return c(a),await t?.(n),{data:a.data}}catch(a){f&&p&&p(null,{data:void 0});let e=await (0,n("hR9WV").handleError)({error:a,transformError:r,onError:o}),t={data:void 0,loading:!1,error:e,called:!0};if(c(t),!o)throw e;return{data:t.data}}}),l]}({fetchData:v,onCompleted:d,onError:u,transformError:p,update:m,optimisticResponse:h})}}),a("1N269",function(e,t){e.exports.getContentAri=({activationId:e,cloudId:t,contentId:a,contentType:o})=>{if("embed"===o&&e)return(0,n("gw4Eo").getConfluenceContentAri)({siteId:t,resourceType:o,activationId:e,resourceId:a});if("database"===o&&e)return n("iH7AG").ConfluenceDatabaseAri.create({siteId:t,databaseId:a,activationId:e}).toString();let r=null;switch(o){case"blogpost":r=n("eB56w").ConfluenceBlogpostAri.create({siteId:t,blogpostId:a});break;case"whiteboard":r=n("a5Dk4").ConfluenceWhiteboardAri.create({siteId:t,whiteboardId:a});break;default:r=n("a2xFu").ConfluencePageAri.create({siteId:t,pageId:a})}return r.toString()},e.exports.getContentTypeForShare=e=>e&&e.includes("BLOG")?"blogpost":"page",e.exports.isSlackIntegrationSupported=e=>"embed"!==e&&"database"!==e}),a("lI2Uj",function(e,t){e.exports.safeJSONParse=e=>{try{return JSON.parse(e)}catch(e){}return null},e.exports.getDraftShareId=()=>{let e=window.location.search.match(/draftShareId=([^&#]*)/);return e&&e[1]||void 0},e.exports.getLinkType=e=>{let t=window.location.href;return/\/wiki\/spaces\/.*\/history\//.test(t)?"history":"edit"===e?"edit":void 0},e.exports.getViewContentShareUrl=()=>window?.location?.href&&(0,n("cb6fO").removeEverythingAfterContentSlug)(window.location.href)}),a("3WXN2",function(e,t){var a,o=n("42omo"),r=n("j1Ss3"),i=n("9WYR7");let s=(0,n("eSUdr").default)`query useCopyContentLinkCopyLinkQuery($contentId:ID!){singleContent(id:$contentId){id links{editui webui tinyui base}}}`;var l=((a={}).PAGE="page",a.BLOGPOST="blogpost",a.OVERVIEW="overview",a.WHITEBOARD="whiteboard",a.EMBED="embed",a.DATABASE="database",a);e.exports.SUPPORTED_CONTENT_TYPES=l,e.exports.useCopyContentLink=({pageMode:e,contentType:t,contentId:a,spaceKey:l,source:c})=>{let{createAnalyticsEvent:d}=(0,n("inPa6").useAnalyticsEvents)(),[u,p]=(0,o.useState)(),{toUrl:f}=(0,o.useContext)(n("7zgzO").RoutesContext),{copyToClipboard:g}=(0,n("3JQXa").useCopyToClipboard)(),{data:m,loading:h,error:E}=(0,r.useQuery)(s,{variables:{contentId:a}}),v=(0,o.useCallback)(()=>{let o,r,s;if(m){let t=m?.singleContent?.links;if((o=e===i.PAGE_MODE.EDIT?t?.editui:t?.tinyui||t?.webui)&&t?.base)return`${t.base}${o}`}if(e===i.PAGE_MODE.EDIT)r="blogpost"===t?n("1NBp8").EDIT_BLOG_V2.name:n("1NBp8").EDIT_PAGE_V2.name,s={contentType:"blogpost"===t?"blog":"pages"};else switch(t){case"overview":r=n("1NBp8").SPACE_OVERVIEW.name;break;case"blogpost":r=n("1NBp8").VIEW_BLOG.name;break;case"page":r=n("1NBp8").VIEW_PAGE.name;break;case"whiteboard":r=n("1NBp8").WHITEBOARD_BOARD.name;break;case"embed":r=n("1NBp8").EMBED_VIEW.name;break;case"database":r=n("1NBp8").DATABASE_VIEW.name;default:let u=Error(`Received an unexpected content type: '${t}'`);d({type:"sendOperationalEvent",data:{action:"thrown",actionSubject:"error",actionSubjectId:i.ACTION_SUBJECT_ID,source:c,attributes:{error:u?.message,contentType:t,pageMode:e}}}).fire(),p(u)}if(r)return d({type:"sendOperationalEvent",data:{action:"copied",actionSubject:"fallbackLink",actionSubjectId:i.ACTION_SUBJECT_ID,source:c,attributes:{queryError:E?.message,isDataLoading:h,route:r}}}).fire(),`${window.location.origin}${f(r,{contentId:a,spaceKey:l,...s})}`},[f,a,t,l,e,c,m,h,E,d]),b=(0,o.useCallback)(()=>g(v()),[v,g]);return(0,o.useMemo)(()=>({queryError:E,unsupportedLinkError:u,getCopyContentLink:v,copyContentLink:b}),[E,u,v,b])}}),a("3JQXa",function(e,t){var a=n("42omo");e.exports.useCopyToClipboard=()=>{let e=(0,a.useCallback)(async e=>{e&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText&&await navigator.clipboard.writeText(e)},[]);return(0,a.useMemo)(()=>({copyToClipboard:e}),[e])}}),a("9WYR7",function(t,a){var o,r=n("42omo"),i=n("b3j2Y"),s=n("aJv6Q"),l=n("56QzY"),c=n("3WXN2");let d=(0,n("cgtv4").defineMessages)({copyLinkLabel:{id:"share.copylink.icon.label",defaultMessage:"Copy link"},copiedTextLabel:{id:"share.copylink.copied.tooltip",defaultMessage:"Copied!"},errorCopyingTextLabel:{id:"share.copylink.error.tooltip",defaultMessage:"Something went wrong."}}),u="copyShareLink";var p=((o={}).VIEW="view",o.EDIT="edit",o);let f=(0,s.withErrorBoundary)({attribution:n("3IBnw").Attribution.PERMISSIONS_EXPERIENCE})(({pageMode:t,contentType:a,contentId:o,spaceKey:s,source:p,shouldResetOnHover:f=!1,buttonAppearance:g="subtle",tooltipPosition:m="bottom"})=>{let h=(0,n("8C5kA").default)(),[E,v]=(0,r.useState)(!1),[b,y]=(0,r.useState)(),{createAnalyticsEvent:I}=(0,n("inPa6").useAnalyticsEvents)(),C=(0,r.useRef)(),S=e(r).useRef(),T=(0,r.useContext)(n("1kHsc").ExperienceTrackerContext);(0,r.useEffect)(()=>(E&&(C.current=setTimeout(()=>v(!1),5e3)),()=>{clearTimeout(C.current)}),[E]),(0,r.useEffect)(()=>{I({type:"sendTrackEvent",data:{actionSubject:"copyShareLink",action:"shown",source:p,attributes:{contentType:a,pageMode:t,isContentWrapper:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")}}}).fire()},[I,a,p,t]);let{queryError:_,unsupportedLinkError:x,copyContentLink:k}=(0,c.useCopyContentLink)({pageMode:t,contentType:a,contentId:o,spaceKey:s,source:p});(0,r.useLayoutEffect)(()=>{S.current?.()},[E]);let A=async()=>{I({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:u,source:p,attributes:{pageMode:t,contentType:a,navdexPointType:l.END,isContentWrapper:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")}}}).fire();try{await k()}catch(e){y(e)}v(!0)},w=x||b,M=h.formatMessage(d.copyLinkLabel),D=h.formatMessage(w?d.errorCopyingTextLabel:d.copiedTextLabel),P=!!(_||w);return e(r).createElement(e(r).Fragment,null,P&&e(r).createElement(i.ErrorDisplay,{error:_||w}),!!w&&e(r).createElement(n("hjygH").ExperienceStop,{name:n("irVI7").COPY_CONTENT_LINK_EXPERIENCE,error:w}),e(r).createElement(n("3gadb").default,{content:({update:e})=>(S.current=e,E?D:M),position:m},e(r).createElement(n("eEA8O").default,{testId:"copy-link-button","aria-label":E?D:M,appearance:g,iconBefore:e(r).createElement(e(n("1bY7o")),{label:"",color:E?"var(--ds-icon-selected, #1868DB)":void 0,spacing:"spacious"}),onClick:A,onMouseEnter:()=>{T.start({name:n("irVI7").COPY_CONTENT_LINK_EXPERIENCE})},onMouseLeave:()=>{f&&v(!1),T.abort({name:n("irVI7").COPY_CONTENT_LINK_EXPERIENCE,reason:"user navigated away"})},shouldFitContainer:!0})),E&&e(r).createElement(n("1eaCJ").ExperienceSuccess,{name:n("irVI7").COPY_CONTENT_LINK_EXPERIENCE}))});t.exports.ACTION_SUBJECT_ID=u,t.exports.PAGE_MODE=p,t.exports.CopyLink=f}),a("hjygH",function(e,t){var a=n("3u0dr"),o=n("frIzR"),r=n("42omo");let i=(0,a.isReactCompilerActiveV1)()?function(e){let t,a,i=(0,o.c)(6),{name:s,error:l,attributes:c}=e,d=(0,r.useContext)(n("1kHsc").ExperienceTrackerContext);return i[0]!==c||i[1]!==l||i[2]!==d||i[3]!==s?(t=()=>{l?d.stopOnError({name:s,error:l,attributes:c}):d.succeed({name:s,attributes:c})},a=[d,s,c,l],i[0]=c,i[1]=l,i[2]=d,i[3]=s,i[4]=t,i[5]=a):(t=i[4],a=i[5]),(0,r.useEffect)(t,a),null}:function({name:e,error:t,attributes:a}){let o=(0,r.useContext)(n("1kHsc").ExperienceTrackerContext);return(0,r.useEffect)(()=>{t?o.stopOnError({name:e,error:t,attributes:a}):o.succeed({name:e,attributes:a})},[o,e,a,t]),null};e.exports.ExperienceStop=i}),a("cVfpT",function(e,a){t(e.exports,"PAGE_MODE",()=>n("9WYR7").PAGE_MODE),n("9WYR7");let o=(0,n("jmjWc").LoadableAfterPaint)({__loadable_id__:"qHKXp",name:"CopyLinkButtonLoader",loader:async()=>(await Promise.resolve(n("9WYR7"))).CopyLink,loading:n("h5hpR").CopyLinkButtonPlaceholder});e.exports.CopyLinkButtonLoader=o}),a("h5hpR",function(t,a){var o=n("42omo");let r=(0,n("cgtv4").defineMessages)({copyLinkLabel:{id:"share.copylink.icon.label",defaultMessage:"Copy link"}});t.exports.CopyLinkButtonPlaceholder=()=>{let t=(0,n("8C5kA").default)();return e(o).createElement(n("eEA8O").default,{testId:"copy-link-button-placeholder","data-test-id":"copy-link-button-placeholder",appearance:"subtle",iconBefore:e(o).createElement(e(n("1bY7o")),{label:t.formatMessage(r.copyLinkLabel),spacing:"spacious"}),isDisabled:!0})}}),a("kDhla",function(e,t){let a={fullPageEditorPresetAPI:void 0},o=(0,n("1P1Tu").createStore)({initialState:a,actions:{setEditorApi:e=>({setState:t})=>{t({fullPageEditorPresetAPI:e})},resetEditorApi:()=>({setState:e})=>{e(a)}},name:"FullPageEditorApiStore"}),r=(0,n("9zUhf").createHook)(o),i=(0,n("9zUhf").createActionsHook)(o),s=(0,n("9zUhf").createStateHook)(o);e.exports.useFullPageEditorApi=r,e.exports.useFullPageEditorApiActions=i,e.exports.useFullPageEditorApiState=s}),a("e4o8D",function(e,t){var a=n("3u0dr"),o=n("frIzR"),r=n("42omo");let i=(0,a.isReactCompilerActiveV1)()?e=>{let t,n,a=(0,o.c)(2),i=!1===window.__SSR_RENDERED__,[s,l]=(0,r.useState)(void 0!==e&&e?!i:window?.__HYDRATABLE__&&!i||!1);return a[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{l(!1)},n=[],a[0]=t,a[1]=n):(t=a[0],n=a[1]),(0,r.useEffect)(t,n),s}:(e=!1)=>{let t=!1===window.__SSR_RENDERED__,[n,a]=(0,r.useState)(e?!t:window?.__HYDRATABLE__&&!t||!1);return(0,r.useEffect)(()=>{a(!1)},[]),n};e.exports.useRenderServerPlaceholder=i}),a("hYoU4",function(t,a){var o=n("3wgAM");let r={setCollabEditProvider:e=>({setState:t})=>{t({collabEditProvider:e})},setCollabEditInitialized:e=>({setState:t})=>{t({collabEditInitialized:e})},setHasInitialDraft:e=>({setState:t})=>{t({hasInitialDraft:e})},setIsDraftSyncPending:e=>({setState:t})=>{t({isDraftSyncPending:e})},setCollabEditConnected:e=>({setState:t})=>{t({collabEditConnected:e})},resetNativeCollabState:()=>({setState:e})=>{e({collabEditProvider:null,collabEditInitialized:!1,hasInitialDraft:!1,isDraftSyncPending:!1,collabEditConnected:!1})}},i=(0,n("1P1Tu").createStore)({initialState:{collabEditProvider:null,collabEditInitialized:!1,hasInitialDraft:!1,isDraftSyncPending:!1,collabEditConnected:!1},actions:r,name:"nativeCollabState"});(0,n("FOT9i").createContainer)(i,{onInit:()=>async({dispatch:e},{initialCollabState:t})=>{t?.collabEditProvider&&e(r.setCollabEditProvider(t?.collabEditProvider)),t?.collabEditInitialized&&e(r.setCollabEditInitialized(t?.collabEditInitialized)),t?.hasInitialDraft&&e(r.setHasInitialDraft(t?.hasInitialDraft)),t?.isDraftSyncPending&&e(r.setIsDraftSyncPending(t?.isDraftSyncPending)),t?.collabEditConnected&&e(r.setCollabEditConnected(t?.collabEditConnected))}});let s=(0,n("9zUhf").createHook)(i,{selector:t=>e(o)(t,"collabEditProvider","collabEditInitialized","hasInitialDraft")}),l=(0,n("9zUhf").createActionsHook)(i),c=(0,n("9zUhf").createHook)(i,{selector:t=>e(o)(t,"isDraftSyncPending")}),d=(0,n("9zUhf").createHook)(i,{selector:t=>e(o)(t,"collabEditConnected")});t.exports.useNativeCollabState=s,t.exports.useNativeCollabActions=l,t.exports.useNativeCollabDraftSync=c,t.exports.useNativeCollabConnected=d}),a("3wgAM",function(e,t){var a=n("2LrJx");e.exports=n("5Nw7l")(function(e,t){return null==e?{}:a(e,t)})}),a("2LrJx",function(e,t){var a=n("egNUN"),o=n("7U49l");e.exports=function(e,t){return a(e,t,function(t,n){return o(e,n)})}}),a("5Nw7l",function(e,t){var a=n("5qOzM"),o=n("iK2Oc"),r=n("gnVVm");e.exports=function(e){return r(o(e,void 0,a),e+"")}}),a("5qOzM",function(e,t){var a=n("8jC8i");e.exports=function(e){return(null==e?0:e.length)?a(e,1):[]}}),a("8KbKw",function(e,t){let a=e=>!!e&&"graphQLErrors"in e&&e.graphQLErrors?.some(e=>e.message.includes("Invalid content id")),o=(0,n("2XqLN").default)((e,t)=>async()=>{let o=n("1sAC2").nativeCollabPermissionsTokenState.getPermissionsTokenState(e);if(o){let{getToken:t,isUsedForDraftFetch:a,isUsedForWSInitialization:r}=o;if(a&&!r){let a=await t;if(a)return n("1sAC2").nativeCollabPermissionsTokenState.setIsUsedForWSInitialization(e,!0),a}}let r=(0,n("hp2SH").getApolloClient)();try{n("9137z").CollabEditProviderMeasures.markMeasureStart(n("j8hiR").COLLAB_EDIT_PROVIDER_MEASURES.COLLAB_PERMS_TOKEN_FETCH);let a=await r.query({query:n("3pJBd").GetCollabPermissionTokenQuery,variables:{contentId:e,...t&&{draftShareId:t}},fetchPolicy:"network-only",context:{fetchOptions:{ignoreNoNetworkError:!0}}});return n("9137z").CollabEditProviderMeasures.markMeasureEnd(n("j8hiR").COLLAB_EDIT_PROVIDER_MEASURES.COLLAB_PERMS_TOKEN_FETCH),a.data?.collabToken?.token??null}catch(e){if((0,n("7Sm4c").markErrorAsHandled)(e),a(e))throw{message:"Content not found",data:{status:404,code:"INSUFFICIENT_EDITING_PERMISSION",meta:{description:"RESOURCE_DELETED",reason:"RESOURCE_DELETED"}}};if(e?.networkError?.response?.status===503)throw{message:"Service unavailable",data:{meta:{reason:"RESOURCE_DELETED"}}};return null}});e.exports.fetchCollabPermissionToken=o}),a("j8hiR",function(e,t){var n,a=((n={}).COLLAB_EDIT_PROVIDER_FETCH="collabEditProviderAnalyticsFetch",n.COLLAB_EDIT_PROVIDER_CREATED="collabEditProviderCreated",n.COLLAB_EDIT_PROVIDER_DISABLED="collabEditProviderDisabled",n.COLLAB_EDIT_PROVIDER_INIT="collabEditProviderInitialized",n.COLLAB_EDIT_PROVIDER_PRE_CONNECTED="collabEditProviderPreconnected",n.COLLAB_EDIT_PROVIDER_CONNECTED="collabEditProviderConnected",n.COLLAB_EDIT_PROVIDER_INIT_DOC="collabEditProviderInitDoc",n.COLLAB_EDIT_PROVIDER_FETCH_NCS_DRAFT="collabEditProviderFetchNCSDraft",n.COLLAB_EDIT_PROVIDER_PRELOAD_NCS_DRAFT="collabEditProviderPreloadNCSDraft",n.COLLAB_EDIT_PROVIDER_PRELOAD_NCS_DRAFT_TIMEOUT="collabEditProviderPreloadNCSDraftTimeout",n.COLLAB_PERMS_TOKEN_FETCH="collabEditProviderPermsTokenFetch",n);e.exports.COLLAB_EDIT_PROVIDER_MEASURES=a}),a("9137z",function(e,t){let a=new(0,n("kGrzq").BaseMeasures);e.exports.CollabEditProviderMeasures=a}),a("3pJBd",function(e,t){let a=(0,n("eSUdr").default)`query getCollabToken($contentId:ID!$draftShareId:String){collabToken(id:$contentId draftShareId:$draftShareId){token}}`;e.exports.GetCollabPermissionTokenQuery=a}),a("1sAC2",function(e,t){let n=new class{getPermissionsTokenState(e){return this.tokenState[e]}setToken(e,t=Promise.resolve(null)){this.tokenState[e]={getToken:t,isUsedForDraftFetch:!1,isUsedForWSInitialization:!1}}setIsUsedForDraftFetch(e,t){this.tokenState[e]&&(this.tokenState[e].isUsedForDraftFetch=t)}setIsUsedForWSInitialization(e,t){this.tokenState[e]&&(this.tokenState[e].isUsedForWSInitialization=t)}setTimestamp(e){this.tokenState[e]&&(this.tokenState[e].timestamp=performance.now())}clearPermissionsTokenState(e){this.tokenState[e]&&delete this.tokenState[e]}constructor(){this.tokenState={}}};e.exports.nativeCollabPermissionsTokenState=n}),a("6i41U",function(e,t){var a=n("42omo");e.exports.default=()=>{let{routerLinkComponent:e}=(0,a.useContext)(n("8x1Q3").RouterLinkProviderContext);if(e)return e}}),a("8x1Q3",function(e,t){n("l998X");let a=(0,n("42omo").createContext)({});e.exports.RouterLinkProviderContext=a}),a("cOrQJ",function(e,t){var a=n("42omo");e.exports.default=()=>{let[e,t]=(0,a.useState)((0,n("8z9j5").default)());return(0,a.useEffect)(()=>{let e=new(0,n("60yhz").default)(e=>t(e));return e.observe(),()=>e.disconnect()},[]),e}}),a("77wHb",function(e,t){var a=n("gETEr"),o=n("bSxMj"),r=n("hWvFC"),i=n("fZxmY");e.exports=function(e,t){return function(n,s){var l=i(n)?a:o,c=t?t():{};return l(n,e,r(s,2),c)}}}),a("gETEr",function(e,t){e.exports=function(e,t,n,a){for(var o=-1,r=null==e?0:e.length;++o<r;){var i=e[o];t(a,i,n(i),e)}return a}}),a("bSxMj",function(e,t){var a=n("iawSg");e.exports=function(e,t,n,o){return a(e,function(e,a,r){t(o,e,n(e),r)}),o}}),a("8Yfbq",function(e,t){var a=n("jSnXV"),o=n("lc9ud");e.exports=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw TypeError("Expected a function");return o(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),a(e,t,{leading:r,maxWait:t,trailing:i})}}),a("9NwnH",function(e,t){var a=n("dQl1W"),o=n("1oCLl"),r=n("iu6m9");class i{constructor(e,t,n){this.step=e,this.inverted=t,this.origin=n}}function s(e,t,a){for(let t=e.length-1;t>=0;t--)a.step(e[t].inverted);for(let e=0;e<t.length;e++)a.step(t[e]);let o=[];for(let t=0,s=e.length;t<e.length;t++){let l=e[t].step.map(a.mapping.slice(s)),c=(0,r.editorExperiment)("platform_editor_offline_editing_web",!0)?(0,n("5jGZY").mapStep)(e,a,t,l):void 0;s--,l&&!a.maybeStep(l).failed&&(a.mapping.setMirror(s,a.steps.length-1),o.push(new i(l,l.invert(a.docs[a.docs.length-1]),e[t].origin))),(0,r.editorExperiment)("platform_editor_offline_editing_web",!0)&&c&&!a.maybeStep(c).failed&&o.push(new i(c,c.invert(a.docs[a.docs.length-1]),a))}return o}class l{constructor(e,t){this.version=e,this.unconfirmed=t}}let c=new(0,n("ks2lK").PluginKey)("collab");e.exports.Rebaseable=i,e.exports.rebaseSteps=s,e.exports.collab=function(e={}){let t={version:e.version||0,clientID:null!=e.clientID&&e.clientID?e.clientID:`temp-pc-${(0,a.v4)()}`},s=e.transformUnconfirmed??(e=>e);return new(0,n("ks2lK").Plugin)({key:c,state:{init:()=>new l(t.version,[]),apply(e,t){let n=e.getMeta(c);if(n)if((0,r.editorExperiment)("platform_editor_offline_editing_web",!0)||(0,o.expValEquals)("platform_editor_enable_single_player_step_merging","isEnabled",!0))return new l(n.version,s(n.unconfirmed));else return n;return e.docChanged?new l(t.version,s(t.unconfirmed.concat(function(e){let t=[];for(let n=0;n<e.steps.length;n++)t.push(new i(e.steps[n],e.steps[n].invert(e.docs[n]),e));return t}(e)))):t}},config:t,historyPreserveItems:!0})},e.exports.getDocBeforeUnconfirmedSteps=function(e){let t=e.tr,{version:n,unconfirmed:a}=c.getState(e)??{};if(void 0===n||!a)return t.doc;for(let e=a.length-1;e>=0;e--)t.step(a[e].inverted);return t.doc},e.exports.syncFromAnotherSource=function(e,t,a,o){let r=e.tr,s=e.schema.nodeFromJSON(a),{from:d,to:u}=r.selection;r.replaceWith(0,e.doc.content.size,s);for(let e=0;e<o.length;e++)r.step(o[e]);let p=r.steps.slice(1).map((e,t)=>{let n=r.docs[t+1];return new i(e,e.invert(n),r)});return r.setSelection(n("ks2lK").TextSelection.create(r.doc,Math.min(d,r.doc.content.size),Math.min(u,r.doc.content.size))),r.setMeta("addToHistory",!1).setMeta(c,new l(t,p))},e.exports.receiveTransaction=function(e,t,a,o={}){let r=c.getState(e),i=(r?.version||0)+t.length,d=c.get(e).spec.config.clientID,u=0;for(;u<a.length&&a[u]==d;)++u;let p=r?.unconfirmed.slice(u)||[];if(!(t=u?t.slice(u):t).length)return e.tr.setMeta(c,new l(i,p));let f=p.length,g=e.tr;if(f)p=s(p,t,g);else{for(let e=0;e<t.length;e++)g.step(t[e]);p=[]}let m=new l(i,p);return o&&o.mapSelectionBackward&&e.selection instanceof n("ks2lK").TextSelection&&(g.setSelection(new(0,n("ks2lK").TextSelection)(g.doc.resolve(g.mapping.map(e.selection.anchor,-1)),g.doc.resolve(g.mapping.map(e.selection.head,-1)))),g.updated&=-2),g.setMeta("rebased",f).setMeta("rebasedData",{unconfirmedSteps:r?.unconfirmed.slice(u)||[],remoteSteps:t,stepsAfterRebase:p,versionBefore:i}).setMeta("addToHistory",!1).setMeta(c,m)},e.exports.sendableSteps=function(e){let t=c.getState(e);return t&&0!=t.unconfirmed.length?{version:t.version,steps:t.unconfirmed.map(e=>e.step),clientID:c.get(e).spec.config.clientID,get origins(){return this._origins||(this._origins=t?.unconfirmed.map(e=>e.origin))}}:null},e.exports.getCollabState=function(e){return c.getState(e)}}),a("5jGZY",function(e,t){let a=(e,t=e.length-1)=>{for(let a=t;a>=0;a--)if(!(e[a]instanceof n("jy7VG").AnalyticsStep))return a},o=e=>e instanceof n("aXG5V").ReplaceStep,r=(e,t)=>{if(o(e.step)&&o(t)&&0===e.step.slice.size&&Math.abs(e.step.to-e.step.from)===t.slice.size){let n=e.origin.steps.findIndex(t=>t===e.step);if(-1===n)return!1;let a=e.origin.docs[n];if(!a)return!1;if(a.slice(e.step.from,e.step.to).eq(t.slice))return!0}return!1},i=(e,t,a,r)=>{if(!o(t)||e&&!o(e)||!e||!(r>=0&&r<a.docs.length&&"number"==typeof t?.from))return;let i=a.docs[r].slice(t?.from,t?.to),s=function(e,t){let n=e.findDiffStart(t),a=e.findDiffEnd(t);if(null===n||null===a)return;let o=n-Math.min(a.a,a.b),r=a.b;return o>0&&(r+=o),{start:n,end:r}}(e.slice.content,i.content);if(void 0===s)return;let l=e.from+s.start,c=i.content.size-e.slice.content.size==0?s.end-s.start:0;return i.content.size-e.slice.content.size<0?new(0,n("aXG5V").ReplaceStep)(l,l+e.slice.content.size-i.content.size,n("5SAOw").Slice.empty):new(0,n("aXG5V").ReplaceStep)(l,l+c,a.docs[r].slice(t?.from+s.start,t?.from+s.end))};e.exports.mapStep=(e,t,n,o)=>{if(n<1)return;let s=a(e.map(e=>e.step),n-1);if(void 0!==s&&r(e[s],e[n].step)){let e=a(t.steps);if(void 0!==e)return i(o,t.steps[e],t,e)}}});
//# sourceMappingURL=ContentHeaderPresence.cb37e162.js.map
