var e=globalThis.parcelRequired477,t=e.register;t("87Z8O",function(t,r){let o=(0,e("eSUdr").default)`query getEmojiTitlePropertyQuery($contentId:ID$status:[String]$draftShareId:String$skipPublishedFragment:Boolean!){content(id:$contentId draftShareId:$draftShareId status:$status){nodes{id emojiTitlePublished:properties(key:"emoji-title-published")@skip(if:$skipPublishedFragment){nodes{id key value version{number}}}emojiTitleDraft:properties(key:"emoji-title-draft"){nodes{id key value version{number}}}contentProperties{latest{defaultTitleEmoji}}}}}`;t.exports.getEmojiTitleProperty=o}),t("brn6e",function(t,r){var o=e("3shHM"),a=e("8rneB");let i=async({userId:e,cloudId:t,emojiId:r})=>{let o=await (0,a.getEmojiProvider)(t,e);if(o){let e=await o.findById(r);if(e)return o.loadMediaEmoji(e)}return Promise.resolve(null)},n=!1,d=null,s=e=>{document.querySelectorAll("link[rel~='icon']").forEach(t=>{n||(d=t.href,n=!0),t.href=e})},m=async({selectedEmoji:t,emojiProvider:r,onUpdateStartEmoji:i,createAnalyticsEvent:n,emojiTitleState:d,onEmojiUpdated:s,onUpdateEndEmoji:m,updateContentPropertyExperimentalMutation:p,updateContentProperty:u,contentId:c,componentName:l,isLivePage:y,emojiStatusFieldName:E},j)=>{i&&i(),(0,o.sendAnalyticsEvent)(n,{eventType:"sendUIEvent",element:"button",action:"clicked",actionSubject:"emojiPicker",actionSubjectId:"emoji",attributes:{emojiId:t?.id,inputMethod:"title",isLivePage:y}});let g=(0,e("5amrO").convertEmojiFieldNameToPropertyKey)(E),h=await r.loadMediaEmoji(t,!0);return d.setOpenSecondEmojiPicker(!1),d.setSelectedEmoji(h),s().then(({data:r})=>{let o=(0,a.getVersionNumber)(r,E),i=o?o+1:1,n=t?.id?.replace(/['"]+/g,"")??"";return(0,e("6mKj3").expValEquals)("migrate_off_experimentalupdatecontentproperty","isEnabled",!0)?u({propertyKey:g,propertyValue:n,hasExistingProperty:o>0,options:{update:()=>{try{let t=(0,e("l1uFv").readQueryInterop)({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:c,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()}});t.content.nodes[0][E]&&(t.content.nodes[0][E].nodes[0]={...t.content.nodes[0][E].nodes[0],id:c,key:g,value:n,version:{number:i,__typename:"Version"}}),(0,e("fEmGS").writeQueryInterop)({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:c,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()},data:r})}catch(e){throw Error(`${l} failed to write to cache while updating ${g} content property after user selecting emoji ${e.message}`)}}},shouldOptimisticResponse:!0}).then(()=>{m&&m(),d.setSelectedEmoji(h)}).catch(e=>{throw Error(`${l} failed to update ${g} content property after user selecting emoji ${e.message}`)}):p({variables:{contentId:c,propertyKey:g,propertyValue:n,versionNumber:String(i)},update:t=>{try{let o=t.readQuery({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:c,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()}});o.content.nodes[0][E]&&(o.content.nodes[0][E].nodes[0]={...o.content.nodes[0][E].nodes[0],id:c,key:g,value:n,version:{number:i,__typename:"Version"}}),t.writeQuery({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:c,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()},data:r})}catch(e){throw Error(`${l} failed to write to cache while updating ${g} content property after user selecting emoji ${e.message}`)}},optimisticResponse:{__typename:"Mutation",experimentalUpdateContentProperty:{__typename:"ExperimentalUpdateContentProperty",success:!0,id:c,key:g,value:n}}}).then(()=>{m&&m(),d.setSelectedEmoji(h)}).catch(e=>{throw Error(`${l} failed to update ${g} content property after user selecting emoji ${e.message}`)})})},p=RegExp("^(\\p{RI}\\p{RI}|\\p{Extended_Pictographic}(\\p{Emoji_Modifier}|\\u{FE0F}\\u{20E3}?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?(\\u{200D}\\p{Extended_Pictographic}(\\p{Emoji_Modifier}|\\u{FE0F}\\u{20E3}?|[\\u{E0020}-\\u{E007E}]+\\u{E007F})?)*)","u"),u=e=>e&&e.replace(p,"").trimLeft()||"",c=e=>e&&p.exec(e)?.[0]||"";t.exports.getEmojiFromEmojiId=i,t.exports.maybeOverrideFaviconWithEmoji=t=>{if((0,e("dh538").fg)("confluence_emoji_title_favicon")){if(!t){n&&d&&s(d);return}s(t)}},t.exports.onSelectEmoji=m,t.exports.onRemoveEmoji=(t,{onUpdateStartEmoji:r,onUpdateEndEmoji:o,onEmojiUpdated:a,contentId:i,updateContentPropertyExperimentalMutation:n,updateContentProperty:d,componentName:s="",emojiStatusFieldName:m})=>{r&&r();let p=(0,e("5amrO").convertEmojiFieldNameToPropertyKey)(m);return a().then(()=>(0,e("6mKj3").expValEquals)("migrate_off_experimentalupdatecontentproperty","isEnabled",!0)?d({propertyKey:p,isDelete:!0,options:{update:()=>{try{let t=(0,e("l1uFv").readQueryInterop)({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:i,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()}});t.content.nodes[0][m]={nodes:[],__typename:"PaginatedJsonContentPropertyList"},(0,e("fEmGS").writeQueryInterop)({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:i,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()},data:t})}catch(e){throw Error(`${s} failed to write to cache while updating content property after user removing emoji ${e.message}`)}}},shouldOptimisticResponse:!0}).finally(()=>{o&&o()}).catch(e=>{throw Error(`${s} failed to update ${p} content property after user removing emoji ${e.message}`)}):n({variables:{contentId:i,propertyKey:p,isDelete:!0},update:t=>{try{let r=t.readQuery({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:i,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()}});r.content.nodes[0][m]={nodes:[],__typename:"PaginatedJsonContentPropertyList"},t.writeQuery({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:i,status:["current","draft"],skipPublishedFragment:!0,draftShareId:(0,e("7PLO8").getDraftShareIdFromQueryParam)()},data:r})}catch(e){throw Error(`${s} failed to write to cache while updating content property after user removing emoji ${e.message}`)}},optimisticResponse:{__typename:"Mutation",experimentalUpdateContentProperty:{__typename:"ExperimentalUpdateContentProperty",success:!0}}}).finally(()=>{o&&o()}).catch(e=>{throw Error(`${s} failed to update ${p} content property after user removing emoji ${e.message}`)}))},t.exports.emojiExp=p,t.exports.removeEmojiFromTitle=u,t.exports.getEmojiFromTitle=c,t.exports.getTitleAndEmoji=(e="",t="",r="",o="",a="",i=!0)=>{let n=i?c(e):"",d="";i&&(d=o?.toLowerCase()==="draft"?r:t);let s=n.length>0,m=d.length>0,p=m?d:n,l=s&&!m?u(e):e;return"draft"!==o||l||(l=a),{text:l,emoji:p,selectedEmoji:d}}}),t("3shHM",function(t,r){var o=e("8rneB");let a=(e,{eventType:t,element:r,action:o,actionSubject:a,actionSubjectId:i,attributes:n={}})=>{e({type:t,data:{action:o,source:"EmojiTitleSection",actionSubject:a,actionSubjectId:i,attributes:{element:r,...n}}}).fire()},i=async({createAnalyticsEvent:t,contentId:r,isLivePage:i})=>{let{data:n}=await (0,e("hp2SH").getApolloClient)().query({query:e("87Z8O").getEmojiTitleProperty,variables:{contentId:r,status:["current","draft"],skipPublishedFragment:!1}}),d=(0,o.getEmojiId)(n,e("5amrO").EMOJI_TITLE_DRAFT_FIELD);d.length>=0&&""!==d&&a(t,{eventType:"sendTrackEvent",element:"",action:"created",actionSubject:"draftWithEmoji",actionSubjectId:"",attributes:{emojiId:d,isLivePage:i}})};t.exports.sendAnalyticsEvent=a,t.exports.trackDraftCreatedWithEmoji=i,t.exports.onFailedToLoadEmoji=({createAnalyticsEvent:e,emoji:t,context:r,error:o={message:""},isLivePage:i})=>{a(e,{eventType:"sendTrackEvent",element:"emoji",action:"error",actionSubject:"renderEmoji",actionSubjectId:"renderEmojiError",attributes:{emojiShortName:t&&t.shortName,emojiId:t&&t.id,context:r,errorMessage:o.message,isLivePage:i}})}});
//# sourceMappingURL=EmojiComponent.d462f5be.js.map
