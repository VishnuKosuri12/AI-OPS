function e(e){return e&&e.__esModule?e.default:e}var n=globalThis.parcelRequired477,t=n.register;t("4Svbr",function(t,o){var a=n("42omo"),i=n("7EEGh"),r=n("hXzKU"),m=n("cMvMc"),l=n("lLpk8");let s={cursor:"pointer",display:"flex",alignItems:"center",height:"24px",marginTop:"var(--ds-space-150, 12px)",left:0},d={paddingTop:"var(--ds-space-100, 8px)"},c=(0,n("ecnYn").xcss)({display:"flex",alignItems:"center"}),u=(0,n("ecnYn").xcss)({color:"color.text.subtle",backgroundColor:"color.background.neutral.subtle",paddingTop:"space.050",paddingBottom:"space.050",paddingLeft:"space.150",paddingRight:"space.150",borderRadius:"radius.small",userSelect:"none",fontWeight:"var(--ds-font-weight-medium, 500)",":hover":{cursor:"pointer",backgroundColor:"color.background.neutral.subtle.hovered"},":active":{backgroundColor:"color.background.neutral.subtle.pressed"}}),p=(0,n("cgtv4").defineMessages)({commentsPanelShowGeneralNestedReplies:{id:"comments-common.comment-thread.go.to.nested.general.reply",defaultMessage:"Go to more replies"},commentsPanelGeneralNestedRepliesHasUnread:{id:"comments-common.comment-thread.general.nested.replies.has.unread",defaultMessage:"There are unread replies"}}),E=({nestedReplies:t,unreadReplyIds:o,targetCommentIdForScroll:i})=>{let{formatMessage:r}=(0,n("8C5kA").default)(),m=new Set(o),l=t.some(e=>m.has(e.id)),E=(0,a.useMemo)(()=>{let e=new Map;for(let n=t.length-1;n>=0;n--){let o,a=t[n],{displayName:i,profilePicture:r}=a.author;o="accountId"in a.author&&a.author.accountId?a.author.accountId:`anonymous-${n}`,e.has(o)||e.set(o,{displayName:i??"",profilePicturePath:r?.path})}return Array.from(e.values()).map(e=>({name:e.displayName,src:e.profilePicturePath}))},[t]);return e(a).createElement("div",{className:(0,n("gMc0m").default)(["_kqswh2mm _18u01jfw"])},e(a).createElement(n("1Sjzs").WithCurvedBranchingStyle,{testId:"comments-panel-reply-scroller-container",showDefaultStyles:!0,customStyles:{...s,...d},disableLeftProp:!0},e(a).createElement("div",{className:(0,n("gMc0m").default)(["_18u0utpp"])},e(a).createElement(n("2W0qg").default,{onClick:()=>{let e=(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?`footer-comment-thread-${i}-replies`:`comment-${i}-footer`,t=document.getElementById(e);if(t){let e=(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?-60:-75;(0,n("fURMF").scrollToElement)(t,e,"smooth")}},testId:"comments-panel-thread-show-nested-general-replies",xcss:u,interactionName:"comments-panel-thread-show-nested-general-replies"},e(a).createElement(n("bUlM5").default,{alignItems:"center",gap:"space.050"},E.length>0&&e(a).createElement(n("2Pg7f").default,{data:E,maxCount:3,appearance:"stack",size:"small",shouldPopupRenderToParent:!0,testId:"comments-panel-replies-scroller-profile-pictures"}),e(a).createElement(n("bUlM5").default,{alignItems:"center",gap:"space.050"},e(a).createElement(n("bUlM5").default,{xcss:c},r(p.commentsPanelShowGeneralNestedReplies),l&&e(a).createElement("span",{"data-testid":"comments-panel-unread-nested-general-replies-indicator","aria-label":r(p.commentsPanelGeneralNestedRepliesHasUnread),className:(0,n("gMc0m").default)(["_2rko1rr0 _18s81b66 _4t3iu2gc _1bsbu2gc _bfhk1856"])}))))))))},I=({isCurrentSelectedComment:e,visibleUnreadRepliesNotMarkedAsRead:t,threadKey:o,commentType:i,setCommentsInThreadToBeMarkedAsRead:r,updateUnreadCommentsListState:m})=>{(0,a.useEffect)(()=>{!(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")&&e&&t.length>0&&(r({threadKey:o,commentIds:t,commentType:i}),m(e=>{let n=new Set(t);return e.filter(e=>!n.has(e.id))}))},[i,e,r,o,m,t])};var C=n("9tfnI");let f=(0,n("eSUdr").default)`mutation CommentRepliesCreateInlineReplyMutation($input:ReplyInlineCommentInput!$pageId:ID!$includeReactions:Boolean!){replyInlineComment(input:$input){id body(representation:ATLAS_DOC_FORMAT){value}contentStatus createdAt{value}createdAtNonLocalized links{webui editui}location{type ...on InlineComment{inlineMarkerRef inlineText inlineResolveProperties{resolved isDangling resolvedFriendlyDate resolvedTime resolvedUser}}...on FooterComment{commentResolveProperties{resolved resolvedFriendlyDate resolvedTime resolvedUser}}}parentId permissions{isEditable isRemovable isResolvable}version{by{displayName}when number}author{displayName profilePicture{path}permissionType ...on KnownUser{accountId}}createdAt{value}createdAtNonLocalized reactionsSummary(pageId:$pageId contentType:"page" childType:"comment")@include(if:$includeReactions){ari containerAri reactionsCount reactionsSummaryForEmoji{id emojiId count reacted}}}}`,_=(0,n("eSUdr").default)`mutation CommentRepliesCreateGeneralReplyMutation($pageId:ID!$cloudId:ID!$input:CreateCommentInput!$includeReactions:Boolean!){createFooterComment(cloudId:$cloudId input:$input){id author{displayName profilePicture{path}permissionType ...on KnownUser{accountId}}body(representation:ATLAS_DOC_FORMAT){value}contentStatus createdAt{value}createdAtNonLocalized links{webui editui}location{type ...on InlineComment{inlineMarkerRef inlineText inlineResolveProperties{isDangling resolvedTime resolvedFriendlyDate resolvedUser resolved}}...on FooterComment{commentResolveProperties{resolvedTime resolvedFriendlyDate resolvedUser resolved}}}parentId permissions{isEditable isRemovable isResolvable}reactionsSummary(pageId:$pageId contentType:"page" childType:"comment")@include(if:$includeReactions){ari containerAri reactionsCount reactionsSummaryForEmoji{id emojiId count reacted}}version{by{displayName}when number}}}`,g={marginLeft:"var(--ds-space-150, 12px)",width:"62px",height:"24px",left:"-12px",paddingTop:"var(--ds-space-100, 8px)",paddingBottom:"var(--ds-space-100, 8px)"},y={marginLeft:"var(--ds-space-300, 24px)",height:"16px",marginRight:"var(--ds-space-050, 4px)"},T={marginLeft:"var(--ds-space-300, 24px)",height:"24px",marginRight:"var(--ds-space-050, 4px)",paddingTop:"var(--ds-space-100, 8px)"},h=(0,n("cgtv4").defineMessages)({replyAction:{id:"comments-panel.reply.action",defaultMessage:"Reply"},threadReplyButtonAriaLabelWithName:{id:"comments-panel.reply.button.aria-label.with-name",defaultMessage:"Reply to {name}’s thread"},replyAriaLabel:{id:"comments-panel.reply.aria-label",defaultMessage:"Reply by {authorName}, {timestamp}"}});t.exports.CommentReplies=({parentComment:t,pageInfo:o,isCurrentSelectedComment:s,hoveredCommentId:d,pageMode:c,editCommentQueryId:u,selectedAnnotation:p,parentCommentId:v,handleMouseEnter:N,handleMouseLeave:R,canAddComments:b,isStandaloneComment:S,deleteStandaloneComment:w,replyToComment:A,updateReactionsCacheFn:M,onRendered:L,eventEmitter:D,isEditorExpanded:k=!1,hasParentMaxHeight:P=!1})=>{let[F]=(0,n("1KmJq").useMutation)(f),[O]=(0,n("1KmJq").useMutation)(_),{isReactionsEnabled:V}=(0,a.useContext)(n("8SCD6").ReactionsContext),x=o?.id??"",U=o?.type??"",{createInlineReplyInterop:K}=(0,n("cQCqE").useCreateInlineReplyMutation)({contentId:x}),{addCommentInCache:G}=(0,n("NYiei").useAllCommentsData)({contentId:x,options:{skip:!0}}),j=(0,n("ag51I").useCreateObjectCommentMutation)(),$=(0,n("8C5kA").default)(),{formatMessage:X}=$,{hasContentChanged:q}=(0,n("bSvtO").useCommentsContentState)(),{onChange:B,resetContentChanged:z}=(0,n("bSvtO").useCommentsContentActions)(),{cloudId:W}=(0,n("bQm3c").useSessionData)(),[{searchSessionId:H}]=(0,n("hl1Kw").useSearchSessionId)(),{createAnalyticsEvent:Q}=(0,n("inPa6").useAnalyticsEvents)(),{addReplyToCommentThread:Y}=(0,n("8i27m").useCommentsDataActions)(),{scrollCommentsPanelToThread:J}=(0,n("6KwrO").useCommentsPanelScroll)(),[{commentsMarkedAsRead:Z,replyToCommentId:ee,location:en,replyToCommentUser:et},{setCommentsInThreadToBeMarkedAsRead:eo,setReplyToCommentId:ea}]=(0,n("3mVfX").useCommentsPanel)(),[{unreadCommentIDSet:ei},{updateUnreadCommentsListState:er,updateReadCommentsListState:em}]=(0,n("fHAwL").useUnreadComments)(),el=(0,n("cZa7r").useAnnotationsIsOffline)(),{commentService:es}=(0,n("6hmtW").useCommentService)(),[ed]=(0,n("ep3mz").useContentType)(),ec=(0,a.useMemo)(()=>(0,n("6mKj3").expValEquals)("confluence_frontend_replytoggler_fix","isEnabled",!0)?t.replies.filter(e=>null!==e&&t.location.inlineMarkerRef===e.location.inlineMarkerRef):t.replies.filter(e=>null!==e),[t.replies,t.location]),eu=ec.length,ep=(0,a.useMemo)(()=>ec.filter(e=>(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")?ei.has(e.id):e.isUnread).map(e=>e.id),[ec,ei]),[eE,eI]=(0,a.useState)(!0),[eC,ef]=(0,a.useState)(void 0),[,e_]=(0,a.useState)(""),[eg,ey]=(0,a.useState)(null),{showModal:eT}=(0,n("8aF6s").useDialogs)(),eh=(0,a.useContext)(n("1kHsc").ExperienceTrackerContext),ev=t.type,eN=t?.location,eR=eN?.inlineResolveProperties?.isDangling&&(0,n("9wGTI").fg)("confluence_frontend_new_dangling_comments_ux"),eb=t.isOpen,eS=!eb||!!eR,[ew,eA]=(0,a.useState)((0,n("7qvmT").getDefaultReplyView)((0,n("ibqdE").getCommentReplies)(ec,v).length,eS,S)),eM=o?.operations||[],eL=eM.some(e=>e?.operation==="create"&&e?.targetType==="comment"),eD=(0,n("9wGTI").fg)("confluence_comment_use_comment_media_endpoint")?eL:eM.some(e=>e?.operation==="update"&&e?.targetType===U),ek=ev===n("8i27m").CommentType.INLINE?(t?.location).inlineMarkerRef||"":v,eP=eb?["edit","resolve","delete"]:["reopen"],eF=(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0)?k:en===n("i6UMJ").LocationValue.PANEL&&(ee===v||ec.some(e=>e.id===ee)&&(0,n("6mKj3").expValEquals)("confluence_comment_expand_reply_editor","isEnabled",!0)),eO=(0,a.useMemo)(()=>(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")?[]:(eC??[]).filter(e=>{let n=Z[ev][ek];return(!n||!n.has(e.id))&&e.isUnread}).map(e=>e.id),[eC,Z,ek,ev]),eV=(0,a.useRef)(ew===n("ibqdE").ViewReplyOptions.ALL?0:eu-(eC?.length??0)),ex=(0,a.useRef)(""),eU=(0,a.useMemo)(()=>{let e=new Set(ec.filter(e=>e.parentId===v).map(e=>e.id)),n=Array.from(e).reduce((e,n)=>(e[n]=[],e),{}),t=ec.reduce((e,n)=>(e[n.id]=n,e),{});for(let o of ec.filter(n=>!e.has(n.id))){let a=o.parentId,i=0;for(;a&&i<100&&!e.has(a);)a=t[a]?.parentId,i++;a&&a in n&&n[a].push(o)}return n},[ec,v]),eK=(0,a.useMemo)(()=>{let e=[],t=ec.filter(e=>e.id in eU);t.sort((e,t)=>{let o=(0,n("6faGq").getValidDate)(e?.createdAtNonLocalized),a=(0,n("6faGq").getValidDate)(t?.createdAtNonLocalized);return o.getTime()-a.getTime()});for(let o=0;o<(0,n("7qvmT").getDefaultNumVisibleReplies)(eu,S,eS);o++)if(t.length>0){let n=t.pop();n&&e.unshift(n)}return e},[ec,S,eu,eU,eS]),eG=(0,a.useMemo)(()=>{let e=new Set;for(let n of eK)for(let t of(e.add(n.id),eU[n.id]))e.add(t.id);return e},[eK,eU]);I({isCurrentSelectedComment:s,visibleUnreadRepliesNotMarkedAsRead:eO,threadKey:ek,commentType:ev,setCommentsInThreadToBeMarkedAsRead:eo,updateUnreadCommentsListState:er});let ej=(0,a.useCallback)(e=>{"function"==typeof e?ef(n=>e(void 0===n?[]:n)):ef(e)},[]);(0,n("8gR6k").useUpdateVisibleReplies)({allReplies:ec,commentType:ev,isParentCommentOpen:eb,currentReplyView:ew,latestReplies:eK,latestReplyIds:eG,parentCommentId:v,setVisibleReplies:ej,shouldShowLatestReplies:eE,numOfHiddenReplies:eV});let e$=eC?.length??-1;(0,a.useEffect)(()=>{if(void 0===eC)return;let e=ew===n("ibqdE").ViewReplyOptions.ALL&&eC.length>0;if(ew===n("ibqdE").ViewReplyOptions.ALL&&eC.length>0){let t=`${ew}-${eC.length}`;ex.current!==t&&0!==eu&&(Q({type:"sendTrackEvent",data:{action:"repliesRenderedStateChanged",actionSubject:"comment",actionSubjectId:v,objectType:U,objectId:x,source:S?n("en1dX").AnalyticsSource.STANDALONE:n("en1dX").AnalyticsSource.COMMENTS_PANEL,attributes:{commentType:ev===n("8i27m").CommentType.GENERAL?"page":"inline",repliesRendered:e,currentReplyView:ew,numOfReplies:eu,visibleRepliesCount:eC.length}}}).fire(),ex.current=t)}},[ew,eC,e$,eu,ev,eh,Q,v,U,x,S]);let eX=(0,a.useCallback)(()=>{c===n("cD1qu").PageMode.VIEW?D?.emit(n("21K7m").AnnotationUpdateEvent.REMOVE_ANNOTATION_FOCUS):D?.emit("setselectedannotation",null)},[c,D]);(0,a.useEffect)(()=>()=>{ex.current="","database"!==ed&&"whiteboard"!==ed&&(0,n("6mKj3").expValEquals)("confluence_comment_reset_reply_options","isEnabled",!0)&&(ea(),eX())},[eX,ea,ed]);let eq=()=>{let e=ev===n("8i27m").CommentType.GENERAL&&p.id&&(0,n("9wGTI").fg)("confluence_comment_panel_footer_reply_editor_focus");q?eT(m.CommentWarningDialog,{onConfirm:()=>{z(),ea({parentCommentId:v,location:n("i6UMJ").LocationValue.PANEL}),e&&D&&eX()}}):(ea({parentCommentId:v,location:n("i6UMJ").LocationValue.PANEL}),e&&D&&eX())},eB=(0,a.useCallback)((e,n)=>{e.stopPropagation(),ey(n)},[ey]),ez=(0,a.useCallback)(e=>{e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||ey(null)},[ey]),eW=()=>{let e=n("irVI7").REPLY_TO_INLINE_COMMENT_LOAD_EXPERIENCE;ev===n("8i27m").CommentType.GENERAL&&(e=n("irVI7").REPLY_TO_PAGE_COMMENT_LOAD_EXPERIENCE),eh.succeed({name:e}),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")||J({annotationId:ek,scrollToEnd:!0})},eH=(0,a.useCallback)((e,n)=>K({originalMutationFn:F,options:e,onCacheUpdateError:n}),[K,F]),eQ=()=>{let o={};(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")&&(o=y,(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&(o=T));let m=e(a).createElement(r.LazyCommentEditor,{pageId:x,pageType:U,content:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?(0,n("7qvmT").getAdfForQuickReplyMention)(et):void 0,appearance:"chromeless",EditorComponent:i.ChromelessEditor,onSaveComment:(e,t)=>(0,n("7qvmT").onSaveReply)({pageId:x,parentCommentId:v,cloudId:W,adf:e,onSuccess:t,pageMode:c,editCommentQueryId:u,setCommentForEdit:e_,createAnalyticsEvent:Q,pageType:U,experienceTracker:eh,createInlineReplyFn:eH,createGeneralReplyFn:O,createObjectReplyFn:(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?j:void 0,addCommentInCommentsDataManagerCacheFn:(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?G:void 0,setReplyToCommentId:ea,resetContentChanged:z,setReplyView:eA,selectedAnnotation:p,addReplyToCommentThread:Y,threadKey:ek,updateReadCommentsListState:em,commentType:ev,searchSessionId:H,isReactionsEnabled:V,analyticsSource:S?n("en1dX").AnalyticsSource.STANDALONE:n("en1dX").AnalyticsSource.COMMENTS_PANEL,contentTypesCommentService:es}),onContentChange:B,onEditorReady:eW,commentMode:"reply",commentType:ev===n("8i27m").CommentType.GENERAL?"page":"inline",spaceId:"",showCancelButton:!0,useNewWarningModal:!0,hideWatchCheckbox:!0,expandEditor:eF,pageMode:"view",hasMediaUploadPermissions:eD,topLevelCommentId:t.id,shouldWarnOnInternalNavigation:!0,onCancelComment:({destroy:e=!1}={})=>{(!e||ee!==v)&&(0,n("9wGTI").fg)("confluence_comment_fix_reply_discard")?ea():(0,n("9wGTI").fg)("confluence_comment_fix_reply_discard")||ea()},isCommentsPanel:!0,wasRemovedByAnotherUser:t.wasRemovedByAnotherUser,isOffline:el});return e(a).createElement(n("666Tc").NewReplyContainer,{mode:"view",isCommentsPanel:!0,isFabricPage:!0,"data-testid":"comments-panel-new-reply-container"},(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0)?m:e(a).createElement(n("1Sjzs").WithCurvedBranchingStyle,{showDefaultStyles:(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2"),customStyles:o},m))};(0,a.useEffect)(()=>{eC&&eC.length>0&&(0,n("6mKj3").expVal)("confluence_frontend_comments_a11y_kb_exp","isEnabled",!1)&&eC.forEach(e=>{let n=document.querySelector(`[data-testid="comment-thread-${t.id}-replies-${e.id}"]`);n instanceof HTMLElement&&n.setAttribute("tabIndex","0")})},[eC,t.id]);let eY=()=>e(a).createElement(n("58Zuw").RepliesToggler,{replies:ec,setVisibleReplies:ej,unreadReplyIds:ep,setReplyView:eA,threadKey:ek,currentReplyView:ew,numOfHiddenReplies:eV,commentType:ev,parentCommentId:v,isParentOpen:eb,canAddComments:b,shouldShowLatestReplies:eE,setShouldShowLatestReplies:eI,latestReplyIds:eG,isStandaloneComment:S,onMouseEnter:N,onMouseLeave:R,analyticsSource:S?n("en1dX").AnalyticsSource.STANDALONE:n("en1dX").AnalyticsSource.COMMENTS_PANEL,expandReplyEditor:eF});return e(a).createElement(e(a).Fragment,null,eu>0&&(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0)&&eY(),e(a).createElement("div",{"data-testid":`comment-thread-${t.id}-replies`,className:(0,n("gMc0m").default)(["_1e0c1txw _2lx21bp4 _19bvpxbi _u5f3u2gc",t.wasRemovedByAnotherUser&&"_tzy41ssb",S&&"_u5f3pxbi"])},e(a).createElement("div",null,eu>0&&!(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0)&&eY(),eC&&eC.length>0&&e(a).createElement("div",{"data-testid":`comment-thread-${t.id}-reply-list`,className:(0,n("gMc0m").default)([!(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")&&"_1kl71uh4 _bozgze3t"])},eC.map((i,r)=>i&&e(a).createElement("div",{key:i.id,"data-testid":`comment-thread-${t.id}-replies-${i.id}`,onMouseEnter:()=>N(i.id),onMouseLeave:R,onFocus:e=>eB(e,i.id),onBlur:ez,"aria-label":X(h.replyAriaLabel,{authorName:i.author?.displayName||X(n("3ejfs").commentsi18n.anonymous),timestamp:(0,n("6faGq").formatTimestampForAriaLabel)({intl:$,dateString:i.createdAtNonLocalized,isReply:!0})}),className:(0,n("gMc0m").default)([(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?"_qtt8glyw _kqswh2mm _ca0qu2gc _n3tdu2gc _19bv1ejb":"_qtt8glyw _kqswh2mm _ca0qu2gc _n3tdu2gc _19bvpxbi",(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&"_ca0qze3t _19bvze3t _n3tdze3t"])},e(a).createElement(C.Comment,{comment:i,supportedTopLevelActions:eP,pageInfo:o,pageMode:c,isUnread:(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")?ei.has(i.id):!Z[ev][ek]?.has(i.id)&&i.isUnread,isHovered:d===i.id||eg===i.id&&(0,n("6mKj3").expVal)("confluence_frontend_comments_a11y_kb_exp","isEnabled",!1),threadKey:ek,hideBranchingStyle:!b&&r===eC.length-1||S&&r===eC.length-1||r===eC.length-1&&!eF&&(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0),adjustForNestedReplies:ev===n("8i27m").CommentType.GENERAL&&i.id in eU&&eU[i.id]?.length>0&&(0,n("9wGTI").fg)("confluence_frontend_content_wrapper"),canAddComments:b,isParentCommentOpen:eb,deleteStandaloneComment:w,isStandaloneComment:S,replyToComment:A,updateReactionsCacheFn:M,onRendered:L,isLastUnnestableReply:r===eC.length-1,commentHandlesPadding:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper"),hasParentMaxHeight:P}),ev===n("8i27m").CommentType.GENERAL&&i.id in eU&&eU[i.id]?.length>0&&(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&e(a).createElement(E,{nestedReplies:eU[i.id],unreadReplyIds:ep,targetCommentIdForScroll:i.id}))))),(0,n("6mKj3").expValEquals)("confluence_comments_tuneup","isEnabled",!0)?e(a).createElement(l.RepliesFooter,{replyView:ew,setReplyView:eA,isEditorExpanded:k,isParentCommentOpen:eb,isStandaloneComment:S,handleReplyButtonClick:eq,numOfVisibleReplies:eC?eC.length:0,isOffline:el,scrollToId:ek,location:n("i6UMJ").LocationValue.PANEL},eQ()):eF&&(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?eQ():S?null:eb&&b&&(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")&&e(a).createElement(n("1Sjzs").WithCurvedBranchingStyle,{showDefaultStyles:!0,customStyles:g,testId:"comments-panel-reply-comment-action",onClick:eq},e(a).createElement(n("ccHMk").default,{"data-cy":"comments-panel-reply-comment-action",appearance:"subtle",isDisabled:!eb,analyticsContext:{attributes:{name:"replyToCommentButton",source:n("en1dX").AnalyticsSource.COMMENTS_PANEL}},interactionName:"start-reply-comment-action",...(0,n("6mKj3").expVal)("confluence_frontend_comments_a11y_kb_exp","isEnabled",!1)?{"aria-label":X(h.threadReplyButtonAriaLabelWithName,{name:t.author?.displayName||X(n("3ejfs").commentsi18n.anonymous)})}:{},className:(0,n("gMc0m").default)(["_1tv3glyw"])},e(a).createElement(n("gtD4K").default,h.replyAction)))),eF&&!(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")&&eQ())}}),t("9tfnI",function(t,o){var a=n("42omo"),i=n("auGhu"),r=n("kEmgx"),m=n("5fMeR");let l=(0,n("eSUdr").default)`mutation CommentResolveInlineCommentMutation($commentId:ID!$resolved:Boolean!){resolveInlineComment(commentId:$commentId resolved:$resolved dangling:false){status resolveProperties{resolved resolvedUser isDangling resolvedFriendlyDate resolvedTime}}}`,s=(0,n("eSUdr").default)`mutation CommentResolveCommentMutation($commentIds:[ID]!$cloudId:ID!){confluence_resolveComments(commentIds:$commentIds cloudId:$cloudId){success commentResolutionStates{commentId resolveProperties{resolvedTime resolvedUser resolvedFriendlyDate}status}errors{message extensions{...on ResolveCommentsMutationErrorExtension{errorType statusCode}__typename}}}}`,d=(0,n("eSUdr").default)`mutation CommentReopenCommentMutation($commentId:ID!$cloudId:ID!){confluence_reopenComment(commentId:$commentId cloudId:$cloudId){success commentResolutionStates{commentId status}errors{message extensions{...on ReopenCommentsMutationErrorExtension{errorType statusCode}__typename}}}}`,c=(0,n("eSUdr").default)`mutation CommentDeleteInlineCommentMutationWithStepMutation($input:DeleteInlineCommentInput!){deleteInlineComment(input:$input)}`,u=(0,n("eSUdr").default)`mutation CommentDeleteInlineCommentMutation($commentIdToDelete:ID!$deleteFrom:CommentDeletionLocation){deleteComment(commentIdToDelete:$commentIdToDelete deleteFrom:$deleteFrom)}`,p=(0,n("eSUdr").default)`mutation CommentDeleteGeneralCommentMutation($commentIdToDelete:ID!$deleteFrom:CommentDeletionLocation){deleteComment(commentIdToDelete:$commentIdToDelete deleteFrom:$deleteFrom)}`,E=(0,n("cgtv4").defineMessages)({commentReopenedFlagTitle:{id:"comments-panel.comment.reopened.flag.title",defaultMessage:"Comment reopened"},commentReopenFailedFlagTitle:{id:"comments-panel.comment.reopen.failed.flag.title",defaultMessage:"Failed to reopen comment"},commentReopenCacheUpdateFailedFlagTitle:{id:"comments-panel.comment.reopen.cache-update.failed.flag.title",defaultMessage:"Failed to update reopened comment. Please refresh the page."},retryCTA:{id:"comments-panel.comment.reopen.failed.flag.cta.retry",defaultMessage:"Retry now"},cannotDeleteTitle:{id:"comments-panel.could.not.delete.title",defaultMessage:"Unable to delete comment"}}),I=(0,n("7W8i8").getLogger)("page-comments-queries");t.exports.Comment=({comment:t,supportedTopLevelActions:o,pageMode:C,pageInfo:f,isUnread:_=!1,isHovered:g,threadKey:y,flags:T,isAnnotatedTextPressed:h,setAnnotatedTextPressed:v,adjustForNestedReplies:N=!1,hideBranchingStyle:R=!1,canAddComments:b=!0,isThreadHovered:S,isParentCommentOpen:w,isStandaloneComment:A,deleteStandaloneComment:M,replyToComment:L,updateReactionsCacheFn:D,onRendered:k,isLastUnnestableReply:P=!1,commentHandlesPadding:F=!1,hasParentMaxHeight:O=!1})=>{let V,x=(0,a.useRef)(null),U=(0,a.useRef)(null),[K,G]=(0,a.useState)(""),{isReactionsEnabled:j}=(0,a.useContext)(n("8SCD6").ReactionsContext),{commentService:$}=(0,n("6hmtW").useCommentService)(),X=(0,n("7B9wr").useIsNewDanglingCommentExperienceEnabled)(),q=(0,n("cZa7r").useAnnotationsIsOffline)(),{setEditorViewProps:B}=(0,n("cZa7r").useAnnotationsDispatch)(),z=(0,a.useContext)(n("1kHsc").ExperienceTrackerContext),{resetContentChanged:W}=(0,n("bSvtO").useCommentsContentActions)(),[H]=(0,n("ep3mz").usePageContentId)(),{createAnalyticsEvent:Q}=(0,n("inPa6").useAnalyticsEvents)(),{removeUnresolvedInlineComment:Y,addUnresolvedInlineComment:J}=(0,n("k8e76").useInlineCommentsActions)(),[{commentsDataMap:Z,orderedActiveAnnotationIdList:ee,cacheUpdateFailed:en},{addNewCommentThreads:et,deleteParentComment:eo,handleRemovingComments:ea,setOrderedActiveAnnotationIdList:ei}]=(0,n("8i27m").useCommentsData)(),{setCacheUpdateFailed:er}=(0,n("8i27m").useCommentsDataActions)(),{deleteCommentInCache:em}=(0,n("NYiei").useAllCommentsData)({contentId:H||"",options:{skip:!0}}),el=(0,n("4L9ve").useProcessedCommentsDataState)(),es=(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?el.commentsDataMap:Z,[{annotations:ed}]=(0,n("aUU0C").useEditorAnnotations)(),{rendererActions:ec}=(0,n("8WQTF").useRendererActions)(),[{updateDocumentFn:eu}]=(0,n("1YPul").useUpdateDocument)(),{cloudId:ep}=(0,n("bQm3c").useSessionData)(),[{currentlySelectedThreadKey:eE},{setCurrentView:eI,setCurrentlySelectedThreadKey:eC,setReplyToCommentId:ef}]=(0,n("3mVfX").useCommentsPanel)(),{formatMessage:e_}=(0,n("8C5kA").default)(),{focusedCommentId:eg}=(0,n("liGyh").useInlineCommentQueryParams)(),{scrollCommentsPanelToThread:ey}=(0,n("6KwrO").useCommentsPanelScroll)(),{isCommentsPanelShown:eT,showCommentsPanel:eh}=(0,m.useShowCommentsPanel)(),[ev]=(0,n("ep3mz").useContentType)(),[eN]=(0,n("1KmJq").useMutation)(l),[eR]=(0,n("1KmJq").useMutation)(s),eb=(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?eR:eN,[eS]=(0,n("1KmJq").useMutation)(d,{refetchQueries:C!==n("cD1qu").PageMode.VIEW||(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?[]:[{query:n("3s9yq").InlineCommentsQuery,variables:{pageId:H}}]}),[ew]=(0,n("1KmJq").useMutation)(c),[eA]=(0,n("1KmJq").useMutation)(u),[eM]=(0,n("1KmJq").useMutation)(p),{updateCommentInCache:eL}=(0,n("jbF1h").useUpdateCommentInCache)(),{updateCommentInCache:eD}=(0,n("jbF1h").useUpdateCommentInCache)(),{updateCommentInCache:ek}=(0,n("jbF1h").useUpdateCommentInCache)(),eP=C===n("cD1qu").PageMode.VIEW?(0,n("gczDe").getRendererAnnotationEventEmitter)():(0,n("gfqXk").getEditorAnnotationEventEmitter)(),eF=t?.author?.accountId,eO=t?.author?.profilePicture?.path,eV=t?.author?.displayName??e_(n("3ejfs").commentsi18n.anonymous),ex=t?.id,eU=t?.version?.when,eK=t?.createdAt?.value,eG=t?.createdAtNonLocalized,ej=t?.version?.by?.displayName,e$=t?.version?.when,eX=t?.permissions,eq=t?.body?.value,eB=t?.author?.permissionType??void 0,ez=t?.parentId,eW=!!ez,eH=(t?.version?.number||0)>1,eQ=t?.replies?.length||0,eY=C===n("cD1qu").PageMode.EDIT?t?.links?.editui:t?.links?.webui,eJ="database"===ev||"whiteboard"===ev,eZ=t?.reactionsSummary,e0=t?.location,e1=t?.location,e9=e0?.type==="INLINE"?n("8i27m").CommentType.INLINE:n("8i27m").CommentType.GENERAL,e7=(0,a.useCallback)(e=>{let t=e===n("8i27m").CommentType.INLINE?e0?.inlineResolveProperties:e1?.commentResolveProperties;if(!eW)return t||void 0},[e0,e1,eW])(e9),e2=e0?.inlineText||void 0,e8=t?.wasRemovedByAnotherUser,e3=e8&&e8===n("8i27m").CommentActionType.RESOLVE_COMMENT_THREAD,e4=e8&&e8===n("8i27m").CommentActionType.DELETE_COMMENT,e6=(0,a.useCallback)((e,t)=>em({commentId:e,onError:o=>{(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:t,error:o,commentId:e})}}),[em,z]),e5=(0,a.useCallback)(({isCacheUpdateFailed:e})=>{T?.showErrorFlag({id:ex,title:e_(e?E.commentReopenCacheUpdateFailedFlagTitle:E.commentReopenFailedFlagTitle),isAutoDismiss:!0,actions:[{content:e_(E.retryCTA),onClick:()=>{T.hideFlag(T.state.flags[0]?.id),U.current?.()}}]})},[ex,T,e_]),ne=(0,a.useCallback)((e,t)=>ek({mutationResult:t,commentId:ex,updateCallback:n("kgNLQ").reopenCommentInCacheCallback,onError:()=>e5({isCacheUpdateFailed:!0})}),[ex,e5,ek]),nn=()=>{eS({variables:{commentId:ex,cloudId:ep},update:(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?ne:void 0}).then(()=>{J(y,C),eJ||e9!==n("8i27m").CommentType.INLINE||(C===n("cD1qu").PageMode.VIEW?(0,n("gczDe").getRendererAnnotationEventEmitter)().emit(n("21K7m").AnnotationUpdateEvent.SET_ANNOTATION_STATE,{[y]:{id:y,annotationType:n("cUycv").AnnotationTypes.INLINE_COMMENT,state:n("cUycv").AnnotationMarkStates.ACTIVE}}):(0,n("gfqXk").getEditorAnnotationEventEmitter)().emit("unresolve",y));let e={...es},t=e[e9][y];if(t){t.isOpen=!0,t.wasRemovedByAnotherUser=!1;let o=t.location;o&&"commentResolveProperties"in o&&o.commentResolveProperties&&(o.commentResolveProperties.resolved=!1),o&&"inlineResolveProperties"in o&&o.inlineResolveProperties&&(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&(o.inlineResolveProperties.resolved=!1),et(e)}if(T?.showSuccessCircleFlag({id:ex,title:e_(E.commentReopenedFlagTitle),isAutoDismiss:!0,actions:[{content:e_(n("9CnRS").i18n.goToCommentCTA),onClick:()=>{let e,t=e0?.inlineResolveProperties?.isDangling;t&&X?((0,n("9wGTI").fg)("confluence_comments_unified_navigation")?eI(n("3mVfX").ViewValues.DELETED_CONTENT):eh({openWithView:n("3mVfX").ViewValues.DELETED_CONTENT}),e=n("3mVfX").ViewValues.DELETED_CONTENT):eT&&(0,n("9wGTI").fg)("confluence_comments_fix_vqr_fliter_scroll")&&(eI(n("3mVfX").ViewValues.OPEN),e=n("3mVfX").ViewValues.OPEN),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")&&(0,n("9FoVw").handleCommentsPanelNavigationWithViewChange)({scrollBehavior:n("9FoVw").ScrollBehavior.SMOOTH,context:n("9FoVw").NavigationContext.PANEL,block:"center",annotationId:y,commentType:e9===n("8i27m").CommentType.INLINE?"INLINE":"FOOTER",annotationClicked:!0,expectedView:e}),e9===n("8i27m").CommentType.INLINE?(eC(y),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")||ey((0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?{annotationId:y,annotationClicked:!0,isCommentThreadDangling:t}:{annotationId:y,isCommentThreadDangling:t})):e9===n("8i27m").CommentType.GENERAL&&(0,n("9wGTI").fg)("confluence_comments_fix_vqr_fliter_scroll")&&(eC(y),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")||ey({annotationId:y,commentType:e9,scrollOnLoad:!0})),T.hideFlag(T.state.flags[0]?.id)}},{content:e_(n("9CnRS").i18n.undoCTA),onClick:()=>{x.current?.(),T.hideFlag(T.state.flags[0]?.id)}}]}),e9===n("8i27m").CommentType.INLINE){if(eJ&&(0,n("9wGTI").fg)("cc-whiteboards-consolidating-comments")){let e=t.location;$.onReopenResolvedComment?.({contentId:H,referenceId:e.inlineMarkerRef})}let e=ee.map(e=>e.threadKey);if(!e7?.isDangling){let t=ed;if(C===n("cD1qu").PageMode.VIEW){let e=ec?.getAnnotationMarks();t=e?.map(e=>e.attrs.id)??[]}t.length>0&&(0,n("g0DaR").insertReopenedCommentAnnotation)(t,y,e,ei)}}}).catch(()=>{e5({isCacheUpdateFailed:!1})})},nt=e9===n("8i27m").CommentType.INLINE?n("irVI7").RESOLVE_INLINE_COMMENT_EXPERIENCE:n("irVI7").RESOLVE_PAGE_COMMENT_EXPERIENCE,no=(0,a.useCallback)(e=>{(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:nt,error:e})},[z,nt]),na=(0,a.useCallback)((e,t)=>eL({mutationResult:t,commentId:ex,updateCallback:n("kgNLQ").resolveInlineCommentInCacheCallback,onError:no}),[eL,ex,no]),ni=(0,a.useCallback)((e,t)=>eD({mutationResult:t,commentId:ex,updateCallback:n("kgNLQ").resolveCommentInCacheCallback,onError:no}),[eD,ex,no]);(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)&&(V=(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?ni:na);let nr=()=>{let e=(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?{commentIds:[ex],cloudId:ep}:{commentId:ex,resolved:!0},o=(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?n("eg9xl").ActiveCommentsQuery:n("jkPJy").CommentsPanelQuery,a=(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")?(0,n("9rE3H").buildConsistentActiveCommentsQueryVariables)({pageId:H,type:e9===n("8i27m").CommentType.GENERAL?"FOOTER":void 0}):{pageId:H,contentStatus:["CURRENT","DRAFT"],first:1e3};eb({variables:e,update:V||((e,{data:i})=>{try{let t=e.readQuery({query:(0,n("86okN").toDocumentNode)(o),variables:a}),i=Object.assign({},t?.comments),r=i.totalCount||0,m=i.nodes?.filter(e=>null!==e),l=m.findIndex(e=>e.id===ex);-1!==l&&(m.splice(l,1),r--),e.writeQuery({query:(0,n("86okN").toDocumentNode)(o),variables:a,data:{comments:{nodes:m,totalCount:r}}}),en&&er(!1)}catch(e){I.error`An error occurred when updating cache for comments panel resolve - ${e}`,er(!0)}if(!eW&&t.type===n("8i27m").CommentType.GENERAL&&(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2"))try{let{confluence_resolveComments:{commentResolutionStates:t,success:o}}=i,a=j?n("ftXPY").CommentsSectionQuery:n("ftXPY").CommentsSectionWithoutReactionsQuery;if(!o||0===t.length)return;let{commentId:r}=t[0],m=e.readQuery({query:a,variables:{contentId:H,offset:"",first:n("2i3To").DEFAULT_LIMIT}}),l=m?.comments?.edges,s=l?.filter(e=>e?.node?.id!==r&&!e?.node?.ancestors.map(e=>e?.id).includes(r))||[],d={comments:{...m?.comments,totalCount:s.length,pageInfo:{...m?.comments?.pageInfo,endCursor:"",hasNextPage:!1},edges:s},content:{...m?.content,nodes:[...m?.content?.nodes||[]]},user:{...m?.user}};e.writeQuery({query:a,variables:{contentId:H,offset:"",first:n("2i3To").DEFAULT_LIMIT},data:{...d}})}catch(e){I.error`An error occurred when updating cache for general comments resolve - ${e}`,er(!0)}})}).then(()=>{let e={...es};if(e[e9][y]){e[e9][y].isOpen=!1;let n=e[e9][y].location;n&&n.inlineResolveProperties&&(n.inlineResolveProperties.resolved=!0),n&&n.commentResolveProperties&&(n.commentResolveProperties.resolved=!0),et(e)}$.onResolveComment?.(y),(0,n("8dA1U").handleResolveSuccess)({commentId:ex,parentCommentMarkerRef:y,pageId:H,pageMode:C,commentType:e9,eventEmitter:eP,source:n("en1dX").AnalyticsSource.COMMENTS_PANEL,removeUnresolvedInlineComment:Y,createAnalyticsEvent:Q,setEditorViewProps:B}),ei(ee.map(e=>e.threadKey).filter(e=>e!==y)),(0,n("9wGTI").fg)("confluence_frontend_comments_panel_v2")&&T?.showSuccessCircleFlag({id:ex,title:e_(n("9CnRS").i18n.resolvedFlagText),isAutoDismiss:!0,actions:[{content:e_(n("9CnRS").i18n.goToCommentCTA),onClick:()=>{eT?eI(n("3mVfX").ViewValues.RESOLVED):eh({openWithView:n("3mVfX").ViewValues.RESOLVED}),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")||ey({annotationId:y,scrollOnLoad:(0,n("9wGTI").fg)("confluence_comments_fix_vqr_fliter_scroll")}),(0,n("9wGTI").fg)("confluence_comments_unified_navigation")&&(0,n("9FoVw").handleCommentsPanelNavigationWithViewChange)({scrollBehavior:n("9FoVw").ScrollBehavior.SMOOTH,context:n("9FoVw").NavigationContext.PANEL,block:"center",annotationId:y,commentType:e9===n("8i27m").CommentType.INLINE?"INLINE":"FOOTER",annotationClicked:!0,expectedView:n("3mVfX").ViewValues.RESOLVED}),T.hideFlag(T.state.flags[0]?.id)}},{content:e_(n("9CnRS").i18n.undoCTA),onClick:()=>{eT||eh({openWithView:n("3mVfX").ViewValues.OPEN}),nn(),T.hideFlag(T.state.flags[0]?.id)}}]}),z.succeed({name:nt})}).catch(e=>{no(e)})};x.current=nr,U.current=nn;let nm=f?.type??"",nl=f?.space?.id??"",ns=f?.operations||[],nd=ns.some(e=>e?.operation==="create"&&e?.targetType==="comment"),nc=(0,n("9wGTI").fg)("confluence_comment_use_comment_media_endpoint")?nd:ns.some(e=>e?.operation==="update"&&e?.targetType===nm),nu=e7?.resolved&&ex===eg,np=!eW&&e8?["reopen"]:o,nE=F&&!A&&ex===K&&eW;return e(a).createElement("div",{className:(0,n("gMc0m").default)([F&&"_19bv1ejb _n3tdu2gc",nE&&"_1kl711qs"])},ex===K?e(a).createElement(i.EditComment,{pageId:H,pageType:nm,annotationId:y,commentId:ex,spaceId:nl,content:eq??"",isReply:eW,displayCommentInViewMode:()=>{G("")},avatarUrl:eO??"",displayName:eV,date:eU??"",dateUrl:eY??"",createdAtNonLocalized:eG??"",versionByDisplayName:ej,versionDate:e$??"",resolveProperties:e7,mode:C===n("cD1qu").PageMode.VIEW?"view":"edit",hasMediaUploadPermissions:nc,isCommentsPanel:eT,commentType:e9,isStandaloneComment:A,isOffline:q,isLastUnnestableReply:P,hasParentMaxHeight:O}):e(a).createElement(r.CommentBody,{mode:"view",userId:eF,avatarUrl:eO,displayName:eV,date:eU??"",dateUrl:eY??"",createdAt:eK??"",createdAtNonLocalized:eG??"",versionByDisplayName:ej,versionDate:e$??"",pageId:H,pageType:nm,commentId:ex??"",isReply:eW,isEdited:eH,parentCommentId:ez,permissions:eX,content:eq??"",permissionType:eB??void 0,supportedActions:np,deleteComment:e9===n("8i27m").CommentType.INLINE?()=>{let t,o=e7?.isDangling,i=!eJ&&C===n("cD1qu").PageMode.VIEW&&!eW,r=!o&&i;if(r)try{let e=ec?.deleteAnnotation(y,"inlineComment");if(!e)return void z.stopOnError({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:Error(`Unable to remove annotation ${y} from document`)});t=e.step}catch(e){z.stopOnError({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:e});return}if(A){M&&ez&&M(ez,ex);return}(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&W();let m=(0,n("fy5yb").deleteInlineParentComment)({isReply:eW,threadKey:y,commentType:e9,commentsDataMap:es,deleteParentComment:eo}),l={variables:r?{input:{commentId:ex,step:t?(0,n("aMfLn").constructStepForGql)(t):{}}}:{commentIdToDelete:ex,deleteFrom:C===n("cD1qu").PageMode.EDIT?n("8z9UY").CommentDeletionLocation.EDITOR:n("8z9UY").CommentDeletionLocation.LIVE},update:(0,n("kgNLQ").selectUpdateFunction)((0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),()=>e6(ex,n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE),()=>eW?(0,n("g0DaR").updateApolloCacheCallback)("delete",{pageId:H,contentStatus:["CURRENT","DRAFT"]},ez,ex):void 0)};(r?ew:eA)({...l}).then(({data:e})=>{if(!e||r&&!e.deleteInlineComment||!r&&!e.deleteComment)throw Error("No data returned from mutation");let t=()=>{ea({threadKey:y,commentId:ex,action:n("8i27m").CommentActionType.DELETE_COMMENT,commentType:e9})},o=e=>{if(C===n("cD1qu").PageMode.VIEW){let t=ec?.deleteAnnotation(e,"inlineComment");t&&t.doc&&(eP.emit(n("21K7m").AnnotationUpdateEvent.REMOVE_ANNOTATION_FOCUS),eP.emit(n("21K7m").AnnotationUpdateEvent.DESELECT_ANNOTATIONS),eu&&eu(t.doc))}else eP.emit("delete",e);(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")||(W(),eo({threadKey:y,commentType:e9}),e9===n("8i27m").CommentType.INLINE&&ei(ee.map(e=>e.threadKey).filter(e=>e!==y)))};$.onDeleteComment?.(y),(0,n("8dA1U").handleDeleteSuccess)({commentId:ex,annotationId:y,pageId:H,pageMode:C,isReply:eW,source:A?n("en1dX").AnalyticsSource.STANDALONE:n("en1dX").AnalyticsSource.COMMENTS_PANEL,inlineNodeTypes:void 0,createAnalyticsEvent:Q,removeUnresolvedInlineComment:Y,onSuccess:e=>{eW?t():o(e),z.succeed({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE})}})}).catch(t=>{if((0,n("9wGTI").fg)("confluence_frontend_show_already_deleted_flag")){let o=(0,n("isdzP").parseError)(t),i=(0,n("isdzP").getTranslatedError)(o.message,ex);(0,n("isdzP").isAlreadyDeletedError)(i)&&(T?.showWarningFlag({id:ex,title:e(a).createElement(n("gtD4K").default,E.cannotDeleteTitle),description:e(a).createElement(n("gtD4K").default,i)}),Q({type:"sendOperationalEvent",data:{action:"alreadyDeleted",actionSubject:"comment",actionSubjectId:ex,objectType:"page",objectId:H,source:n("en1dX").AnalyticsSource.COMMENTS_PANEL,attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),commentType:n("8i27m").CommentType.INLINE,mode:C,framework:n("kmHPt").InlineCommentFramework.ANNOTATION_PROVIDER,isReply:eW}}}).fire())}m&&(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&et(m),(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:t,commentId:ex})})}:()=>{let t;C!==n("cD1qu").PageMode.VIEW&&(t=C===n("cD1qu").PageMode.EDIT?n("8z9UY").CommentDeletionLocation.EDITOR:n("8z9UY").CommentDeletionLocation.LIVE);let o=(0,n("9rE3H").buildConsistentActiveCommentsQueryVariables)({pageId:H,type:"FOOTER"});eM({...{variables:{commentIdToDelete:ex,deleteFrom:t},update:(0,n("kgNLQ").selectUpdateFunction)((0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),()=>e6(ex,n("irVI7").DELETE_PAGE_COMMENT_EXPERIENCE),()=>eW?(0,n("87CZC").updateApolloCacheReplyCallback)("delete",o,ez,j,ex):(0,n("87CZC").updateApolloCacheParentCallback)("delete",o,j,ex))}}).then(({data:e})=>{if(!e||!e.deleteComment)throw Error("No data returned from mutation");W(),eW?ea({threadKey:y,commentId:ex,action:n("8i27m").CommentActionType.DELETE_COMMENT,commentType:e9}):eo({threadKey:y,commentType:e9}),Q({type:"sendTrackEvent",data:{action:"deleted",actionSubject:"comment",actionSubjectId:ex,objectType:"page",objectId:H,source:n("en1dX").AnalyticsSource.COMMENTS_PANEL,attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),isReply:eW,commentType:n("8i27m").CommentType.GENERAL,source:A?n("en1dX").AnalyticsSource.STANDALONE:n("en1dX").AnalyticsSource.COMMENTS_PANEL,pageMode:C}}}).fire(),z.succeed({name:n("irVI7").DELETE_PAGE_COMMENT_EXPERIENCE})}).catch(t=>{if((0,n("9wGTI").fg)("confluence_frontend_show_already_deleted_flag")){let o=(0,n("isdzP").parseError)(t),i=(0,n("isdzP").getTranslatedError)(o.message,ex);(0,n("isdzP").isAlreadyDeletedError)(i)&&(T?.showWarningFlag({title:e(a).createElement(n("gtD4K").default,E.cannotDeleteTitle),description:e(a).createElement(n("gtD4K").default,i)}),Q({type:"sendOperationalEvent",data:{action:"alreadyDeleted",actionSubject:"comment",actionSubjectId:ex,objectType:"page",objectId:H,source:n("en1dX").AnalyticsSource.COMMENTS_PANEL,attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),commentType:n("8i27m").CommentType.GENERAL,mode:C,isReply:eW}}}).fire())}(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").DELETE_PAGE_COMMENT_EXPERIENCE,error:t,commentId:ex})})},editComment:()=>{G(ex)},resolveComment:nr,numReplies:eQ,isUnread:_,isCommentActive:!0,isCommentsPanel:!0,isHovered:g,isResolvedByAnotherUser:e3,isFocused:nu,isOffline:q,resolveProperties:e7,annotationId:y,annotatedText:e2,reopenComment:nn,replyToComment:A?e=>{L&&L(e,t)}:e=>{ef({parentCommentId:e,location:n("i6UMJ").LocationValue.PANEL,user:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?{displayName:t?.author?.displayName,accountId:t?.author?.accountId}:void 0})},inheritedReactionsData:eZ,isDeletedByAnotherUser:e4,currentlySelectedThreadKey:eE,setCurrentlySelectedThreadKey:eC,isAnnotatedTextPressed:h,setAnnotatedTextPressed:v,commentType:e9,adjustForNestedReplies:N,hideBranchingStyle:R,canAddComments:b,isThreadHovered:S,isParentCommentOpen:w,reactionsCacheUpdateFn:D,isStandaloneComment:A,onRendered:k}))}}),t("1YPul",function(e,t){let o=(0,n("1P1Tu").createStore)({initialState:{updateDocumentFn:()=>{}},actions:{setUpdateDocumentFn:e=>({setState:n})=>{n({updateDocumentFn:e})}},name:"UpdateDocumentStore"}),a=(0,n("9zUhf").createHook)(o),i=(0,n("9zUhf").createActionsHook)(o);e.exports.useUpdateDocument=a,e.exports.useUpdateDocumentActions=i}),t("2UZkz",function(t,o){var a=n("42omo"),i=n("7EEGh");let r=({refs:e,shouldSkip:n=!1})=>{let[t,o]=(0,a.useState)(new Set),i=(0,a.useRef)({root:null,rootMargin:"0px",threshold:.5});return(0,a.useEffect)(()=>{if(n||!e.every(({ref:e})=>e.current))return;let t=new IntersectionObserver(n=>{n.forEach(n=>{let t=e.find(({ref:e})=>e.current===n.target);t&&o(e=>{let o=new Set(e),a=o.has(t.id);return n.isIntersecting?a||o.add(t.id):a&&o.delete(t.id),o})})},i.current);return e.forEach(({ref:e})=>{e.current&&t.observe(e.current)}),()=>{t.disconnect()}},[e,n]),t},m=({commentData:t,isEditor:o,focusedCommentId:i,shouldCollapseReplies:m,setIsReplyChainCollapsed:l,isInlineCommentVisible:s,onUpdateUnreadStatus:d})=>{let[{unreadCommentsListState:c,readCommentsListState:u},{updateUnreadCommentsListState:p,updateReadCommentsListState:E}]=(0,n("fHAwL").useUnreadComments)(),I=(0,n("dPJCf").createSingleQueryParamHook)("unreadCommentMark")(),[C,f]=(0,a.useState)(new Set),_=(0,a.useCallback)((e,n)=>!n.has(e),[]),[g,{error:y}]=(0,n("1KmJq").useMutation)((0,n("eSUdr").default)`mutation useUnreadCommentsForInlineCommentMarkInlineCommentsReadMutation($commentIds:[ID!]!){markCommentsAsRead(input:{commentIds:$commentIds}){success errors}}`),T=(0,a.useRef)([]);(0,a.useEffect)(()=>{(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")||(T.current=T.current.slice(0,(t?.replies?.length||0)+1))},[t]);let h=(0,a.useMemo)(()=>[t?.id,...t?.replies?.map(e=>e?.id)||[]].filter(e=>e&&_(e,u)).map((n,t)=>{var o;return{ref:(o=T.current)[t]||(o[t]=e(a).createRef()),id:n??""}}),[t,_,u]),v=r({refs:h,shouldSkip:0===C.size});return(0,a.useEffect)(()=>{if(!(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")&&t){let e=new Set;e.add(t.id),t.replies?.forEach(n=>{n&&e.add(n.id)});let n=new Set,o=c.filter(t=>{let o=e.has(t.id);return o&&n.add(t.id),!o});if(p(()=>o),f(n),n.size){let e=new Set([...u,...n]);E(()=>e),g({variables:{commentIds:[...n]}}),d(n)}}},[t]),(0,a.useEffect)(()=>{if(!(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")&&t){let e=new Set;v.size&&p(n=>n.filter(n=>!v.has(n.id)||(e.add(n.id),!1))),e.size}},[t,v]),(0,a.useEffect)(()=>{if(!(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")&&m&&t?.replies?.length){let e=t?.replies.slice(0,-1);e&&e.find(e=>e&&C.has(e.id))&&l(!1)}},[t?.replies,C,m,l]),(0,a.useEffect)(()=>{if(!(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")&&I===t?.location?.inlineMarkerRef&&!i&&C.size&&s){let[e]=C;(0,n("aHcFH").handleScrollToElement)({commentId:e,targetCommentId:e,isEditor:!!o,viewingRoomOffset:-300})}},[C,i,o,t?.location,I,s]),{unreadCommentRefs:h,currentUnreadIds:C,markCommentReadError:y}};var l=n("b3j2Y"),s=n("b8XTE"),d=n("hXzKU");let c=(0,n("7W8i8").getLogger)("annotation-provider-inline-comment"),u=e=>{let{reopenInlineCommentFn:t,getUpdateFn:o,commentId:a,annotationId:i,reopenParentComment:r,setOrderedActiveAnnotationIdList:m,orderedActiveAnnotationIdList:l,highlightReopenedComment:s,isEditor:d,eventEmitter:u,setActiveHighlight:p,experienceTracker:E}=e;return()=>t({variables:{commentId:a,resolved:!1},update:o?.(e=>{E.stopOnError({name:n("irVI7").UNRESOLVE_INLINE_COMMENT_EXPERIENCE,error:e})})}).then(()=>{if(r({threadKey:i,commentType:n("8i27m").CommentType.INLINE}),m([...l.map(e=>e.threadKey),i]),s(i),d)u.emit("unresolve",i),u.emit("setselectedannotation",i);else{let e=document.getElementById(i);u.emit(n("21K7m").AnnotationUpdateEvent.ON_ANNOTATION_CLICK,{annotationIds:[i],eventTarget:e}),p(i)}E.succeed({name:n("irVI7").UNRESOLVE_INLINE_COMMENT_EXPERIENCE})}).catch(e=>{c.error`An error occurred when reopening a comment ${e}`,E.stopOnError({name:n("irVI7").UNRESOLVE_INLINE_COMMENT_EXPERIENCE,error:e})})},p=({commentId:e,experienceTracker:t,flags:o,mode:a,annotationId:i,handleReopenComment:r,formatMessage:m,showCommentsPanel:l,setCurrentView:s,scrollCommentsPanelToThread:d,isCommentsPanelShown:c,setCurrentlySelectedThreadKey:u})=>{o?.showSuccessCircleFlag({id:e,title:m(n("9CnRS").i18n.resolvedFlagText),isAutoDismiss:!0,actions:[{content:m(n("9CnRS").i18n.goToCommentCTA),onClick:()=>{c?(s(n("3mVfX").ViewValues.RESOLVED),d?.({annotationId:i})):(u(i),l({openWithView:n("3mVfX").ViewValues.RESOLVED}),d?.({annotationId:i,annotationClicked:!0})),o.hideFlag(o.state.flags[0]?.id)}},{content:m(n("9CnRS").i18n.undoCTA),onClick:()=>{t.start({name:n("irVI7").UNRESOLVE_INLINE_COMMENT_EXPERIENCE,id:e,attributes:{mode:a,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,annotationId:i}}),r(),o.hideFlag(o.state.flags[0]?.id)}}]})};var E=n("auGhu"),I=n("kEmgx"),C=n("daq5m"),f=n("4Svbr"),_=n("5fMeR"),g=n("B3Avz");let y="annotation-provider-inline-comments/InlineComment",T=(0,n("eSUdr").default)`mutation InlineCommentResolveInlineCommentMutation($commentId:ID!$resolved:Boolean!){resolveInlineComment(commentId:$commentId resolved:$resolved dangling:false){status resolveProperties{resolved resolvedUser isDangling resolvedFriendlyDate resolvedTime}}}`,h=(0,n("eSUdr").default)`mutation InlineCommentDeleteInlineCommentMutation($commentIdToDelete:ID!$deleteFrom:CommentDeletionLocation){deleteComment(commentIdToDelete:$commentIdToDelete deleteFrom:$deleteFrom)}`,v=(0,n("eSUdr").default)`mutation InlineCommentDeleteInlineCommentMutationWithStepMutation($input:DeleteInlineCommentInput!){deleteInlineComment(input:$input)}`,N=(0,n("eSUdr").default)`mutation InlineCommentCreateInlineReplyMutation($input:ReplyInlineCommentInput!$pageId:ID!$includeReactions:Boolean!){replyInlineComment(input:$input){id body(representation:ATLAS_DOC_FORMAT){value}contentStatus createdAt{value}createdAtNonLocalized links{webui editui}location{type ...on InlineComment{inlineMarkerRef inlineText inlineResolveProperties{resolved isDangling resolvedFriendlyDate resolvedTime resolvedUser}}...on FooterComment{commentResolveProperties{resolved resolvedFriendlyDate resolvedTime resolvedUser}}}parentId permissions{isEditable isRemovable isResolvable}version{by{displayName}when number}author{displayName profilePicture{path}permissionType ...on KnownUser{accountId}}createdAt{value}createdAtNonLocalized reactionsSummary(pageId:$pageId contentType:"page" childType:"comment")@include(if:$includeReactions){ari containerAri reactionsCount reactionsSummaryForEmoji{id emojiId count reacted}}}}`,R=(0,n("cgtv4").defineMessages)({cannotDeleteTitle:{id:"annotation-provider-inline-comments.could.not.delete.title",defaultMessage:"Unable to delete comment"},commentLoadError:{id:"annotation-provider-inline-comments.error.comment.load.message",defaultMessage:"Something went wrong when loading this comment. Refresh to view the latest updates."},commentLoadNetworkError:{id:"annotation-provider-inline-comments.network.error.message",defaultMessage:"This comment wasn't loaded due to a network error. Check your connection and try again."},commentLoadErrorTitle:{id:"annotation-provider-inline-comments.error.comment.load.title",defaultMessage:"Unable to load comment"},commentReplyAriaLabel:{id:"annotation-provider-inline-comments.comment.reply.aria-label",defaultMessage:"Reply to {name}’s thread"},commentAriaLabel:{id:"annotation-provider-inline-comments.comment.aria-label",defaultMessage:"Comment by {displayName}, {timestamp}"}}),b=(0,n("7W8i8").getLogger)("annotation-provider-inline-comment"),S=(0,n("7aRa9").withFlags)(({annotation:t,onResolve:o,deleteOptions:r,onClose:c,isEditor:S,isArchived:w,onNavigationClick:A,onDelete:M,supportedTopLevelActions:L,getInlineNodeTypes:D,isOpeningMediaCommentFromToolbar:k,inlineCommentRef:P=()=>{},isInlineCommentVisible:F=!1,flags:O,isOffline:V})=>{let x,U=(0,n("9QIM2").usePageClass)(),K=(0,a.useRef)(void 0),{replyToCommentUser:G}=(0,n("3mVfX").useCommentsPanelState)(),{setCurrentView:j,setReplyToCommentId:$,setCurrentlySelectedThreadKey:X}=(0,n("3mVfX").useCommentsPanelActions)(),q=(0,n("aSsfA").useGetPageMode)(),[B]=(0,n("ep3mz").usePageContentId)(),z=(0,a.useContext)(n("1kHsc").ExperienceTrackerContext),{focusedCommentId:W,replyToCommentId:H,editCommentId:Q}=(0,n("liGyh").useInlineCommentQueryParams)(),Y=(0,n("7aw3q").useEmbeddedComments)(),J=S?n("a3q17").EDITOR_INLINE_COMMENT_RENDER_METRIC:n("a3q17").RENDERER_INLINE_COMMENT_RENDER_METRIC;if(K.current!==t.id){if(n("4EKKB").selectInlineCommentCompoundExperience.showComment.start({pageClass:U,annotationId:t.id,entryPoint:"unknown:InlineComment"}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")){J.start();let e={pageMode:q,pageClass:U,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,annotationId:t.id,isEditor:!!S,isArchived:!!w,isOpeningMediaCommentFromToolbar:!!k,isInlineCommentVisible:!!F,isOffline:!!V,...W&&{focusedCommentId:W},...H&&{replyToCommentId:H},...Q&&{editCommentId:Q}};(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_extend")?(n("4EKKB").selectInlineComment.debug(`InlineComment component mounted with annotation id ${t.id}`),z.updateAttributes({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,attributes:e})):z.start({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,timeout:n("aJPUt").ExperienceTimeout.VIEW_INLINE_COMMENT,attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),...e,entryPoint:y}}),"renderer"!==U&&"editor"!==U&&z.abort({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,reason:"Page class is not renderer or editor",checkForTimeout:!0,publishDebugPoints:!0,attributes:{stopPoint:y}})}K.current=t.id}let Z=(0,a.useRef)(null),ee=(0,a.useRef)(),en=(0,a.useRef)(null),et=(0,a.useRef)(null),[eo]=(0,a.useState)(()=>S?(0,n("gfqXk").getEditorAnnotationEventEmitter)():(0,n("gczDe").getRendererAnnotationEventEmitter)()),[ea,ei]=(0,a.useState)(!1),{addUnresolvedInlineComment:er,removeUnresolvedInlineComment:em}=(0,n("k8e76").useInlineCommentsActions)(),el=(0,n("3jwuS").useIsCurrentPageLive)(),{canAddComments:es}=(0,n("dANtQ").useAddCommentPermissionCheck)(B),{handleClose:ed,setEditorCreateProps:ec,setHoverProps:eu,setSelectionProps:ep,setStoredCommentData:eE,clearStoredCommentData:eI}=(0,n("cZa7r").useAnnotationsDispatch)(),{storedCommentData:eC}=(0,n("cZa7r").useAnnotations)(),{createAnalyticsEvent:ef}=(0,n("inPa6").useAnalyticsEvents)(),{userId:e_}=(0,n("bQm3c").useSessionData)(),{width:eg}=(0,n("hl0fg").useWindowSize)(),[ey,eT]=(0,a.useState)(""),[eh,ev]=(0,a.useState)(null),[eN,eR]=(0,a.useState)(!1),[eb,eS]=(0,a.useState)(!0),{onChange:ew,resetContentChanged:eA}=(0,n("bSvtO").useCommentsContentActions)(),{setActiveHighlight:eM}=(0,n("9jl6v").useInlineCommentsDispatchContext)(),{isCommentsPanelShown:eL,showCommentsPanel:eD}=(0,_.useShowCommentsPanel)(),ek=(0,a.useRef)(null),[eP,eF]=e(a).useState(),[eO,eV]=e(a).useState(!1),ex=(0,n("8C5kA").default)(),{formatMessage:eU}=ex,{isSticky:eK}=(0,n("3Xfi8").useShouldCommentSidebarBeSticky)({annotationElement:Z.current,isEditor:!!S}),eG=(0,n("eA7s6").useCommentSidebarOffset)({isEditor:S||!1,annotationElement:document.getElementById(t.id),isViewCommentMode:!0,windowWidth:eg,isSticky:eK}),ej=(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?n("g0DaR").updateApolloCacheCallbackForGA:n("g0DaR").updateApolloCacheCallback,e$=(0,a.useCallback)(()=>{ed(),eu(null),ep(null),ec(null)},[ed,eu,ep,ec]),eX=(0,a.useCallback)(e=>{let t=!1;return e.graphQLErrors?.length>0&&e.graphQLErrors.forEach(e=>{e.path?.includes("reactionsSummary")?n("4EKKB").selectInlineComment.debug("found reactionsSummary graphql error",{errorMessage:e.message}):t=!0}),!t&&!e.networkError},[]),eq=(0,a.useCallback)(t=>{if(n("4EKKB").selectInlineComment.debug("received a gql error",{errorMessage:t.message}),eX(t))return void n("4EKKB").selectInlineComment.debug("did not receive non-reactionsSummary errors, ignoring");-1!==t.message.search(/reactions/i)||-1!==t.message.search(/cc-pages/i)?(0,n("7Sm4c").markErrorAsHandled)(t):(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")||z.stopOnError({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,error:t});let o=(0,n("isdzP").parseError)(t),i=(0,n("isdzP").getTranslatedError)(o.message);i===n("9CnRS").i18n.unexpectedError?(O.showWarningFlag({title:e(a).createElement(n("gtD4K").default,R.commentLoadErrorTitle),description:e(a).createElement(n("gtD4K").default,R.commentLoadError)}),n("4EKKB").selectInlineCommentCompoundExperience.showComment.fail(t),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.stopOnError({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,error:t,attributes:{stopPoint:y}})):(O.showWarningFlag({title:e(a).createElement(n("gtD4K").default,R.commentLoadErrorTitle),description:e(a).createElement(n("gtD4K").default,(0,n("isdzP").isNetworkError)(i)?R.commentLoadNetworkError:i)}),n("4EKKB").selectInlineCommentCompoundExperience.showComment.abort({abortReason:o.message}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.abort({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,reason:o.message,checkForTimeout:!0,publishDebugPoints:!0,attributes:{stopPoint:y}}),(0,n("7Sm4c").markErrorAsHandled)(t)),n("4EKKB").selectInlineComment.debug("Closing create comment following a gql error"),e$()},[z,O,e$,eX]),[{readCommentsListState:eB,unreadCommentIDSet:ez}]=(0,n("fHAwL").useUnreadComments)(),eW=!!eC,eH=(0,n("lb2Lp").useCommentById)({markerRef:t.id,contentId:B,contentStatus:(0,n("kgNLQ").buildDefaultCommentsContentStatusFilters)(q),options:{skip:!(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)||eW,fetchPolicy:"cache-first"}}),{deleteCommentInCache:eQ}=(0,n("NYiei").useAllCommentsData)({contentId:B,options:{skip:!0}}),{data:eY,error:eJ}=(0,n("xQxzY").useQuery)((0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?n("1C8XP").ActiveInlineCommentsQuery:n("3B9cR").InlineCommentQuery,{variables:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?{pageId:B,inlineMarkerRefList:[t.id],contentStatus:[w?"ARCHIVED":"DRAFT","CURRENT"]}:{pageId:B,annotationId:t.id,contentStatus:[w?"ARCHIVED":"DRAFT","CURRENT"]},onError:void 0,fetchPolicy:"cache-and-network",skip:eW||(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),errorPolicy:"all"}),eZ=(0,a.useMemo)(()=>eH?.comment&&(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?{comments:{nodes:[eH.comment]}}:eW?{comments:{nodes:[eC]}}:eY,[eW,eC,eH?.comment,eY]),[e0]=(0,n("1KmJq").useMutation)(T),{updateCommentInCache:e1}=(0,n("jbF1h").useUpdateCommentInCache)(),{pageInfo:e9,error:e7}=(0,n("cAdj8").usePageInfo)();(0,a.useEffect)(()=>{e7&&(0,n("9wGTI").fg)("confluence_frontend_inline_comment_page_info_err")&&eq(e7)},[e7,eq]),(0,a.useEffect)(()=>{eJ&&eq(eJ)},[eJ,eq]),(0,a.useEffect)(()=>{ev(null),clearTimeout(ee.current),ee.current=void 0},[t]);let[e2]=(0,n("1KmJq").useMutation)(T),[e8]=(0,n("1KmJq").useMutation)(h),[e3]=(0,n("1KmJq").useMutation)(v),[e4]=(0,n("1KmJq").useMutation)(N),{createInlineReplyInterop:e6}=(0,n("cQCqE").useCreateInlineReplyMutation)({contentId:B}),e5=e9?.space?.id??"",ne=e9?.type??"",nn=e9?.operations||[],nt=nn.some(e=>e?.operation==="create"&&e?.targetType==="comment"),no=(0,n("9wGTI").fg)("confluence_comment_use_comment_media_endpoint")?nt:nn.some(e=>e?.operation==="update"&&e?.targetType===ne);eH?.comment&&(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?x=eH.comment:eW?x=eC:((0,n("9wGTI").fg)("confluence_frontend_content_wrapper"),x=eZ?.comments?.nodes?.[0]),(0,a.useEffect)(()=>{x&&F&&(z.succeed({name:n("irVI7").VIEW_PAGE_DIRECT_COMMENT_DATA_FLOW_EXPERIENCE,attributes:{annotationId:t.id,pageId:B,pageMode:S?n("cD1qu").PageMode.EDIT:n("cD1qu").PageMode.VIEW,isEditor:!!S}}),n("a3q17").DIRECT_COMMENT_DATA_FLOW_METRIC.stop())},[x,F,eC,t.id,B,S,z]);let na=(0,n("3iaSn").useGetCommentStatus)({resolveProperties:x?.location?.inlineResolveProperties||x?.location?.commentResolveProperties}),ni=x?.author?.accountId,nr=x?.author?.profilePicture?.path,nm=x?.author?.displayName??eU(n("3ejfs").commentsi18n.anonymous),nl=x?.id,ns=x?.createdAt?.value,nd=x?.createdAtNonLocalized,nc=x?.version?.when,nu=x?.version?.by?.displayName,np=(x?.version?.number||0)>1,nE=x?.permissions,nI=x?.body?.value,nC=x?.author?.permissionType,nf=x?.replies?.length||0,n_=1+nf,ng=x?.location?.inlineResolveProperties||void 0,ny=x?.location?.inlineResolveProperties?.resolvedTime,nT=x?.location?.inlineResolveProperties?.resolvedUser,nh=S&&!el?x?.links.editui:x?.links.webui,nv=x?.reactionsSummary??null,nN=eb&&nf&&nf>n("bEwJH").MAX_UNCOLLAPSED_REPIES,[{orderedActiveAnnotationIdList:nR},{addReplyToCommentThread:nb,handleRemovingComments:nS,deleteParentComment:nw,resolveParentComment:nA,reopenParentComment:nM,setOrderedActiveAnnotationIdList:nL,updateUnreadStatus:nD}]=(0,n("8i27m").useCommentsData)(),nk=(0,a.useCallback)(e=>{nD({inline:{[t.id]:e},general:{}},n("8i27m").UnreadAction.READ)},[nD,t.id]),{unreadCommentRefs:nP,currentUnreadIds:nF,markCommentReadError:nO}=m({commentData:x,isEditor:!!S,focusedCommentId:W??null,shouldCollapseReplies:!!nN,setIsReplyChainCollapsed:eS,isInlineCommentVisible:F,onUpdateUnreadStatus:nk});(0,a.useEffect)(()=>{(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")||(J.start(),z.start({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,id:t.id,attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),mode:q,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER}}))},[J,t,z,S,q]),(0,a.useEffect)(()=>{nl&&(ef({type:"sendTrackEvent",data:{action:"viewed",actionSubject:"inlineCommentsSidebar",objectType:"page",objectId:B,source:S?"editPageScreen":"viewPageScreen",attributes:{...(0,n("gtj7V").getCommentsDataManagerExperimentAttributes)(),mode:q,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,commentsDeckSize:nf+1,commentId:nl}}}).fire(),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")?n("4EKKB").selectInlineComment.debug(`Comment ID or page ID was updated. Comment ID: ${nl}, page ID: ${B}`):z.succeed({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE}))},[B,nl]),(0,a.useEffect)(()=>{Q&&(x?.replies?.map(e=>e?.id)?.includes(Q)&&eS(!1),eT(Q))},[Q,x]),(0,a.useEffect)(()=>{let e=x?.replies?.map(e=>e?.id)?.includes(H);ei(!!H&&(e||H===nl))},[H,nl,x]),(0,a.useEffect)(()=>{if(ea)if(x&&H===x.id)nx(x?.id,x);else{let e=x?.replies?.find(e=>e?.id===H);e&&e.parentId&&nx(e.parentId,e)}},[ea,x?.replies]),(0,a.useEffect)(()=>{W&&x?.replies?.map(e=>e?.id)?.includes(W)&&eS(!1)},[W,x]),(0,a.useEffect)(()=>{eZ&&e9&&(n("4EKKB").selectInlineComment.debug("Closing create comment as the view component is ready [!apollo_loading]"),e$(),eR(!0),n("4EKKB").selectInlineComment.debug("Data has loaded. Rendering inline comment sidebar... [apollo_loading]"))},[eZ,e9]),(0,a.useEffect)(()=>()=>{eR(!1),n("4EKKB").selectInlineComment.debug("Data changed, hiding comment",{...!!nl&&{commentId:nl},pageId:B,selectedAnnotationId:t.id,shouldRender:eN}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&n("4EKKB").selectInlineComment.debug(`Data has changed. Selected annotation ID: ${t?.id}, comment ID: ${nl}, page ID: ${B}, shouldRender: ${eN}. Hiding inline comment sidebar (if open)...`),eN&&(n("4EKKB").selectInlineCommentCompoundExperience.abort({abortReason:"Inline comment experience received a new experience while already running"}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.abort({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,reason:`Inline comment component has received new data and is hiding the inline comment sidebar. shouldRender: ${eN}`,checkForTimeout:!0,publishDebugPoints:!0,attributes:{stopPoint:y}}))},[nl,B,t]),(0,a.useEffect)(()=>{nl!==eh?.commentId&&(clearTimeout(ee.current),ee.current=void 0)},[nl,eh,ee]);let nV=(e="")=>{eT(e)};(0,a.useEffect)(()=>{let e=x?.location?.inlineMarkerRef;e&&eM(e)},[x,eM]);let nx=(e,t)=>{let o=t||x;ei(!0),$({parentCommentId:e,location:n("i6UMJ").LocationValue.STANDALONE,user:{displayName:o?.author?.displayName,accountId:o?.author?.accountId}})},nU=(0,a.useCallback)(e=>eQ({commentId:e,onError:t=>{(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:t,commentId:e})}}),[eQ,z]),nK=(0,a.useCallback)((o,i)=>{let m,l,s=!!o;if(s)l={variables:{commentIdToDelete:i,deleteFrom:n("8z9UY").CommentDeletionLocation.LIVE}};else{try{m=r?.deleteAnnotation(t)}catch(e){z.stopOnError({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:e});return}if(!m)return void z.stopOnError({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:Error(`Unable to remove annotation ${t.id} from document`)});l={variables:{input:{commentId:nl,step:(0,n("aMfLn").constructStepForGql)(m.step)}}}}let d=t?D(t.id):void 0,u=s?e8:e3,p=s?i:nl,E=s?ej("delete",{pageId:B,annotationId:t.id,contentStatus:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?["DRAFT","CURRENT"]:["CURRENT","DRAFT"]},o,i):void 0;u({...l,update:(0,n("kgNLQ").selectUpdateFunction)((0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),()=>nU(p),E)}).then(e=>{let{data:o}=e;if(!o||!s&&!o.deleteInlineComment)throw Error("No data returned from mutation");(0,n("8dA1U").handleDeleteSuccess)({commentId:s?i:nl,annotationId:t?.id,pageId:B,pageMode:q,isReply:s,source:n("en1dX").AnalyticsSource.STANDALONE,inlineNodeTypes:d,createAnalyticsEvent:ef,removeUnresolvedInlineComment:em,onSuccess:e=>{eC&&eI&&(s?i&&eE({...eC,replies:(eC.replies||[]).filter(e=>e?.id!==i)}):eI()),s?i&&nS({threadKey:e,commentId:i,action:n("8i27m").CommentActionType.DELETE_COMMENT,commentType:n("8i27m").CommentType.INLINE}):(m&&r?.onDeleteSuccess(m.doc,e),eA(),c&&c(),nw({threadKey:e,commentType:n("8i27m").CommentType.INLINE})),z.succeed({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE})}})}).catch(t=>{if((0,n("9wGTI").fg)("confluence_frontend_show_already_deleted_flag")){let o=(0,n("isdzP").parseError)(t),r=(0,n("isdzP").getTranslatedError)(o.message,s?i:nl);(0,n("isdzP").isAlreadyDeletedError)(r)&&(O.showWarningFlag({title:e(a).createElement(n("gtD4K").default,R.cannotDeleteTitle),description:e(a).createElement(n("gtD4K").default,r)}),ef({type:"sendOperationalEvent",data:{action:"alreadyDeleted",actionSubject:"comment",actionSubjectId:s?i:nl,objectType:"page",objectId:B,source:"viewPageScreen",attributes:{commentType:n("8i27m").CommentType.INLINE,mode:q,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,isReply:s}}}).fire())}(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:t,commentId:s?i:nl})})},[nl,ef,r,nU,z,eA,c,B,em,t,e8,e3,q,D,nS,nw,O]),nG=(0,a.useCallback)((o,i)=>{let r=!!o,m=(0,n("asNlu").getTargetNodeType)(t.id,!0),l=r?i:nl,s=r?ej("delete",{pageId:B,annotationId:t.id,contentStatus:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?["DRAFT","CURRENT"]:["CURRENT","DRAFT"]},o,i):void 0;e8({variables:{commentIdToDelete:r?i:nl,deleteFrom:el?n("8z9UY").CommentDeletionLocation.LIVE:n("8z9UY").CommentDeletionLocation.EDITOR},update:(0,n("kgNLQ").selectUpdateFunction)((0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),()=>nU(l),s)}).then(({data:e})=>{if(!e||!r&&!e.deleteComment)throw Error("No data returned from mutation");eC&&(r?i&&eE({...eC,replies:(eC.replies||[]).filter(e=>e?.id!==i)}):eI()),ef({type:"sendTrackEvent",data:{action:"deleted",actionSubject:"comment",actionSubjectId:r?i:nl,objectType:"page",objectId:B,source:"editPageScreen",attributes:{commentType:n("8i27m").CommentType.INLINE,source:n("en1dX").AnalyticsSource.STANDALONE,pageMode:q,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,inlineNodeTypes:t?D(t.id):void 0,isReply:r,targetNodeType:m}}}).fire(),z.succeed({name:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE}),r?i&&nS({threadKey:t.id,commentId:i,action:n("8i27m").CommentActionType.DELETE_COMMENT,commentType:n("8i27m").CommentType.INLINE}):(M?.(t?.id),em(t?.id),eA(),nw({threadKey:t.id,commentType:n("8i27m").CommentType.INLINE}))}).catch(t=>{if((0,n("9wGTI").fg)("confluence_frontend_show_already_deleted_flag")){let o=(0,n("isdzP").parseError)(t),m=(0,n("isdzP").getTranslatedError)(o.message,r?i:nl);(0,n("isdzP").isAlreadyDeletedError)(m)&&(O.showWarningFlag({id:nl,title:e(a).createElement(n("gtD4K").default,R.cannotDeleteTitle),description:e(a).createElement(n("gtD4K").default,m)}),ef({type:"sendOperationalEvent",data:{action:"alreadyDeleted",actionSubject:"comment",actionSubjectId:r?i:nl,objectType:"page",objectId:B,source:"editPageScreen",attributes:{commentType:n("8i27m").CommentType.INLINE,mode:q,framework:n("24amZ").InlineCommentFramework.ANNOTATION_PROVIDER,isReply:r}}}).fire())}(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").DELETE_INLINE_COMMENT_EXPERIENCE,error:t,commentId:r?i:nl})})},[nl,ef,e8,nU,z,q,B,M,t,D,eA,el,em,nS,O]),nj=(0,a.useCallback)((e,n)=>{S?nG(e,n):nK(e,n)},[S,nK,nG]),n$=(0,a.useCallback)(e=>{(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").RESOLVE_INLINE_COMMENT_EXPERIENCE,error:e})},[z]),nX=(0,a.useCallback)((e,t)=>e1({mutationResult:t,commentId:nl,updateCallback:n("kgNLQ").resolveInlineCommentInCacheCallback,onError:n$}),[e1,nl,n$]),nq=(0,a.useCallback)(e=>(t,o)=>e1({mutationResult:o,commentId:nl,updateCallback:n("kgNLQ").resolveInlineCommentInCacheCallback,onError:e}),[e1,nl]),nB=()=>{let e={variables:{commentId:nl,resolved:!0}};(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)&&(e.update=nX),e2(e).then(()=>{let e=t.id;o(e),(0,n("8dA1U").handleResolveSuccess)({commentId:nl,parentCommentMarkerRef:e,pageId:B,pageMode:q,eventEmitter:eo,source:n("en1dX").AnalyticsSource.STANDALONE,removeUnresolvedInlineComment:em,createAnalyticsEvent:ef,getInlineNodeTypes:D,commentType:n("8i27m").CommentType.INLINE}),nA({threadKey:e,commentType:n("8i27m").CommentType.INLINE}),nL(nR.map(e=>e.threadKey).filter(n=>n!==e)),z.succeed({name:n("irVI7").RESOLVE_INLINE_COMMENT_EXPERIENCE}),S?nJ():c&&c(),Y&&p({commentId:nl??"",experienceTracker:z,flags:O,mode:q,annotationId:e,formatMessage:eU,showCommentsPanel:eD,setCurrentView:j,isCommentsPanelShown:eL,handleReopenComment:u({reopenInlineCommentFn:e0,getUpdateFn:(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1)?nq:void 0,commentId:nl??"",annotationId:e,reopenParentComment:nM,setOrderedActiveAnnotationIdList:nL,orderedActiveAnnotationIdList:nR,highlightReopenedComment:nZ,isEditor:S??!1,eventEmitter:eo,setActiveHighlight:eM,experienceTracker:z}),setCurrentlySelectedThreadKey:X}),S||(nl&&ev({commentId:nl,inlineMarkerRef:e}),eh?.commentId===x?.id&&(ee.current=setTimeout(()=>{c&&c()},7500)))}).catch(e=>{n$(e)})},nz=(0,a.useCallback)(e=>(0,n("8dA1U").handleMutationFailure)({experienceTracker:z,experienceName:n("irVI7").REPLY_TO_INLINE_COMMENT_PUBLISH_EXPERIENCE,error:e,commentId:nl,shouldReturnError:!0,shouldAbortForExpectedError:!0,compoundExperienceName:n("irVI7").REPLY_TO_INLINE_COMMENT_EXPERIENCE}),[z,nl]),nW=async(e,o)=>{let a=nl??"",i={input:{containerId:B,parentCommentId:a,commentBody:{value:JSON.stringify(e),representationFormat:"ATLAS_DOC_FORMAT"},createdFrom:el?n("afGoD").CommentCreationLocation.LIVE:S?n("afGoD").CommentCreationLocation.EDITOR:n("afGoD").CommentCreationLocation.RENDERER},pageId:B,includeReactions:!1},r={annotationId:t?.id,pageId:B,contentStatus:["DRAFT","CURRENT"]};return(0,n("8Ss4E").startEditorSubExperience)({name:n("irVI7").REPLY_TO_INLINE_COMMENT_PUBLISH_EXPERIENCE,attributes:{parentCommentId:a}}),e6({originalMutationFn:e4,options:{variables:i,update:ej("create",r,a)},onCacheUpdateError:nz}).then(({data:e})=>{let a=e.replyInlineComment;a?.reactionsSummary||(a.reactionsSummary=n("g0DaR").defaultReactionsSummary);let i={...a,isUnread:!1};eC&&eE&&eE({...eC,replies:[...eC.replies||[],a]}),nb(t.id,i,n("8i27m").CommentType.INLINE),G&&$(),(0,n("g0DaR").handleCreateReplySuccess)({onSuccess:o,editCommentQueryId:Q,setCommentForEdit:eT,data:e,createAnalyticsEvent:ef,pageId:B,pageType:ne,analyticsSource:n("en1dX").AnalyticsSource.STANDALONE,commentId:nl,pageMode:q,selectedAnnotation:t,getInlineNodeTypes:void 0,experienceTracker:z,isEditor:!!S})}).catch(e=>nz(e))},nH=(0,a.useCallback)((e,o,a,i,r)=>{let m={pageId:i,annotationId:t?.id,contentStatus:[w?"ARCHIVED":"DRAFT","CURRENT"]};try{let t,i,l=r?.readQuery({query:n("3B9cR").InlineCommentQuery,variables:m});if(!l?.comments?.nodes?.[0])return;let s=l.comments.nodes[0];if(s.id===a?t=s.reactionsSummary?{...s.reactionsSummary}:n("g0DaR").defaultReactionsSummary:(i=s.replies.find(e=>e?.id===a))&&(t=i.reactionsSummary?{...i.reactionsSummary}:n("g0DaR").defaultReactionsSummary),!t)return;let d=t.ari||"",c=t.containerAri||"",u=t.reactionsCount||0,p={...t},E=[...t.reactionsSummaryForEmoji||[]];if("add"===o){let n=E.find(n=>n?.emojiId===e);if(n&&!n.reacted)n.count++,n.reacted=!0;else{let n={emojiId:e,count:1,reacted:!0,id:`${c}|${d}|${e}`,__typename:"ReactionsSummaryForEmoji"};E.push(n)}++u}else if("delete"===o){let n=E.findIndex(n=>n?.emojiId===e);if(-1!==n){let e=E[n];e&&e.count>1?(e.count--,e.reacted=!1):E.splice(n,1),--u}}p.reactionsSummaryForEmoji=E,p.reactionsCount=u??0;let I={...s,replies:s.replies.map(e=>e?.id===a?{...e,reactionsSummary:p}:e)};s.id===a&&(I.reactionsSummary=p),r?.writeQuery({query:n("3B9cR").InlineCommentQuery,variables:m,data:{comments:{nodes:[I],__typename:"PaginatedCommentList"}}})}catch(e){b.error`An error occurred when updating reactions cache for ${o} - ${e}`}},[t,w]),nQ=(0,a.useCallback)((e,o,a,i,r)=>{if((0,n("9wGTI").fg)("confluence_frontend_content_wrapper")){if((0,n("g0DaR").updateReactionsCacheCallbackForGA)(e,o,a,B,t,w??!1,r),eC&&eE){let n={...eC};if(eC.id===a){let t=[...eC.reactionsSummary?.reactionsSummaryForEmoji||[]],a=eC.reactionsSummary?.reactionsCount||0;if("add"===o){let n=t.find(n=>n?.emojiId===e);n&&!n.reacted?(n.count++,n.reacted=!0):n||t.push({emojiId:e,count:1,reacted:!0,id:`${eC.reactionsSummary?.containerAri}|${eC.reactionsSummary?.ari}|${e}`,__typename:"ReactionsSummaryForEmoji"}),a++}else if("delete"===o){let n=t.findIndex(n=>n?.emojiId===e);if(-1!==n){let e=t[n];e&&e.count>1?(e.count--,e.reacted=!1):t.splice(n,1),a--}}n.reactionsSummary={...eC.reactionsSummary,reactionsSummaryForEmoji:t,reactionsCount:a,ari:eC.reactionsSummary?.ari||""}}else n.replies=(eC.replies||[]).map(n=>{if(n?.id===a){let t=[...n.reactionsSummary?.reactionsSummaryForEmoji||[]],a=n.reactionsSummary?.reactionsCount||0;if("add"===o){let o=t.find(n=>n?.emojiId===e);o&&!o.reacted?(o.count++,o.reacted=!0):o||t.push({emojiId:e,count:1,reacted:!0,id:`${n.reactionsSummary?.containerAri}|${n.reactionsSummary?.ari}|${e}`,__typename:"ReactionsSummaryForEmoji"}),a++}else if("delete"===o){let n=t.findIndex(n=>n?.emojiId===e);if(-1!==n){let e=t[n];e&&e.count>1?(e.count--,e.reacted=!1):t.splice(n,1),a--}}return{...n,reactionsSummary:{...n.reactionsSummary,reactionsSummaryForEmoji:t,reactionsCount:a,ari:n.reactionsSummary?.ari||""}}}return n});eE(n)}}else nH(e,o,a,i,r)},[B,t,w,nH,eC,eE]),nY=(0,a.useCallback)(o=>{let i=eZ?.comments?.nodes?.[0]?.replies||[];return(o?i.slice(-1):i).map(o=>{if(!o)return e(a).createElement(e(a).Fragment,null);let{id:i,permissions:r,body:m,reactionsSummary:l,createdAtNonLocalized:s}=o,d=nP.find(e=>e.id===i)?.ref;return i===ey?e(a).createElement(E.EditComment,{key:i,commentId:i,annotationId:t.id,displayName:o.author?.displayName??eU(n("3ejfs").commentsi18n.anonymous),avatarUrl:o.author?.profilePicture?.path??"",pageId:B,pageType:ne,spaceId:e5,content:m?.value,displayCommentInViewMode:nV,mode:S?"edit":"view",isReply:!0,hasMediaUploadPermissions:no,getInlineNodeTypes:D,commentType:n("8i27m").CommentType.INLINE,date:o.version?.when??"",versionDate:o.version?.when??"",hasParentMaxHeight:eO}):e(a).createElement(I.CommentBody,{key:i,userId:o.author?.accountId??"",displayName:o.author?.displayName,avatarUrl:o.author?.profilePicture?.path,date:o.version?.when??"",dateUrl:S&&!el?o.links.editui??void 0:o.links.webui??void 0,createdAt:o.createdAt?.value??"",createdAtNonLocalized:s??"",versionDate:o.version?.when??"",versionByDisplayName:o.version?.by?.displayName,commentId:i,pageId:B,pageType:ne,isReply:!0,isEdited:(o.version?.number||0)>1,parentCommentId:o.parentId,permissions:r,editComment:()=>nV(i),deleteComment:()=>nj(o.parentId,i),content:o.body?.value,isCommentActive:!0,mode:S?"edit":"view",permissionType:o.author?.permissionType??void 0,supportedActions:["edit","delete","resolve"],isFocused:W===i,isUnread:(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")?ez.has(i):nF.has(i),onRendered:()=>{if((0,n("9wGTI").fg)("confluence-fe-comments-deep-link-behavior"))return;let e=W||H;eG>0&&e&&(0,n("aHcFH").handleScrollToElement)({commentId:i,targetCommentId:e,isEditor:!!S,useInstantScroll:!0})},unreadCommentRef:d,commentType:n("8i27m").CommentType.INLINE,inheritedReactionsData:l,reactionsCacheUpdateFn:nQ,canAddComments:es,isOffline:V,isFabricPage:!0})})},[eZ,ey,ne,B,e5,t,S,W,H,nj,el,eG,nF,nP,no,D,nQ,V,es,eU,ez,eO]),nJ=(0,a.useCallback)(()=>{let e=""===ey;z.abort({name:e?n("irVI7").REPLY_TO_INLINE_COMMENT_EXPERIENCE:n("irVI7").EDIT_INLINE_COMMENT_EXPERIENCE,reason:"comment discarded by user"}),(0,n("aGjYc").clearCommentDraft)(S?"edit-inline":"inline",e?"reply":"edit"),eS(!0),ei(!1),c&&c(),eM(null)},[z,ey,S,c,eM]),nZ=(0,a.useCallback)(e=>{eo.emit(n("21K7m").AnnotationUpdateEvent.SET_ANNOTATION_STATE,{[e]:{id:e,annotationType:n("cUycv").AnnotationTypes.INLINE_COMMENT,state:n("cUycv").AnnotationMarkStates.ACTIVE}}),er(e,q)},[er,eo,q]),n0=(0,a.useMemo)(()=>({disableCommentCount:eh?.commentId===x?.id||(0,n("9wGTI").fg)("confluence-frontend-comments-panel"),commentData:x,onNavigationClick:A}),[eh,x,A]);(0,a.useEffect)(()=>{if(!t.id)return;if(!1===eN)return void n("4EKKB").selectInlineComment.debug(`InlineComment has been rendered, but is returning null due to shouldRender. Selected annotation ID: ${t?.id}`);let o=z.getExperienceState(n("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE)?.taskId,i=!1,r=setTimeout(()=>{i&&(0,n("9wGTI").fg)("confluence_frontend_view_inline_is_cancelled")||requestAnimationFrame(()=>{if(i&&(0,n("9wGTI").fg)("confluence_frontend_view_inline_is_cancelled"))return;let r=z.getExperienceState(n("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE)?.taskId;if(!r)return void n("4EKKB").selectInlineComment.debug("No current task ID");if(o!==r){(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.attachDebugPoint({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,message:`Experience has been restarted or has otherwise ended. initialTaskId: ${o}, currentTaskId: ${r}`});return}if(K.current!==t.id)return void n("4EKKB").selectInlineComment.debug(`View inline comment assumed aborted due to selection change. lastSelected.current: ${K?.current}, selectedAnnotation.id: ${t?.id}`);if(!Z.current){n("4EKKB").selectInlineComment.debug("Show inline comment assumed aborted by deselection or selection change. This message indicate an abort failed and something has gone wrong."),n("4EKKB").selectInlineCommentCompoundExperience.abort({abortReason:"No annotation element found for the inline comment ui to attach to."}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.abort({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,reason:"No annotation element found for the inline comment component to attach to.",checkForTimeout:!0,publishDebugPoints:!0,attributes:{stopPoint:y}}),(0,n("9wGTI").fg)("confluence_frontend_null_annotation_flag")&&O.showWarningFlag({title:e(a).createElement(n("gtD4K").default,R.commentLoadErrorTitle),description:e(a).createElement(n("gtD4K").default,R.commentLoadError)});return}if(!en.current){n("4EKKB").selectInlineCommentCompoundExperience.showComment.fail(Error("Document missing inline comment ui")),eN&&(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.fail({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,error:Error("Document is missing inline comment sidebar element"),attributes:{stopPoint:y}});return}let m=Math.abs(Z.current.getBoundingClientRect().top-en.current.getBoundingClientRect?.().top);if(m>40)if(en.current.checkVisibility())n("4EKKB").selectInlineComment.debug("View Inline Comment UI too far from annotation",{misalignedBy:m});else{n("4EKKB").selectInlineCommentCompoundExperience.showComment.fail(Error("View Created Comment UI too far from annotation"),{misalignedBy:m}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.fail({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,error:Error("View inline comment sidebar was rendered too far from annotation"),attributes:{misalignedBy:m,stopPoint:y}});return}(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.succeed({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,publishDebugPoints:!0,attributes:{stopPoint:y}}),n("4EKKB").selectInlineCommentCompoundExperience.showComment.complete("Inline Comment panel comment shown")})},10);return()=>{i=!0,clearTimeout(r),eR(!1);let e=z.getExperienceState(n("irVI7").SELECT_INLINE_COMMENT_EXPERIENCE)?.taskId;e&&o===e&&(n("4EKKB").selectInlineCommentCompoundExperience.showComment.abort({abortReason:"InlineComment component unmounted"}),(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.abort({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,reason:"Inline comment component unmounted",checkForTimeout:!0,publishDebugPoints:!0,attributes:{stopPoint:y}}))}},[t.id,eN,ef,z,O]);let[n1,n9]=(0,a.useState)(!1),[n7,n2]=(0,a.useState)(void 0),[n8,n3]=(0,a.useState)(!1),n4=(0,a.useCallback)(e=>{(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&(n9(!0),e&&n2(e))},[]),n6=(0,a.useCallback)(()=>{(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&(n9(!1),n2(void 0))},[]),n5=(0,a.useCallback)(e=>{n3(!0),e.stopPropagation()},[n3]),te=(0,a.useCallback)(e=>{e.relatedTarget&&e.currentTarget.contains(e.relatedTarget)||n3(!1)},[n3]);if(!eN)return null;if(Z.current=document.getElementById(t.id),!Z.current)return(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&n("4EKKB").selectInlineComment.debug("There is no annotation element element, so not rendering InlineComment"),null;let tn=ni===e_;return e(a).createElement(g.CommentSidebar,{nudgeRef:ek,pageId:B,annotationElement:Z.current,navigationOptions:n0,onClose:S?nJ:()=>{c&&c(),eM(null)},isEditor:S,isViewCommentMode:!0,sidebarOffset:eG,commentId:nl,isOpeningMediaCommentFromToolbar:k,sidebarEl:en,annotationId:t?.id,inlineCommentRef:P,...(0,n("9wGTI").fg)("confluence-fe-comment-temp-max-height-fix")?{setPopupsScrollableElement:eF}:{},isSticky:eK,isFabricPage:!0,authorName:nm,onMaxHeightApplied:eV},nO&&e(a).createElement(l.ErrorDisplay,{error:nO}),e(a).createElement(a.Fragment,null,e(a).createElement(n("6f0Oj").default,{testId:"inline-comment-container",onMouseEnter:()=>n4(nl),onMouseLeave:n6,onBlur:te,onFocus:n5,tabIndex:0,"aria-label":eU(R.commentAriaLabel,{displayName:nm,timestamp:(0,n("6faGq").formatTimestampForAriaLabel)({intl:ex,dateString:x?.createdAtNonLocalized,commentStatus:na,resolveProperties:x?.location?.inlineResolveProperties||x?.location?.commentResolveProperties})})},(()=>{let o=nP.find(e=>e.id===nl)?.ref;return nl===ey?e(a).createElement(E.EditComment,{pageId:B,date:nc??"",createdAtNonLocalized:nd??"",pageType:ne,annotationId:t.id,commentId:nl,spaceId:e5,content:nI??"",isReply:!1,displayCommentInViewMode:nV,avatarUrl:nr??"",displayName:nm,dateUrl:nh??"",versionDate:nc??"",isEdited:np,resolveProperties:ng,mode:S?"edit":"view",hasMediaUploadPermissions:no,getInlineNodeTypes:D,commentType:n("8i27m").CommentType.INLINE,isStandaloneComment:!0,hasParentMaxHeight:eO}):e(a).createElement(a.Fragment,null,e(a).createElement(I.CommentBody,{userId:ni,avatarUrl:nr,displayName:nm,date:nc??"",dateUrl:nh??"",createdAt:ns??"",createdAtNonLocalized:nd??"",versionDate:nc??"",versionByDisplayName:nu,pageId:B,pageType:ne,commentId:nl??"",isReply:!1,isEdited:np,permissions:nE,deleteComment:()=>{if(el||!S)return nj(void 0)},editComment:()=>nV(nl),content:nI??"",isCommentActive:!0,mode:S?"edit":"view",onClose:c,permissionType:nC??void 0,resolveComment:nB,supportedActions:L,isUnread:(0,n("9wGTI").fg)("confluence_frontend_unread_comments_fixes")?ez.has(nl??""):nF.has(nl??""),numReplies:nf,unreadCommentRef:o,commentType:n("8i27m").CommentType.INLINE,inheritedReactionsData:nv,reactionsCacheUpdateFn:nQ,isStandalonehovered:n1,isHovered:n7===nl||n8&&(0,n("9wGTI").fg)("confluence_comments_hover_state_on_focused_comment"),replyToComment:nx,hideBranchingStyle:!x?.replies||x?.replies?.length===0,resolveProperties:ng,isStandaloneComment:!0,canAddComments:es,isOffline:V,isFabricPage:!0,onRendered:()=>{(0,n("9wGTI").fg)("confluence_frontend_view_inline_comment_exp_parity")&&z.attachDebugPoint({name:n("irVI7").VIEW_INLINE_COMMENT_EXPERIENCE,message:"Inline comment body rendered"})}}),!(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&e(a).createElement(n("c7FK0").ReopenedMessage,{resolvedUser:nT??void 0,resolvedTime:ny}),e(a).createElement(s.PageSegmentLoadEnd,{key:`stop-${nl}`,metric:J}))})()),!(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&x?.replies?.length>0&&e(a).createElement(n("666Tc").ReplyListContainer,{"data-testid":"inline-comment-reply-container"},nN&&e(a).createElement(n("8wupW").CollapsedReplies,{numCollapsedReplies:nf-1,onClick:()=>eS(!1)}),nY(!!nN)),x?.replies?.length>0&&(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&e(a).createElement(f.CommentReplies,{parentComment:(0,n("3ZsvI").normalizeCommentData)({comment:x,readCommentsListState:eB,currentUserId:e_??"",pageMode:q,isOpen:!0,type:n("8i27m").CommentType.INLINE}),pageInfo:e9,pageMode:q,parentCommentId:x.id,handleMouseEnter:n4,handleMouseLeave:n6,canAddComments:es,isCurrentSelectedComment:!1,hoveredCommentId:n7??"",isStandaloneComment:!0,editCommentQueryId:Q,selectedAnnotation:t,key:`standalone-comment-replies-${x.id}`,deleteStandaloneComment:nj,replyToComment:nx,updateReactionsCacheFn:nQ,...eP&&(0,n("9wGTI").fg)("confluence-fe-comment-temp-max-height-fix")?{popupsScrollableElement:eP,popupsMountPoint:document.getElementById("editor-comments-sidebar")||document.body}:{},onRendered:()=>{if((0,n("9wGTI").fg)("confluence-fe-comments-deep-link-behavior"))return;let e=W||H;eG>0&&e&&x?.id&&(0,n("aHcFH").handleScrollToElement)({commentId:x.id,targetCommentId:e,isEditor:!!S,useInstantScroll:!0})},hasParentMaxHeight:eO}),!w&&es&&e(a).createElement(n("666Tc").NewReplyContainer,{mode:S?"edit":"view","data-cy":"editor-reply-container","data-testid":"inline-comment-new-reply-container",ref:et,isFabricPage:!0},!(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")&&e(a).createElement(C.CommentAuthor,{commentMode:"reply",userId:e_,size:"small",permissionType:nC??void 0}),e(a).createElement(d.LazyCommentEditor,{pageId:B,pageType:ne,onCancelComment:()=>{$(),ei(!1)},content:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper")?(0,n("7qvmT").getAdfForQuickReplyMention)(G):void 0,appearance:"chromeless",EditorComponent:i.ChromelessEditor,onSaveComment:nW,onContentChange:ew,onEditorReady:()=>{z.succeed({name:n("irVI7").REPLY_TO_INLINE_COMMENT_LOAD_EXPERIENCE})},commentMode:"reply",commentType:S?"edit-inline":"inline",spaceId:e5,showCancelButton:!0,useNewWarningModal:!0,hideWatchCheckbox:!0,expandEditor:ea,pageMode:S?"edit":"view",hasMediaUploadPermissions:no,topLevelCommentId:nl,shouldWarnOnInternalNavigation:!0,commentContainerElementRef:et,isStandaloneComment:(0,n("9wGTI").fg)("confluence_frontend_content_wrapper"),hasParentMaxHeight:eO,key:`comment-editor-${nl}`,...eP&&(0,n("9wGTI").fg)("confluence-fe-comment-temp-max-height-fix")?{popupsScrollableElement:eP,popupsMountPoint:document.getElementById("editor-comments-sidebar")||document.body}:{},isOffline:V,customAriaLabel:(0,n("6mKj3").expVal)("confluence_frontend_comments_a11y_kb_exp","isEnabled",!1)?eU(R.commentReplyAriaLabel,{name:nm}):void 0}))),tn&&1===n_&&e(a).createElement(n("g1WP0").AsyncWrapper,{trigger:"inline-comments",showImage:!1,width:280,reference:ek}))});t.exports.InlineComment=S}),t("8wupW",function(t,o){var a=n("3u0dr"),i=n("frIzR"),r=n("42omo");let m=(0,r.forwardRef)((0,a.isReactCompilerActiveV1)()?(t,o)=>{let a,m,l,s,d,c,u=(0,i.c)(13);if(u[0]!==o||u[1]!==t){let{as:e,style:i,...r}=t;a=void 0===e?"div":e,m=r,l=i,s=o,d=(0,n("gMc0m").default)(["_x3doia51 _y3gn1h6o _4t3i1pa9",r.className]),u[0]=o,u[1]=t,u[2]=a,u[3]=m,u[4]=l,u[5]=s,u[6]=d}else a=u[2],m=u[3],l=u[4],s=u[5],d=u[6];return u[7]!==a||u[8]!==m||u[9]!==l||u[10]!==s||u[11]!==d?(c=e(r).createElement(a,{...m,style:l,ref:s,className:d}),u[7]=a,u[8]=m,u[9]=l,u[10]=s,u[11]=d,u[12]=c):c=u[12],c}:({as:t="div",style:o,...a},i)=>e(r).createElement(t,{...a,style:o,ref:i,className:(0,n("gMc0m").default)(["_x3doia51 _y3gn1h6o _4t3i1pa9",a.className])})),l=(0,r.forwardRef)((0,a.isReactCompilerActiveV1)()?(t,o)=>{let a,m,l,s,d,c,u=(0,i.c)(13);if(u[0]!==o||u[1]!==t){let{as:e,style:i,...r}=t;a=void 0===e?"div":e,m=r,l=i,s=o,d=(0,n("gMc0m").default)(["_n7zlia51 _4t3irdoj",r.className]),u[0]=o,u[1]=t,u[2]=a,u[3]=m,u[4]=l,u[5]=s,u[6]=d}else a=u[2],m=u[3],l=u[4],s=u[5],d=u[6];return u[7]!==a||u[8]!==m||u[9]!==l||u[10]!==s||u[11]!==d?(c=e(r).createElement(a,{...m,style:l,ref:s,className:d}),u[7]=a,u[8]=m,u[9]=l,u[10]=s,u[11]=d,u[12]=c):c=u[12],c}:({as:t="div",style:o,...a},i)=>e(r).createElement(t,{...a,style:o,ref:i,className:(0,n("gMc0m").default)(["_n7zlia51 _4t3irdoj",a.className])})),s=(0,r.forwardRef)((0,a.isReactCompilerActiveV1)()?(t,o)=>{let a,m,l,s,d,c,u=(0,i.c)(13);if(u[0]!==o||u[1]!==t){let{as:e,style:i,...r}=t;a=void 0===e?"div":e,m=r,l=i,s=o,d=(0,n("gMc0m").default)(["_kqswh2mm _1lry1n0e _t41qmgjw _1r33tlke _1plvvuon _1c5th2mm",r.className]),u[0]=o,u[1]=t,u[2]=a,u[3]=m,u[4]=l,u[5]=s,u[6]=d}else a=u[2],m=u[3],l=u[4],s=u[5],d=u[6];return u[7]!==a||u[8]!==m||u[9]!==l||u[10]!==s||u[11]!==d?(c=e(r).createElement(a,{...m,style:l,ref:s,className:d}),u[7]=a,u[8]=m,u[9]=l,u[10]=s,u[11]=d,u[12]=c):c=u[12],c}:({as:t="div",style:o,...a},i)=>e(r).createElement(t,{...a,style:o,ref:i,className:(0,n("gMc0m").default)(["_kqswh2mm _1lry1n0e _t41qmgjw _1r33tlke _1plvvuon _1c5th2mm",a.className])})),d=(0,a.isReactCompilerActiveV1)()?t=>{let o,a,d,c,u,p=(0,i.c)(9),{numCollapsedReplies:E,onClick:I}=t;p[0]!==E?(o={...n("9CnRS").i18n.collapsedRepliesMore,values:{numCollapsedReplies:E}},p[0]=E,p[1]=o):o=p[1];let C=o;return p[2]===Symbol.for("react.memo_cache_sentinel")?(a=e(r).createElement(l,null),d=e(r).createElement(l,null),p[2]=a,p[3]=d):(a=p[2],d=p[3]),p[4]!==C?(c=e(r).createElement(n("gtD4K").default,C),p[4]=C,p[5]=c):c=p[5],p[6]!==I||p[7]!==c?(u=e(r).createElement(m,null,a,d,e(r).createElement(s,{"data-testid":"collapsed-inline-replies",onClick:I},c)),p[6]=I,p[7]=c,p[8]=u):u=p[8],u}:({numCollapsedReplies:t,onClick:o})=>{let a={...n("9CnRS").i18n.collapsedRepliesMore,values:{numCollapsedReplies:t}};return e(r).createElement(m,null,e(r).createElement(l,null),e(r).createElement(l,null),e(r).createElement(s,{"data-testid":"collapsed-inline-replies",onClick:o},e(r).createElement(n("gtD4K").default,a)))};t.exports.CollapsedReplies=d}),t("c7FK0",function(t,o){var a=n("3u0dr"),i=n("frIzR"),r=n("42omo");let m=(0,r.forwardRef)((0,a.isReactCompilerActiveV1)()?(t,o)=>{let a,m,l,s,d,c,u=(0,i.c)(13);if(u[0]!==o||u[1]!==t){let{as:e,style:i,...r}=t;a=void 0===e?"div":e,m=r,l=i,s=o,d=(0,n("gMc0m").default)(["_1yt412zh _11c81o8v _x3doia51",r.className]),u[0]=o,u[1]=t,u[2]=a,u[3]=m,u[4]=l,u[5]=s,u[6]=d}else a=u[2],m=u[3],l=u[4],s=u[5],d=u[6];return u[7]!==a||u[8]!==m||u[9]!==l||u[10]!==s||u[11]!==d?(c=e(r).createElement(a,{...m,style:l,ref:s,className:d}),u[7]=a,u[8]=m,u[9]=l,u[10]=s,u[11]=d,u[12]=c):c=u[12],c}:({as:t="div",style:o,...a},i)=>e(r).createElement(t,{...a,style:o,ref:i,className:(0,n("gMc0m").default)(["_1yt412zh _11c81o8v _x3doia51",a.className])})),l=(0,a.isReactCompilerActiveV1)()?t=>{let o,a=(0,i.c)(3),{resolvedUser:l,resolvedTime:s}=t;return a[0]!==s||a[1]!==l?(o=l&&s?e(r).createElement(m,null,e(r).createElement(n("gtD4K").default,{id:"inline-comments-common.reopened.message",defaultMessage:"Reopened by {person}",values:{person:l}})," ",e(r).createElement(n("1YXTQ").TimeAgo,{date:s})):null,a[0]=s,a[1]=l,a[2]=o):o=a[2],o}:({resolvedUser:t,resolvedTime:o})=>t&&o?e(r).createElement(m,null,e(r).createElement(n("gtD4K").default,{id:"inline-comments-common.reopened.message",defaultMessage:"Reopened by {person}",values:{person:t}})," ",e(r).createElement(n("1YXTQ").TimeAgo,{date:o})):null;t.exports.ReopenedMessage=l}),t("cQCqE",function(e,t){var o=n("42omo");let a=n("310ZR").default;e.exports.useCreateInlineReplyMutation=({contentId:e})=>{let{addCommentInCache:t}=(0,n("NYiei").useAllCommentsData)({contentId:e,options:{skip:!0}}),[i]=(0,n("308Wd").useMutationInterop)(a),r=(0,o.useCallback)(e=>e?{...e,replies:[]}:void 0,[]);return{createInlineReplyInterop:(0,o.useCallback)(({originalMutationFn:e,options:o,onCacheUpdateError:a})=>{if(!(0,n("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1))return e(o);{let{variables:e}=o,{includeReactionsAndReplies:n,...m}=e;return i({variables:{...m},update:(e,n)=>{t({newComment:r(n.data.replyInlineComment),onError:a})}})}},[t,r,i])}}}),t("8z9UY",function(e,n){var t,o=((t={}).EDITOR="EDITOR",t.LIVE="LIVE",t);e.exports.CommentDeletionLocation=o}),t("310ZR",function(e,n){var t,o,a,i,r,m,l,s,d,c,u,p;let E={fragment:{argumentDefinitions:t=[{defaultValue:null,kind:"LocalArgument",name:"input"},{defaultValue:null,kind:"LocalArgument",name:"pageId"}],kind:"Fragment",name:"useCreateInlineReplyMutation",selections:p=[{args:[{kind:"Variable",name:"input",variableName:"input"}],concreteType:"Comment",kind:"LinkedField",name:"replyInlineComment",plural:!1,selections:[o={kind:"ScalarField",name:"id"},{kind:"LinkedField",name:"author",plural:!1,selections:[a={kind:"ScalarField",name:"__typename"},i={kind:"ScalarField",name:"displayName"},{kind:"ScalarField",name:"permissionType"},{concreteType:"Icon",kind:"LinkedField",name:"profilePicture",plural:!1,selections:[{kind:"ScalarField",name:"path"}]},r={kind:"ScalarField",name:"type"},m={kind:"InlineFragment",selections:[{kind:"ScalarField",name:"accountId"}],type:"KnownUser"}]},{args:[{kind:"Literal",name:"representation",value:"ATLAS_DOC_FORMAT"}],concreteType:"DocumentBody",kind:"LinkedField",name:"body",plural:!1,selections:l=[{kind:"ScalarField",name:"value"}],storageKey:'body(representation:"ATLAS_DOC_FORMAT")'},{concreteType:"Content",kind:"LinkedField",name:"container",plural:!1,selections:[o]},{kind:"ScalarField",name:"contentStatus"},{concreteType:"ConfluenceDate",kind:"LinkedField",name:"createdAt",plural:!1,selections:l},{kind:"ScalarField",name:"createdAtNonLocalized"},{concreteType:"Map_LinkType_String",kind:"LinkedField",name:"links",plural:!1,selections:[{kind:"ScalarField",name:"editui"},{kind:"ScalarField",name:"webui"}]},{kind:"LinkedField",name:"location",plural:!1,selections:[a,r,{kind:"InlineFragment",selections:[{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"commentResolveProperties",plural:!1,selections:[s={kind:"ScalarField",name:"resolved"},d={kind:"ScalarField",name:"resolvedFriendlyDate"},c={kind:"ScalarField",name:"resolvedTime"},u={kind:"ScalarField",name:"resolvedUser"}]}],type:"FooterComment"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"inlineMarkerRef"},{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"inlineResolveProperties",plural:!1,selections:[{kind:"ScalarField",name:"isDangling"},s,d,c,u]},{kind:"ScalarField",name:"inlineText"}],type:"InlineComment"}]},{kind:"ScalarField",name:"parentId"},{concreteType:"CommentPermissions",kind:"LinkedField",name:"permissions",plural:!1,selections:[{kind:"ScalarField",name:"isEditable"},{kind:"ScalarField",name:"isRemovable"},{kind:"ScalarField",name:"isResolvable"}]},{args:[{kind:"Literal",name:"childType",value:"comment"},{kind:"Literal",name:"contentType",value:"page"},{kind:"Variable",name:"pageId",variableName:"pageId"}],concreteType:"ReactionsSummaryResponse",kind:"LinkedField",name:"reactionsSummary",plural:!1,selections:[{kind:"ScalarField",name:"ari"},{kind:"ScalarField",name:"containerAri"},{kind:"ScalarField",name:"reactionsCount"},{concreteType:"ReactionsSummaryForEmoji",kind:"LinkedField",name:"reactionsSummaryForEmoji",plural:!0,selections:[o,{kind:"ScalarField",name:"count"},{kind:"ScalarField",name:"emojiId"},{kind:"ScalarField",name:"reacted"}]}]},{concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[a,r,i,m]},{kind:"ScalarField",name:"friendlyWhen"},{kind:"ScalarField",name:"number"},{kind:"ScalarField",name:"when"}]}]}],type:"Mutation"},kind:"Request",operation:{argumentDefinitions:t,kind:"Operation",name:"useCreateInlineReplyMutation",selections:p},params:{cacheID:"ff5215a72489876105d30ad9309f5653",id:"22405cc40e4df294f2bb5ab4cc21322f39813988c99b602fd078e2d2171b1569",metadata:{},name:"useCreateInlineReplyMutation",operationKind:"mutation",text:'mutation useCreateInlineReplyMutation($input:ReplyInlineCommentInput!,$pageId:ID!){replyInlineComment(input:$input){id,author{__typename,displayName,permissionType,...on KnownUser{accountId,permissionType},profilePicture{path},type},body(representation:ATLAS_DOC_FORMAT){value},container{id},contentStatus,createdAt{value},createdAtNonLocalized,links{editui,webui},location{__typename,type,...on FooterComment{commentResolveProperties{resolved,resolvedFriendlyDate,resolvedTime,resolvedUser}},...on InlineComment{inlineMarkerRef,inlineResolveProperties{isDangling,resolved,resolvedFriendlyDate,resolvedTime,resolvedUser},inlineText}},parentId,permissions{isEditable,isRemovable,isResolvable},reactionsSummary(pageId:$pageId,contentType:"page",childType:"comment"){ari,containerAri,reactionsCount,reactionsSummaryForEmoji{id,count,emojiId,reacted}},version{by{__typename,type,displayName,...on KnownUser{accountId}},friendlyWhen,number,when}}}'}};E.hash="89307048f2bef038ef297088e05842c3",e.exports.default=E});
//# sourceMappingURL=FullPageEditorComponent.4959a66f.js.map
