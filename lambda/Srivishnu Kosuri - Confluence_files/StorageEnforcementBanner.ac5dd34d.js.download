function e(e){return e&&e.__esModule?e.default:e}var t=globalThis.parcelRequired477,r=t.register;r("3Atou",function(r,n){var a=t("42omo"),s=t("T1bCI"),o=t("b3j2Y"),i=t("4PPzL");let c="StorageEnforcementBanner",l=t("1UApO").PERSISTED_KEYS_ON_SERVER.PERSISTED_STORAGE_ENFORCEMENT_BANNER,u=()=>"true"===String(t("17wUi").confluenceLocalStorageInstance?.getItem(l)),E=({currentUsage:e,skip:r})=>{let[n,s]=(0,a.useState)(u);return(0,a.useEffect)(()=>{n&&(e<t("hezbO").CONFLUENCE_STORAGE_LIMITS.FREE*t("hezbO").WARNING_THRESHOLD||e>=t("hezbO").CONFLUENCE_STORAGE_LIMITS.FREE)&&(t("17wUi").confluenceLocalStorageInstance.setItem(l,"false"),s(!1))},[e,n]),{isDismissed:!r&&n,onDismiss:(0,a.useCallback)(()=>{t("17wUi").confluenceLocalStorageInstance.setItem(l,"true"),s(!0)},[])}},d=(0,t("cgtv4").defineMessages)({learnMoreLink:{id:"storage-enforcement.banner.learn-more",defaultMessage:"Learn more"}}),m=(0,t("cgtv4").defineMessages)({dismiss:{id:"storage-enforcement.banner.button.dismiss",defaultMessage:"Dismiss"},moreIcon:{id:"storage-enforcement.icons.more",defaultMessage:"More icon"}}),g=({handleDismiss:r=()=>{},showDismiss:n,onLearnMoreClick:s})=>{let{formatMessage:o}=(0,t("8C5kA").default)();return e(a).createElement(t("52EPl").default,{trigger:({triggerRef:r,...n})=>e(a).createElement(t("eEA8O").default,{...n,appearance:"subtle",iconBefore:e(a).createElement(e(t("9VJDA")),{label:o(m.moreIcon)}),ref:r}),shouldRenderToParent:(0,t("9wGTI").fg)("should-render-to-parent-should-be-trueadmin-experi")},e(a).createElement(t("ahaN7").default,null,e(a).createElement(t("dAYOx").default,{href:t("7aTMs").LEARN_MORE_URL,target:"_blank",onClick:s},o(d.learnMoreLink)),n&&e(a).createElement(t("dAYOx").default,{onClick:r},o(m.dismiss))))},f=(0,t("jmjWc").LoadableLazy)({__loadable_id__:"U0Lbt",name:"PlanConsentDeepLink",loader:async()=>(await t("lUKe9")).PlanConsentDeepLink});function _({children:r}){let{fireLearnMoreEvent:n}=(0,t("jH0zq").useBannerAnalytics)();return e(a).createElement(t("53qVZ").BannerLink,{onClick:n,href:t("7aTMs").LEARN_MORE_URL,target:"_blank"},r)}let b=(0,t("cgtv4").defineMessages)({adminHardMessageV2:{id:"storage-enforcement.banner.admin.hard.message.v2",defaultMessage:"Action required. You won’t be able to create in Confluence soon, unless you upgrade for more storage or delete <b>{number} GB</b> of files by {date}. <a>Upgrade to Standard</a>"},adminHardEnforceMessage:{id:"storage-enforcement.banner.admin.hard.enforced.message",defaultMessage:"Action required. You can’t edit or create new content in Confluence until you upgrade for more storage or delete <b>{number} GB</b> GB of files. <a>Upgrade to Standard</a>"},nthUserHardMessage:{id:"storage-enforcement.banner.nth-user.hard.message",defaultMessage:"Action required. You won’t be able to create in Confluence soon unless you delete files by {date}. <a>Learn more</a>"},nthUserHardEnforceMessage:{id:"storage-enforcement.banner.nth-user.hard.enforced.message",defaultMessage:"Action required. You can’t edit or create new content in Confluence until you delete files. <a>Learn more</a>"}}),S=()=>{let{formatMessage:r,formatDate:n}=(0,t("8C5kA").default)(),{currentUsage:s,gracePeriodEndDate:o,isStorageEnforcementGracePeriodComplete:i}=(0,t("4c1VG").useGetCurrentStorageUsage)(),{isSiteAdmin:c}=(0,a.useContext)(t("1ytiN").SPAViewContext),{fireLearnMoreEvent:l,fireScreenEvent:u}=(0,t("jH0zq").useBannerAnalytics)(),E=n(new Date(o),{year:"numeric",month:"long",day:"2-digit"}),d=(0,t("hezbO").getOverLimitFormatted)(s,t("euL71").ConfluenceEdition.FREE);(0,a.useEffect)(()=>{u()},[u]);let m=i?b.adminHardEnforceMessage:b.adminHardMessageV2,S=i?b.nthUserHardEnforceMessage:b.nthUserHardMessage,C=c?r(m,{date:E,number:d,a:t=>e(a).createElement(f,null,t),b:(...t)=>e(a).createElement("b",null,t)}):r(S,{date:E,number:d,a:t=>e(a).createElement(_,null,t)});return e(a).createElement(e(a).Fragment,null,e(a).createElement(t("1eaCJ").ExperienceSuccess,{name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_EXPERIENCE}),e(a).createElement(t("53qVZ").OnboardingWarningBanner,{bannerHeight:56,description:C,rightSideComponent:c&&e(a).createElement(g,{onLearnMoreClick:l,showDismiss:!1})}))},C=(0,t("cgtv4").defineMessages)({closeIcon:{id:"storage-enforcement.icons.close",defaultMessage:"Close icon"},softMessageOver:{id:"storage-enforcement.banner.soft.message.over",defaultMessage:"You’ve exceeded the 2GB storage limit for your Free plan."},softMessageUnderV2:{id:"storage-enforcement.banner.soft.message.under.v2",defaultMessage:"You’ve used <b>{number}%</b> of the Free plan’s 2 GB storage limit."},upgradeForMoreStorage:{id:"storage-enforcement.banner.button.upgrade-for-more-storage",defaultMessage:"Upgrade for more storage"}}),p=({onDismiss:r})=>{let{formatMessage:n}=(0,t("8C5kA").default)(),s=(0,a.useContext)(t("1kHsc").ExperienceTrackerContext),{currentUsage:o}=(0,t("4c1VG").useGetCurrentStorageUsage)(),{isSiteAdmin:i}=(0,a.useContext)(t("1ytiN").SPAViewContext),{fireLearnMoreEvent:c,fireDismissEvent:l,fireScreenEvent:u}=(0,t("jH0zq").useBannerAnalytics)();(0,a.useEffect)(()=>{u()},[u]);let E=()=>{s.start({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_DISMISS_EXPERIENCE});try{l(),r(),s.succeed({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_DISMISS_EXPERIENCE})}catch(e){s.stopOnError({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_DISMISS_EXPERIENCE,error:e})}};return e(a).createElement(e(a).Fragment,null,e(a).createElement(t("1eaCJ").ExperienceSuccess,{name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_EXPERIENCE}),e(a).createElement(t("53qVZ").OnboardingWarningBanner,{bannerHeight:56,description:n(C.softMessageUnderV2,{number:(0,t("hezbO").getStoragePercentForEdition)(o,t("euL71").ConfluenceEdition.FREE),b:(...t)=>e(a).createElement("b",null,t)}),inlineDescriptionCTA:i?e(a).createElement(f,null,n(C.upgradeForMoreStorage)):e(a).createElement(_,null,n(d.learnMoreLink)),rightSideComponent:e(a).createElement(e(a).Fragment,null,i&&e(a).createElement(g,{onLearnMoreClick:c,handleDismiss:E,showDismiss:!0}),!i&&e(a).createElement(t("eEA8O").default,{appearance:"subtle",onClick:E,onMouseDown:e=>e.preventDefault(),iconBefore:e(a).createElement(e(t("hmuev")),{label:n(C.closeIcon)})}))}))},N=(0,a.memo)(({bannerState:r})=>{let n=(0,a.useContext)(t("1kHsc").ExperienceTrackerContext),{shouldRender:s,shouldRenderHard:i,error:l,loading:u,onDismiss:d}=function(e=null){let{currentUsage:r,loading:n,error:a,gracePeriodEndDate:s}=(0,t("4c1VG").useGetCurrentStorageUsage)(),o=r>=t("hezbO").CONFLUENCE_STORAGE_LIMITS.FREE&&s,i=r>=t("hezbO").CONFLUENCE_STORAGE_LIMITS.FREE*t("hezbO").WARNING_THRESHOLD&&r<t("hezbO").CONFLUENCE_STORAGE_LIMITS.FREE,{isDismissed:l,onDismiss:u}=E({currentUsage:r,skip:!i});i&&(i=!l);let d=!!(o||i);return d?(e?.show(c,56),(0,t("cbc8g").addUFOCustomData)({isStorageEnforcementBannerDisplayed:!0})):e?.hide(c),{shouldRender:d,shouldRenderHard:o,currentUsage:r,onDismiss:u,error:a,loading:n}}(r),{createAnalyticsEvent:m}=(0,t("inPa6").useAnalyticsEvents)();return l?(n.stopOnError({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_EXPERIENCE,error:l,attributes:{shouldRender:s,shouldRenderHard:i,isSSR:void 0}}),(0,t("1uFM6").isUnauthorizedError)(l))?((0,t("7Sm4c").markErrorAsHandled)(l),null):(m({type:"sendOperationalEvent",data:{action:"errored",actionSubject:"storageEnforcementBanner",source:"onboarding",attributes:{message:l.message,stack:l.stack}}}).fire(),e(a).createElement(o.ErrorDisplay,{error:l})):s?i?e(a).createElement(S,null):e(a).createElement(p,{onDismiss:d}):(u||n.abort({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_EXPERIENCE,reason:"under storage enforcement threshold"}),null)});r.exports.StorageEnforcementBanner=()=>e(a).createElement(i.ErrorBoundary,{attribution:t("3IBnw").Attribution.ADMIN_EXPERIENCE},e(a).createElement(t("ln0hx").ExperienceStart,{name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BANNER_EXPERIENCE}),e(a).createElement(s.Subscribe,{to:[t("hrAmX").BannerStateContainer]},t=>e(a).createElement(N,{bannerState:t})))}),r("4c1VG",function(e,r){e.exports.useGetCurrentStorageUsage=({skip:e}={})=>{let{data:r,loading:n,error:a}=(0,t("xQxzY").useQuery)((0,t("eSUdr").default)`query useGetCurrentStorageUsageGetCurrentStorageUsageQuery{storage:confluence_storage{bytesUsed isStorageEnforcementGracePeriodComplete gracePeriodEndDate}}`,{skip:e});return{currentUsage:r?.storage?.bytesUsed??0,isStorageEnforcementGracePeriodComplete:r?.storage?.isStorageEnforcementGracePeriodComplete,gracePeriodEndDate:r?.storage?.gracePeriodEndDate,loading:n,error:a}}}),r("hezbO",function(e,r){var n,a=((n={})[n.FREE=2e9]="FREE",n[n.STANDARD=25e10]="STANDARD",n);let s={[t("euL71").ConfluenceEdition.FREE]:2e9,[t("euL71").ConfluenceEdition.STANDARD]:25e10};e.exports.WARNING_THRESHOLD=.9,e.exports.CONFLUENCE_STORAGE_LIMITS=a,e.exports.getOverLimitFormatted=(e,t)=>{let r=(e-s[t])/1e9;return(r<0?0:r).toFixed(1)},e.exports.getOverLimitPercent=(e,t)=>{let r=s[t];return((e-r)/r*100).toFixed(1)},e.exports.getStoragePercentForEdition=(e,t)=>{let r=Math.floor(e/s[t]*100);return r>100?100:r},e.exports.getIsOverEditionLimit=(e,t)=>e>s[t]}),r("53qVZ",function(r,n){var a=t("3u0dr"),s=t("frIzR"),o=t("42omo");let i=(0,o.forwardRef)((0,a.isReactCompilerActiveV1)()?(r,n)=>{let a,i=(0,s.c)(8);if(i[0]!==n||i[1]!==r){let s,c,{as:l,style:u,...E}=r,d=`${E.height}px`;i[3]!==d?(s=(0,t("7sObp").default)(d),i[3]=d,i[4]=s):s=i[4],i[5]!==u||i[6]!==s?(c={...u,"--_1neqek2":s},i[5]=u,i[6]=s,i[7]=c):c=i[7],a=e(o).createElement(void 0===l?"div":l,{...E,style:c,ref:n,className:(0,t("gMc0m").default)(["_11q71917 _1yt4utpp _zulp1b66 _1e0c1txw _1bah1h6o _4cvr1h6o _syazi7uo _4t3i2nrh _vchhusvi",E.className])}),i[0]=n,i[1]=r,i[2]=a}else a=i[2];return a}:({as:r="div",style:n,...a},s)=>e(o).createElement(r,{...a,style:{...n,"--_1neqek2":(0,t("7sObp").default)(`${a.height}px`)},ref:s,className:(0,t("gMc0m").default)(["_11q71917 _1yt4utpp _zulp1b66 _1e0c1txw _1bah1h6o _4cvr1h6o _syazi7uo _4t3i2nrh _vchhusvi",a.className])})),c=(0,o.forwardRef)((0,a.isReactCompilerActiveV1)()?(r,n)=>{let a,i,c,l,u,E,d=(0,s.c)(13);if(d[0]!==n||d[1]!==r){let{as:e,style:s,...o}=r;a=void 0===e?"a":e,i=o,c=s,l=n,u=(0,t("gMc0m").default)(["_4bfu1r31 _1hms8stv _ajmmnqa1 _syazi7uo _80omtlke _o5721q9c _d16pv77o _7b0b1i6y _30l3i7uo _1053i7uo",o.className]),d[0]=n,d[1]=r,d[2]=a,d[3]=i,d[4]=c,d[5]=l,d[6]=u}else a=d[2],i=d[3],c=d[4],l=d[5],u=d[6];return d[7]!==a||d[8]!==i||d[9]!==c||d[10]!==l||d[11]!==u?(E=e(o).createElement(a,{...i,style:c,ref:l,className:u}),d[7]=a,d[8]=i,d[9]=c,d[10]=l,d[11]=u,d[12]=E):E=d[12],E}:({as:r="a",style:n,...a},s)=>e(o).createElement(r,{...a,style:n,ref:s,className:(0,t("gMc0m").default)(["_4bfu1r31 _1hms8stv _ajmmnqa1 _syazi7uo _80omtlke _o5721q9c _d16pv77o _7b0b1i6y _30l3i7uo _1053i7uo",a.className])})),l=(0,o.forwardRef)((0,a.isReactCompilerActiveV1)()?(r,n)=>{let a,i,c,l,u,E,d=(0,s.c)(13);if(d[0]!==n||d[1]!==r){let{as:e,style:s,...o}=r;a=void 0===e?"div":e,i=o,c=s,l=n,u=(0,t("gMc0m").default)(["_1reo15vq _18m915vq _zulp1b66 _1e0c1txw _4cvr1h6o _k48p1wq8",o.className]),d[0]=n,d[1]=r,d[2]=a,d[3]=i,d[4]=c,d[5]=l,d[6]=u}else a=d[2],i=d[3],c=d[4],l=d[5],u=d[6];return d[7]!==a||d[8]!==i||d[9]!==c||d[10]!==l||d[11]!==u?(E=e(o).createElement(a,{...i,style:c,ref:l,className:u}),d[7]=a,d[8]=i,d[9]=c,d[10]=l,d[11]=u,d[12]=E):E=d[12],E}:({as:r="div",style:n,...a},s)=>e(o).createElement(r,{...a,style:n,ref:s,className:(0,t("gMc0m").default)(["_1reo15vq _18m915vq _zulp1b66 _1e0c1txw _4cvr1h6o _k48p1wq8",a.className])})),u=(0,o.forwardRef)((0,a.isReactCompilerActiveV1)()?(r,n)=>{let a,i,c,l,u,E,d=(0,s.c)(13);if(d[0]!==n||d[1]!==r){let{as:e,style:s,...o}=r;a=void 0===e?"span":e,i=o,c=s,l=n,u=(0,t("gMc0m").default)(["_1reo15vq _18m915vq _o5721q9c _1bto1l2s",o.className]),d[0]=n,d[1]=r,d[2]=a,d[3]=i,d[4]=c,d[5]=l,d[6]=u}else a=d[2],i=d[3],c=d[4],l=d[5],u=d[6];return d[7]!==a||d[8]!==i||d[9]!==c||d[10]!==l||d[11]!==u?(E=e(o).createElement(a,{...i,style:c,ref:l,className:u}),d[7]=a,d[8]=i,d[9]=c,d[10]=l,d[11]=u,d[12]=E):E=d[12],E}:({as:r="span",style:n,...a},s)=>e(o).createElement(r,{...a,style:n,ref:s,className:(0,t("gMc0m").default)(["_1reo15vq _18m915vq _o5721q9c _1bto1l2s",a.className])})),E=(0,t("cgtv4").defineMessages)({warningIcon:{id:"banners.icons.warning",defaultMessage:"Warning icon"},moreIcon:{id:"banners.icons.more",defaultMessage:"More icon"},closeIcon:{id:"banners.icons.close",defaultMessage:"Close icon"}}),d=(0,a.isReactCompilerActiveV1)()?r=>{let n,a,c,d,m,g=(0,s.c)(14),{bannerHeight:f,description:_,inlineDescriptionCTA:b,rightSideComponent:S}=r,{formatMessage:C}=(0,t("8C5kA").default)();return g[0]!==C?(n=C(E.warningIcon),g[0]=C,g[1]=n):n=g[1],g[2]!==n?(a=e(o).createElement(e(t("ebrpi")),{spacing:"spacious",label:n,color:"var(--ds-icon-warning, #E06C00)"}),g[2]=n,g[3]=a):a=g[3],g[4]!==_?(c=e(o).createElement(u,null,_),g[4]=_,g[5]=c):c=g[5],g[6]!==b||g[7]!==a||g[8]!==c?(d=e(o).createElement(l,null,a,c,b),g[6]=b,g[7]=a,g[8]=c,g[9]=d):d=g[9],g[10]!==f||g[11]!==S||g[12]!==d?(m=e(o).createElement(i,{height:f},d,S),g[10]=f,g[11]=S,g[12]=d,g[13]=m):m=g[13],m}:({bannerHeight:r,description:n,inlineDescriptionCTA:a,rightSideComponent:s})=>{let{formatMessage:c}=(0,t("8C5kA").default)();return e(o).createElement(i,{height:r},e(o).createElement(l,null,e(o).createElement(e(t("ebrpi")),{spacing:"spacious",label:c(E.warningIcon),color:"var(--ds-icon-warning, #E06C00)"}),e(o).createElement(u,null,n),a),s)};r.exports.BannerLink=c,r.exports.OnboardingWarningBanner=d}),r("7aTMs",function(e,t){e.exports.EVENT_SOURCE="onboarding",e.exports.LEARN_MORE_URL="https://support.atlassian.com/confluence-cloud/docs/manage-your-storage-usage/"}),r("jH0zq",function(e,r){var n,a=t("42omo");(n={})[n.MIN=90]="MIN",n[n.MAX=100]="MAX";let s=(e,r)=>(0,t("hezbO").getIsOverEditionLimit)(e,r)?100:90;e.exports.useBannerAnalytics=()=>{let{createAnalyticsEvent:e}=(0,t("inPa6").useAnalyticsEvents)(),{currentUsage:r}=(0,t("4c1VG").useGetCurrentStorageUsage)(),{isSiteAdmin:n}=(0,a.useContext)(t("1ytiN").SPAViewContext),o=s(r,t("euL71").ConfluenceEdition.FREE),i=(0,a.useCallback)(()=>{e({type:"sendScreenEvent",data:{name:"storageEnforcementBanner",attributes:{isSiteAdmin:n,threshold:o}}}).fire()},[e,n,o]),c=(0,a.useCallback)(()=>{e({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"storageEnforcementBannerLearnMore",source:t("7aTMs").EVENT_SOURCE,attributes:{isSiteAdmin:n,threshold:o}}}).fire()},[e,n,o]);return{fireUpgradeEvent:(0,a.useCallback)(()=>{e({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"storageEnforcementBannerUpgrade",source:t("7aTMs").EVENT_SOURCE,attributes:{isSiteAdmin:n,threshold:o}}}).fire()},[e,n,o]),fireLearnMoreEvent:c,fireDismissEvent:(0,a.useCallback)(()=>{e({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"storageEnforcementBannerDismissed",source:t("7aTMs").EVENT_SOURCE,attributes:{isSiteAdmin:n,threshold:o}}}).fire()},[e,n,o]),fireScreenEvent:i}}}),r("lUKe9",function(e,r){let n=t("4mJKd")(5);e.exports=Promise.all([n("7WaUI"),n("cGZdO")]).then(()=>t("fYalI"))}),r("lqy4C",function(e,r){var n=t("42omo");e.exports.useHardStorageEnforcement=({source:e})=>{let r=(0,n.useContext)(t("1kHsc").ExperienceTrackerContext),{createAnalyticsEvent:a}=(0,t("inPa6").useAnalyticsEvents)(),s=(0,t("alLTz").useIsStorageEnforcementEligible)(),{isStorageEnforcementGracePeriodComplete:o}=(0,t("4c1VG").useGetCurrentStorageUsage)({skip:!s}),{showBlockCreateModal:i}=(0,t("cLhhP").useBlockCreateModalActions)(),c=s&&!!o,l=(0,n.useCallback)(n=>(...s)=>{if(c){let n=s?.[0];n&&"function"==typeof n.preventDefault&&n.preventDefault(),r.start({name:t("irVI7").ONBOARDING_STORAGE_ENFORCEMENT_BLOCK_CREATE_MODAL}),a({type:"sendOperationalEvent",data:{action:"render",actionSubject:"hardStorageEnforcement",actionSubjectId:"enforceStorageLimit",source:e||"onboarding"}}).fire(),i(e);return}return n.apply(void 0,s)},[a,r,c,i,e]);return{shouldBlockCreate:c,enforceStorageLimit:l}}}),r("alLTz",function(e,r){e.exports.useIsStorageEnforcementEligible=()=>{let{edition:e,isLoggedIn:r}=(0,t("bQm3c").useSessionData)();return e===t("euL71").ConfluenceEdition.FREE&&r}}),r("cLhhP",function(e,r){let n=(0,t("1P1Tu").createStore)({name:"BLOCK_CREATE_MODAL_STORE",initialState:{isActive:!1,source:""},actions:{showBlockCreateModal:e=>({setState:t})=>{t({isActive:!0,source:e})},onBlockCreateModalClose:()=>({setState:e})=>{e({isActive:!1,source:""})}}}),a=(0,t("9zUhf").createHook)(n),s=(0,t("9zUhf").createActionsHook)(n);e.exports.useBlockCreateModalStore=a,e.exports.useBlockCreateModalActions=s});
//# sourceMappingURL=StorageEnforcementBanner.ac5dd34d.js.map
