function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}var n=globalThis.parcelRequired477,i=n.register;i("5u6LZ",function(t,i){var r=n("42omo"),o=n("b3j2Y");let a=n("e3X7L").default,s=(0,n("jmjWc").LoadablePaint)({__loadable_id__:"5ag_g",name:"GrantAccessDialogPaint",loader:async()=>(await n("97EnF")).GrantAccessDialog});t.exports.GrantAccessDialogLoader=({contentId:t,accountId:i,shouldSSRGrantAccessRestrictions:c,buttonPlaceholder:l,...d})=>{let u=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"o997N",name:"GrantAccessDialog",loader:async()=>(await n("97EnF")).GrantAccessDialog,loading:()=>l}),g=c&&window.__SSR_RENDERED__,{data:m,error:E}=(0,n("jMyy4").useQueryInterop)(a,{variables:{contentId:t||"",accountId:i},skip:!t||!i,fetchPolicy:g?"cache-first":"cache-and-network"}),R="",S=m?.user?.photos;if(S?.length){let e=S.find(e=>e?.isPrimary);R=(e?e.value:S[0]?.value)||""}return E?e(r).createElement(o.ErrorDisplay,{error:E}):t&&m?.user?e(r).createElement(c?s:u,{contentId:t,accountId:i,contentTitle:m?.singleContent?.title||"",displayName:m?.user?.displayName||"",profilePhoto:R,...d}):e(r).createElement(e(r).Fragment,null,d.children)}}),i("97EnF",function(e,t){let i=n("4mJKd")(5);e.exports=Promise.all([i("2t3HP"),i("coJiW"),i("h4Nf7"),i("lXGg9"),i("hy3sK"),i("lk4cE")]).then(()=>n("3aGPB"))}),i("4mJKd",function(e,t){e.exports=e=>t=>import(n("8tirZ").shardUrl(n("02nRr").resolve(t),e))}),i("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=a,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=i,e.exports.shardUrl=function(e,t){return globalThis[n]?s(e,t):e},e.exports.shardUrlUnchecked=s;let n="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function i(e,t){let n=t+1,i=e.split("").reduce((e,t)=>{let i=(e<<n)-e+t.charCodeAt(0);return i&i},0);return(i%=n)<0&&(i+=n),i}let r=/-\d+$/;function o(e){if(!r.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function a(e,t){let n=e.indexOf("."),i=0===t?"":`-${t-1}`;if(-1===n)return`${o(e)}${i}`;let r=o(e.slice(0,n));return`${r}${i}${e.slice(n)}`}function s(e,t){let n=new URL(e),r=i(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(n.pathname),t);return n.hostname=a(n.hostname,r),n.toString()}e.exports.domainShardingKey=n}),i("02nRr",function(e,n){t(e.exports,"register",()=>i,e=>i=e),t(e.exports,"resolve",()=>r,e=>r=e);var i,r,o=new Map;i=function(e,t){for(var n=0;n<t.length-1;n+=2)o.set(t[n],{baseUrl:e,path:t[n+1]})},r=function(e){var t=o.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),i("8RR7m",function(e,t){let i=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"960Da",name:"GrantAccessFlagLoader",loader:async()=>(await n("a1eqA")).GrantAccessFlag});e.exports.GrantAccessFlagLoader=i}),i("a1eqA",function(e,t){let i=n("4mJKd")(5);e.exports=Promise.all([i("coJiW"),i("h4Nf7"),i("lXGg9"),i("hy3sK"),i("4mWJk")]).then(()=>n("4Cd45"))}),i("hAnPj",function(e,i){t(e.exports,"RestrictionsDialogTriggerWrapper",()=>n("SAFLR").RestrictionsDialogTriggerWrapper),t(e.exports,"RestrictionsDialogTrigger",()=>n("lEXFh").RestrictionsDialogTrigger),t(e.exports,"RestrictionsDialogMenuPropsProvider",()=>n("lQDcS").RestrictionsDialogMenuPropsProvider),n("SAFLR"),n("lEXFh"),n("lQDcS");let r=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"qdHUS",name:"LazyRestrictionsDialogMountPoint",loader:async()=>(await n("jaWw7")).RestrictionsDialogMountPoint});e.exports.LazyRestrictionsDialogMountPoint=r}),i("SAFLR",function(t,i){var r=n("42omo"),o=n("4PPzL"),a=n("lEXFh");t.exports.RestrictionsDialogTriggerWrapper=t=>{let{accessStatus:i}=(0,n("bQm3c").useSessionData)(),s=i===n("d9tcB").AccessStatus.LICENSED_USE_ACCESS||i===n("d9tcB").AccessStatus.LICENSED_ADMIN_ACCESS;return e(r).createElement(o.ErrorBoundary,{attribution:n("3IBnw").Attribution.PERMISSIONS_EXPERIENCE,key:"restrictions-dialog-trigger"},s?e(r).createElement(e(r).Fragment,null,e(r).createElement(n("ln0hx").ExperienceStart,{key:"restriction-button-start",id:t.contentId,name:n("irVI7").VIEW_PAGE_RESTRICTIONS_BUTTON_EXPERIENCE}),e(r).createElement(a.RestrictionsDialogTrigger,t)):null)}}),i("lEXFh",function(t,i){var r=n("42omo"),o=n("T1bCI"),a=n("7d2Nc"),s=n("b27bJ"),c=n("5u6LZ"),l=n("8RR7m"),d=n("cSVAY");let u=(0,n("ecnYn").xcss)({display:"inline-block",verticalAlign:"top"}),g="bottom-end",m=(0,r.memo)(t=>{let i=(0,n("ckmNl").useContentId)(t.contentId)||"",{edition:m}=(0,n("bQm3c").useSessionData)(),[R,S]=(0,r.useState)({grantAccessClicked:!1,hasAutoOpenedRestrictionDialog:!1,showFreeRestrictionDialog:!1}),f=t.contentSubType,p=(0,n("inPa6").useAnalyticsEvents)(),[h]=(0,n("ep3mz").useContentType)(),I=(0,r.useContext)(n("1kHsc").ExperienceTrackerContext),D=e=>()=>E({...p,actionSubjectId:"restrictionsDialogButton",dialogStateContainer:e,edition:m,experienceTracker:I,contentType:h,contentSubType:f,contentId:i}),_=e=>{let t=e?.ancestors||[];for(let e=t.length-1;e>=0;e--)if(t[e].hasRestrictions)return t[e]},L=()=>{S(e=>({...e,grantAccessClicked:!0}))},b=()=>{S(e=>({...e,showFreeRestrictionDialog:!0}))},P=()=>{S(e=>({...e,showFreeRestrictionDialog:!1}))},C=(o,a)=>{let{isDisabled:c,triggeredFrom:l}=t,u="fromView"===l;return e(r).createElement(n("jLw6A").PageRestrictionsContextConsumer,null,({loading:t,error:m,restrictions:E})=>{if(!E&&t||m)return e(r).createElement(n("eE3dj").RestrictionsButtonPlaceholder,null);let f=!!(E?.hasRestrictions||E?.hasInheritedRestrictions),p=!!(E?.hasInheritedRestrictions&&!E?.hasRestrictions),h=(E?.ancestors.length||0)-1>0;if(f){if(h&&p){let t=_(E);return u?e(r).createElement(s.ChangeEditionInlineDialogPaintLoader,{isOpen:R.showFreeRestrictionDialog,onClose:P,parentData:t,isChildPage:h,placement:g},e(r).createElement(d.RestrictionsButtonLoaderPaint,{contentId:i,isDisabled:c,onClick:b,restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free inherited",triggeredFrom:l})):e(r).createElement(s.ChangeEditionInlineDialogLoader,{isOpen:R.showFreeRestrictionDialog,onClose:P,parentData:t,isChildPage:h,placement:g},e(r).createElement(d.RestrictionsButtonLoaderAfterPaint,{contentId:i,isDisabled:c,onClick:b,restrictionsButtonSSRLocation:"free inherited",triggeredFrom:l}))}return a&&!R.hasAutoOpenedRestrictionDialog&&(D(o)(),S(e=>({...e,hasAutoOpenedRestrictionDialog:!0}))),u?e(r).createElement(d.RestrictionsButtonLoaderPaint,{contentId:i,isDisabled:c,resetDialogState:()=>o.initState(),onClick:D(o),restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free grandfather",triggeredFrom:l}):e(r).createElement(d.RestrictionsButtonLoaderAfterPaint,{contentId:i,isDisabled:c,onClick:D(o),restrictionsButtonSSRLocation:"free grandfather",triggeredFrom:l})}return u?e(r).createElement(s.ChangeEditionInlineDialogPaintLoader,{isOpen:R.showFreeRestrictionDialog,onClose:P,placement:g},e(r).createElement(d.RestrictionsButtonLoaderPaint,{contentId:i,isDisabled:c,onClick:b,restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"free",triggeredFrom:l})):e(r).createElement(s.ChangeEditionInlineDialogLoader,{isOpen:R.showFreeRestrictionDialog,onClose:P,placement:g},e(r).createElement(d.RestrictionsButtonLoaderAfterPaint,{contentId:i,isDisabled:c,onClick:b,restrictionsButtonSSRLocation:"free",triggeredFrom:l}))})},A=n=>{let{isDisabled:o,triggeredFrom:a}=t;return a&&"fromView"===a?e(r).createElement(d.RestrictionsButtonLoaderPaint,{contentId:i,isDisabled:o,onClick:D(n),resetDialogState:()=>n.initState(),restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"default",triggeredFrom:a}):e(r).createElement(d.RestrictionsButtonLoaderAfterPaint,{contentId:i,isDisabled:o,onClick:D(n),restrictionsButtonSSRLocation:"default",triggeredFrom:a})},x=(o,a,s)=>{let{isDisabled:l,triggeredFrom:u}=t,g=o(),m="fromView"===u;if(s&&!R.grantAccessClicked){let t=(0,n("c3Qwv").getSingleParam)(g,"accountId"),o=(0,n("c3Qwv").getSingleParam)(g,"username")||"";return e(r).createElement(c.GrantAccessDialogLoader,{isOpen:!0,contentId:i,onActionClick:L,accessType:"edit"===(0,n("c3Qwv").getSingleParam)(g,"accessType")?"edit":"view",accountId:t||o,shouldSSRGrantAccessRestrictions:m,buttonPlaceholder:e(r).createElement(n("eE3dj").RestrictionsButtonPlaceholder,null)},m?e(r).createElement(d.RestrictionsButtonLoaderPaint,{contentId:i,isDisabled:l,resetDialogState:()=>a.initState(),onClick:D(a),restrictionsButtonSSRRendered:!0,restrictionsButtonSSRLocation:"default grant access",triggeredFrom:u}):e(r).createElement(d.RestrictionsButtonLoaderAfterPaint,{contentId:i,isDisabled:l,onClick:D(a),restrictionsButtonSSRLocation:"default grant access",triggeredFrom:u}))}return A(a)},T=t=>e(r).createElement(e(r).Fragment,null,A(t),e(r).createElement(l.GrantAccessFlagLoader,{contentId:i}));return e(r).createElement(o.Subscribe,{to:[n("bVAxT").RestrictionsDialogStateContainer]},t=>e(r).createElement(n("6f0Oj").default,{xcss:u},e(r).createElement(a.PageSegmentLoadStart,{isCustomStart:!0,key:`start-${i}`,metric:n("14SPd").RESTRICTIONS_BUTTON_METRIC}),m?e(r).createElement(n("7zgzO").RoutesContext.Consumer,null,({getQueryParams:e})=>{let{accountId:i,grantAccess:r,username:o}=e(),a=!!(r&&i||o);return m===n("euL71").ConfluenceEdition.FREE?C(t,a):(0,n("9wGTI").fg)("confluence_frontend_grant_access_flag")?T(t):x(e,t,a)}):e(r).createElement(n("fkOJz").RestrictionsButtonLoading,null)))});function E({actionSubjectId:e,createAnalyticsEvent:t,dialogStateContainer:i,edition:r,experienceTracker:o,triggeredFrom:a,contentType:s,contentSubType:c,contentId:l}){t({type:"sendUIEvent",data:{source:"viewPageScreen",action:"clicked",actionSubject:"button",actionSubjectId:e,attributes:{source:"v2",triggeredFrom:a,edition:r,contentType:s,isLivePage:"live"===c}}}).fire(),o.start({name:n("irVI7").RESTRICTIONS_DIALOG_EXPERIENCE,attributes:{contentType:s},collect(e,t){t.stopOn(e.find(({action:e,name:t})=>("taskFail"===e||"taskAbort"===e)&&(t===n("irVI7").RESTRICTIONS_DIALOG_LOAD_EXPERIENCE||t===n("irVI7").RESTRICTIONS_DIALOG_APPLY_EXPERIENCE)))}}),o.start({name:n("irVI7").RESTRICTIONS_DIALOG_LOAD_EXPERIENCE,timeout:n("aJPUt").ExperienceTimeout.DEFAULT}),i.setContentId(l),i.setIsOpen(!0,a),n("14SPd").RESTRICTIONS_DIALOG_METRIC.start()}m.displayName="RestrictionsDialogTrigger",t.exports.RestrictionsDialogTrigger=m,t.exports.startRestrictionsDialogExperience=E}),i("b27bJ",function(e,t){let i=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"PlyJG",name:"ChangeEditionInlineDialogLoader",loader:async()=>(await n("cJNu5")).ChangeEditionInlineDialog}),r=(0,n("jmjWc").LoadablePaint)({__loadable_id__:"4GH4a",name:"ChangeEditionInlineDialogPaintLoader",loader:async()=>(await n("cJNu5")).ChangeEditionInlineDialog});e.exports.ChangeEditionInlineDialogLoader=i,e.exports.ChangeEditionInlineDialogPaintLoader=r}),i("cJNu5",function(e,t){let i=n("4mJKd")(5);e.exports=Promise.all([i("fD0v8"),i("6XCf4"),i("5pvpJ"),i("1qlDN"),i("1yVM6"),i("1zoBu")]).then(()=>n("4QNfT"))}),i("cSVAY",function(e,t){let i=(0,n("jmjWc").LoadablePaint)({__loadable_id__:"langk",name:"RestrictionsButtonLoaderPaint",loader:async()=>(await n("lf3z3")).RestrictionsButton,loading:n("fkOJz").RestrictionsButtonLoading}),r=(0,n("jmjWc").LoadableAfterPaint)({__loadable_id__:"ZXc7l",name:"RestrictionsButtonLoaderAfterPaint",loader:async()=>(await n("lf3z3")).RestrictionsButton,loading:n("eE3dj").RestrictionsButtonPlaceholder});e.exports.RestrictionsButtonLoaderPaint=i,e.exports.RestrictionsButtonLoaderAfterPaint=r}),i("eE3dj",function(t,i){var r=n("42omo");t.exports.RestrictionsButtonPlaceholder=function(){return e(r).createElement("div",{"data-testid":"restrictions-button-placeholder","data-test-id":"restrictions-button-placeholder",style:{width:32,height:32}})}}),i("fkOJz",function(t,i){var r=n("42omo");t.exports.RestrictionsButtonLoading=()=>e(r).createElement(n("eE3dj").RestrictionsButtonPlaceholder,null)}),i("lf3z3",function(e,t){let i=n("4mJKd")(5);e.exports=Promise.all([i("6wr18"),i("ffEVr"),i("bfhXH")]).then(()=>n("l5Yc7"))}),i("lQDcS",function(t,i){var r=n("42omo"),o=n("T1bCI"),a=n("lEXFh");let s=e(r).createElement(n("gtD4K").default,{id:"restrictions.dialog.link.text",defaultMessage:"Restrictions"});t.exports.RestrictionsDialogMenuPropsProvider=function({children:t,contentId:i}){let{edition:c}=(0,n("bQm3c").useSessionData)(),l=(0,n("inPa6").useAnalyticsEvents)(),d=(0,r.useContext)(n("1kHsc").ExperienceTrackerContext);return t&&c?e(r).createElement(o.Subscribe,{to:[n("bVAxT").RestrictionsDialogStateContainer]},e=>t({id:"bm-restrictions-link",label:s,onClick(){(0,a.startRestrictionsDialogExperience)({...l,actionSubjectId:"restrictionsDialogLink",dialogStateContainer:e,edition:c,experienceTracker:d,triggeredFrom:"actionsMenu",contentId:i})}})):null}}),i("jaWw7",function(e,t){e.exports=n("4mJKd")(5)("fno6o").then(()=>n("ca7si"))});
//# sourceMappingURL=ShareRestrictAndCopyCoordinator.9fe99ba0.js.map
