function e(e,t,s,i){Object.defineProperty(e,t,{get:s,set:i,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var s=globalThis.parcelRequired477,i=s.register;i("32CBT",function(e,t){let i=(0,s("jmjWc").LoadableLazy)({__loadable_id__:"3GQfQ",name:"PublishModal",loader:async()=>(await s("iTRet")).PublishModal}),o=(0,s("jmjWc").LoadableLazy)({__loadable_id__:"5nfIQ",name:"DiscardModal",loader:async()=>(await s("dpItF")).DiscardModal}),n=(0,s("jmjWc").LoadableLazy)({__loadable_id__:"Xm8EX",name:"CancelSchedulePublishModal",loader:async()=>(await s("9MxoE")).CancelSchedulePublishModal});e.exports.PublishModal=i,e.exports.DiscardModal=o,e.exports.CancelSchedulePublishModal=n}),i("iTRet",function(e,t){let i=s("4mJKd")(5);e.exports=Promise.all([i("2spqH"),i("gWSdF"),i("aeEUI"),i("6wr18"),i("kahM9"),i("hRUX7"),i("g4oYs"),i("kHOMt"),i("hhss7"),i("ffEVr"),i("Wowvf"),i("7EorR"),i("kUbUu"),i("anQQJ")]).then(()=>s("9V1Xo"))}),i("4mJKd",function(e,t){e.exports=e=>t=>import(s("8tirZ").shardUrl(s("02nRr").resolve(t),e))}),i("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=r,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=i,e.exports.shardUrl=function(e,t){return globalThis[s]?a(e,t):e},e.exports.shardUrlUnchecked=a;let s="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function i(e,t){let s=t+1,i=e.split("").reduce((e,t)=>{let i=(e<<s)-e+t.charCodeAt(0);return i&i},0);return(i%=s)<0&&(i+=s),i}let o=/-\d+$/;function n(e){if(!o.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function r(e,t){let s=e.indexOf("."),i=0===t?"":`-${t-1}`;if(-1===s)return`${n(e)}${i}`;let o=n(e.slice(0,s));return`${o}${i}${e.slice(s)}`}function a(e,t){let s=new URL(e),o=i(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(s.pathname),t);return s.hostname=r(s.hostname,o),s.toString()}e.exports.domainShardingKey=s}),i("02nRr",function(t,s){e(t.exports,"register",()=>i,e=>i=e),e(t.exports,"resolve",()=>o,e=>o=e);var i,o,n=new Map;i=function(e,t){for(var s=0;s<t.length-1;s+=2)n.set(t[s],{baseUrl:e,path:t[s+1]})},o=function(e){var t=n.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),i("dpItF",function(e,t){let i=s("4mJKd")(5);e.exports=Promise.all([i("hhss7"),i("fCqMy")]).then(()=>s("hpcRG"))}),i("9MxoE",function(e,t){let i=s("4mJKd")(5);e.exports=Promise.all([i("hhss7"),i("a6uKK")]).then(()=>s("ic1wA"))}),i("ibgjl",function(e,i){var o=s("42omo"),n=s("a4TK8");let r=(0,s("eSUdr").default)`query useFetchRestrictionsRESTObjRestrictionsRESTQuery($contentId:ID!$draftShareId:String){content(id:$contentId status:["current" "draft"]draftShareId:$draftShareId){nodes{id type restrictions{read{operation restrictions{groupWithRestrictions{nodes{id name usageType}}userWithRestrictions{nodes{accountId displayName email hasSpaceEditPermission hasSpaceViewPermission permissionType publicName profilePicture{path}type}}}}update{operation restrictions{groupWithRestrictions{nodes{id name usageType}}userWithRestrictions{nodes{accountId displayName email hasSpaceEditPermission hasSpaceViewPermission permissionType publicName profilePicture{path}type}}}}}}}}`,a=({contentId:e,onSuccess:t})=>{let{createAnalyticsEvent:i}=(0,s("inPa6").useAnalyticsEvents)(),[n,a]=(0,o.useState)(void 0),{data:l,error:d,refetch:u}=(0,s("xQxzY").useQuery)(r,{variables:{contentId:e,draftShareId:(0,s("7PLO8").getDraftShareIdFromQueryParam)()},notifyOnNetworkStatusChange:!0,fetchPolicy:"network-only",onCompleted:e=>{try{t?.((0,s("8mrqR").transformGraphQLQueryToRESTObj)(e)),a(void 0)}catch(e){a(e),i({type:"sendUIEvent",data:{action:"error",actionSubject:"fetchRestrictions",actionSubjectId:"fetchRestrictionsError",source:"useFetchRestrictionsRESTObj",attributes:{message:e.message}}}).fire()}}});return{fetchedRestrictions:(0,o.useMemo)(()=>{if(l){let e;try{e=(0,s("8mrqR").transformGraphQLQueryToRESTObj)(l)}catch(e){i({type:"sendUIEvent",data:{action:"error",actionSubject:"fetchRestrictions",actionSubjectId:"fetchRestrictionsError",source:"useFetchRestrictionsRESTObj",attributes:{message:e.message}}}).fire()}return e}},[l,i]),error:d||n,refetch:u}},l={pendingScheduledPublishDate:void 0,versionComments:"",publishAsBlog:!1,shouldNotify:!0,moveParams:void 0,restrictionsRestObj:void 0},d=(0,o.createContext)({...l,currentlyScheduledPublishDate:void 0,setCurrentlyScheduledPublishDate:()=>{},setPendingScheduledPublishDate:()=>{},scheduledPublishDate:void 0,setVersionComments:()=>{},setPublishAsBlog:()=>{},expanded:!1,setExpanded:()=>{},setShouldNotify:()=>{},setRestrictionsRestObj:()=>{},hasModifiedRestrictions:!1,refetchAll:()=>{},shouldNotifyComputedValue:!0,discardCurrentState:()=>{},graphqlError:void 0,restrictionsGraphQLError:void 0,onClickPublish:()=>{},onClickPreview:()=>{},retrieveEditorTitleAndContent:()=>Promise.resolve({title:"",adf:{type:""}}),flags:new(0,s("gqqjz").FlagsStateContainer)([]),hasModifiedSettings:!0,isBlog:!1,setIsBlog:()=>{},setMoveParams:()=>{},hasModifiedLocation:!1,hasScheduledRestrictions:!1,setHasScheduledRestrictions:()=>{},isConvertToPageDialog:!1}),u=()=>{let[e,s]=(0,o.useState)(void 0),[i,r]=(0,o.useState)(l.pendingScheduledPublishDate),[a,d]=(0,o.useState)(l.versionComments),[u,c]=(0,o.useState)(l.publishAsBlog),[h,p]=(0,o.useState)(!1),[b,m]=(0,o.useState)(l.shouldNotify),[f,g]=(0,o.useState)(l.restrictionsRestObj),[S,P]=(0,o.useState)(l),[v,y]=(0,o.useState)(!1),[C,R]=(0,o.useState)(!1),[D,E]=(0,o.useState)(l.moveParams),I=e?.getTime()!==i?.getTime()&&void 0!==i,M=void 0!==f&&!t(n)(S.restrictionsRestObj,f),x=S.publishAsBlog!==u||S.moveParams!==D,T=I||S.versionComments!==a||S.shouldNotify!==b||x||M,j=i??e;return{currentlyScheduledPublishDate:e,setCurrentlyScheduledPublishDate:s,pendingScheduledPublishDate:i,setPendingScheduledPublishDate:r,versionComments:a,setVersionComments:d,publishAsBlog:u,setPublishAsBlog:c,expanded:h,setExpanded:p,shouldNotify:b,setShouldNotify:m,restrictionsRestObj:f,setRestrictionsRestObj:g,hasModifiedRestrictions:M,scheduledPublishDate:j,discardCurrentState:()=>{r(l.pendingScheduledPublishDate),d(l.versionComments),c(l.publishAsBlog),m(l.shouldNotify),E(l.moveParams),g(l.restrictionsRestObj),P(l)},savedSnapshot:S,setSavedSnapshot:P,hasModifiedSettings:T,isBlog:C,setIsBlog:R,setMoveParams:E,moveParams:D,hasModifiedLocation:x,hasScheduledRestrictions:v,setHasScheduledRestrictions:y}},c=(0,s("7aRa9").withFlags)(({children:e,onClickPublish:i,onClickPreview:n,retrieveEditorTitleAndContent:r,flags:l,isUnpublishedDraft:c,contentType:h,isConvertToPageDialog:p=!1})=>{let[b]=(0,s("ep3mz").usePageContentId)(),{currentlyScheduledPublishDate:m,setCurrentlyScheduledPublishDate:f,pendingScheduledPublishDate:g,setPendingScheduledPublishDate:S,versionComments:P,setVersionComments:v,publishAsBlog:y,setPublishAsBlog:C,expanded:R,setExpanded:D,shouldNotify:E,setShouldNotify:I,restrictionsRestObj:M,setRestrictionsRestObj:x,hasModifiedRestrictions:T,scheduledPublishDate:j,discardCurrentState:w,savedSnapshot:A,setSavedSnapshot:_,hasModifiedSettings:O,isBlog:U,setIsBlog:B,setMoveParams:L,moveParams:N,hasModifiedLocation:k,hasScheduledRestrictions:Q,setHasScheduledRestrictions:V}=u(),F=(0,o.useCallback)((e,t)=>{if(!["DUAL","GRAPHQL"].includes(s("4VJDS").default.getString("confluence-migrate-fps-to-graphql-subscription",""))||!(0,s("6mKj3").expVal)("cc_fps_migration_scheduled-publish","isEnabled",!1)){let{schedulePublishRequestBody:{publishTime:e,eventType:s}}=t;"scheduled"===s?m&&m?.toISOString()===e||f(new Date(e)):"unscheduled"===s&&m&&f(void 0)}},[m,f]),q=(0,o.useCallback)((e,t)=>{let{eventType:s,publishTime:i}=t?.schedulePublished||{};"SCHEDULED"===s?m&&m?.toISOString()===i||f(new Date(i)):"UNSCHEDULED"===s&&m&&f(void 0)},[m,f]);(0,s("bT0se").usePubSubEvent)({contentId:b??"",contentType:h??"page",eventName:"blogpost"===h?"schedulePublish:blogpost":"schedulePublish:page",onEvent:F,skip:(0,s("6mKj3").expVal)("cc_fps_migration_scheduled-publish","isEnabled",!1)&&(0,s("9wGTI").fg)("confluence_enable_subscriptions-context-provider")&&"GRAPHQL"===s("4VJDS").default.getString("confluence-migrate-fps-to-graphql-subscription","")}),(0,s("i9VoI").useSubscriptionEvent)({contentId:b??"",contentType:h??"page",subscriberId:"PublishModalContextSubscription",delta:"schedulePublished",skip:!(0,s("6mKj3").expVal)("cc_fps_migration_scheduled-publish","isEnabled",!1)||!(0,s("9wGTI").fg)("confluence_enable_subscriptions-context-provider")||!["DUAL","GRAPHQL"].includes(s("4VJDS").default.getString("confluence-migrate-fps-to-graphql-subscription","")),onDataReceived:q});let{error:K,refetch:H}=a({contentId:b??"",onSuccess:e=>!Q&&_({...A,restrictionsRestObj:e})}),$=c&&U,W=E,G=T?M:A.restrictionsRestObj;G&&(0,s("8mrqR").restrictionsArePrivateToYouOnly)(G)?W=!1:(y||$)&&(W=!0);let z=e=>{let t,i,o,n=R,r=y,a=M,l=N,d=e?.singleContent?.schedulePublishInfo;d?.date?(t=new Date(Date.parse(d?.date)),i=void 0,n=!0):(t=void 0,i=void 0);let u=d?.versionComment??"";o="boolean"!=typeof d?.minorEdit||!d?.minorEdit,r=d?.targetType==="blogpost"&&e?.singleContent?.type!=="blogpost";let c=d?.targetLocation;c?.destinationSpace?.key&&(l={newSpaceKey:c?.destinationSpace?.alias||c?.destinationSpace?.key},c?.parentId&&(l={...l,newParentPageId:c?.parentId})),d?.restrictions&&(V(!0),a=(0,s("jVFPV").convertRestrictionsObjFromSchedulePublishInfo)(d?.restrictions)),f(t),S(i),D(n),v(u),I(o),C(r),x(a),L(l),_(e=>({pendingScheduledPublishDate:i,versionComments:u,publishAsBlog:r,shouldNotify:o,moveParams:l,restrictionsRestObj:a??e.restrictionsRestObj}))},{data:J,error:X,refetch:Y}=(0,s("xQxzY").useQuery)((0,s("eSUdr").default)`query PublishModalContextPublishModalWithMoreOptionsQuery($contentId:ID){singleContent(id:$contentId){id type space{id}schedulePublishInfo{date versionComment minorEdit targetType targetLocation{parentId destinationSpace{id key alias}}restrictions{update{user:personConnection{edges{node{email permissionType displayName accountId publicName profilePicture{path}}}}group{edges{node{name id}}}}read{user:personConnection{edges{node{email permissionType displayName accountId publicName profilePicture{path}}}}group{edges{node{name id}}}}}}}}`,{errorPolicy:"all",fetchPolicy:"cache-and-network",variables:{contentId:b},onCompleted:z});(0,o.useEffect)(()=>{let e=J?.singleContent?.schedulePublishInfo?.date;e&&f(new Date(Date.parse(e)))},[J?.singleContent?.schedulePublishInfo?.date,f]);let Z={currentlyScheduledPublishDate:m,setCurrentlyScheduledPublishDate:f,pendingScheduledPublishDate:g,setPendingScheduledPublishDate:S,scheduledPublishDate:j,versionComments:P,setVersionComments:v,publishAsBlog:y,setPublishAsBlog:C,expanded:R,setExpanded:D,shouldNotify:E,setShouldNotify:I,restrictionsRestObj:G,setRestrictionsRestObj:x,hasModifiedRestrictions:T,refetchAll:(0,o.useCallback)(()=>{Y(),H()},[Y,H]),shouldNotifyComputedValue:W,graphqlError:X,restrictionsGraphQLError:K,discardCurrentState:()=>{J?.singleContent?.schedulePublishInfo?.date?z(J):w()},onClickPublish:i,onClickPreview:n,retrieveEditorTitleAndContent:r,flags:l,hasModifiedSettings:O,isBlog:U,setIsBlog:B,setMoveParams:L,moveParams:N,hasModifiedLocation:k,hasScheduledRestrictions:Q,setHasScheduledRestrictions:V,isConvertToPageDialog:p};return t(o).createElement(d.Provider,{value:Z},e)});e.exports.PublishModalContext=d,e.exports.withPublishModalContextProvider=e=>({onClickPublish:s,onClickPreview:i,retrieveEditorTitleAndContent:n,isUnpublishedDraft:r,contentType:a,isConvertToPageDialog:l,...d})=>t(o).createElement(c,{onClickPublish:s,onClickPreview:i,retrieveEditorTitleAndContent:n,isUnpublishedDraft:r,contentType:a,isConvertToPageDialog:l},t(o).createElement(e,{isUnpublishedDraft:r,contentType:a,...d}))}),i("4f2ij",function(e,i){var o=s("42omo"),n=s("32CBT"),r=s("7CLBv"),a=s("lgKMU");let l=({onClose:e,contentId:i,contentType:n,isUnpublishedDraft:l})=>{let{restrictionsRestObj:d,setRestrictionsRestObj:u,hasModifiedRestrictions:c,hasScheduledRestrictions:h}=(0,o.useContext)(s("ibgjl").PublishModalContext);return t(o).createElement(a.ShareAndRestrictDialogController,{contentId:i,contentType:n,allowRestrictions:!0,pageModes:"view",refetchButtonData:()=>{},onClose:e,publishModalRestrictions:c||h?d:void 0,pushPublishModalRestrictions:e=>{u(t(r)(e))},isUnpublishedDraft:l})};e.exports.PublishModalDialogs=({isUnpublishedDraft:e,contentType:i,title:r,publishButtonDisabled:a,userViewingPreview:d,initialFocusTarget:u,shouldShowWorldIcon:c,shouldShowFooterButtons:h=!0,onPublishModalComplete:p,onHoverPublish:b})=>{let[m=""]=(0,s("ep3mz").usePageContentId)(),{discardCurrentState:f,hasModifiedSettings:g,refetchAll:S}=(0,o.useContext)(s("ibgjl").PublishModalContext),[P,v]=(0,o.useState)(!0),[y,C]=(0,o.useState)(!1),R=(0,o.useRef)(!1),[D,E]=(0,o.useState)(u),[I,M]=(0,o.useState)(!1);(0,o.useEffect)(()=>{S()},[S]);let x=()=>{M(!0)},T=()=>{M(!1)},j=e=>{v(!0),E(e)},w=({endPublishExperience:e})=>{e&&(R.current=!0),v(!1)};return t(o).createElement(o.Fragment,null,t(o).createElement(s("6xdDU").default,null,P&&t(o).createElement(n.PublishModal,{publishButtonDisabled:a,closeModal:w,openModal:j,requestCloseModal:()=>{g?C(!0):(f(),w({endPublishExperience:!0}))},onCloseComplete:()=>{R.current&&p()},isUnpublishedDraft:e,openPermissionsDialog:()=>{w({endPublishExperience:!1}),x()},userViewingPreview:d,title:r,focusField:D,setFocusField:E,shouldShowWorldIcon:c,shouldShowFooterButtons:h,onHoverPublish:b})),I&&t(o).createElement(l,{contentId:m,contentType:i,onClose:()=>{T(),j("access")},isUnpublishedDraft:e}),t(o).createElement(s("6xdDU").default,null,y&&t(o).createElement(n.DiscardModal,{closeModal:w,closeDiscardModal:()=>{C(!1)},isUnpublishedDraft:e})))}});
//# sourceMappingURL=PublishButtonWithMoreOptions.589d60fc.js.map
