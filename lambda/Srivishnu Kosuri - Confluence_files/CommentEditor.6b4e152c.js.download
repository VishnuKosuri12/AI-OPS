function e(e){return e&&e.__esModule?e.default:e}function t(e,t,r,o){Object.defineProperty(e,t,{get:r,set:o,enumerable:!0,configurable:!0})}var r=globalThis.parcelRequired477,o=r.register;o("9uAPw",function(t,o){var n=r("42omo"),s=r("7dgT3");let a=(0,r("cgtv4").defineMessages)({errorTitleCannotStart:{id:"loom-utils.error-flag.title.cannot-start",defaultMessage:"We couldn’t start your recording"},errorTitleRecordingAlreadyInProgress:{id:"loom-utils.error-flag.title.recording-already-in-progress",defaultMessage:"Recording already in progress"},errorTitleNotReady:{id:"loom-utils.error-flag.title.not-ready",defaultMessage:"The Loom recorder wasn’t ready"},errorIncompatibleBrowser:{id:"loom-utils.error-flag.description.incompatible-browser",defaultMessage:"The browser you’re currently using isn’t compatible with Loom (or you could be trying to use it in private/incognito mode). <a>Which browsers are compatible?</a>"},errorThirdPartyCookieDisabled:{id:"loom-utils.error-flag.description.third-party-cookie-disabled",defaultMessage:"Check that you have third-party cookies enabled, then try again."},errorNoMediaStreamSupport:{id:"loom-utils.error-flag.description.no-media-stream-support",defaultMessage:"You might need to try a different browser. <a>Which browsers are compatible?</a>"},errorSDKNotInitialized:{id:"loom-utils.error-flag.description.sdk-not-initialized",defaultMessage:"Try to start recording again now."},errorBackendFFNotEnabledYet:{id:"loom-utils.error-flag.description.be-ff-not-enabled-yet",defaultMessage:"Loom was recently enabled. Try again in a few minutes."},errorUnexpectedAuthTokenFailure:{id:"loom-utils.error-flag.description.unexpected-auth-token-failure",defaultMessage:"Something went wrong with the Loom recorder. Try again later, or contact Atlassian Support for help."},errorLoomUserNotCreatedYet:{id:"loom-utils.error-flag.description.loom-user-not-created-yet",defaultMessage:"Loom is enabled, just give us a few minutes to set everything up. You can try recording again in a bit."},errorSDKFailedToInitialize:{id:"loom-utils.error-flag.description.sdk-failed-to-initialize",defaultMessage:"Give it a moment and then refresh to try again."},errorRecordingAlreadyInProgress:{id:"loom-utils.error-flag.description.recording-already-in-progress",defaultMessage:"Finish your current Loom video so you can start another."}}),i="https://support.loom.com/hc/en-us/articles/360020667617-loomSDK-FAQ";t.exports.useLoomRecorderEntryPoint=({entryPointLocation:t,flags:o,resetInsertFunctionOnUnmount:c=!1})=>{let l=(0,n.useContext)(r("1kHsc").ExperienceTrackerContext),{cloudId:u,environment:d}=(0,r("bQm3c").useSessionData)(),{entryPointVariant:p}=(0,r("4R3wx").useLoomEntryPointVariant)(),[m,{initLoomSDK:g}]=(0,r("jHGaM").useLoomEntryPointGlobalState)(),[f,E]=(0,n.useState)(!1),I=(0,n.useRef)(null),S=(0,n.useRef)(m);S.current=m;let{showModal:y}=(0,r("8aF6s").useDialogs)(),{createAnalyticsEvent:_}=(0,r("inPa6").useAnalyticsEvents)();return(0,n.useEffect)(()=>{("BETA"===p||"CO_USE"===p)&&g({cloudId:u,environment:d,entryPointLocation:t})},[g,u,_,d,p,t]),(0,n.useEffect)(()=>()=>{c&&I.current&&S.current.initializedLoomSDK&&(S.current.initializedLoomSDK.updateConfig({config:{insertButtonText:"Open on Loom"}}),I.current.off("insert-click"),I.current.on("insert-click",e=>{window.open(e.sharedUrl,"_blank"),l.succeed({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,attributes:{inserted:!0,insertFunctionWasReset:!0}}),_({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:"insertVideoLink",attributes:{insertFunctionWasReset:!0}}}).fire()}))},[t,c,l,_]),{openLoomRecorder:(0,n.useCallback)(async c=>{if(S.current.initializedLoomSDK&&"active-recording"===S.current.initializedLoomSDK.status().state)return void o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleRecordingAlreadyInProgress),description:e(n).createElement(r("gtD4K").default,a.errorRecordingAlreadyInProgress)});if(l.start({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,attributes:{entryPointLocation:t}}),S.current.isInitializing){o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleNotReady),description:e(n).createElement(r("gtD4K").default,a.errorSDKNotInitialized)}),l.abort({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,reason:"SDK has not been configured yet."});return}if(S.current.isLoomSDKSupportedError){var u;let t="third-party-cookies-disabled"===(u=S.current.isLoomSDKSupportedError)?e(n).createElement(r("gtD4K").default,a.errorThirdPartyCookieDisabled):"no-media-streams-support"===u?e(n).createElement(r("gtD4K").default,{...a.errorNoMediaStreamSupport,values:{a:t=>(0,r("9wGTI").fg)("dst-a11y__replace-anchor-with-link__integrations")?e(n).createElement(r("2Nwuj").default,{href:i,target:"_blank"},t):e(n).createElement("a",{href:i,target:"_blank"},t)}}):"incompatible-browser"===u?e(n).createElement(r("gtD4K").default,{...a.errorIncompatibleBrowser,values:{a:t=>(0,r("9wGTI").fg)("dst-a11y__replace-anchor-with-link__integrations")?e(n).createElement(r("2Nwuj").default,{href:i,target:"_blank"},t):e(n).createElement("a",{href:i,target:"_blank"},t)}}):void 0;o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleCannotStart),description:t}),l.abort({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,reason:`SDK not supported: ${S.current.isLoomSDKSupportedError}.`});return}if(!S.current.hasRecordingAccess){let t=S.current.noRecordingAccessReason;"backendFF"===t?(o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleCannotStart),description:e(n).createElement(r("gtD4K").default,a.errorBackendFFNotEnabledYet)}),l.abort({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,reason:"loom enablement in progress"})):"not-created"===t?(o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleCannotStart),description:e(n).createElement(r("gtD4K").default,a.errorLoomUserNotCreatedYet)}),l.abort({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,reason:"user not created yet"})):"not-mastered"===t||"not-mastered-enterprise"===t?(y(s.NonMasteredUserModalLoader,{isMasteringFlowEnabled:"not-mastered-enterprise"!==t}),l.abort({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,reason:"Does not have access to record looms from Confluence.",attributes:{noRecordingAccessReason:t}})):(o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleCannotStart),description:e(n).createElement(r("gtD4K").default,a.errorUnexpectedAuthTokenFailure)}),l.fail({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,error:S.current.authTokenError||Error("unexpected error from Loom auth token or Loom user status")}));return}if(!S.current.initializedLoomSDK||!S.current.initializedLoomSDK.status().success){o.showInfoFlag({title:e(n).createElement(r("gtD4K").default,a.errorTitleCannotStart),description:e(n).createElement(r("gtD4K").default,a.errorSDKFailedToInitialize)}),l.fail({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,error:S.current.initializedLoomSDKError||Error("Loom SDK did not successfully initialize."),attributes:{loomSDKSuccessStatus:S.current.initializedLoomSDK?.status()?.success}});return}r("cl98v").OPEN_LOOM_RECORDER_SDK_INTERACTION_METRIC.start(),E(!0),_({type:"sendTrackEvent",data:{source:t,action:"opened",actionSubject:"loomSdkRecorder"}}).fire();let{configureButton:d,updateConfig:p}=S.current.initializedLoomSDK,m=d();p({config:{insertButtonText:c?c.insertButtonText:void 0,entryPointName:t}}),c&&m.on("insert-click",async e=>{c.onInsert(e.sharedUrl,e),l.succeed({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,attributes:{inserted:!0}}),_({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:"insertVideoLink",attributes:{insertFunctionWasReset:!1}}}).fire()}),m.on("start",()=>{_({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:"loomRecordingStart"}}).fire()}),m.on("recording-start",()=>{_({type:"sendTrackEvent",data:{source:t,action:"started",actionSubject:"loomRecording"}}).fire()}),m.on("cancel",()=>{_({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:"loomRecordingCancel"}}).fire()}),m.on("complete",()=>{_({type:"sendUIEvent",data:{source:t,action:"clicked",actionSubject:"button",actionSubjectId:"loomRecordingComplete",attributes:{location:c?.location}}}).fire()}),m.on("recording-complete",()=>{_({type:"sendTrackEvent",data:{source:t,action:"completed",actionSubject:"loomRecording",attributes:{location:c?.location}}}).fire()}),m.on("upload-complete",()=>{_({type:"sendTrackEvent",data:{source:t,action:"uploaded",actionSubject:"loomRecording"}}).fire()}),m.on("lifecycle-update",e=>{"pre-recording"===e?(r("cl98v").OPEN_LOOM_RECORDER_SDK_INTERACTION_METRIC.stop(),E(!1)):"closed"===e?(I.current=null,l.succeed({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,attributes:{closed:!0,insertFunctionDefined:void 0!==c}})):"cascaded"===e&&l.succeed({name:r("irVI7").RECORD_LOOM_ENTRY_POINT,attributes:{cascaded:!0,entryPointLocation:t}})}),m.openPreRecordPanel(),I.current=m},[t,l,o,y,_]),isOpeningRecorder:f,isLoomRecorderInitialized:!S.current.isInitializing,hasRecordingAccess:S.current.hasRecordingAccess}}}),o("7dgT3",function(e,t){let o=(0,r("jmjWc").LoadableLazy)({__loadable_id__:"n2Ktr",name:"NonMasteredUserModalLoader",loader:async()=>(await r("g2fKo")).NonMasteredUserModal});e.exports.NonMasteredUserModalLoader=o}),o("g2fKo",function(e,t){let o=r("4mJKd")(5);e.exports=Promise.all([o("hhss7"),o("np2ZB")]).then(()=>r("6i2Ga"))}),o("4mJKd",function(e,t){e.exports=e=>t=>import(r("8tirZ").shardUrl(r("02nRr").resolve(t),e))}),o("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=a,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=o,e.exports.shardUrl=function(e,t){return globalThis[r]?i(e,t):e},e.exports.shardUrlUnchecked=i;let r="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function o(e,t){let r=t+1,o=e.split("").reduce((e,t)=>{let o=(e<<r)-e+t.charCodeAt(0);return o&o},0);return(o%=r)<0&&(o+=r),o}let n=/-\d+$/;function s(e){if(!n.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function a(e,t){let r=e.indexOf("."),o=0===t?"":`-${t-1}`;if(-1===r)return`${s(e)}${o}`;let n=s(e.slice(0,r));return`${n}${o}${e.slice(r)}`}function i(e,t){let r=new URL(e),n=o(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(r.pathname),t);return r.hostname=a(r.hostname,n),r.toString()}e.exports.domainShardingKey=r}),o("02nRr",function(e,r){t(e.exports,"register",()=>o,e=>o=e),t(e.exports,"resolve",()=>n,e=>n=e);var o,n,s=new Map;o=function(e,t){for(var r=0;r<t.length-1;r+=2)s.set(t[r],{baseUrl:e,path:t[r+1]})},n=function(e){var t=s.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),o("cl98v",function(e,t){let o=(0,r("lSOAM").createInteractionMetric)({key:r("jIOyV").OPEN_LOOM_RECORDER_SDK_INTERACTION}),n=(0,r("lSOAM").createInteractionMetric)({key:r("jIOyV").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION});e.exports.OPEN_LOOM_RECORDER_SDK_INTERACTION_METRIC=o,e.exports.INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC=n}),o("jHGaM",function(e,t){let o=(0,r("1P1Tu").createStore)({initialState:{isInitializing:!0,initializedLoomSDK:null,_hasLoomSDKInitializationStarted:!1,hasRecordingAccess:!1,noRecordingAccessReason:void 0,authTokenError:void 0,isLoomSDKSupportedError:void 0,initializedLoomSDKError:null},actions:{initLoomSDK:({cloudId:e,environment:t,entryPointLocation:o})=>async({getState:n,setState:s})=>{if(n().initializedLoomSDK||n()._hasLoomSDKInitializationStarted)return;s({_hasLoomSDKInitializationStarted:!0}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.start();try{let{isSupported:e}=await r("aWuvK"),{supported:t,error:o}=await e();if(!t){s({isLoomSDKSupportedError:o,isInitializing:!1}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.cancel();return}}catch{s({isLoomSDKSupportedError:"incompatible-browser",isInitializing:!1}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.cancel();return}let{recorderToken:a,tokenError:i}=await (0,r("3d6VZ").getAuthToken)();if(!a||i){s({isInitializing:!1,noRecordingAccessReason:await (0,r("38NxZ").getNoRecordingAccessReason)(i),authTokenError:i}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.cancel();return}s({hasRecordingAccess:!0});try{let{createInstance:n}=await r("5a9y3"),i=await n((0,r("gmNpb").getLoomInstanceDataByEnvironment)({environment:t,jws:a,siteId:e,entryPointName:o}));s({initializedLoomSDK:i,isInitializing:!1}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.stop()}catch(e){s({isInitializing:!1,initializedLoomSDKError:e}),r("cl98v").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.cancel()}}},name:"loomEntryPointGlobalStateStore"}),n=(0,r("9zUhf").createHook)(o);e.exports.useLoomEntryPointGlobalState=n}),o("3d6VZ",function(e,t){let o=async()=>{try{let e=await (0,r("hp2SH").getApolloClient)().query({query:r("e01Lp").LoomAuthTokenQuery,fetchPolicy:"network-only"});return{recorderToken:e.data.loomToken?.token}}catch(e){return(0,r("5ZqQS").getMonitoringClient)().submitError(e,{attribution:r("3IBnw").Attribution.CONTENT_TYPES}),(0,r("7Sm4c").markErrorAsHandled)(e),{tokenError:e}}},n=async()=>{try{return(await (0,r("hp2SH").getApolloClient)().query({query:r("55UbZ").LoomAuthStateQuery})).data.loomUserStatus}catch(e){(0,r("5ZqQS").getMonitoringClient)().submitError(e,{attribution:r("3IBnw").Attribution.CONTENT_TYPES}),(0,r("7Sm4c").markErrorAsHandled)(e);return}};e.exports.getAuthToken=o,e.exports.getAuthState=n}),o("e01Lp",function(e,t){let o=(0,r("eSUdr").default)`query LoomAuthTokenQuery{loomToken{token}}`;e.exports.LoomAuthTokenQuery=o}),o("55UbZ",function(e,t){let o=(0,r("eSUdr").default)`query LoomAuthStateQuery{loomUserStatus}`;e.exports.LoomAuthStateQuery=o}),o("gmNpb",function(e,t){let r={noBackend:"a3f31403-5892-4b68-baf9-a8b1c1f9ef80",staging:"811e05d4-b0aa-4ec9-80e4-68cf5e924102",production:{development:"dba4f6db-8419-44f6-ac25-32b6fc352747",userFacing:"8e345daf-482a-4abf-a612-cb6457110817"}};e.exports.getLoomInstanceDataByEnvironment=({environment:e,jws:t,siteId:o,entryPointName:n})=>{let s={jws:t,siteId:o,config:{enableNewUi:!0,productName:"Confluence",entryPointName:n}};return"DEVELOPMENT"===e?{...s,mode:"standard",publicAppId:r.noBackend,environment:"production"}:"STAGING"===e?{...s,mode:"first-party",publicAppId:r.staging,environment:"staging"}:{...s,mode:"first-party",publicAppId:r.production.userFacing,environment:"production"}}}),o("38NxZ",function(e,t){let o=(e,t)=>!!e&&"graphQLErrors"in e&&e.graphQLErrors?.some(({message:e})=>e.includes(t)),n=async e=>{if(o(e,"Attempted to fetch Loom token without feature flag enabled"))return"backendFF";if(o(e,"Failed to fetch loom auth token. Status code: 404")){let e=await (0,r("3d6VZ").getAuthState)();if(e===r("dn8bs").LoomUserStatus.NOT_FOUND)return"not-created";if(e===r("dn8bs").LoomUserStatus.LINKED)return"not-mastered";if(e===r("dn8bs").LoomUserStatus.LINKED_ENTERPRISE)return"not-mastered-enterprise"}return"unexpected"};e.exports.getNoRecordingAccessReason=n}),o("dn8bs",function(e,t){var r,o=((r={}).LINKED="LINKED",r.LINKED_ENTERPRISE="LINKED_ENTERPRISE",r.MASTERED="MASTERED",r.NOT_FOUND="NOT_FOUND",r);e.exports.LoomUserStatus=o}),o("aWuvK",function(e,t){let o=r("4mJKd")(5);e.exports=Promise.all([o("lwKXH"),o("4byV5")]).then(()=>r("3f9PV"))}),o("5a9y3",function(e,t){let o=r("4mJKd")(5);e.exports=Promise.all([o("lkOIY"),o("jSdjl"),o("l2EUC"),o("kWZnd"),o("92LGf"),o("6wr18"),o("a3Uq6"),o("xvDzM"),o("jle6Z"),o("4drdS"),o("lLK0D"),o("9LQGG"),o("wIOhQ"),o("lwKXH"),o("fisfU"),o("ffEVr"),o("7EorR"),o("btYwu")]).then(()=>r("fIeud"))}),o("8Q0mA",function(t,o){var n=r("42omo");let s="crossJoin",a=(0,r("cgtv4").defineMessages)({crossJoinCTA:{id:"loom-utils.loom-cross-sell-popup-card.crossJoinCTA",defaultMessage:"Try now"},requestAccessSuccessFlagTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-success-flag.title",defaultMessage:"Your admins were notified of your request"},requestAccessSuccessFlagDescription:{id:"loom-utils.loom-cross-join-popup-card.request-access-success-flag.description",defaultMessage:"You’ll receive an email once they’ve approved it."},requestAccessErrorFlagTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.title",defaultMessage:"We couldn't add you to Loom"},requestAccessErrorFlagDescription:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.description",defaultMessage:"Try again in a few minutes. If you still aren't able to join, "},requestAccessErrorFlagActionTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.action.title",defaultMessage:"contact support"}});t.exports.LoomCrossJoinPopupCard=({description:t,entryPointId:o,placement:i,shouldRenderToParent:c,sourceActionSubjectId:l,sourceComponent:u,title:d,triggerLink:p,flags:m})=>{let{createAnalyticsEvent:g}=(0,r("inPa6").useAnalyticsEvents)(),f=(0,r("8C5kA").default)(),E=(0,r("f5Ulo").useLoomCrossJoinUrl)(),I=(0,n.useContext)(r("1kHsc").ExperienceTrackerContext),{stopPulse:S}=(0,r("aFmsO").useDiscoverabilityPulseActions)(),{stopPostOffice:y}=(0,r("jHpN3").useDiscoverabilityPulseActions)(),_=(0,r("erVVf").useStreamliningCrossJoin)({entryPointId:o,flags:m,source:"loomCrossJoinPopupCard",sourceAdType:s,sourceComponent:u}),T=(0,n.useCallback)(()=>{if((0,r("9wGTI").fg)("confluence_loom_x-sell_ep_po_migration"))return void y();S()},[y,S]),b=(0,n.useCallback)(()=>{T(),I.succeed({name:r("irVI7").LOOM_CROSS_SELL_EXPERIENCE,attributes:{sourceComponent:o,adType:s}})},[o,I,T]),R=(0,n.useCallback)(async()=>{(0,r("9wGTI").fg)("twcg-1241_streamlining_loom_cross_join_gate")&&await _(),g({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"tryNow",source:"loomCrossJoinPopupCard",attributes:{adType:s,entrypoint:o,sourceComponent:u}}}).fire(),b()},[g,o,b,u,_]),C=(0,n.useCallback)(async()=>{(0,r("9wGTI").fg)("twcg-1241_streamlining_loom_cross_join_gate")&&await _(),g({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:l,source:l,attributes:{adType:s,entrypoint:o,sourceComponent:u}}}).fire(),b()},[g,o,b,l,u,_]);return e(n).createElement(r("cnQgR").BaseLoomPopupCard,{actions:(0,r("9wGTI").fg)("twcg-1241_streamlining_loom_cross_join_gate")?e(n).createElement(r("ccHMk").default,{appearance:"discovery",onClick:R},f.formatMessage(a.crossJoinCTA)):e(n).createElement(r("7p4As").default,{appearance:"discovery",href:E,onClick:R,rel:"noreferrer",target:"_blank"},f.formatMessage(a.crossJoinCTA)),description:t,entryPointId:o,placement:i,shouldRenderToParent:c,title:d,trigger:e=>p((0,r("9wGTI").fg)("twcg-1241_streamlining_loom_cross_join_gate")?"":E,{...e,onClick:C}),sourceAdType:s,sourceComponent:u})}}),o("aFmsO",function(e,t){var o=r("42omo");e.exports.useDiscoverabilityPulseActions=()=>{let e=(0,r("lwNi3").useCoordinationClient)(),{stop:t}=(0,r("gd8AW").useDiscoverabilityPulseActions)();return{stopPulse:(0,o.useCallback)(()=>{(0,r("9wGTI").fg)("confluence_frontend_loom_discoverability_pulse")&&t(e)},[e,t])}},e.exports.useDiscoverabilityPulse=e=>{let t=(0,r("lwNi3").useCoordinationClient)(),{start:n}=(0,r("gd8AW").useDiscoverabilityPulseActions)(),s=(0,r("gd8AW").useIsPulseActive)(e),a=s||(0,r("gd8AW").havePulsesEnded)();return(0,o.useEffect)(()=>{if(a||!(0,r("9wGTI").fg)("confluence_frontend_loom_discoverability_pulse"))return;let o=async r=>{let o=!!await t.start(r);return o&&n(e,r),o};(async()=>{!(await o("cc-loom-x-sell-discoverability-pulse-1")||await o("cc-loom-x-sell-discoverability-pulse-2")||await o("cc-loom-x-sell-discoverability-pulse-3"))&&!await o("cc-loom-x-sell-discoverability-pulse-4")&&await o("cc-loom-x-sell-discoverability-pulse-5")&&((0,r("gd8AW").endPulses)(),t.stop("cc-loom-x-sell-discoverability-pulse-5"))})()},[t,e,a,n]),{isPulseActive:s&&(0,r("9wGTI").fg)("confluence_frontend_loom_discoverability_pulse")}}}),o("gd8AW",function(e,t){let o=()=>!!r("17wUi").confluenceLocalStorageInstance.getItem(r("1UApO").PERSISTED_KEYS_ON_SERVER.PERSISTED_LOOM_CROSS_SELL_DISCOVERABILITY_PULSES_HAVE_ENDED),n=()=>r("17wUi").confluenceLocalStorageInstance.setItem(r("1UApO").PERSISTED_KEYS_ON_SERVER.PERSISTED_LOOM_CROSS_SELL_DISCOVERABILITY_PULSES_HAVE_ENDED,!0),s=(0,r("1P1Tu").createStore)({initialState:{entryPointId:null,messageId:null},actions:{start:(e,t)=>({setState:r})=>{r({entryPointId:e,messageId:t})},stop:e=>({getState:t,setState:r})=>{let{messageId:s}=t();s&&e.stop(s),o()||n(),r({entryPointId:null,messageId:null})}},name:"LoomEntryPointsDiscoverabilityPulse"}),a=(0,r("9zUhf").createStateHook)(s,{selector:(e,t)=>e.entryPointId===t}),i=(0,r("9zUhf").createActionsHook)(s);e.exports.havePulsesEnded=o,e.exports.endPulses=n,e.exports.useIsPulseActive=a,e.exports.useDiscoverabilityPulseActions=i}),o("jHpN3",function(e,t){let o=()=>!!r("17wUi").confluenceLocalStorageInstance.getItem(r("1UApO").PERSISTED_KEYS_ON_SERVER.PERSISTED_LOOM_CROSS_SELL_DISCOVERABILITY_PULSES_HAVE_ENDED),n=()=>r("17wUi").confluenceLocalStorageInstance.setItem(r("1UApO").PERSISTED_KEYS_ON_SERVER.PERSISTED_LOOM_CROSS_SELL_DISCOVERABILITY_PULSES_HAVE_ENDED,!0),s=(0,r("1P1Tu").createStore)({initialState:{activeMessageId:null,entryPointIds:[],clickTrackingHandler:null,dismissHandler:null,wasDismissedByUser:!1},actions:{start:(e,t,r)=>({getState:o,setState:n})=>{let s=o(),a=s.activeMessageId!==t?{activeMessageId:t,entryPointIds:[e],clickTrackingHandler:r?.onClick??null,dismissHandler:r?.onDismiss??null,wasDismissedByUser:!1}:{activeMessageId:t,entryPointIds:s.entryPointIds.includes(e)?s.entryPointIds:[...s.entryPointIds,e],clickTrackingHandler:r?.onClick??s.clickTrackingHandler,dismissHandler:r?.onDismiss??s.dismissHandler,wasDismissedByUser:!1},i=a.entryPointIds!==s.entryPointIds,c=a.clickTrackingHandler!==s.clickTrackingHandler,l=a.dismissHandler!==s.dismissHandler,u=a.activeMessageId!==s.activeMessageId,d=s.wasDismissedByUser;(i||c||l||u||d)&&n(a)},stopPostOffice:()=>({getState:e,setState:t})=>{let r=e();r.clickTrackingHandler?.(),r.dismissHandler?.(),o()||n(),null===r.activeMessageId&&0===r.entryPointIds.length&&null===r.dismissHandler&&null===r.clickTrackingHandler&&r.wasDismissedByUser||t({activeMessageId:null,entryPointIds:[],clickTrackingHandler:null,dismissHandler:null,wasDismissedByUser:!0})}},name:"LoomEntryPointsDiscoverabilityPulse"}),a=(0,r("9zUhf").createStateHook)(s,{selector:(e,t)=>e.entryPointIds.includes(t)&&!e.wasDismissedByUser}),i=(0,r("9zUhf").createActionsHook)(s);e.exports.havePulsesEnded=o,e.exports.endPulses=n,e.exports.useIsPulseActive=a,e.exports.useDiscoverabilityPulseActions=i}),o("erVVf",function(t,o){var n=r("42omo");let s=(0,r("cgtv4").defineMessages)({requestAccessSuccessFlagTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-success-flag.title",defaultMessage:"Your admins were notified of your request"},requestAccessSuccessFlagDescription:{id:"loom-utils.loom-cross-join-popup-card.request-access-success-flag.description",defaultMessage:"You’ll receive an email once they’ve approved it."},requestAccessErrorFlagTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.title",defaultMessage:"We couldn't add you to Loom"},requestAccessErrorFlagDescription:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.description",defaultMessage:"Try again in a few minutes. If you still aren't able to join, "},requestAccessErrorFlagActionTitle:{id:"loom-utils.loom-cross-join-popup-card.request-access-error-flag.action.title",defaultMessage:"contact support"}});t.exports.useStreamliningCrossJoin=({entryPointId:t,flags:o,source:a,sourceAdType:i,sourceComponent:c})=>{let l=(0,r("8C5kA").default)(),u=(0,r("f5Ulo").useLoomCrossJoinUrl)(),{createAnalyticsEvent:d}=(0,r("inPa6").useAnalyticsEvents)(),p=(0,r("64hvi").useRequestAccessService)({entryPointId:t,source:a,sourceAdType:i}),m=(0,r("64hvi").useFetchRequestAccessCapability)({entryPointId:t,source:a,sourceAdType:i});return(0,n.useCallback)(async()=>{if("REQUEST_ACCESS"===await m()&&["control","variation"].includes((0,r("6mKj3").expVal)("twcg-1241_streamlining_loom_cross_join","cohort","not-enrolled"))&&(d({type:"sendTrackEvent",data:{action:"exposed",actionSubject:"feature",source:a,attributes:{adType:i,entrypoint:t,flagKey:"twcg-1241_streamlining_loom_cross_join",cohort:(0,r("6mKj3").expVal)("twcg-1241_streamlining_loom_cross_join","cohort","not-enrolled")}}}).fire(),(0,r("6mKj3").expValEquals)("twcg-1241_streamlining_loom_cross_join","cohort","variation")))try{if(await p()){o&&o.showSuccessFlag({title:l.formatMessage(s.requestAccessSuccessFlagTitle),description:l.formatMessage(s.requestAccessSuccessFlagDescription)});return}}catch(u){d({type:"sendTrackEvent",data:{action:"failed",actionSubject:"requestAccess",source:a,attributes:{adType:i,entrypoint:t,sourceComponent:c,error:u instanceof Error?u.message:"unknown"}}}).fire(),o&&o.showErrorFlag({title:l.formatMessage(s.requestAccessErrorFlagTitle),description:e(n).createElement(e(n).Fragment,null,e(n).createElement("span",null,l.formatMessage(s.requestAccessErrorFlagDescription)),e(n).createElement(r("7p4As").default,{href:"https://support.atlassian.com/contact",target:"_blank",rel:"noreferrer"},l.formatMessage(s.requestAccessErrorFlagActionTitle)))})}window&&window.open(u,"_blank")},[d,u,t,m,o,l,p,a,i,c])}}),o("f5Ulo",function(e,t){let o={DEVELOPMENT:"dev",STAGING:"stg",PRODUCTION:"prod"};e.exports.useLoomCrossJoinUrl=()=>{let{cloudId:e,environment:t}=(0,r("bQm3c").useSessionData)(),n=(0,r("dedJV").getATLContextDomain)("id",[o[t],"commercial"]),s=`ari:cloud:loom::site/${e}`,a=encodeURIComponent(`https://${n}/join/user-access?resource=${s}&continue=${"PRODUCTION"===t?"https://loom.com/api/auth/atlassian":"https://stage.loom.com/api/auth/atlassian"}`);return`https://${n}/login?continue=${a}`}}),o("64hvi",function(e,t){var o=r("42omo");let n=async e=>{let{url:t,...o}=e;return(await (0,r("f7B1p").cfetch)(t,o)).json()};e.exports.useRequestAccessService=({entryPointId:e,source:t,sourceAdType:s})=>{let{createAnalyticsEvent:a}=(0,r("inPa6").useAnalyticsEvents)(),{cloudId:i,userId:c}=(0,r("bQm3c").useSessionData)(),l=(0,o.useMemo)(()=>({createAnalyticsEvent:({type:e,data:r})=>a({type:e,data:{source:t,...r}}),fetchJSON:n,getCurrentCloudId:()=>i,getCurrentUserId:()=>c??"",getCurrentProduct:()=>"confluence"}),[a,i,t,c]),u=(0,r("hCOLa").useService)(r("fNwcJ").requestAccess,l);return(0,o.useCallback)(async()=>{try{let{result:r=""}=await u({product:"loom",integration:e}),o="PENDING_REQUEST_CREATED"===r;return a({type:"sendOperationalEvent",data:{action:"succeeded",actionSubject:"fetch",actionSubjectId:"requestAccess",source:t,attributes:{adType:s,entrypoint:e,result:r,success:o}}}).fire(),o}catch(r){throw a({type:"sendOperationalEvent",data:{action:"failed",actionSubject:"fetch",actionSubjectId:"requestAccess",source:t,attributes:{adType:s,entrypoint:e,error:r instanceof Error?r.message:"unknown",result:void 0,success:!1}}}).fire(),r}},[e,u,t,s,a])},e.exports.useFetchRequestAccessCapability=({entryPointId:e,source:t,sourceAdType:s})=>{let{createAnalyticsEvent:a}=(0,r("inPa6").useAnalyticsEvents)(),{cloudId:i}=(0,r("bQm3c").useSessionData)();return(0,o.useCallback)(async()=>{let r=`ari:cloud:loom::site/${i}`;try{let o=new URLSearchParams({resource:r}),i=`/gateway/api/invitations/v1/access-requests/capabilities?${o.toString()}`,c=await n({url:i});return a({type:"sendOperationalEvent",data:{action:"succeeded",actionSubject:"fetch",actionSubjectId:"requestAccessCapability",source:t,attributes:{adType:s,entrypoint:e,resource:r}}}).fire(),c.results[r]||void 0}catch(o){a({type:"sendOperationalEvent",data:{action:"failed",actionSubject:"fetch",actionSubjectId:"requestAccessCapability",source:t,attributes:{adType:s,entrypoint:e,error:o instanceof Error?o.message:"unknown",resource:r}}}).fire()}},[i,a,e,t,s])}}),o("fNwcJ",function(e,t){let o=Object.assign(n,{dependencies:{fetchJSON:r("bmTr3").fetchJSON,createAnalyticsEvent:r("2Q94g").createAnalyticsEvent,getStargateURL:r("2Q94g").getStargateURL,getCurrentUserId:r("2Q94g").getCurrentUserId,getCurrentCloudId:r("2Q94g").getCurrentCloudId,getCurrentProduct:r("2Q94g").getCurrentProduct}});async function n(e,t){let o,n=t.dependencies(),s=e.cloudId??n.getCurrentCloudId(),a=n.getCurrentUserId(),i=`ari:cloud:${e.product}::site/${s}`;try{var c,l;c=await n.fetchJSON({url:n.getStargateURL("/invitations/v1/access-requests/request"),method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource:i})}),l={resource:i,userId:a,...e},o={error:null,result:c.results[l.resource],...l}}catch(t){o={error:(0,r("7DBey").toError)(t),...e,result:null,resource:i,userId:a}}return function({error:e,product:t,result:r},o){if(!e){var n;let e=o.dependencies().getCurrentUserId(),s={userAaid:e,actorAaid:e,roleName:"product/member",inviteStatus:r,sourceProduct:o.dependencies().getCurrentProduct(),sourceTenantId:o.dependencies().getCurrentCloudId(),product:t};"ACCESS_GRANTED"===r?function({userUuid:e,userAaid:t,roleName:r,sourceTenantId:o,sourceProduct:n,recommendationSources:s,product:a},i){i.dependencies().createAnalyticsEvent({type:"sendTrackEvent",data:{actionSubject:"product",action:"joined",actionSujectId:a,attributes:{userUuid:e,userAaid:t,roleName:r,sourceTenantId:o,sourceProduct:n,recommendationSources:s,product:a}}}).fire()}(s,o):(n=s,o.dependencies().createAnalyticsEvent({type:"sendTrackEvent",data:{actionSubject:"productAccess",action:"requested",actionSujectId:n.userAaid,attributes:n}}).fire())}}({...e,...o},t),o}e.exports.requestAccess=o}),o("cnQgR",function(t,o){var n=r("42omo"),s=r("2fvAC");let a=(0,r("ecnYn").xcss)({borderRadius:"radius.small",overflow:"auto",width:"352px"}),i=(0,r("ecnYn").xcss)({padding:"space.300"}),c=(0,r("ecnYn").xcss)({height:"201px"});t.exports.BaseLoomPopupCard=({actions:t,description:o,entryPointId:l,placement:u,shouldRenderToParent:d=!0,title:p,trigger:m,sourceAdType:g,sourceComponent:f})=>{let{createAnalyticsEvent:E}=(0,r("inPa6").useAnalyticsEvents)(),[I,S]=(0,n.useState)(!1),y=(0,n.useRef)(!1),_=(0,n.useRef)(null),T=(0,n.useRef)(null),b=(0,n.useRef)(null),R=(0,n.useRef)(null),C=(0,n.useRef)(!1),A=(0,n.useCallback)(()=>{_.current&&(clearTimeout(_.current),_.current=null)},[]),O=(0,n.useCallback)(()=>{T.current&&(clearTimeout(T.current),T.current=null)},[]),h=(0,n.useContext)(r("1kHsc").ExperienceTrackerContext);(0,n.useEffect)(()=>{I&&h.start({name:r("irVI7").LOOM_CROSS_SELL_EXPERIENCE,attributes:{sourceComponent:l,adType:g}})},[l,h,I,g]);let L=(0,n.useCallback)(()=>{S(!1),h.abort({name:r("irVI7").LOOM_CROSS_SELL_EXPERIENCE,reason:"Loom pop up closed",attributes:{sourceComponent:l,adType:g}}),C.current=!0,setTimeout(()=>{C.current=!1},0)},[l,h,g]),D=(0,n.useCallback)(()=>{O(),_.current||(_.current=setTimeout(()=>{L(),_.current=null},400))},[O,L]),v=(0,n.useCallback)(()=>{A(),y.current||(y.current=!0,new Image().src=e(s)),T.current||(T.current=setTimeout(()=>{E({type:"sendScreenEvent",data:{name:"loomAdPopupCard",attributes:{adType:g,entrypoint:l,sourceComponent:f}}}).fire(),S(!0),T.current=null},400))},[A,E,l,g,f]),P=(0,n.useCallback)(()=>{O()},[O]),N=(0,n.useCallback)(()=>{C.current||v()},[v]),w=(0,n.useCallback)(()=>{v()},[v]),k=(0,n.useCallback)(()=>{A()},[A]),M=(0,n.useCallback)(()=>{b.current?.contains(document.activeElement)||document.activeElement===R.current||D()},[D]);return e(n).createElement(r("lGgRw").default,{autoFocus:!1,content:()=>e(n).createElement(r("6f0Oj").default,{onMouseEnter:k,onMouseLeave:M,ref:b,xcss:a},e(n).createElement(r("6f0Oj").default,{xcss:c},e(n).createElement(r("gj7hi").default,{alt:"",height:"201px",width:"352px",src:e(s)})),e(n).createElement(r("1GzhS").default,{space:"space.300",xcss:i},e(n).createElement(r("1GzhS").default,{space:"space.100"},e(n).createElement(r("7hXDW").default,{as:"h2",size:"small"},p),e(n).createElement(r("5dK2X").default,{as:"p",color:"color.text.subtle"},o)),e(n).createElement(r("dcJ7R").default,{alignBlock:"center",spread:"space-between"},e(n).createElement(r("lAFHW").LoomAttributionLogo,{appearance:"brand",size:"medium"}),t))),isOpen:I,label:p,onClose:L,placement:u||"auto",role:"dialog",shouldRenderToParent:d,trigger:e=>m({...e,isSelected:I,onBlur:P,onFocus:N,onMouseEnter:w,onMouseLeave:M,ref:(0,r("4rwCt").mergeRefs)([e.ref,R])})})}}),o("2fvAC",function(e,t){e.exports=new URL("LoomCrossSellPopupCardImage.6e60c328.png",import.meta.url).toString()});
//# sourceMappingURL=CommentEditor.6b4e152c.js.map
