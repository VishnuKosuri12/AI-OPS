function e(e){return e&&e.__esModule?e.default:e}function t(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var n=globalThis.parcelRequired477,r=n.register;r("aT8im",function(e,t){var r=n("j1Ss3"),a=n("42omo");let i="growth-luna-edition-awareness-standard-to-premium:treatmentPillDismissed",o=(0,n("eSUdr").default)`query useConfluenceStandardToPremiumExperimentQuery($key:[String]){isSiteAdmin onboardingState(key:$key){key value}license{trialEndDate firstPredunningEndTime}}`;e.exports.EDITION_AWARENESS_STANDARD_TO_PREMIUM_EXPERIMENT_PILL_DISMISSED=i,e.exports.useConfluenceStandardToPremiumExperimentQuery=o,e.exports.useConfluenceStandardToPremiumExperiment=()=>{let{data:e,error:t,loading:s}=(0,r.useQuery)(o,{variables:{key:i},fetchPolicy:"cache-only"}),{edition:l,cloudId:d}=(0,n("bQm3c").useSessionData)(),{createAnalyticsEvent:u}=(0,n("inPa6").useAnalyticsEvents)(),{setOnboardingState:c}=(0,n("ivb8S").useSetOnboardingState)(),m=(0,a.useCallback)(()=>{c({key:i,value:"true"})},[c]);t&&!(0,n("7Sm4c").isErrorMarkedAsHandled)(t)&&(u({type:"sendTrackEvent",data:{action:"failed",actionSubject:"ea-standard-to-premium-query",source:"useConfluenceStandardToPremiumExperiment",attributes:{growthFeature:"EditionAwareness",error:t.message}}}).fire(),(0,n("7Sm4c").markErrorAsHandled)(t));let p=(0,n("6mKj3").UNSAFE_expValEqualsNoExposure)("edition_awareness_standard_upsell_confluence_ab","cohort","control")||(0,n("6mKj3").UNSAFE_expValEqualsNoExposure)("edition_awareness_standard_upsell_confluence_ab","cohort","treatment"),f=e?.isSiteAdmin,g=l?.toLocaleLowerCase(),S=(0,n("1o4fX").getTrialDaysLeftFromTrialEndDate)(e?.license?.trialEndDate),E=!e||s||t?void 0:!!S&&S>0,h=e?.license?.firstPredunningEndTime,x=!!h&&Date.now()<h,{treatmentPillDismissed:P}=(0,n("ivb8S").deserializeState)(e?.onboardingState?{onboardingState:e?.onboardingState}:null);return{isEligibleForUpsellExperiment:p&&"standard"===g&&!1===E&&!x&&!!f,cloudId:d,product:"confluence",edition:g,userRoles:f?["SITE_ADMIN"]:[],hasDismissedButton:s||!!t||!!P,onDismissButton:m}}}),r("c5zvz",function(r,a){t(r.exports,"useConfluenceStandardToPremiumPUBTouchpoint",()=>n("fBwOr").useConfluenceStandardToPremiumPUBTouchpoint),t(r.exports,"StandardToPremiumModalMountComponent",()=>n("5DQLv").StandardToPremiumModalMountComponent);var i=n("42omo"),o=n("aJv6Q");n("fBwOr"),n("5DQLv");let s=(0,i.forwardRef)(({as:t="div",style:r,...a},o)=>e(i).createElement(t,{...a,style:r,ref:o,className:(0,n("gMc0m").default)(["_1e0cglyw _1ydi18uv",a.className])})),l=(0,n("jmjWc").LoadableAfterPaint)({__loadable_id__:"IlAy6",name:"EditionAwarenessUpsellLoadable",loader:async()=>(await n("0SQe8")).EditionAwarenessUpsell}),d=(0,o.withTransparentErrorBoundary)({attribution:n("3IBnw").Attribution.GROWTH_LUNA})(({navVersion:t})=>e(i).createElement(n("5izcQ").default,{name:"edition-awareness"},e(i).createElement(s,null,e(i).createElement(l,{navVersion:t}))));r.exports.EditionAwarenessUpsellExperiment=d}),r("fBwOr",function(t,r){var a=n("42omo"),i=n("hSqtY");let o=(0,n("cgtv4").defineMessages)({persistentUpgradeMenuItemFreePlanTitle:{id:"experiment-edition-awareness-for-standard-to-premium.section.message.persistent-upgrade.menuitem.premiumplan.title",defaultMessage:"Upgrade"}});t.exports.useConfluenceStandardToPremiumPUBTouchpoint=t=>{let[r,s]=(0,a.useState)(!1),{cloudId:l,isEligibleForUpsellExperiment:d,hasDismissedButton:u}=(0,n("aT8im").useConfluenceStandardToPremiumExperiment)(),{createAnalyticsEvent:c}=(0,n("inPa6").useAnalyticsEvents)(),{showModal:m,setModalProps:p}=(0,n("99oLS").useConfluenceStandardToPremiumModalActions)(),f=d&&u,{data:g,error:S,loading:E}=(0,n("xQxzY").useQuery)((0,n("eSUdr").default)`query useConfluenceStandardToPremiumPUBTouchpointconfluenceEditionAwarenessQuery($cloudId:ID!$productKey:String!$trialOfferingName:String!){tenantContexts(cloudIds:[$cloudId])@optIn(to:["CcpAllUserUpgradeAndPay" "HamsAllUserUpgradeAndPay"]){entitlementInfo(hamsProductKey:$productKey){paidEntitlement:entitlement(where:{inTrialOrPreDunning:false}){experienceCapabilities{changeOfferingV2(offeringName:$trialOfferingName){experienceUrl}}}}}}`,{client:(0,n("gKr8t").getAGGClient)(),variables:{cloudId:l,productKey:"confluence",trialOfferingName:"Premium"},skip:!f});S&&!(0,n("7Sm4c").isErrorMarkedAsHandled)(S)&&(c({type:"sendTrackEvent",data:{action:"failed",actionSubject:"persistent-upgrade-button-standard-to-premium",source:"useConfluenceStandardToPremiumPUBTouchpoint",attributes:{growthFeature:"EditionAwareness",navVersion:t,error:S.message}}}).fire(),(0,n("7Sm4c").markErrorAsHandled)(S));let h=f&&!r,x=g?.tenantContexts?.[0]?.entitlementInfo?.paidEntitlement?.experienceCapabilities?.changeOfferingV2?.experienceUrl;!E&&h&&(!x||x?.includes("admin/billing"))&&c({type:"sendUIEvent",data:{action:"error",actionSubject:"dialog",actionSubjectId:"editionAwarenessStandardToPremiumDialog",attributes:{product:"confluence",touchpointIntent:"startTrial",dialogId:"standard-to-premium",dialogType:"modal",error:"No change offering URL found for premium upgrade - using fallback",navVersion:t,changeOfferingUrl:x??"",isEligibleForStandardToPremiumPersistentUpgradeButton:h},source:"useConfluenceStandardToPremiumPUBTouchpoint"}}).fire();let P=(0,n("hxSIT").useBuildLearnMoreLink)(x),b=(0,a.useCallback)(()=>{c({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"persistent-upgrade-button-standard-to-premium",attributes:{growthFeature:"EditionAwareness",navVersion:t},source:"useConfluenceStandardToPremiumPUBTouchpoint"}}).fire(),p({experienceUrl:x??"",learnMoreUrl:P,navVersion:t}),m({touchpointId:"edition-awareness-standard-to-premium-pub"})},[c,m,p,x,P,t]);return!h||E||S?[]:[{heading:{...o.persistentUpgradeMenuItemFreePlanTitle},items:[{action:()=>b(),content:e(a).createElement(i.TransparentErrorBoundary,{attribution:n("3IBnw").Attribution.GROWTH_LUNA,onError:()=>s(!0)},e(a).createElement(n("50xoH").EditionAwarenessStandardPubTouchpoint,{product:"confluence",testId:"edition-awareness-standard-pub-touchpoint",navVersion:t})),key:"try-premium-plan"}]}]}}),r("50xoH",function(e,t){var r=n("l998X"),a=n("42omo");let i=(0,n("cgtv4").defineMessages)({persistentUpgradeMenuItemStandardToPremiumPlanLabelExperiment:{id:"persistent-upgrade.trial-plan-comparison.section.message.persistent-upgrade.menuitem.freeplan.label",defaultMessage:"Try the Premium plan"},persistentUpgradeMenuItemStandardToPremiumPlanLozengeExperiment:{id:"persistent-upgrade.trial-plan-comparison.section.message.persistent-upgrade.menuitem.freeplan.lozenge",defaultMessage:"FREE 30-DAY TRIAL"}}),o=(0,n("ecnYn").xcss)({display:"flex",flexWrap:"nowrap"}),s=(0,n("ecnYn").xcss)({marginTop:"space.0",marginRight:"space.0",marginBottom:"space.0",marginLeft:"space.100"});function l({product:e,testId:t,navVersion:l}){let{createAnalyticsEvent:d}=(0,n("inPa6").useAnalyticsEvents)();return(0,a.useEffect)(()=>{d({type:"sendScreenEvent",data:{name:"editionAwarenessStandardToPremiumPUB",attributes:{source:"EditionAwarenessStandardPubTouchpoint",product:e,navVersion:l}}}).fire()},[d,e,l]),(0,r.jsxs)(n("bUlM5").default,{xcss:o,testId:t,children:[(0,r.jsx)(n("gtD4K").default,{...i.persistentUpgradeMenuItemStandardToPremiumPlanLabelExperiment}),(0,r.jsx)(n("6f0Oj").default,{xcss:s,children:(0,r.jsx)(n("5nBzc").default,{appearance:"new",children:(0,r.jsx)(n("gtD4K").default,{...i.persistentUpgradeMenuItemStandardToPremiumPlanLozengeExperiment})})})]})}e.exports.EditionAwarenessStandardPubTouchpoint=function(e){let{product:t,navVersion:i}=e,{createAnalyticsEvent:o}=(0,n("inPa6").useAnalyticsEvents)(),s=(0,a.useCallback)(e=>{o({eventType:"operational",action:"failed",actionSubject:"@atlassian/edition-awareness.edition-awareness",source:"unknownErrorSource",attributes:{product:t,edition:"standard",navVersion:i,error:e.message}}).fire()},[o,t,i]);return(0,r.jsx)(n("lAJUP").ErrorBoundary,{fallback:(0,r.jsx)(r.Fragment,{}),onError:s,children:(0,r.jsx)(l,{...e})})}}),r("99oLS",function(e,t){let r=(0,n("1P1Tu").createStore)({initialState:{isOpen:!1,learnMoreUrl:"",experienceUrl:"",navVersion:void 0},actions:{showModal:({touchpointId:e})=>({setState:t})=>{t({isOpen:!0,touchpointId:e})},closeModal:()=>({setState:e})=>{e({isOpen:!1})},setModalProps:({learnMoreUrl:e,experienceUrl:t,navVersion:n})=>({setState:r})=>{r({learnMoreUrl:e,experienceUrl:t,navVersion:n})}},name:"editionAwarenessStandardToPremiumModalStore"}),a=(0,n("9zUhf").createActionsHook)(r),i=(0,n("9zUhf").createHook)(r);e.exports.useConfluenceStandardToPremiumModalActions=a,e.exports.useConfluenceStandardToPremiumModal=i}),r("hxSIT",function(e,t){var r=n("42omo");e.exports.useBuildLearnMoreLink=e=>{let t="/admin/billing";return(0,r.useMemo)(()=>{if(!e)return t;try{let t=new URL(e);return t.pathname.includes("change-edition")?t.pathname=t.pathname.split("/").slice(0,-1).join("/"):(t.searchParams.delete("offeringName"),t.searchParams.delete("offeringname")),t.toString()}catch(e){return t}},[e])}}),r("5DQLv",function(t,r){var a=n("42omo");let i=(0,n("jmjWc").LoadableLazy)({__loadable_id__:"Xlut2",name:"LazyStandardToPremiumModal",loader:async()=>(await n("5qldL")).StandardToPremiumModal});t.exports.StandardToPremiumModalMountComponent=()=>(0,n("9wGTI").fg)("edition_awareness_standard_upsell_confluence_ab_fg")?e(a).createElement(i,null):null}),r("5qldL",function(e,t){let r=n("4mJKd")(5);e.exports=Promise.all([r("6wr18"),r("hUapU"),r("lRtGG"),r("8UKe0"),r("ffEVr"),r("hhss7"),r("9CRBg")]).then(()=>n("hCU0r"))}),r("4mJKd",function(e,t){e.exports=e=>t=>import(n("8tirZ").shardUrl(n("02nRr").resolve(t),e))}),r("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=o,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=r,e.exports.shardUrl=function(e,t){return globalThis[n]?s(e,t):e},e.exports.shardUrlUnchecked=s;let n="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function r(e,t){let n=t+1,r=e.split("").reduce((e,t)=>{let r=(e<<n)-e+t.charCodeAt(0);return r&r},0);return(r%=n)<0&&(r+=n),r}let a=/-\d+$/;function i(e){if(!a.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function o(e,t){let n=e.indexOf("."),r=0===t?"":`-${t-1}`;if(-1===n)return`${i(e)}${r}`;let a=i(e.slice(0,n));return`${a}${r}${e.slice(n)}`}function s(e,t){let n=new URL(e),a=r(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(n.pathname),t);return n.hostname=o(n.hostname,a),n.toString()}e.exports.domainShardingKey=n}),r("02nRr",function(e,n){t(e.exports,"register",()=>r,e=>r=e),t(e.exports,"resolve",()=>a,e=>a=e);var r,a,i=new Map;r=function(e,t){for(var n=0;n<t.length-1;n+=2)i.set(t[n],{baseUrl:e,path:t[n+1]})},a=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),r("0SQe8",function(e,t){let r=n("4mJKd")(5);e.exports=Promise.all([r("6vyHt"),r("6wr18"),r("44lfG"),r("kFEyO"),r("eufZR"),r("eeaKR"),r("awqCy"),r("hhss7"),r("ffEVr"),r("7EorR"),r("lz2pE")]).then(()=>n("7Bwbp"))});
//# sourceMappingURL=GlobalComponents.e0e3bb92.js.map
