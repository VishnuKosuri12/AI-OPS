var e=globalThis.parcelRequired477,t=e.register;t("b6A6z",function(t,n){let r,o={noBackend:"a3f31403-5892-4b68-baf9-a8b1c1f9ef80",staging:"811e05d4-b0aa-4ec9-80e4-68cf5e924102",production:{development:"dba4f6db-8419-44f6-ac25-32b6fc352747",userFacing:"8e345daf-482a-4abf-a612-cb6457110817"}},i=({environment:e,jws:t,siteId:n,productName:r,entryPointName:i})=>{let a={jws:t,siteId:n,config:{enableNewUi:!0,productName:r,entryPointName:i}};return"dev"===e?{...a,mode:"standard",publicAppId:o.noBackend,environment:"production"}:"staging"===e?{...a,mode:"first-party",publicAppId:o.staging,environment:"staging"}:{...a,mode:"first-party",publicAppId:o.production.userFacing,environment:"production"}},a={UNSUPPORTED_BROWSER:"unsupported-browser",UNSUPPORTED_MEDIA_STREAMING:"unsupported-media-streaming",UNSUPPORTED_3RD_PARTY_COOKIE:"unsupported-third-party-cookie",UNSUPPORTED_UNKNOWN:"unsupported-unknown",TOKEN_UNSUCCESSFUL:"token-unsuccessful",UNMERGED_USER:"token-unsuccessful-unmerged-user",TOKEN_EMPTY:"token-empty",NETWORK:"network",LOOM_INTERNAL_ERROR:"loom-internal-error",UNKNOWN:"unknown"};class s extends Error{constructor(e,t){super(t),this.type=void 0,this.type=e}}async function c(e,t="GET",n=[]){try{let r=await fetch(e,{method:t,headers:{Accept:"application/json"}});if(!r.ok&&!n.includes(r.status))throw new s(a.NETWORK,r.statusText);return await r.json()}catch(e){throw new s(a.NETWORK,e instanceof Error?e.message:"")}}async function E(){let{token:e,message:t}=await c("/gateway/api/loom-auth/api/internal/auth/sdk_token","POST",[404]);if("Loom user needs merge"===t)throw new s(a.UNMERGED_USER);if("Success"!==t){let e;try{let{status:t}=await c("/gateway/api/loom-auth/api/internal/identity/user-status","GET");e=t}catch(t){e="unknown user status"}throw new s(a.TOKEN_UNSUCCESSFUL,`${t} , ${e}`)}if(!e)throw new s(a.TOKEN_EMPTY);return e}async function u({cloudId:t,environment:n,productName:r,experienceTracker:o,entryPointLocation:c}){let u;try{e("cglvp").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.start(),o.start({id:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,name:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,attributes:{entryPointLocation:c}});let{isSupported:N}=await e("aWuvK"),{supported:I,error:O}=N();if(!I)throw new s(function(e){switch(e){case"incompatible-browser":return a.UNSUPPORTED_BROWSER;case"third-party-cookies-disabled":return a.UNSUPPORTED_3RD_PARTY_COOKIE;case"no-media-streams-support":return a.UNSUPPORTED_MEDIA_STREAMING;default:return a.UNSUPPORTED_UNKNOWN}}(O));let p="dev"===n?"":await E(),{createInstance:_}=await e("5a9y3");if(!(u=await _(i({environment:n,jws:p,siteId:t,productName:r,entryPointName:c}))).status().success)throw new s(a.LOOM_INTERNAL_ERROR,"Loom SDK timeout or another internal issue");o.succeed({name:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,attributes:{entryPointLocation:c}}),e("cglvp").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.stop()}catch(t){if(e("cglvp").INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC.cancel(),t instanceof s)return t.type===a.UNSUPPORTED_BROWSER||t.type===a.UNSUPPORTED_MEDIA_STREAMING||t.type===a.UNSUPPORTED_3RD_PARTY_COOKIE||t.type===a.UNMERGED_USER?o.succeed({name:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,attributes:{entryPointLocation:c}}):o.fail({name:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,error:Error(t.type),attributes:{entryPointLocation:c}}),{kind:"failure",initError:{type:t.type,message:t.message}};if(o.fail({name:e("cglvp").INITIALIZE_LOOM_ENTRY_POINT,error:Error(a.UNKNOWN),attributes:{entryPointLocation:c}}),t instanceof Error)return{kind:"failure",initError:{type:a.UNKNOWN,message:t.message}};return{kind:"failure",initError:{type:a.UNKNOWN}}}return{kind:"success",loomSDKInstance:u}}t.exports.LoomInitErrorException=a,t.exports.initLoomSDK=function(e){return void 0===r&&(r=u(e)),r},t.exports.resetInstance=function(){r=void 0}}),t("cglvp",function(t,n){let r=e("kyiqo").metrics.interaction({key:"open-loom-recorder-sdk"}),o=e("kyiqo").metrics.interaction({key:"initialize-loom-recorder-sdk"});t.exports.OPEN_LOOM_RECORDER_SDK_INTERACTION_METRIC=r,t.exports.INITIALIZE_LOOM_RECORDER_SDK_INTERACTION_METRIC=o,t.exports.RECORD_LOOM_ENTRY_POINT="record-loom-entry-point",t.exports.INITIALIZE_LOOM_ENTRY_POINT="initialize-loom-entry-point"}),t("aWuvK",function(t,n){let r=e("4mJKd")(5);t.exports=Promise.all([r("lwKXH"),r("4byV5")]).then(()=>e("3f9PV"))}),t("5a9y3",function(t,n){let r=e("4mJKd")(5);t.exports=Promise.all([r("lkOIY"),r("jSdjl"),r("l2EUC"),r("kWZnd"),r("92LGf"),r("6wr18"),r("a3Uq6"),r("xvDzM"),r("jle6Z"),r("4drdS"),r("lLK0D"),r("9LQGG"),r("wIOhQ"),r("lwKXH"),r("fisfU"),r("ffEVr"),r("7EorR"),r("btYwu")]).then(()=>e("fIeud"))});
//# sourceMappingURL=initLoomSDK.69905978.js.map
