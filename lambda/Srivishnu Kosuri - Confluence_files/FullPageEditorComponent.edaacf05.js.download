function e(e){return e&&e.__esModule?e.default:e}var t=globalThis,n={},a={},i=t.parcelRequired477;null==i&&(i=function(e){var t=n[e];if(void 0!==t)return t.exports;var i=a[e];if(void 0!==i){delete a[e];var o={id:e,exports:{}};return n[e]=o,i.call(o.exports,o,o.exports),o.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s},i.register=function(e,t){a[e]=t},t.parcelRequired477=i);var o=i.register;t.lb||(t.lb=new Set,t.bq=[],t.rlb=e=>{t.lb.add(e),t.pq()},t.rwr=(e,n,a)=>{t.bq.push({b:e,r:n,d:a}),t.pq()},t.pq=()=>{var e=t.bq.find(e=>e.d.every(e=>t.lb.has(e)));e&&(t.bq=t.bq.filter(t=>t.b!==e.b),e.r(),t.pq())}),o("fTvEN",function(t,n){var a=i("l998X");i("42omo");var o=i("3pLGZ"),s=i("dZ8uq");let r=(e,t,n=!0)=>({tr:a})=>{let{expand:o,nestedExpand:s}=a.doc.type.schema.nodes,r=t&&t<=a.doc.content.size?t:a.doc.content.size;return a.doc.nodesBetween(e&&e>=0?e:0,r,e=>{[o,s].includes(e.type)&&i("adayn").expandedState.set(e,n)}),null};i("42omo");let l="expand",d=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)();return t?.blockMenu?.actions.isTransformOptionDisabled(l)?null:(0,a.jsx)(i("2GVu1").ToolbarDropdownItem,{onClick:e=>{let n=e.nativeEvent instanceof KeyboardEvent||0===e.nativeEvent.detail?i("d925B").INPUT_METHOD.KEYBOARD:i("d925B").INPUT_METHOD.MOUSE,a=i("d925B").INPUT_METHOD.BLOCK_MENU;t?.core.actions.execute(({tr:e})=>{let i=t?.blockMenu?.commands.transformNode(e.doc.type.schema.nodes.expand,{inputMethod:a,triggeredFrom:n,targetTypeName:l});return i?i({tr:e}):null})},elemBefore:(0,a.jsx)(e(i("cZifa")),{label:""}),children:n(i("4HWgE").toolbarInsertBlockMessages.expand)})},c=e=>()=>(0,a.jsx)(d,{api:e});var p=i("8m4tT"),u=i("1oCLl");let h=e=>(0,p.hasParentNode)(t=>t.type===e.schema.nodes.expand||t.type===e.schema.nodes.nestedExpand)(e.selection),m=new(0,i("ks2lK").PluginKey)("expandPlugin"),{createPluginState:f,createCommand:g,getPluginState:T}=(0,i("lkJUe").pluginFactory)(m,(e,t)=>"SET_EXPAND_REF"===t.type?{...e,expandRef:t.data.ref}:e),E=e=>g({type:"SET_EXPAND_REF",data:{ref:e}},e=>e.setMeta("addToHistory",!1)),y=e=>(t,n)=>(a,o)=>{if(!n||isNaN(t))return!1;let s={action:i("d925B").ACTION.DELETED,actionSubject:n.type===a.schema.nodes.expand?i("d925B").ACTION_SUBJECT.EXPAND:i("d925B").ACTION_SUBJECT.NESTED_EXPAND,attributes:{inputMethod:i("d925B").INPUT_METHOD.FLOATING_TB},eventType:i("d925B").EVENT_TYPE.TRACK};if(n&&o){let{tr:r}=a;if(r.delete(t,t+n.nodeSize),e?.attachAnalyticsEvent(s)(r),n.type===a.schema.nodes.nestedExpand){let e=r.doc.resolve(t+1);e&&r.setSelection(i("ks2lK").Selection.near(e,-1))}o(r)}return!0},_=e=>(t,n)=>{let a=(0,i("hcbpx").findExpand)(t);return!!a&&y(e)(a.pos,a.node)(t,n)},S=({title:e,nodeType:t,pos:n,__livePage:a})=>(o,s)=>{let r=o.doc.nodeAt(n);if(r&&r.type===t&&s){let{tr:t}=o;a?t.step(new(0,i("9YoeD").SetAttrsStep)(n,{...r.attrs,title:e})):t.setNodeMarkup(n,r.type,{...r.attrs,title:e},r.marks),s(t)}return!0},b=({editorAnalyticsAPI:e,pos:t,nodeType:n,__livePage:a})=>(o,s)=>{let r=o.doc.nodeAt(t);if(r&&r.type===n&&s){let{tr:l}=o,d=!r.attrs.__expanded;a?l.step(new(0,i("9YoeD").SetAttrsStep)(t,{...r.attrs,__expanded:d})):l.setNodeMarkup(t,r.type,{...r.attrs,__expanded:d},r.marks),(a?!0===d:!1===d&&(0,i("hcbpx").findExpand)(o))&&l.setSelection(new(0,i("adhil").GapCursorSelection)(l.doc.resolve(t+r.nodeSize),i("adhil").Side.RIGHT));let c={action:i("d925B").ACTION.TOGGLE_EXPAND,actionSubject:n===o.schema.nodes.expand?i("d925B").ACTION_SUBJECT.EXPAND:i("d925B").ACTION_SUBJECT.NESTED_EXPAND,attributes:{platform:i("e2wMq").PLATFORMS.WEB,mode:i("e2wMq").MODE.EDITOR,expanded:a?!d:d},eventType:i("d925B").EVENT_TYPE.TRACK};l.setMeta("isRemote",!0),e?.attachAnalyticsEvent(c)(l),s(l)}return!0},C=e=>{let{expand:t,nestedExpand:n}=e.schema.nodes,a=!!(0,i("id9O1").findTable)(e.selection),o=h(e);return(a||o?n:t).createAndFill({})},v=e=>t=>(n,a)=>{let o=C(n);if(!o)return!1;let s=n.selection.empty?(0,p.safeInsert)(o)(n.tr).scrollIntoView():(0,i("l9FJJ").createWrapSelectionTransaction)({state:n,type:o.type}),r={action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:o?.type===n.schema.nodes.expand?i("d925B").ACTION_SUBJECT_ID.EXPAND:i("d925B").ACTION_SUBJECT_ID.NESTED_EXPAND,attributes:{inputMethod:t},eventType:i("d925B").EVENT_TYPE.TRACK};return a&&o&&(e?.attachAnalyticsEvent(r)(s),a(s)),!0},I=e=>(t,n)=>v(e)(i("d925B").INPUT_METHOD.INSERT_MENU)(t,n),N=e=>(t,n,a)=>{if(a){let i=a.domAtPos(e).node.parentElement;if(i){x(e)(t,n,a);let o=i.querySelector("input");if(o)return o.focus(),!0}}return!1},k=e=>(t,n,a)=>{if(!(e instanceof HTMLElement))return!1;let o=(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?e.querySelector(`.${i("iMS6j").expandClassNames.iconButton}`):e.querySelector(`.${i("iMS6j").expandClassNames.iconContainer}`);if(o&&o.focus){let{tr:e}=t,s=t.selection.from;return e.setSelection(new(0,i("ks2lK").TextSelection)(e.doc.resolve(s))),n&&n(e),a?.dom.blur(),o.focus(),!0}return!1},x=e=>(t,n,a)=>{if(a){a.hasFocus()||a.focus();let t=i("ks2lK").Selection.findFrom(a.state.doc.resolve(e),1,!0);return t&&n&&n(a.state.tr.setSelection(t)),!0}return!1},A=e=>({tr:e})=>null,O=e=>e?.type.name==="expand"||e?.type.name==="nestedExpand",P=e=>e instanceof i("ks2lK").NodeSelection&&O(e.node);i("42omo");var M=i("cUcZ5"),w=i("kbdB6");function D(e,t){let{allowInteractiveExpand:n,expanded:a,intl:o}=t,s=o.formatMessage(a?i("kSoKM").messages.collapseNode:i("kSoKM").messages.expandNode),r=e.querySelector(`.${i("iMS6j").expandClassNames.iconButton}`);if(r)r.setAttribute("aria-label",s),r.setAttribute("aria-expanded",String(a)),n?(r.setAttribute("title",s),r.removeAttribute("disabled")):(r.removeAttribute("title"),r.setAttribute("disabled","true"));else{let t=(0,i("hTKp4").getDocument)();if(!t)return;let o=t.createElement("button");o.className=i("iMS6j").expandClassNames.iconButton,o.setAttribute("aria-label",s),o.setAttribute("aria-expanded",String(a)),n?o.setAttribute("title",s):o.setAttribute("disabled","true"),e.appendChild(o);let r=t.createElementNS("http://www.w3.org/2000/svg","svg");r.setAttribute("class",i("iMS6j").expandClassNames.iconSvg),r.setAttribute("width","12"),r.setAttribute("height","12"),r.setAttribute("viewBox","0 0 16 16"),r.setAttribute("role","presentation");let l=t.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("fill","currentcolor"),l.setAttribute("d","m6.03 1.47 6 6a.75.75 0 0 1 .052 1.004l-.052.056-6 6-1.06-1.06L10.44 8 4.97 2.53z"),r.appendChild(l),o.appendChild(r)}}var R=i("42omo");let B=t=>{let{allowInteractiveExpand:n,expanded:a,intl:o}=t,s=(0,R.useCallback)((e,n)=>{let{buttonStyles:a,...o}=e(n);return{buttonStyles:{...a,height:"100%","& svg":{transform:t.expanded?"transform: rotate(90deg);":"transform: rotate(0deg);",transition:`transform 0.2s ${i("aFUXX").akEditorSwoopCubicBezier};`}},...o}},[t]),r=a?i("kSoKM").messages.collapseNode:i("kSoKM").messages.expandNode,l=o?o.formatMessage(r):r.defaultMessage;return(0,i("9K4OG").jsx)(i("4KS7f").default,{appearance:"subtle",className:i("iMS6j").expandClassNames.iconContainer,iconBefore:(0,i("9K4OG").jsx)(e(i("6R5uz")),{label:"",size:"small"}),shouldFitContainer:!0,theme:s,"aria-label":l,"aria-expanded":a,isDisabled:!n})},L=class extends e(R).Component{render(){let{label:e}=this.props;return(0,i("9K4OG").jsx)(i("3gadb").default,{content:e,position:"top",tag:i("kSoKM").ExpandLayoutWrapperWithRef},(0,i("9K4OG").jsx)(B,this.props))}constructor(e){super(e)}},U=e=>{let{expanded:t,intl:n}=e,a=t?i("kSoKM").messages.collapseNode:i("kSoKM").messages.expandNode,o=n&&n.formatMessage(a)||a.defaultMessage,s=!(window.matchMedia&&window.matchMedia("(any-hover: hover)").matches!==window.matchMedia("(any-hover: none)").matches)||window.matchMedia("(any-hover: hover)").matches;return e.allowInteractiveExpand&&s?(0,i("9K4OG").jsx)(L,{label:o,...e}):(0,i("9K4OG").jsx)("div",{css:i("kSoKM").expandLayoutWrapperStyle},(0,i("9K4OG").jsx)(B,{label:o,...e}))},K=(e,t,n,a,o)=>{var s,r;return["div",{class:(s=e.type.name,r=t?!e.attrs.__expanded:e.attrs.__expanded,`${i("iMS6j").expandClassNames.prefix} ${i("iMS6j").expandClassNames.type(s)} ${r?i("iMS6j").expandClassNames.expanded:""}`),"data-node-type":e.type.name,"data-title":e.attrs.title,...(0,i("dh538").fg)("platform_editor_adf_with_localid")&&{"data-local-id":e.attrs.localId}},["div",{class:i("iMS6j").expandClassNames.titleContainer,contenteditable:"false",tabindex:"-1"},["div",{class:i("iMS6j").expandClassNames.icon,style:"display: flex; width: var(--ds-space-300, 24px); height: var(--ds-space-300, 24px)"}],["div",{class:i("iMS6j").expandClassNames.inputContainer},["input",{class:i("iMS6j").expandClassNames.titleInput,"aria-label":n&&n.formatMessage(i("kSoKM").messages.expandArialabel)||i("kSoKM").messages.expandArialabel.defaultMessage,value:e.attrs.title,placeholder:n&&n.formatMessage(i("kSoKM").messages.expandPlaceholderText)||i("kSoKM").messages.expandPlaceholderText.defaultMessage,type:"text",readonly:a?"true":void 0}]]],["div",{class:i("iMS6j").expandClassNames.content,contenteditable:void 0!==o?o?"true":"false":void 0},0]]};class F{initHandlers(){this.dom&&(this.dom.addEventListener("click",this.handleClick),this.dom.addEventListener("input",this.handleInput)),this.input&&(this.input.addEventListener("keydown",this.handleTitleKeydown),this.input.addEventListener("blur",this.handleBlur),this.input.addEventListener("focus",this.handleInputFocus)),this.titleContainer&&this.titleContainer.addEventListener("focus",this.handleFocus),this.icon&&this.icon.addEventListener("keydown",this.handleIconKeyDown),this.api?.editorDisabled&&(this.cleanUpEditorDisabledOnChange=this.api.editorDisabled.sharedState.onChange(e=>{let t=e.nextSharedState.editorDisabled;this.input&&(t?this.input.setAttribute("readonly","true"):this.input.removeAttribute("readonly")),this.content&&this.content.setAttribute("contenteditable",this.getContentEditable(this.node)?"true":"false")}))}renderNativeIcon(e){if(!this.icon)return;let{__expanded:t}=e.attrs;D(this.icon,{expanded:this.__livePage?!t:t,allowInteractiveExpand:this.allowInteractiveExpand,intl:this.intl})}renderIcon(e,t){if(!this.icon)return;let{__expanded:n}=t&&t.attrs||this.node.attrs;this.nodeViewPortalProviderAPI.render(()=>(0,a.jsx)(U,{intl:e,allowInteractiveExpand:this.allowInteractiveExpand,expanded:this.__livePage?!n:n}),this.icon,this.renderKey)}stopEvent(e){let t=e.target;return t===this.input||t===this.icon||!!(0,i("4vlwG").closestElement)(t,`.${i("iMS6j").expandClassNames.icon}`)}ignoreMutation(e){return(!this.isMobile||"characterData"!==e.type&&"childList"!==e.type)&&"selection"!==e.type}update(e,t){return this.node.type===e.type&&(this.node.attrs.__expanded!==e.attrs.__expanded&&(this.dom&&(this.dom.classList.toggle(i("iMS6j").expandClassNames.expanded),(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?this.renderNativeIcon(e):this.renderIcon(this&&this.intl,e)),this.content&&this.content.setAttribute("contenteditable",this.getContentEditable(e)?"true":"false")),window.requestAnimationFrame(()=>{this.input&&this.node.attrs.title!==this.input.value&&(this.input.value=this.node.attrs.title)}),this.node=e,!0)}destroy(){this.dom&&(this.dom.removeEventListener("click",this.handleClick),this.dom.removeEventListener("input",this.handleInput)),this.input&&(this.input.removeEventListener("keydown",this.handleTitleKeydown),this.input.removeEventListener("blur",this.handleBlur),this.input.removeEventListener("focus",this.handleInputFocus)),this.titleContainer&&this.titleContainer.removeEventListener("focus",this.handleFocus),this.icon&&(this.icon.removeEventListener("keydown",this.handleIconKeyDown),this.nodeViewPortalProviderAPI.remove(this.renderKey)),this.decorationCleanup?.(),this.cleanUpEditorDisabledOnChange&&this.cleanUpEditorDisabledOnChange(),this.dom=void 0,this.contentDOM=void 0,this.icon=void 0,this.input=void 0,this.titleContainer=void 0,this.content=void 0,this.cleanUpEditorDisabledOnChange=void 0}constructor(t,n,a,o,s,r,l,d,c=!0,p=!1,h){this.selectNearNode=r,this.__livePage=p,this.cleanUpEditorDisabledOnChange=h,this.node=void 0,this.view=void 0,this.dom=void 0,this.contentDOM=void 0,this.icon=void 0,this.input=void 0,this.titleContainer=void 0,this.content=void 0,this.getPos=void 0,this.intl=void 0,this.allowInteractiveExpand=!0,this.isMobile=!1,this.api=void 0,this.nodeViewPortalProviderAPI=void 0,this.decorationCleanup=void 0,this.renderKey=void 0,this.focusTitle=()=>{if(this.input){let{state:e,dispatch:t}=this.view;if(this.selectNearNode){let n=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.Start})(e);t&&t(n)}let n=this.getPos();"number"==typeof n&&x(n)(e,t,this.view),this.input.focus()}},this.handleIconKeyDown=e=>{switch((0,w.keyName)(e)){case"Tab":e.preventDefault(),this.focusTitle();break;case"Enter":e.preventDefault(),this.handleClick(e)}},this.handleClick=e=>{let t=this.getPos();if("number"!=typeof t)return;let n=e.target,{state:a,dispatch:o}=this.view;if((0,i("4vlwG").closestElement)(n,`.${i("iMS6j").expandClassNames.icon}`)){if(!this.allowInteractiveExpand)return;e.stopPropagation(),this.view.dom instanceof HTMLElement&&this.view.dom.blur(),b({editorAnalyticsAPI:this.api?.analytics?.actions,pos:t,nodeType:this.node.type,__livePage:this.__livePage})(a,o);return}if(n===this.input){e.stopPropagation(),this.focusTitle();return}},this.handleInput=e=>{let t=this.getPos();if("number"!=typeof t)return;let n=e.target;if(n===this.input){e.stopPropagation();let{state:a,dispatch:i}=this.view;S({title:n.value,pos:t,nodeType:this.node.type,__livePage:this.__livePage})(a,i)}},this.handleFocus=e=>{e.stopImmediatePropagation()},this.handleInputFocus=()=>{this.decorationCleanup=this.api?.selectionMarker?.actions?.hideDecoration()},this.handleBlur=()=>{this.decorationCleanup?.()},this.handleTitleKeydown=e=>{switch((0,w.keyName)(e)){case"Enter":this.toggleExpand();break;case"Tab":case"ArrowDown":this.moveToOutsideOfTitle(e);break;case"ArrowRight":this.handleArrowRightFromTitle(e);break;case"ArrowLeft":this.handleArrowLeftFromTitle(e);break;case"ArrowUp":(0,u.expValEquals)("platform_editor_lovability_navigation_fixes","isEnabled",!0)?this.moveToPreviousLine(e):this.setLeftGapCursor(e);break;case"Backspace":this.deleteExpand(e)}return e.ctrlKey&&"y"===e.key||(e.ctrlKey||e.metaKey)&&e.shiftKey&&"z"===e.key?void this.handleRedoFromTitle(e):(e.ctrlKey||e.metaKey)&&"z"===e.key?void this.handleUndoFromTitle(e):void((0,u.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0)&&(e.ctrlKey||e.metaKey)&&e.altKey&&("BracketLeft"===e.code||"BracketRight"===e.code)&&this.view.dispatchEvent(new KeyboardEvent("keydown",{key:e.key,code:e.code,metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey})))},this.deleteExpand=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n!==a||0!==n)return;let{state:o}=this.view,s=this.node;s&&(0,i("l9G9n").isEmptyNode)(o.schema)(s)&&y(this.api?.analytics?.actions)(t,s)(o,this.view.dispatch)},this.toggleExpand=()=>{let e=this.getPos();if("number"==typeof e&&this.allowInteractiveExpand){let{state:t,dispatch:n}=this.view;b({editorAnalyticsAPI:this.api?.analytics?.actions,pos:e,nodeType:this.node.type,__livePage:this.__livePage})(t,n)}},this.moveToOutsideOfTitle=e=>{e.preventDefault();let{state:t,dispatch:n}=this.view,a=this.getPos();if("number"!=typeof a)return;let o=a;this.isCollapsed()&&(o=a+this.node.nodeSize);let s=t.doc.resolve(o);if(!s)return;if(this.isCollapsed()&&s.nodeAfter&&["expand","nestedExpand"].indexOf(s.nodeAfter.type.name)>-1)return this.setRightGapCursor(e);let r=i("ks2lK").Selection.findFrom(s,1,!0);r&&(this.view.focus(),n(t.tr.setSelection(r)))},this.isCollapsed=()=>this.__livePage?this.node.attrs.__expanded:!this.node.attrs.__expanded,this.setRightGapCursor=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{value:n,selectionStart:a,selectionEnd:o}=this.input;if(a===o&&a===n.length){let{state:n,dispatch:a}=this.view;e.preventDefault(),this.view.focus(),a(n.tr.setSelection(new(0,i("adhil").GapCursorSelection)(n.doc.resolve(this.node.nodeSize+t),i("adhil").Side.RIGHT)))}},this.moveToPreviousLine=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view,o=n.doc.resolve(t);if(!o)return;if(0===o.pos)return void this.setLeftGapCursor(e);let s=i("ks2lK").Selection.findFrom(o,-1);s&&(this.view.focus(),a(n.tr.setSelection(s)))}},this.setLeftGapCursor=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus(),a(n.tr.setSelection(new(0,i("adhil").GapCursorSelection)(n.doc.resolve(t),i("adhil").Side.LEFT)))}},this.handleArrowRightFromTitle=e=>{if(!this.input||!this.selectNearNode)return;let t=this.getPos();if("number"!=typeof t)return;let{value:n,selectionStart:a,selectionEnd:o}=this.input;if(a===o&&a===n.length){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus();let o=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.End,selection:i("ks2lK").NodeSelection.create(n.doc,t)})(n);a&&a(o)}},this.handleArrowLeftFromTitle=e=>{if(!this.input||!this.selectNearNode)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus();let o=this.api?.selection?.sharedState.currentState()||{};if(o?.selectionRelativeToNode===void 0){let e=this.selectNearNode({selectionRelativeToNode:void 0,selection:new(0,i("adhil").GapCursorSelection)(n.doc.resolve(t),i("adhil").Side.LEFT)})(n);a&&a(e)}else{let e=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.Start,selection:i("ks2lK").NodeSelection.create(n.doc,t)})(n);a&&a(e)}}},this.handleUndoFromTitle=e=>{let{state:t,dispatch:n}=this.view;(0,i("ke2AI").undo)(t,n),e.preventDefault()},this.handleRedoFromTitle=e=>{let{state:t,dispatch:n}=this.view;(0,i("ke2AI").redo)(t,n),e.preventDefault()},this.getContentEditable=e=>{let t=this.__livePage?!e.attrs.__expanded:e.attrs.__expanded;return this.api&&this.api.editorDisabled?!this.api.editorDisabled.sharedState.currentState()?.editorDisabled&&t:t},this.intl=o();let{dom:m,contentDOM:f}=i("5SAOw").DOMSerializer.renderSpec(document,K(t,this.__livePage,this.intl,l?.editorDisabled?.sharedState.currentState()?.editorDisabled));this.nodeViewPortalProviderAPI=d,this.allowInteractiveExpand=c,this.getPos=a,this.view=n,this.node=t,this.dom=m,this.contentDOM=f,this.isMobile=s,this.api=l,this.icon=this.dom.querySelector(`.${i("iMS6j").expandClassNames.icon}`),this.input=this.dom.querySelector(`.${i("iMS6j").expandClassNames.titleInput}`),this.titleContainer=this.dom.querySelector(`.${i("iMS6j").expandClassNames.titleContainer}`),this.content=this.dom.querySelector(`.${i("iMS6j").expandClassNames.content}`),this.renderKey=e(M)(),(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?this.renderNativeIcon(this.node):this.renderIcon(this.intl),this.initHandlers()}}function j({getIntl:e,isMobile:t,api:n,nodeViewPortalProviderAPI:a,allowInteractiveExpand:i=!0,__livePage:o}){return(s,r,l)=>new F(s,r,l,e,t,n?.selection?.actions?.selectNearNode,n,a,i,o)}function G(e,t){return!!e?.classList?.contains(t)}let V=(e,t,n="full-page",a=!1,o,s,r=!0,l=!1)=>{let d=f(e,{});return new(0,i("1S4f7").SafePlugin)({state:d,key:m,props:{nodeViews:{expand:j({getIntl:t,isMobile:!1,api:o,nodeViewPortalProviderAPI:s,allowInteractiveExpand:r,__livePage:l}),nestedExpand:j({getIntl:t,isMobile:!1,api:o,nodeViewPortalProviderAPI:s,allowInteractiveExpand:r,__livePage:l})},handleKeyDown:(e,t)=>G(t.target,i("iMS6j").expandClassNames.titleContainer),handleKeyPress:(e,t)=>G(t.target,i("iMS6j").expandClassNames.titleContainer),handleScrollToSelection:()=>G(document.activeElement,i("iMS6j").expandClassNames.titleInput),handleClickOn:(0,i("3tffm").createSelectionClickHandler)(["expand","nestedExpand"],e=>e.classList.contains(i("iMS6j").expandClassNames.prefix),{useLongPressSelection:a}),handleDrop:(e,t,n,a)=>(function(e,t,n){let{state:a,dispatch:o}=e,s=a.tr,{selection:r}=a,{from:l,to:d}=r,c=!1,p=!1;if(n.content.forEach(e=>{e.type===a.schema.nodes.expand?c=!0:e.type===a.schema.nodes.nestedExpand&&(p=!0)}),!c&&!p||c&&p)return!1;let u=e.posAtCoords({left:t.clientX,top:t.clientY});if(!u)return!1;let h=a.doc.resolve(u.pos),m=h.node().type,f=h.depth>0?h.node(h.depth-1).type:m,g=[a.schema.nodes.expand,a.schema.nodes.tableHeader,a.schema.nodes.tableCell],T=g.includes(m)||g.includes(f),E=m===a.schema.nodes.nestedExpand||f===a.schema.nodes.nestedExpand,y=n;if(c&&T?y=(0,i("hcbpx").transformSliceExpandToNestedExpand)(n):!p||T||E||(y=(0,i("hcbpx").transformSliceNestedExpandToExpand)(n,a.schema)),!y||y.eq(n))return!1;let _=u.pos>l?u.pos-y.content.size:u.pos;return m===a.schema.nodes.doc||c||(_-=1),s.delete(l,d),s.insert(_,y.content),o(s),!0})(e,t,n)},filterTransaction:e=>!G(document.activeElement,i("iMS6j").expandClassNames.titleInput)||!e.selectionSet||!!e.steps.length&&!e.isGeneric,view:e=>{let t=e.domAtPos.bind(e);return{update:e=>{let{state:n,dispatch:a}=e,o=(0,i("hcbpx").findExpand)(n);if(o){let e=(0,p.findDomRefAtPos)(o.pos,t);T(n).expandRef!==e&&E(e)(n,a)}}}}})},z=t=>(n,{formatMessage:a})=>{let{hoverDecoration:o}=t?.decorations?.actions??{},s=t?.analytics?.actions,{expandRef:r}=T(n)??{};if(r){let{nestedExpand:t,expand:l}=n.schema.nodes;return{title:"Expand toolbar",getDomRef:()=>r,nodeType:[t,l],offset:[0,6],items:[{type:"copy-button",items:[{state:n,formatMessage:a,nodeType:[t,l]}]},{type:"separator"},{id:"editor.expand.delete",type:"button",appearance:"danger",focusEditoronEnter:!0,icon:e(i("gKvd9")),onClick:_(s),onMouseEnter:o?.([t,l],!0),onMouseLeave:o?.([t,l],!1),onFocus:o?.([t,l],!0),onBlur:o?.([t,l],!1),title:a(i("61p3e").default.remove),tabIndex:null}]}}},H=({config:e={},api:t})=>((0,s.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)&&t?.blockMenu?.actions.registerBlockMenuComponents([{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_EXPAND_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_EXPAND_MENU_ITEM.key]},component:c(t)}]),{name:"expand",nodes:()=>[{name:"expand",node:i("4r9Pq").expandWithNestedExpand},{name:"nestedExpand",node:i("iw2ID").nestedExpand}],actions:{insertExpand:I(t?.analytics?.actions),insertExpandWithInputMethod:v(t?.analytics?.actions)},commands:{toggleExpandWithMatch:e=>A(e),toggleExpandRange:r},pmPlugins:()=>[{name:"expand",plugin:({dispatch:n,getIntl:a,nodeViewPortalProviderAPI:i})=>V(n,a,e.appearance,e.useLongPressSelection,t,i,e.allowInteractiveExpand??!0,e.__livePage)},{name:"expandKeymap",plugin:()=>(function(e,t){let n={};return(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveRight.common,(t,n,a)=>{if(!a)return!1;let{selection:o}=t,{selectionRelativeToNode:s}=e?.selection?.sharedState.currentState()||{};return!!P(o)&&s===i("cQ4aK").RelativeSelectionPos.Start&&N(o.from+1)(t,n,a)},n),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveLeft.common,(t,n,a)=>{if(!a)return!1;let{selection:o}=t,{selectionRelativeToNode:s}=e?.selection?.sharedState.currentState()||{};return!!P(o)&&(void 0===s||s===i("cQ4aK").RelativeSelectionPos.End)&&N(o.from+1)(t,n,a)},n),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").tab.common,(e,t,n)=>{if(n&&n.dom instanceof HTMLElement){let{from:a}=e.selection;if(P(e.selection)){let i=n.nodeDOM(a);return!!i&&k(i)(e,t,n)}if(e.selection instanceof i("ks2lK").TextSelection&&!(0,i("bMyNT").isInTable)(e)){let a=(0,i("hcbpx").findExpand)(e);if(a){let i=n.nodeDOM(a.pos);if(i)return k(i)(e,t,n)}}}return!1},n),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveUp.common,(e,n,a)=>{if(!a)return!1;let{selection:o,schema:s}=e,{nodeBefore:r}=o.$from;if(o instanceof i("adhil").GapCursorSelection&&o.side===i("adhil").Side.RIGHT&&r&&(r.type===s.nodes.expand||r.type===s.nodes.nestedExpand)&&(t.__livePage?r.attrs.__expanded:!r.attrs.__expanded)){let{$from:t}=o;return N(Math.max(t.pos-1,0))(e,n,a)}let{$from:l}=e.selection;if(a.endOfTextblock("up")){let o=(0,i("hcbpx").findExpand)(e);if((0,i("caYZ2").isPositionNearTableRow)(l,s,"before")&&!o)return!1;let r=Math.max(l.pos-l.parentOffset-1,0);if(o&&o.start===r)return N(o.start)(e,n,a);let d=i("ks2lK").Selection.findFrom(e.doc.resolve(r),-1),c=(0,i("hcbpx").findExpand)(e,d);if(d&&c)return(t.__livePage?c.node.attrs.__expanded:!c.node.attrs.__expanded)?N(c.start)(e,n,a):(n&&n(e.tr.setSelection(d)),!0)}return!1},n),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveDown.common,(e,n,a)=>{if(!a)return!1;let{expand:o,nestedExpand:s}=e.schema.nodes,{selection:r}=e,{nodeAfter:l}=r.$from;if(r instanceof i("adhil").GapCursorSelection&&r.side===i("adhil").Side.LEFT&&l&&(l.type===o||l.type===s)&&(t.__livePage?l.attrs.__expanded:!l.attrs.__expanded)){let{$from:t}=r;return N(t.pos+1)(e,n,a)}if((0,u.expValEquals)("platform_editor_lovability_navigation_fixes","isEnabled",!0)){let t=(0,i("adayn").getNextNodeExpandPos)(a,r);if(void 0!==t)return N(t)(e,n,a)}if(a.endOfTextblock("down")){let{$from:t}=e.selection;if(0===t.depth)return!1;let i=e.doc.resolve(t.after());if(i.nodeAfter&&(i.nodeAfter.type===o||i.nodeAfter.type===s))return N(i.pos+1)(e,n,a)}return!1},n),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").backspace.common,(n,a,o)=>{let{selection:s}=n,{$from:r}=s;if(!o||!s.empty)return!1;let{expand:l,nestedExpand:d}=n.schema.nodes,c=(0,i("hcbpx").findExpand)(n);if(!c){let e=i("ks2lK").Selection.findFrom(n.doc.resolve(Math.max(s.$from.pos-1,0)),-1),r=(0,i("hcbpx").findExpand)(n,e);return!!r&&(r.node.type===l||r.node.type===d)&&(t.__livePage?!!r.node.attrs.__expanded:!r.node.attrs.__expanded)&&N(r.start)(n,a,o)}let p=n.doc.nodeAt(r.before(Math.max(r.depth-1,1)));if(p&&!O(p))return!1;let u=i("ks2lK").Selection.findFrom(n.doc.resolve(c.pos),1,!0);return!!(u&&s.$from.pos===u.$from.pos&&(0,i("l9G9n").isEmptyNode)(n.schema)(c.node))&&!!a&&_(e?.analytics?.actions)(n,a)},n),(0,i("dus6D").keymap)(n)})(t,{__livePage:e.__livePage})}],pluginsOptions:{floatingToolbar:z(t),quickInsert:({formatMessage:n})=>e&&!0!==e.allowInsertion?[]:[{id:"expand",title:n(i("4HWgE").toolbarInsertBlockMessages.expand),description:n(i("4HWgE").toolbarInsertBlockMessages.expandDescription),keywords:["accordion","collapse"],priority:600,icon:()=>(0,a.jsx)(o.IconExpand,{}),action(e,n){let a=C(n);if(!a)return!1;let o=n.selection.empty?e(a):(0,i("l9FJJ").createWrapSelectionTransaction)({state:n,type:a.type});return t?.analytics?.actions.attachAnalyticsEvent({action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a.type===n.schema.nodes.nestedExpand?i("d925B").ACTION_SUBJECT_ID.NESTED_EXPAND:i("d925B").ACTION_SUBJECT_ID.EXPAND,attributes:{inputMethod:i("d925B").INPUT_METHOD.QUICK_INSERT},eventType:i("d925B").EVENT_TYPE.TRACK})(o),o}}]}});i("42omo");let q=(t,n=!0,a)=>{let{expand:o,nestedExpand:s,paragraph:r}=t.schema.nodes,l=!!(0,i("id9O1").findTable)(t.selection),d=h(t),c=l||d?s:o,p=(0,i("dh538").fg)("platform_editor_adf_with_localid")?c.createAndFill(a?{localId:e(M)()}:{},r.createAndFill(a?{localId:e(M)()}:{})):c.createAndFill({});return n&&i("adayn").expandedState.set(p,!0),p},W=(e,t)=>{let n=(0,i("l9FJJ").createWrapSelectionTransaction)({state:e,type:t.type,nodeAttributes:t.attrs}),a=(0,p.findParentNodeOfType)(t.type)(n.selection);return a&&i("adayn").expandedState.set(a.node,!0),n},X=e=>t=>(n,a)=>{let o,s=q(n,!1,!!e?.localId);if(!s)return!1;if(n.selection.empty)o=(0,p.safeInsert)(s)(n.tr).scrollIntoView(),i("adayn").expandedState.set(s,!0);else{o=(0,i("l9FJJ").createWrapSelectionTransaction)({state:n,type:s.type,...(0,i("dh538").fg)("platform_editor_adf_with_localid")&&{nodeAttributes:s.attrs}});let e=(0,p.findParentNodeOfType)(s.type)(o.selection);e&&i("adayn").expandedState.set(e.node,!0)}let r={action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:s?.type===n.schema.nodes.expand?i("d925B").ACTION_SUBJECT_ID.EXPAND:i("d925B").ACTION_SUBJECT_ID.NESTED_EXPAND,attributes:{inputMethod:t},eventType:i("d925B").EVENT_TYPE.TRACK};return a&&(e?.analytics?.actions?.attachAnalyticsEvent(r)(o),a(o)),!0},Y=e=>(t,n)=>X(e)(i("d925B").INPUT_METHOD.INSERT_MENU)(t,n),$=e=>(t,n)=>{let a=(0,i("hcbpx").findExpand)(t);return!!a&&J(e)(a.pos,a.node)(t,n)},J=e=>(t,n)=>(a,o)=>{if(!n||isNaN(t))return!1;let s={action:i("d925B").ACTION.DELETED,actionSubject:n.type===a.schema.nodes.expand?i("d925B").ACTION_SUBJECT.EXPAND:i("d925B").ACTION_SUBJECT.NESTED_EXPAND,attributes:{inputMethod:i("d925B").INPUT_METHOD.FLOATING_TB},eventType:i("d925B").EVENT_TYPE.TRACK};if(n&&o){let{tr:r}=a;if(r.delete(t,t+n.nodeSize),e?.attachAnalyticsEvent(s)(r),n.type===a.schema.nodes.nestedExpand){let e=r.doc.resolve(t+1);e&&r.setSelection(i("ks2lK").Selection.near(e,-1))}o(r)}return!0},Z=e=>(t,n,a)=>{if(a){a.hasFocus()||a.focus();let t=i("ks2lK").Selection.findFrom(a.state.doc.resolve(e),1,!0);return t&&n&&n(a.state.tr.setSelection(t)),!0}return!1},Q=({editorAnalyticsAPI:e,pos:t,node:n})=>(a,o)=>{if(n&&o){let{tr:s}=a,r=!i("adayn").expandedState.get(n);i("adayn").expandedState.set(n,r),!0===r&&s.setSelection(new(0,i("adhil").GapCursorSelection)(s.doc.resolve(t+n.nodeSize),i("adhil").Side.RIGHT));let l={action:i("d925B").ACTION.TOGGLE_EXPAND,actionSubject:n.type===a.schema.nodes.expand?i("d925B").ACTION_SUBJECT.EXPAND:i("d925B").ACTION_SUBJECT.NESTED_EXPAND,attributes:{platform:i("e2wMq").PLATFORMS.WEB,mode:i("e2wMq").MODE.EDITOR,expanded:r},eventType:i("d925B").EVENT_TYPE.TRACK};s.setMeta("scrollIntoView",!1),e?.attachAnalyticsEvent(l)(s),o(s)}return!0},ee=({title:e,nodeType:t,pos:n})=>(a,o)=>{let s=a.doc.nodeAt(n);if(s&&s.type===t&&o){let{tr:t}=a;t.step(new(0,i("9YoeD").SetAttrsStep)(n,{...s.attrs,title:e})),o(t)}return!0},et=e=>(t,n,a)=>{if(a){let i=a.domAtPos(e).node.parentElement;if(i){Z(e)(t,n,a);let o=i.querySelector("input");if(o)return o.focus(),!0}}return!1},en=e=>(t,n,a)=>{if(!(e instanceof HTMLElement))return!1;let o=(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?e.querySelector(`.${i("iMS6j").expandClassNames.iconButton}`):e.querySelector(`.${i("iMS6j").expandClassNames.iconContainer}`);if(o&&o.focus){let{tr:e}=t,s=t.selection.from;return e.setSelection(new(0,i("ks2lK").TextSelection)(e.doc.resolve(s))),n&&n(e),a?.dom.blur(),o.focus(),!0}return!1},ea=e=>({tr:t})=>{let{expand:n,nestedExpand:a}=t.doc.type.schema.nodes,o=(0,p.findParentNodeOfType)(a)(e);o&&(0,u.expValEquals)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&(i("adayn").expandedState.get(o.node)||i("adayn").expandedState.set(o.node,!0));let s=(0,p.findParentNodeOfType)(n)(e);return s&&(0,u.expValEquals)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&(i("adayn").expandedState.get(s.node)||i("adayn").expandedState.set(s.node,!0)),t},ei=e=>e?.type.name==="expand"||e?.type.name==="nestedExpand",eo=e=>e instanceof i("ks2lK").NodeSelection&&ei(e.node);i("42omo");let es=t=>{let n=(0,R.useCallback)((e,n)=>{let{buttonStyles:a,...o}=e(n);return{buttonStyles:{...a,height:"100%","& svg":{transform:t.expanded?"transform: rotate(90deg);":"transform: rotate(0deg);",transition:`transform 0.2s ${i("aFUXX").akEditorSwoopCubicBezier};`}},...o}},[t]),{intl:a,expanded:o}=t,s=o?i("kSoKM").messages.collapseNode:i("kSoKM").messages.expandNode,r=a?a.formatMessage(s):s.defaultMessage;return(0,i("9K4OG").jsx)(i("4KS7f").default,{appearance:"subtle",className:i("iMS6j").expandClassNames.iconContainer,iconBefore:(0,i("9K4OG").jsx)(e(i("6R5uz")),{label:"",size:"small"}),shouldFitContainer:!0,theme:n,"aria-label":r,"aria-expanded":t.expanded,isDisabled:!t.allowInteractiveExpand})},er=function(e){return(0,i("9K4OG").jsx)(i("3gadb").default,{content:e.label,position:"top",tag:i("kSoKM").ExpandLayoutWrapperWithRef},(0,i("9K4OG").jsx)(es,e))},el=e=>{let{expanded:t,intl:n}=e,a=t?i("kSoKM").messages.collapseNode:i("kSoKM").messages.expandNode,o=n&&n.formatMessage(a)||a.defaultMessage,s=!(window.matchMedia&&window.matchMedia("(any-hover: hover)").matches!==window.matchMedia("(any-hover: none)").matches)||window.matchMedia("(any-hover: hover)").matches;return e.allowInteractiveExpand&&s?(0,i("9K4OG").jsx)(er,{label:o,...e}):(0,i("9K4OG").jsx)("div",{css:i("kSoKM").expandLayoutWrapperStyle},(0,i("9K4OG").jsx)(es,{label:o,...e}))},ed=(e,t)=>`${i("iMS6j").expandClassNames.prefix} ${i("iMS6j").expandClassNames.type(e)} ${t?i("iMS6j").expandClassNames.expanded:""}`,ec=(e,t,n,a,o)=>["div",{class:ed(e.type.name,i("adayn").expandedState.get(e)??!1),"data-node-type":e.type.name,"data-title":e.attrs.title,...(0,i("dh538").fg)("platform_editor_adf_with_localid")&&{"data-local-id":e.attrs.localId}},["div",{class:i("iMS6j").expandClassNames.titleContainer,contenteditable:"false",tabindex:"-1"},["div",{class:i("iMS6j").expandClassNames.icon,style:"display: flex; width: var(--ds-space-300, 24px); height: var(--ds-space-300, 24px)"}],["div",{class:i("iMS6j").expandClassNames.inputContainer},["input",{class:i("iMS6j").expandClassNames.titleInput,"aria-label":n&&n.formatMessage(i("kSoKM").messages.expandArialabel)||i("kSoKM").messages.expandArialabel.defaultMessage,value:e.attrs.title,placeholder:n&&"function"==typeof n.formatMessage&&n.formatMessage(i("kSoKM").messages.expandPlaceholderText)||i("kSoKM").messages.expandPlaceholderText.defaultMessage,type:"text",readonly:a?"true":void 0}]]],["div",{class:i("iMS6j").expandClassNames.content,contenteditable:void 0!==o?o?"true":"false":void 0},0]],ep=e=>(0,p.findParentNodeOfType)(e.schema.nodes.nestedExpand)(e.selection)||(0,p.findParentNodeOfType)(e.schema.nodes.expand)(e.selection),eu=["search-match-dark","search-match-expand-title","selected-search-match"];class eh{stopEvent(e){let t=e.target;return t===this.input||t===this.icon||!!(0,i("4vlwG").closestElement)(t,`.${i("iMS6j").expandClassNames.icon}`)}ignoreMutation(e){return(!this.isMobile||"characterData"!==e.type&&"childList"!==e.type)&&"selection"!==e.type}update(e,t){if(this.node.type===e.type){if(window.requestAnimationFrame(()=>{this.input&&this.node.attrs.title!==this.input.value&&(this.input.value=this.node.attrs.title)}),this.node!==e){let t=i("adayn").expandedState.get(this.node);t&&i("adayn").expandedState.set(e,t)}return(0,u.expValEquals)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)?(this.node=e,this.isExpanded!==i("adayn").expandedState.get(e)&&this.updateExpandToggleIcon(e)):(this.node=e,(0,i("dh538").fg)("platform_editor_disable_unnecessary_expand_renders")||this.updateExpandToggleIcon(this.node)),!0}return!1}updateExpandToggleIcon(e){let t=!!i("adayn").expandedState.get(e)&&i("adayn").expandedState.get(e);if(this.dom&&void 0!==t){if((0,u.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)){let n=this.dom.className.split(" ").filter(e=>eu.includes(e)).join(" ");this.dom.className=n?ed(e.type.name,t)+` ${n}`:ed(e.type.name,t)}else this.dom.className=ed(e.type.name,t);(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?this.renderNativeIcon(e):this.renderIcon(this.icon?this.icon:null,i("adayn").expandedState.get(e)??!1)}this.updateExpandBodyContentEditable(),(0,u.expValEquals)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&(this.isExpanded=t)}updateExpandBodyContentEditable(){this.content&&this.content.setAttribute("contenteditable",this.getContentEditable(this.node)?"true":"false")}renderNativeIcon(e){this.icon&&D(this.icon,{expanded:!(0,i("adayn").isExpandCollapsed)(e),allowInteractiveExpand:this.allowInteractiveExpand,intl:this.intl})}destroy(){this.dom&&this.input&&this.titleContainer&&this.icon&&(this.dom.removeEventListener("click",this.handleClick),this.dom.removeEventListener("input",this.handleInput),this.input.removeEventListener("keydown",this.handleTitleKeydown),this.input.removeEventListener("blur",this.handleBlur),this.input.removeEventListener("focus",this.handleInputFocus),this.titleContainer.removeEventListener("focus",this.handleFocus),this.icon.removeEventListener("keydown",this.handleIconKeyDown),this.decorationCleanup?.(),this.cleanUpEditorDisabledOnChange&&this.cleanUpEditorDisabledOnChange(),this.nodeViewPortalProviderAPI.remove(this.renderKey))}constructor(t,n,o,s,r,l,d,c,p=!0,h=!1,m,f=!1){this.selectNearNode=l,this.__livePage=h,this.cleanUpEditorDisabledOnChange=m,this.isExpanded=f,this.node=void 0,this.view=void 0,this.dom=void 0,this.contentDOM=void 0,this.icon=void 0,this.input=void 0,this.titleContainer=void 0,this.content=void 0,this.getPos=void 0,this.intl=void 0,this.allowInteractiveExpand=!0,this.isMobile=!1,this.api=void 0,this.nodeViewPortalProviderAPI=void 0,this.decorationCleanup=void 0,this.renderKey=void 0,this.focusTitle=()=>{if(this.input){let{state:e,dispatch:t}=this.view;if(this.selectNearNode){let n=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.Start})(e);t&&t(n)}let n=this.getPos();"number"==typeof n&&Z(n)(e,t,this.view),this.input.focus()}},this.handleIconKeyDown=e=>{switch((0,w.keyName)(e)){case"Tab":e.preventDefault(),this.focusTitle();break;case"Enter":e.preventDefault(),this.handleClick(e)}},this.handleClick=e=>{let t=this.getPos();if("number"!=typeof t)return;let n=e.target;if((0,i("4vlwG").closestElement)(n,`.${i("iMS6j").expandClassNames.icon}`)){if(!this.allowInteractiveExpand)return;e.stopPropagation(),this.view.dom instanceof HTMLElement&&this.view.dom.blur(),Q({editorAnalyticsAPI:this.api?.analytics?.actions,pos:t,node:this.node})(this.view.state,this.view.dispatch),this.updateExpandToggleIcon(this.node);return}if(n===this.input){e.stopPropagation(),this.focusTitle();return}},this.handleInput=e=>{let t=this.getPos();if("number"!=typeof t)return;let n=e.target;if(n===this.input){e.stopPropagation();let{state:a,dispatch:i}=this.view;ee({title:n.value,pos:t,nodeType:this.node.type})(a,i)}},this.handleFocus=e=>{e.stopImmediatePropagation()},this.handleInputFocus=()=>{this.decorationCleanup=this.api?.selectionMarker?.actions?.hideDecoration()},this.handleBlur=()=>{this.decorationCleanup?.()},this.handleTitleKeydown=e=>{switch((0,w.keyName)(e)){case"Enter":this.toggleExpand();break;case"Tab":case"ArrowDown":this.moveToOutsideOfTitle(e);break;case"ArrowRight":this.handleArrowRightFromTitle(e);break;case"ArrowLeft":this.handleArrowLeftFromTitle(e);break;case"ArrowUp":(0,u.expValEquals)("platform_editor_lovability_navigation_fixes","isEnabled",!0)?this.moveToPreviousLine(e):this.setLeftGapCursor(e);break;case"Backspace":this.deleteEmptyExpand()}return e.ctrlKey&&"y"===e.key||(e.ctrlKey||e.metaKey)&&e.shiftKey&&"z"===e.key?void this.handleRedoFromTitle(e):(e.ctrlKey||e.metaKey)&&"z"===e.key?void this.handleUndoFromTitle(e):void((0,u.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0)&&(e.ctrlKey||e.metaKey)&&e.altKey&&("BracketLeft"===e.code||"BracketRight"===e.code)&&this.view.dispatchEvent(new KeyboardEvent("keydown",{key:e.key,code:e.code,metaKey:e.metaKey,ctrlKey:e.ctrlKey,altKey:e.altKey})))},this.deleteEmptyExpand=()=>{let{state:e}=this.view,t=this.node;if(!this.input)return;let{selectionStart:n,selectionEnd:a}=this.input;n===a&&0===n&&t&&(0,i("l9G9n").isEmptyNode)(e.schema)(t)&&$(this.api?.analytics?.actions)(e,this.view.dispatch)},this.toggleExpand=()=>{let e=this.getPos();if("number"==typeof e&&this.allowInteractiveExpand){let{state:t,dispatch:n}=this.view;Q({editorAnalyticsAPI:this.api?.analytics?.actions,pos:e,node:this.node})(t,n),this.updateExpandToggleIcon(this.node)}},this.moveToOutsideOfTitle=e=>{e.preventDefault();let{state:t,dispatch:n}=this.view,a=this.getPos();if("number"!=typeof a)return;let o=a;this.isCollapsed()&&(o=a+this.node.nodeSize);let s=t.doc.resolve(o);if(!s)return;if(this.isCollapsed()&&s.nodeAfter&&["expand","nestedExpand"].indexOf(s.nodeAfter.type.name)>-1)return this.setRightGapCursor(e);let r=i("ks2lK").Selection.findFrom(s,1,!0);r&&(this.view.focus(),n(t.tr.setSelection(r)))},this.isCollapsed=()=>!i("adayn").expandedState.get(this.node),this.setRightGapCursor=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{value:n,selectionStart:a,selectionEnd:o}=this.input,s=null!=a&&a>=0&&a<=n.length,r=null!=o&&o>=0&&o<=n.length;if(s&&r){let{state:n,dispatch:a}=this.view;e.preventDefault(),this.view.focus(),a(n.tr.setSelection(new(0,i("adhil").GapCursorSelection)(n.doc.resolve(this.node.nodeSize+t),i("adhil").Side.RIGHT)))}},this.moveToPreviousLine=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view,o=n.doc.resolve(t);if(!o)return;if(0===o.pos)return void this.setLeftGapCursor(e);let s=i("ks2lK").Selection.findFrom(o,-1);s&&(this.view.focus(),a(n.tr.setSelection(s)))}},this.setLeftGapCursor=e=>{if(!this.input)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus(),a(n.tr.setSelection(new(0,i("adhil").GapCursorSelection)(n.doc.resolve(t),i("adhil").Side.LEFT)))}},this.handleArrowRightFromTitle=e=>{if(!this.input||!this.selectNearNode)return;let t=this.getPos();if("number"!=typeof t)return;let{value:n,selectionStart:a,selectionEnd:o}=this.input;if(a===o&&a===n.length){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus();let o=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.End,selection:i("ks2lK").NodeSelection.create(n.doc,t)})(n);a&&a(o)}},this.handleArrowLeftFromTitle=e=>{if(!this.input||!this.selectNearNode)return;let t=this.getPos();if("number"!=typeof t)return;let{selectionStart:n,selectionEnd:a}=this.input;if(n===a&&0===n){e.preventDefault();let{state:n,dispatch:a}=this.view;this.view.focus();let o=this.api?.selection?.sharedState.currentState()||{};if(o?.selectionRelativeToNode===void 0){let e=this.selectNearNode({selectionRelativeToNode:void 0,selection:new(0,i("adhil").GapCursorSelection)(n.doc.resolve(t),i("adhil").Side.LEFT)})(n);a&&a(e)}else{let e=this.selectNearNode({selectionRelativeToNode:i("cQ4aK").RelativeSelectionPos.Start,selection:i("ks2lK").NodeSelection.create(n.doc,t)})(n);a&&a(e)}}},this.handleUndoFromTitle=e=>{let{state:t,dispatch:n}=this.view;(0,i("ke2AI").undo)(t,n),e.preventDefault()},this.handleRedoFromTitle=e=>{let{state:t,dispatch:n}=this.view;(0,i("ke2AI").redo)(t,n),e.preventDefault()},this.getContentEditable=e=>{let t=!(0,i("adayn").isExpandCollapsed)(e);return this.api&&this.api.editorDisabled?!this.api.editorDisabled.sharedState.currentState()?.editorDisabled&&t:t},this.renderIcon=(e,t)=>{e&&this.nodeViewPortalProviderAPI.render(()=>(0,a.jsx)(el,{intl:this.intl,allowInteractiveExpand:this.allowInteractiveExpand,expanded:t}),e,this.renderKey)},this.intl=s(),this.nodeViewPortalProviderAPI=c,this.allowInteractiveExpand=p,this.getPos=o,this.view=n,this.node=t;let{dom:g,contentDOM:T}=i("5SAOw").DOMSerializer.renderSpec(document,ec(t,this.__livePage,this.intl,d?.editorDisabled?.sharedState.currentState()?.editorDisabled));if(this.dom=g,this.contentDOM=T,this.isMobile=r,this.api=d,this.icon=this.dom.querySelector(`.${i("iMS6j").expandClassNames.icon}`),this.input=this.dom.querySelector(`.${i("iMS6j").expandClassNames.titleInput}`),this.titleContainer=this.dom.querySelector(`.${i("iMS6j").expandClassNames.titleContainer}`),this.renderKey=e(M)(),this.content=this.dom.querySelector(`.${i("iMS6j").expandClassNames.content}`),i("adayn").expandedState.has(this.node)||i("adayn").expandedState.set(this.node,!1),(0,u.expValEquals)("platform_editor_native_expand_button","isEnabled",!0)?this.renderNativeIcon(this.node):this.renderIcon(this.icon,!(0,i("adayn").isExpandCollapsed)(this.node)),!this.input||!this.titleContainer||!this.icon)return;this.dom.addEventListener("click",this.handleClick),this.dom.addEventListener("input",this.handleInput),this.input.addEventListener("keydown",this.handleTitleKeydown),this.input.addEventListener("blur",this.handleBlur),this.input.addEventListener("focus",this.handleInputFocus),this.titleContainer.addEventListener("focus",this.handleFocus),this.icon.addEventListener("keydown",this.handleIconKeyDown),this.api?.editorDisabled&&(this.cleanUpEditorDisabledOnChange=this.api.editorDisabled.sharedState.onChange(e=>{let t=e.nextSharedState.editorDisabled;this.input&&(t?this.input.setAttribute("readonly","true"):this.input.removeAttribute("readonly")),this.content&&this.content.setAttribute("contenteditable",this.getContentEditable(this.node)?"true":"false")}))}}function em({getIntl:e,isMobile:t,api:n,nodeViewPortalProviderAPI:a,allowInteractiveExpand:i=!0,__livePage:o}){return(s,r,l)=>new eh(s,r,l,e,t,n?.selection?.actions?.selectNearNode,n,a,i,o)}let ef=new(0,i("ks2lK").PluginKey)("expandPlugin");function eg(e,t){return!!e?.classList?.contains(t)}let eT=(e,t,n="full-page",a=!1,o,s,r=!0,l=!1)=>new(0,i("1S4f7").SafePlugin)({key:ef,props:{nodeViews:{expand:em({getIntl:t,isMobile:!1,api:o,nodeViewPortalProviderAPI:s,allowInteractiveExpand:r,__livePage:l}),nestedExpand:em({getIntl:t,isMobile:!1,api:o,nodeViewPortalProviderAPI:s,allowInteractiveExpand:r,__livePage:l})},handleKeyDown:(e,t)=>eg(t.target,i("iMS6j").expandClassNames.titleContainer),handleKeyPress:(e,t)=>eg(t.target,i("iMS6j").expandClassNames.titleContainer),handleScrollToSelection:()=>eg(document.activeElement,i("iMS6j").expandClassNames.titleInput),handleClickOn:(0,i("3tffm").createSelectionClickHandler)(["expand","nestedExpand"],e=>e.classList.contains(i("iMS6j").expandClassNames.prefix),{useLongPressSelection:a}),handleDrop:(e,t,n,a)=>(function(e,t,n){let{state:a,dispatch:o}=e,s=a.tr,{selection:r}=a,{from:l,to:d}=r,c=!1,p=!1;if(n.content.forEach(e=>{e.type===a.schema.nodes.expand?c=!0:e.type===a.schema.nodes.nestedExpand&&(p=!0)}),!c&&!p||c&&p)return!1;let u=e.posAtCoords({left:t.clientX,top:t.clientY});if(!u)return!1;let h=a.doc.resolve(u.pos),m=h.node().type,f=h.depth>0?h.node(h.depth-1).type:m,g=[a.schema.nodes.expand,a.schema.nodes.tableHeader,a.schema.nodes.tableCell],T=g.includes(m)||g.includes(f),E=m===a.schema.nodes.nestedExpand||f===a.schema.nodes.nestedExpand,y=n;if(c&&T?y=(0,i("hcbpx").transformSliceExpandToNestedExpand)(n):!p||T||E||(y=(0,i("hcbpx").transformSliceNestedExpandToExpand)(n,a.schema)),!y||y.eq(n))return!1;let _=u.pos>l?u.pos-y.content.size:u.pos;return m===a.schema.nodes.doc||c||(_-=1),s.delete(l,d),s.insert(_,y.content),o(s),!0})(e,t,n)},filterTransaction:e=>!eg(document.activeElement,i("iMS6j").expandClassNames.titleInput)||!e.selectionSet||!!e.steps.length&&!e.isGeneric}),eE=t=>(n,{formatMessage:a})=>{let{hoverDecoration:o}=t?.decorations?.actions??{},s=t?.analytics?.actions,r=ep(n);if(r){let{nestedExpand:t,expand:l}=n.schema.nodes;return{title:"Expand toolbar",getDomRef:e=>(0,p.findDomRefAtPos)(r.pos,e.domAtPos.bind(e)),nodeType:[t,l],offset:[0,6],items:[{type:"copy-button",items:[{state:n,formatMessage:a,nodeType:[t,l]}]},{type:"separator"},{id:"editor.expand.delete",type:"button",appearance:"danger",focusEditoronEnter:!0,icon:e(i("gKvd9")),onClick:$(s),onMouseEnter:o?.([t,l],!0),onMouseLeave:o?.([t,l],!1),onFocus:o?.([t,l],!0),onBlur:o?.([t,l],!1),title:a(i("61p3e").default.remove),tabIndex:null}]}}},ey=({config:e={},api:t})=>((0,s.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)&&t?.blockMenu?.actions.registerBlockMenuComponents([{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_EXPAND_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_EXPAND_MENU_ITEM.key]},component:c(t)}]),{name:"expand",nodes:()=>[{name:"expand",node:(0,i("dh538").fg)("platform_editor_adf_with_localid")?i("4r9Pq").expandWithNestedExpandLocalId:i("4r9Pq").expandWithNestedExpand},{name:"nestedExpand",node:(0,i("dh538").fg)("platform_editor_adf_with_localid")?i("iw2ID").nestedExpandWithLocalId:i("iw2ID").nestedExpand}],actions:{insertExpand:Y(t),insertExpandWithInputMethod:X(t)},commands:{toggleExpandWithMatch:e=>ea(e),toggleExpandRange:r},pmPlugins:()=>[{name:"expand",plugin:({dispatch:n,getIntl:a,nodeViewPortalProviderAPI:i})=>eT(n,a,e.appearance,e.useLongPressSelection,t,i,e.allowInteractiveExpand??!0,e.__livePage)},{name:"expandKeymap",plugin:()=>(function(e){let t={};return(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveRight.common,(t,n,a)=>{if(!a)return!1;let{selection:o}=t,{selectionRelativeToNode:s}=e?.selection?.sharedState.currentState()||{};return!!eo(o)&&s===i("cQ4aK").RelativeSelectionPos.Start&&et(o.from+1)(t,n,a)},t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveLeft.common,(t,n,a)=>{if(!a)return!1;let{selection:o}=t,{selectionRelativeToNode:s}=e?.selection?.sharedState.currentState()||{};return!!eo(o)&&(void 0===s||s===i("cQ4aK").RelativeSelectionPos.End)&&et(o.from+1)(t,n,a)},t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").tab.common,(e,t,n)=>{if(n&&n.dom instanceof HTMLElement){let{from:a}=e.selection;if(eo(e.selection)){let i=n.nodeDOM(a);return!!i&&en(i)(e,t,n)}if(e.selection instanceof i("ks2lK").TextSelection&&!(0,i("bMyNT").isInTable)(e)){let a=(0,i("hcbpx").findExpand)(e);if(a){let i=n.nodeDOM(a.pos);if(i)return en(i)(e,t,n)}}}return!1},t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveUp.common,(e,t,n)=>{if(!n)return!1;let{selection:a,schema:o}=e,{nodeBefore:s}=a.$from;if(a instanceof i("adhil").GapCursorSelection&&a.side===i("adhil").Side.RIGHT&&s&&(s.type===o.nodes.expand||s.type===o.nodes.nestedExpand)&&(0,i("adayn").isExpandCollapsed)(s)){let{$from:i}=a;return et(Math.max(i.pos-1,0))(e,t,n)}let{$from:r}=e.selection;if(n.endOfTextblock("up")){let a=(0,i("hcbpx").findExpand)(e);if((0,i("caYZ2").isPositionNearTableRow)(r,o,"before")&&!a)return!1;let s=Math.max(r.pos-r.parentOffset-1,0);if(a&&a.start===s)return et(a.start)(e,t,n);let l=i("ks2lK").Selection.findFrom(e.doc.resolve(s),-1),d=(0,i("hcbpx").findExpand)(e,l);if(l&&d)return(0,i("adayn").isExpandCollapsed)(d.node)?et(d.start)(e,t,n):(t&&t(e.tr.setSelection(l)),!0)}return!1},t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").moveDown.common,(e,t,n)=>{if(!n)return!1;let{expand:a,nestedExpand:o}=e.schema.nodes,{selection:s}=e,{nodeAfter:r}=s.$from;if(s instanceof i("adhil").GapCursorSelection&&s.side===i("adhil").Side.LEFT&&r&&(r.type===a||r.type===o)&&(0,i("adayn").isExpandCollapsed)(r)){let{$from:a}=s;return et(a.pos+1)(e,t,n)}if((0,u.expValEquals)("platform_editor_lovability_navigation_fixes","isEnabled",!0)){let a=(0,i("adayn").getNextNodeExpandPos)(n,s);if(void 0!==a)return et(a)(e,t,n)}if(n.endOfTextblock("down")){let{$from:i}=e.selection;if(0===i.depth)return!1;let s=e.doc.resolve(i.after());if(s.nodeAfter&&(s.nodeAfter.type===a||s.nodeAfter.type===o))return et(s.pos+1)(e,t,n)}return!1},t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").backspace.common,(t,n,a)=>{let{selection:o}=t,{$from:s}=o;if(!a||!o.empty)return!1;let{expand:r,nestedExpand:l}=t.schema.nodes,d=(0,i("hcbpx").findExpand)(t);if(!d){let e=i("ks2lK").Selection.findFrom(t.doc.resolve(Math.max(o.$from.pos-1,0)),-1),s=(0,i("hcbpx").findExpand)(t,e);return!!(s&&(s.node.type===r||s.node.type===l)&&(0,i("adayn").isExpandCollapsed)(s.node))&&et(s.start)(t,n,a)}let c=t.doc.nodeAt(s.before(Math.max(s.depth-1,1)));if(c&&!ei(c))return!1;let p=i("ks2lK").Selection.findFrom(t.doc.resolve(d.pos),1,!0);return!!(p&&o.$from.pos===p.$from.pos&&(0,i("l9G9n").isEmptyNode)(t.schema)(d.node))&&!!n&&$(e?.analytics?.actions)(t,n)},t),(0,i("dus6D").keymap)(t)})(t)}],pluginsOptions:{floatingToolbar:eE(t),quickInsert:({formatMessage:n})=>e&&!0!==e.allowInsertion?[]:[{id:"expand",title:n(i("4HWgE").toolbarInsertBlockMessages.expand),description:n(i("4HWgE").toolbarInsertBlockMessages.expandDescription),keywords:["accordion","collapse"],priority:600,icon:()=>(0,a.jsx)(o.IconExpand,{}),action(e,n){let a=q(n,void 0,!!t?.localId);if(!a)return!1;let o=n.selection.empty?e(a):(0,i("dh538").fg)("platform_editor_adf_with_localid")?W(n,a):(0,i("l9FJJ").createWrapSelectionTransaction)({state:n,type:a.type});return t?.analytics?.actions.attachAnalyticsEvent({action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a.type===n.schema.nodes.nestedExpand?i("d925B").ACTION_SUBJECT_ID.NESTED_EXPAND:i("d925B").ACTION_SUBJECT_ID.EXPAND,attributes:{inputMethod:i("d925B").INPUT_METHOD.QUICK_INSERT},eventType:i("d925B").EVENT_TYPE.TRACK})(o),o}}]}});t.exports.expandPlugin=({config:e={},api:t})=>e?.__livePage||(0,i("dh538").fg)("platform-editor-single-player-expand")?ey({config:e,api:t}):H({config:e,api:t})}),o("05jmd",function(t,n){var a=i("l998X");i("42omo");var o=i("3pLGZ"),s=i("8m4tT"),r=i("dZ8uq"),l=i("iu6m9");let d={1:100,2:50,3:33.33,4:25,5:20},c=new(0,i("ks2lK").PluginKey)("layout"),p=["single"],u=["two_equal","two_left_sidebar","two_right_sidebar"],h=["three_equal","three_with_sidebars"],m=e=>{if((0,l.editorExperiment)("advanced_layouts",!0))switch(e){case"single":return[100];case"two_equal":return[50,50];case"three_equal":return[33.33,33.33,33.33];case"two_left_sidebar":return[33.33,66.66];case"two_right_sidebar":return[66.66,33.33];case"three_with_sidebars":return[25,50,25];case"three_left_sidebars":return[25,25,50];case"three_right_sidebars":return[50,25,25];case"four_equal":return[25,25,25,25];case"five_equal":return[20,20,20,20,20]}switch(e){case"single":return[100];case"two_equal":return[50,50];case"three_equal":return[33.33,33.33,33.33];case"two_left_sidebar":return[33.33,66.66];case"two_right_sidebar":return[66.66,33.33];case"three_with_sidebars":return[25,50,25]}return[]},f=e=>{let t=0,n=!1;return(0,i("3Ter7").mapChildren)(e,e=>e.attrs.width).forEach(e=>{"number"==typeof e&&isFinite(e)&&e>0&&e<=100?t+=e:n=!0}),!n&&100===Math.round(t)},g=e=>{let t=(0,i("3Ter7").mapChildren)(e,e=>e.attrs.width).join(",");if((0,l.editorExperiment)("advanced_layouts",!0)){switch(t){case"100":return"single";case"33.33,33.33,33.33":return"three_equal";case"25,50,25":return"three_with_sidebars";case"50,25,25":return"three_right_sidebars";case"25,25,50":return"three_left_sidebars";case"50,50":return"two_equal";case"33.33,66.66":return"two_left_sidebar";case"66.66,33.33":return"two_right_sidebar";case"25,25,25,25":return"four_equal";case"20,20,20,20,20":return"five_equal"}return}switch(t){case"100":return"single";case"33.33,33.33,33.33":return"three_equal";case"25,50,25":return"three_with_sidebars";case"50,50":return"two_equal";case"33.33,66.66":return"two_left_sidebar";case"66.66,33.33":return"two_right_sidebar"}},T=(e,t)=>e.childCount!==m(t).length,E=(e,t)=>e&&T(e,t)&&(0,l.editorExperiment)("advanced_layouts",!0)?M(e):e&&g(e)&&g(e)||t,y=(e,t=2)=>{let{layoutSection:n,layoutColumn:a}=e.schema.nodes,o=i("5SAOw").Fragment.fromArray(Array.from({length:t},()=>a.createAndFill({width:d[t]})));return n.createAndFill(void 0,o)},_=e=>{let{layoutSection:t,layoutColumn:n}=e.schema.nodes,a=i("5SAOw").Fragment.fromArray([n.createAndFill({width:50}),n.createAndFill({width:50})]);return t.createAndFill(void 0,a)},S=e=>t=>(0,i("dAtrv").withAnalytics)(e,{action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.LAYOUT,attributes:{inputMethod:t,columnCount:(0,i("dh538").fg)("platform_editor_column_count_analytics")?2:void 0},eventType:i("d925B").EVENT_TYPE.TRACK})((e,t)=>(t&&t((0,s.safeInsert)(_(e))(e.tr)),!0));function b(e,t){return(0,l.editorExperiment)("advanced_layouts",!1)?n=>{n.replaceWith(n.mapping.map(t),n.mapping.map(t),e.nodes.layoutColumn.createAndFill())}:n=>{n.replaceWith(n.mapping.map(t),n.mapping.map(t),e.nodes.layoutColumn.createAndFill(void 0))}}function C(e,t,n){return a=>{if((0,i("2pjJ5").isEmptyDocument)(e)){let e=(0,l.editorExperiment)("single_column_layouts",!0)?t:t-1;a.replaceRange(a.mapping.map(e),a.mapping.map(n),i("5SAOw").Slice.empty)}else a.replaceRange(a.mapping.map(t-1),a.mapping.map(t+1),i("5SAOw").Slice.empty)}}let v=(e,t)=>n=>{b(e,t)(n),b(e,t)(n)},I=(e,t,n)=>{let a=e.content.child(2);C(a,n-a.nodeSize,n)(t);let i=e.content.child(1);C(i,n-a.nodeSize-i.nodeSize,n)(t)},N=(e,t,n=1)=>a=>{for(let i=0;i<n;i++)b(e,t)(a)},k=(e,t,n=1)=>a=>{let i=t,o=e.content.lastChild;for(let t=0;t<n;t++)o&&C(o,i-o.nodeSize,i)(a),i-=o?.nodeSize||0,o=e.content.child(e.childCount-t-2)};function x(e,t,n){let{layoutColumn:a}=t.nodes,o=n.map(e=>Number(e.toFixed(2)));return(0,i("3Ter7").flatmap)(e.content,(e,t)=>e.type===a?a.create({...e.attrs,width:o[t]},e.content,e.marks):e)}function A(e,t,n,a){let o=((0,l.editorExperiment)("advanced_layouts",!0)?function(e,t,n,a){let i=e.tr,o=n+t.nodeSize-1,s=t.childCount,r=m(a).length-s;return r>0?N(e.schema,o,r)(i):r<0&&k(t,o,-r)(i),i}:function(e,t,n,a){let i=e.tr,o=n+t.nodeSize-1,s=t.childCount;if(u.indexOf(a)>=0&&3===s){let e=t.content.child(2),n=o-e.nodeSize;C(e,n,o)(i)}else if(h.indexOf(a)>=0&&2===s)b(e.schema,o)(i);else if(p.indexOf(a)>=0&&2===s){let e=t.content.child(1),n=o-e.nodeSize;C(e,n,o)(i)}else p.indexOf(a)>=0&&3===s?I(t,i,o):u.indexOf(a)>=0&&1===s?b(e.schema,o)(i):h.indexOf(a)>=0&&1===s&&v(e.schema,o)(i);return i})(e,t,n,a),s=o.selection,r=(o=function(e,t,n,a){let i=t.doc.nodeAt(n);return i?t.replaceWith(n+1,n+i.nodeSize-1,x(i,e.schema,m(a))):t}(e,o,n,a)).doc.resolve(s.$from.pos);return o.setSelection(e.selection instanceof i("ks2lK").NodeSelection?new(0,i("ks2lK").NodeSelection)(r):new(0,i("ks2lK").TextSelection)(r))}let O=e=>t=>(n,a)=>{let{pos:o,selectedLayout:s}=c.getState(n);if(null===o)return!1;let r=n.doc.nodeAt(o);if(!r||s===t&&r.childCount>1)return!1;let l=A(n,r,o,t);return!!l&&(e?.attachAnalyticsEvent({action:i("d925B").ACTION.CHANGED_LAYOUT,actionSubject:i("d925B").ACTION_SUBJECT.LAYOUT,attributes:{previousLayout:L(s),newLayout:L(t)},eventType:i("d925B").EVENT_TYPE.TRACK})(l),l.setMeta("scrollIntoView",!1),a&&a(l),!0)};function P(e){return(0,l.editorExperiment)("advanced_layouts",!0)?!g(e)||!f(e):!g(e)}let M=e=>{let t=e.childCount;if(t<=1)return"single";switch(t){case 1:return"single";case 2:return"two_equal";case 3:return"three_equal";case 4:return"four_equal";default:return"five_equal"}};function w(e,t,n){if(e.type===n.nodes.layoutSection){if(!P(e))return;let a=(0,l.editorExperiment)("advanced_layouts",!0)?M(e):2===e.childCount?"two_equal":3===e.childCount?"three_equal":"single",o=x(e,n,m(a));return{from:t+1,to:t+e.nodeSize-1,slice:new(0,i("5SAOw").Slice)(o,0,0)}}}let D=(e,t)=>{let n,{layoutSection:a}=t.schema.nodes,o=(0,i("2pjJ5").getStepRange)(e);if(!o)return;e.doc.nodesBetween(o.from,o.to,(e,i)=>e.type!==a||(P(e)&&(n=w(e,i,t.schema)),!1));let s=e.doc.resolve(o.to);if(s.depth>0){let i=s.after(),o=e.doc.nodeAt(i);o&&o.type===a&&P(o)&&(n=w(o,i,t.schema))}return n},R=e=>{let{pos:t,selectedLayout:n}=c.getState(e);if(null!==t&&n){let a=e.doc.nodeAt(t);if(a&&(a.childCount!==m(n).length||!f(a)&&(0,l.editorExperiment)("advanced_layouts",!0)))return A(e,a,t,n)}},B=(e,t)=>(n,a)=>{let{pos:o,selectedLayout:s}=c.getState(n);if(null!==o){let r=n.doc.nodeAt(o);if(a){let l=n.tr.delete(o,o+r.nodeSize);e?.attachAnalyticsEvent({action:i("d925B").ACTION.DELETED,actionSubject:i("d925B").ACTION_SUBJECT.LAYOUT,attributes:{layout:L(s),inputMethod:t},eventType:i("d925B").EVENT_TYPE.TRACK})(l),a(l)}return!0}return!1},L=e=>{if((0,l.editorExperiment)("advanced_layouts",!0))switch(e){case"single":return i("eKaDU").LAYOUT_TYPE.SINGLE_COL;case"two_equal":return i("eKaDU").LAYOUT_TYPE.TWO_COLS_EQUAL;case"three_equal":return i("eKaDU").LAYOUT_TYPE.THREE_COLS_EQUAL;case"two_left_sidebar":return i("eKaDU").LAYOUT_TYPE.LEFT_SIDEBAR;case"two_right_sidebar":return i("eKaDU").LAYOUT_TYPE.RIGHT_SIDEBAR;case"three_with_sidebars":return i("eKaDU").LAYOUT_TYPE.THREE_WITH_SIDEBARS;case"four_equal":return i("eKaDU").LAYOUT_TYPE.FOUR_COLS_EQUAL;case"five_equal":return i("eKaDU").LAYOUT_TYPE.FIVE_COLS_EQUAL}switch(e){case"single":return i("eKaDU").LAYOUT_TYPE.SINGLE_COL;case"two_equal":return i("eKaDU").LAYOUT_TYPE.TWO_COLS_EQUAL;case"three_equal":return i("eKaDU").LAYOUT_TYPE.THREE_COLS_EQUAL;case"two_left_sidebar":return i("eKaDU").LAYOUT_TYPE.LEFT_SIDEBAR;case"two_right_sidebar":return i("eKaDU").LAYOUT_TYPE.RIGHT_SIDEBAR;case"three_with_sidebars":return i("eKaDU").LAYOUT_TYPE.THREE_WITH_SIDEBARS}},U=e=>{let{schema:{nodes:{layoutSection:t,layoutColumn:n}},selection:a}=e;return(0,l.editorExperiment)("advanced_layouts",!0)&&(0,s.findSelectedNodeOfType)([n])(a)?void 0:(0,s.findParentNodeOfType)(t)(a)||(0,s.findSelectedNodeOfType)([t])(a)},K=(e,t,n=0)=>{let a=e.state.doc.resolve(t);if(a.nodeAfter?.type.name==="layoutSection"){let t=a.nodeAfter;if(n<0||n>=t.childCount)return;let o=a.posAtIndex(n,1),s=e.state.tr,r=s.doc.resolve(o);return t.firstChild?.type.name==="paragraph"?e.dispatch(s.setSelection(i("ks2lK").TextSelection.near(r))):e.dispatch(s.setSelection(i("adhil").GapCursorSelection.near(r))),s}},F=e=>{let t=(0,s.findParentNodeOfType)(e.schema.nodes.layoutColumn)(e.selection);return!!t&&e.selection.from<t.pos+t.node.nodeSize},j=(e,t)=>{let{selection:n}=e,{schema:{nodes:{layoutColumn:a,layoutSection:o}}}=e,r=(0,s.findParentNodeOfType)(o)(n),l=(0,s.findParentNodeOfType)(a)(n);if(l.node!==r.node.lastChild){let n=e.doc.resolve(l.pos+l.node.nodeSize),a=i("ks2lK").TextSelection.findFrom(n,1);t&&t(e.tr.setSelection(a))}return!0},G=(e,t)=>[i("ftzrq").Decoration.node(e,e+t.nodeSize,{class:"selected"})],V=(e,t)=>{let n=U(t),a=e.allowBreakout||!1,i=e.UNSAFE_addSidebarLayouts||!1,o=e.UNSAFE_allowSingleColumnLayout||!1;return{pos:n?n.pos:null,allowBreakout:a,addSidebarLayouts:i,selectedLayout:E(n&&n.node,"two_equal"),allowSingleColumnLayout:o,isResizing:!1}},z=(e,t)=>{let n=e.selection;if(n instanceof i("ks2lK").NodeSelection&&"layoutColumn"===n.node.type.name&&"layoutSection"===n.$from.parent.type.name&&2===n.$from.parent.childCount&&t&&(0,l.editorExperiment)("advanced_layouts",!0)&&!(0,l.editorExperiment)("single_column_layouts",!0)){let a=e.tr,o=0===n.$from.parentOffset?i("5SAOw").Fragment.from(n.$from.parent.lastChild?.content):i("5SAOw").Fragment.from(n.$from.parent.firstChild?.content),r=(0,s.findParentNodeClosestToPos)(n.$from,e=>"layoutSection"===e.type.name);if(r){let n=a.mapping.map(r.pos),i=r.node.nodeSize;return t(e.tr.replaceWith(n,n+i,o)),!0}}return!1};var H=e=>new(0,i("1S4f7").SafePlugin)({key:c,state:{init:(t,n)=>V(e,n),apply:(e,t,n,a)=>{let i=!!(0,l.editorExperiment)("single_column_layouts",!0)&&(e.getMeta("is-resizer-resizing")??c.getState(n)?.isResizing);if(e.docChanged||e.selectionSet){let e=U(a);return{...t,pos:e?e.pos:null,isResizing:i,selectedLayout:E(e&&e.node,t.selectedLayout)}}return{...t,isResizing:i}}},props:{decorations(e){let t=c.getState(e);if(null!==t.pos)return i("ftzrq").DecorationSet.create(e.doc,G(t.pos,e.doc.nodeAt(t.pos)))},handleKeyDown:(0,i("dus6D").keydownHandler)({Tab:(0,i("e7tBw").filterCommand)(F,j),"Mod-Backspace":z,"Mod-Delete":z,Backspace:z,Delete:z}),handleClickOn:(0,i("3tffm").createSelectionClickHandler)(["layoutColumn"],e=>e.hasAttribute("data-layout-section")||e.hasAttribute("data-layout-column"),{useLongPressSelection:e.useLongPressSelection||!1,getNodeSelectionPos:(e,t)=>e.doc.resolve(t).before()})},appendTransaction:(e,t,n)=>{let a=[];if(e.forEach(e=>{if(a.forEach(t=>({from:e.mapping.map(t.from),to:e.mapping.map(t.to),slice:t.slice})),!e.docChanged)return;let t=D(e,n);t&&a.push(t)}),(0,l.editorExperiment)("advanced_layouts",!0)&&1===a.length){let e=a[0];if(!(0,l.editorExperiment)("single_column_layouts",!0)&&1===e.slice.content.childCount&&e.slice.content.firstChild?.type.name==="layoutColumn"&&e.slice.content.firstChild?.attrs.width===d[1]){let t=n.tr,{content:a}=e.slice.content.firstChild;return t.replaceWith(e.from-1,e.to,a),t}}if(a.length){let e=n.tr,t=n.selection.toJSON();if(a.forEach(t=>{e.replaceRange(t.from,t.to,t.slice)}),(e=R(n)||e).docChanged)return e.setSelection(i("ks2lK").Selection.fromJSON(e.doc,t)),e}}}),q=i("42omo"),W=i("1oCLl");let X={lineLength:"grid",wide:"wide",fullWidth:"full_width"},Y={lineLength:"center",wide:"wide",fullWidth:"full-width"},$=(e,t=.5)=>Math.round(e/t)*t,J=["layoutSection","expand","codeBlock"],Z=(e,t)=>{if(t)return{left:{display:"none"},right:{display:"none"}};if("codeBlock"===e)return{left:{left:"-12px"},right:{right:"-12px"}};{let e=(0,i("dh538").fg)("platform_editor_nested_dnd_styles_changes")?2*i("boKri").LAYOUT_SECTION_MARGIN+12:2*i("boKri").LAYOUT_COLUMN_PADDING;return{left:{left:`-${e}px`,height:"calc(100% - 8px)",bottom:"0px",top:"unset"},right:{right:`-${e}px`,height:"calc(100% - 8px)",bottom:"0px",top:"unset"}}}},Q=e=>e.target instanceof Element&&e.target.classList.contains("resizer-item")||"attributes"===e.type&&"style"===e.attributeName,ee={left:"50%",transform:"translateX(-50%)",display:"grid"},et={display:"grid"},en=({editorView:t,nodeType:n,getPos:a,getRef:o,disabled:s,getEditorWidth:r,parentRef:d,displayGuidelines:c,editorAnalyticsApi:p,displayGapCursor:u,onResizeStart:h,dynamicFullWidthGuidelineOffset:m,hidden:f=!1})=>{let[{minWidth:g,maxWidth:T,isResizing:E},y]=(0,q.useState)({minWidth:void 0,maxWidth:void 0,isResizing:!1}),_=(0,q.useRef)(!1),S=(0,q.useRef)(null),{snaps:b,currentLayout:C,guidelines:v,setCurrentWidth:I}=function(e,t,n=0){let a=e(),{lineLength:o,wide:s,fullWidth:r}=(0,q.useMemo)(()=>{if(!t)return{};let{width:e,lineLength:o}=a||{},s=o?Math.round(o*i("aFUXX").breakoutWideScaleRatio):void 0,r=(0,l.editorExperiment)("single_column_layouts",!0)?i("aFUXX").akEditorCalculatedWideLayoutWidth:s,d=e&&e<=i("aFUXX").akEditorFullPageNarrowBreakout&&(0,l.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?i("aFUXX").akEditorGutterPaddingReduced:(0,i("aFUXX").akEditorGutterPaddingDynamic)(),c=e?e-(d+n)*2:void 0;return{wide:r,fullWidth:e&&c?Math.min(c,i("aFUXX").akEditorFullWidthLayoutWidth):void 0,lineLength:(0,l.editorExperiment)("single_column_layouts",!0)?i("aFUXX").akEditorDefaultLayoutWidth:o}},[a,t,n]),d=(0,q.useMemo)(()=>r&&s&&o&&!(r<=((0,l.editorExperiment)("single_column_layouts",!0)?i("aFUXX").akEditorDefaultLayoutWidth:o))?r-s>8?{lineLength:o,wide:s,fullWidth:r}:r<=s&&r-o>8?{lineLength:o,fullWidth:r}:null:null,[r,o,s]),c=(0,q.useMemo)(()=>t&&d?{x:Object.values(d)}:null,[d,t]),[p,u]=(0,q.useState)(null),h=(0,q.useMemo)(()=>{let e=[];return d&&Object.entries(d).map(([t,n])=>{n&&(e.push({key:`${X[t]}_left`,position:{x:-$(n/2)},active:p===Y[t]}),e.push({key:`${X[t]}_right`,position:{x:$(n/2)},active:p===Y[t]}))}),e},[d,p]);return{snaps:c,currentLayout:p,guidelines:h,setCurrentWidth:(0,q.useCallback)(e=>{if("number"!=typeof e)return void u(null);o&&4>Math.abs(e-o)?u("center"):s&&4>Math.abs(e-s)?u("wide"):r&&(r+i("aFUXX").akEditorGutterPadding-e<4||e>=r)?u("full-width"):u(null)},[o,s,r])}}(r,E&&(0,l.editorExperiment)("single_column_layouts",!0),m),N=(0,W.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,i("d7ZU3").getBrowserInfo)():i("d7ZU3").browser;(0,q.useEffect)(()=>{c&&c(v||[])},[c,v]);let k=(0,q.useMemo)(()=>{let e=a();if(void 0===e)return!1;let n=t.state.doc.nodeAt(e);if(null===n)return!1;let i=e+n.nodeSize,{$from:o,$to:s}=t.state.selection;return o.pos>=e&&i>=s.pos},[t.state.doc,t.state.selection,a]),x=(0,q.useCallback)(()=>{let e,n;h?.();let a=r(),{dispatch:o,state:s}=t;if(u(!1),void 0!==a&&void 0!==a.lineLength&&void 0!==a.width){let t=a.width<=i("aFUXX").akEditorFullPageNarrowBreakout&&(0,l.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?i("aFUXX").akEditorGutterPaddingReduced:(0,i("aFUXX").akEditorGutterPaddingDynamic)();n=Math.min(a.width-2*t-i("aFUXX").akEditorGutterPadding,i("aFUXX").akEditorFullWidthLayoutWidth),e=Math.min(a.lineLength,i("aFUXX").akEditorDefaultLayoutWidth,n)}y({isResizing:!0,minWidth:e,maxWidth:n}),o(s.tr.setMeta("is-resizer-resizing",!0))},[h,r,t,u]),A=(0,q.useCallback)((e,t)=>{(0,l.editorExperiment)("single_column_layouts",!0)&&I(e.width+t.width)},[I]),O=(0,q.useCallback)((e,n)=>{let o=e.width+n.width,s=a();if(void 0===s)return;let{state:r,dispatch:d}=t,{breakout:c}=r.schema.marks,h=r.doc.nodeAt(s),m=r.tr;if(h&&J.includes(h.type.name))if(C&&["wide","full-width"].includes(C)&&(0,l.editorExperiment)("single_column_layouts",!0))m.setNodeMarkup(s,h.type,h.attrs,[c.create({mode:C,width:null})]);else{let t=Math.max(o,i("aFUXX").akEditorDefaultLayoutWidth);m.setNodeMarkup(s,h.type,h.attrs,[c.create({width:t})]);let n={action:i("d925B").ACTION.RESIZED,actionSubject:i("d925B").ACTION_SUBJECT.ELEMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{nodeType:h.type.name,prevWidth:e.width,newWidth:t}};p?.attachAnalyticsEvent(n)(m)}m.setMeta("is-resizer-resizing",!1).setMeta("scrollIntoView",!1),u(!0),d(m),y({isResizing:!1,minWidth:void 0,maxWidth:void 0}),I(null)},[a,t,u,I,C,p]),P=(0,q.useCallback)(()=>{t?.focus()},[t]),M=(0,q.useCallback)(e=>{if(!d)return;let t=d.closest(".resizer-item");if(!(t instanceof HTMLElement))return;let n=t.offsetWidth+e;T&&n>T||g&&n<g||O({width:t.offsetWidth,x:0,y:0,height:0},{width:e,height:0})},[O,T,g,d]),w=(0,q.useCallback)(e=>{let t="BracketRight"===e.code||"BracketLeft"===e.code,n=N.mac?e.metaKey:e.ctrlKey;(e.altKey||n||e.shiftKey)&&(_.current=!0),e.altKey&&n?t&&(e.preventDefault(),M("BracketRight"===e.code?10:-10)):_.current||P()},[P,M,N]),D=(0,q.useCallback)(e=>{(e.altKey||e.metaKey)&&(_.current=!1)},[_]),R=(0,q.useCallback)(e=>{if(!S.current)return;let t=S.current.getResizerThumbEl(),n=N.mac?e.metaKey:e.ctrlKey,a=e.target instanceof HTMLElement&&e.target.classList.contains("resizer-handle-thumb");if(e.altKey&&e.shiftKey&&n&&"KeyR"===e.code||a&&(e.altKey||n||e.shiftKey)){if(e.preventDefault(),!t)return;t.focus(),t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},[S,N]);return((0,q.useLayoutEffect)(()=>{if(!S.current||!t)return;let e=S.current.getResizerThumbEl();if(!e)return;let n=t.dom,a=(0,i("fFa3V").bind)(n,{type:"keydown",listener:R}),o=(0,i("fFa3V").bindAll)(e,[{type:"keydown",listener:w},{type:"keyup",listener:D}]);return()=>{a(),o()}},[t,R,w,D]),s)?e(q).createElement("div",{"data-testid":"breakout-resizer-editor-view-wrapper",ref:e=>o&&o(e)}):e(q).createElement(i("8b5jG").default,{ref:S,enable:{left:!0,right:!0},snap:b||void 0,snapGap:8,handleStyles:Z(n,f),minWidth:g,maxWidth:T,style:E?ee:et,handleResizeStart:x,handleResizeStop:O,handleResize:A,childrenDOMRef:o,resizeRatio:2,isHandleVisible:k,handleSize:"clamped",handleHighlight:"full-height",handlePositioning:"adjacent",handleAlignmentMethod:"sticky",labelComponent:C&&(0,l.editorExperiment)("single_column_layouts",!0)&&["full-width","wide"].includes(C||"")&&e(q).createElement(i("7x0qS").ResizerBreakoutModeLabel,{layout:C})})},ea=e=>!!e&&"paragraph"===e.type.name&&!e.childCount,ei=e=>!!e.marks.breakout,eo=e=>{if(!e||e.content.size/e.childCount!=4)return!1;let t=!0;return e.content.forEach(e=>{if("layoutColumn"!==e.type.name||e.childCount>1||!ea(e.firstChild)){t=!1;return}}),t},es=e=>({editorDisabled:e.editorDisabledState?.editorDisabled}),er=({pluginInjectionApi:e,forwardRef:t,getPos:n,view:o,parentRef:s})=>{let{editorDisabled:r}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["editorDisabled"],es),d=(0,i("b3YrF").useSharedPluginStateSelector)(e,"interaction.interactionState"),c=(0,q.useCallback)(t=>e?.core?.actions.execute(e?.selection?.commands.displayGapCursor(t))??!1,[e]),p=(0,q.useCallback)(t=>{e?.guideline?.actions?.displayGuideline(o)({guidelines:t})},[e,o]),u=(0,q.useCallback)(()=>{let e=n();void 0!==e&&K(o,e,0)},[n,o]);return"hasNotHadInteraction"!==d||(0,W.expValEquals)("platform_editor_breakout_interaction_rerender","isEnabled",!0)?(0,a.jsx)(en,{getRef:t,getPos:n,editorView:o,nodeType:"layoutSection",getEditorWidth:()=>e?.width?.sharedState.currentState(),disabled:!!(0,l.editorExperiment)("platform_editor_breakout_resizing",!0)||!0===r||!ei(o.state.schema),hidden:"hasNotHadInteraction"===d&&(0,W.expValEquals)("platform_editor_breakout_interaction_rerender","isEnabled",!0),parentRef:s,editorAnalyticsApi:e?.analytics?.actions,displayGuidelines:(0,l.editorExperiment)("single_column_layouts",!0)?p:void 0,displayGapCursor:c,onResizeStart:()=>{u()},dynamicFullWidthGuidelineOffset:16}):null},el=e=>["div",{class:"layout-section-container"},["div",{"data-layout-section":!0,...(0,i("dh538").fg)("platform_editor_adf_with_localid")&&{"data-local-id":e.attrs.localId}},0]];class ed extends i("2gkmX").default{getContentDOM(){let{dom:e,contentDOM:t}=i("5SAOw").DOMSerializer.renderSpec(document,el(this.node));return this.layoutDOM=e.querySelector("[data-layout-section]"),this.layoutDOM.setAttribute("data-column-rule-style",this.node.attrs.columnRuleStyle),this.layoutDOM.setAttribute("data-empty-layout",(!!this.isEmpty).toString()),(0,i("dh538").fg)("platform_editor_adf_with_localid")&&this.layoutDOM.setAttribute("data-local-id",this.node.attrs.localId),{dom:e,contentDOM:t}}setDomAttrs(e,t){this.layoutDOM&&this.layoutDOM.setAttribute("data-column-rule-style",e.attrs.columnRuleStyle)}render(e,t){return(this.isEmpty=eo(this.node),this.layoutDOM&&this.layoutDOM.setAttribute("data-empty-layout",(!!this.isEmpty).toString()),(0,W.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0))?null:(0,a.jsx)(er,{pluginInjectionApi:e.pluginInjectionApi,forwardRef:t,getPos:e.getPos,view:e.view,parentRef:this.layoutDOM})}ignoreMutation(e){return Q(e)}constructor(e){super(e.node,e.view,e.getPos,e.portalProviderAPI,e.eventDispatcher,e),this.options=void 0,this.layoutDOM=void 0,this.isEmpty=void 0,this.isEmpty=eo(this.node),this.options=e.options}}let ec=new(0,i("ks2lK").PluginKey)("layoutResizingPlugin");var ep=(e,t,n,a)=>new(0,i("1S4f7").SafePlugin)({key:ec,props:{nodeViews:{layoutSection:(i,o,s)=>new ed({node:i,view:o,getPos:s,portalProviderAPI:n,eventDispatcher:a,pluginInjectionApi:t,options:e}).init()}}});let eu=e=>(0,l.editorExperiment)("platform_editor_controls","variant1")?(0,i("9K4OG").css)({".ProseMirror-focused .layoutSectionView-content-wrap.selected [data-layout-column] > [data-layout-content] > p:only-child:has(.ProseMirror-trailingBreak:only-child)":{"&::before":{content:`"${e}"`,position:"absolute",color:"var(--ds-text-subtlest, #6B6E76)",pointerEvents:"none"}}}):(0,i("9K4OG").css)({".ProseMirror .layoutSectionView-content-wrap.selected [data-layout-column] > [data-layout-content] > p:only-child:has(.ProseMirror-trailingBreak:only-child)":{"&::before":{content:`"${e}"`,position:"absolute",color:"var(--ds-text-disabled, #A5ADBA)",font:'var(--ds-font-body, normal 400 14px/20px ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Ubuntu, "Helvetica Neue", sans-serif)',marginTop:"var(--ds-space-050, 4px)",pointerEvents:"none"}}}),eh=()=>{let{formatMessage:e}=(0,i("8C5kA").default)(),t=(0,q.useMemo)(()=>eu(e((0,l.editorExperiment)("platform_editor_controls","variant1")?i("l51YQ").toolbarMessages.controlslayoutPlaceholder:i("l51YQ").toolbarMessages.layoutPlaceholder)),[e]);return(0,i("9K4OG").jsx)(i("9K4OG").Global,{styles:t})};i("42omo");let em="layoutSection",ef=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)();return t?.blockMenu?.actions.isTransformOptionDisabled(em)?null:(0,a.jsx)(i("2GVu1").ToolbarDropdownItem,{onClick:e=>{let n=e.nativeEvent instanceof KeyboardEvent||0===e.nativeEvent.detail?i("d925B").INPUT_METHOD.KEYBOARD:i("d925B").INPUT_METHOD.MOUSE,a=i("d925B").INPUT_METHOD.BLOCK_MENU;t?.core.actions.execute(({tr:e})=>{let i=t?.blockMenu?.commands.transformNode(e.doc.type.schema.nodes.layoutSection,{inputMethod:a,triggeredFrom:n,targetTypeName:em});return i?i({tr:e}):null})},elemBefore:(0,a.jsx)(e(i("asgOl")),{label:""}),children:n(i("eKkkY").messages.layout)})},eg=e=>()=>(0,a.jsx)(ef,{api:e});i("42omo");let eT={name:"dzd8y1",styles:"padding:0 4px"},eE=({children:e})=>(0,i("9K4OG").jsx)("div",{css:eT},e),ey=()=>(0,i("9K4OG").jsx)(eE,null,(0,i("9K4OG").jsx)(e(i("gF8oK")),{label:""})),e_=()=>(0,i("9K4OG").jsx)(eE,null,(0,i("9K4OG").jsx)(e(i("2q3lZ")),{label:""}));i("42omo");let eS=t=>(0,a.jsx)(e(i("4ED0i")),{...t});i("42omo");let eb=t=>(0,a.jsx)(e(i("hLZr6")),{...t}),eC=[{id:"editor.layout.twoEquals",type:"two_equal",title:i("l51YQ").toolbarMessages.twoColumns,icon:e(i("asgOl"))},{id:"editor.layout.threeEquals",type:"three_equal",title:i("l51YQ").toolbarMessages.threeColumns,icon:e(i("f22ZH"))}],ev=[{id:"editor.layout.singeLayout",type:"single",title:i("l51YQ").toolbarMessages.singleColumn,icon:e(i("bmsMK"))},...eC],eI=[{id:"editor.layout.twoRightSidebar",type:"two_right_sidebar",title:i("l51YQ").toolbarMessages.rightSidebar,icon:e(i("dIYpm"))},{id:"editor.layout.twoLeftSidebar",type:"two_left_sidebar",title:i("l51YQ").toolbarMessages.leftSidebar,icon:e(i("e0qVa"))},{id:"editor.layout.threeWithSidebars",type:"three_with_sidebars",title:i("l51YQ").toolbarMessages.threeColumnsWithSidebars,icon:e(i("5NtbR"))}],eN=[{id:"editor.layout.twoEquals",type:"two_equal",title:i("l51YQ").toolbarMessages.twoColumns,icon:e(i("asgOl"))},{id:"editor.layout.twoRightSidebar",type:"two_right_sidebar",title:i("l51YQ").toolbarMessages.rightSidebar,icon:e(i("dIYpm"))},{id:"editor.layout.twoLeftSidebar",type:"two_left_sidebar",title:i("l51YQ").toolbarMessages.leftSidebar,icon:e(i("e0qVa"))}],ek=[{id:"editor.layout.threeEquals",type:"three_equal",title:i("l51YQ").toolbarMessages.threeColumns,icon:e(i("f22ZH"))},{id:"editor.layout.threeWithSidebars",type:"three_with_sidebars",title:i("l51YQ").toolbarMessages.threeColumnsWithSidebars,icon:e(i("5NtbR"))},{id:"editor.layout.threeRightSidebars",type:"three_right_sidebars",title:i("l51YQ").toolbarMessages.threeColumnsWithRightSidebars,icon:eb,iconFallback:eb},{id:"editor.layout.threeLeftSidebars",type:"three_left_sidebars",title:i("l51YQ").toolbarMessages.threeColumnsWithLeftSidebars,icon:eS,iconFallback:eS}],ex=(e,t,n,a)=>({id:t.id,type:"button",icon:t.icon,iconFallback:t.iconFallback,testId:t.title.id?`${t.title.id}`:void 0,title:e.formatMessage(t.title),onClick:O(a)(t.type),selected:!!n&&n===t.type,tabIndex:null}),eA=e(i("asgOl")),eO=t=>{if((0,l.editorExperiment)("single_column_layouts",!0)||(0,l.editorExperiment)("platform_editor_controls","variant1"))switch(t){case 1:return(0,a.jsx)(e(i("bmsMK")),{label:""});case 2:return(0,a.jsx)(e(i("asgOl")),{label:""});case 3:return(0,a.jsx)(e(i("f22ZH")),{label:""});case 4:return(0,a.jsx)(e_,{});case 5:return(0,a.jsx)(ey,{});default:return}},eP=({addSidebarLayouts:e,intl:t,editorAnalyticsAPI:n,state:a,node:o,nodeType:s,separator:r,deleteButton:l,currentLayout:d,allowAdvancedSingleColumnLayout:c})=>{let p=o.content.childCount||2,u=2===p?eN:3===p?ek:[],h=[{title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:2}),icon:eO(2)||eA,onClick:O(n)("two_equal"),selected:2===p},{title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:3}),icon:eO(3)||eA,onClick:O(n)("three_equal"),selected:3===p},{title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:4}),icon:eO(4)||eA,onClick:O(n)("four_equal"),selected:4===p},{title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:5}),icon:eO(5)||eA,onClick:O(n)("five_equal"),selected:5===p}],m=c?{title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:1}),icon:eO(1)||eA,onClick:O(n)("single"),selected:1===p}:[];return[{type:"dropdown",title:t.formatMessage(i("l51YQ").toolbarMessages.columnOption,{count:p}),options:[m,h].flat(),showSelected:!0,testId:"column-options-button"},...u.length>0?[r]:[],...e?u.map(e=>ex(t,e,d,n)):[]]},eM={type:"separator",fullHeight:!0},ew=(t,n,o,r,d,c,p,u)=>{let{hoverDecoration:h}=u?.decorations?.actions??{},m=u?.analytics?.actions,f=t.doc.nodeAt(o),T=(0,i("iHzeA").areToolbarFlagsEnabled)(!!u?.toolbar);if(f){let r=g(f),E={type:"separator"},y=t.schema.nodes.layoutSection,_={id:"editor.layout.delete",type:"button",appearance:"danger",focusEditoronEnter:!0,icon:e(i("gKvd9")),testId:i("61p3e").default.remove.id,title:n.formatMessage(i("61p3e").default.remove),onClick:B(m,i("d925B").INPUT_METHOD.FLOATING_TB),onMouseEnter:h?.(y,!0),onMouseLeave:h?.(y,!1),onFocus:h?.(y,!0),onBlur:h?.(y,!1),tabIndex:null},S={type:"copy-button",items:[{state:t,formatMessage:n.formatMessage,nodeType:y}]},b=(e,t)=>({onMouseEnter:h?.(e,!0,t),onMouseLeave:h?.(e,!1,t),onFocus:h?.(e,!0,t),onBlur:h?.(e,!1,t)}),C={type:"overflow-dropdown",testId:"layout-overflow-dropdown-trigger",options:[{title:n.formatMessage(i("61p3e").default.copyToClipboard),onClick:()=>(u?.core?.actions.execute(u?.floatingToolbar?.commands.copyNode(y,i("d925B").INPUT_METHOD.FLOATING_TB)),!0),icon:(0,a.jsx)(e(i("2MuFw")),{label:""}),...b(y,i("aFUXX").akEditorSelectedNodeClassName)},{title:n.formatMessage(i("61p3e").default.delete),onClick:B(m,i("d925B").INPUT_METHOD.FLOATING_TB),icon:(0,a.jsx)(e(i("gKvd9")),{label:""}),...b(y)}]};return{title:"Layout floating controls",getDomRef:e=>(0,s.findDomRefAtPos)(o,e.domAtPos.bind(e)),nodeType:y,groupLabel:n.formatMessage(i("l51YQ").toolbarMessages.floatingToolbarRadioGroupAriaLabel),items:[...(0,l.editorExperiment)("advanced_layouts",!0)?eP({addSidebarLayouts:d,intl:n,editorAnalyticsAPI:m,state:t,nodeType:y,node:f,separator:E,deleteButton:_,currentLayout:r,allowAdvancedSingleColumnLayout:p}):[...(c?ev:eC).map(e=>ex(n,e,r,m)),...d?eI.map(e=>ex(n,e,r,m)):[]],...T?[eM,C]:[E,S,E,_]],scrollable:!0}}},eD=e=>{if(!(0,l.editorExperiment)("single_column_layouts",!0))return e;let{layoutSection:t,paragraph:n}=e.doc.type.schema.nodes,a=(0,s.findParentNode)(e=>e.type===t)(e.selection);return a&&a.node&&"layoutSection"===a.node.type.name&&a.node.firstChild?.firstChild?.type===n&&e.setSelection(i("ks2lK").TextSelection.create(e.doc,a.pos)),e};t.exports.layoutPlugin=({config:e={},api:t})=>{let n=(0,l.editorExperiment)("advanced_layouts",!0)&&(0,l.editorExperiment)("single_column_layouts",!0,{exposure:!0});return(0,r.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)&&t?.blockMenu?.actions.registerBlockMenuComponents([{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_LAYOUT_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_LAYOUT_MENU_ITEM.key]},component:eg(t)}]),{name:"layout",nodes:()=>[{name:"layoutSection",node:(0,l.editorExperiment)("advanced_layouts",!0)?(0,i("dh538").fg)("platform_editor_adf_with_localid")?i("hVXQj").layoutSectionWithSingleColumnLocalId:i("hVXQj").layoutSectionWithSingleColumn:(0,i("dh538").fg)("platform_editor_adf_with_localid")?i("hVXQj").layoutSectionWithLocalId:i("hVXQj").layoutSection},{name:"layoutColumn",node:(0,i("dh538").fg)("platform_editor_adf_with_localid")?i("lifsC").layoutColumnWithLocalId:i("lifsC").layoutColumn}],pmPlugins(){let n=[{name:"layout",plugin:()=>H(e)}];return("full-page"===e.editorAppearance||"full-width"===e.editorAppearance)&&t&&(0,l.editorExperiment)("advanced_layouts",!0)&&n.push({name:"layoutResizing",plugin:({portalProviderAPI:n,eventDispatcher:a})=>ep(e,t,n,a)}),n},actions:{insertLayoutColumns:S(t?.analytics?.actions)},pluginsOptions:{floatingToolbar(e,a){let{pos:i,allowBreakout:o,addSidebarLayouts:s,allowSingleColumnLayout:r,isResizing:d}=c.getState(e),p=d&&(0,l.editorExperiment)("single_column_layouts",!0);if(null!==i&&!p)return ew(e,a,i,o,s,r,n,t)},quickInsert:({formatMessage:e})=>{let s=(e,n)=>(t?.analytics?.actions?.attachAnalyticsEvent({action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.LAYOUT,attributes:{inputMethod:i("d925B").INPUT_METHOD.QUICK_INSERT,columnCount:n},eventType:i("d925B").EVENT_TYPE.TRACK})(e),e),r=n?[{id:"onecolumnlayout",title:e(i("l51YQ").toolbarMessages.singleColumnAdvancedLayout),description:e(i("4HWgE").toolbarInsertBlockMessages.singleColumnsDescriptionAdvancedLayout),keywords:["layout","column","section","single column"],priority:1100,icon:()=>(0,a.jsx)(o.IconOneColumnLayout,{}),action(e,t){let n=e(y(t,1));return(0,i("dh538").fg)("platform_editor_column_count_analytics")?s(n,1):s(n),eD(n),n}}]:[];return(0,l.editorExperiment)("advanced_layouts",!0)?[...r,{id:"twocolumnslayout",title:e(i("l51YQ").toolbarMessages.twoColumnsAdvancedLayout),description:e(i("4HWgE").toolbarInsertBlockMessages.columnsDescriptionAdvancedLayout,{numberOfColumns:"two"}),keywords:["layout","column","section","two column"],priority:1100,icon:()=>(0,a.jsx)(o.IconTwoColumnLayout,{}),action(e,t){let n=e(y(t,2));return(0,i("dh538").fg)("platform_editor_column_count_analytics")?s(n,2):s(n),eD(n),n}},{id:"threecolumnslayout",title:e(i("l51YQ").toolbarMessages.threeColumnsAdvancedLayout),description:e(i("4HWgE").toolbarInsertBlockMessages.columnsDescriptionAdvancedLayout,{numberOfColumns:"three"}),keywords:["layout","column","section","three column"],priority:1100,icon:()=>(0,a.jsx)(o.IconThreeColumnLayout,{}),action(e,t){let n=e(y(t,3));return(0,i("dh538").fg)("platform_editor_column_count_analytics")?s(n,3):s(n),eD(n),n}},{id:"fourcolumnslayout",title:e(i("l51YQ").toolbarMessages.fourColumns),description:e(i("4HWgE").toolbarInsertBlockMessages.columnsDescriptionAdvancedLayout,{numberOfColumns:"four"}),keywords:["layout","column","section","four column"],priority:1100,icon:()=>(0,a.jsx)(o.IconFourColumnLayout,{}),action(e,t){let n=e(y(t,4));return(0,i("dh538").fg)("platform_editor_column_count_analytics")?s(n,4):s(n),eD(n),n}},{id:"fivecolumnslayout",title:e(i("l51YQ").toolbarMessages.fiveColumns),description:e(i("4HWgE").toolbarInsertBlockMessages.columnsDescriptionAdvancedLayout,{numberOfColumns:"five"}),keywords:["layout","column","section","five column"],priority:1100,icon:()=>(0,a.jsx)(o.IconFiveColumnLayout,{}),action(e,t){let n=e(y(t,5));return(0,i("dh538").fg)("platform_editor_column_count_analytics")?s(n,5):s(n),eD(n),n}}]:[{id:"layout",title:e(i("4HWgE").toolbarInsertBlockMessages.columns),description:e(i("4HWgE").toolbarInsertBlockMessages.columnsDescription),keywords:["column","section"],priority:1100,icon:()=>(0,a.jsx)(o.IconLayout,{}),action(e,n){let a=e(_(n));return t?.analytics?.actions?.attachAnalyticsEvent({action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.LAYOUT,attributes:{inputMethod:i("d925B").INPUT_METHOD.QUICK_INSERT},eventType:i("d925B").EVENT_TYPE.TRACK})(a),a}}]}},contentComponent:()=>(0,l.editorExperiment)("advanced_layouts",!0)?(0,a.jsx)(eh,{}):null}}}),o("b3BjA",function(t,n){var a=i("l998X");i("42omo");var o=i("42omo");function s(){let{iconThemed:t}=(0,i("1R4Hk").useIconThemed)();return e(o).createElement("svg",{width:"40",height:"40",viewBox:"0 0 40 40",fill:"none",focusable:"false","aria-hidden":!0},e(o).createElement("rect",{width:"40",height:"40",fill:t({light:"#fff",dark:"#161A1D"})}),e(o).createElement("path",{d:"M8 13C8 12.4477 8.44772 12 9 12H40V28H9C8.44772 28 8 27.5523 8 27V13Z",fill:t({light:"var(--ds-background-accent-teal-subtlest, #E7F9FF)",dark:"var(--ds-background-accent-teal-subtlest, #E7F9FF)"})}),e(o).createElement("g",{clipPath:"url(#clip0)"},e(o).createElement("path",{d:"M19.9999 16.2222C15.5817 16.2222 12.2222 19.5818 12.2222 24H16.0093C16.0093 21.7962 17.7964 20.0093 19.9999 20.0093V16.2222Z",fill:t({light:"#6E5DC6",dark:"#9F8FEF"})}),e(o).createElement("path",{d:"M12 23.9998H12.676C12.676 19.9578 15.9502 16.6809 19.9909 16.676V16C15.5767 16.0051 12 19.5847 12 23.9998Z",fill:t({light:"#E34935",dark:"#EF5C48"})}),e(o).createElement("path",{d:"M12.6851 24H13.3517C13.3517 20.3262 16.3273 17.3478 19.9999 17.3429V16.6762C15.9593 16.6811 12.6851 19.958 12.6851 24Z",fill:t({light:"#D97008",dark:"#F18D13"})}),e(o).createElement("path",{d:"M13.3518 24H14.0185C14.0185 20.6945 16.6956 18.0145 20 18.0096V17.3429C16.3274 17.3478 13.3518 20.3262 13.3518 24Z",fill:t({light:"#E2B203",dark:"#E2B203"})}),e(o).createElement("path",{d:"M14.0184 24H14.6851C14.6851 21.0629 17.064 18.6811 20 18.6762V18.0096C16.6955 18.0144 14.0184 20.6944 14.0184 24Z",fill:t({light:"#6A9A23",dark:"#82B536"})}),e(o).createElement("path",{d:"M14.6851 24H15.3517C15.3517 21.4311 17.4322 19.348 19.9999 19.3431V18.6762C17.0639 18.6811 14.6851 21.0629 14.6851 24Z",fill:t({light:"#0055CC",dark:"#579DFF"})})),e(o).createElement("defs",null,e(o).createElement("clipPath",{id:"clip0"},e(o).createElement("rect",{width:"8",height:"8",fill:t({light:"#fff",dark:"#fff"}),transform:"translate(12 16)"}))))}var r=i("3pLGZ"),l=i("1oCLl"),d=i("dZ8uq"),c=i("iu6m9"),p=i("8m4tT");let u=(e,t)=>{let{panel:n}=e.schema.nodes;return(0,p.findSelectedNodeOfType)(n)(t||e.selection)||(0,p.findParentNodeOfType)(n)(t||e.selection)},h=(e,t)=>{let{panelColor:n,panelType:a,panelIcon:o,panelIconId:s,panelIconText:r}=e,l=a===i("dGKc1").PanelType.CUSTOM&&t,d=!l||!!o||!!s,c=n&&(0,i("6icEc").hexToEditorBackgroundPaletteColor)(n)||n,p=`${n&&l?`background-color: ${c};`:""}${!d&&!(0,i("dh538").fg)("platform_editor_nested_dnd_styles_changes")?"padding-left: 12px;padding-right: 12px;":""}`,u={class:`${i("DoNsZ").PanelSharedCssClassName.prefix}${!d&&(0,i("dh538").fg)("platform_editor_nested_dnd_styles_changes")?` ${i("DoNsZ").PanelSharedCssClassName.noIcon}`:""}`,"data-panel-type":a||i("dGKc1").PanelType.INFO,"data-testid":"panel-node-view",style:p};n&&l&&(u={...u,"data-panel-color":n,"data-panel-icon-id":s,"data-panel-icon-text":r}),(0,i("dh538").fg)("platform_editor_adf_with_localid")&&(u={...u,"data-local-id":e.localId});let h=["div",{class:i("DoNsZ").PanelSharedCssClassName.icon,"data-panel-type":a||i("dGKc1").PanelType.INFO}],m=["div",{class:i("DoNsZ").PanelSharedCssClassName.content},0];return d?["div",u,h,m]:["div",u,m]},m=(e,t)=>{let n=e.tr,{schema:a}=e.doc.type;if(f(e,t)){let e=a.nodes.paragraph.create(),o=(0,p.findParentNode)(e=>"panel"===e.type.name)(t.tr.selection),s=o?.node.copy(),r=a.nodes.panel.create({...s?.attrs},e),l=t.tr.selection.$from.pos;if(o)return n.insert(o.pos,r).setSelection(new(0,i("ks2lK").TextSelection)(n.doc.resolve(l))),n}},f=(e,t)=>{let n=t.tr.selection instanceof i("ks2lK").NodeSelection,a=n&&["codeBlock","rule"].includes(t.tr.selection.node.type.name),o=(0,p.findParentNodeOfType)(e.schema.nodes.panel)(t.tr.selection),s=(0,p.findParentNodeOfType)(e.schema.nodes.decisionList)(t.tr.selection);return!!(n&&o?.node.childCount===1&&(s?.node.childCount===1||a))},g=e=>(t,n)=>{let{schema:{nodes:a},tr:o}=t,s={action:i("d925B").ACTION.DELETED,actionSubject:i("d925B").ACTION_SUBJECT.PANEL,attributes:{inputMethod:i("d925B").INPUT_METHOD.FLOATING_TB},eventType:i("d925B").EVENT_TYPE.TRACK},r=o;return(0,p.findSelectedNodeOfType)(a.panel)(o.selection)?r=(0,p.removeSelectedNode)(o):(0,p.findParentNodeOfType)(a.panel)(o.selection)&&(r=(0,p.removeParentNodeOfType)(a.panel)(o)),!!r&&(n&&(e?.attachAnalyticsEvent(s)(r),n(r)),!0)},T=e=>(t,n={},a=!1)=>(o,s)=>{let r,{schema:{nodes:l},tr:d}=o,c=u(o);if(void 0===c)return!1;let p=c.node.attrs.panelType;if(a){let e="custom"===c.node.attrs.panelType?c.node.attrs.panelColor||"none":(0,i("DoNsZ").getPanelTypeBackgroundNoTokens)(p),a=c.node.attrs.panelIcon,o={color:e,emoji:a,emojiId:c.node.attrs.panelIconId,emojiText:c.node.attrs.panelIconText,...n};r=d.setNodeMarkup(c.pos,l.panel,{panelIcon:o.emoji,panelIconId:o.emojiId,panelIconText:o.emojiText,panelColor:o.color,panelType:t})}else r=d.setNodeMarkup(c.pos,l.panel,{panelType:t});let h={action:i("d925B").ACTION.CHANGED_TYPE,actionSubject:i("d925B").ACTION_SUBJECT.PANEL,attributes:{newType:t,previousType:p},eventType:i("d925B").EVENT_TYPE.TRACK},m=o.selection instanceof i("ks2lK").NodeSelection&&"panel"===o.selection.node.type.name?r.setSelection(new(0,i("ks2lK").NodeSelection)(d.doc.resolve(c.pos))):r;return e?.attachAnalyticsEvent(h)(m),m.setMeta("scrollIntoView",!1),s&&s(m),!0};var E=function(){let e=(e,t)=>t.delete(e.before(e.depth)-1,e.end(e.depth)+1);return(0,i("dus6D").keymap)({Backspace:(t,n)=>{let{selection:a,schema:{nodes:o},tr:s}=t,{panel:r,blockquote:l,orderedList:d,bulletList:c,mediaSingle:u,mediaGroup:h,extension:m}=o,{$from:f,$to:g}=a;if(f.pos!==g.pos||0!==f.parentOffset)return!1;let T=s.doc.resolve(Math.max(0,f.before(f.depth)-1)),E=T.pos>0&&T.parent&&T.parent.type,y=f.parent.type,_=E===r,S=y===r,b=T?.nodeBefore,C=T.nodeAfter?.type===m;if(_&&!S&&!C||function(e,t,n){let a=function(e,t){let n=(0,p.findParentNodeOfType)(t)(e);return n?n.node:null}(e,t);return a&&(0,i("l9G9n").isEmptyNode)(n)(a)}(a,r,t.schema)||(0,p.hasParentNodeOfType)(l)(a)&&E!==c&&E!==d&&E!==u&&E!==h&&!C||b?.type?.spec?.isolating&&(0,p.hasParentNodeOfType)(r)(a)){let t=f.node(f.depth).content,a=T.pos;return e(f,s).insert(a,t),n&&n((0,p.setTextSelection)(a)(s).scrollIntoView()),!0}return f.node().type===r}})};i("42omo");var y=i("cUcZ5");let _=t=>{let{allowTextFallback:n,shortName:a,id:s,fallback:r,fitToHeight:l,showTooltip:d,resourceConfig:c,emojiProvider:p}=t,u=(0,o.useMemo)(()=>({shortName:a,id:s,fallback:r}),[a,s,r]),h=(0,o.useMemo)(()=>Promise.resolve(p),[p]);return n&&!p?e(o).createElement("span",{"data-emoji-id":s,"data-emoji-short-name":a,"data-emoji-text":r||a},r||a):p?e(o).createElement(i("etuMO").default,{emojiId:u,emojiProvider:h,showTooltip:d,fitToHeight:l,optimistic:!0,optimisticImageURL:c?.optimisticImageApi?.getUrl({id:s,fallback:r,shortName:a}),editorEmoji:!0}):null};var S=e(o).memo(t=>e(o).createElement(_,t)),b=i("cQMhV");let C={info:b.PanelInfoIcon,success:b.PanelSuccessIcon,note:b.PanelNoteIcon,tip:e(i("3HOqx")),warning:b.PanelWarningIcon,error:b.PanelErrorIcon,custom:b.PanelInfoIcon},v=e=>({emojiState:e.emojiState}),I=e=>{let{allowCustomPanel:t,providerFactory:n,pluginInjectionApi:o,panelAttributes:{panelType:s,panelIcon:r,panelIconId:l,panelIconText:d}}=e,{emojiState:c}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(o,["emoji"],v),p=c?.emojiProvider;if(t&&r&&s===i("dGKc1").PanelType.CUSTOM)return(0,a.jsx)(S,{emojiProvider:p,providers:n,shortName:r,id:l,fallback:d,showTooltip:!1,allowTextFallback:!1,fitToHeight:i("aFUXX").akEditorCustomIconSize});let u=C[s];return u?(0,a.jsx)(u,{label:`${s} panel`}):null};class N{ignoreMutation(e){if(!this.icon)return!1;let t=e.target===this.icon||e.target.parentNode===this.icon,n=this.icon.contains(e.target);return t||n}destroy(){this.nodeViewPortalProviderAPI.remove(this.key)}constructor(t,n,o,s,r,l,d){this.node=void 0,this.dom=void 0,this.contentDOM=void 0,this.icon=void 0,this.getPos=void 0,this.view=void 0,this.providerFactory=void 0,this.nodeViewPortalProviderAPI=void 0,this.pluginOptions=void 0,this.key=void 0,this.nodeViewPortalProviderAPI=l,this.providerFactory=d,this.pluginOptions=s,this.view=n,this.node=t,this.key=e(y)();let{dom:c,contentDOM:p}=i("5SAOw").DOMSerializer.renderSpec(document,h(t.attrs,s.allowCustomPanel||!1));if(this.getPos=o,this.dom=c,this.contentDOM=p,this.icon=this.dom.querySelector(`.${i("DoNsZ").PanelSharedCssClassName.icon}`),!this.icon)return;this.icon.contentEditable="false",this.nodeViewPortalProviderAPI.render(()=>(0,a.jsx)(I,{pluginInjectionApi:r,allowCustomPanel:s.allowCustomPanel,panelAttributes:t.attrs,providerFactory:this.providerFactory}),this.icon,this.key)}}let k=(e,t,n,a)=>(i,o,s)=>new N(i,o,s,e,t,n,a),x=new(0,i("ks2lK").PluginKey)("panelPlugin"),A=(e,t,n,a,o)=>{let{useLongPressSelection:s=!1}=n;return new(0,i("1S4f7").SafePlugin)({key:x,appendTransaction:(e,t,n)=>{if(e.find(e=>"cut"===e.getMeta("uiEvent")))return m(n,t)},props:{nodeViews:{panel:k(n,a,o,t)},handleClickOn:(0,i("3tffm").createSelectionClickHandler)(["panel"],e=>!!e.closest(`.${i("DoNsZ").PanelSharedCssClassName.prefix}`),{useLongPressSelection:s})}})};i("42omo");let O="panel",P=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)();return t?.blockMenu?.actions.isTransformOptionDisabled(O)?null:(0,a.jsx)(i("2GVu1").ToolbarDropdownItem,{onClick:e=>{let n=e.nativeEvent instanceof KeyboardEvent||0===e.nativeEvent.detail?i("d925B").INPUT_METHOD.KEYBOARD:i("d925B").INPUT_METHOD.MOUSE,a=i("d925B").INPUT_METHOD.BLOCK_MENU;t?.core.actions.execute(({tr:e})=>{let i=t?.blockMenu?.commands.transformNode(e.doc.type.schema.nodes.panel,{inputMethod:a,triggeredFrom:n,targetTypeName:O});return i?i({tr:e}):null})},elemBefore:(0,a.jsx)(e(i("8tSmd")),{label:""}),children:n(i("2UWDO").messages.panel)})},M=e=>()=>(0,a.jsx)(P,{api:e});i("42omo");let w=[{label:"White",value:"#FFFFFF"},{label:"Light blue",value:"#DEEBFF"},{label:"Light teal",value:"#E6FCFF"},{label:"Light green",value:"#E3FCEF"},{label:"Light yellow",value:"#FFFAE6"},{label:"Light red",value:"#FFEBE6"},{label:"Light purple",value:"#EAE6FF"},{label:"Light gray",value:"#F4F5F7"},{label:"Blue",value:"#B3D4FF"},{label:"Teal",value:"#B3F5FF"},{label:"Green",value:"#ABF5D1"},{label:"Yellow",value:"#FFF0B3"},{label:"Red",value:"#FFBDAD"},{label:"Purple",value:"#C0B6F2"},{label:"Gray",value:"#B3BAC5"},{label:"Dark blue",value:"#4C9AFF"},{label:"Dark teal",value:"#79E2F2"},{label:"Dark green",value:"#57D9A3"},{label:"Dark yellow",value:"#FFC400"},{label:"Dark red",value:"#FF8F73"},{label:"Dark purple",value:"#998DD9"}].map(e=>({...e,border:`var(--ds-border, ${i("lhtyR").DEFAULT_BORDER_COLOR})`}));[{label:"Dark gray",value:i("DoNsZ").darkPanelColors.DarkGray},{label:"Dark blue",value:i("DoNsZ").darkPanelColors.B1200S},{label:"Dark teal",value:i("DoNsZ").darkPanelColors.T1200S},{label:"Dark green",value:i("DoNsZ").darkPanelColors.G1200S},{label:"Dark yellow",value:i("DoNsZ").darkPanelColors.Y1200S},{label:"Dark red",value:i("DoNsZ").darkPanelColors.R1200S},{label:"Dark purple",value:i("DoNsZ").darkPanelColors.P1200S},{label:"Gray",value:i("DoNsZ").darkPanelColors.Gray},{label:"blue",value:i("DoNsZ").darkPanelColors.B900},{label:"teal",value:i("DoNsZ").darkPanelColors.T900},{label:"green",value:i("DoNsZ").darkPanelColors.G900},{label:"yellow",value:i("DoNsZ").darkPanelColors.Y900},{label:"red",value:i("DoNsZ").darkPanelColors.R900},{label:"purple",value:i("DoNsZ").darkPanelColors.P900},{label:"Light gray",value:i("DoNsZ").darkPanelColors.LightGray},{label:"Light blue",value:i("DoNsZ").darkPanelColors.B800S},{label:"Light teal",value:i("DoNsZ").darkPanelColors.T900S},{label:"Light green",value:i("DoNsZ").darkPanelColors.G900S},{label:"Light yellow",value:i("DoNsZ").darkPanelColors.Y800S},{label:"Light red",value:i("DoNsZ").darkPanelColors.R800S},{label:"Light purple",value:i("DoNsZ").darkPanelColors.P800S}].map(e=>({...e,border:i("lhtyR").DEFAULT_BORDER_COLOR}));let D={[i("dGKc1").PanelType.INFO]:{title:i("02xUP").panelMessages.info,icon:e(i("eXmBZ"))({label:"info-icon",color:"var(--ds-icon-information, #357DE8)"})},[i("dGKc1").PanelType.NOTE]:{title:i("02xUP").panelMessages.note,icon:e(i("3gddQ"))({label:"note-icon",color:"var(--ds-icon-discovery, #AF59E1)"})},[i("dGKc1").PanelType.SUCCESS]:{title:i("02xUP").panelMessages.success,icon:e(i("3sFtD"))({label:"success-icon",color:"var(--ds-icon-success, #6A9A23)"})},[i("dGKc1").PanelType.WARNING]:{title:i("02xUP").panelMessages.warning,icon:e(i("ebrpi"))({label:"warning-icon",color:"var(--ds-icon-warning, #E06C00)"})},[i("dGKc1").PanelType.ERROR]:{title:i("02xUP").panelMessages.error,icon:e(i("7yDmn"))({label:"error-icon",color:"var(--ds-icon-danger, #C9372C)"})},[i("dGKc1").PanelType.CUSTOM]:{title:i("02xUP").panelMessages.custom,icon:e(i("isYda"))({label:"custom-icon"})}},R=({activePanelType:e,editorAnalyticsAPI:t,formatMessage:n})=>{let a=[{id:"editor.panel.info",icon:D[i("dGKc1").PanelType.INFO].icon,onClick:T(t)(i("dGKc1").PanelType.INFO),selected:e===i("dGKc1").PanelType.INFO,title:n(D[i("dGKc1").PanelType.INFO].title)},{id:"editor.panel.note",icon:D[i("dGKc1").PanelType.NOTE].icon,onClick:T(t)(i("dGKc1").PanelType.NOTE),selected:e===i("dGKc1").PanelType.NOTE,title:n(D[i("dGKc1").PanelType.NOTE].title)},{id:"editor.panel.success",icon:D[i("dGKc1").PanelType.SUCCESS].icon,onClick:T(t)(i("dGKc1").PanelType.SUCCESS),selected:e===i("dGKc1").PanelType.SUCCESS,title:n(D[i("dGKc1").PanelType.SUCCESS].title)},{id:"editor.panel.warning",icon:D[i("dGKc1").PanelType.WARNING].icon,onClick:T(t)(i("dGKc1").PanelType.WARNING),selected:e===i("dGKc1").PanelType.WARNING,title:n(D[i("dGKc1").PanelType.WARNING].title)},{id:"editor.panel.error",icon:D[i("dGKc1").PanelType.ERROR].icon,onClick:T(t)(i("dGKc1").PanelType.ERROR),selected:e===i("dGKc1").PanelType.ERROR,title:n(D[i("dGKc1").PanelType.ERROR].title)}],o=D[e||i("dGKc1").PanelType.INFO]||D[i("dGKc1").PanelType.CUSTOM];return{id:"panel-type-dropdown",testId:"panel-type-dropdown-trigger",type:"dropdown",options:a,showSelected:!0,iconBefore:()=>o.icon,title:n(o.title)}},B={[i("dGKc1").PanelType.INFO]:{shortName:":info:",id:"atlassian-info"},[i("dGKc1").PanelType.NOTE]:{shortName:":note:",id:"atlassian-note"},[i("dGKc1").PanelType.WARNING]:{shortName:":warning:",id:"atlassian-warning"},[i("dGKc1").PanelType.ERROR]:{shortName:":cross_mark:",id:"atlassian-cross_mark"},[i("dGKc1").PanelType.SUCCESS]:{shortName:":check_mark:",id:"atlassian-check_mark"},[i("dGKc1").PanelType.TIP]:{shortName:":tip:",id:"atlassian-tip"}},L=(t,n,o,s,r,l,d,c,p,h,m,f)=>{let E=!(0,i("iHzeA").areToolbarFlagsEnabled)(!!f?.toolbar),y=E?[{id:"editor.panel.info",type:"button",icon:e(i("eXmBZ")),onClick:T(d)(i("dGKc1").PanelType.INFO),selected:c===i("dGKc1").PanelType.INFO,title:t(i("02xUP").panelMessages.info),tabIndex:null},{id:"editor.panel.note",type:"button",icon:e(i("3gddQ")),onClick:T(d)(i("dGKc1").PanelType.NOTE),selected:c===i("dGKc1").PanelType.NOTE,title:t(i("02xUP").panelMessages.note),tabIndex:null},{id:"editor.panel.success",type:"button",icon:e(i("3sFtD")),onClick:T(d)(i("dGKc1").PanelType.SUCCESS),selected:c===i("dGKc1").PanelType.SUCCESS,title:t(i("02xUP").panelMessages.success),tabIndex:null},{id:"editor.panel.warning",type:"button",icon:e(i("ebrpi")),onClick:T(d)(i("dGKc1").PanelType.WARNING),selected:c===i("dGKc1").PanelType.WARNING,title:t(i("02xUP").panelMessages.warning),tabIndex:null},{id:"editor.panel.error",type:"button",icon:e(i("7yDmn")),onClick:T(d)(i("dGKc1").PanelType.ERROR),selected:c===i("dGKc1").PanelType.ERROR,title:t(i("02xUP").panelMessages.error),tabIndex:null}]:[R({activePanelType:c,editorAnalyticsAPI:d,formatMessage:t}),...f?.toolbar?[]:[{type:"separator"}]];if(o){let n=e=>(t,n)=>{let a=u(t);if(void 0===a)return!1;let s="custom"===a.node.attrs.panelType?a.node.attrs.panelColor||"none":(0,i("DoNsZ").getPanelTypeBackgroundNoTokens)(a.node.attrs.panelType),r=B[a.node.attrs.panelType],l=r?{emoji:r.shortName,emojiId:r.id}:{};if(s===e)return T(d)(i("dGKc1").PanelType.CUSTOM,{color:e,...l},o)(t,n),!1;let c={action:i("d925B").ACTION.CHANGED_BACKGROUND_COLOR,actionSubject:i("d925B").ACTION_SUBJECT.PANEL,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.PANEL,attributes:{newColor:e,previousColor:s},eventType:i("d925B").EVENT_TYPE.TRACK};return(0,i("dAtrv").withAnalytics)(d,c)(T(d)(i("dGKc1").PanelType.CUSTOM,{color:e,...l},o))(t,n),!1},r=e=>(t,n)=>{let a=u(t);if(void 0===a)return!1;let o=a.node.attrs.panelIcon||"";if(o===e.shortName)return T(d)(i("dGKc1").PanelType.CUSTOM,{emoji:e.shortName,emojiId:e.id,emojiText:e.fallback},!0)(t,n),!1;let s={action:i("d925B").ACTION.CHANGED_ICON,actionSubject:i("d925B").ACTION_SUBJECT.PANEL,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.PANEL,attributes:{newIcon:e.shortName,previousIcon:o},eventType:i("d925B").EVENT_TYPE.TRACK};return(0,i("dAtrv").withAnalytics)(d,s)(T(d)(i("dGKc1").PanelType.CUSTOM,{emoji:e.shortName,emojiId:e.id,emojiText:e.fallback},!0))(t,n),!1},l=c===i("dGKc1").PanelType.CUSTOM?p||(0,i("DoNsZ").getPanelTypeBackgroundNoTokens)(i("dGKc1").PanelType.INFO):(0,i("DoNsZ").getPanelTypeBackgroundNoTokens)(c),m=w.find(e=>e.value===l)||{label:"Custom",value:l,border:i("lhtyR").DEFAULT_BORDER_COLOR};if(s){let s={id:"editor.panel.colorPicker",title:t(i("02xUP").panelMessages.backgroundColor),isAriaExpanded:!0,type:"select",selectType:"color",defaultValue:m,options:w,onChange:e=>n(e.value)},l={id:"editor.panel.emojiPicker",title:t(i("02xUP").panelMessages.emoji),type:"select",selectType:"emoji",options:[],selected:c===i("dGKc1").PanelType.CUSTOM&&!!h,onChange:e=>r(e)},p={id:"editor.panel.removeEmoji",type:"button",icon:()=>(0,a.jsx)(e(i("2G5zx")),{spacing:"spacious",label:""}),onClick:(e,t)=>{let n=u(e);if(c===i("dGKc1").PanelType.CUSTOM&&!h||void 0===n)return!1;let a={action:i("d925B").ACTION.REMOVE_ICON,actionSubject:i("d925B").ACTION_SUBJECT.PANEL,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.PANEL,attributes:{icon:n.node.attrs.panelIcon},eventType:i("d925B").EVENT_TYPE.TRACK};return(0,i("dAtrv").withAnalytics)(d,a)(T(d)(i("dGKc1").PanelType.CUSTOM,{emoji:void 0,emojiId:void 0,emojiText:void 0},o))(e,t),!1},title:t(i("61p3e").default.removeEmoji),disabled:!h};y.push(l,p,{type:"separator"},s)}}if(E)m&&(y.push({type:"separator"}),y.push({type:"copy-button",items:[{state:m,formatMessage:t,nodeType:n}]})),y.push({type:"separator"},{id:"editor.panel.delete",type:"button",appearance:"danger",focusEditoronEnter:!0,icon:()=>(0,a.jsx)(e(i("gKvd9")),{spacing:"spacious",label:""}),onClick:g(d),onMouseEnter:l?.(n,!0),onMouseLeave:l?.(n,!1),onFocus:l?.(n,!0),onBlur:l?.(n,!1),title:t(i("61p3e").default.remove),tabIndex:null});else{let o=(e,t)=>({onMouseEnter:l?.(e,!0,t),onMouseLeave:l?.(e,!1,t),onFocus:l?.(e,!0,t),onBlur:l?.(e,!1,t)}),s=[{type:"separator",fullHeight:!0},{type:"overflow-dropdown",testId:"panel-overflow-dropdown-trigger",options:[{title:t(i("61p3e").default.copyToClipboard),onClick:()=>(f?.core?.actions.execute(f?.floatingToolbar?.commands.copyNode(n,i("d925B").INPUT_METHOD.FLOATING_TB)),!0),icon:(0,a.jsx)(e(i("2MuFw")),{label:""}),...o(n,i("aFUXX").akEditorSelectedNodeClassName)},{title:t(i("61p3e").default.delete),onClick:g(d),icon:(0,a.jsx)(e(i("gKvd9")),{label:""}),...o(n)}]}];y.push(...s)}return y},U=(e,t,n={},a,o)=>{let{formatMessage:s}=t,r=u(e);if(r){let t=e.schema.nodes.panel,{panelType:l,panelColor:d,panelIcon:c}=r.node.attrs,u=L(s,t,n.allowCustomPanel||!1,n.allowCustomPanel&&n.allowCustomPanelEdit||!1,a,o?.decorations?.actions.hoverDecoration,o?.analytics?.actions,l,n.allowCustomPanel?d:void 0,n.allowCustomPanel?c||(l!==i("dGKc1").PanelType.CUSTOM?l:void 0):void 0,e,(0,i("iHzeA").areToolbarFlagsEnabled)(!!o?.toolbar)?o:void 0);return{title:"Panel floating controls",getDomRef:e=>{let t=e.domAtPos.bind(e);return(0,p.findDomRefAtPos)(r.pos,t)},nodeType:t,items:u,scrollable:!0,groupLabel:s(i("02xUP").panelMessages.panelsGroup)}}};function K({state:e,attributes:t,api:n,typeAheadInsert:a,inputMethod:o=i("d925B").INPUT_METHOD.QUICK_INSERT}){let s,{panel:r}=e.schema.nodes;if((0,l.expValEquals)("platform_editor_fix_quick_insert_consistency_exp","isEnabled",!0))if(e.selection.empty){let n=r.createAndFill({...t});if(!n)return!1;s=void 0!==a?a(n):(0,i("zT4ZO").insertSelectedItem)(n)(e,e.tr,e.selection.head)?.scrollIntoView()}else s=(0,i("l9FJJ").createWrapSelectionTransaction)({state:e,type:r,nodeAttributes:{...t}});else if((0,c.editorExperiment)("platform_editor_controls","variant1"))s=e.selection.empty&&(0,i("l9FJJ").createWrapSelectionTransaction)({state:e,type:r,nodeAttributes:{...t}});else{let n=r.createAndFill({...t});if(!n)return!1;s=e.selection.empty&&a(n)}return s&&n?.analytics?.actions.attachAnalyticsEvent({action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.PANEL,attributes:{inputMethod:o,panelType:t.panelType},eventType:i("d925B").EVENT_TYPE.TRACK})(s),s??!1}t.exports.default=({config:e={},api:t})=>((0,d.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)&&t?.blockMenu?.actions.registerBlockMenuComponents([{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_PANEL_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_PANEL_MENU_ITEM.key]},component:M(t)}]),{name:"panel",nodes:()=>(0,i("dh538").fg)("platform_editor_adf_with_localid")?(0,i("dh538").fg)("platform_editor_ai_generic_prep_for_aifc_2")?[{name:"panel",node:{...(0,i("dGKc1").extendedPanelWithLocalId)(!!e.allowCustomPanel),definingAsContext:!0}}]:[{name:"panel",node:(0,i("dGKc1").extendedPanelWithLocalId)(!!e.allowCustomPanel)}]:[{name:"panel",node:(0,i("dGKc1").extendedPanel)(!!e.allowCustomPanel)}],pmPlugins:()=>[{name:"panel",plugin:({providerFactory:n,dispatch:a,nodeViewPortalProviderAPI:i})=>A(a,n,e,t,i)},{name:"panelKeyMap",plugin:()=>E()}],actions:{insertPanel(e){var n;return(0,l.expValEquals)("platform_editor_fix_quick_insert_consistency_exp","isEnabled",!0)?function(n,a){let o=K({state:n,attributes:{panelType:i("dGKc1").PanelType.INFO},api:t,inputMethod:e});return!!o&&(a&&a(o),!0)}:(n=t?.analytics?.actions,(0,i("dAtrv").withAnalytics)(n,{action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.PANEL,attributes:{inputMethod:e,panelType:i("dGKc1").PanelType.INFO},eventType:i("d925B").EVENT_TYPE.TRACK})(function(e,t){let{nodes:n}=e.schema;return!!n.panel&&!!n.paragraph&&(0,i("8vgNB").wrapSelectionIn)(n.panel)(e,t)}))}},pluginsOptions:{quickInsert:({formatMessage:n})=>{let o=[{id:"infopanel",title:n(i("2UWDO").messages.infoPanel),keywords:["panel"],description:n(i("2UWDO").messages.infoPanelDescription),priority:800,icon:()=>(0,a.jsx)(r.IconPanel,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.INFO},api:t,typeAheadInsert:e})},{id:"notepanel",title:n(i("2UWDO").messages.notePanel),description:n(i("2UWDO").messages.notePanelDescription),priority:1e3,icon:()=>(0,a.jsx)(r.IconPanelNote,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.NOTE},api:t,typeAheadInsert:e})},{id:"successpanel",title:n(i("2UWDO").messages.successPanel),description:n(i("2UWDO").messages.successPanelDescription),keywords:["tip"],priority:1e3,icon:()=>(0,a.jsx)(r.IconPanelSuccess,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.SUCCESS},api:t,typeAheadInsert:e})},{id:"warningpanel",title:n(i("2UWDO").messages.warningPanel),description:n(i("2UWDO").messages.warningPanelDescription),priority:1e3,icon:()=>(0,a.jsx)(r.IconPanelWarning,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.WARNING},api:t,typeAheadInsert:e})},{id:"errorpanel",title:n(i("2UWDO").messages.errorPanel),description:n(i("2UWDO").messages.errorPanelDescription),priority:1e3,icon:()=>(0,a.jsx)(r.IconPanelError,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.ERROR},api:t,typeAheadInsert:e})}];return e.allowCustomPanel&&e.allowCustomPanelEdit&&o.push({id:"custompanel",title:n(i("2UWDO").messages.customPanel),description:n(i("2UWDO").messages.customPanelDescription),priority:1e3,icon:()=>(0,a.jsx)(s,{}),action:(e,n)=>K({state:n,attributes:{panelType:i("dGKc1").PanelType.CUSTOM,panelIcon:":rainbow:",panelIconId:"1f308",panelIconText:"\uD83C\uDF08",panelColor:i("6fnsQ").T50},api:t,typeAheadInsert:e})}),o},floatingToolbar:(n,a,i)=>U(n,a,e,i,t)}})}),o("jaskt",function(t,n){var a,o,s,r,l,d=i("l998X");i("42omo");var c=i("3pLGZ"),p=i("8m4tT"),u=i("1oCLl"),h=i("dZ8uq"),m=i("iu6m9");let f=e=>0===e.content.childCount||"blockTaskItem"===e.type.name&&1===e.content.childCount&&e.content.firstChild?.type.name==="paragraph"&&e.content.firstChild?.childCount===0,g=()=>(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)?i("5elS6").taskItem:{...i("5elS6").taskItem,toDOM:e=>y(e)},T=()=>(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)?i("5elS6").blockTaskItem:{...i("5elS6").blockTaskItem,toDOM:e=>y(e)},E=e=>`task-checkbox-${e}`,y=e=>{let t="DONE"===e.attrs.state,n={name:e.attrs.localId,id:e.attrs.localId,type:"checkbox"};t&&(n.checked="true");let a={"data-task-local-id":e.attrs.localId,"data-task-state":e.attrs.state,..."blockTaskItem"===e.type.name?{"data-task-is-block":"true"}:{}};return["div",{class:i("7iisy").TaskDecisionSharedCssClassName.TASK_CONTAINER,...a,style:(0,i("24P9d").convertToInlineCss)({listStyleType:"none",lineHeight:"24px",minWidth:"48px",position:"relative"})},["div",{style:(0,i("24P9d").convertToInlineCss)({display:"flex"})},["span",{contenteditable:"false",style:(0,i("24P9d").convertToInlineCss)({width:"24px",height:"24px",lineHeight:"24px",display:"grid",placeContent:"center center"})},["input",{...n,"data-input-type":"lazy-task-item",style:(0,i("24P9d").convertToInlineCss)({width:"13px",height:"13px",margin:"1px 0 0 0",padding:0,accentColor:"var(--ds-background-selected-bold, #1868DB)"})}]],["div",{"data-component":"content"},["div",{class:i("7iisy").TaskDecisionSharedCssClassName.TASK_ITEM,style:(0,i("24P9d").convertToInlineCss)({display:"block",fontSize:"16px",fontFamily:'var(--ds-font-body, normal 400 14px/20px ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Ubuntu, "Helvetica Neue", sans-serif)',color:"var(--ds-text, #292A2E)"})},0]]]]},_=()=>(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)?i("bpTLT").decisionItem:{...i("bpTLT").decisionItem,toDOM:e=>{let{localId:t,state:n}=e.attrs,a=0===e.content.size;return["li",{"data-decision-local-id":t||"local-decision","data-decision-state":n,class:"decisionItemView-content-wrap"},["div",{"data-decision-wrapper":!0,"data-testid":"elements-decision-item",style:(0,i("24P9d").convertToInlineCss)({background:"var(--ds-background-neutral, #0515240F)",padding:"var(--ds-space-100, 8px)",paddingLeft:"var(--ds-space-150, 12px)",margin:"var(--ds-space-100, 8px) 0 0 0",display:"flex",borderRadius:"var(--ds-radius-small, 3px)"})},["span",{style:(0,i("24P9d").convertToInlineCss)({width:"16px",height:"16px",margin:"var(--ds-space-050, 4px) var(--ds-space-150, 12px) 0 0",color:a?"var(--ds-icon-subtle, #505258)":"var(--ds-icon-success, #6A9A23)",display:"flex",alignItems:"center",justifyContent:"center"}),contentEditable:"false","data-component":"icon"},["span",{role:"img","aria-label":"Decision",style:(0,i("24P9d").convertToInlineCss)({width:"32px",height:"32px"})},["http://www.w3.org/2000/svg svg",{viewBox:"0 0 24 24",role:"presentation",width:"24",height:"24","data-icon-source":"legacy",style:(0,i("24P9d").convertToInlineCss)({width:"32px",height:"32px"})},["http://www.w3.org/2000/svg path",{fill:"currentcolor","fill-rule":"evenodd",d:"m9.414 8 3.293 3.293c.187.187.293.442.293.707v5a1 1 0 0 1-2 0v-4.586l-3-3V10.5a1 1 0 0 1-2 0V7a1 1 0 0 1 1-1h3.5a1 1 0 0 1 0 2zm8.293-1.707a1 1 0 0 1 0 1.414l-2.5 2.5a.997.997 0 0 1-1.414 0 1 1 0 0 1 0-1.414l2.5-2.5a1 1 0 0 1 1.414 0"}]]]],["div",{"data-component":"content"},["div",{class:"decision-item"},0]]]]}},S=new(0,i("ks2lK").PluginKey)("tasksAndDecisionsPlugin");var b=((a={})[a.SET_PROVIDER=0]="SET_PROVIDER",a[a.FOCUS_BY_LOCALID=1]="FOCUS_BY_LOCALID",a[a.OPEN_REQUEST_TO_EDIT_POPUP=2]="OPEN_REQUEST_TO_EDIT_POPUP",a);function C(e){return!!(e&&e.type&&"taskList"===e.type.name)}let v=e=>{let t=e.blockRange(e,C);return t&&0===e.textOffset&&t.end-1===e.pos?i("ks2lK").Selection.near(e.doc.resolve(t.end+1),1).$from:e},I=e=>{let t=e.blockRange(e,C);return t&&0===e.textOffset&&t.start+1===e.pos?i("ks2lK").Selection.near(e.doc.resolve(t.start-1),-1).$to:e},N=e=>{if(e.empty)return e;let{$from:t,$to:n}=e;if(e instanceof i("ks2lK").NodeSelection){let e=v(t);return new(0,i("ks2lK").TextSelection)(e,e)}let a=v(t),o=I(n);return new(0,i("ks2lK").TextSelection)(o,a)},k=e=>{let{blockTaskItem:t,paragraph:n}=e.doc.type.schema.nodes,a=e.parent;if(a.type===t)return{blockTaskItemNode:a,hasParagraph:!1};if(a.type===n&&e.depth>=1){let n=e.node(e.depth-1);if(n.type===t)return{blockTaskItemNode:n,hasParagraph:!0}}return!1},x=e=>{let{decisionItem:t,taskItem:n,blockTaskItem:a}=e.schema.nodes;return a?!!(0,p.findParentNodeOfTypeClosestToPos)(e.selection.$from,[t,n,a]):(0,p.hasParentNodeOfType)([t,n,a])(e.selection)},A=e=>{let{taskList:t,decisionList:n}=e.type.schema.nodes;return[t,n].indexOf(e.type)>-1},O=e=>{let{taskItem:t,decisionItem:n,blockTaskItem:a}=e.type.schema.nodes;return[t,n,a].indexOf(e.type)>-1},P=e=>{let{taskItem:t,blockTaskItem:n}=e.schema.nodes;return(0,p.hasParentNodeOfType)([t,n])(e.selection)},M=e=>{let{decisionItem:t}=e.schema.nodes;return(0,p.hasParentNodeOfType)([t])(e.selection)},w=e=>{if(!e)return!1;let{table:t,tableHeader:n,tableCell:a,tableRow:i}=e.type.schema.nodes;return[t,n,a,i].includes(e.type)},D=({$from:e,$to:t})=>{let{taskList:n,taskItem:a,blockTaskItem:o,paragraph:s}=e.doc.type.schema.nodes;if(o){let r=k(e);if(r){let{hasParagraph:l}=r,d=l?e.depth-1:e.depth,c=d-1,p=e.start(d)-1,u=t.end(),h=t.doc.resolve(u+1),m=h.nodeAfter,f=t.node(t.depth),g=t.start()+f.nodeSize;f.type===s?m=(h=t.doc.resolve(u+2)).nodeAfter:(c--,g--),m&&m.type===n&&h.depth===d-1&&(g+=m.nodeSize);let T=e.doc.resolve(p-1),E=T.nodeBefore?.nodeSize||0,y=e.doc.resolve(T.pos-E-1).nodeAfter;return y&&[o,a].includes(y.type)&&(c=d-1,g-=2,p+=1),new(0,i("5SAOw").NodeRange)(t.doc.resolve(p),t.doc.resolve(g),c)}}let r=t.end(),l=t.doc.resolve(r+1),d=l.nodeAfter;return d&&d.type===n&&l.depth===t.depth-1&&(r+=d.nodeSize),e.blockRange(t.doc.resolve(r))},R=e=>{let{$from:t}=e,{taskList:n,blockTaskItem:a}=t.doc.type.schema.nodes,o=(0,i("l9G9n").findFarthestParentNode)(e=>e.type===n)(t);if(!o)return null;if((0,p.hasParentNodeOfType)([a])(e)){let e=(0,i("l9G9n").findFarthestParentNode)(e=>e.type===a)(t);if(e)return e.depth-o.depth}return t.depth-o.depth},B=e=>{let t=e.selection.$from,n=(0,p.findParentNodeClosestToPos)(t,e=>e?.type.name==="taskList");return t.index(n?n.depth:void 0)},L=e=>{let t=e;for(;t.pos<t.doc.nodeSize-2&&t.parentOffset>0;)t=t.doc.resolve(t.pos+1);return t},U=(e,t,n)=>{let a=(0,i("l9G9n").findFarthestParentNode)(e=>n.indexOf(e.type)>-1)(e);if(!a)return -1;let o=e.depth-a.depth,s=D({$from:e,$to:t});if(!s)return -1;let r=e.depth;return e.doc.nodesBetween(s.start,s.end,(t,a,i)=>{if(r=Math.max(e.doc.resolve(a).depth,r),n.indexOf(t.type)>-1)return!0}),o+(r-e.depth)},K=e=>{let{selection:t,schema:n}=e,{paragraph:a,blockTaskItem:o,decisionItem:s,taskItem:r}=n.nodes,{$from:l}=t,d=l.node(l.depth),c=d&&(d.type===r||d.type===s)&&0===d.content.size,p=0===d.content.size&&d.type===a&&l.depth>0&&l.node(l.depth-1).type===o&&1===l.node(l.depth-1).childCount&&(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_3");return c||p},F=(e,t,n)=>{let a=D({$from:t,$to:n});if(!a)return null;let o=(0,i("aXG5V").liftTarget)(a);return"number"!=typeof o?null:e.lift(a,o).scrollIntoView()};function j(e){let{state:t}=e,{selection:n,schema:a}=t,{$from:i}=n;if((0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)){let{taskItem:e,blockTaskItem:t}=a.nodes,n=(0,p.findParentNodeOfTypeClosestToPos)(i,[e,t]);if(n)return{pos:n?.pos,localId:n?.node.attrs.localId}}else if(i.node().type===a.nodes.taskItem)return{pos:i.before(),localId:i.node().attrs.localId}}function G(e,t){let n=function(e){let{state:t}=e,{schema:n}=t,a=t.selection.$from;if(!((0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)?P(t):a.node().type===n.nodes.taskItem))return;let{taskList:o,taskItem:s,blockTaskItem:r}=n.nodes,l=(0,i("l9G9n").findFarthestParentNode)(e=>e.type===o)(a);if(l){let e=l.node,t=l.start,n=[];return e.descendants((e,a,i,o)=>{(e.type===s||(0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)&&r&&e.type===r)&&n.push({node:e,pos:a+t,index:o})}),n}}(e);if(!n)return;let a=function(e,t){let{state:n}=e,{schema:a}=n,{taskItem:i,blockTaskItem:o}=a.nodes,s=n.selection.$from,r=t.map(e=>e.node),l=(0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)?(0,p.findParentNodeOfTypeClosestToPos)(s,[i,o])?.node:s.node(s.depth);return l?r.indexOf(l):-1}(e,n);if("next"===t?a===n.length-1:0===a)return;let o=n["next"===t?a+1:a-1];return{pos:o.pos,localId:o.node.attrs.localId}}function V(e,t){let{pos:n,localId:a}=t,{state:o,dispatch:s}=e,{doc:r}=o,{schema:l}=o,{extension:d}=l.nodes,c=o.tr;(0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)&&d&&r.resolve(n+1).nodeAfter?.type===d?c.setSelection(new(0,i("adhil").GapCursorSelection)(r.resolve(n+1))):(0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)&&r.resolve(n+1).nodeAfter?.isTextblock?c.setSelection(new(0,i("ks2lK").TextSelection)(r.resolve(n+2))):c.setSelection(new(0,i("ks2lK").TextSelection)(r.resolve(n+1))),c.setMeta(S,{action:b.FOCUS_BY_LOCALID,data:a}),s(c)}function z(e){let{state:t,dispatch:n}=e,{tr:a}=t;e.focus(),n(a.setMeta(S,{action:b.FOCUS_BY_LOCALID}))}function H(e){let t=e.doc.nodeAt(e.pos),n=null;if((0,i("irKZA").isListNode)(t))n=e.pos;else{let t=(0,p.findParentNodeClosestToPos)(e,i("irKZA").isListNode);n=t&&t.pos}if(null==n)return null;let a=e.doc.nodeAt(n);return a?{node:a,pos:n}:null}let q=e=>{let{$from:t}=e.selection,{blockTaskItem:n}=e.schema.nodes;return t.parent.isTextblock&&t.node(t.depth-1).type===n&&0===t.index(t.depth-1)},W=e=>{let{$from:t}=e.selection,{blockTaskItem:n}=e.schema.nodes,a=t.node(t.depth-1);return t.parent.isTextblock&&a.type===n&&t.index(t.depth-1)===a.childCount-1};var X=((o={}).EDIT="edit",o.NEW="new",o);(s={}).RESOLVED="resolved",s.UNRESOLVED="unresolved",(r={}).TEXT="text",r.INLINE_CARD="inlineCard",r.BLOCK_CARD="blockCard",r.EMBED="embed",(l={}).JIRA="jiraIssue",l.CONFLUENCE="confluencePage",l.BITBUCKET_PR="bitbucketPR",l.BITBUCKET_REPO="bitbucketRepo",l.TRELLO_CARD="trelloCard",l.TRELLO_BOARD="trelloBoard",l.STATUS_PAGE="statusPage",l.BOX="boxFile",l.DROPBOX="dropboxFile",l.OFFICE="office",l.DRIVE="drive",l.YOUTUBE="youtubeVideo",l.TWITTER="twitterTweet",l.OTHER="other";let Y=(e={})=>{let{objectId:t,containerId:n}=e,a=t?X.EDIT:X.NEW;return{objectId:t,containerId:n,userContext:a}},$=(e,t,n,a,o,s,r)=>{let l,d,c;return t&&({containerId:l,objectId:d,userContext:c}=t),{action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:"taskList"===e?i("d925B").ACTION_SUBJECT_ID.ACTION:i("d925B").ACTION_SUBJECT_ID.DECISION,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:n,containerAri:l,objectAri:d,userContext:c,localId:a,listLocalId:o,position:s,listSize:r}}},J=(e,t)=>{let{decisionList:n,decisionItem:a,taskList:i,taskItem:o}=t.nodes;return"taskList"===e?{list:i,item:o}:{list:n,item:a}},Z=(e,t)=>(n,a,o=i("d925B").INPUT_METHOD.TOOLBAR,s,r,l,d)=>{let{schema:c}=n,p=s??(({tr:e,list:t,item:a,listLocalId:i,itemLocalId:o})=>ea(e,t,a,c,n,i,o,d)),u=ee(e,t)(n,a,o,p,({state:e,tr:t,item:n,itemLocalId:a})=>{let{$to:o}=e.selection,s=o.end(o.depth);return t.split(s,1,[{type:n,attrs:{localId:a}}]).setSelection(new(0,i("ks2lK").TextSelection)(t.doc.resolve(s+2)))},r,l,d);return u?((0,i("56SXY").autoJoinTr)(u,["taskList","decisionList"]),u):n.tr},Q=(e,t)=>(n,a=i("d925B").INPUT_METHOD.TOOLBAR,o,s,r)=>(i,l)=>{let d=Z(e,t)(i,n,a,o,s,r);return l&&l(d),!0},ee=(e,t)=>(n,a,o,s,r,l,d,c)=>{let u,h,m,{schema:f}=n,{list:g,item:T}=J(a,f),{tr:E}=n,{$to:y}=n.selection,_=(0,p.findParentNodeOfType)(g)(n.selection),S=Y(t());if(_){if(y.node().textContent.length>=0){m=_.node.childCount+1,l=l||_.node.attrs.localId;let e=(0,p.findParentNodeOfType)(T)(n.selection);h=e?n.doc.resolve(e.pos).index()+1:0,u=r||s}}else h=0,m=1,u=s;if(l=l||i("fO7hX").uuid.generate(),d=d||i("fO7hX").uuid.generate(),u){let t=u({state:n,tr:E,list:g,item:T,listLocalId:l,itemLocalId:d,itemAttrs:c});return t&&e?.attachAnalyticsEvent($(a,S,o,d,l,h||0,m||0))(t),t}return null},et=(e,t)=>{let{paragraph:n,blockquote:a,decisionList:i,taskList:o,bulletList:s,numberedList:r}=e.nodes;return(0,p.hasParentNodeOfType)([a,n,i,o])(t)&&!(0,p.hasParentNodeOfType)([s,r])(t)},en=(e,t)=>t.depth-e.depth,ea=(e,t,n,a,o,s=i("fO7hX").uuid.generate(),r=i("fO7hX").uuid.generate(),l)=>{let{selection:d}=o,{$from:c,$to:u}=d;if(c.parent!==u.parent)return null;let{paragraph:h,blockquote:m,decisionList:f,taskList:g,decisionItem:T,taskItem:E,mediaGroup:y}=a.nodes;if(c.parent.type===y)return null;let _=t.create({localId:s},[n.create({localId:r,...l})]);if(d instanceof i("adhil").GapCursorSelection)return(0,p.safeInsert)(_)(e);if(et(a,d)){let{type:a,childCount:o}=d.$from.node(),s=t.create({localId:i("fO7hX").uuid.generate()},[n.create({localId:i("fO7hX").uuid.generate()},c.node(c.depth).content)]),r=(0,p.findParentNodeOfType)(m)(d);if(r){let t=c.depth-1,n=new(0,i("5SAOw").NodeRange)(c,u,t);e.lift(n,(0,i("aXG5V").liftTarget)(n))}let l=(0,p.findParentNodeOfType)(g)(d)||(0,p.findParentNodeOfType)(f)(d),y=(0,p.findParentNodeOfType)(E)(d)||(0,p.findParentNodeOfType)(T)(d);if(l&&y){let t,n,a=d.from;return l.node.firstChild===y.node?(t=l.start-1,n=y.start+y.node.nodeSize,1===l.node.childCount&&(n=l.start+l.node.nodeSize-1)):(t=y.start-1,n=y.start+y.node.nodeSize,a+=2),e.replaceWith(t,n,s),e=(0,p.setTextSelection)(a)(e)}let _=[m];(a===h&&o>0||r)&&_.push(h);let S=e,b=en(u,(S=(0,p.replaceParentNodeOfType)(_,s)(e)).selection.$to);if(S!==(e=e.setSelection(new(0,i("ks2lK").TextSelection)(e.doc.resolve(u.pos+b)))))return e}return(0,p.safeInsert)(_)(e)},ei=e=>t=>t.setMeta(S,{action:b.SET_PROVIDER,data:e}),eo=(e,t)=>(n,a,o)=>(0,i("l03WE").createRule)(n,(n,s,r,l)=>{let{paragraph:d}=n.schema.nodes,{list:c}=J(a,n.schema),u=n.doc.resolve(l),h=n.doc.resolve(u.after());return u.parent.type===d&&(0,p.canInsert)(h,c.createAndFill())?Z(e,t)(n,a,i("d925B").INPUT_METHOD.FORMATTING,el(r,l),void 0,void 0,o):null}),es=e=>e.node(e.depth-1)?.type.name==="listItem",er=(e,t,n,a,o,s,r,l)=>{let d=e.cut(t.pos-t.start(),e.size);n.insert(t.after(),a.create({localId:s},[o.create({localId:r,...l},d)])).setSelection(new(0,i("ks2lK").TextSelection)(n.doc.resolve(t.after()))).delete(t.start(),t.end())},el=(e,t)=>({tr:n,state:a,list:o,item:s,listLocalId:r,itemLocalId:l,itemAttrs:d})=>{let{selection:{$from:c},schema:p}=a,{hardBreak:u}=p.nodes,h=c.node(c.depth).content,m=!1;if(h.forEach((t,n)=>{t.type===u&&n<e&&(m=!0)}),!m)return es(c)?er(h,c,n,o,s,r,l,d):n.replaceRangeWith(c.before(),c.after(),o.create({localId:r},[s.create({localId:l,...d},h)])).delete(e+1,t+1).setSelection(new(0,i("ks2lK").TextSelection)(n.doc.resolve(e+1))),n;let f=en(c,n.selection.$from);return n.split(c.pos).setSelection(new(0,i("ks2lK").NodeSelection)(n.doc.resolve(c.pos+1))).replaceSelectionWith(o.create({localId:r},[s.create({localId:l,...d},n.doc.nodeAt(c.pos+1).content)])).setSelection(new(0,i("ks2lK").TextSelection)(n.doc.resolve(c.pos+f))).delete(e,t+1),n};var ed=(e,t)=>(n,a)=>{let o=[],{decisionList:s,decisionItem:r,taskList:l,taskItem:d}=n.nodes;return s&&r&&o.push(eo(e,t)(RegExp(`(^|${i("14sLv").leafNodeReplacementCharacter})\\<\\>\\s$`),"decisionList")),l&&d&&(o.push(eo(e,t)(RegExp(`(^|${i("14sLv").leafNodeReplacementCharacter})\\[\\]\\s$`),"taskList")),o.push(eo(e,t)(RegExp(`(^|${i("14sLv").leafNodeReplacementCharacter})\\[x\\]\\s$`),"taskList",{state:"DONE"}))),new(0,i("1S4f7").SafePlugin)((0,i("aIMBk").createPlugin)("tasks-and-decisions",o,{isBlockNodeRule:!0}))};let ec=(e,t)=>{let{$from:n,$to:a}=N(e.selection),i=F(e.tr,n,a);return t&&i&&t(i),!!i},ep=(e,t)=>{let{$from:n,$to:a}=N(e.selection),{taskList:o,taskItem:s,blockTaskItem:r}=e.schema.nodes,l=U(n,a,[o,s]);if(r){let e=k(n);if(e){let{hasParagraph:t}=e;l=t?U(n,a,[o,r])-1:U(n,a,[o,r])}}if(l>=6)return!0;let d=D({$from:n,$to:a});if(!d)return!0;let c=(0,i("aXG5V").findWrapping)(d,e.schema.nodes.taskList);return!c||(t&&t(e.tr.wrap(d,c).scrollIntoView()),!0)},eu=e=>(t,n)=>{let a=(0,i("dhoHU").findCutBefore)(e),{blockTaskItem:o}=t.schema.nodes;if(!a)return!1;let{paragraph:s}=a.doc.type.schema.nodes;if(a.nodeBefore&&A(a.nodeBefore)&&a.nodeAfter&&a.nodeAfter.type===s){let e=a.doc.resolve(a.pos-1);for(;!O(e.parent);)e=t.doc.resolve(e.pos-1);let r=t.tr.doc.slice(e.pos,a.pos),l=e.pos,d=a.pos+a.nodeAfter.nodeSize,c=a.pos+1,p=a.pos+a.nodeAfter.nodeSize-1;if(o&&e.parent.type===o){let n=t.doc.resolve(e.pos-1);n.parent.type===s?(r=t.tr.doc.slice(n.pos,a.pos),l=e.pos-1):(c=a.pos,p=a.pos+a.nodeAfter.nodeSize-1)}let u=t.tr.step(new(0,i("aXG5V").ReplaceAroundStep)(l,d,c,p,r,0,!0));return n&&n(u),!0}return!1},eh=(e="paragraph")=>({tr:t})=>{let{nodes:n}=t.doc.type.schema,{selection:a}=t;if((0,i("dh538").fg)("platform_editor_toolbar_aifc_ga_blockers")){let{$from:e}=a;if(0===e.parent.content.size&&n.taskList&&n.taskItem){let e=i("fO7hX").uuid.generate(),a=i("fO7hX").uuid.generate(),o=n.taskList.create({localId:e},[n.taskItem.create({localId:a})]),s=(0,p.safeInsert)(o)(t);if(s!==t){let e=s.selection.$from.pos;return s.setSelection(i("ks2lK").TextSelection.near(s.doc.resolve(e)))}}}let{node:o,pos:s}=(0,i("4FFjp").getFormattedNode)(t);if(null!==o&&null!==s){if((0,i("iD5M5").isBulletOrOrderedList)(o.type)){let e={sourceNode:o,sourcePos:s,targetNodeType:n.taskList,tr:t};return(0,i("4FFjp").transformBetweenListTypes)(e)}if((0,i("iD5M5").isTaskList)(o.type)){let a={sourceNode:o,sourcePos:s,targetNodeType:n[e],tr:t};return"paragraph"===e?(0,i("4FFjp").transformTaskListToBlockNodes)(a):(0,i("4FFjp").transformBetweenListTypes)(a)}let{$from:r,$to:l}=a,d=r.blockRange(l);if(d)return(0,i("4FFjp").transformToTaskList)(t,d,n.taskList,void 0,n)}return t},em=(e,t,n)=>({action:i("d925B").ACTION.FORMATTED,actionSubject:i("d925B").ACTION_SUBJECT.TEXT,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.FORMAT_INDENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:n,previousIndentationLevel:e,newIndentLevel:t===i("aU3dp").INDENT_DIRECTION.OUTDENT?e-1:e+1,direction:t,indentType:i("aU3dp").INDENT_TYPE.TASK_LIST}}),ef=e=>e.doc.resolve(e.end()).nodeAfter,eg=e=>{let t=ef(e);return!t||O(t)},eT=e=>(t=i("d925B").INPUT_METHOD.KEYBOARD)=>(0,i("e7tBw").filterCommand)(P,(n,a)=>{let o=R(N(n.selection));return!!o&&1!==o&&(0,i("dAtrv").withAnalytics)(e,em(o,i("aU3dp").INDENT_DIRECTION.OUTDENT,t))((0,i("astHL").autoJoin)(ec,["taskList"]))(n,a)}),eE=e=>{let t=R(e.selection),n=B(e),{tableCell:a,tableHeader:i}=e.schema.nodes,o=(0,p.findParentNodeOfType)([a,i])(e.selection);return!!(1===t&&0===n||M(e))&&!!o},ey=e=>(t=i("d925B").INPUT_METHOD.KEYBOARD)=>(0,i("e7tBw").filterCommand)(P,(n,a)=>{let o=R(N(n.selection));return!o||o>=6||(0,i("dAtrv").withAnalytics)(e,em(o,i("aU3dp").INDENT_DIRECTION.INDENT,t))((0,i("astHL").autoJoin)(ep,["taskList"]))(n,a)}),e_=e=>t=>(n,a)=>{let{taskList:i,blockTaskItem:o,paragraph:s}=n.schema.nodes;if((0,u.expValEquals)("editor_refactor_backspace_task_and_decisions","isEnabled",!0)){let r=k(t),l=r&&r?.hasParagraph,d=l?t.before()-1:t.before(),c=t.doc.resolve(d).nodeBefore,p=c&&O(c)&&0===c.content.size,u=o&&c?.type===o&&c?.firstChild?.type===s&&c?.firstChild?.content?.size===0;if(p||u)return!1;let h=t.depth-((l?2:1)+1);if(t.node(h).type===i)return eT(e)()(n,a);if(eg(t)&&a){let e,i=l?n.doc.slice(t.start(t.depth-1),t.end(t.depth-1)).content:n.doc.slice(t.start(),t.end()).content;try{e=i.size?s.createChecked(void 0,i):s.createChecked();let o=eI(n.tr,e,t,!0);return a(o),!0}catch(o){if(r&&r.blockTaskItemNode)return e=Array.from(i.content),a(eI(n.tr,e,t,!0)),!0}}}else{let r=t.doc.resolve(t.before());if(r.nodeBefore&&O(r.nodeBefore)&&2===r.nodeBefore.nodeSize)return!1;if(t.node(t.depth-2).type===i)return eT(e)()(n,a);if(eg(t)&&a){let e,i=n.doc.slice(t.start(),t.end()).content;try{e=i.size?s.createChecked(void 0,i):s.createChecked();let o=eI(n.tr,e,t,!0);return a(o),!0}catch(s){if(o)return e=Array.from(i.content),a(eI(n.tr,e,t,!0)),!0}}}return!1},eS=e=>(0,i("e7tBw").filterCommand)(i("e7tBw").isEmptySelectionAtStart,(0,i("astHL").autoJoin)((0,i("astHL").chainCommands)((e,t)=>eu(e.selection.$from)(e,t),(0,i("e7tBw").filterCommand)(x,(t,n)=>e_(e)(t.selection.$from)(t,n))),["taskList","decisionList"])),eb=(0,i("astHL").autoJoin)((0,i("astHL").chainCommands)((0,i("e7tBw").deleteEmptyParagraphAndMoveBlockUp)(A),(e,t)=>{if(!(0,i("e7tBw").isEmptySelectionAtEnd)(e)||!x(e)||!t)return!1;let n=L(e.selection.$from),{taskList:a,taskItem:o,decisionList:s,decisionItem:r,paragraph:l,bulletList:d,orderedList:c,listItem:u}=e.schema.nodes;if(!(0,p.findParentNodeOfTypeClosestToPos)(n,[a,o,s,r])){if(n.parent.type===l)return eu(n.doc.resolve(n.pos))(e,t);if((n.parent.type===d||n.parent.type===c)&&n.parent.firstChild&&n.parent.firstChild.type===u){let a=e.doc.resolve(n.pos+1),o=F(e.tr,a,a);return(0,i("astHL").autoJoin)((e,t)=>!!o&&(t&&t(o),!0),["bulletList","orderedList"])(e,t)}}return!1},(e,t)=>{let{selection:{$from:n},schema:{nodes:{taskList:a,doc:o,paragraph:s,blockTaskItem:r,taskItem:l}},tr:d}=e;if((0,i("dh538").fg)("platform_editor_blocktaskitem_patch_3")){if(!(0,i("e7tBw").isEmptySelectionAtEnd)(e)||!t)return!1;let c=L(n);if(!c.parent||c.parent.type===o)return!1;let p=n.doc.resolve(n.start(n.depth-1)),u=n.node(),h=p.node();if(!O(u)&&!O(h))return!1;let m=k(c),f=!1;if(m){let{blockTaskItemNode:e}=m;f=r&&e&&1===e.childCount&&e.firstChild?.type===s&&0===e.firstChild.childCount}if(u&&O(u)&&0===u.childCount||f)return!1;let g=k(c),T=g&&g?.hasParagraph;if(c.node(c.depth-2).type===a||c.node(c.depth-1).type===a&&c.parent.type===a)return F(d,c,c),t(d),!0;let E=r&&(c?.node()?.type===l&&n?.node()?.type===r||c?.node()?.type===r&&n?.node()?.type===l||[l,r].includes(c?.node()?.type)&&m&&m.blockTaskItemNode);if((!w(c.nodeAfter)&&O(n.parent)||m&&m.blockTaskItemNode&&eg(n)&&(c.node().type.name===n.node().type.name||E))&&t){let n,a=T?e.doc.slice(c.start(c.depth-1),c.end(c.depth-1)).content:e.doc.slice(c.start(),c.end()).content;try{n=a.size?s.createChecked(void 0,a):s.createChecked();let i=eI(e.tr,n,c,!1);return t(i),!0}catch(i){if(g&&g.blockTaskItemNode){n=Array.from(a.content);let i=c;return c.node().firstChild?.isTextblock&&(i=c.doc.resolve(c.pos+1)),t(eI(e.tr,n,i,!1)),!0}}}}else{if(!(0,i("e7tBw").isEmptySelectionAtEnd)(e)||!t)return!1;let r=L(n);if(!r.parent||r.parent.type===o)return!1;if(r.node(r.depth-2).type===a||r.node(r.depth-1).type===a&&r.parent.type===a)return F(d,r,r),t(d),!0;if(!w(r.nodeAfter)&&O(n.parent)&&eg(n)&&r.node().type.name===n.node().type.name){let n=e.doc.slice(r.start(),r.end()).content;return t(eI(d,n.size?s.createChecked(void 0,n):[],r,!1)),!0}}return!1}),["taskList","decisionList"]),eC=(e,t)=>{let n=e.selection.$from,a=e.doc.resolve(n.start(n.depth-2)),i=e.doc.resolve(a.before()-1);e.delete(i.start(),a.pos)},ev=(e,t,n)=>{let a=H(t),o=a?.node.childCount,s=H(e.doc.resolve(e.mapping.map(t.pos))),r=s?.node.childCount;o&&r&&o+1!==r&&eC(e,t);let l=e.doc.resolve(n);e.setSelection(i("ks2lK").TextSelection.create(e.doc,l.after()+2))},eI=(e,t,n,a)=>{let o=e.doc,{blockTaskItem:s,taskList:r}=e.doc.type.schema.nodes,l=n.depth,d=o.resolve(n.after()),c=0,p=0,u=0,h=!0,m=!1,f=!1;if(s){let t=k(n);if(t){let{blockTaskItemNode:a,hasParagraph:g}=t;if(f=(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_3")&&!!a,a){g?(l=n.depth-1,d=o.resolve(n.after(l)),u=1):(c=1,m=!0),c=1,d.nodeAfter?.type===r&&(h=!1);let t=n.start(g?n.depth-1:n.depth)-1,a=e.doc.resolve(t);a.nodeBefore?.type===s&&g&&(p=1)}}}let g=n.node(l-2),T=n.index(l-1),E=!(!A(g)&&0===T)&&h,y=i("5SAOw").Fragment.from(t),_=1===y.childCount&&y.firstChild?.type.name==="listItem";E&&!_&&(e=e.split(n.pos,(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_3")&&f?0:1,[{type:n.parent.type,attrs:{localId:i("fO7hX").uuid.generate()}}]));let S=_?n.start(l-2):0;if(e=e.replace(e.mapping.map(n.start(l)-2+p),e.mapping.map(n.end(l)+2),y.size?new(0,i("5SAOw").Slice)(y,0,0):i("5SAOw").Slice.empty),a&&!_){let t=n.pos+1-(2*!E+c);e=m?e.setSelection(new(0,i("adhil").GapCursorSelection)(e.doc.resolve(t),i("adhil").Side.LEFT)):e.setSelection(new(0,i("ks2lK").TextSelection)(e.doc.resolve(t)))}if(d.depth===l-1&&d.nodeAfter&&A(d.nodeAfter)){let t=e.mapping.map(d.pos+2),n=e.doc.resolve(t),a=D({$from:n,$to:e.doc.resolve(n.after(n.depth-1)-1)});a&&(e=e.lift(a,a.depth-1).scrollIntoView()),e=e.deleteRange(t-3-u,t-1-u)}return _&&ev(e,n,S),e},eN=e=>e.schema.nodes.listItem.create({},e.schema.nodes.paragraph.create()),ek=(e,t)=>{let{tr:n,selection:{$from:a}}=e,{listItem:o,blockTaskItem:s,taskItem:r,paragraph:l}=e.schema.nodes;if(eg(a)){if(t){if((0,i("dh538").fg)("platform_editor_blocktaskitem_patch_3")){let i=e.doc.resolve(a.pos-1).nodeBefore;if(s&&i?.type===s&&a.parent.type===r){let e=a.parent.nodeSize;return n.delete(a.pos-Math.floor(e/2),a.pos+Math.ceil(e/2)),n.insert(a.pos,l.createChecked()),t(n),!0}}if((0,p.hasParentNodeOfType)(o)(n.selection))return t(eI(n,eN(e),a,!0)),!0;t(eI(n,l.createChecked(),a,!0))}return!0}return!1},ex=(e,t)=>(0,i("e7tBw").filterCommand)(x,(0,i("astHL").chainCommands)((0,i("e7tBw").filterCommand)(K,(0,i("astHL").chainCommands)(eT(e)(),ek)),(n,a)=>{let{selection:o,schema:s}=n,{decisionItem:r,taskItem:l,blockTaskItem:d}=s.nodes,{$from:c,$to:u}=o,h=c.node(c.depth),m=h&&h.type;if(![r,l,d].includes(m)){let e=(0,p.findParentNodeOfType)([r,l,d])(o)?.node?.type;e&&(m=e)}let f=[l,d].includes(m)?"taskList":"decisionList",g=ee(e,t)(n,f,i("d925B").INPUT_METHOD.KEYBOARD,({tr:e,itemLocalId:t})=>{if(c.pos===u.pos&&0===c.parentOffset&&(!(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_2")||!c.parent.isTextblock||q(n))){let n=m.createAndFill({localId:t});if(n){if(m===d){let n=(0,p.findParentNodeOfType)([d])(o),a=l.createAndFill({localId:t});return n&&a?e.insert(n.pos,a):e}return e.insert(c.pos-1,n)}}if(m===d){let a=(0,p.findParentNodeOfType)([d])(o);if(!a)return e;if((!(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_2")||!c.parent.isTextblock||W(n))&&c.parentOffset===c.parent.nodeSize-2){let n=l.createAndFill({localId:t});if(n)return e.insert(a.pos+a.node.nodeSize,n),e.setSelection(i("ks2lK").TextSelection.create(e.doc,a.pos+a.node.nodeSize+1)),e}return e.split(c.pos,(0,i("dh538").fg)("platform_editor_blocktaskitem_patch_2")?c?.parent?.isTextblock?2:1:c.depth-1,[{type:d,attrs:{localId:t}}])}return e.split(c.pos,1,[{type:m,attrs:{localId:t}}])});return g&&a&&(g.scrollIntoView(),a(g)),!0})),eA=(0,i("e7tBw").filterCommand)(x,(e,t)=>{let{selection:n,schema:a}=e,{taskItem:o}=a.nodes,{$from:s}=n,r=s.node(s.depth),l=r&&r.type,d=s.before(s.depth);if(l===o){let n=e.tr;n.step(new(0,i("9YoeD").SetAttrsStep)(d,{state:"TODO"===r.attrs.state?"DONE":"TODO",localId:r.attrs.localId})),n&&t&&t(n)}return!0});var eO=function(e,t,n,a){let o={"Shift-Tab":(0,i("e7tBw").filterCommand)([x,e=>!eE(e)],(e,n)=>eT(t?.analytics?.actions)(i("d925B").INPUT_METHOD.KEYBOARD)(e,n)||!!a),Tab:(0,i("e7tBw").filterCommand)([x,e=>!eE(e)],(e,n)=>ey(t?.analytics?.actions)(i("d925B").INPUT_METHOD.KEYBOARD)(e,n)||!!a)},s=a?{"Shift-Tab":x,Tab:x}:{},r={Backspace:eS(t?.analytics?.actions),Delete:eb,"Ctrl-d":eb,Enter:ex(t?.analytics?.actions,()=>t?.contextIdentifier?.sharedState.currentState()?.contextIdentifierProvider),[i("hgeg8").toggleTaskItemCheckbox.common]:eA,[i("hgeg8").toggleTaskList.common]:(e,t)=>{if(!(0,u.expValEquals)("platform_editor_toolbar_aifc_patch_6","isEnabled",!0)||!e.schema.nodes.taskItem)return!1;if(t){let n=eh()({tr:e.tr});if(n)return t(n),!0}return!1},...n?o:s};return(0,i("dus6D").keymap)(r)};let eP=["span",{contentEditable:!1,"data-component":"icon"},["span",{role:"img","aria-label":"Decision"},["http://www.w3.org/2000/svg svg",{viewBox:"0 0 24 24",role:"presentation",width:"24",height:"24","data-icon-source":"legacy"},["http://www.w3.org/2000/svg path",{fill:"currentcolor","fill-rule":"evenodd",d:"m9.414 8 3.293 3.293c.187.187.293.442.293.707v5a1 1 0 0 1-2 0v-4.586l-3-3V10.5a1 1 0 0 1-2 0V7a1 1 0 0 1 1-1h3.5a1 1 0 0 1 0 2zm8.293-1.707a1 1 0 0 1 0 1.414l-2.5 2.5a.997.997 0 0 1-1.414 0 1 1 0 0 1 0-1.414l2.5-2.5a1 1 0 0 1 1.414 0"}]],["http://www.w3.org/2000/svg svg",{viewBox:"-4 -4 24 24",fill:"none",role:"presentation",width:"24",height:"24","data-icon-source":"refreshed"},["http://www.w3.org/2000/svg path",{fill:"currentcolor","fill-rule":"evenodd",d:"m13.97.97-4.5 4.5 1.06 1.06 4.5-4.5zM3.56 2.5H8V1H1.75a.75.75 0 0 0-.75.75V8h1.5V3.56l4.604 4.604a.5.5 0 0 1 .146.354V15h1.5V8.518a2 2 0 0 0-.586-1.414z"}]]]],eM=(e,t)=>{let n=e.childCount>0?{}:{"data-empty":"true"};return["li",{"data-decision-local-id":e.attrs.localId||"local-decision","data-decision-state":e.attrs.state,"data-prosemirror-node-name":"decisionItem",class:"decisionItemView-content-wrap"},["div",{"data-testid":"elements-decision-item","data-decision-wrapper":!0},eP,["span",{"data-testid":"task-decision-item-placeholder","data-component":"placeholder",contentEditable:!1},t.formatMessage(i("2iuib").tasksAndDecisionsMessages.decisionPlaceholder)],["div",{"data-component":"content"},["div",{class:"decision-item",...n},0]]]]};class ew{updateHasChildren(e){let t=e.childCount>0;return t!==this.hasChildren&&(this.hasChildren=t,this.contentDOM?.toggleAttribute("data-empty",!t)),this.hasChildren}update(e){return this.updateHasChildren(e),!0}ignoreMutation(e){return!!(0,u.expValEquals)("platform_editor_debounce_portal_provider","isEnabled",!0,!1)&&(!this.contentDOM||!this.contentDOM.contains(e.target)&&"selection"!==e.type)}constructor(e,t){this.dom=void 0,this.contentDOM=void 0,this.hasChildren=void 0;let n=eM(e,t),{dom:a,contentDOM:o}=i("5SAOw").DOMSerializer.renderSpec(document,n);this.dom=a,this.contentDOM=o}}class eD{getContextIdentifierProvider(){return this.api?.contextIdentifier?.sharedState.currentState()?.contextIdentifierProvider}getObjectAri(){let e=this.getContextIdentifierProvider();if(e)return e.objectId}isContentEmpty(e){return 0===e.content.childCount}updatePlaceholder(e){let t=this.isContentEmpty(e);(0,u.expValEquals)("platform_editor_blocktaskitem_node_tenantid","isEnabled",!0)&&(t=f(e)),t!==this.emptyContent&&(this.emptyContent=t,this.contentDOM?.toggleAttribute("data-empty",t))}update(e){if(!(0,u.expValEquals)("platform_editor_prevent_taskitem_remount","isEnabled",!0)&&(e.type!==this.node.type||e.attrs.state!==this.node.attrs.state)||this.node.attrs.localId!==e.attrs.localId)return!1;if((0,u.expValEquals)("platform_editor_prevent_taskitem_remount","isEnabled",!0)){if(e.type!==this.node.type)return!1;e.type===this.node.type&&e.attrs.state!==this.node.attrs.state&&this.input&&(this.input.checked="DONE"===e.attrs.state)}return this.updatePlaceholder(e),this.domElement&&!e.sameMarkup(this.node)&&(this.domElement.setAttribute("data-task-state",e.attrs.state),this.domElement.setAttribute("data-task-local-id",e.attrs.localId),this.domElement.setAttribute("state",e.attrs.state)),this.node=e,!0}ignoreMutation(e){return!this.contentDOM||!this.contentDOM.contains(e.target)&&"selection"!==e.type}destroy(){this.unbindInputDom&&this.unbindInputDom(),this.contentDOM=void 0,this.input=void 0,this.emptyContent=void 0,this.api=void 0}constructor(e,t,n,{api:a,placeholder:o,intl:s}){this.dom=void 0,this.domElement=void 0,this.contentDOM=void 0,this.node=void 0,this.view=void 0,this.getPos=void 0,this.api=void 0,this.intl=void 0,this.unbindInputDom=void 0,this.emptyContent=void 0,this.input=void 0,this.handleOnClick=e=>{if(!this.api?.taskDecision?.sharedState.currentState()?.hasEditPermission){e.stopImmediatePropagation(),e.preventDefault();let t=this.getPos();"number"==typeof t&&function(e,t){let{state:n,dispatch:a}=e,{tr:i}=n;a(i.setMeta(S,{action:b.OPEN_REQUEST_TO_EDIT_POPUP,data:t}))}(this.view,t);return}},this.handleOnChange=()=>{let{tr:e}=this.view.state,t=this.getPos();if("number"!=typeof t)return;let{localId:n,state:a}=this.node.attrs,o="DONE"===a?"TODO":"DONE",s=this.api?.taskDecision.sharedState.currentState(),r=this.getObjectAri();s?.taskDecisionProvider&&r&&s.taskDecisionProvider.toggleTask({localId:n,objectAri:r},o),e.step(new(0,i("9YoeD").SetAttrsStep)(t,{state:o,localId:n})),e.setMeta("scrollIntoView",!1);let l={checkState:o,from:t,to:t+this.node.nodeSize};e.setMeta("taskItemInfo",l),this.view.dispatch(e)},this.node=e,this.view=t,this.getPos=n,this.intl=s,this.api=a,this.view=t;let r=o??this.intl.formatMessage(i("2iuib").tasksAndDecisionsMessages.taskPlaceholder),{dom:l,contentDOM:d}=i("5SAOw").DOMSerializer.renderSpec(document,function(e,t,n){let a="DONE"===e.attrs.state,o=E(e.attrs.localId),s={name:o,id:o,type:"checkbox","aria-label":n.formatMessage(a?i("2iuib").tasksAndDecisionsMessages.markTaskAsNotCompleted:i("2iuib").tasksAndDecisionsMessages.markTaskAsCompleted)};a&&(s.checked="true");let r={"data-task-local-id":e.attrs.localId,"data-task-state":e.attrs.state,"data-prosemirror-node-name":"taskItem",..."blockTaskItem"===e.type.name?{"data-task-is-block":"true"}:{}},l=e.content.childCount>0?{}:{"data-empty":"true"};return(0,u.expValEquals)("platform_editor_blocktaskitem_node_tenantid","isEnabled",!0)&&(l=f(e)?{"data-empty":"true"}:{}),["div",{class:`${i("7iisy").TaskDecisionSharedCssClassName.TASK_CONTAINER}`,...r,state:e.attrs.state},["div",{"data-component":"task-item-main"},["span",{contenteditable:"false",class:`${i("7iisy").TaskDecisionSharedCssClassName.TASK_CHECKBOX_CONTAINER}`,"data-component":"task-item-input-wrap"},["input",{...s,"data-input-type":"task-item","data-task-input":!0,"data-testid":"task-item-checkbox","data-component":"task-item-input",role:"checkbox"}],["span",{"aria-hidden":!0,"data-component":"checkbox-icon-wrap"},["http://www.w3.org/2000/svg svg",{viewBox:"0 0 16 16",width:"16",height:"16",role:"presentation",fill:"none","data-component":"checkbox-unchecked-icon"},["http://www.w3.org/2000/svg rect",{width:"12.5",height:"12.5",x:"1.75",y:"1.75",stroke:"currentcolor","stroke-width":"1.5",rx:"1.25"}]],["http://www.w3.org/2000/svg svg",{viewBox:"0 0 16 16",width:"16",height:"16",role:"presentation",fill:"none","data-component":"checkbox-checked-icon"},["http://www.w3.org/2000/svg path",{fill:"currentcolor","fill-rule":"evenodd","clip-rule":"evenodd",d:"M3 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2zm9.326 4.48-1.152-.96L6.75 9.828 4.826 7.52l-1.152.96 2.5 3a.75.75 0 0 0 1.152 0z"}]]]],["span",{class:"placeholder-node-view","data-testid":"task-decision-item-placeholder","data-component":"placeholder",contenteditable:"false"},t],["div",{"data-component":"content"},["div",{class:i("7iisy").TaskDecisionSharedCssClassName.TASK_ITEM,...l},0]]]]}(e,r,s));this.dom=l,this.contentDOM=d,this.domElement=this.dom instanceof HTMLElement?this.dom:void 0,this.domElement&&(this.input=this.domElement.querySelector('input[type="checkbox"]'),this.unbindInputDom=(0,i("fFa3V").bindAll)(this.input,[{type:"click",listener:this.handleOnClick},{type:"change",listener:this.handleOnChange}]))}}let eR=(e,t,n)=>(a,i,o)=>new eD(a,i,o,{placeholder:n,api:e,intl:t}),eB=(e,t)=>({...e,focusedTaskItemLocalId:t.data}),eL=(e,t)=>({...e,taskDecisionProvider:t.data}),eU=(e,t)=>({...e,openRequestToEditPopupAt:t.data});function eK(e,t){let{target:n}=t;if(!n||!(n instanceof HTMLInputElement)||"checkbox"!==n.type||"lazy-task-item"!==n.getAttribute("data-input-type"))return;let a=e.posAtDOM(n,0),i=e.state.doc.resolve(a),o=i?.parent;if(o?.type?.name!=="taskItem")return;let s=i.before(i.depth),r=e.state.tr.setNodeMarkup(s,null,{...o.attrs,state:n.checked?"DONE":"TODO"});e.dispatch(r)}let eF=(e,t)=>{let{schema:n}=t.state,{taskItem:a,blockTaskItem:o,paragraph:s}=n.nodes,{$from:r}=t.state.selection;if(r.node().type===a&&o){let t=[];if(e.content.forEach(e=>{if(e.type===o){let n=!0;e.content.forEach(e=>{e.type!==s&&(n=!1)}),n&&e.childCount>0?e.content.forEach(n=>{let o=a.create({localId:i("fO7hX").uuid.generate(),state:e.attrs.state||"TODO"},n.content);t.push(o)}):t.push(e)}else t.push(e)}),t.length!==e.content.childCount||t.some((t,n)=>t!==e.content.child(n))){let n=i("5SAOw").Fragment.from(t);return new(0,i("5SAOw").Slice)(n,e.openStart,e.openEnd)}}return e};i("42omo");let ej="decisionList",eG=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)();return t?.blockMenu?.actions.isTransformOptionDisabled(ej)?null:(0,d.jsx)(i("2GVu1").ToolbarDropdownItem,{onClick:e=>{let n=e.nativeEvent instanceof KeyboardEvent||0===e.nativeEvent.detail?i("d925B").INPUT_METHOD.KEYBOARD:i("d925B").INPUT_METHOD.MOUSE,a=i("d925B").INPUT_METHOD.BLOCK_MENU;t?.core.actions.execute(({tr:e})=>{let i=t?.blockMenu?.commands.transformNode(e.doc.type.schema.nodes.decisionList,{inputMethod:a,triggeredFrom:n,targetTypeName:ej});return i?i({tr:e}):null})},elemBefore:(0,d.jsx)(e(i("ejBUP")),{label:""}),children:n(i("eKkkY").messages.decisionList)})};var eV=i("42omo");let ez=(0,i("efG2U").default)(i("jwWgu").default),eH={pressable:"_ca0qze3t _n3tdze3t _19bvze3t _u5f3ze3t _1wybdlk8 _syaz1oa5 _bfhksm61 _9oik1r31 _1bnx8stv _jf4cnqa1 _9h8h12zz"},eq=e=>({action:e,actionSubject:i("d925B").ACTION_SUBJECT.REQUEST_TO_EDIT_POP_UP,eventType:i("d925B").EVENT_TYPE.UI,attributes:{platform:i("e2wMq").PLATFORMS.WEB,mode:i("e2wMq").MODE.EDITOR}}),eW=()=>{let{formatMessage:t}=(0,i("8C5kA").default)();return(0,d.jsxs)(d.Fragment,{children:[t(i("2iuib").tasksAndDecisionsMessages.requestToEdit),(0,d.jsx)(e(i("cvXh8")),{label:"requested-to-edit",color:"var(--ds-icon-disabled, #080F214A)"})]})},eX=({onClick:e})=>{let{formatMessage:t}=(0,i("8C5kA").default)();return(0,d.jsx)(i("gdv5Z").default,{children:(0,d.jsx)(i("fVUfS").default,{onClick:e,xcss:eH.pressable,testId:"request-to-edit-popup-request-btn",children:t(i("2iuib").tasksAndDecisionsMessages.requestToEdit)})})},eY=({element:e,api:t,editorView:n,onClose:a,mountTo:o,boundariesElement:s,scrollableElement:r})=>{let l=(0,i("b3YrF").useSharedPluginStateSelector)(t,"taskDecision.hasRequestedEditPermission"),c=(0,i("b3YrF").useSharedPluginStateSelector)(t,"taskDecision.openRequestToEditPopupAt"),[p,u]=(0,eV.useState)(!!c),[h,m]=(0,eV.useState)(l),[f,g]=(0,eV.useState)(!1),{formatMessage:T}=(0,i("8C5kA").default)();(0,eV.useEffect)(()=>{m(l)},[l]),(0,eV.useEffect)(()=>{if(!f){let e=setTimeout(()=>{g(!1)},3e3);return()=>clearTimeout(e)}},[f]);let E=e=>{if(e.stopPropagation(),"view"!==t?.editorViewMode?.sharedState.currentState()?.mode)return;let a=t?.analytics?.actions;g(!0);let{tr:o}=n.state;if(o.setMeta("scrollIntoView",!1),!t?.taskDecision?.sharedState.currentState()?.hasEditPermission){let e=t?.taskDecision?.sharedState.currentState()?.requestToEditContent;e&&e()}a?.attachAnalyticsEvent(eq(i("d925B").ACTION.REQUEST_TO_EDIT))(o),n.dispatch(o)},y=e=>{e?.fireAnalyticsEvent(eq(i("d925B").ACTION.DISMISSED)),u(!1),a()},_=t=>{let n=t.target;n&&(e.contains(n)||e===n)||(u(!1),a())};return p?(0,d.jsx)(ez,{target:e,fitHeight:148,handleClickOutside:_,handleEscapeKeydown:_,zIndex:i("aFUXX").akEditorFloatingDialogZIndex,mountTo:o,boundariesElement:s,scrollableElement:r,ariaLabel:null,preventOverflow:!0,focusTrap:!0,captureClick:!0,children:(0,d.jsx)(i("efG2U").OutsideClickTargetRefContext.Consumer,{children:e=>(0,d.jsx)("div",{ref:e,className:(0,i("gMc0m").default)(["_2rkofajl _ca0qv77o _n3tdv77o _19bvv77o _u5f3v77o _16qs130s _bfhk1bhr"]),children:(0,d.jsx)("div",{className:(0,i("gMc0m").default)(["_1e0c1txw _2lx21bp4 _p12f1qwj _ca0qpxbi _u5f31ejb _n3tdpxbi _19bv1ejb"]),children:(0,d.jsxs)(i("eyWa4").default,{space:"space.150",children:[(0,d.jsx)(i("7hXDW").default,{size:"xsmall",children:T(i("2iuib").tasksAndDecisionsMessages.editAccessTitle)}),(0,d.jsx)("div",{children:T(i("2iuib").tasksAndDecisionsMessages.requestToEditDescription)}),(0,d.jsxs)("div",{className:(0,i("gMc0m").default)(["_zulp1b66 _1e0c1txw _4cvr1h6o _syaz1gmx"]),children:[f||h?(0,d.jsx)(eW,{}):(0,d.jsx)(eX,{onClick:E}),(0,d.jsx)("div",{className:(0,i("gMc0m").default)(["_19pku2gc _otyru2gc _18u0u2gc _2hwxu2gc _1e0c1o8l _1bsbyh40 _4t3iyh40 _bfhk16e3","_2rko1rr0"])}),(0,d.jsx)(i("gdv5Z").default,{children:(0,d.jsx)(i("fVUfS").default,{onClick:()=>y(t?.analytics?.actions),xcss:eH.pressable,testId:"request-to-edit-popup-cancel-btn",children:T(i("2iuib").tasksAndDecisionsMessages.dismiss)})})]})]})})})})}):null};i("42omo");let e$="taskList",eJ=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)();return t?.blockMenu?.actions.isTransformOptionDisabled(e$)?null:(0,d.jsx)(i("2GVu1").ToolbarDropdownItem,{onClick:e=>{let n=e.nativeEvent instanceof KeyboardEvent||0===e.nativeEvent.detail?i("d925B").INPUT_METHOD.KEYBOARD:i("d925B").INPUT_METHOD.MOUSE,a=i("d925B").INPUT_METHOD.BLOCK_MENU;t?.core.actions.execute(({tr:e})=>{let i=t?.blockMenu?.commands.transformNode(e.doc.type.schema.nodes.taskList,{inputMethod:a,triggeredFrom:n,targetTypeName:e$});return i?i({tr:e}):null})},elemBefore:(0,d.jsx)(e(i("dmbve")),{label:""}),children:n(i("2iuib").tasksAndDecisionsMessages.taskList)})};i("42omo"),i("42omo");let eZ=({api:t})=>{let{formatMessage:n}=(0,i("8C5kA").default)(),{isInsideTask:a}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(t,["taskDecision"],e=>({isInsideTask:e.taskDecisionState?.isInsideTask}));return(0,d.jsx)(i("2GVu1").ToolbarDropdownItem,{elemBefore:(0,d.jsx)(e(i("dmbve")),{size:"small",label:""}),elemAfter:(0,d.jsx)(i("jbmmV").ToolbarKeyboardShortcutHint,{shortcut:(0,i("hgeg8").formatShortcut)(i("hgeg8").toggleTaskList)}),isSelected:a,isDisabled:!1,onClick:()=>{t?.core.actions.execute(t?.taskDecision?.commands.toggleTaskList())},ariaKeyshortcuts:(0,i("hgeg8").formatShortcut)(i("hgeg8").toggleTaskList),children:n(i("2iuib").tasksAndDecisionsMessages.taskList)})},eQ=({api:e})=>(0,u.expValEquals)("platform_editor_toolbar_aifc_patch_6","isEnabled",!0)?[{type:i("cPCP8").TASK_LIST_MENU_ITEM.type,key:i("cPCP8").TASK_LIST_MENU_ITEM.key,parents:[{type:i("cPCP8").LISTS_INDENTATION_MENU_SECTION.type,key:i("cPCP8").LISTS_INDENTATION_MENU_SECTION.key,rank:i("4Chin").LISTS_INDENTATION_MENU_SECTION_RANK[i("cPCP8").TASK_LIST_MENU_ITEM.key]}],component:({parents:t})=>(0,d.jsx)(eZ,{api:e,parents:t})}]:[];i("42omo");var e0=(0,i("gmMgo").default)(({isDisabled:t,isReducedSpacing:n,intl:{formatMessage:a},editorView:o,editorAPI:s})=>{let r=a(i("4HWgE").toolbarInsertBlockMessages.decision);return(0,d.jsx)(i("a4eZN").default,{buttonId:i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.DECISION_LIST,onClick:()=>!!o&&(Q(s?.analytics?.actions,()=>s?.contextIdentifier?.sharedState.currentState()?.contextIdentifierProvider)("decisionList")(o.state,o.dispatch),!0),disabled:t,spacing:n?"none":"default",title:`${r} <>`,"aria-keyshortcuts":"Shift+, Shift+. space",iconBefore:(0,d.jsx)(e(i("ejBUP")),{label:r})})});i("42omo");var e1=(0,i("gmMgo").default)(({isDisabled:t,isReducedSpacing:n,intl:{formatMessage:a},editorAPI:o,editorView:s})=>{let r=a(i("4HWgE").toolbarInsertBlockMessages.action);return(0,d.jsx)(i("a4eZN").default,{buttonId:i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.TASK_LIST,onClick:()=>!!s&&(Q(o?.analytics?.actions,()=>o?.contextIdentifier?.sharedState.currentState()?.contextIdentifierProvider)("taskList")(s.state,s.dispatch),!0),disabled:t,spacing:n?"none":"default",title:`${r} []`,iconBefore:(0,d.jsx)(e(i("7FcUt")),{label:r})})});let e5=(e,t,n)=>({listLocalId:a,itemLocalId:i})=>{let{list:o,item:s}=J(t,n);return e(o.createChecked({localId:a},s.createChecked({localId:i})))};function e2({editorView:e,popupsMountPoint:t,popupsBoundariesElement:n,popupsScrollableElement:a,dependencyApi:o}){let s=(0,i("b3YrF").useSharedPluginStateSelector)(o,"taskDecision.openRequestToEditPopupAt"),r=(0,i("b3YrF").useSharedPluginStateSelector)(o,"taskDecision.hasEditPermission");if((0,u.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!e||r||!s)return null;let l=e.domAtPos.bind(e),c=(0,p.findDomRefAtPos)(s,l);return(0,d.jsx)(eY,{api:o,editorView:e,mountTo:t,boundariesElement:n,scrollableElement:a,element:c,onClose:()=>{let{state:t,dispatch:n}=e,{tr:a}=t;n(a.setMeta(S,{action:b.OPEN_REQUEST_TO_EDIT_POPUP,data:null})),e.focus()}},s)}t.exports.tasksAndDecisionsPlugin=({config:{allowNestedTasks:e,consumeTabs:t,useLongPressSelection:n,hasEditPermission:a=!0,hasRequestedEditPermission:o,quickInsertActionDescription:s,requestToEditContent:r,taskDecisionProvider:l,taskPlaceholder:p,allowBlockTaskItem:m}={},api:f})=>{let E,y=()=>f?.contextIdentifier?.sharedState.currentState()?.contextIdentifierProvider;return f?.toolbar&&(0,u.expValEquals)("platform_editor_toolbar_aifc_patch_6","isEnabled",!0)&&f?.toolbar?.actions.registerComponents(eQ({api:f})),l&&l.then(e=>{f?.core.actions.execute(({tr:t})=>ei(e)(t))}),(0,h.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)&&f?.blockMenu?.actions.registerBlockMenuComponents([{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_TASK_LIST_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_TASK_LIST_MENU_ITEM.key]},component:()=>(0,d.jsx)(eJ,{api:f})},{type:"block-menu-item",key:i("btNLq").TRANSFORM_STRUCTURE_DECISION_MENU_ITEM.key,parent:{type:"block-menu-section",key:i("btNLq").TRANSFORM_STRUCTURE_MENU_SECTION.key,rank:i("gEb6G").TRANSFORM_STRUCTURE_MENU_SECTION_RANK[i("btNLq").TRANSFORM_STRUCTURE_DECISION_MENU_ITEM.key]},component:()=>(0,d.jsx)(eG,{api:f})}]),{name:"taskDecision",nodes:()=>[{name:"decisionList",node:i("gClzS").decisionList},{name:"decisionItem",node:_()},{name:"taskList",node:i("cXZ4C").taskList},{name:"taskItem",node:g()},...(0,u.expValEquals)("platform_editor_blocktaskitem_node_tenantid","isEnabled",!0)&&m?[{name:"blockTaskItem",node:T()}]:[]],getSharedState(e){if(!e)return;let t=S.getState(e),n=R(e.selection)||0,a=B(e);return{focusedTaskItemLocalId:t?.focusedTaskItemLocalId||null,isInsideTask:P(e),indentDisabled:0===a||n>=i("5abq6").MAX_INDENTATION_LEVEL,outdentDisabled:n<=1,hasEditPermission:t?.hasEditPermission===void 0||t?.hasEditPermission,requestToEditContent:t?.requestToEditContent,hasRequestedEditPermission:t?.hasRequestedEditPermission,taskDecisionProvider:t?.taskDecisionProvider,openRequestToEditPopupAt:t?.openRequestToEditPopupAt}},commands:{toggleTaskList:eh,updateEditPermission:e=>({tr:t})=>t.setMeta(S,{hasEditPermission:e}),updateHasRequestedEditPermission:e=>({tr:t})=>t.setMeta(S,{hasRequestedEditPermission:e})},actions:{insertTaskDecision:Q(f?.analytics?.actions,y),indentTaskList:ey(f?.analytics?.actions),outdentTaskList:eT(f?.analytics?.actions),setProvider:async e=>{let t=await e;return E!==t&&l!==e&&(E=t,f?.core.actions.execute(({tr:e})=>ei(t)(e))??!1)}},pmPlugins:()=>[{name:"tasksAndDecisions",plugin:({portalProviderAPI:e,eventDispatcher:t,dispatch:s,getIntl:l})=>(function(e,t,n,a,o,s=!1,r,l,d,c){return new(0,i("1S4f7").SafePlugin)({props:{nodeViews:{taskItem:eR(a,o(),c),decisionItem:e=>new ew(e,o()),...(0,u.expValEquals)("platform_editor_blocktaskitem_node_tenantid","isEnabled",!0)?{blockTaskItem:eR(a,o(),c)}:{}},decorations(e){let t=S.getState(e);return t?.decorations?t.decorations:i("ftzrq").DecorationSet.empty},handleTextInput(e,t,n,a){let{state:o,dispatch:s}=e,{tr:r}=o;return o.selection instanceof i("ks2lK").NodeSelection&&o.selection.node.type===e.state.schema.nodes.decisionItem&&(o.selection.replace(r),r.insertText(a),s&&s(r),!0)},handleClickOn:(0,i("3tffm").createSelectionClickHandler)(["decisionItem","taskItem"],e=>e.hasAttribute("data-decision-wrapper")||"Decision"===e.getAttribute("aria-label"),{useLongPressSelection:s}),handleDOMEvents:{change:eK},handleKeyDown:(e,t)=>{let{state:n}=e,{selection:a,schema:o}=n,{$from:s,$to:r}=a,l=s.parentOffset,d=(0,u.expValEquals)("platform_editor_blocktaskitem_patch_1","isEnabled",!0)?P(n):s.node().type===o.nodes.taskItem,c=S.getState(n).focusedTaskItemLocalId,p=j(e),h=c===p?.localId;if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key)||["ArrowUp","ArrowDown","ArrowLeft"].includes(t.key)&&(!d||s.pos!==r.pos))return!1;if(t.shiftKey||t.ctrlKey||t.metaKey)return h&&z(e),!1;if(c){if("ArrowLeft"===t.key)return z(e),!1;if("ArrowRight"===t.key)return z(e),!0;if("ArrowUp"===t.key||"ArrowDown"===t.key){let n=G(e,"ArrowUp"===t.key?"previous":"next");return n?(V(e,n),!0):(z(e),!1)}}if("ArrowLeft"===t.key&&0===l){let{state:t,dispatch:n}=e,{tr:a}=t;return p&&(a.setMeta(S,{action:b.FOCUS_BY_LOCALID,data:p.localId}),n(a)),!0}if("ArrowRight"===t.key)if(a instanceof i("adhil").GapCursorSelection&&"left"===a.side&&s.nodeAfter?.type===o.nodes.taskList){let t=s.nodeAfter.child(0);return V(e,{pos:s.pos+1,localId:t.attrs.localId}),!0}else{if(!d||s.node().content.size!==l)return!1;let t=G(e,"next");if(t)return V(e,t),!0}},transformPasted:(e,t)=>(t?.state?.schema?.nodes?.blockTaskItem&&(e=eF(e,t)),e)},state:{init:()=>({insideTaskDecisionItem:!1,hasEditPermission:r,hasRequestedEditPermission:l,requestToEditContent:d,focusedTaskItemLocalId:null,taskDecisionProvider:void 0,decorations:i("ftzrq").DecorationSet.empty}),apply(e,t){let a=e.getMeta(S),{action:o,data:s}=a??{action:null,data:null},r=t;switch(o){case b.FOCUS_BY_LOCALID:r=eB(r,{action:b.FOCUS_BY_LOCALID,data:s});break;case b.SET_PROVIDER:r=eL(r,{action:b.SET_PROVIDER,data:s});break;case b.OPEN_REQUEST_TO_EDIT_POPUP:r=eU(r,{action:b.OPEN_REQUEST_TO_EDIT_POPUP,data:s})}a&&"hasEditPermission"in a&&(r={...r,hasEditPermission:a.hasEditPermission}),a&&"hasRequestedEditPermission"in a&&(r={...r,hasRequestedEditPermission:a.hasRequestedEditPermission});let l=e.getMeta("taskItemInfo"),d=i("ftzrq").DecorationSet.empty;d=l?i("ftzrq").DecorationSet.create(e.doc,[i("ftzrq").Decoration.inline(l.from,l.to,{},{dataTaskNodeCheckState:l.checkState})]):r.decorations?.map(e.mapping,e.doc);let c={...r,decorations:d};return n(S,c),c}},key:S,appendTransaction:(e,t,n)=>{let a=n.tr,o=!1;if(e.forEach(e=>{e.docChanged&&function(e,t,n){let a=(0,i("2pjJ5").getStepRange)(e);a&&e.doc.nodesBetween(a.from,a.to,t,void 0)}(e,(e,t)=>{let{decisionList:s,decisionItem:r,taskList:l,taskItem:d,blockTaskItem:c}=n.schema.nodes;if(e.type&&(e.type===s||e.type===r||e.type===l||e.type===d||c&&e.type===c)){let{localId:n,...s}=e.attrs;(null==n||""===n)&&(a.step(new(0,i("9YoeD").SetAttrsStep)(t,{localId:i("fO7hX").uuid.generate(),...s})),o=!0)}})}),o)return a.setMeta("addToHistory",!1)},view:()=>({update:(e,t)=>{let n=S.getState(e.state),a=S.getState(t);if(n.focusedTaskItemLocalId===a.focusedTaskItemLocalId)return;let i=j(e);if(i&&n.focusedTaskItemLocalId===i.localId){let t=e.nodeDOM(i.pos);t instanceof HTMLElement&&t?.querySelector("input")?.focus()}}})})})(0,0,s,f,l,n,a,o,r,p)},{name:"tasksAndDecisionsInputRule",plugin:({schema:e,featureFlags:t})=>ed(f?.analytics?.actions,y)(e,t)},{name:"tasksAndDecisionsKeyMap",plugin:({schema:n})=>eO(n,f,e,t)}],secondaryToolbarComponent:({editorView:e,disabled:t})=>(0,d.jsxs)("div",{className:(0,i("gMc0m").default)(["_1e0c1txw"]),children:[(0,d.jsx)(e0,{editorView:e,isDisabled:t,isReducedSpacing:!0,editorAPI:f}),(0,d.jsx)(e1,{editorView:e,isDisabled:t,isReducedSpacing:!0,editorAPI:f})]}),contentComponent:({editorView:e,dispatchAnalyticsEvent:t,popupsMountPoint:n,popupsBoundariesElement:a,popupsScrollableElement:i})=>e?(0,d.jsx)(e2,{dependencyApi:f,editorView:e,dispatchAnalyticsEvent:t,popupsMountPoint:n,popupsBoundariesElement:a,popupsScrollableElement:i}):null,pluginsOptions:{quickInsert:({formatMessage:e})=>[{id:"action",title:e(i("4HWgE").toolbarInsertBlockMessages.action),description:s??e(i("4HWgE").toolbarInsertBlockMessages.actionDescription),priority:100,keywords:["checkbox","task","todo"],keyshortcut:"[]",icon:()=>(0,d.jsx)(c.IconAction,{}),action:(e,t)=>Z(f?.analytics?.actions,y)(t,"taskList",i("d925B").INPUT_METHOD.QUICK_INSERT,e5(e,"taskList",t.schema))},{id:"decision",title:e(i("4HWgE").toolbarInsertBlockMessages.decision),description:e(i("4HWgE").toolbarInsertBlockMessages.decisionDescription),priority:900,keyshortcut:"<>",icon:()=>(0,d.jsx)(c.IconDecision,{}),action:(e,t)=>Z(f?.analytics?.actions,y)(t,"decisionList",i("d925B").INPUT_METHOD.QUICK_INSERT,e5(e,"decisionList",t.schema))}]}}}}),o("4FFjp",function(e,t){var n=i("8m4tT");let a=e=>t=>{try{return e.validContent(i("5SAOw").Fragment.from(t))}catch{return!1}},o=(e,t)=>{let n=[],{listNode:s,isSourceBulletOrOrdered:r,isTargetBulletOrOrdered:l,isSourceTask:d,isTargetTask:c,supportedListTypes:p,schema:u,targetNodeType:h}=e,{taskList:m,listItem:f,taskItem:g,paragraph:T}=u.nodes;return s.forEach(s=>{if(r&&c){if(s.type===f){let r=[],l=[];s.forEach(n=>{p.has(n.type)&&n.type!==m?l.push(o({...e,listNode:n},t)):a(g)(n)||n.isTextblock?r.push(...(0,i("iD5M5").convertBlockToInlineContent)(n,u)):t?.(n)}),n.push(g.create(null,r.length>0?r:null)),n.push(...l)}}else if(d&&l){if(s.type===g){let e=[...s.content.content],t=T.create(null,e.length>0?e:null);n.push(f.create(null,[t]))}else if(s.type===m){let a=o({...e,listNode:s},t),i=n[n.length-1];if(i?.type===f){let e=[...i.content.content,a];n[n.length-1]=f.create(i.attrs,e)}else n.push(...a.content.content)}}else if(r&&l&&s.type===f){let a=[];s.forEach(n=>{if(p.has(n.type)&&n.type!==h){let i=o({...e,listNode:n},t);a.push(i)}else a.push(n)}),n.push(f.create(null,a))}}),h.create(null,n)},s=e=>{let{tr:t,sourceNode:n,sourcePos:a,targetNodeType:s}=e,r=t.doc.type.schema.nodes,l=[];try{let{node:e,pos:d}={node:n,pos:a},c=(0,i("iD5M5").isBulletOrOrderedList)(e.type),p=(0,i("iD5M5").isTaskList)(s),u=(0,i("iD5M5").isTaskList)(e.type),h=(0,i("iD5M5").isBulletOrOrderedList)(s),m=(0,i("iD5M5").getSupportedListTypesSet)(r),f=o({isSourceBulletOrOrdered:c,isSourceTask:u,isTargetBulletOrOrdered:h,isTargetTask:p,listNode:e,schema:t.doc.type.schema,supportedListTypes:m,targetNodeType:s},e=>{l.push(e)});return t.replaceWith(d,d+e.nodeSize,[f,...l]),t}catch{return t}};e.exports.transformListRecursively=o,e.exports.transformBetweenListTypes=e=>{let{tr:t,sourceNode:n,sourcePos:a,targetNodeType:o}=e,{nodes:r}=t.doc.type.schema,l=n.type,d=(0,i("iD5M5").isBulletOrOrderedList)(l),c=(0,i("iD5M5").isTaskList)(o),p=(0,i("iD5M5").isTaskList)(l),u=(0,i("iD5M5").isBulletOrOrderedList)(o);try{if(d&&c||p&&u)return s(e);{t.setNodeMarkup(a,o);let e=a+n.nodeSize,s=(0,i("iD5M5").getSupportedListTypesSet)(r);return t.doc.nodesBetween(a,e,(e,n,d)=>(s.has(e.type)&&n!==a&&d&&(s.has(d.type)||d.type===r.listItem)&&(e.type===l||(0,i("iD5M5").isBulletOrOrderedList)(e.type)&&u)&&t.setNodeMarkup(n,o),!0)),t}}catch{return null}},e.exports.transformToTaskList=(e,t,n,a,i)=>{try{let{taskItem:o}=i,s=[];if(e.doc.nodesBetween(t.start,t.end,e=>{if(e.isBlock){let t=[...e.content.content];if(t.length>0){let e=o.create(a,t);s.push(e)}}return!1}),0===s.length)return null;let r=n.create(a,s);return e.replaceWith(t.start,t.end,r),e}catch{return null}},e.exports.transformTaskListToBlockNodes=e=>{let{tr:t,targetNodeType:a,targetAttrs:o,sourceNode:s,sourcePos:r}=e,{selection:l}=t,d=l.$from.doc.type.schema,c=(0,n.findChildrenByType)(s,d.nodes.taskItem).map(e=>e.node).map(e=>e.content),p=[];if(a===d.nodes.heading&&o){let e=o.level;p=c.map(t=>d.nodes.heading.createChecked({level:e},t.content))}if(a===d.nodes.paragraph&&(p=c.map(e=>d.nodes.paragraph.createChecked({},e.content))),a===d.nodes.codeBlock){let e=c.map(e=>e.textBetween(0,e.size,"\n")).join("\n");p=[d.nodes.codeBlock.createChecked({},d.text(e))]}let u=new(0,i("5SAOw").Slice)(i("5SAOw").Fragment.fromArray(p),0,0),h=null!==r?r:l.from;return t.replaceRange(h,h+s.nodeSize,u),t},e.exports.getFormattedNode=e=>{let t,{selection:a}=e,{nodes:i}=e.doc.type.schema,o=a.from,s=(0,n.findSelectedNodeOfType)([i.paragraph,i.heading,i.blockquote,i.panel,i.expand,i.codeBlock,i.bulletList,i.orderedList,i.taskList,i.layoutSection])(a);if(s)t=s.node,o=s.pos;else{let e=(0,n.findParentNodeOfType)([i.blockquote,i.panel,i.expand,i.codeBlock,i.listItem,i.taskItem,i.layoutSection])(a);if(e){t=e.node,o=e.pos;let s=(0,n.findParentNodeOfType)([i.paragraph,i.heading])(a);if(e.node.type===i.listItem||e.node.type===i.taskItem){let e=(0,n.findParentNodeOfType)([i.bulletList,i.orderedList,i.taskList])(a);e&&(t=e.node,o=e.pos)}else e.node.type!==i.blockquote&&s&&(t=s.node,o=s.pos)}}return t||(t=a.$from.node(),o=a.$from.pos),{node:t,pos:o}}}),o("iD5M5",function(e,t){let n=e=>[e.bulletList,e.orderedList,e.taskList].filter(Boolean);e.exports.isBulletOrOrderedList=e=>"bulletList"===e.name||"orderedList"===e.name,e.exports.isTaskList=e=>"taskList"===e.name,e.exports.getSupportedListTypesSet=e=>new Set(n(e)),e.exports.convertBlockToInlineContent=(e,t)=>{let{paragraph:n,hardBreak:a}=t.nodes;if(e.type===n)return[...e.content.content];if(e.isBlock){let n=e.textContent.split("\n"),i=[];return n.forEach((e,o)=>{""!==e&&i.push(e?t.text(e):t.text(" ")),n.length>1&&o!==n.length-1&&i.push(a.create())}),i}return[e]}}),o("3ihIB",function(e,t){var n=i("l998X");i("42omo");let a=new(0,i("ks2lK").PluginKey)("accessibilityUtilsPlugin");function o({api:e}){let{ariaLiveElementAttributes:t,key:a,message:o}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["accessibilityUtils"],e=>({ariaLiveElementAttributes:e.accessibilityUtilsState?.ariaLiveElementAttributes,key:e.accessibilityUtilsState?.key,message:e.accessibilityUtilsState?.message})),s=t?.priority==="important"?"alert":"status";return(0,n.jsx)(i("6F6hl").default,{testId:"accessibility-message-wrapper",role:s,..."alert"===s&&{key:a},children:o})}e.exports.accessibilityUtilsPlugin=({api:e})=>{let t,s=e=>{t=e};return{name:"accessibilityUtils",actions:{ariaNotify:(e,n)=>{if(!t)return;let i=t.state.tr;i.setMeta(a,{message:e,ariaLiveElementAttributes:n,key:Date.now().toString()}),t.dispatch(i)}},contentComponent:()=>(0,n.jsx)(o,{api:e}),getSharedState:e=>e?a.getState(e):null,pmPlugins:()=>[{name:"get-editor-view",plugin:()=>new(0,i("1S4f7").SafePlugin)({key:a,state:{init:()=>({message:"",ariaLiveElementAttributes:{}}),apply:(e,t)=>{let n=e.getMeta(a);return n?{...t,...n}:t}},view:e=>(s(e),{})})}]}}}),o("PJ00O",function(t,n){var a=i("l998X");i("42omo");var o=i("42omo");i("42omo");let s=(0,i("9K4OG").css)({background:`var(--ds-background-neutral, ${i("6fnsQ").N20})`,borderRadius:"var(--ds-radius-full, 9999px)",minWidth:"var(--ds-space-400, 32px)",marginLeft:"var(--ds-space-negative-050, -4px)"}),r={name:"1g5siac",styles:"margin-right:var(--ds-space-100, 8px);display:flex;align-items:center;&& > ul{list-style-type:none;}div:last-child button.invite-to-edit{border-radius:var(--ds-radius-full, 9999px);height:32px;width:32px;padding:var(--ds-space-025, 2px);}"},l=(e,t)=>(0,i("9K4OG").css)({display:"block",position:"absolute",right:"var(--ds-space-025, 2px)",bottom:"var(--ds-space-025, 2px)",width:"var(--ds-space-150, 12px)",height:"var(--ds-space-150, 12px)",zIndex:i("aFUXX").akEditorSmallZIndex,borderRadius:"var(--ds-radius-small, 3px)",background:e,color:t,fontSize:(0,i("aFUXX").relativeFontSizeToBase16)(9),lineHeight:0,paddingTop:"var(--ds-space-075, 6px)",textAlign:"center",boxShadow:"0 0 1px var(--ds-border-inverse, #fff)",boxSizing:"border-box"});i("42omo");let d=e=>{let t=e.api?.collabEdit?.actions?.getAvatarColor(e.presenceId??e.sessionId)??{backgroundColor:`var(--ds-background-accent-red-subtle, ${i("6fnsQ").R100})`,textColor:`var(--ds-text-accent-gray-bolder, ${i("6fnsQ").N900})`},n=e.name.substr(0,1).toUpperCase();return(0,i("9K4OG").jsx)("div",{css:l(t?.backgroundColor,t?.textColor),"data-testid":"editor-collab-badge"},n)};var c=(0,i("2XqLN").default)((e,t)=>({name:e.name,src:e.avatar,size:"medium",presence:(0,a.jsx)(d,{api:t,name:e.name,sessionId:e.sessionId,presenceId:e.presenceId})}),function([e],[t]){return e.name===t.name&&e.avatar===t.avatar&&e.sessionId===t.sessionId});let p=(e,t,n,a,o)=>{let s=t[a],r=s.cursorPos;if(s&&void 0!==r&&s.sessionId!==n){let t={action:i("d925B").ACTION.MATCHED,actionSubject:i("d925B").ACTION_SUBJECT.SELECTION,eventType:i("d925B").EVENT_TYPE.TRACK};e?.core?.actions?.execute(({tr:e})=>(e.setSelection(i("ks2lK").Selection.near(e.doc.resolve(r))),o?.attachAnalyticsEvent(t)(e),e.scrollIntoView(),e)),e?.core?.actions?.focus()}},u=e(o).memo(e=>{let{sessionId:t,featureFlags:n,editorAPI:a}=e,o=e.participants?.toArray()?.slice();if(!o)return null;let s=o.sort(e=>e.sessionId===t?-1:1).map(e=>c(e,a));return s.length?(0,i("9K4OG").jsx)("div",{css:r},(0,i("9K4OG").jsx)(i("2Pg7f").default,{appearance:"stack",size:"medium",data:s,maxCount:3,onAvatarClick:(t,i,s)=>{n?.collabAvatarScroll&&s>0&&p(a,o,e.sessionId,s,e.editorAnalyticsAPI)}}),e.children):null}),h=e=>(0,i("9K4OG").jsx)(o.Fragment,null,e.children),m=t=>{let{Component:n,onClick:a,selected:r,title:l}=t,d=e(o).useMemo(()=>(0,i("9K4OG").jsx)(e(i("g5gZt")),{label:l}),[l]);return n||a?(0,i("9K4OG").jsx)("div",{css:s},(0,i("9K4OG").jsx)(n||h,null,(0,i("9K4OG").jsx)(i("a4eZN").default,{className:"invite-to-edit",onClick:a,selected:r,title:l,titlePosition:"bottom",iconBefore:d}))):null};var f=(0,i("gmMgo").default)(e=>{let t=e.intl.formatMessage(i("61p3e").default.inviteToEditButtonTitle),{isInviteToEditButtonSelected:n,inviteToEditHandler:o,inviteToEditComponent:s,editorView:r,featureFlags:l,editorAnalyticsAPI:d,editorAPI:c}=e,{sessionId:p,activeParticipants:h,initialised:f}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(c,["collabEdit"],e=>({sessionId:e.collabEditState?.sessionId,activeParticipants:e.collabEditState?.activeParticipants,initialised:e.collabEditState?.initialised}));return f?(0,a.jsx)(u,{sessionId:p,participants:h,editorView:r,featureFlags:l,editorAnalyticsAPI:d,editorAPI:c,children:(0,a.jsx)(m,{title:t,selected:n,onClick:o,Component:s})}):null});let g={name:"gzuwk4",styles:"display:flex;justify-content:flex-end;flex-grow:0;align-items:center;& > div{margin-right:0;}"},T=(0,i("9K4OG").css)(g,"flex-grow:1;");var E=e=>{let{dispatchAnalyticsEvent:t,featureFlags:n}=e,a=(0,i("8C5kA").default)();return(0,o.useEffect)(()=>{t&&t({action:i("d925B").ACTION.VIEWED,actionSubject:i("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.AVATAR_GROUP_PLUGIN,eventType:i("d925B").EVENT_TYPE.UI})},[t]),(0,i("9K4OG").jsx)("div",{"aria-label":a.formatMessage(i("c5kBY").avatarGroupMessages.editors),"data-testid":"avatar-group-in-plugin",css:e.takeFullWidth?T:g},(0,i("9K4OG").jsx)(f,{editorView:e.editorView,eventDispatcher:e.eventDispatcher,inviteToEditComponent:e.collabEdit&&e.collabEdit.inviteToEditComponent,inviteToEditHandler:e.collabEdit&&e.collabEdit.inviteToEditHandler,isInviteToEditButtonSelected:e.collabEdit&&e.collabEdit.isInviteToEditButtonSelected,featureFlags:n,editorAnalyticsAPI:e.editorAnalyticsAPI,editorAPI:e.editorAPI}))};t.exports.avatarGroupPlugin=({config:e,api:t})=>{let n=t?.featureFlags?.sharedState.currentState()||{},i=({editorView:i,eventDispatcher:o,dispatchAnalyticsEvent:s})=>i?(0,a.jsx)(E,{dispatchAnalyticsEvent:s,editorView:i,eventDispatcher:o,collabEdit:e?.collabEdit,takeFullWidth:e?.takeFullWidth,featureFlags:n,editorAnalyticsAPI:t?.analytics?.actions,editorAPI:t}):null;return e.showAvatarGroup&&t?.primaryToolbar?.actions.registerComponent({name:"avatarGroup",component:i}),{name:"avatarGroup",primaryToolbarComponent:!t?.primaryToolbar&&e.showAvatarGroup?i:void 0,actions:{getToolbarItem:({inviteToEditHandler:e,isInviteToEditButtonSelected:n,inviteToEditComponent:i})=>(0,a.jsx)(f,{featureFlags:t?.featureFlags?.sharedState.currentState()??{},editorAnalyticsAPI:t?.analytics?.actions,editorAPI:t,inviteToEditHandler:e,isInviteToEditButtonSelected:n,inviteToEditComponent:i})}}}}),o("fPXRH",function(e,t){let n=e=>e instanceof i("9YoeD").SetAttrsStep?{position:e.pos,attrs:e.attrs}:{position:e.pos,attrs:{[e.attr]:e.value}},a=e=>Array.from(e.reduce((e,t)=>{let a=n(t),i=e.get(a.position)||{};return e.set(a.position,{...i,...a.attrs}),e},new Map),([e,t])=>({position:e,attrs:t})),o=e=>!e.some(e=>{let t=e instanceof i("9YoeD").SetAttrsStep,n=e instanceof i("aXG5V").AttrStep;return!(t||n)}),s=({doc:e,steps:t})=>{if(!o(t))throw Error("BatchAttrsSteps error: Invalid BatchStep usage - non attribute step used");let n=a(t).map(({position:t,attrs:n})=>{let a=e.nodeAt(t);if(!a)throw Error(`BatchAttrsSteps error: Node does not exist at the position ${t}.`);return{position:t,attrs:n,nodeType:a.type.name}});return new(0,i("7Mtx3").BatchAttrsStep)(n)};e.exports.batchAttributeUpdatesPlugin=()=>({name:"batchAttributeUpdates",actions:{batchSteps:s}})}),o("hSJYu",function(e,t){e.exports.borderPlugin=()=>({name:"border",marks:()=>[{name:"border",mark:i("eINDz").border}]})}),o("01uqX",function(t,n){var a=i("1oCLl");let o=new(0,i("ks2lK").PluginKey)("codeBidiWarningPlugin");var s=i("l998X");i("42omo");var r=i("cUcZ5"),l=(e,t)=>e;let d=e=>(0,i("lkJUe").pluginFactory)(o,l,{onDocChanged:(t,n)=>{if(!t.steps.find(i("kTbzR").stepHasSlice))return n;let a=c({doc:t.doc,codeBidiWarningLabel:n.codeBidiWarningLabel,tooltipEnabled:n.tooltipEnabled,nodeViewPortalProviderAPI:e});return{...n,decorationSet:a}}});function c({doc:t,codeBidiWarningLabel:n,tooltipEnabled:a,nodeViewPortalProviderAPI:o}){let l=[];return(t.descendants((e,t)=>{if("text"===e.type.name&&e.marks&&e.marks.some(e=>"code"===e.type.name))return(0,i("03WRT").default)(e.textContent,({bidiCharacter:e,index:n})=>{l.push({position:t+n,bidiCharacter:e})}),!1;"codeBlock"===e.type.name&&(0,i("03WRT").default)(e.textContent,({bidiCharacter:e,index:n})=>{l.push({position:t+n+1,bidiCharacter:e})})}),0===l.length)?i("ftzrq").DecorationSet.empty:i("ftzrq").DecorationSet.create(t,l.map(({position:t,bidiCharacter:l})=>{let d=e(r)();return i("ftzrq").Decoration.widget(t,e=>(function({bidiCharacter:e,codeBidiWarningLabel:t,tooltipEnabled:n,nodeViewPortalProviderAPI:a,renderKey:o}){let r=document.createElement("span");return a.render(()=>(0,s.jsx)(i("g7Pc3").default,{bidiCharacter:e,skipChildren:!0,label:t,tooltipEnabled:n}),r,o),r})({bidiCharacter:l,codeBidiWarningLabel:n,tooltipEnabled:a,nodeViewPortalProviderAPI:o,renderKey:d}),{destroy:e=>{}})}))}let p=()=>(0,i("lkJUe").pluginFactory)(o,l,{onDocChanged:(e,t)=>{if(!e.steps.find(i("kTbzR").stepHasSlice))return t;let n=h({doc:e.doc,codeBidiWarningLabel:t.codeBidiWarningLabel,tooltipEnabled:t.tooltipEnabled});return{...t,decorationSet:n}}});function u(e){if(1!==e.nodeType)throw Error("Code Bidi Warning DOM spec did not return an Element node")}function h({doc:e,codeBidiWarningLabel:t,tooltipEnabled:n}){let a=[];return(e.descendants((e,t)=>{if("text"===e.type.name&&e.marks&&e.marks.some(e=>"code"===e.type.name))return(0,i("03WRT").default)(e.textContent,({bidiCharacter:e,index:n})=>{a.push({position:t+n,bidiCharacter:e})}),!1;"codeBlock"===e.type.name&&(0,i("03WRT").default)(e.textContent,({bidiCharacter:e,index:n})=>{a.push({position:t+n+1,bidiCharacter:e})})}),0===a.length)?i("ftzrq").DecorationSet.empty:i("ftzrq").DecorationSet.create(e,a.map(({position:e,bidiCharacter:a})=>i("ftzrq").Decoration.widget(e,()=>(function(e,t,n){let a=function(e,t,n){let a=`U+${e.codePointAt(0)?.toString(16)?.toUpperCase()}`;return["span",{"data-prosemirror-node-name":"code-bidi-warning",dir:"ltr"},["span",{"data-bidi-component":"code-bidi-warning-decorator","data-testid":"code-bidi-warning-decorator","data-bidi-character-code":a,role:"mark"},["span",{"aria-hidden":"true"},"<"],a,["span",{"aria-hidden":"true"},">"]],...n?[["span",{"data-bidi-component":"code-bidi-warning-tooltip",role:"tooltip"},t]]:[]]}(e,t,n),{dom:o}=i("5SAOw").DOMSerializer.renderSpec(document,a);return u(o),o})(a,t,n),{destroy:e=>{u(e),e.remove()}})))}let m=(e,{dispatch:t,getIntl:n,nodeViewPortalProviderAPI:s},{appearance:r})=>{let l=n().formatMessage(i("7Rcde").codeBidiWarningMessages.label),{createPluginState:u,getPluginState:m}=(0,i("dh538").fg)("platform_editor_vanilla_codebidi_warning")?p():d(s);return new(0,i("1S4f7").SafePlugin)({key:o,state:u(t,t=>(0,a.expValEquals)("platform_editor_remove_bidi_char_warning","isEnabled",!0)||e?.limitedMode?.sharedState.currentState()?.enabled?{decorationSet:i("ftzrq").DecorationSet.empty,codeBidiWarningLabel:"",tooltipEnabled:!1}:{decorationSet:(0,i("dh538").fg)("platform_editor_vanilla_codebidi_warning")?h({doc:t.doc,codeBidiWarningLabel:l,tooltipEnabled:!0}):c({doc:t.doc,codeBidiWarningLabel:l,tooltipEnabled:!0,nodeViewPortalProviderAPI:s}),codeBidiWarningLabel:l,tooltipEnabled:!0}),props:{decorations:e=>{if((0,a.expValEquals)("platform_editor_remove_bidi_char_warning","isEnabled",!0))return i("ftzrq").DecorationSet.empty;let{decorationSet:t}=m(e);return t}}})};t.exports.codeBidiWarningPlugin=({config:e,api:t})=>({name:"codeBidiWarning",pmPlugins:()=>[{name:"codeBidiWarning",plugin:n=>m(t,n,e??{})}]})}),o("bS1lJ",function(e,t){let n=new(0,i("ks2lK").PluginKey)("customAutoformatPlugin"),a=e=>n.getState(e),o=(e,t)=>e.setMeta(n,t),s=(e,t)=>async(e,n,a,s)=>{let r=t(n.slice(1,n.length-1));e.dispatch(o(e.state.tr,{action:"matched",match:n,start:a,end:s}));let l=await r,d=(0,i("6tl2G").processRawValue)(e.state.schema,l);return e.dispatch(o(e.state.tr,{action:"resolved",matchString:n[0],replacement:d})),l},r=(e,t)=>{let n=e[0],a=e.slice(1),i=t[0][0];return a===t[0].slice(1)&&"|"===n&&""===i},l=(e,t)=>{let{inlineCard:n}=e.state.schema.nodes;t.matches.forEach(a=>{let s=t.resolving.filter(e=>e.match[0]===a.matchString),l=e.state.tr;s.forEach(t=>{let{match:i,start:o,end:s}=t,{replacement:d}=a,c=i[1],p=s+i[i.length-1].length;if(!d||d.type!==n&&!d.isText)return;let u=e.state.doc.textBetween(o,p,"#","|"),h=r(u,i);(u===i[0]||h)&&(l=l.replaceWith(l.mapping.map(o+c.length),l.mapping.map(s,-1),d))}),l=o(l,{action:"finish",matchString:a.matchString}),e.dispatch((0,i("ke2AI").closeHistory)(l))})},d=(e,t,n,a,i)=>{let{state:o}=e,s=o.doc.resolve(n);if(s.parent.type.spec.code)return!1;let r=s.parent.textBetween(Math.max(0,s.parentOffset-500),s.parentOffset,void 0,"")+i;for(let o=0;o<t.length;o++){let s;if(s=i.length?t[o].matchTyping.exec(r):t[o].matchEnter.exec(r)){let r=n-(s[0].length-i.length);return t[o].handler(e,s,r,a),!0}}return!1},c=(e,t)=>({...e,resolving:[...e.resolving,{start:t.start,end:t.end,match:t.match}]}),p=(e,t)=>({...e,matches:[...e.matches,{replacement:t.replacement,matchString:t.matchString}]}),u=(e,t)=>({...e,resolving:e.resolving.filter(e=>e.match[0]!==t.matchString),matches:e.matches.filter(e=>e.matchString!==t.matchString)}),h=(e,t)=>({...e,autoformattingProvider:t.provider});var m=(e,t)=>{switch(t.action){case"matched":return c(e,t);case"resolved":return p(e,t);case"finish":return u(e,t);case"setProvider":return h(e,t);default:return e}};let f=({providerFactory:e},t,o)=>{let r=[];return new(0,i("1S4f7").SafePlugin)({state:{init:()=>({resolving:[],matches:[],autoformattingProvider:void 0}),apply(e,t){if(!t)return t;let a={...t,resolving:t.resolving.map(t=>({...t,start:e.mapping.map(t.start),end:e.mapping.map(t.end,-1)}))},i=e.getMeta(n);return i?m(a,i):a}},props:{handleTextInput:(e,t,n,a)=>(d(e,r,t,n,a),!1),handleKeyDown:(0,i("dus6D").keydownHandler)({Enter:(e,t,n)=>(n&&d(n,r,n.state.selection.from,n.state.selection.to,""),!1)})},view(){var e;return t?.autoformattingProvider&&(e=t.autoformattingProvider)&&e.then(async e=>{let t=await e.getRules();Object.keys(t).forEach(e=>{let n={matchTyping:RegExp("(\\s+|^|\\ufffc)"+e+"(\\s|,|\\.)$"),matchEnter:RegExp("(\\s+|^)"+e+"()$"),handler:s(e,t[e])};r.push(n)})}),{update(e){let t=a(e.state);t&&t.matches&&l(e,t)}}},key:n})},g=e=>t=>o(t,{action:"setProvider",provider:e});e.exports.customAutoformatPlugin=({api:e,config:t})=>{let n;return t?.autoformattingProvider&&t.autoformattingProvider.then(t=>{e?.core.actions.execute(({tr:e})=>g(t)(e))}),{name:"customAutoformat",pmPlugins:()=>[{name:"customAutoformat",plugin:n=>f(n,t,e)}],getSharedState(e){if(!e)return;let{autoformattingProvider:t}=a(e)??{};return{autoformattingProvider:t}},actions:{setProvider:async a=>{let i=await a;return n!==i&&t?.autoformattingProvider!==a&&(n=i,e?.core.actions.execute(({tr:e})=>g(i)(e))??!1)}}}}}),o("2nH2Y",function(e,t){e.exports.dataConsumerPlugin=()=>({name:"dataConsumer",marks:()=>[{name:"dataConsumer",mark:i("4dOgb").dataConsumer}]})}),o("1GAIu",function(e,t){let n=new(0,i("ks2lK").PluginKey)("scrollIntoViewPlugin"),a=e=>!!e.docChanged&&e.steps.some(e=>e instanceof i("aXG5V").ReplaceStep||e instanceof i("aXG5V").ReplaceAroundStep),o=()=>new(0,i("1S4f7").SafePlugin)({key:n,appendTransaction:(e,t,n)=>{if(!e.length)return;let o=e[0];if((a(o)||o.storedMarksSet)&&!o.scrolledIntoView&&!1!==o.getMeta("scrollIntoView")&&!1!==o.getMeta("addToHistory")&&!o.getMeta("isRemote")&&!o.getMeta(i("14sLv").TEXT_INPUT_RULE_TRANSACTION_KEY)&&void 0===o.getMeta("appendedTransaction"))return n.tr.scrollIntoView()}});e.exports.scrollIntoViewPlugin=()=>({name:"scrollIntoView",pmPlugins:()=>[{name:"scrollIntoView",plugin:()=>o()}]})}),o("59fTa",function(t,n){var a,o,s=i("42omo"),r=((a={}).START_TRACKING_PASTED_MACRO_POSITIONS="START_TRACKING_PASTED_MACRO_POSITIONS",a.STOP_TRACKING_PASTED_MACRO_POSITIONS="STOP_TRACKING_PASTED_MACRO_POSITIONS",a.SHOW_PASTE_OPTIONS="SHOW_PASTE_OPTIONS",a.HIDE_PASTE_OPTIONS="HIDE_PASTE_OPTIONS",a.HIGHLIGHT_CONTENT="HIGHLIGHT_CONTENT",a.CHANGE_FORMAT="CHANGE_FORMAT",a);let l=new(0,i("ks2lK").PluginKey)("paste-options");var d=((o={})[o.Markdown=0]="Markdown",o[o.RichText=1]="RichText",o[o.PlainText=2]="PlainText",o[o.None=3]="None",o);let{createPluginState:c,createCommand:p,getPluginState:u}=(0,i("lkJUe").pluginFactory)(l,(e,t)=>{switch(t.type){case r.SHOW_PASTE_OPTIONS:return{...e,showToolbar:!0,highlightContent:!1,isPlainText:t.data.isPlainText,plaintext:t.data.plaintext,selectedOption:t.data.selectedOption,richTextSlice:t.data.richTextSlice,pasteStartPos:t.data.pasteStartPos,pasteEndPos:t.data.pasteEndPos};case r.HIDE_PASTE_OPTIONS:return{...e,highlightContent:!1,showToolbar:!1};case r.HIGHLIGHT_CONTENT:return{...e,highlightContent:!0};case r.CHANGE_FORMAT:return{...e,highlightContent:!0,selectedOption:t.data.selectedOption};default:return e}},{mapping:(e,t)=>{if(!e.docChanged||!t.showToolbar)return t;let n=t.pasteStartPos,a=t.pasteEndPos,i=e.mapping.map(n),o=e.mapping.map(a);return h(e)?{...t,pasteEndPos:o}:n===i&&a===o?t:{...t,pasteStartPos:i,pasteEndPos:o}},onSelectionChanged:(e,t)=>e.getMeta("outsideProsemirrorEditorClicked")?{...t,showToolbar:!1,highlightContent:!1}:t}),h=e=>{let t=e.getMeta("paste-options$");return!!t&&t.type===r.CHANGE_FORMAT},m=e=>{if(!e)return!1;let t=!1;return e.content.descendants(e=>!["media","mediaInline","mediaGroup","mediaSingle"].includes(e.type.name)||(t=!0,!1)),t},f=(e,t)=>{let n=!1;return e.content.nodesBetween(0,e.content.size,(e,a)=>{e.type===t.nodes.rule&&(n=!0)}),n},g=e=>{let t=!1;return e.content.descendants(e=>{let n=e.marks?.map(e=>e.type.name);if(t=n?.includes("link"))return!1}),t},T=(e,t)=>{let n=t.pasteStartPos,a=t.pasteEndPos,o=t.plaintext;if(n<0)return e;let s=e.doc.resolve(n);0===s.parentOffset&&s.depth>0&&(n=s.before());let r=function(e,t,n){let a=n.$from.parent,o=n.$to.parent;try{let n=e,s=n.split(/```/);for(let e=0;e<s.length;e++)e%2==0&&(s[e]=s[e].replace(/\\/g,"\\\\"));n=s.join("```");let r=new(0,i("aRZzN").MarkdownTransformer)(t,i("jvA0K").md).parse(n.replace(/(\[([^\]]+)\]\()?((https?|ftp|jamfselfservice):\/\/[^\s"'>]+)/g,e=>e.match(/^(https?|ftp|jamfselfservice):\/\/[^\s"'>]+$/)?`<${e}>`:e));if(!r||!r.content)return;let l=a.type===r.content.firstChild?.type,d=o.type===r.content.lastChild?.type,c=i("ks2lK").Selection.atStart(r).$from,p=i("ks2lK").Selection.atEnd(r).$from,u=l?c.depth:0,h=d?p.depth:0;return new(0,i("5SAOw").Slice)(r.content,u,h)}catch(e){(0,i("hWRJP").logException)(e,{location:"editor-plugin-paste-options-toolbar/util"});return}}(o,e.doc.type.schema,e.selection);return r&&_({tr:e,pasteStartPos:n,pasteEndPos:a,slice:r}),e},E=(e,t)=>{let n=t.pasteStartPos,a=t.pasteEndPos,o=t.richTextSlice;if(n<0||0===o.content.size)return e;let s=e.doc.resolve(n);return 0===s.parentOffset&&s.depth>0&&(n=s.before()),function({tr:e,pasteStartPos:t,pasteEndPos:n,slice:a}){e.replaceRange(t,n,a);let o=e.steps[0];if(!(o instanceof i("aXG5V").ReplaceStep))return;let s=e.mapping.map(o.to),r=i("ks2lK").Selection.findFrom(e.doc.resolve(Math.min(s,e.doc.content.size)),-1);r&&e.setSelection(r)}({tr:e,pasteStartPos:n,pasteEndPos:a,slice:o}),e},y=(e,t)=>{let n=t.pasteStartPos,a=t.pasteEndPos,o=t.plaintext;if(n<0||""===o)return e;let s=e.doc.resolve(n);0===s.parentOffset&&s.depth>0&&(n=s.before());let r=e.doc.type.schema,l=r.text(o),d=i("5SAOw").Fragment.from(r.nodes.paragraph.createAndFill(null,l));return _({tr:e,pasteStartPos:n,pasteEndPos:a,slice:new(0,i("5SAOw").Slice)(d,s.depth,s.depth)}),e};function _({tr:e,pasteStartPos:t,pasteEndPos:n,slice:a}){e.replaceRange(t,n,a);let o=e.steps[0];if(!(o instanceof i("aXG5V").ReplaceStep))return e;let s=o.slice.content.lastChild,r=s?.type.createAndFill(),l=r?.nodeSize===s?.nodeSize,d=!s?.isLeaf&&l,c=e.doc.resolve(e.mapping.map(o.to)),p=d&&c.depth>0?e.doc.resolve(c.before()):c,u=i("ks2lK").Selection.findFrom(p,-1);u&&e.setSelection(u)}let S=(e,t)=>p(n=>({type:r.SHOW_PASTE_OPTIONS,data:{selectedOption:t,plaintext:e.text??"",isPlainText:e.isPlainText,richTextSlice:e.pastedSlice,pasteStartPos:e.pasteStartPos,pasteEndPos:e.pasteEndPos}})),b=()=>p(e=>({type:r.CHANGE_FORMAT,data:{selectedOption:d.PlainText}}),(e,t)=>{let n=l.getState(t);return n.selectedOption===d.PlainText?e:y(e,n)}),C=(e,t)=>()=>(0,i("dAtrv").withAnalytics)(e,{action:i("d925B").ACTION.PASTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:i("d925B").INPUT_METHOD.TOOLBAR,type:i("aSgIe").PasteTypes.plain,content:i("aSgIe").PasteContents.text,pasteSize:t}})(b()),v=()=>A(),I=()=>p(e=>({type:r.CHANGE_FORMAT,data:{selectedOption:d.RichText}}),(e,t)=>{let n=l.getState(t);return n.selectedOption===d.RichText?e:E(e,n)}),N=e=>()=>(0,i("dAtrv").withAnalytics)(e,e=>{let t=l.getState(e);return{action:i("d925B").ACTION.PASTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:i("d925B").INPUT_METHOD.TOOLBAR,type:i("aSgIe").PasteTypes.richText,content:i("aSgIe").PasteContents.text,pasteSize:t.richTextSlice?.size||0}}})(I()),k=()=>p(e=>({type:r.CHANGE_FORMAT,data:{selectedOption:d.Markdown}}),(e,t)=>{let n=l.getState(t);return n.selectedOption===d.Markdown?e:T(e,n)}),x=(e,t)=>()=>(0,i("dAtrv").withAnalytics)(e,{action:i("d925B").ACTION.PASTED,actionSubject:i("d925B").ACTION_SUBJECT.DOCUMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:i("d925B").INPUT_METHOD.TOOLBAR,type:i("aSgIe").PasteTypes.markdown,content:i("aSgIe").PasteContents.text,pasteSize:t}})(k()),A=()=>p(e=>({type:r.HIGHLIGHT_CONTENT})),O=()=>p(e=>({type:r.HIDE_PASTE_OPTIONS})),P=e=>{l.getState(e.state).showToolbar&&O()(e.state,e.dispatch)};var M=i("l998X");i("42omo");let w=t=>(0,M.jsx)(e(i("iV0NL")),{...t});w.displayName="EditorPasteIcon";let D=(e,t)=>{let n=e.selection.$from;if(f(t.pastedSlice,e.schema))return!1;let a=n.parent?.type,i=n.node(n.depth-1)?.type;return!(!i||i.name!==e.schema.nodes.doc.name||a.name===e.schema.nodes.codeBlock?.name||"fabric-editor"===t.pasteSource||g(t.pastedSlice)||m(t.pastedSlice))},R=(e,t,n)=>{let a=[{id:"editor.paste.richText",title:t.formatMessage(i("fHFVT").pasteOptionsToolbarMessages.richText),selected:e.selectedOption===d.RichText,hidden:e.isPlainText,onClick:N(n)()},{id:"editor.paste.markdown",title:t.formatMessage(i("fHFVT").pasteOptionsToolbarMessages.markdown),selected:e.selectedOption===d.Markdown,onClick:x(n,e.plaintext.length)()},{id:"editor.paste.plainText",title:t.formatMessage(i("fHFVT").pasteOptionsToolbarMessages.plainText),selected:e.selectedOption===d.PlainText,onClick:C(n,e.plaintext.length)()}];return{id:"ak-editor-paste-toolbar-item",icon:w,type:"dropdown",testId:"paste-options-testid",title:t.formatMessage(i("fHFVT").pasteOptionsToolbarMessages.pasteOptions),options:a,onToggle:B}},B=(e,t)=>v()(e,t),L=(e,t,n)=>{let{schema:a}=e,o=Object.values(a.nodes),s=R(l.getState(e),t,n);return{title:t.formatMessage(i("fHFVT").pasteOptionsToolbarMessages.pasteOptions),nodeType:o,zIndex:i("aFUXX").akEditorFloatingPanelZIndex,className:"ak-editor-paste-toolbar",items:[s],align:"right",onPositionCalculated:U}},U=(e,t)=>{let{from:n}=e.state.selection,a=e.coordsAtPos(n),o=document.querySelector(`div[aria-label="${i("fHFVT").pasteOptionsToolbarMessages.pasteOptions.defaultMessage}"]`),s=o?.offsetParent||e.dom,r=s?.getBoundingClientRect(),l=r?.top||0,d=r?.left||0,c=s?.scrollTop||0,p=K(e,n);return{top:a.top-l+c+p,left:a.left-d}},K=(e,t)=>{let n=e.domAtPos(t).node,a=n?.nodeType===Node.TEXT_NODE?n.parentNode:n;return parseFloat(window.getComputedStyle(a,void 0).lineHeight||"")};t.exports.pasteOptionsToolbarPlugin=({config:e,api:t})=>{let n=t?.analytics?.actions;return{name:"pasteOptionsToolbarPlugin",pmPlugins:()=>[{name:"pasteOptionsToolbarPlugin",plugin:({dispatch:e})=>new(0,i("1S4f7").SafePlugin)({key:l,state:c(e,{showToolbar:!1,pasteStartPos:0,pasteEndPos:0,plaintext:"",isPlainText:!1,highlightContent:!1,highlightDecorationSet:i("ftzrq").DecorationSet.empty,richTextSlice:i("5SAOw").Slice.empty,selectedOption:d.None}),view:e=>({update:(e,t)=>t}),props:{handleDOMEvents:{blur:P,mousedown:P},handleKeyDown:e=>(P(e),!1),decorations:e=>{let{highlightContent:t,pasteStartPos:n}=l.getState(e)||{},a=l.getState(e)?.highlightDecorationSet??i("ftzrq").DecorationSet.empty;if(!t)return a;let{selection:o}=e.tr,s=o.$anchor.pos,r=i("ftzrq").Decoration.inline(n,s,{class:"text-highlight"},{key:"paste-highlight-decoration-key"});return a.add(e.doc,[r])}}})}],pluginsOptions:{floatingToolbar(e,t){if(l.getState(e).showToolbar)return L(e,t,n)}},usePluginHook({editorView:e}){let{lastContentPasted:n}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(t,["paste"],e=>({lastContentPasted:e.pasteState?.lastContentPasted}));(0,s.useEffect)(()=>{if(!n)return void O()(e.state,e.dispatch);let t=d.None;t=n.isPlainText?n.isShiftPressed?d.PlainText:d.Markdown:d.RichText,D(e.state,n)&&S(n,t)(e.state,e.dispatch)},[n,e])}}}}),o("bz4KD",function(e,t){var n=i("kyRHQ");e.exports.ufoPlugin=()=>({name:"ufo",pmPlugins:()=>(n?.env?.REACT_SSR,[])})}),o("hr8mu",function(t,n){var a,o=i("l998X");i("42omo");var s=i("iu6m9");let r=e=>(t,n)=>{let{nodes:{paragraph:a,heading:o},marks:{alignment:s}}=t.schema;return(0,i("dhoHU").toggleBlockMark)(s,()=>e?"start"!==e&&{align:e}:void 0,[a,o])(t,n)},l=(e,t,n)=>(a,o)=>{let{nodes:{paragraph:s,heading:r},marks:{alignment:l}}=a.schema;return(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,actionSubject:i("d925B").ACTION_SUBJECT.ALIGNMENT,action:i("d925B").ACTION.UPDATED,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.TEXT,attributes:{alignmentType:t,inputMethod:n}})((0,i("dhoHU").toggleBlockMark)(l,()=>t?"start"!==t&&{align:t}:void 0,[s,r]))(a,o)},d=(e,t,n)=>({tr:a})=>{let{nodes:{paragraph:o,heading:s},marks:{alignment:r}}=a.doc.type.schema;return(0,i("dhoHU").toggleBlockMarkNext)(r,()=>t?"start"!==t&&{align:t}:void 0,[o,s])(a)&&e?.analytics?.actions.attachAnalyticsEvent({eventType:i("d925B").EVENT_TYPE.TRACK,actionSubject:i("d925B").ACTION_SUBJECT.ALIGNMENT,action:i("d925B").ACTION.UPDATED,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.TEXT,attributes:{alignmentType:t,inputMethod:n}})(a),a},c=(e,t,n)=>(a,o)=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,actionSubject:i("d925B").ACTION_SUBJECT.ALIGNMENT,action:i("d925B").ACTION.UPDATED,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.MEDIA_SINGLE,attributes:{alignmentType:t,inputMethod:n}})((0,i("dhoHU").changeImageAlignment)(t))(a,o),p=(e,t,n)=>({tr:a})=>((0,i("dhoHU").changeImageAlignmentNext)(t)(a)&&e?.analytics?.actions.attachAnalyticsEvent({eventType:i("d925B").EVENT_TYPE.TRACK,actionSubject:i("d925B").ACTION_SUBJECT.ALIGNMENT,action:i("d925B").ACTION.UPDATED,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.MEDIA_SINGLE,attributes:{alignmentType:t,inputMethod:n}})(a),a),u=(e,t,n)=>(a,o)=>{var s;return(s=[c(t?.analytics?.actions,e,n),l(t?.analytics?.actions,e,n)],(e,t)=>{let{tr:n}=e,a=!1,o=e=>{let t=e.selection.toJSON();n.setSelection(i("ks2lK").Selection.fromJSON(n.doc,t)),e.steps.forEach(e=>{n.step(e)}),a=!0};return s.forEach(t=>t(e,o)),!!t&&!!a&&(t(n),!0)})(a,o)},h=(e,t,n)=>({tr:a})=>(d(e,t,n)({tr:a}),p(e,t,n)({tr:a}),a);var m=i("8m4tT");let f=e=>{if(e.selection instanceof i("7XFGZ").CellSelection){let t=[];return e.selection.forEachCell(n=>{let a=n.firstChild.marks.filter(t=>t.type===e.schema.marks.alignment)[0];t.push(a?a.attrs.align:"start")}),t.every(e=>e===t[0])?t[0]:"start"}let t=(0,m.findParentNodeOfType)([e.schema.nodes.paragraph,e.schema.nodes.heading])(e.selection),n=t&&t.node.marks.filter(t=>t.type===e.schema.marks.alignment)[0];return n&&n.attrs.align||"start"},g=new(0,i("ks2lK").PluginKey)("alignmentPlugin");var T=i("42omo"),E=((a={}).PRIMARY="primaryToolbar",a.FLOATING="floatingToolbar",a),y=i("2dkHo"),_=i("h4TOP");i("42omo"),i("42omo");let S={start:{Component:e(i("6bJyJ")),label:i("hkTaH").alignmentMessages.alignLeft},end:{Component:e(i("cOZT3")),label:i("hkTaH").alignmentMessages.alignRight},center:{Component:e(i("kiZiu")),label:i("hkTaH").alignmentMessages.alignCenter}},b=e=>{let{Component:t,label:n}=S[e.alignment],a=(0,i("8C5kA").default)();return(0,o.jsx)(t,{label:a.formatMessage(n),color:"currentColor",spacing:"spacious"})};i("42omo");var C=function({label:e,isSelected:t,content:n,shortcut:a,onClick:s,value:r}){return(0,o.jsx)(i("a4eZN").default,{disabled:!1,selected:t,title:(0,o.jsx)(i("hgeg8").ToolTipContent,{description:e,keymap:a}),"aria-label":a?(0,i("hgeg8").tooltip)(a,e):e,"aria-pressed":t,"aria-keyshortcuts":(0,i("hgeg8").getAriaKeyshortcuts)(a),onClick:e=>{let t=e instanceof MouseEvent;e.preventDefault(),s(r,t)},iconBefore:n,titlePosition:"bottom"})};let v=i("hgeg8").alignCenter,I=i("hgeg8").alignRight,N=[{title:i("hkTaH").alignmentMessages.alignLeft,shortcut:i("hgeg8").alignLeft,value:"start"},{title:i("hkTaH").alignmentMessages.alignCenter,shortcut:v,value:"center"},{title:i("hkTaH").alignmentMessages.alignRight,shortcut:I,value:"end"}];var k=(0,i("gmMgo").default)(function({onClick:e,selectedAlignment:t,className:n,intl:a}){return(0,o.jsx)("div",{"data-testid":"alignment-buttons",className:(0,i("gMc0m").default)(["_1e0c1txw _ca0qze3t _n3tdze3t _19bvu2gc _u5f3u2gc _p12f53f4 _gy1pv77o","_1fvdglyw",n]),children:N.map(n=>{let{value:i,title:s,shortcut:r}=n,l=a.formatMessage(s);return(0,o.jsx)(C,{content:(0,o.jsx)(b,{alignment:i}),value:i,label:l,shortcut:r,onClick:e,isSelected:i===t},i)})})});function x(e,t,n){var a;return(t="symbol"==typeof(a=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=typeof a)return a;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?a:a+"")in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class A extends e(T).Component{render(){let{isOpen:t}=this.state,{popupsMountPoint:n,popupsBoundariesElement:a,popupsScrollableElement:r,isReducedSpacing:l,align:d,disabled:c,intl:p,api:u}=this.props,h=d??"start",m=p.formatMessage(i("hkTaH").alignmentMessages.alignment),f=(0,s.editorExperiment)("platform_editor_controls","variant1",{exposure:!0})?"compact":"none",g=[{key:"alignmentLeft",content:p.formatMessage(i("hkTaH").alignmentMessages.alignLeft),value:{name:"start"},isActive:"start"===d,elemAfter:(0,o.jsx)(i("807Mc").Shortcut,{children:(0,i("hgeg8").tooltip)(i("hgeg8").alignLeft)}),elemBefore:(0,o.jsx)(e(i("6bJyJ")),{label:""})},{key:"alignmentCenter",content:p.formatMessage(i("hkTaH").alignmentMessages.alignCenter),value:{name:"center"},isActive:"center"===d,elemAfter:(0,o.jsx)(i("807Mc").Shortcut,{children:(0,i("hgeg8").tooltip)(i("hgeg8").alignCenter)}),elemBefore:(0,o.jsx)(e(i("kiZiu")),{label:""})},{key:"alignmentRight",content:p.formatMessage(i("hkTaH").alignmentMessages.alignRight),value:{name:"end"},isActive:"end"===d,elemAfter:(0,o.jsx)(i("807Mc").Shortcut,{children:(0,i("hgeg8").tooltip)(i("hgeg8").alignRight)}),elemBefore:(0,o.jsx)(e(i("cOZT3")),{label:""})}];return(0,o.jsxs)(i("8mBDG").ToolbarDropdownWrapper,{children:[(0,s.editorExperiment)("platform_editor_controls","variant1")?(0,o.jsx)(_.DropdownMenuWithKeyboardNavigation,{arrowKeyNavigationProviderOptions:{type:i("5v8Ta").ArrowKeyNavigationType.MENU},items:[{items:g}],isOpen:t,onItemActivated:this.handleOnItemActivated,onOpenChange:e=>this.setState({isOpen:e?.isOpen}),mountTo:n,boundariesElement:a,scrollableElement:r,fitWidth:200,children:(0,o.jsx)(i("a4eZN").default,{spacing:l?f:"default",disabled:c,selected:t,title:m,"aria-label":m,"aria-expanded":t,"aria-haspopup":!0,onClick:this.toggleOpen,onKeyDown:this.toggleOpenByKeyboard,iconBefore:(0,o.jsxs)(i("7k7Bn").ToolbarDropdownTriggerWrapper,{children:[(0,o.jsx)(b,{alignment:h}),(0,o.jsx)(i("l1m3U").ToolbarExpandIcon,{})]})})}):(0,o.jsx)(y.DropdownContainer,{mountTo:n,boundariesElement:a,scrollableElement:r,isOpen:t,handleClickOutside:e=>{e instanceof MouseEvent&&this.hide({isOpen:!1,event:e})},handleEscapeKeydown:this.hideOnEscape,arrowKeyNavigationProviderOptions:{type:i("5v8Ta").ArrowKeyNavigationType.MENU},fitWidth:112,fitHeight:80,closeOnTab:!0,trigger:(0,o.jsx)(i("a4eZN").default,{spacing:l?f:"default",disabled:c,selected:t,title:m,className:"align-btn","aria-label":m,"aria-expanded":t,"aria-haspopup":!0,onClick:this.toggleOpen,onKeyDown:this.toggleOpenByKeyboard,iconBefore:(0,o.jsxs)(i("7k7Bn").ToolbarDropdownTriggerWrapper,{children:[(0,o.jsx)(b,{alignment:h}),(0,o.jsx)(i("l1m3U").ToolbarExpandIcon,{})]}),ref:this.toolbarItemRef}),children:(0,o.jsx)(k,{onClick:e=>this.changeAlignment(e,!1),selectedAlignment:h})}),!u?.primaryToolbar&&(0,o.jsx)(i("jN96M").ToolbarSeparator,{})]})}componentDidUpdate(e){this.props.toolbarType!==E.FLOATING&&this.state.isOpen&&setTimeout(()=>{let e=new KeyboardEvent("keydown",{bubbles:!0,key:"ArrowDown"});this.toolbarItemRef.current?.dispatchEvent(e)},0)}constructor(...t){super(...t),x(this,"toolbarItemRef",e(T).createRef()),x(this,"state",{isOpen:!1}),x(this,"changeAlignment",(e,t)=>(t&&this.toggleOpen(),this.props.changeAlignment(e))),x(this,"toggleOpen",()=>{this.setState({isOpen:!this.state.isOpen})}),x(this,"toggleOpenByKeyboard",e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),this.setState({isOpen:!this.state.isOpen}))}),x(this,"handleOnItemActivated",({item:e,shouldCloseMenu:t=!0})=>this.changeAlignment(e.value.name,t)),x(this,"hide",e=>{this.state.isOpen&&(this.setState({isOpen:!1}),e?.event instanceof KeyboardEvent&&"Escape"===e.event.key&&this.toolbarItemRef?.current?.focus())}),x(this,"hideOnEscape",()=>{this.hide(),this.toolbarItemRef?.current?.focus()})}}x(A,"displayName","AlignmentToolbar");var O=(0,i("gmMgo").default)(A);let P={disabled:!1,isToolbarReducedSpacing:!0};function M({api:e,editorView:t}){let{align:n,isEnabled:a}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["alignment"],e=>({align:e.alignmentState?.align,isEnabled:e.alignmentState?.isEnabled})),r=(0,T.useCallback)(n=>u(n,e,i("d925B").INPUT_METHOD.FLOATING_TB)(t.state,t.dispatch),[t,e]);return(0,o.jsx)(O,{align:n,isReducedSpacing:!(0,s.editorExperiment)("platform_editor_controls","variant1")&&P.isToolbarReducedSpacing,changeAlignment:r,disabled:P.disabled||!a,toolbarType:E.FLOATING,api:e})}function w({api:e,editorView:t,disabled:n,popupsMountPoint:a,popupsBoundariesElement:s,popupsScrollableElement:r,isToolbarReducedSpacing:l}){let{align:d,isEnabled:c}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["alignment"],e=>({align:e.alignmentState?.align,isEnabled:e.alignmentState?.isEnabled})),p=(0,T.useCallback)(n=>u(n,e,i("d925B").INPUT_METHOD.TOOLBAR)(t.state,t.dispatch),[t,e]);return(0,o.jsx)(O,{align:d,isReducedSpacing:l,changeAlignment:p,disabled:n||!c,popupsMountPoint:a,popupsBoundariesElement:s,popupsScrollableElement:r,api:e,toolbarType:E.PRIMARY})}i("42omo");var D=i("1oCLl");i("42omo");let R=()=>({start:{key:i("cPCP8").ALIGN_LEFT_MENU_ITEM.key,type:i("cPCP8").ALIGN_LEFT_MENU_ITEM.type,rank:i("4Chin").ALIGNMENT_MENU_SECTION_RANK[i("cPCP8").ALIGN_LEFT_MENU_ITEM.key],label:i("hkTaH").alignmentMessages.alignLeft,icon:e(i("6bJyJ")),keymap:i("hgeg8").alignLeft},center:{key:i("cPCP8").ALIGN_CENTER_MENU_ITEM.key,type:i("cPCP8").ALIGN_CENTER_MENU_ITEM.type,rank:i("4Chin").ALIGNMENT_MENU_SECTION_RANK[i("cPCP8").ALIGN_CENTER_MENU_ITEM.key],label:i("hkTaH").alignmentMessages.alignCenter,icon:e(i("kiZiu")),keymap:i("hgeg8").alignCenter},end:{key:i("cPCP8").ALIGN_RIGHT_MENU_ITEM.key,type:i("cPCP8").ALIGN_RIGHT_MENU_ITEM.type,rank:i("4Chin").ALIGNMENT_MENU_SECTION_RANK[i("cPCP8").ALIGN_RIGHT_MENU_ITEM.key],label:i("hkTaH").alignmentMessages.alignRight,icon:e(i("cOZT3")),keymap:i("hgeg8").alignRight}}),B=({children:e,api:t})=>{let{align:n="start",isEnabled:a}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(t,["alignment"],e=>({align:e.alignmentState?.align,isEnabled:e.alignmentState?.isEnabled})),{icon:s}=R()[n],{formatMessage:r}=(0,i("8C5kA").default)(),l=r(i("hkTaH").alignmentMessages.alignment);return(0,o.jsx)(i("iIVVb").ToolbarTooltip,{content:l,children:(0,o.jsx)(i("bTiiT").ToolbarDropdownMenu,{iconBefore:(0,o.jsx)(s,{label:"",size:"small"}),isDisabled:!a,testId:"text-alignment-menu",label:l,children:e})})};i("42omo");let L=({option:{label:e,icon:t,keymap:n},api:a,alignment:s,parents:r})=>{let{align:l}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(a,["alignment"],e=>({align:e.alignmentState?.align})),{formatMessage:d}=(0,i("8C5kA").default)(),c=(0,i("hgeg8").tooltip)(n);return(0,o.jsx)(i("2GVu1").ToolbarDropdownItem,{isSelected:l===s,elemBefore:(0,o.jsx)(t,{size:"small",label:""}),elemAfter:c&&(0,o.jsx)(i("jbmmV").ToolbarKeyboardShortcutHint,{shortcut:c}),ariaKeyshortcuts:(0,i("hgeg8").getAriaKeyshortcuts)(n),onClick:()=>{a?.core.actions.execute(h(a,s,(0,i("4Dsx2").getInputMethodFromParentKeys)(r)))},children:d(e)})};i("42omo");let U=({children:e,title:t,parents:n})=>{let a=n.some(e=>e.key===i("cPCP8").TEXT_COLLAPSED_MENU.key);return(0,o.jsx)(i("6UWPx").ToolbarDropdownItemSection,{hasSeparator:a,title:t,children:e})},K=e=>Object.entries(R()).map(([t,n])=>{let{key:a,type:s,rank:r}=n;return{type:s,key:a,parents:[{type:i("cPCP8").ALIGNMENT_MENU_SECTION.type,key:i("cPCP8").ALIGNMENT_MENU_SECTION.key,rank:r}],component:({parents:a})=>(0,o.jsx)(L,{api:e,option:n,alignment:t,parents:a})}}),F=e=>[{type:i("cPCP8").ALIGNMENT_GROUP.type,key:i("cPCP8").ALIGNMENT_GROUP.key,parents:[{type:i("cPCP8").TEXT_SECTION.type,key:i("cPCP8").TEXT_SECTION.key,rank:i("4Chin").TEXT_SECTION_RANK[i("cPCP8").ALIGNMENT_GROUP.key]},{type:i("cPCP8").TEXT_SECTION_PRIMARY_TOOLBAR.type,key:i("cPCP8").TEXT_SECTION_PRIMARY_TOOLBAR.key,rank:i("4Chin").TEXT_SECTION_PRIMARY_TOOLBAR_RANK[i("cPCP8").ALIGNMENT_GROUP.key]}]},{type:i("cPCP8").ALIGNMENT_MENU.type,key:i("cPCP8").ALIGNMENT_MENU.key,parents:[{type:i("cPCP8").ALIGNMENT_GROUP.type,key:i("cPCP8").ALIGNMENT_GROUP.key,rank:i("4Chin").ALIGNMENT_GROUP_RANK[i("cPCP8").ALIGNMENT_MENU.key]}],component:({children:t})=>(0,o.jsx)(B,{api:e,children:t})},{type:i("cPCP8").ALIGNMENT_MENU_SECTION.type,key:i("cPCP8").ALIGNMENT_MENU_SECTION.key,parents:[{type:i("cPCP8").ALIGNMENT_MENU.type,key:i("cPCP8").ALIGNMENT_MENU.key,rank:i("4Chin").ALIGNMENT_MENU_RANK[i("cPCP8").ALIGNMENT_MENU_SECTION.key]},...(0,D.expValEquals)("platform_editor_toolbar_aifc_responsive","isEnabled",!0)?[{type:i("cPCP8").TEXT_COLLAPSED_MENU.type,key:i("cPCP8").TEXT_COLLAPSED_MENU.key,rank:i("4Chin").TEXT_COLLAPSED_MENU_RANK[i("cPCP8").ALIGNMENT_MENU_SECTION.key]}]:[]],component:(0,D.expValEquals)("platform_editor_toolbar_aifc_responsive","isEnabled",!0)?U:void 0},...K(e)],j={align:"start"};t.exports.alignmentPlugin=({api:e})=>{let t=!!e?.toolbar,n=({editorView:t,popupsMountPoint:n,popupsBoundariesElement:a,popupsScrollableElement:i,disabled:s,isToolbarReducedSpacing:r})=>t?(0,o.jsx)(w,{api:e,editorView:t,disabled:s,popupsMountPoint:n,popupsBoundariesElement:a,popupsScrollableElement:i,isToolbarReducedSpacing:r}):null;return t?e?.toolbar?.actions.registerComponents(F(e)):e?.primaryToolbar?.actions.registerComponent({name:"alignment",component:n}),{name:"alignment",marks:()=>[{name:"alignment",mark:i("anbEX").alignment}],getSharedState(e){if(!e)return;let t=g.getState(e);return t?{align:t.align,isEnabled:t.isEnabled}:void 0},pmPlugins:()=>[{name:"alignmentPlugin",plugin:({dispatch:e})=>new(0,i("1S4f7").SafePlugin)({key:g,state:{init:(e,t)=>({align:f(t)||j.align,isEnabled:!0}),apply(t,n,a,i){let o=f(i),s=r(o)(i),l={...n,align:o,isEnabled:s};return(o!==n.align||s!==n.isEnabled)&&e(g,l),l}}})},{name:"annotationKeymap",plugin:()=>(function(e){let t={};return(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").alignLeft.common,u("start",e,i("d925B").INPUT_METHOD.SHORTCUT),t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").alignCenter.common,u("center",e,i("d925B").INPUT_METHOD.SHORTCUT),t),(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").alignRight.common,u("end",e,i("d925B").INPUT_METHOD.SHORTCUT),t),(0,i("60bKU").keymap)(t)})(e)}],pluginsOptions:{selectionToolbar:t?void 0:()=>"none"===((0,i("dh538").fg)("platform_editor_use_preferences_plugin")?e?.userPreferences?.sharedState.currentState()?.preferences?.toolbarDockingPosition:e?.selectionToolbar?.sharedState?.currentState()?.toolbarDocking)&&(0,s.editorExperiment)("platform_editor_controls","variant1",{exposure:!0})?{isToolbarAbove:!0,items:[{type:"custom",render:t=>{if(t)return(0,o.jsx)(M,{api:e,editorView:t})},fallback:[]}],rank:4,pluginName:"alignment"}:void 0},primaryToolbarComponent:e?.primaryToolbar||t?void 0:n}}}),o("cpn0f",function(t,n){var a,o,s=i("l998X");i("42omo");var r=i("1oCLl"),l=i("iu6m9"),d=((a={})[a.UPDATE_INLINE_COMMENT_STATE=0]="UPDATE_INLINE_COMMENT_STATE",a[a.SET_INLINE_COMMENT_DRAFT_STATE=1]="SET_INLINE_COMMENT_DRAFT_STATE",a[a.INLINE_COMMENT_UPDATE_MOUSE_STATE=2]="INLINE_COMMENT_UPDATE_MOUSE_STATE",a[a.INLINE_COMMENT_CLEAR_DIRTY_MARK=3]="INLINE_COMMENT_CLEAR_DIRTY_MARK",a[a.ADD_INLINE_COMMENT=4]="ADD_INLINE_COMMENT",a[a.INLINE_COMMENT_SET_VISIBLE=5]="INLINE_COMMENT_SET_VISIBLE",a[a.CLOSE_COMPONENT=6]="CLOSE_COMPONENT",a[a.SET_SELECTED_ANNOTATION=7]="SET_SELECTED_ANNOTATION",a[a.SET_HOVERED_ANNOTATION=8]="SET_HOVERED_ANNOTATION",a[a.FLUSH_PENDING_SELECTIONS=9]="FLUSH_PENDING_SELECTIONS",a[a.SET_PENDING_SELECTIONS=10]="SET_PENDING_SELECTIONS",a[a.SET_INLINE_COMMENTS_FETCHED=11]="SET_INLINE_COMMENTS_FETCHED",a),c=((o={}).INVALID="invalid",o.DISABLED="disabled",o.VALID="valid",o);let p="ak-editor-annotation",u={prefix:p,floatingComponent:`${p}-floating-component`,floatingToolbarCreateButton:`${p}-toolbar-create-button`,componentSave:`${p}-dummy-save-button`,componentClose:`${p}-dummy-close-button`};function h(e,t){return e.reduce((e,n)=>e+t(n),0)}let m=e=>{let{nodeBefore:t,nodeAfter:n}=e,a=t&&e.doc.nodeAt(Math.max(0,e.pos-t.nodeSize-1)),i=n&&e.doc.nodeAt(e.pos+n.nodeSize);return[a&&a.marks||[],i&&i.marks||[]]},f=e=>{if(!e.length)return[];let{annotation:t}=e[0].type.schema.marks;return e.filter(e=>e.type===t).map(e=>e.attrs.id)},g=(e,t)=>{let n=m(t).map(f);e.sort((e,t)=>h(n,t=>t.indexOf(e.id))-h(n,e=>e.indexOf(t.id)))},T=e=>{let t=new Set;return e.descendants(e=>(e.marks.filter(e=>"annotation"===e.type.name).filter(E).forEach(e=>t.add(e.attrs.id)),!0)),Array.from(t)},E=e=>{var t,n;let{id:a,annotationType:o}=e.attrs;return!!(t=a)&&"string"==typeof t&&!["null","undefined"].includes(t.toLowerCase())&&!!(n=o)&&"string"==typeof n&&Object.values(i("cUycv").AnnotationTypes).includes(n)},y={block:"blockCommentDecoration",inline:"inlineCommentDecoration"},_=(e,t,n="inline")=>"block"===n?i("ftzrq").Decoration.node(e,t,{class:`${i("6ESsx").BlockAnnotationSharedClassNames.draft}`},{key:y.block}):i("ftzrq").Decoration.inline(e,t,{class:`${i("6ESsx").AnnotationSharedClassNames.draft}`},{key:y.inline}),S=e=>{let t=e.map(e=>e.id).join("_");return`view-annotation-wrapper_${t}`},b=(e,t)=>{let{empty:n,$anchor:a,anchor:o}=e;if(!n||!t){if(!(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes"))return[];else if(!(e instanceof i("ks2lK").NodeSelection&&["inlineCard","emoji","date","mention","status"].includes(e.node.type.name)))return[]}let s=t.nodeAt(o),r=a.nodeBefore;if(!s&&!r||[r,s].some(e=>e?.type.name==="mediaInline"))return[];let l=t.type.schema.marks.annotation,d=s?.marks||[],c=[];if(l.isInSet(d)&&(c=d),r&&l.isInSet(r.marks)){let e=c.map(e=>e.attrs.id);c=c.concat(...r.marks.filter(t=>!e.includes(t.attrs.id)))}let p=c.filter(e=>"annotation"===e.type.name).map(e=>({id:e.attrs.id,type:e.attrs.annotationType}));return g(p,a),p},C=(e,t,n=[])=>{let{doc:a}=e,o=t?t.resolve(a):e.selection,{from:s,to:r,head:l}=o,d={from:s,to:r,head:l,isBlockNode:!1};if(o instanceof i("ks2lK").NodeSelection){let e=!1;a.nodesBetween(s,r,(t,a)=>{if(e)return!1;let i=a+t.nodeSize;if(n.includes(t.type.name))return d={from:a,to:i,head:i,isBlockNode:t.isBlock},e=!0,!1})}return d},v=new(0,i("ks2lK").PluginKey)("inlineCommentPluginKey"),I=e=>v.getState(e),N=e=>{let{from:t,to:n}=e.selection;return(0,i("bYZ53").getAnnotationIdsFromRange)({from:t,to:n},e.doc,e.schema).length},k=(e,t)=>n=>{let a={};if(e&&(a={inputMethod:t,overlap:N(n)}),(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")){let{bookmark:e}=I(n)||{};a.inlineNodeNames=(0,i("bYZ53").getRangeInlineNodeNames)({doc:n.doc,pos:C(n,e)})}return{action:e?i("d925B").ACTION.OPENED:i("d925B").ACTION.CLOSED,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:a}},x=(e,t=[])=>{let{selection:n}=e,{disallowOnWhitespace:a}=I(e)||{},o=n.empty,s=n instanceof i("ks2lK").TextSelection||n instanceof i("ks2lK").AllSelection,r=n instanceof i("ks2lK").NodeSelection&&["emoji","status","date","mention","inlineCard"].includes(n.node.type.name);if((0,i("kfJSC").currentMediaNodeWithPos)(e)?.node)return c.VALID;if(o||!(s||r))return c.INVALID;let l=A(e);return l&&n.to-n.from==1?c.INVALID:l?c.DISABLED:a&&function(e,t){let n=!1,a=e.content().content,o=!1,s=!1;return(a.descendants(e=>(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")&&["emoji","status","date","mention","inlineCard"].includes(e.type.name)?(o=!0,!1):!(e.type===t.nodes.inlineCard&&(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes"))&&((0,i("7iE7T").isText)(e,t)?((0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")&&""!==e.textContent.trim()&&(s=!0),!1):(!(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")&&""===e.textContent.trim()&&(e.eq(a.lastChild)&&!e.eq(a.firstChild)&&(0,i("7iE7T").isParagraph)(e,t)||(n=!0)),!n))),(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes"))?!o&&!s:n}(n,e.schema)||!(n instanceof i("ks2lK").NodeSelection)&&(0,i("bYZ53").isEmptyTextSelection)(n,e.schema)?c.INVALID:c.VALID},A=e=>{let{selection:t,doc:n,schema:a}=e;return!(0,i("bYZ53").canApplyAnnotationOnRange)({from:t.from,to:t.to},n,a)},O=(e,t=[])=>t.indexOf(e.type.name)>=0||"mediaSingle"===e.type.name&&t.indexOf("media")>=0;function P(e,t){if(!e.content.size)return!1;e.content.forEach(e=>{M(e,t),e.content.descendants(e=>(M(e,t),!0))})}function M(e,t){return(0,i("bYZ53").hasAnnotationMark)(e,t)&&(e.marks=e.marks.filter(e=>{if("annotation"===e.type.name){var n=e.attrs.id;let a=I(t);return!!a?.annotations&&Object.keys(a.annotations).includes(n)}return!0})),e}function w(e,t){return t.length!==e.length||t.some(t=>!e.find(e=>t.id===e.id&&t.type===e.type))}let D=(e,t=[])=>{if(t.length&&e instanceof i("ks2lK").NodeSelection){let n="mediaSingle"===e.node.type.name?e.node.firstChild:e.node,a=n?.marks.filter(e=>"annotation"===e.type.name).map(e=>({id:e.attrs.id,type:e.attrs.annotationType}))||[];return!t.some(e=>!a.find(t=>t.id===e.id&&t.type===e.type))}return!1},R=e=>{let t=I(e)?.annotations;return!!t&&Object.keys(t).filter(e=>"undefined"!==e&&!1===t[e]).length>0};function B(e,t,n,a,o,s,r){let{draftDecorationSet:l}=e;l&&t||(l=i("ftzrq").DecorationSet.empty);let d={...e,draftDecorationSet:l,isDrafting:t,targetNodeId:s};if(d.bookmark=void 0,t&&n){d.bookmark=n.selection.getBookmark();let{from:e,to:t}=C(n,d.bookmark,o),i=_(e,t,a);d.draftDecorationSet=l.add(n.doc,[i])}return d.isOpeningMediaCommentFromToolbar=r,d}let L=(e,t)=>e.getMeta("replaceDocument")?{...t,dirtyAnnotations:!0}:j(!1)(e,t),U=(e,t,n)=>{if(t.selection.empty||!n);else if(t.selection instanceof i("ks2lK").NodeSelection){let a=n?.resolve(e.doc);if(a instanceof i("ks2lK").NodeSelection){let e=t.selection.node,n=a.node;return"media"===e.type.name&&"mediaSingle"===n.type.name?!n.firstChild?.eq(e):!n.eq(e)}}return!0},K=e=>(t,n)=>{if(n.skipSelectionHandling)return{...n,skipSelectionHandling:!1,...e&&{isInlineCommentViewClosed:!1}};if(D(t.selection,n.selectedAnnotations))return{...n,...e&&{isInlineCommentViewClosed:!1}};let a=b(t.selection,t.doc);return 0===a.length?{...n,selectedAnnotations:a,isInlineCommentViewClosed:!0,selectAnnotationMethod:void 0}:w(a,n.selectedAnnotations)?{...n,selectedAnnotations:a,selectAnnotationMethod:void 0,...e&&{isInlineCommentViewClosed:!1}}:{...n,...e&&{isInlineCommentViewClosed:!1},selectAnnotationMethod:void 0}},F=e=>(t,n)=>{if(n.skipSelectionHandling)return{...n,skipSelectionHandling:!1,...e&&{isInlineCommentViewClosed:!1}};let a=b(t.selection,t.doc);return w(a,n.pendingSelectedAnnotations)?{...n,pendingSelectedAnnotations:a,pendingSelectedAnnotationsUpdateCount:n.pendingSelectedAnnotationsUpdateCount+1,...e&&{isInlineCommentViewClosed:!1}}:{...n,...e&&{isInlineCommentViewClosed:!1},selectAnnotationMethod:void 0}},j=e=>(t,n)=>n.isAnnotationManagerEnabled?F(e)(t,n):K(e)(t,n),G=(()=>{let e={};return(t,n)=>{if(t.getMeta("replaceDocument"))return{...n,dirtyAnnotations:!0};let a=j(!1)(t,n),i=new Set;t.doc.descendants(e=>{e.marks.forEach(e=>{"annotation"===e.type.name&&i.add(e.attrs.id)})});let o=Object.keys(n.annotations);if(!(i.size!==o.length||o.some(e=>!i.has(e))))return a;let s={};return o.forEach(t=>{i.has(t)||(e[t]=n.annotations[t])}),i.forEach(t=>{s[t]=n.annotations[t]??e[t]??!1}),{...a,annotations:s}}})(),{createPluginState:V,createCommand:z}=(0,i("lkJUe").pluginFactory)(v,(e,t)=>{switch(t.type){case d.SET_INLINE_COMMENTS_FETCHED:return{...e,annotationsLoaded:!0};case d.UPDATE_INLINE_COMMENT_STATE:return{...e,annotationsLoaded:!0,annotations:{...e.annotations,...t.data}};case d.INLINE_COMMENT_UPDATE_MOUSE_STATE:let n=Object.assign({},e.mouseData,t.data.mouseData);return{...e,mouseData:n};case d.SET_INLINE_COMMENT_DRAFT_STATE:return B(e,t.data.drafting,t.data.editorState,t.data.targetType,t.data.supportedBlockNodes,t.data.targetNodeId,t.data.isOpeningMediaCommentFromToolbar);case d.INLINE_COMMENT_CLEAR_DIRTY_MARK:return{...e,dirtyAnnotations:!1,annotations:{}};case d.CLOSE_COMPONENT:return{...e,isInlineCommentViewClosed:!0,isDrafting:!1,isOpeningMediaCommentFromToolbar:!1,...(0,i("dh538").fg)("platform_editor_annotation_selected_annotation")&&{selectedAnnotations:[]},...e.isAnnotationManagerEnabled&&{selectedAnnotations:[]}};case d.ADD_INLINE_COMMENT:let a=B(e,t.data.drafting,t.data.editorState);return{...a,selectedAnnotations:[...a.selectedAnnotations,...t.data.selectedAnnotations],annotations:{...e.annotations,...t.data.inlineComments},isInlineCommentViewClosed:!1,selectAnnotationMethod:void 0,...e.isAnnotationManagerEnabled&&{skipSelectionHandling:!0}};case d.INLINE_COMMENT_SET_VISIBLE:let{isVisible:o}=t.data;if(o===e.isVisible)return e;return{...o?e:B(e,!1),isVisible:o};case d.SET_SELECTED_ANNOTATION:return{...e,selectedAnnotations:[...t.data.selectedAnnotations],selectAnnotationMethod:t.data.selectAnnotationMethod,skipSelectionHandling:!0,isInlineCommentViewClosed:!1,isOpeningMediaCommentFromToolbar:t.data.isOpeningMediaCommentFromToolbar};case d.SET_HOVERED_ANNOTATION:return{...e,hoveredAnnotations:[...t.data.hoveredAnnotations],skipSelectionHandling:!0,isInlineCommentViewClosed:!1};case d.FLUSH_PENDING_SELECTIONS:return{...e,selectedAnnotations:t.data.canSetAsSelectedAnnotations?[...e.pendingSelectedAnnotations]:e.selectedAnnotations,pendingSelectedAnnotations:[],isInlineCommentViewClosed:!1};case d.SET_PENDING_SELECTIONS:return{...e,pendingSelectedAnnotations:[...t.data.selectedAnnotations],pendingSelectedAnnotationsUpdateCount:e.pendingSelectedAnnotationsUpdateCount+1,skipSelectionHandling:!0,isInlineCommentViewClosed:!1};default:return e}},{onSelectionChanged:j(!0),onDocChanged:(e,t)=>(0,r.expValEquals)("platform_editor_annotations_sync_on_docchange","isEnabled",!0)?G(e,t):L(e,t),mapping:(e,t,n)=>{let{draftDecorationSet:a,bookmark:o}=t,s=i("ftzrq").DecorationSet.empty,r,l=!1;return(a&&(s=a.map(e.mapping,e.doc)),!(s.find(void 0,void 0,e=>Object.values(y).includes(e.key)).length>0)&&U(e,n,o))?{...t,draftDecorationSet:s,bookmark:void 0}:(o&&(r=o.map(e.mapping)),r===o&&s===a)?t:{...t,draftDecorationSet:s,bookmark:r}}}),H=e=>e instanceof i("aXG5V").AddMarkStep&&"annotation"===e.mark.type.name,q=(e,t)=>(n,a)=>{let{bookmark:o}=I(a)||{},s=a.schema.marks.annotation.create({id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT}),{from:r,to:l,head:d,isBlockNode:c}=C(a,o,t),p=n;if(c)(p=p.addNodeMark(r,s)).setSelection(i("ks2lK").NodeSelection.create(p.doc,r));else{let e=(0,i("b167b").applyMarkOnRange)(r,l,!1,s,n),t=e.steps.reverse().find(H),a=r===d?t?.from:t?.to;e.setSelection(i("ks2lK").TextSelection.create(e.doc,a??d))}return p},W=e=>(t,n=i("d925B").INPUT_METHOD.TOOLBAR)=>(a,i)=>{let o=k(t,n)(i);return e?.attachAnalyticsEvent(o)(a),a},X=e=>(t,n)=>{let a={action:i("d925B").ACTION.INSERTED,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,eventType:i("d925B").EVENT_TYPE.TRACK,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,attributes:{}};if((0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")){let{bookmark:e}=I(n)||{};a.attributes.inlineNodeNames=(0,i("bYZ53").getRangeInlineNodeNames)({doc:n.doc,pos:C(n,e)})}return e?.attachAnalyticsEvent(a)(t),t};var Y={addInlineComment:(e,t)=>(n,a)=>(o,s)=>{let r=q(n,a)(o,s);t?.editorViewModeEffects?.actions.applyViewModeStepAt(r),r=X(e)(r,s),r=W(e)(!1,i("d925B").INPUT_METHOD.TOOLBAR)(r,s);let l=I(s);return l?.featureFlagsPluginState?.commentsOnMediaAutoscrollInEditor&&r.setMeta("scrollIntoView",!1),r},handleDraftState:e=>(t,n=i("d925B").INPUT_METHOD.TOOLBAR)=>(a,i)=>{let o=W(e)(t,n)(a,i),s=I(i);return s?.featureFlagsPluginState?.commentsOnMediaAutoscrollInEditor&&o.setMeta("scrollIntoView",!1),o},addResolveAnalytics:e=>t=>(n,a)=>{let o={action:i("d925B").ACTION.RESOLVED,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{method:t}};return e?.attachAnalyticsEvent(o)(n),n},addPreemptiveGateErrorAnalytics:e=>t=>(n,a)=>{let o={action:i("d925B").ACTION.ERROR,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{errorReason:t}};return e?.attachAnalyticsEvent(o)(n),n},addDeleteAnalytics:e=>(t,n)=>{let a={action:i("d925B").ACTION.DELETED,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{}};return e?.attachAnalyticsEvent(a)(t),t}};let $=(e,t)=>e?.userIntent?.commands?.setCurrentUserIntent("commenting")({tr:t}),J=(e,t)=>e?.userIntent?.commands?.setCurrentUserIntent("default")({tr:t}),Z=e=>(t,n)=>{let a={type:d.UPDATE_INLINE_COMMENT_STATE,data:t},o=Object.values(t).every(e=>e),s=(e,t)=>n===i("55QXP").RESOLVE_METHOD.CONSUMER?e.setMeta("scrollIntoView",!1):e;return n&&o?z(a,(t,a)=>s(Y.addResolveAnalytics(e)(n)(t,a),a)):z(a,s)},Q=()=>z({type:d.CLOSE_COMPONENT}),ee=()=>z({type:d.INLINE_COMMENT_CLEAR_DIRTY_MARK}),et=()=>z({type:d.SET_INLINE_COMMENTS_FETCHED}),en=e=>(t,n)=>{let a={type:d.FLUSH_PENDING_SELECTIONS,data:{canSetAsSelectedAnnotations:t}};return n?z(a,(t,a)=>Y.addPreemptiveGateErrorAnalytics(e)(n)(t,a)):z(a)},ea=e=>z({type:d.SET_PENDING_SELECTIONS,data:{selectedAnnotations:[{id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT}]}}),ei=(e,t=[],n,a)=>{let{tr:o,selection:s}=n;if(s instanceof i("ks2lK").NodeSelection&&O(s.node,t)){let{$from:t}=s,r=s.node,l=t.start();r.type===n.schema.nodes.mediaSingle&&r.firstChild&&(r=r.firstChild,l+=1);let{annotation:d}=n.schema.marks;return!!r.marks.some(e=>e.type===d)&&(o.removeNodeMark(l,d.create({id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT})),a&&a(o),!0)}return!1},eo=(e,t=[])=>(n,a)=>{let{tr:o,selection:{$from:s}}=n;if(ei(e,t,n,a))return!0;let{annotation:r}=n.schema.marks;return!!s.marks().some(e=>e.type===r)&&(o.removeMark(s.start(),s.end(),r.create({id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT})),a&&a(o),!0)},es=e=>(t,n=[])=>(a,i)=>{let{tr:o}=a;return a.doc.descendants((e,i)=>{if("mediaInline"===e.type.name)return!1;let s=e.isBlock&&n?.includes(e.type.name);e.marks.filter(e=>e.type===a.schema.marks.annotation&&e.attrs.id===t).forEach(t=>{s?o.removeNodeMark(i,t):o.removeMark(i,i+e.nodeSize,t)})}),!!i&&(i(Y.addDeleteAnalytics(e)(o,a)),!0)},er=(e,t,n,a,i)=>o=>(!e||x(o)===c.VALID)&&{type:d.SET_INLINE_COMMENT_DRAFT_STATE,data:{drafting:e,editorState:o,targetType:t,supportedBlockNodes:a,targetNodeId:n,isOpeningMediaCommentFromToolbar:i}},el=(e=[])=>(t,n,a)=>(i,o)=>{let s=I(i),{annotation:r}=i.schema.marks;if(t&&t.isBlock&&e.includes(t.type.name)){let e=(t?.marks||[]).filter(e=>e.type===r&&!s?.annotations[e.attrs.id]).map(e=>({id:e.attrs.id,type:e.attrs.annotationType}));if(e.length&&o)return o(i.tr.setMeta(v,{type:d.SET_SELECTED_ANNOTATION,data:{selectedAnnotations:e,selectAnnotationMethod:n,isOpeningMediaCommentFromToolbar:a}})),!0}return!1},ed=(e,t=[],n)=>(a,o=i("d925B").INPUT_METHOD.TOOLBAR,s="inline",r,l)=>{let d=er(a,s,r,t,l);return n?.toolbar?(t,i)=>{let s=Y.handleDraftState(e)(a,o)(t.tr,t),r=d(t);return!!s&&!!r&&(s.setMeta(v,r),a?$(n,s):J(n,s),i&&i(s),!0)}:z(d,Y.handleDraftState(e)(a,o))},ec=(e,t)=>(n,a)=>{let o=e=>({type:d.ADD_INLINE_COMMENT,data:{drafting:!1,inlineComments:{[n]:!1},selectedAnnotations:[{id:n,type:i("cUycv").AnnotationTypes.INLINE_COMMENT}],editorState:e}});return t?.toolbar?(i,s)=>{let r=Y.addInlineComment(e,t)(n,a)(i.tr,i);return r.setMeta(v,o(i)),J(t,r),!!s&&(s(r),!0)}:z(o,Y.addInlineComment(e,t)(n,a))},ep=e=>z({type:d.INLINE_COMMENT_UPDATE_MOUSE_STATE,data:{mouseData:e}}),eu=e=>z({type:d.SET_SELECTED_ANNOTATION,data:{selectedAnnotations:[{id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT}]}}),eh=e=>z({type:d.SET_HOVERED_ANNOTATION,data:{hoveredAnnotations:[{id:e,type:i("cUycv").AnnotationTypes.INLINE_COMMENT}]}}),em=(e,t)=>(n,a=i("cUycv").AnnotationTypes.INLINE_COMMENT,o)=>(s,r)=>{let{bookmark:l}=I(s)||{};return!!l&&!!r&&a===i("cUycv").AnnotationTypes.INLINE_COMMENT&&ec(e,t)(n,o)(s,r)},ef=e=>z({type:d.INLINE_COMMENT_SET_VISIBLE,data:{isVisible:e}}),eg={...i("cUycv").annotation,toDOM:e=>["span",{id:e.attrs.id,annotationType:e.attrs.annotationType,"data-mark-type":"annotation","data-mark-annotation-type":e.attrs.annotationType,"data-id":e.attrs.id},0]},eT=(e,t,n)=>{if(e)return t?i("6ESsx").AnnotationSharedClassNames.focus:n?i("6ESsx").AnnotationSharedClassNames.hover:i("6ESsx").AnnotationSharedClassNames.blur},eE=(e,t)=>{if(e)return t?i("6ESsx").BlockAnnotationSharedClassNames.focus:i("6ESsx").BlockAnnotationSharedClassNames.blur};var ey=i("8m4tT");let e_="draft-not-started",eS="draft-in-progress",eb="id-not-valid",eC=(e,t)=>{let n;try{n=(0,ey.findDomRefAtPos)(t,e.domAtPos.bind(e))}catch(e){console.warn(e);return}return n},ev=(e,t)=>()=>{let{isDrafting:t,draftDecorationSet:n}=v.getState(e.state)||{};if(t)return!1;let a=n?.find();return!a?.length&&x(e.state)===c.VALID},eI=(e,t)=>()=>{let{isDrafting:n,selectedAnnotations:a}=v.getState(e.state)||{};if(n)return{success:!1,reason:eS};a?.length&&(Q()(e.state,e.dispatch),a?.forEach(n=>{t.annotationManager?.emit({name:"annotationSelectionChanged",data:{annotationId:n.id,isSelected:!1,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(e.state,n.id)??[]}})})),ed(t.editorAnalyticsAPI,void 0,t.api)(!0)(e.state,e.dispatch);let{draftDecorationSet:o}=v.getState(e.state)||{},s=o?.find();if(!s?.length)return{success:!1,reason:"invalid-range"};let r=s[0].from,l=eC(e,r),d=(0,i("bYZ53").getRangeInlineNodeNames)({doc:e.state.doc,pos:{from:r,to:s[s.length-1].to}})??[];return t.annotationManager?.emit({name:"draftAnnotationStarted",data:{targetElement:l,actionResult:void 0,inlineNodeTypes:d}}),{success:!0,targetElement:l,actionResult:void 0,inlineNodeTypes:d}},eN=(e,t)=>()=>{let{isDrafting:n,draftDecorationSet:a}=v.getState(e.state)||{};if(!n)return{success:!1,reason:e_};let i=a?.find();return i?.length?(ed(t.editorAnalyticsAPI,void 0,t.api)(!1)(e.state,e.dispatch),e.hasFocus()||e.focus(),{success:!0}):{success:!1,reason:e_}},ek=(e,t)=>n=>{let{isDrafting:a,draftDecorationSet:o,bookmark:s}=v.getState(e.state)||{};if(!a)return{success:!1,reason:e_};let r=o?.find();if(!r?.length||!s)return{success:!1,reason:"range-no-longer-exists"};let l=r[0].from;em(t.editorAnalyticsAPI,t.api)(n,i("cUycv").AnnotationTypes.INLINE_COMMENT,t.provider.supportedBlockNodes)(e.state,e.dispatch),e.hasFocus()||e.focus();let d=eC(e,l);return t.annotationManager?.emit({name:"annotationSelectionChanged",data:{annotationId:n,isSelected:!0,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(e.state,n)??[]}}),{success:!0,targetElement:d,actionResult:void 0}},ex=(e,t)=>()=>{let{isDrafting:t,draftDecorationSet:n}=v.getState(e.state)||{};if(!t)return{success:!1,reason:e_};let a=n?.find();if(!a?.length)return{success:!1,reason:e_};let o=a[0].from,s=eC(e,o);return{success:!0,inlineNodeTypes:(0,i("bYZ53").getRangeInlineNodeNames)({doc:e.state.doc,pos:{from:o,to:a[a.length-1].to}})??[],targetElement:s,actionResult:void 0}},eA=(e,t)=>(n,a)=>{let{annotations:o,isDrafting:s,selectedAnnotations:r}=v.getState(e.state)||{};if(s)return{success:!1,reason:eS};if(!o?.hasOwnProperty(n))return{success:!1,reason:eb};let l=-1!==(r?.findIndex(e=>e.id===n)??-1);return a!==l&&(l&&!a?(Q()(e.state,e.dispatch),t.annotationManager?.emit({name:"annotationSelectionChanged",data:{annotationId:n,isSelected:!1,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(e.state,n)??[]}})):!l&&a&&(eu(n)(e.state,e.dispatch),r?.forEach(a=>{a.id!==n&&t.annotationManager?.emit({name:"annotationSelectionChanged",data:{annotationId:a.id,isSelected:!1,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(e.state,a.id)??[]}})}),t.annotationManager?.emit({name:"annotationSelectionChanged",data:{annotationId:n,isSelected:!0,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(e.state,n)??[]}}))),{success:!0,isSelected:a}},eO=(e,t)=>(t,n)=>{let{annotations:a,hoveredAnnotations:i}=v.getState(e.state)||{};if(!a?.hasOwnProperty(t))return{success:!1,reason:eb};let o=-1!==(i?.findIndex(e=>e.id===t)??-1);return n!==o&&(o&&!n?eh("")(e.state,e.dispatch):!o&&n&&eh(t)(e.state,e.dispatch)),{success:!0,isHovered:n}},eP=(e,t)=>n=>{let{annotations:a}=v.getState(e.state)||{};return a?.hasOwnProperty(n)?(es(t.editorAnalyticsAPI)(n,t.provider.supportedBlockNodes)(e.state,e.dispatch),{success:!0,actionResult:void 0}):{success:!1,reason:eb}};i("42omo");let eM=e=>{let{schema:t}=e,{annotation:n}=t.marks;return Object.keys(t.nodes).reduce((e,a)=>{let i=t.nodes[a];return i.allowsMarkType(n)&&e.push(i),e},[])},ew=({state:e,bookmark:t})=>{if(!t)return!1;let{tr:n}=e,a=t.resolve(n.doc);return a.to===n.selection.to&&a.from===n.selection.from},eD=(e,t)=>{let n=!!(t?.userIntent&&(0,r.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0));return{items:[],nodeType:eM(e),title:"Annotation suppressed toolbar",__suppressAllToolbars:!n||void 0}},eR=t=>({state:n,intl:a,isToolbarAbove:o=!1,_supportedNodes:r=[],api:l,createCommentExperience:d,annotationManager:p,onCommentButtonMount:h,getCanAddComments:m=()=>!0,contentType:f})=>{let g=x(n);if((0,i("kfJSC").currentMediaNodeWithPos)(n)||g===c.INVALID)return;let T=a.formatMessage(i("ahUGI").annotationMessages.createComment),E=a.formatMessage((0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")?i("ahUGI").annotationMessages.createCommentDisabled:i("ahUGI").annotationMessages.createCommentInvalid),y=m(),_=!y||g===c.DISABLED,S=y?E:a.formatMessage(i("ahUGI").annotationMessages.noPermissionToAddComment,{contentType:f}),b={type:"button",showTitle:!0,disabled:_||(0,i("91bcx").isOfflineMode)(l?.connectivity?.sharedState?.currentState()?.mode),testId:u.floatingToolbarCreateButton,interactionName:"start-inline-comment-action",icon:e(i("1yB28")),iconFallback:e(i("1yB28")),tooltipContent:_?S:(0,s.jsx)(i("hgeg8").ToolTipContent,{description:T,keymap:i("hgeg8").addInlineComment}),title:T,onMount:()=>{(0,i("dh538").fg)("confluence_frontend_preload_inline_comment_editor")&&h&&h();let e=I(n),a=((0,i("bYZ53").getRangeInlineNodeNames)({doc:n.doc,pos:C(n,e?.bookmark)})??[]).filter(e=>"text"!==e).length>0;t&&t.fireAnalyticsEvent({action:i("d925B").ACTION.VIEWED,actionSubject:i("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.UI,attributes:{isNonTextInlineNodeInludedInComment:a,isDisabled:g===c.DISABLED,inputMethod:i("d925B").INPUT_METHOD.FLOATING_TB,mode:i("e2wMq").MODE.EDITOR}})},onClick:(e,n)=>(t?.fireAnalyticsEvent({action:i("d925B").ACTION.CLICKED,actionSubject:i("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.CREATE_INLINE_COMMENT_FROM_HIGHLIGHT_ACTIONS_MENU,eventType:i("d925B").EVENT_TYPE.UI,attributes:{source:"highlightActionsMenu",pageMode:"edit"}}),p)?(p.checkPreemptiveGate().then(e=>{if(e){d?.start({attributes:{pageClass:"editor",commentType:"inline",entryPoint:"highlightActions"}}),d?.initExperience.start();let e=p.startDraft();e.success||t?.fireAnalyticsEvent({action:i("d925B").ACTION.ERROR,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{errorReason:`toolbar-start-draft-failed/${e.reason}`}})}}).catch(()=>{t?.fireAnalyticsEvent({action:i("d925B").ACTION.ERROR,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{errorReason:"toolbar-start-draft-preemptive-gate-error"}})}),!0):(d?.start({attributes:{pageClass:"editor",commentType:"inline",entryPoint:"highlightActions"}}),d?.initExperience.start(),ed(t)(!0)(e,n)),supportsViewMode:!0},v=a.formatMessage(i("ahUGI").annotationMessages.toolbar),N=(o?i("lNDSG").calculateToolbarPositionAboveSelection:i("lNDSG").calculateToolbarPositionTrackHead)(v);return{title:v,nodeType:eM(n),items:[b],onPositionCalculated:N,pluginName:"annotation"}},eB=async(e,t)=>{if(!e||!e.getState)return{};let n=await e.getState(t),a={};return n.forEach(e=>{e.annotationType===i("cUycv").AnnotationTypes.INLINE_COMMENT&&(a[e.id]=e.state.resolved)}),a},eL=async(e,t,n,a)=>{let o=await eB(e,t);if(0===Object.keys(o).length){let{annotationsLoaded:e}=I(n.state)||{};!e&&(0,i("dh538").fg)("confluence_frontend_new_dangling_comments_ux")&&et()(n.state,n.dispatch);return}n.dispatch&&Z(a)(o)(n.state,n.dispatch)},eU=(e=!1,t,n=!1)=>({annotationsLoaded:!1,annotations:{},selectedAnnotations:[],hoveredAnnotations:[],mouseData:{isSelecting:!1},disallowOnWhitespace:e,isInlineCommentViewClosed:!1,isVisible:!0,skipSelectionHandling:!1,featureFlagsPluginState:t,isDrafting:!1,pendingSelectedAnnotations:[],pendingSelectedAnnotationsUpdateCount:0,isAnnotationManagerEnabled:n}),eK=(e,t)=>()=>{ep({isSelecting:!0})(e,t)},eF=e=>(t,n)=>a=>{Z(e)({[a]:!0},i("55QXP").RESOLVE_METHOD.CONSUMER)(t,n)},ej=e=>(t,n)=>a=>{Z(e)({[a]:!1})(t,n)},eG=(e,t)=>n=>{let{mouseData:a}=I(e)||{};a?.isSelecting&&ep({isSelecting:!1})(e,t)},eV=e=>t=>{let{state:n,dispatch:a}=e;ef(t)(n,a),t&&e.focus()},ez=e=>{let{provider:t,featureFlagsPluginState:n,annotationManager:a}=e;return new(0,i("1S4f7").SafePlugin)({key:v,state:V(e.dispatch,eU(t.disallowOnWhitespace,n,!!a)),view(n){let o,s,r,l,d,c,p,u;a&&(o=ev(n,e),s=eI(n,e),r=eN(n,e),l=ek(n,e),d=ex(n,e),c=eA(n,e),p=eO(n,e),u=eP(n,e),a.hook("allowAnnotation",o),a.hook("startDraft",s),a.hook("clearDraft",r),a.hook("applyDraft",l),a.hook("getDraft",d),a.hook("setIsAnnotationSelected",c),a.hook("setIsAnnotationHovered",p),a.hook("clearAnnotation",u)),eL(t,T(n.state.doc),n,e.editorAnalyticsAPI);let h=t=>eF(e.editorAnalyticsAPI)(n.state,n.dispatch)(t),m=t=>ej(e.editorAnalyticsAPI)(n.state,n.dispatch)(t),f=e=>eG(n.state,n.dispatch)(e),g=e=>eV(n)(e),E=e=>{e?eu(e)(n.state,n.dispatch):Q()(n.state,n.dispatch)},y=e=>{e?eh(e)(n.state,n.dispatch):Q()(n.state,n.dispatch)},_=()=>{eh("")(n.state,n.dispatch)},S=()=>{Q()(n.state,n.dispatch)},{updateSubscriber:b}=t;b&&b.on("resolve",h).on("delete",h).on("unresolve",m).on("create",m).on("setvisibility",g).on("setselectedannotation",E).on("sethoveredannotation",y).on("removehoveredannotation",_).on("closeinlinecomment",S),n.root.addEventListener("mouseup",f);let C=!1;return{update(o,s){let{selectedAnnotations:r,annotations:l,isDrafting:d,bookmark:c}=I(o.state)||{},{selectedAnnotations:p}=I(s)||{},u=r&&0!==r.length&&r[0].id?r[0].id:void 0;u&&u!==p?.[0]?.id&&l&&!1===l[u]&&(e.selectCommentExperience?.selectAnnotation.complete(u),e.viewInlineCommentTraceUFOPress?.());let{api:h}=e;if(d&&!o.state.selection.eq(s.selection)&&h?.toolbar&&h?.core.actions.execute(({tr:e})=>(ew({state:o.state,bookmark:c})?$(h,e):J(h,e),e)),a){let{pendingSelectedAnnotations:t,pendingSelectedAnnotationsUpdateCount:r}=I(o.state)||{},{pendingSelectedAnnotationsUpdateCount:l}=I(s)||{};!C&&r!==l&&t?.length&&(C=!0,a.checkPreemptiveGate().then(t=>{let{isDrafting:s,pendingSelectedAnnotations:r,selectedAnnotations:l}=I(o.state)||{};t?(s&&ed(e.editorAnalyticsAPI,void 0,e.api)(!1)(o.state,o.dispatch),en(e.editorAnalyticsAPI)(!0)(o.state,o.dispatch),l?.filter(e=>r?.findIndex(t=>t.id===e.id)===-1).forEach(e=>{a.emit({name:"annotationSelectionChanged",data:{annotationId:e.id,isSelected:!1,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(n.state,e.id)??[]}})}),r?.forEach(({id:e})=>{a.emit({name:"annotationSelectionChanged",data:{annotationId:e,isSelected:!0,inlineNodeTypes:(0,i("bYZ53").getAnnotationInlineNodeTypes)(o.state,e)??[]}})})):en(e.editorAnalyticsAPI)(!1)(o.state,o.dispatch)}).catch(t=>{en(e.editorAnalyticsAPI)(!1,"pending-selection-preemptive-gate-error")(o.state,o.dispatch)}).finally(()=>{C=!1}))}let{dirtyAnnotations:m}=I(o.state)||{};m&&(ee()(o.state,o.dispatch),eL(t,T(o.state.doc),o,e.editorAnalyticsAPI))},destroy(){n.root.removeEventListener("mouseup",f),b&&b.off("resolve",h).off("delete",h).off("unresolve",m).off("create",m).off("setvisibility",g).off("setselectedannotation",E).off("sethoveredannotation",y).off("removehoveredannotation",_).off("closeinlinecomment",S),a&&(a.unhook("allowAnnotation",o),a.unhook("startDraft",s),a.unhook("clearDraft",r),a.unhook("applyDraft",l),a.unhook("getDraft",d),a.unhook("setIsAnnotationSelected",c),a.unhook("setIsAnnotationHovered",p),a.unhook("clearAnnotation",u))}}},props:{handleDOMEvents:{mousedown:e=>{let t=I(e.state);return t?.mouseData.isSelecting||eK(e.state,e.dispatch)(),!1},dragstart:(e,t)=>eG(e.state,e.dispatch)(t),click:(e,t)=>{if(!(t.target instanceof HTMLElement))return!1;let n=t.target.closest("[data-id]")?.getAttribute("data-id");if(!n)return!1;let i=I(e.state);if(i?.selectedAnnotations?.some(e=>e.id===n)&&!i?.isInlineCommentViewClosed)return!1;let{annotations:o}=i||{};if(!(o&&!1===o[n]))return!1;if(a){if(i?.pendingSelectedAnnotations?.some(e=>e.id===n))return!1;ea(n)(e.state,e.dispatch)}else eu(n)(e.state,e.dispatch);return!0}},decorations(e){let{draftDecorationSet:n,annotations:a,selectedAnnotations:o,isVisible:s,isInlineCommentViewClosed:r,hoveredAnnotations:l}=I(e)||{},d=n??i("ftzrq").DecorationSet.empty,c=[];return e.doc.descendants((n,d)=>{if("mediaInline"===n.type.name)return!1;let p=n.isBlock&&t.supportedBlockNodes?.includes(n.type.name);n.marks.filter(t=>t.type===e.schema.marks.annotation).forEach(e=>{if(s){let t=!!a&&!1===a[e.attrs.id],s=!r&&!!o?.some(t=>t.id===e.attrs.id),u=!r&&!!l?.some(t=>t.id===e.attrs.id);p?c.push(i("ftzrq").Decoration.node(d,d+n.nodeSize,{class:`${eE(t,s)} ${t}`},{key:y.block})):(0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")?n.isText?c.push(i("ftzrq").Decoration.inline(d,d+n.nodeSize,{class:`${eT(t,s,u)} ${t}`,nodeName:"span"})):c.push(i("ftzrq").Decoration.node(d,d+n.nodeSize,{class:`${eT(t,s,u)} ${t}`},{key:y.block})):c.push(i("ftzrq").Decoration.inline(d,d+n.nodeSize,{class:`${eT(t,s,u)} ${t}`,nodeName:"span"}))}})}),d=d.add(e.doc,c)}}})};var eH=i("42omo");class eq extends e(eH).PureComponent{componentDidMount(){let{onViewed:e}=this.props;e&&e()}render(){return this.props.children}}let eW=e=>{let{$from:t,from:n}=e,a=t.index();return!(a<t.parent.childCount&&t.parent.child(a))&&t.nodeBefore&&t.nodeBefore.isText&&t.nodeBefore.marks.find(e=>"annotation"===e.type.name)?n-1:n},eX=e=>({annotations:e.annotationState?.annotations,bookmark:e.annotationState?.bookmark,isInlineCommentViewClosed:e.annotationState?.isInlineCommentViewClosed,isOpeningMediaCommentFromToolbar:e.annotationState?.isOpeningMediaCommentFromToolbar,selectAnnotationMethod:e.annotationState?.selectAnnotationMethod,selectedAnnotations:e.annotationState?.selectedAnnotations,isAnnotationManagerEnabled:e.annotationState?.isAnnotationManagerEnabled});function eY({providers:e,editorView:t,editorAnalyticsAPI:n,editorAPI:a,dispatchAnalyticsEvent:o}){let r,{inlineComment:d}=e,{state:c,dispatch:p}=t,h=(0,eH.useRef)(),{createComponent:m,viewComponent:f}=d,{annotations:g,bookmark:E,isInlineCommentViewClosed:y,isOpeningMediaCommentFromToolbar:_,selectAnnotationMethod:b,selectedAnnotations:C,isAnnotationManagerEnabled:v}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(a,["annotation"],eX),I=T(t.state.doc),N=E?E.resolve(c.doc):c.selection,k=eW(N);try{r=(0,ey.findDomRefAtPos)(k,t.domAtPos.bind(t))}catch(e){console.warn(e),o&&o({action:i("d925B").ACTION.ERRORED,actionSubject:i("d925B").ACTION_SUBJECT.CONTENT_COMPONENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{component:i("d925B").CONTENT_COMPONENT.INLINE_COMMENT,selection:N.toJSON(),position:k,docSize:t.state.doc.nodeSize,error:e.toString()}})}let x=(0,i("b3YrF").useSharedPluginStateSelector)(a,"connectivity.mode",{disabled:(0,l.editorExperiment)("platform_editor_offline_editing_web",!1)});if(!r)return null;if(E){if(!m)return null;let e=C?.[0]?.id,o=e!==h.current;o&&(h.current=e);let l=(0,i("bYZ53").getRangeInlineNodeNames)({doc:c.doc,pos:N}),p=c.doc.textBetween(N.from,N.to);return(0,s.jsx)("div",{"data-testid":u.floatingComponent,"data-editor-popup":"true",children:(0,s.jsx)(m,{dom:r,textSelection:p,wasNewAnnotationSelected:!!e&&o,onCreate:e=>{if(!v){let o=em(n,a)(e,i("cUycv").AnnotationTypes.INLINE_COMMENT,d.supportedBlockNodes)(t.state,t.dispatch);if(t.hasFocus()||t.focus(),!o)throw Error("Failed to create annotation")}},onClose:()=>{!v&&(ed(n,void 0,a)(!1)(t.state,t.dispatch),t.hasFocus()||t.focus())},inlineNodeTypes:l,isOpeningMediaCommentFromToolbar:_,isOffline:(0,i("91bcx").isOfflineMode)(x)})})}let A=C?.filter(e=>g&&!1===g[e.id])||[];return f&&0!==A.length?y||!C?null:(0,s.jsx)(eq,{"data-editor-popup":"true","data-testid":u.floatingComponent,onViewed:()=>{o&&o({action:i("d925B").ACTION.VIEWED,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{overlap:A.length?A.length-1:0,targetNodeType:t.state.doc.nodeAt(k)?.type.name,method:b}})},children:(0,s.jsx)(f,{annotationsList:I,annotations:A,getInlineNodeTypes:e=>(0,i("bYZ53").getAnnotationInlineNodeTypes)(t.state,e),dom:r,onDelete:e=>eo(e,d.supportedBlockNodes)(t.state,p),onResolve:e=>Z(n)({[e]:!0},i("55QXP").RESOLVE_METHOD.COMPONENT)(t.state,t.dispatch),onClose:()=>{Q()(t.state,t.dispatch)},isOpeningMediaCommentFromToolbar:_,isOffline:(0,i("91bcx").isOfflineMode)(x)})},S(A)):null}i("42omo"),i("42omo");let e$=({state:e,api:t,canAddComments:n})=>{let a=e?x(e):c.INVALID;return!n||a===c.DISABLED||(0,i("91bcx").isOfflineMode)(t?.connectivity?.sharedState?.currentState()?.mode)},eJ=({state:e,isVisible:t,annotationSelectionType:n})=>{let a=!!e&&(0,i("kfJSC").currentMediaNodeWithPos)(e),o=!1;return(0,r.expValEquals)("platform_editor_toolbar_aifc_patch_4","isEnabled",!0)&&e&&(o=v.getState(e)?.isDrafting||!1),!o&&!a&&n!==c.INVALID&&!!t},eZ=({api:e})=>{e.analytics?.actions.fireAnalyticsEvent({action:i("d925B").ACTION.CLICKED,actionSubject:i("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.CREATE_INLINE_COMMENT_FROM_HIGHLIGHT_ACTIONS_MENU,eventType:i("d925B").EVENT_TYPE.UI,attributes:{source:"highlightActionsMenu",pageMode:"edit"}})},eQ=({api:e,errorReason:t})=>{e.analytics?.actions?.fireAnalyticsEvent({action:i("d925B").ACTION.ERROR,actionSubject:i("d925B").ACTION_SUBJECT.ANNOTATION,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{errorReason:t}})},e0=({api:e,isNonTextInlineNodeInludedInComment:t,annotationSelectionType:n})=>{e?.analytics?.actions.fireAnalyticsEvent({action:i("d925B").ACTION.VIEWED,actionSubject:i("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:i("d925B").ACTION_SUBJECT_ID.INLINE_COMMENT,eventType:i("d925B").EVENT_TYPE.UI,attributes:{isNonTextInlineNodeInludedInComment:t,isDisabled:n===c.DISABLED,inputMethod:i("d925B").INPUT_METHOD.FLOATING_TB,mode:i("e2wMq").MODE.EDITOR}})},e1=({annotationProviders:e,api:t,state:n,dispatch:a})=>{let i=e?.annotationManager;return i?(i.checkPreemptiveGate().then(n=>{if(n){e.createCommentExperience?.start({attributes:{pageClass:"editor",commentType:"inline",entryPoint:"highlightActions"}}),e.createCommentExperience?.initExperience.start();let n=i.startDraft();n.success||eQ({api:t,errorReason:`toolbar-start-draft-failed/${n.reason}`})}}).catch(()=>{eQ({api:t,errorReason:"toolbar-start-draft-preemptive-gate-error"})}),!0):(e?.createCommentExperience?.start({attributes:{pageClass:"editor",commentType:"inline",entryPoint:"highlightActions"}}),e?.createCommentExperience?.initExperience.start(),ed(t?.analytics?.actions,void 0,t)(!0)(n,a))},e5=({state:e,annotationProviders:t,api:n,annotationSelectionType:a,bookmark:o})=>{(0,eH.useEffect)(()=>{e&&(t?.inlineComment&&(0,i("dh538").fg)("confluence_frontend_preload_inline_comment_editor")&&t.inlineComment.onCommentButtonMount?.(),e0({api:n,isNonTextInlineNodeInludedInComment:((0,i("bYZ53").getRangeInlineNodeNames)({doc:e.doc,pos:C(e,o)})??[]).filter(e=>"text"!==e).length>0,annotationSelectionType:a}))},[])},e2=({api:t,annotationProviders:n})=>{let a=(0,i("b3YrF").useSharedPluginStateSelector)(t,"annotation.isVisible"),o=(0,i("b3YrF").useSharedPluginStateSelector)(t,"annotation.bookmark"),{editorView:r}=(0,i("gzUv9").useEditorToolbar)(),l=r?.state?x(r.state):c.INVALID,{getCanAddComments:d,contentType:p}=n?.inlineComment??{};e5({state:r?.state,annotationProviders:n,api:t,annotationSelectionType:l,bookmark:o});let h=(0,i("8C5kA").default)();if(!eJ({state:r?.state,isVisible:a,annotationSelectionType:l}))return null;let m=!d||d(),f=h.formatMessage(i("ahUGI").annotationMessages.createComment),g=h.formatMessage((0,i("dh538").fg)("editor_inline_comments_on_inline_nodes")?i("ahUGI").annotationMessages.createCommentDisabled:i("ahUGI").annotationMessages.createCommentInvalid),T=h.formatMessage(i("ahUGI").annotationMessages.noPermissionToAddComment,{contentType:p}),E=e$({state:r?.state,api:t,canAddComments:m});return(0,s.jsx)(i("iIVVb").ToolbarTooltip,{content:E?m?g:T:(0,s.jsx)(i("hgeg8").ToolTipContent,{description:f,keymap:i("hgeg8").addInlineComment}),children:(0,s.jsx)(i("7ERUE").ToolbarButton,{iconBefore:(0,s.jsx)(e(i("1yB28")),{label:"",size:"small"}),onClick:()=>{t&&n&&r?.state&&r?.dispatch&&(eZ({api:t}),e1({annotationProviders:n,api:t,state:r.state,dispatch:r.dispatch}))},testId:u.floatingToolbarCreateButton,isDisabled:E,children:f})})},e9=(e,t)=>[{type:i("cPCP8").COLLAB_SECTION.type,key:i("cPCP8").COLLAB_SECTION.key,parents:[{type:"toolbar",key:i("cPCP8").TOOLBARS.INLINE_TEXT_TOOLBAR,rank:i("4Chin").TOOLBAR_RANK[i("cPCP8").COLLAB_SECTION.key]}]},{type:i("cPCP8").COMMENT_GROUP.type,key:i("cPCP8").COMMENT_GROUP.key,parents:[{type:i("cPCP8").COLLAB_SECTION.type,key:i("cPCP8").COLLAB_SECTION.key,rank:i("4Chin").TOOLBAR_RANK[i("cPCP8").COLLAB_SECTION.key]}]},{type:i("cPCP8").COMMENT_HERO_BUTTON.type,key:i("cPCP8").COMMENT_HERO_BUTTON.key,parents:[{type:i("cPCP8").COMMENT_GROUP.type,key:i("cPCP8").COMMENT_GROUP.key,rank:i("4Chin").COLLAB_SECTION_RANK[i("cPCP8").COMMENT_GROUP.key]}],component:()=>(0,s.jsx)(e2,{api:e,annotationProviders:t})}],e3=e=>({isVisible:e.annotationState?.isVisible,selectedAnnotations:e.annotationState?.selectedAnnotations,annotations:e.annotationState?.annotations});function e4({api:e,editorView:t,annotationProviders:n,dispatchAnalyticsEvent:a}){let o=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["annotation"],e3);return o?.isVisible===!1?null:(0,s.jsx)("div",{"data-editor-popup":"true",children:(0,s.jsx)(eY,{providers:n,editorView:t,dispatchAnalyticsEvent:a,editorAnalyticsAPI:e?.analytics?.actions,editorAPI:e})})}t.exports.annotationPlugin=({config:e,api:t})=>{let n=t?.featureFlags?.sharedState.currentState(),a=!!t?.toolbar;return a&&t?.toolbar?.actions.registerComponents(e9(t,e)),{name:"annotation",marks:()=>[{name:"annotation",mark:eg}],actions:{hasAnyUnResolvedAnnotationInPage:R,stripNonExistingAnnotations:P,setInlineCommentDraftState:ed(t?.analytics?.actions,e?.inlineComment.supportedBlockNodes),showCommentForBlockNode:el(e?.inlineComment.supportedBlockNodes)},getSharedState(e){if(!e)return;let t=Object.assign({},I(e)||void 0);return delete t?.featureFlagsPluginState,t},pmPlugins:()=>[{name:"annotation",plugin:({dispatch:a})=>{if(e)return ez({dispatch:a,provider:e.inlineComment,editorAnalyticsAPI:t?.analytics?.actions,featureFlagsPluginState:n,selectCommentExperience:e.selectCommentExperience,viewInlineCommentTraceUFOPress:e.viewInlineCommentTraceUFOPress,annotationManager:e.annotationManager,api:t})}},{name:"annotationKeymap",plugin:()=>{if(e){let e={};return(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").addInlineComment.common,ed(t?.analytics?.actions,void 0,t)(!0,i("d925B").INPUT_METHOD.SHORTCUT),e),(0,i("dus6D").keymap)(e)}}}],pluginsOptions:{floatingToolbar(e){let n=I(e);if(ew({state:e,bookmark:n?.bookmark}))return eD(e,t)},selectionToolbar(n,i){if(a||!e)return;let o=I(n);if(o&&o.isVisible&&!o.bookmark&&!o.mouseData.isSelecting){let{isToolbarAbove:a,onCommentButtonMount:o,getCanAddComments:s,contentType:r}=e.inlineComment,d=eR(t?.analytics?.actions)({state:n,intl:i,isToolbarAbove:a,api:t,createCommentExperience:e.createCommentExperience,annotationManager:e.annotationManager,onCommentButtonMount:o,getCanAddComments:s,contentType:r});if(!d)return;return{...d,rank:(0,l.editorExperiment)("platform_editor_controls","variant1")?1:void 0}}}},contentComponent:({editorView:n,dispatchAnalyticsEvent:a})=>!e||!n||(0,i("eTj7Y").isSSR)()&&(0,r.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?null:(0,s.jsx)(e4,{api:t,editorView:n,annotationProviders:e,dispatchAnalyticsEvent:a})}}}),o("cwPVT",function(t,n){var a=i("l998X"),o=i("42omo"),s=i("1oCLl"),r=i("iu6m9");let l=new(0,i("ks2lK").PluginKey)("breakoutPlugin"),d=e=>l.getState(e)||void 0,c=({tr:e,node:t,pos:n,isLivePage:a})=>{if(a||(0,i("dh538").fg)("platform-editor-single-player-expand")){let a=i("adayn").expandedState.get(t),o=e.doc.nodeAt(n);void 0!==a&&o&&i("adayn").expandedState.set(o,a)}},p=(e,t,n)=>{if((0,r.editorExperiment)("platform_editor_breakout_resizing",!0))c({tr:e,node:t.node,pos:t.pos,isLivePage:n});else if(n||(0,i("dh538").fg)("platform-editor-single-player-expand")){let n=i("adayn").expandedState.get(t.node),a=e.doc.nodeAt(t.pos);void 0!==n&&a&&i("adayn").expandedState.set(a,n)}};function u(e,t,n,a){return(o,s)=>{let r=o.doc.nodeAt(n);if(!r)return!1;let l=o.tr.setNodeMarkup(n,r.type,r.attrs,[o.schema.marks.breakout.create({width:e,mode:t})]);if(r.type===o.schema.nodes.expand)c({tr:l,node:r,pos:n,isLivePage:a});else if(r.type===o.schema.nodes.codeBlock){let e=l.doc.nodeAt(n);e&&(0,i("dNXVc").transferCodeBlockWrappedValue)(r,e)}return l.setMeta("scrollIntoView",!1),o.selection instanceof i("ks2lK").NodeSelection&&o.selection.node.eq(r)&&l.setSelection(i("ks2lK").NodeSelection.create(l.doc,n)),s&&s(l),!0}}let h=(e,t)=>{let n=e.state.selection;if(n instanceof i("ks2lK").NodeSelection){let e=n.node;if(t.has(e.type))return{node:e,pos:n.$from.pos}}else if(n instanceof i("ks2lK").TextSelection){let a=null,i=null,o=e.state.doc.resolve(n.$from.pos),s=o.node(1);if(t.has(s.type))return{node:s,pos:o.before(1)}}return null},m=e=>(t,n)=>{let a=((0,s.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,i("d7ZU3").getBrowserInfo)():i("d7ZU3").browser).mac?n.metaKey:n.ctrlKey,o="BracketRight"===n.code||"BracketLeft"===n.code;if(a&&n.altKey&&o){let{expand:a,codeBlock:o,layoutSection:s}=t.state.schema.nodes,l=(0,r.editorExperiment)("platform_synced_block",!0)?(0,i("fJNzZ").getBreakoutResizableNodeTypes)(t.state.schema):new Set([a,o,s]),d=h(t,l);if(d){let{node:a,pos:o}=d,s=a?.marks.find(e=>"breakout"===e.type.name);if(s){let a="BracketRight"===n.code?10:-10,r=s.attrs.width+a;if(r<i("aFUXX").akEditorFullWidthLayoutWidth&&r>i("aFUXX").akEditorDefaultLayoutWidth){let n=e?.editorViewMode?.sharedState.currentState()?.mode==="edit";u(s.attrs.width+a,s.attrs.mode,o,n)(t.state,t.dispatch),t.focus()}return!0}}}return!1};var f=i("cUcZ5"),g=i("4T4vf"),T=i("5X6QO"),E=i("gZctg");let y=e=>"layoutSection"===e?"layout":"codeBlock"===e||"expand"===e?e:"node",_={expand:i("5duTD").messages.resizeExpand,codeBlock:i("5duTD").messages.resizeCodeBlock,layout:i("5duTD").messages.resizeLayout,node:i("5duTD").messages.resizeElement},S=({rail:e,target:t,intl:n})=>{let[s,r]=(0,o.useState)("node");return(0,o.useLayoutEffect)(()=>{let e=t.querySelector("[data-prosemirror-node-name]");r(y(e?.dataset.prosemirrorNodeName))},[t]),(0,a.jsx)(i("3gadb").default,{content:n.formatMessage(_[s]),position:"mouse",children:(0,a.jsx)("div",{className:"pm-breakout-resize-handle-rail-inside-tooltip",ref:t=>{t&&e.parentNode!==t&&t.appendChild(e)}})})},b=({target:t,onDragStart:n,onDrag:o,onDrop:s,intl:r,nodeViewPortalProviderAPI:l})=>{let d="default",c=n=>{let i=document.createElement("div");i.contentEditable="false",i.classList.add("pm-breakout-resize-handle-container"),i.style.gridColumn="left"===n?"1":"3";let o=document.createElement("div");o.classList.add("pm-breakout-resize-handle-rail"),"left"===n?(i.classList.add("pm-breakout-resize-handle-container--left"),i.setAttribute("data-testid","pragmatic-resizer-handle-left")):(i.classList.add("pm-breakout-resize-handle-container--right"),i.setAttribute("data-testid","pragmatic-resizer-handle-right"));let s=document.createElement("div");s.classList.add("pm-breakout-resize-handle-hit-box");let d=document.createElement("div");d.classList.add("pm-breakout-resize-handle-thumb"),o.appendChild(d);let c=document.createElement("div");c.classList.add("pm-breakout-resize-handle-rail-wrapper"),i.appendChild(c),i.appendChild(s);let p=e(f)();return l.render(()=>(0,a.jsx)(S,{rail:o,target:t,intl:r}),c,p),{handle:i,rail:o,handleHitBox:s,destroyTooltip:()=>l.remove(p)}},p=c("right"),u=c("left"),h=(e,t)=>(0,g.draggable)({element:e,onGenerateDragPreview:({nativeSetDragImage:e})=>{(0,T.disableNativeDragPreview)({nativeSetDragImage:e}),E.preventUnhandled.start()},getInitialData:()=>({handleSide:t}),onDragStart(t){d="resizing",e.classList.add("pm-breakout-resize-handle-container--active"),n(t)},onDrag:o,onDrop(t){E.preventUnhandled.stop(),d="default",e.classList.remove("pm-breakout-resize-handle-container--active"),s(t)}}),m=e=>[(0,i("fFa3V").bind)(e,{type:"mouseenter",listener:()=>{p.rail.style.setProperty("opacity","1"),u.rail.style.setProperty("opacity","1")}}),(0,i("fFa3V").bind)(e,{type:"mouseleave",listener:()=>{"resizing"!==d&&(p.rail.style.removeProperty("opacity"),u.rail.style.removeProperty("opacity"))}})],y=[...m(t),...m(p.handleHitBox),...m(u.handleHitBox),...m(p.rail),...m(u.rail)],_=[h(p.handle,"right"),h(u.handle,"left"),p.destroyTooltip,u.destroyTooltip];return{rightHandle:p.handle,leftHandle:u.handle,destroy:e=>{_.forEach(e=>e()),y.forEach(e=>e()),e&&(p.handle.parentElement?.removeChild(p.handle),u.handle.parentElement?.removeChild(u.handle))}}},C={MIN:i("aFUXX").akEditorDefaultLayoutWidth,WIDE:i("aFUXX").akEditorCalculatedWideLayoutWidth,FULL:i("aFUXX").akEditorFullWidthLayoutWidth,MAX:i("aFUXX").akEditorMaxLayoutWidth},v={lineLengthLeft:"grid_left",lineLengthRight:"grid_right",wideLeft:"wide_left",wideRight:"wide_right",fullWidthLeft:"full_width_left",fullWidthRight:"full_width_right",maxWidthLeft:"max_width_left",maxWidthRight:"max_width_right"},I=(e,t=.5)=>Math.round(e/t)*t,N=(0,i("2XqLN").default)((e,t,n,a)=>{let o=[];if(!e)return o;let l=0;if(a)switch(a.name){case"expand":l=8+i("7QdQz").resizerHandleThumbWidth+8;break;case"layoutSection":l=i("boKri").LAYOUT_COLUMN_PADDING+8}let{width:d}=n()||{},c=d&&d<=i("aFUXX").akEditorFullPageNarrowBreakout&&(0,r.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?i("aFUXX").akEditorGutterPaddingReduced:(0,i("aFUXX").akEditorGutterPaddingDynamic)(),p=d?Math.min(C.FULL,d-2*c-i("aFUXX").akEditorGutterPadding):void 0,u=d&&((0,s.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,s.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))?Math.min(C.MAX,d-2*c-i("aFUXX").akEditorGutterPadding):void 0;return o.push({key:v.lineLengthLeft,position:{x:-I(C.MIN/2+l)},active:t===C.MIN}),o.push({key:v.lineLengthRight,position:{x:I(C.MIN/2+l)},active:t===C.MIN}),o.push({key:v.wideLeft,position:{x:-I(C.WIDE/2+l)},active:t===C.WIDE}),o.push({key:v.wideRight,position:{x:I(C.WIDE/2+l)},active:t===C.WIDE}),p&&(o.push({key:v.fullWidthLeft,position:{x:-I(p/2+l)},active:t===p}),o.push({key:v.fullWidthRight,position:{x:I(p/2+l)},active:t===p})),u&&(o.push({key:v.maxWidthLeft,position:{x:-I(u/2+l)},active:t===u}),o.push({key:v.maxWidthRight,position:{x:I(u/2+l)},active:t===u})),o}),k=e=>e.frameRateSamples.map((t,n)=>({action:i("d925B").ACTION.RESIZED_PERF_SAMPLING,actionSubject:i("d925B").ACTION_SUBJECT.ELEMENT,eventType:i("d925B").EVENT_TYPE.OPERATIONAL,attributes:{nodeType:e.originalNode.type.name,frameRate:t,nodeSize:e.originalNode.nodeSize,docSize:e.docSize,isInitialSample:0===n}})),x=({node:e,prevWidth:t,newWidth:n})=>({action:i("d925B").ACTION.RESIZED,actionSubject:i("d925B").ACTION_SUBJECT.ELEMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{nodeType:e.type.name,prevWidth:t,newWidth:n}}),A=e=>{if(!(e.length>1))return e;{let t=Math.round(e.reduce((e,t,n)=>0===n?e:e+t,0)/(e.length-1));return[e[0],t]}},O=e=>{let t,{maxSamples:n=10,minFrames:a=5,minTimeMs:i=500,sampleRateMs:o=1e3,timeoutMs:s=200}=e||{},r=0,l=0,d=[],c=(e=0)=>{let t=performance.now()-l-e;if(t>i&&r>=a){let e=Math.round(r/(t/1e3));d.push(e)}r=0,l=0};return{startMeasure:()=>{r=0,l=performance.now()},endMeasure:()=>{let e=d;return d=[],e},countFrames:()=>{if(d.length>=n&&t)return void clearTimeout(t);0===l&&(l=performance.now()),r++,t&&clearTimeout(t),performance.now()-l>o?c():t=setTimeout(()=>c(s),s)}}},P={MIN:i("aFUXX").akEditorDefaultLayoutWidth,WIDE:i("aFUXX").akEditorCalculatedWideLayoutWidth,FULL:i("aFUXX").akEditorFullWidthLayoutWidth,MAX:i("aFUXX").akEditorMaxLayoutWidth};function M({initialWidth:e,location:t,api:n,source:a}){let o="left"===a.data.handleSide?-1:1,l=(t.current.input.clientX-t.initial.input.clientX)*2*o,d=n?.width.sharedState?.currentState()?.width||0,c=d<=i("aFUXX").akEditorFullPageNarrowBreakout&&(0,r.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?i("aFUXX").akEditorGutterPaddingReduced:(0,i("aFUXX").akEditorGutterPaddingDynamic)(),p=d-2*c-i("aFUXX").akEditorGutterPadding,u=Math.min(e,p)+l,h=[P.MIN,P.WIDE,Math.min(p,P.FULL)];for(let e of(((0,s.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,s.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&h.push(Math.min(p,P.MAX)),h))if(e-10<u&&e+10>u)return e;let m=(0,s.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,s.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?Math.min(p,P.MAX):Math.min(p,P.FULL);return Math.max(P.MIN,Math.min(u,m))}let w="--local-resizing-width";class D{setupResizerCallbacks(e,t,n,a,i){let{leftHandle:o,rightHandle:r,destroy:l}=b({target:t,...function({dom:e,view:t,mark:n,api:a}){let i=null,o=[],{startMeasure:r,endMeasure:l,countFrames:d}=O(),c=()=>a?.width?.sharedState.currentState();return{onDragStart:()=>{r();let n=t.posAtDOM(e,0);i=t.state.doc.nodeAt(n),a?.core.actions.execute(({tr:e})=>(a.userIntent?.commands.setCurrentUserIntent("dragging")({tr:e}),e.setMeta("is-resizer-resizing",!0),e.setMeta(B,{type:"UPDATE_BREAKOUT_NODE",data:{node:i,pos:n,start:n,depth:0}}),e))},onDrag:({location:s,source:r})=>{d();let l=M({initialWidth:n.attrs.width,location:s,api:a,source:r});o=N(!0,l,c,i?.type),a?.guideline?.actions?.displayGuideline(t)({guidelines:o});let p=o.find(e=>e.active&&!e.key.startsWith("grid"));p&&a?.core.actions.execute(({tr:e})=>(e.setMeta(B,{type:"UPDATE_ACTIVE_GUIDELINE_KEY",data:{activeGuidelineKey:p.key}}),e)),!p&&a?.breakout.sharedState.currentState()?.activeGuidelineKey&&a?.core.actions.execute(({tr:e})=>(e.setMeta(B,{type:"CLEAR_ACTIVE_GUIDELINE_KEY"}),e)),e.style.setProperty(w,`${l}px`)},onDrop({location:r,source:d}){let p=[],h=l();p=k({docSize:t.state.doc.nodeSize,frameRateSamples:A(h),originalNode:i});let m=!!o.find(e=>e.key.startsWith("full_width")&&e.active),f=!1;((0,s.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,s.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&(f=!!o.find(e=>e.key.startsWith("max_width")&&e.active)),o=N(!1,0,c),a?.guideline?.actions?.displayGuideline(t)({guidelines:o});let g=t.posAtDOM(e,0),T=n.attrs.mode,E=n.attrs.width,y=m?P.FULL:M({initialWidth:E,location:r,api:a,source:d});if(((0,s.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,s.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&f&&(y=P.MAX),u(y,T,g,a?.editorViewMode?.sharedState.currentState()?.mode==="edit")(t.state,t.dispatch),e.style.removeProperty(w),i){let e=x({node:i,prevWidth:E,newWidth:y});p.push(e)}a?.core.actions.execute(({tr:e})=>(a.userIntent?.commands.setCurrentUserIntent("default")({tr:e}),p.forEach(t=>{a.analytics?.actions?.attachAnalyticsEvent(t)(e)}),e.setMeta("is-resizer-resizing",!1).setMeta("scrollIntoView",!1),e.setMeta(B,{type:"RESET_STATE"}),e))}}}({dom:e,view:n,mark:a,api:i}),intl:this.intl,nodeViewPortalProviderAPI:this.nodeViewPortalProviderAPI});this.dom.prepend(o),this.dom.appendChild(r),this.destroyFn=l,this.isResizingInitialised=!0}ignoreMutation(){return!0}destroy(){this.destroyFn?.(),this.unsubscribeToViewModeChange?.()}constructor(e,t,n,a,o){this.dom=void 0,this.contentDOM=void 0,this.view=void 0,this.mark=void 0,this.destroyFn=void 0,this.intl=void 0,this.nodeViewPortalProviderAPI=void 0,this.unsubscribeToViewModeChange=void 0,this.isResizingInitialised=!1;let r=document.createElement("div"),l=document.createElement("div");l.className=i("ly3wu").BreakoutCssClassName.BREAKOUT_MARK_DOM,l.setAttribute("data-testid","ak-editor-breakout-mark-dom"),r.className=i("ly3wu").BreakoutCssClassName.BREAKOUT_MARK,r.setAttribute("data-layout",e.attrs.mode),r.setAttribute("data-testid","ak-editor-breakout-mark"),r.style.transform="none",r.style.display="grid",r.style.justifyContent="center",l.style.gridColumn="2",l.style.zIndex="1",(0,s.expValEquals)("platform_editor_breakout_resizing_vc90_fix","isEnabled",!0)?e.attrs.width?r.style.gridTemplateColumns=`auto max(var(--ak-editor--breakout-min-width), min(var(${w}, ${e.attrs.width}px), var(--ak-editor--breakout-fallback-width))) auto`:("wide"===e.attrs.mode&&(l.style.width=`max(var(--ak-editor--line-length), min(var(${w}, var(--ak-editor--breakout-wide-layout-width)), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))`),"full-width"===e.attrs.mode&&(l.style.width=`max(var(--ak-editor--line-length), min(var(${w}, var(--ak-editor--full-width-layout-width)), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))`)):e.attrs.width?r.style.gridTemplateColumns=`auto min(var(${w}, ${e.attrs.width}px), var(--ak-editor--breakout-fallback-width)) auto`:("wide"===e.attrs.mode&&(l.style.width=`max(var(--ak-editor--line-length), min(var(${w}, var(--ak-editor--breakout-wide-layout-width)), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))`),"full-width"===e.attrs.mode&&(l.style.width=`max(var(--ak-editor--line-length), min(var(${w}, var(--ak-editor--full-width-layout-width)), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))`)),r.appendChild(l),this.dom=r,this.contentDOM=l,this.view=t,this.mark=e,this.intl=a(),this.nodeViewPortalProviderAPI=o,n?.editorViewMode?.sharedState.currentState()?.mode!=="view"&&this.setupResizerCallbacks(r,l,t,e,n),this.unsubscribeToViewModeChange=n?.editorViewMode?.sharedState.onChange(a=>{a.nextSharedState?.mode!==a.prevSharedState?.mode&&(a.nextSharedState?.mode==="view"&&this.isResizingInitialised?(this.destroyFn?.(!0),this.isResizingInitialised=!1):a.nextSharedState?.mode!=="edit"||this.isResizingInitialised||this.setupResizerCallbacks(r,l,t,e,n))})}}let R=({node:e,pos:t,newState:n,newTr:a,breakoutResizableNodes:o,isFullWidthEnabled:s})=>{let r=!1,l=a,d=n.doc.resolve(t),p=d?.depth===0;if(o.has(e.type)&&p){let{breakout:o}=n.schema.marks,{expand:d}=n.schema.nodes,p=e.marks.find(e=>e.type===o),u=e.type===d;if(p){if(p?.attrs.width===null||p?.attrs.width===void 0){let n=p.attrs.mode,d=s||"full-width"===n?i("aFUXX").akEditorFullWidthLayoutWidth:i("aFUXX").akEditorCalculatedWideLayoutWidth;l=a.setNodeMarkup(t,e.type,e.attrs,[o.create({width:d,mode:n})]),u&&c({tr:l,node:e,pos:t,isLivePage:!0}),r=!0}}else{let n=s?i("aFUXX").akEditorFullWidthLayoutWidth:i("aFUXX").akEditorDefaultLayoutWidth;l=a.setNodeMarkup(t,e.type,e.attrs,[o.create({width:n})]),u&&c({tr:l,node:e,pos:t,isLivePage:!0}),r=!0}}return{updatedTr:l,updatedDocChanged:r}},B=new(0,i("ks2lK").PluginKey)("breakout-resizing"),L={init:()=>({breakoutNode:void 0,activeGuidelineLabel:void 0}),apply(e,t){let n=e.getMeta(B);if(n)switch(n.type){case"UPDATE_BREAKOUT_NODE":return{...t,breakoutNode:n.data};case"UPDATE_ACTIVE_GUIDELINE_KEY":return{...t,activeGuidelineKey:n.data.activeGuidelineKey};case"CLEAR_ACTIVE_GUIDELINE_KEY":return{...t,activeGuidelineKey:void 0};case"RESET_STATE":return{activeGuidelineLabel:void 0,breakoutNode:void 0}}return t}},U=(e,t,n,a)=>new(0,i("1S4f7").SafePlugin)({key:B,state:L,props:{markViews:{breakout:(a,i)=>new D(a,i,e,t,n)},handleKeyDown:m(e)},appendTransaction(t,n,o){if(e?.editorViewMode?.sharedState.currentState()?.mode==="view")return;let s=o.tr,l=!1,{expand:d,codeBlock:c,layoutSection:p}=o.schema.nodes,u=(0,r.editorExperiment)("platform_synced_block",!0)?(0,i("fJNzZ").getBreakoutResizableNodeTypes)(o.schema):new Set([d,c,p]),h=a?.allowBreakoutButton!==!0;if((0,i("2pjJ5").isReplaceDocOperation)(t,n)?o.doc.forEach((e,t)=>{let{updatedTr:n,updatedDocChanged:a}=R({node:e,pos:t,newState:o,newTr:s,breakoutResizableNodes:u,isFullWidthEnabled:h});s=n,l=l||a}):t.forEach(e=>{e.steps.some(e=>(0,i("kTbzR").stepAddsOneOf)(e,u))&&(0,i("2pjJ5").getChangedNodes)(e).forEach(({node:e,pos:t})=>{let{updatedTr:n,updatedDocChanged:a}=R({node:e,pos:t,newState:o,newTr:s,breakoutResizableNodes:u,isFullWidthEnabled:h});s=n,l=l||a})}),l)return s}});var K=i("8m4tT");let F=["codeBlock","layoutSection","expand"],j=["codeBlock","expand"];function G(e){return(0,r.editorExperiment)("advanced_layouts",!0)?-1!==j.indexOf(e.type.name):-1!==F.indexOf(e.type.name)}function V(e){if(e instanceof i("ks2lK").NodeSelection&&G(e.node))return{pos:e.from,start:e.from,node:e.node,depth:e.$anchor.depth};let t=(0,K.findParentNode)(G)(e);if(t&&0!==t.depth)return{node:t.node,start:t.start,pos:t.pos,depth:t.depth-1}}function z(e){let t=V(e.selection);if(!t)return;let n=t.node.marks.find(e=>"breakout"===e.type.name);if(n)return n.attrs.mode}i("42omo");let H={wide_left:"wide",wide_right:"wide",full_width_left:"full-width",full_width_right:"full-width",max_width_left:"max",max_width_right:"max"},q=({api:e,editorView:t,mountPoint:n,boundariesElement:o,scrollableElement:s})=>{let r=(0,i("b3YrF").useSharedPluginStateSelector)(e,"breakout.breakoutNode"),l=(0,i("b3YrF").useSharedPluginStateSelector)(e,"breakout.activeGuidelineKey");if(!r||!l)return null;let d=(0,K.findDomRefAtPos)(r.pos,t.domAtPos.bind(t));return(0,a.jsx)(i("jwWgu").default,{target:d&&d instanceof HTMLElement?d:void 0,offset:[0,10],alignY:"bottom",alignX:"center",mountTo:n,boundariesElement:o,scrollableElement:s,stick:!0,forcePlacement:!0,children:(0,a.jsx)(i("7x0qS").ResizerBreakoutModeLabel,{layout:H[l]})})},W=(0,i("9K4OG").css)({"&& button":{background:`var(--ds-background-neutral, ${i("6fnsQ").N20A})`,color:`var(--ds-icon, ${i("6fnsQ").N300})`,":hover":{background:`var(--ds-background-neutral-hovered, ${i("6fnsQ").B300})`,color:"var(--ds-icon, white) !important"}}}),X=(0,i("9K4OG").css)({[`@container editor-area (max-width: ${i("aFUXX").akEditorFullPageNarrowBreakout}px)`]:{"&& button":{visibility:"hidden",opacity:0}}}),Y=({intl:{formatMessage:t},mountPoint:n,boundariesElement:a,scrollableElement:l,editorView:c,isLivePage:u,isBreakoutNodePresent:h,breakoutMode:m,api:f})=>{let g=(0,o.useCallback)(e=>{if((0,s.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!c)return;let{state:t,dispatch:n}=c,a=d(t)?.breakoutNode;-1!==["wide","full-width"].indexOf(e)?(((t,n)=>{let a=V(t.selection);if(!a)return;let o=t.tr.setNodeMarkup(a.pos,a.node.type,a.node.attrs,[t.schema.marks.breakout.create({mode:e})]);if(a.node.type===t.schema.nodes.expand)p(o,a,u);else if(a.node.type===t.schema.nodes.codeBlock){let e=o.doc.nodeAt(a.pos),t=a.node;e&&(0,i("dNXVc").transferCodeBlockWrappedValue)(t,e)}return o.setMeta("scrollIntoView",!1),t.selection instanceof i("ks2lK").NodeSelection&&t.selection.$anchor.pos===a.pos&&o.setSelection(i("ks2lK").NodeSelection.create(o.doc,a.pos)),n&&n(o)})(t,n),f?.analytics?.actions.fireAnalyticsEvent({action:i("d925B").ACTION.CHANGED_BREAKOUT_MODE,actionSubject:i("d925B").ACTION_SUBJECT.ELEMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{mode:e,nodeType:a?.node.type.name}})):(((e,t)=>{let n=V(e.selection);if(!n)return;let a=n.node.marks.filter(e=>"breakout"!==e.type.name),o=e.tr.setNodeMarkup(n.pos,n.node.type,n.node.attrs,a);if(n.node.type===e.schema.nodes.expand)p(o,n,u);else if(n.node.type===e.schema.nodes.codeBlock){let e=o.doc.nodeAt(n.pos),t=n.node;e&&(0,i("dNXVc").transferCodeBlockWrappedValue)(t,e)}return o.setMeta("scrollIntoView",!1),e.selection instanceof i("ks2lK").NodeSelection&&e.selection.$anchor.pos===n.pos&&o.setSelection(i("ks2lK").NodeSelection.create(o.doc,n.pos)),t&&t(o)})(t,n),f?.analytics?.actions.fireAnalyticsEvent({action:i("d925B").ACTION.CHANGED_BREAKOUT_MODE,actionSubject:i("d925B").ACTION_SUBJECT.ELEMENT,eventType:i("d925B").EVENT_TYPE.TRACK,attributes:{mode:"center",nodeType:a?.node.type.name}}))},[f?.analytics?.actions,c,u]);if((0,s.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!c||!h||!function(e){if(!e.schema.marks.breakout)return!1;let t=V(e.selection);return!!t&&e.selection.$from.node(t.depth).type.allowsMarkType(e.schema.marks.breakout)}(c.state))return null;let T=(0,i("fJNzZ").getTitle)(m),E=t(T),y=(0,i("fJNzZ").getNextBreakoutMode)(m),_=i("dTk3A").layers.layer()-1,S=d(c.state);if(!S)return null;let b=function(e,t,n){if(e.breakoutNode)return t instanceof i("ks2lK").NodeSelection&&G(t.node)?(0,K.findDomRefAtPos)(t.from,n.domAtPos.bind(n)):(0,K.findParentDomRefOfType)(e.breakoutNode.node.type,n.domAtPos.bind(n))(t)}(S,c.state.selection,c);if(!b)return null;let C=b.querySelector(`.${i("ly3wu").BreakoutCssClassName.BREAKOUT_MARK_DOM}`);return C&&C.firstChild&&(b=C.firstChild),(0,i("9K4OG").jsx)(i("jwWgu").default,{ariaLabel:E,target:b,offset:[5,0],alignY:"start",alignX:"end",mountTo:n,boundariesElement:a,scrollableElement:l,stick:!0,forcePlacement:!0,zIndex:_},(0,i("9K4OG").jsx)("div",{css:[W,(0,r.editorExperiment)("platform_editor_preview_panel_responsiveness",!0)&&X]},(0,i("9K4OG").jsx)(i("a4eZN").default,{title:E,testId:T.id,onClick:()=>g(y),iconBefore:"full-width"===m?(0,i("9K4OG").jsx)(e(i("64M9v")),{label:E,spacing:"spacious"}):(0,i("9K4OG").jsx)(e(i("1kVeP")),{label:E,spacing:"spacious"})})))};Y.displayName="LayoutButton";var $=(0,i("gmMgo").default)(Y);class J{constructor(e,t,n){this.dom=void 0,this.contentDOM=void 0,this.view=void 0,this.mark=void 0;let a=document.createElement("div"),o=document.createElement("div");o.className=i("ly3wu").BreakoutCssClassName.BREAKOUT_MARK_DOM,o.setAttribute("data-testid","ak-editor-breakout-mark-dom"),a.className=i("ly3wu").BreakoutCssClassName.BREAKOUT_MARK,a.setAttribute("data-layout",e.attrs.mode),a.setAttribute("data-testid","ak-editor-breakout-mark"),a.appendChild(o),a.style.transform="none",a.style.display="flex",a.style.justifyContent="center",o.style.transition=`min-width 0.5s ${i("aFUXX").akEditorSwoopCubicBezier}`,(0,r.editorExperiment)("advanced_layouts",!0)?e.attrs.width?o.style.minWidth=`min(${e.attrs.width}px, calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding)))`:("full-width"===e.attrs.mode&&(o.style.minWidth="max(var(--ak-editor--line-length), min(var(--ak-editor--full-width-layout-width), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))"),"wide"===e.attrs.mode&&(n&&"full-width"===n&&(0,r.editorExperiment)("single_column_layouts",!0)&&1?o.style.minWidth="min(var(--ak-editor--breakout-wide-layout-width), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding)))":o.style.minWidth="max(var(--ak-editor--line-length), min(var(--ak-editor--breakout-wide-layout-width), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))")):("full-width"===e.attrs.mode&&(o.style.minWidth="max(var(--ak-editor--line-length), min(var(--ak-editor--full-width-layout-width), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))"),"wide"===e.attrs.mode&&(o.style.minWidth="max(var(--ak-editor--line-length), min(var(--ak-editor--breakout-wide-layout-width), calc(100cqw - var(--ak-editor--breakout-full-page-guttering-padding))))")),this.dom=a,this.mark=e,this.view=t,this.contentDOM=o}}let Z=({api:e,editorView:t,boundariesElement:n,scrollableElement:l,mountPoint:d})=>{let{editorDisabled:c,isDragging:p,isPMDragging:u,mode:h}=(0,i("eiA8Z").useSharedPluginStateWithSelector)(e,["editorViewMode","editorDisabled","blockControls"],e=>({isDragging:e.blockControlsState?.isDragging,isPMDragging:e.blockControlsState?.isPMDragging,mode:e.editorViewModeState?.mode,editorDisabled:e.editorDisabledState?.editorDisabled})),[m,f]=(0,o.useState)(!1),[g,T]=(0,o.useState)((0,s.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!t?void 0:z(t.state));return((0,i("6qdjm").usePluginStateEffect)(e,["breakout"],({breakoutState:e})=>{if((0,s.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!t)return;e?.breakoutNode&&!m&&f(!0),!e?.breakoutNode&&m&&f(!1);let n=z(t.state);n!==g&&T(n)}),"hasNotHadInteraction"===(0,i("b3YrF").useSharedPluginStateSelector)(e,"interaction.interactionState")||(p||u)&&(0,r.editorExperiment)("advanced_layouts",!0)||"view"===h||!1!==c)?null:(0,a.jsx)($,{editorView:t,mountPoint:d,boundariesElement:n,scrollableElement:l,isLivePage:"edit"===h,isBreakoutNodePresent:m,breakoutMode:g,api:e})};t.exports.breakoutPlugin=({config:e,api:t})=>({name:"breakout",pmPlugins:()=>(0,s.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0)?[{name:"breakout-resizing",plugin:({getIntl:n,nodeViewPortalProviderAPI:a})=>U(t,n,a,e)}]:[{name:"breakout",plugin:t=>(function(e,{dispatch:t},n){return new(0,i("1S4f7").SafePlugin)({state:{init:()=>({breakoutNode:void 0,activeGuidelineKey:void 0}),apply(e,n){var a;let i=V(e.selection);if(a=n.breakoutNode,i&&a?i!==a:!!i||!!a){let e={...n,breakoutNode:i};return t(l,e),e}return n}},key:l,props:{nodeViews:{breakout:(e,t)=>new J(e,t,n)}}})})(0,t,e?.appearance)}],marks:()=>[{name:"breakout",mark:i("gWpm5").breakout}],getSharedState(e){if(!e)return{breakoutNode:void 0};if((0,s.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0)){let t=B.getState(e);return t||{breakoutNode:void 0,activeGuidelineKey:void 0}}let t=l.getState(e);return t||{breakoutNode:void 0}},contentComponent:({editorView:n,popupsMountPoint:i,popupsBoundariesElement:o,popupsScrollableElement:r})=>n?(0,s.expValEquals)("platform_editor_breakout_resizing","isEnabled",!0)?(0,a.jsx)(q,{api:t,editorView:n,mountPoint:i,boundariesElement:o,scrollableElement:r}):e&&!e.allowBreakoutButton?null:(0,a.jsx)(Z,{api:t,mountPoint:i,editorView:n,boundariesElement:o,scrollableElement:r}):null})}),o("25jxS",function(e,t){var n,a=((n={}).NCS_STORAGE_CLIENT_KEY="ncs-session-step-metrics-storage",n.NCS_SESSION_STEP_METRICS="ncsSessionStepMetrics",n.NCS_ACTIVE_SESSIONS="ncsActiveSessions",n);e.exports.NCS_STORAGE=a}),o("1nZXu",function(e,t){let n=e=>e.setMeta(i("1nZXu").pluginKey,{changed:!0}),a=new(0,i("ks2lK").PluginKey)("contextPanelPluginKey");e.exports.pluginKey=a,e.exports.contextPanelPlugin=({config:e})=>({name:"contextPanel",actions:{applyChange:n,showPanel:e?.objectSideBar.showPanel&&(0,i("dh538").fg)("platform_editor_ai_object_sidebar_injection")?(t,n,a)=>e.objectSideBar.showPanel(t,n,a):void 0,closePanel:e?.objectSideBar.closePanel&&(0,i("dh538").fg)("platform_editor_ai_object_sidebar_injection")?()=>e.objectSideBar.closePanel():void 0,closePanelById:e?.objectSideBar.closePanelById&&(0,i("dh538").fg)("platform_editor_ai_object_sidebar_injection")?t=>e.objectSideBar.closePanelById(t):void 0},getSharedState(e){if(!e)return;let{contents:t}=a.getState(e)??{};return{contents:t}},pmPlugins:(e=[])=>[{name:"contextPanel",plugin:({dispatch:t})=>{var n;return n=e.filter(Boolean),new(0,i("1S4f7").SafePlugin)({key:a,state:{init:(e,t)=>({handlers:n,contents:n.map(e=>e(t))}),apply(e,n,i,o){let s=n,r=e.getMeta(a);if(e.docChanged||e.selectionSet||r&&r.changed){let e=n.handlers.map(e=>e(o)),t=e.length!==s.contents.length,a=e.some((e,t)=>s.contents[t]!==e);(t||a)&&(s={...s,contents:e})}return s!==n&&t(a,s),s}}})}}]})}),o("dtCIm",function(t,n){let a;var o,s=i("l998X");i("42omo");var r=i("iu6m9"),l=i("1oCLl"),d=i("dZ8uq"),c=((o={}).ACTIVATE="ACTIVATE",o.FIND="FIND",o.UPDATE_DECORATIONS="UPDATE_DECORATIONS",o.FIND_NEXT="FIND_NEXT",o.FIND_PREVIOUS="FIND_PREVIOUS",o.REPLACE="REPLACE",o.REPLACE_ALL="REPLACE_ALL",o.CANCEL="CANCEL",o.BLUR="BLUR",o.TOGGLE_MATCH_CASE="TOGGLE_MATCH_CASE",o);let p=new(0,i("ks2lK").PluginKey)("findReplace"),u={isActive:!1,shouldFocus:!1,findText:"",replaceText:"",index:0,matches:[],decorationSet:i("ftzrq").DecorationSet.empty,shouldMatchCase:!1},h=(e,t,n)=>new(0,i("1S4f7").SafePlugin)({key:p,state:R(e,()=>(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)||(0,l.expValEquals)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)?{...u,getIntl:t,api:n}:{...u}),props:{decorations(e){let{isActive:t,findText:n,decorationSet:a}=D(e);if(t&&n)return a}}});var m=i("2daQU");let f="selected-search-match",g="search-match-dark",T=(e,t)=>t.map(({start:t,end:n,canReplace:a,nodeType:i},o)=>_({start:t,end:n,canReplace:a,nodeType:i},o===e)),E=e=>["blockCard","embedCard","inlineCard","status","mention","date"].includes(e||""),y=e=>["expand","nestedExpand"].includes(e.nodeType||"")&&!e.canReplace,_=(t,n)=>{let{start:a,end:o,nodeType:s}=t;if((0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)){let{colorMode:r}=(0,i("8z9j5").default)();if(E(s)){let t=e(m)("search-match-block",{"search-match-block-selected":n,[g]:"dark"===r});return i("ftzrq").Decoration.node(a,o,{class:t})}if(y(t)){let t=e(m)("search-match-expand-title",{[f]:n,[g]:"dark"===r});return i("ftzrq").Decoration.node(a,o,{class:t})}{let t=e(m)("search-match-text",{[f]:n,[g]:"dark"===r});return i("ftzrq").Decoration.inline(a,o,{class:t})}}{let e="search-match";return n&&(e+=` ${f}`),i("ftzrq").Decoration.inline(a,o,{class:e})}};function S({content:e,searchText:t,shouldMatchCase:n,contentIndex:a=0,getIntl:o,api:s}){let r=[],d=t.length,c=null,p=e=>{if(!e)return;let{text:i}=e,{pos:o}=e,s=a+o;n||(t=t.toLowerCase(),i=i.toLowerCase());let c=i.indexOf(t);for(;-1!==c;){let e=c+d;r.push({start:s+c,end:s+e,canReplace:!!(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)||void 0,nodeType:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?"text":void 0}),c=i.indexOf(t,e)}},u=(e,a)=>{if(!e)return;let{pos:i}=e,{text:o}=e;"status"===a.type.name&&n?o=o.toUpperCase():n||(o=o.toLowerCase(),t=t.toLowerCase()),-1!==o.indexOf(t)&&r.push({start:i,end:i+a.nodeSize,canReplace:!1,nodeType:a.type.name})},h=(e,t)=>{let n=s?.card?.sharedState.currentState()?.cards;if(n){let a=n.find(t=>t.url===e.attrs.url),i=a?.title;a&&(i?u({text:i,pos:t},e):"inlineCard"===e.type.name&&u({text:e.attrs.url,pos:t},e))}};return d>0&&(e.descendants((e,t)=>{if(e.isText)null===c?c={text:e.text,pos:t}:c.text=c.text+e.text;else if(p(c),c=null,(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0))switch(e.type.name){case"status":u({text:e.attrs.text,pos:t},e);break;case"date":u({text:(0,i("dIxHZ").timestampToString)(e.attrs.timestamp,o?o():null),pos:t},e);break;case"expand":case"nestedExpand":u({text:e.attrs.title,pos:t},e);break;case"mention":let n;if(e.attrs.text)n=e.attrs.text;else{let t=s?.mention?.sharedState.currentState()?.mentionProvider;if((0,i("bqMS3").isResolvingMentionProvider)(t)){let a=t.resolveMentionName(e.attrs.id);n=(0,i("6mYMS").isPromise)(a)?"@...":a.status===i("6mYMS").MentionNameStatus.OK?`@${a.name||""}`:"@_|unknown|_"}}n&&u({text:n,pos:t},e);break;case"inlineCard":case"blockCard":case"embedCard":h(e,t)}}),c&&p(c)),r}function b(e,t){let n=t.findIndex(t=>t.start>=e);if(-1===n)return t.length>0?t.length-1:0;if(0===n)return n;let a=n-1;return t[n].start-e<e-t[a].start?n:a}function C(e,t,n=!1){if(n){let n=t.findIndex(t=>t.start>=e)-1;return n<0&&(n=t.length-1),n}return Math.max(t.findIndex(t=>t.start>=e),0)}let v=(e,t)=>(e+1)%t,I=(e,t)=>(e-1+t)%t,N=(e,t,n,a,o=0)=>a[n]?y(a[n])?i("ks2lK").NodeSelection.create(t,a[n].start):i("ks2lK").TextSelection.create(t,a[n].start+o):e,k=(e,t)=>{if(!t)return;let n=e.find(t.start,t.end);return n.length?n.find(e=>e.from===t.start&&e.to===t.end):void 0},x=(e,t,n)=>{let a=e.find(),i=(e=e.remove(t.map(e=>e.copy(e.from,e.to)))).find(),o=O(t,a,i);return o.length>0&&(e=e.add(n,o)),e},A=(e,t,n)=>(t.filter(e=>!!e).map(t=>k(e,t)).forEach(t=>{t&&(e=x(e,[t],n))}),e),O=(e,t,n)=>{let a=[];if(t.length-e.length>n.length){let i=e.length>0?e[0].from:0,o=Math.min(P(t,i),P(n,i)),s=t.slice(o),r=n.slice(o),l=[],d=s.length-r.length,c=!1,p=0;for(let t=0;t<s.length;t++){let n=s[t];if(e.find(e=>e.from===n.from)){p-=1;continue}let a=t+p;for(a>=r.length&&(l.push(n),l.length===d&&(c=!0));a<r.length;a++){let e=r[a];if(n.from===e.from)break;if(e.from>n.from||a===r.length-1){l.push(n),p-=1,l.length===d&&(c=!0);break}}if(c)break}a=l.filter(t=>!e.find(e=>t.from===e.from))}return a},P=(e,t)=>{let n=0;for(let a=e.length-1;a>=0;a-=100){if(e[a].from<t){n=a;for(let i=a;i<=e.length-1;i++)if(e[i].from<=t)n=i;else break;break}a<100&&a>0&&(a=100)}return n},M=(e,t,n)=>{let{from:a,to:i,slice:o}=t,s=o.content.size;return a+s>=e.start&&i-s<=e.end||n.mapping.map(a)+s>=e.start&&n.mapping.map(i)-s<=e.end},{createCommand:w,getPluginState:D,createPluginState:R}=(0,i("lkJUe").pluginFactory)(p,(a=()=>u,(e,t)=>{switch(t.type){case c.ACTIVATE:case c.FIND:return{...e,isActive:!0,shouldFocus:t.type===c.ACTIVATE,findText:void 0!==t.findText?t.findText:e.findText,matches:t.matches||e.matches,index:void 0!==t.index?t.index:e.index};case c.UPDATE_DECORATIONS:return{...e,decorationSet:t.decorationSet};case c.FIND_NEXT:case c.FIND_PREVIOUS:return{...e,index:t.index,decorationSet:t.decorationSet};case c.REPLACE:case c.REPLACE_ALL:return{...e,replaceText:t.replaceText,decorationSet:t.decorationSet,matches:t.matches,index:t.index};case c.CANCEL:let{getIntl:n,api:i}=e;return(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?{...a(),getIntl:n,api:i}:a();case c.BLUR:return{...e,shouldFocus:!1};case c.TOGGLE_MATCH_CASE:return{...e,shouldMatchCase:!e.shouldMatchCase};default:return e}}),{onDocChanged:(e,t)=>{let{isActive:n,findText:a}=t;if(!n||!a||!e.steps.find(i("kTbzR").stepHasSlice))return t;let{index:o,decorationSet:s,matches:r,shouldMatchCase:c,getIntl:p,api:u}=t,h=S({content:e.doc,searchText:a,shouldMatchCase:c,getIntl:p,api:u}),m=(s=s.map(e.mapping,e.doc)).find().length,f=r.map(t=>({start:e.mapping.map(t.start),end:e.mapping.map(t.end),canReplace:t.canReplace,nodeType:t.nodeType})),g=[],E=[];if(h.length>0&&0===m?g=h:0===h.length&&m>0?s=i("ftzrq").DecorationSet.empty:(h.length>0||m>0)&&e.steps.forEach(t=>{if((0,i("kTbzR").stepHasSlice)(t)){var n,a;g=[...g,...h.filter(n=>M(n,t,e)&&!k(s,n))],E=[...E,...(n=f.filter(n=>M(n,t,e)&&!!k(s,n)),a=(e,t)=>e.start===t.start&&e.end===t.end,n.filter(e=>-1===h.findIndex(t=>a?a(e,t):e===t)))]}}),E.length>0){let t=E.reduce((e,t)=>[...e,...s.find(t.start,t.end)],[]);s=x(s,t,e.doc)}g.length>0&&(s=s.add(e.doc,T(e.selection.from,g)));let y=o,_=f[o];_&&(y=h.findIndex(e=>e.start===_.start)),(void 0===y||-1===y)&&(y=(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?b(e.selection.from,h):C(e.selection.from,h));let v=h[y];if(s=A(s,[_,v],e.doc),v&&(s=s.add(e.doc,T(0,[v]))),(0,d.expValEqualsNoExposure)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)){let t=N(e.selection,e.doc,y,h);u?.expand?.commands.toggleExpandWithMatch(t)({tr:e})}return{...t,matches:h,index:y,decorationSet:s}}}),B=new class{stop(){this.rafId&&cancelAnimationFrame(this.rafId)}async applyAllSearchDecorations(e,t,n,a){if(this.stop(),this.addDecorations=n,this.removeDecorations=a,!t)return;let i=t.querySelector(".ProseMirror");if(!i)return;let{startPos:o,endPos:s,viewportStartPos:r,viewportEndPos:l}=this.calcDecorationPositions(e,t,i),d=0,c=r,p=l-2e3;for(await this.updateDecorationsBetween(e,r,l);c>o||p<s;)if(d++%2==0&&c>o||p>=s){let t=c-o;c=Math.max(c-2e3,o),await this.updateDecorationsBetween(e,c,c+Math.min(t,2e3))}else p=Math.min(p+2e3,s),await this.updateDecorationsBetween(e,p,Math.min(p+2e3,s))}async updateDecorationsBetween(e,t,n){await this.removeDecorationsBetween(e,t,n),await this.addDecorationsBetween(e,t,n)}async addDecorationsBetween(e,t,n){let{selection:a}=e.state,{matches:i,decorationSet:o}=D(e.state);if(0===i.length)return;let s=i.filter(e=>e.start>=t&&(void 0===n||e.start<n)),r=i.find(e=>e.start>=a.from),l=s.findIndex(e=>e===r);return await this.batchRequests(e=>{let t=s.slice(e,e+100);if(0===t.length)return!1;let n=l>=e&&l<e+100;r&&n&&k(o,r)&&(t.splice(l%100,1),n=!1),this.addDecorations&&this.addDecorations(T(n?l%100:-1,t))},{increment:100,until:s.length})}async removeDecorationsBetween(e,t,n){let{decorationSet:a}=D(e.state),i=a.find(t,n);if(0!==i.length)return await this.batchRequests(e=>{let n=i.slice(e,e+100);if(0===n.length)return!1;for(let e=0;e<n.length&&!(n[e].from>=t);e++)n=n.slice(1);this.removeDecorations&&this.removeDecorations(n)},{increment:100,until:i.length})}calcDecorationPositions(e,t,n){let a=t.getBoundingClientRect(),i=n.getBoundingClientRect();return{viewportStartPos:this.getStartPos(e,0,i.left),viewportEndPos:this.getEndPos(e,a.top+a.height,i.left),startPos:+!(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0),endPos:e.state.doc.nodeSize}}getStartPos(e,t,n){let a=e.posAtCoords({top:t,left:n});return(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?a?a.pos:0:a?a.pos:1}getEndPos(e,t,n){let a=e.state.doc.nodeSize,i=e.posAtCoords({top:t,left:n});return i?i.pos:a}batchRequests(e,t){let n=0,{increment:a,until:i}=t;return new Promise(t=>{let o=()=>{let s=e(n);for(;!1===s&&n<i;)n+=a,s=e(n);n<i?(n+=a,this.rafId=requestAnimationFrame(o)):(this.rafId=void 0,t())};this.rafId=requestAnimationFrame(o)})}constructor(){this.rafId=void 0,this.addDecorations=void 0,this.removeDecorations=void 0}},L=e=>(t,n,a)=>e(t,e=>{e.scrollIntoView(),n&&n(e)},a),U=()=>w(e=>{let t,n,a,{selection:o}=e;if(o instanceof i("ks2lK").TextSelection&&!o.empty){t=function(e){let t="",n=e.content().content;for(let e=0;e<n.childCount;e++)t+=n.child(e).textContent;return t}(o);let{shouldMatchCase:i,getIntl:s,api:r}=D(e);n=S({content:e.doc,searchText:t,shouldMatchCase:i,getIntl:s,api:r}),a=(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?b(o.from,n):C(o.from,n)}return{type:c.ACTIVATE,findText:t,matches:n,index:a}}),K=(e,t,n)=>L(w(a=>{let{selection:i}=a,{shouldMatchCase:o,getIntl:s,api:r}=D(a),d=void 0!==n?S({content:a.doc,searchText:n,shouldMatchCase:o,getIntl:s,api:r}):[],p=(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?b(i.from,d):C(i.from,d);return B.applyAllSearchDecorations(e,t,t=>H(t)(e.state,e.dispatch),t=>q(t)(e.state,e.dispatch)),{type:c.FIND,findText:n||"",matches:d,index:p}},(e,t)=>{let{selection:a}=t,{shouldMatchCase:i,getIntl:o,api:s}=D(t),r=void 0!==n?S({content:t.doc,searchText:n,shouldMatchCase:i,getIntl:o,api:s}):[];if(r.length>0){let t=(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?b(a.from,r):C(a.from,r),n=N(e.selection,e.doc,t,r);return(0,d.expValEqualsNoExposure)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&s?.expand?.commands.toggleExpandWithMatch(n)({tr:e}),e.setSelection(n)}return e})),F=e=>L(w(e=>G(e,"next"),(e,t)=>{let{matches:n,index:a,api:i}=D(t),o=C(t.selection.from,n);o===a&&(o=v(o,n.length));let s=N(e.selection,e.doc,o,n);return(0,d.expValEqualsNoExposure)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&i?.expand?.commands.toggleExpandWithMatch(s)({tr:e}),e.setSelection(s)})),j=e=>L(w(e=>G(e,"previous"),(e,t)=>{let{matches:n,api:a}=D(t),i=C(t.selection.from,n,!0),o=N(e.selection,e.doc,i,n);return(0,d.expValEqualsNoExposure)("platform_editor_toggle_expand_on_match_found","isEnabled",!0)&&a?.expand?.commands.toggleExpandWithMatch(o)({tr:e}),e.setSelection(o)})),G=(e,t)=>{let n=D(e),{matches:a,findText:i}=n,{decorationSet:o,index:s}=n;if(i){let n=C(e.selection.from,a,"previous"===t);o=$(e,s=s===n?"next"===t?v(s,a.length):I(s,a.length):n)}return{type:"next"===t?c.FIND_NEXT:c.FIND_PREVIOUS,index:s,decorationSet:o}},V=e=>L(w(t=>{let n=D(t),{findText:a,matches:i}=n,{decorationSet:o,index:s}=n;return o=$(t,v(s,i.length)),-1===e.toLowerCase().indexOf(a.toLowerCase())?(o=A(o,[i[s]],t.doc),i.splice(s,1),s>i.length-1&&(s=0)):s=v(s,i.length),{type:c.REPLACE,replaceText:e,decorationSet:o,matches:i,index:s}},(t,n)=>{let{matches:a,index:i,findText:o}=D(n);if(a[i]){if(!a[i].canReplace&&(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0))return t;let{start:n,end:s}=a[i],r=v(i,a.length);t.insertText(e,n,s).setSelection(N(t.selection,t.doc,r,a,0===r?0:e.length-o.length))}return t})),z=e=>w({type:c.REPLACE_ALL,replaceText:e,decorationSet:i("ftzrq").DecorationSet.empty,matches:[],index:0},(t,n)=>(D(n).matches.forEach(n=>{if(!n.canReplace&&(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0))return t;t.insertText(e,t.mapping.map(n.start),t.mapping.map(n.end))}),t.setMeta("scrollIntoView",!1),t)),H=e=>w(t=>{let{decorationSet:n}=D(t);return{type:c.UPDATE_DECORATIONS,decorationSet:n.add(t.doc,e)}}),q=e=>w(t=>{let{decorationSet:n}=D(t);return{type:c.UPDATE_DECORATIONS,decorationSet:x(n,e,t.doc)}}),W=()=>w(()=>(B.stop(),{type:c.CANCEL})),X=()=>w({type:c.BLUR}),Y=()=>w({type:c.TOGGLE_MATCH_CASE}),$=(e,t)=>{let{index:n,matches:a}=D(e),{decorationSet:i}=D(e),o=a[n],s=a[t];if(n===t)return i;let r=k(i,o),l=k(i,s),d=[];return r&&d.push(r),l&&d.push(l),d.length>0&&(d.sort((e,t)=>e.from<t.from?-1:1),i=x(i,d,e.doc)),o&&(i=i.add(e.doc,[_(o)])),s&&(i=i.add(e.doc,[_(s,!0)])),i},J=e=>({triggerMethod:t})=>(0,i("dAtrv").withAnalytics)(e,e=>({eventType:i("d925B").EVENT_TYPE.UI,action:i("d925B").ACTION.ACTIVATED,actionSubject:i("d925B").ACTION_SUBJECT.FIND_REPLACE_DIALOG,attributes:{inputMethod:e.selection instanceof i("ks2lK").TextSelection&&!e.selection.empty?i("d925B").INPUT_METHOD.PREFILL:i("d925B").INPUT_METHOD.KEYBOARD,triggerMethod:t}}))(U()),Z=e=>({editorView:t,containerElement:n,keyword:a})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.FIND_PERFORMED,actionSubject:i("d925B").ACTION_SUBJECT.TEXT})(K(t,n,a)),Q=(e,t)=>({triggerMethod:n})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.FIND_NEXT_PERFORMED,actionSubject:i("d925B").ACTION_SUBJECT.TEXT,attributes:{triggerMethod:n}})(F(t)),ee=(e,t)=>({triggerMethod:n})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.FIND_PREV_PERFORMED,actionSubject:i("d925B").ACTION_SUBJECT.TEXT,attributes:{triggerMethod:n}})(j(t)),et=e=>({triggerMethod:t,replaceText:n})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.REPLACED_ONE,actionSubject:i("d925B").ACTION_SUBJECT.TEXT,attributes:{triggerMethod:t}})(V(n)),en=e=>({replaceText:t})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.REPLACED_ALL,actionSubject:i("d925B").ACTION_SUBJECT.TEXT})(z(t)),ea=e=>({triggerMethod:t})=>(0,i("dAtrv").withAnalytics)(e,{eventType:i("d925B").EVENT_TYPE.UI,action:i("d925B").ACTION.DEACTIVATED,actionSubject:i("d925B").ACTION_SUBJECT.FIND_REPLACE_DIALOG,attributes:{triggerMethod:t}})(W()),ei=e=>(t,n)=>(J(e)({triggerMethod:i("d925B").TRIGGER_METHOD.SHORTCUT})(t,n),!0);var eo=e=>{let t={};return(0,i("hgeg8").bindKeymapWithCommand)(i("hgeg8").find.common,ei(e),t),(0,i("dus6D").keymap)(t)},es=i("42omo");i("42omo");var er=i("jSnXV");class el extends e(es).PureComponent{render(){let{title:e,icon:t,iconSize:n,keymapDescription:a,disabled:o,isPressed:r,appearance:l}=this.props,d={..."boolean"==typeof r&&{"aria-pressed":r}};return(0,s.jsx)(i("3gadb").default,{content:(0,s.jsx)(i("hgeg8").ToolTipContent,{description:e,keymap:(0,i("hgeg8").findKeymapByDescription)(a)}),hideTooltipOnClick:!0,position:"top",children:(0,s.jsx)(i("1qfLF").default,{id:"afterInputSection",label:e,appearance:l,testId:e,ref:this.buttonRef,icon:e=>(0,s.jsx)(t,{...e,size:n}),isDisabled:o,onClick:this.handleClick,isSelected:r,...d})})}constructor(...t){super(...t),this.buttonRef=e(es).createRef(),this.handleClick=()=>{this.props.onClick(this.buttonRef)}}}el.defaultProps={keymapDescription:"no-keymap",appearance:"subtle"};let ed=(0,i("9K4OG").css)({width:"100%",border:"none",backgroundColor:`var(--ds-border, ${i("6fnsQ").N30A})`,margin:"var(--ds-space-050, 4px) 0px",height:"1px",borderRadius:"var(--ds-border-width, 1px)"}),ec=(0,i("9K4OG").css)({display:"flex",flexDirection:"column","> *:not(#replace-hr-element)":{margin:"0px var(--ds-space-050, 4px)"}}),ep=(0,i("9K4OG").css)({padding:"var(--ds-space-050, 4px) var(--ds-space-050, 4px)"}),eu={name:"7ag069",styles:"display:flex;& > *{display:inline-flex;height:32px;flex:0 0 auto;}& > [data-ds--text-field--container]{display:flex;flex:1 1 auto;}"},eh={name:"14m6ydf",styles:"display:flex;padding:var(--ds-space-100, 8px);& > *{height:unset;}"};(0,i("9K4OG").css)({justifyContent:"space-between",fontSize:(0,i("aFUXX").relativeFontSizeToBase16)(14)});let em=(0,i("9K4OG").css)({flex:"1 100%",flexWrap:"wrap","#find-text-field, #replace-text-field":{height:"2.5714285714285716em"},label:{fontSize:(0,i("aFUXX").relativeFontSizeToBase16)(14),lineHeight:"16px"}}),ef={name:"pxta9y",styles:"display:flex;flex:0 0 auto;align-items:center"},eg={name:"1v69wxd",styles:"padding-right:var(--ds-space-100, 8px);button{width:20px;height:20px;}"};(0,i("9K4OG").css)({padding:"0px var(--ds-space-025, 2px)"});let eT=(0,i("9K4OG").css)({color:"var(--ds-text-subtlest, #626F86)",fontSize:`${(0,i("aFUXX").relativeFontSizeToBase16)(12)}`,flex:"0 0 auto",justifyContent:"center",alignItems:"center",marginLeft:"var(--ds-space-050, 4px)",marginRight:"var(--ds-space-100, 8px)"}),eE={name:"1bc3mbb",styles:"display:inline-flex;height:32px"};(0,i("9K4OG").css)({order:"0",marginInline:"var(--ds-space-050, 4px) var(--ds-space-025, 2px)"});class ey extends e(es).Component{componentDidMount(){this.props.onFindTextfieldRefSet(this.findTextfieldRef),this.props.findText||((0,i("dh538").fg)("platform_editor_a11y_find_replace_focus_fix")?setTimeout(()=>{this.focusFindTextfield()},100):this.focusFindTextfield()),this.syncFindText(()=>{this.props.findText&&this.focusFindTextfield()})}componentDidUpdate(e){this.props.findText===this.state?.localFindText&&this.focusFindTextfield(),this.props.findText!==e.findText&&this.props.shouldFocus&&this.syncFindText(()=>{this.props.findText&&this.focusFindTextfield()})}componentWillUnmount(){this.debouncedFind.cancel(),this.handleFindKeyDownThrottled.cancel()}render(){let{findText:e,count:t,shouldMatchCase:n,intl:{formatMessage:a}}=this.props,o=a(i("lzn6v").findReplaceMessages.resultsCount,{selectedMatchPosition:t.index+1,totalResultsCount:t.total}),s=(0,i("9K4OG").jsx)("div",{css:ef},(0,i("9K4OG").jsx)("div",{"aria-live":"polite"},e&&(0,i("9K4OG").jsx)("span",{"data-testid":"textfield-count",css:[eT,eE]},0===t.total?this.noResultsFound:o)),(0,i("9K4OG").jsx)("div",{css:eg},(0,i("9K4OG").jsx)(el,{title:this.matchCase,appearance:"default",icon:this.matchCaseIconEle,iconLabel:this.matchCase,onClick:this.handleMatchCaseClick,isPressed:n})));return(0,i("9K4OG").jsx)("div",{css:[eu,eh]},(0,i("9K4OG").jsx)("div",{css:em},(0,i("9K4OG").jsx)(i("bfgIy").Label,{htmlFor:"find-text-field"},this.find),(0,i("9K4OG").jsx)(i("4noo5").default,{name:"find",id:"find-text-field",testId:"find-field",appearance:"standard",value:this.state.localFindText,ref:this.findTextfieldRef,autoComplete:"off",onChange:this.handleFindChange,onKeyDown:this.handleFindKeyDown,onKeyUp:this.handleFindKeyUp,onBlur:this.props.onFindBlur,onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,elemAfterInput:s})))}constructor(t){super(t),this.findTextfieldRef=e(es).createRef(),this.isComposing=!1,this.find=void 0,this.noResultsFound=void 0,this.matchCase=void 0,this.syncFindText=e=>{this.isComposing||this.props.findText===this.state?.localFindText||this.updateFindValue(this.props.findText||"",e)},this.focusFindTextfield=()=>{let e=this.findTextfieldRef.current;this.props.shouldFocus&&e&&e.select()},this.handleFindChange=e=>{this.updateFindValue(e.target.value)},this.debouncedFind=e(er)(e=>{this.props.onFind(e)},100),this.updateFindValue=(e,t)=>{this.setState({localFindText:e},()=>{this.isComposing||(t&&t(),this.debouncedFind(e))}),this.props.setFindTyped(!0)},this.handleFindKeyDownThrottled=(0,i("2P8Ax").default)(e=>{"Enter"===e.key?e.shiftKey?this.props.onFindPrev({triggerMethod:i("d925B").TRIGGER_METHOD.KEYBOARD}):this.props.onFindNext({triggerMethod:i("d925B").TRIGGER_METHOD.KEYBOARD}):"ArrowDown"===e.key&&this.props.onArrowDown()}),this.handleFindKeyDown=e=>{this.isComposing||(e.persist(),this.handleFindKeyDownThrottled(e))},this.handleFindKeyUp=()=>{this.handleFindKeyDownThrottled.cancel()},this.handleFindNextClick=e=>{this.isComposing||this.props.onFindNext({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON})},this.handleFindPrevClick=e=>{this.isComposing||this.props.onFindPrev({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON})},this.handleCompositionStart=()=>{this.isComposing=!0},this.handleCompositionEnd=e=>{this.isComposing=!1,this.updateFindValue(e.target.value)},this.clearSearch=()=>{this.props.onCancel({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON})},this.handleMatchCaseClick=e=>{this.props.onToggleMatchCase&&(this.props.onToggleMatchCase(),this.props.onFind(this.props.findText))},this.matchCaseIconEle=t=>(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?(0,i("9K4OG").jsx)(e(i("1FOj2")),{label:t.label,size:"small"}):(0,i("9K4OG").jsx)(e(i("5gydP")),{label:this.matchCase});let{intl:{formatMessage:n}}=t;this.find=n(i("lzn6v").findReplaceMessages.find),this.noResultsFound=n(i("lzn6v").findReplaceMessages.noResultsFound),this.matchCase=n(i("lzn6v").findReplaceMessages.matchCase),this.state={localFindText:""}}}var e_=(0,i("gmMgo").default)(ey);let eS=(0,i("ecnYn").xcss)({padding:"space.100"}),eb=(0,i("ecnYn").xcss)({paddingBottom:"space.050"}),eC=(0,i("ecnYn").xcss)({paddingTop:"space.200"}),ev=(0,i("ecnYn").xcss)({justifyContent:"space-between",flexDirection:"row-reverse"}),eI=(0,i("ecnYn").xcss)({justifyContent:"space-between",flexDirection:"row-reverse",flexWrap:"wrap"}),eN=(0,i("ecnYn").xcss)({gap:"space.075"}),ek=(0,i("ecnYn").xcss)({marginRight:"auto"});var ex=(0,i("gmMgo").default)(({canReplace:t,replaceText:n,onReplace:a,onReplaceAll:o,onReplaceTextfieldRefSet:r,onArrowUp:d,onCancel:c,count:p,onFindNext:u,onFindPrev:h,dispatchAnalyticsEvent:m,setFindTyped:f,findTyped:g,focusToolbarButton:T,intl:{formatMessage:E}})=>{let[y,_]=(0,es.useState)(n||""),[S,b]=(0,es.useState)(!1),[C,v]=(0,es.useState)(!1),[I,N]=(0,es.useState)(!1),[k,x]=(0,es.useState)(0),A=(0,es.useRef)(null),O=(0,es.useRef)(null),P=E(i("lzn6v").findReplaceMessages.replaceWith),M=E(i("lzn6v").findReplaceMessages.replaceAll),w=E(i("lzn6v").findReplaceMessages.findPrevious),D=E(i("lzn6v").findReplaceMessages.closeFindReplaceDialog);(0,es.useEffect)(()=>{r(A)},[r]),(0,es.useEffect)(()=>{_(n||"")},[n]);let R=e=>{S||e()},B=e=>{if(k===e&&N(!I),O.current){let e=O.current.querySelector('[aria-live="polite"]');e?.removeAttribute("aria-live"),e?.setAttribute("aria-live","polite")}},L=e=>{m&&m({eventType:i("d925B").EVENT_TYPE.TRACK,action:i("d925B").ACTION.CHANGED_REPLACEMENT_TEXT,actionSubject:i("d925B").ACTION_SUBJECT.FIND_REPLACE_DIALOG}),_(e)},U=()=>{c({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON}),T()},K=E(i("lzn6v").findReplaceMessages.replaceSuccess,{numberOfMatches:k});return(0,s.jsxs)(i("6f0Oj").default,{xcss:eS,children:[(0,s.jsx)(i("6f0Oj").default,{xcss:eb,children:(0,s.jsx)(i("5dK2X").default,{id:"replace-text-field-label",size:"medium",weight:"bold",color:"color.text.subtle",children:P})}),(0,s.jsx)(i("4noo5").default,{name:"replace","aria-labelledby":"replace-text-field-label",testId:"replace-field",appearance:"standard",defaultValue:y,ref:A,autoComplete:"off",onChange:e=>R(()=>{L(e.target.value)}),onKeyDown:e=>R(()=>{"Enter"===e.key?a({triggerMethod:i("d925B").TRIGGER_METHOD.KEYBOARD,replaceText:y}):"ArrowUp"===e.key&&d()}),onCompositionStart:()=>{b(!0)},onCompositionEnd:e=>{b(!1),L(e.target.value)}}),C&&!g&&(0,s.jsx)("div",{ref:O,children:(0,s.jsx)(i("gQhRa").ValidMessage,{testId:"message-success-replacement",children:I?K.replace(/ /u,""):K})}),(0,s.jsx)(i("6f0Oj").default,{xcss:eC,children:(0,s.jsxs)(i("dcJ7R").default,{xcss:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?[eN,eI]:[eN,ev],children:[(0,s.jsxs)(i("dcJ7R").default,{xcss:eN,children:[(0,s.jsx)(el,{title:E(i("lzn6v").findReplaceMessages.findNext),icon:t=>(0,s.jsx)(e(i("ghftu")),{label:t.label,size:"small"}),iconLabel:E(i("lzn6v").findReplaceMessages.findNext),keymapDescription:"Enter",onClick:()=>{S||u({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON})},disabled:p.total<=1}),(0,s.jsx)(el,{title:w,icon:t=>(0,s.jsx)(e(i("2AytZ")),{label:t.label,size:"small"}),iconLabel:w,keymapDescription:"Shift Enter",onClick:()=>{S||h({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON})},disabled:p.total<=1}),(0,s.jsx)(i("ccHMk").default,{testId:"Replace",id:"replace-button",onClick:()=>R(()=>{a({triggerMethod:i("d925B").TRIGGER_METHOD.BUTTON,replaceText:y}),B(1),v(!0),x(1),f(!1)}),isDisabled:!t,children:E(i("lzn6v").findReplaceMessages.replace)}),(0,s.jsx)(i("ccHMk").default,{appearance:"primary",testId:M,id:"replaceAll-button",onClick:()=>R(()=>{o({replaceText:y}),v(!0),p.totalReplaceable&&(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?(B(p.totalReplaceable),x(p.totalReplaceable)):(B(p.total),x(p.total)),f(!1)}),isDisabled:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?0===p.totalReplaceable:!t,children:M})]}),(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?(0,s.jsx)(i("dcJ7R").default,{xcss:ek,children:(0,s.jsx)(i("ccHMk").default,{appearance:"subtle",testId:D,onClick:U,children:D})}):(0,s.jsx)(i("ccHMk").default,{appearance:"subtle",testId:D,onClick:U,children:D})]})})]})});class eA extends e(es).PureComponent{render(){let{findText:e,count:t,isReplaceable:n,shouldFocus:a,onFind:o,onFindBlur:s,onFindNext:r,onFindPrev:d,onCancel:c,replaceText:p,onReplace:u,onReplaceAll:h,dispatchAnalyticsEvent:m,allowMatchCase:f,shouldMatchCase:g,onToggleMatchCase:T,intl:E}=this.props,y=this.props.focusToolbarButton||(()=>{});return(0,i("9K4OG").jsx)("div",{role:"dialog","aria-label":(0,i("dh538").fg)("platform_editor_dec_a11y_fixes")?E?.formatMessage(i("lzn6v").findReplaceMessages.findReplaceDialogAriaLabel):"Find and Replace","aria-modal":!1,ref:this.modalRef,css:[ec,ep]},(0,i("9K4OG").jsx)(e_,{allowMatchCase:f,shouldMatchCase:g,onToggleMatchCase:T,findText:e,count:t,shouldFocus:a,onFind:o,onFindBlur:s,onFindPrev:d,onFindNext:r,onFindTextfieldRefSet:this.setFindTextfieldRef,onCancel:c,onArrowDown:this.setFocusToReplace,findTyped:this.state.findTyped,setFindTyped:this.setFindTyped}),(0,i("9K4OG").jsx)("hr",{role:"presentation",css:ed,id:"replace-hr-element"}),(0,i("9K4OG").jsx)(ex,{canReplace:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?!!n:t.total>0,replaceText:p,onReplace:u,onReplaceAll:h,onReplaceTextfieldRefSet:this.setReplaceTextfieldRef,onArrowUp:this.setFocusToFind,onCancel:c,count:t,onFindPrev:d,onFindNext:r,dispatchAnalyticsEvent:m,findTyped:this.state.findTyped,setFindTyped:this.setFindTyped,focusToolbarButton:y}))}constructor(t){super(t),this.findTextfield=null,this.replaceTextfield=null,this.modalRef=void 0,this.state={findTyped:!1},this.setFindTyped=e=>{this.setState({findTyped:e})},this.setFindTextfieldRef=e=>{this.findTextfield=e.current},this.setReplaceTextfieldRef=e=>{this.replaceTextfield=e.current},this.setFocusToFind=()=>{this.findTextfield&&this.findTextfield.focus()},this.setFocusToReplace=()=>{this.replaceTextfield&&this.replaceTextfield.focus()},this.modalRef=e(es).createRef()}}let eO=(0,i("ecnYn").xcss)({display:"flex",flexDirection:"column"});var eP=(0,i("gmMgo").default)(e=>{let{findText:t,replaceText:n,isActive:a,index:o,numMatches:r,popupsMountPoint:l,numReplaceable:d,onCancel:c}=e;return l?(0,s.jsx)(i("6qITU").default,{target:l,mountTo:l,forcePlacement:!0,alignX:"right",alignY:"start",offset:[4,0],isOpen:a,handleEscapeKeydown:()=>{a&&c({triggerMethod:i("d925B").TRIGGER_METHOD.KEYBOARD})},fitWidth:382,zIndex:i("aFUXX").akEditorFloatingPanelZIndex,arrowKeyNavigationProviderOptions:{type:i("5v8Ta").ArrowKeyNavigationType.MENU,disableArrowKeyNavigation:!0},children:(0,s.jsx)(i("6f0Oj").default,{xcss:eO,children:(0,s.jsx)(eA,{findText:t,replaceText:n,count:{index:o,total:r,totalReplaceable:d},...e})})}):null});let eM=(0,i("9K4OG").css)("display:flex;flex:1 1 auto;flex-grow:0;justify-content:flex-end;align-items:center;padding:0 var(--ds-space-100, 8px);@media (max-width: ",i("aFUXX").akEditorMobileMaxWidth,"px){justify-content:center;padding:0;}"),ew=({isButtonHidden:e,children:t})=>(0,i("9K4OG").jsx)("div",{css:(0,i("9K4OG").css)({display:e?"none":"block"})},t),eD={name:"1ff36h2",styles:"flex-grow:1"},eR={name:"n1rao0",styles:"flex-grow:0;padding:0"},eB={name:"1fttcpj",styles:"display:flex;flex-direction:column"};class eL extends e(es).PureComponent{render(){let{popupsMountPoint:t,popupsBoundariesElement:n,popupsScrollableElement:a,isReducedSpacing:o,findText:s,replaceText:r,isActive:l,index:d,numMatches:c,numReplaceable:p,intl:{formatMessage:u},takeFullWidth:h,isButtonHidden:m=!1}=this.props,f=u(i("lzn6v").findReplaceMessages.findReplaceToolbarButton),g=i("aFUXX").akEditorFloatingPanelZIndex-1,T=(0,i("hgeg8").findKeymapByDescription)("Find");return(0,i("9K4OG").jsx)("div",{css:[eM,h&&eD,m&&(0,i("dh538").fg)("platform_editor_toolbar_responsive_fixes")&&eR]},(0,i("9K4OG").jsx)(i("6qITU").default,{mountTo:t,boundariesElement:n,scrollableElement:a,isOpen:l,handleEscapeKeydown:()=>{l&&(this.props.onCancel({triggerMethod:i("d925B").TRIGGER_METHOD.KEYBOARD}),this.state.openedByClick&&this.toolbarButtonRef.current&&this.toolbarButtonRef.current.focus(),this.setState({openedByClick:!1}))},fitWidth:382,zIndex:g,arrowKeyNavigationProviderOptions:{type:i("5v8Ta").ArrowKeyNavigationType.MENU,disableArrowKeyNavigation:!0},trigger:(0,i("dh538").fg)("platform_editor_toolbar_responsive_fixes")?(0,i("9K4OG").jsx)(ew,{isButtonHidden:m},(0,i("9K4OG").jsx)(i("a4eZN").default,{buttonId:i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.FIND_REPLACE,testId:`editor-toolbar__${i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.FIND_REPLACE}`,spacing:o?"none":"default",selected:l,title:(0,i("9K4OG").jsx)(i("hgeg8").ToolTipContent,{description:f,keymap:T}),iconBefore:(0,i("9K4OG").jsx)(e(i("jEno1")),{label:f,spacing:"spacious"}),onClick:this.toggleOpen,"aria-expanded":l,"aria-haspopup":!0,"aria-label":T?(0,i("hgeg8").tooltip)(T,f):f,"aria-keyshortcuts":(0,i("hgeg8").getAriaKeyshortcuts)(T),ref:this.toolbarButtonRef})):(0,i("9K4OG").jsx)(i("a4eZN").default,{buttonId:i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.FIND_REPLACE,testId:`editor-toolbar__${i("8TW6I").TOOLBAR_ACTION_SUBJECT_ID.FIND_REPLACE}`,spacing:o?"none":"default",selected:l,title:(0,i("9K4OG").jsx)(i("hgeg8").ToolTipContent,{description:f,keymap:T}),iconBefore:(0,i("9K4OG").jsx)(e(i("jEno1")),{label:f,spacing:"spacious"}),onClick:this.toggleOpen,"aria-expanded":l,"aria-haspopup":!0,"aria-label":T?(0,i("hgeg8").tooltip)(T,f):f,"aria-keyshortcuts":(0,i("hgeg8").getAriaKeyshortcuts)(T),ref:this.toolbarButtonRef})},(0,i("9K4OG").jsx)("div",{css:eB},(0,i("9K4OG").jsx)(eA,{findText:s,replaceText:r,count:{index:d,total:c,totalReplaceable:p},focusToolbarButton:this.focusToolbarButton,...this.props}))))}constructor(...t){super(...t),this.state={openedByClick:!1},this.toggleOpen=()=>{this.props.isActive?this.props.onCancel({triggerMethod:i("d925B").TRIGGER_METHOD.TOOLBAR}):(this.setState({openedByClick:!0}),this.props.onActivate())},this.focusToolbarButton=()=>{this.state.openedByClick&&this.toolbarButtonRef.current&&this.toolbarButtonRef.current.focus(),this.setState({openedByClick:!1})},this.toolbarButtonRef=e(es).createRef()}}var eU=(0,i("gmMgo").default)(eL);let eK=e=>{let[t,n]=(0,es.useState)(e?.findReplace?.sharedState.currentState());return(0,es.useLayoutEffect)(()=>{let t=e?.findReplace?.sharedState.onChange(({nextSharedState:e})=>{n(e)});return()=>{t?.()}},[e]),{findReplaceState:t}};var eF=e(es).memo(({popupsBoundariesElement:e,popupsMountPoint:t,popupsScrollableElement:n,isToolbarReducedSpacing:a,editorView:o,containerElement:r,dispatchAnalyticsEvent:d,takeFullWidth:c,api:p,isButtonHidden:u,doesNotHaveButton:h})=>{let m=p?.analytics?.actions,{findReplaceState:f}=eK(p),g=f?.shouldMatchCase,T=f?.isActive,E=f?.findText,y=f?.replaceText,_=f?.index,S=f?.matches,b=f?.shouldFocus;if(!o)return null;let C=e=>{let t=document.activeElement;o.focus(),e(),t?.focus()},v=e=>{let{state:t,dispatch:n}=o;e(t,n)};return void 0===g||void 0===T||void 0===E||void 0===y||void 0===_||void 0===S||void 0===b?null:(0,s.jsx)(h?eP:eU,{shouldMatchCase:g,onToggleMatchCase:()=>{v(Y())},isActive:T,findText:E,index:_,numMatches:S.length,isReplaceable:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?S[_]?.canReplace:void 0,numReplaceable:(0,l.expValEquals)("platform_editor_find_and_replace_improvements","isEnabled",!0)?S.filter(e=>!0===e.canReplace).length:void 0,replaceText:y,shouldFocus:b,popupsBoundariesElement:e,popupsMountPoint:t,popupsScrollableElement:n,isReducedSpacing:!!a,dispatchAnalyticsEvent:d,onFindBlur:()=>{v(X())},onCancel:({triggerMethod:e})=>{v(ea(m)({triggerMethod:e})),o.focus()},onActivate:()=>{C(()=>v(J(m)({triggerMethod:i("d925B").TRIGGER_METHOD.TOOLBAR})))},onFind:e=>{C(()=>v(Z(m)({editorView:o,containerElement:r,keyword:e})))},onFindNext:({triggerMethod:e})=>{C(()=>v(Q(m,o)({triggerMethod:e})))},onFindPrev:({triggerMethod:e})=>{C(()=>v(ee(m,o)({triggerMethod:e})))},onReplace:({triggerMethod:e,replaceText:t})=>{C(()=>v(et(m)({triggerMethod:e,replaceText:t})))},onReplaceAll:({replaceText:e})=>{C(()=>v(en(m)({replaceText:e})))},takeFullWidth:!!c,isButtonHidden:u})});t.exports.findReplacePlugin=({config:e,api:t})=>{let n={current:null},a={current:!1},o=({popupsBoundariesElement:n,popupsMountPoint:o,popupsScrollableElement:l,isToolbarReducedSpacing:d,toolbarSize:c,editorView:p,containerElement:u,dispatchAnalyticsEvent:h})=>{if(!p)return null;let m=!!(0,i("dh538").fg)("platform_editor_toolbar_responsive_fixes")&&c<i("zMjD6").ToolbarSize.XL;return e?.twoLineEditorToolbar||a.current&&(0,r.editorExperiment)("platform_editor_controls","variant1")?null:(0,s.jsx)(eF,{popupsBoundariesElement:n,popupsMountPoint:o,popupsScrollableElement:l,isToolbarReducedSpacing:d,editorView:p,containerElement:u,dispatchAnalyticsEvent:h,takeFullWidth:e?.takeFullWidth,api:t,isButtonHidden:m})};return t?.primaryToolbar?.actions.registerComponent({name:"findReplace",component:o}),{name:"findReplace",pmPlugins(){let e=[{name:"findReplace",plugin:({dispatch:e,getIntl:n})=>h(e,n,t)},{name:"findReplaceKeymap",plugin:()=>eo(t?.analytics?.actions)}];return(0,r.editorExperiment)("platform_editor_controls","variant1",{exposure:!1})&&e.push({name:"findReplaceEditorViewReferencePlugin",plugin:()=>new(0,i("1S4f7").SafePlugin)({view:e=>(n.current=e,{destroy:()=>{n.current=null}})})}),e},getSharedState(e){if(e)return p.getState(e)||void 0},actions:{registerToolbarButton:({popupsBoundariesElement:e,popupsMountPoint:n,popupsScrollableElement:i,editorView:o,containerElement:l,dispatchAnalyticsEvent:d,isToolbarReducedSpacing:c})=>(a.current=(0,r.editorExperiment)("platform_editor_controls","variant1"),(0,s.jsx)(eF,{popupsBoundariesElement:e,popupsMountPoint:n,popupsScrollableElement:i,editorView:o,containerElement:l,dispatchAnalyticsEvent:d,isToolbarReducedSpacing:c,api:t})),activateFindReplace:e=>{if(!n.current)return!1;let{state:a,dispatch:o}=n.current;return t?.analytics?.actions?J(t?.analytics?.actions)({triggerMethod:e||i("d925B").TRIGGER_METHOD.EXTERNAL})(a,o):U()(a,o),!0}},primaryToolbarComponent:t?.primaryToolbar?void 0:o,contentComponent:(0,r.editorExperiment)("platform_editor_controls","variant1",{exposure:!0})?({editorView:n,containerElement:i,popupsMountPoint:o,popupsBoundariesElement:r,popupsScrollableElement:l,wrapperElement:d,dispatchAnalyticsEvent:c})=>{if(a.current||!n)return null;let p=o||d?.querySelector("[data-editor-container='true']");return(0,s.jsx)(eF,{popupsBoundariesElement:r,popupsMountPoint:p,popupsScrollableElement:l||i||void 0,isToolbarReducedSpacing:!1,editorView:n,containerElement:i,dispatchAnalyticsEvent:c,takeFullWidth:e?.takeFullWidth,api:t,doesNotHaveButton:!0})}:void 0}}}),o("6q6xk",function(e,t){let n=new(0,i("ks2lK").PluginKey)("fragmentMarkConsistencyPlugin"),a=e=>{let{table:t,extension:n,bodiedExtension:a,inlineExtension:i}=e.nodes;return[t,n,a,i]},o=e=>new(0,i("1S4f7").SafePlugin)({key:n,appendTransaction:(e,t,n)=>{let o=!1,s=n.tr,{fragment:r}=n.schema.marks,l=a(n.schema),d=new Set,c=new Map,p=new Set;if(e.forEach(e=>{if(e.docChanged&&"cut"!==e.getMeta("uiEvent"))for(let{node:t}of(0,i("2pjJ5").getChangedNodes)(e))l.includes(t.type)&&d.add(t)}),d.size){for(let e of(n.doc.descendants((e,t)=>{if(d.has(e))return c.set(e,t),!0;if(!l.includes(e.type))return!0;let n=e.marks.find(e=>e.type===r);return!n||(p.add(n.attrs.localId),!0)}),d)){let t=c.get(e);if(void 0===t)continue;let n=e.marks.find(e=>e.type===r);n&&p.has(n.attrs.localId)&&(s.setNodeMarkup(t,void 0,e.attrs,e.marks.map(e=>e.type!==r?e:r.create({...e.attrs,localId:i("fO7hX").uuid.generate(),name:null}))),o=!0)}if(o)return s}}});e.exports.fragmentPlugin=()=>({name:"fragmentPlugin",marks:()=>[{name:"fragment",mark:i("jTb2k").fragment}],pmPlugins:()=>[{name:"fragmentMarkConsistency",plugin:({dispatch:e})=>o(e)}]})}),o("cZifa",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"ExpandElementIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M1 3a2 2 0 0 1 2-2h12v1.5H3a.5.5 0 0 0-.5.5v12H1z" clip-rule="evenodd"/><path fill="currentcolor" fill-rule="evenodd" d="M7.48 8.42 4.61 5.67l1.04-1.08L8 6.84l2.36-2.25 1.04 1.08-2.87 2.75a.75.75 0 0 1-1.04 0M15 12H4.5v-1.5H15zm0 3H4.5v-1.5H15z" clip-rule="evenodd"/>'},e));s.displayName="ExpandElementIcon",e.exports.default=s}),o("gF8oK",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"LayoutFiveColumnsIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M0 1.75A.75.75 0 0 1 .75 1h.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1-.75-.75zm3.5 0A.75.75 0 0 1 4.25 1h.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1-.75-.75zm3.5 0A.75.75 0 0 1 7.75 1h.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1-.75-.75zm3.5 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1-.75-.75zm3.5 0a.75.75 0 0 1 .75-.75h.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-.5a.75.75 0 0 1-.75-.75z" clip-rule="evenodd"/>'},e));s.displayName="LayoutFiveColumnsIcon",e.exports.default=s}),o("2q3lZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"LayoutFourColumnsIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M0 1.75A.75.75 0 0 1 .75 1h1.375a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1-.75-.75zm4.375 0a.75.75 0 0 1 .75-.75H6.5a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75H5.125a.75.75 0 0 1-.75-.75zm4.375 0A.75.75 0 0 1 9.5 1h1.375a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75H9.5a.75.75 0 0 1-.75-.75zm4.375 0a.75.75 0 0 1 .75-.75h1.375a.75.75 0 0 1 .75.75v12.5a.75.75 0 0 1-.75.75h-1.375a.75.75 0 0 1-.75-.75z" clip-rule="evenodd"/>'},e));s.displayName="LayoutFourColumnsIcon",e.exports.default=s}),o("4ED0i",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"LayoutThreeColumnsSidebarsLeftIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M0 2.375C0 1.615.616 1 1.375 1h.75c.76 0 1.375.616 1.375 1.375v11.25c0 .76-.616 1.375-1.375 1.375h-.75C.615 15 0 14.384 0 13.625zm1.5.125v11H2v-11zM5 2.375C5 1.615 5.616 1 6.375 1h.75c.76 0 1.375.616 1.375 1.375v11.25c0 .76-.616 1.375-1.375 1.375h-.75C5.615 15 5 14.384 5 13.625zm1.5.125v11H7v-11zm3.5-.125C10 1.615 10.616 1 11.375 1h3.25C15.385 1 16 1.616 16 2.375v11.25c0 .76-.616 1.375-1.375 1.375h-3.25c-.76 0-1.375-.616-1.375-1.375zm1.5.125v11h3v-11z" clip-rule="evenodd"/>'},e));s.displayName="LayoutThreeColumnsSidebarsLeftIcon",e.exports.default=s}),o("hLZr6",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"LayoutThreeColumnsSidebarsRightIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M0 2.375C0 1.615.616 1 1.375 1h3.25C5.385 1 6 1.616 6 2.375v11.25C6 14.385 5.384 15 4.625 15h-3.25C.615 15 0 14.384 0 13.625zm1.5.125v11h3v-11zm6-.125C7.5 1.615 8.116 1 8.875 1h.75C10.385 1 11 1.616 11 2.375v11.25c0 .76-.616 1.375-1.375 1.375h-.75c-.76 0-1.375-.616-1.375-1.375zM9 2.5v11h.5v-11zm3.5-.125c0-.76.616-1.375 1.375-1.375h.75C15.385 1 16 1.616 16 2.375v11.25c0 .76-.616 1.375-1.375 1.375h-.75c-.76 0-1.375-.616-1.375-1.375zM14 2.5v11h.5v-11z" clip-rule="evenodd"/>'},e));s.displayName="LayoutThreeColumnsSidebarsRightIcon",e.exports.default=s}),o("1FOj2",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=o(i("42omo")),a=o(i("aSNrY"));function o(e){return e&&e.__esModule?e:{default:e}}let s=e=>n.default.createElement(a.default,Object.assign({name:"TextLetterCaseIcon",dangerouslySetGlyph:'<path fill="currentcolor" fill-rule="evenodd" d="M16 13h-1.5v-.38a3.1 3.1 0 0 1-1.87.63c-1.95 0-3.37-1.78-3.37-3.75s1.42-3.75 3.38-3.75c.71 0 1.35.24 1.88.63v-.63H16zm-3.37-5.75c-.94 0-1.87.91-1.87 2.25s.93 2.25 1.88 2.25 1.86-.91 1.86-2.25-.93-2.25-1.87-2.25M5.71 3.51 8.92 13H7.33l-.84-2.5H2.51L1.67 13H.09l3.2-9.49.17-.51h2.08zM3.02 9h2.96L4.5 4.61z" clip-rule="evenodd"/>'},e));s.displayName="TextLetterCaseIcon",e.exports.default=s}),t.rlb("1eO5Z");
//# sourceMappingURL=FullPageEditorComponent.edaacf05.js.map
