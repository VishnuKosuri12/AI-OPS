function e(e,t,s,r){Object.defineProperty(e,t,{get:s,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var s=globalThis.parcelRequired477,r=s.register;r("9lSmU",function(t,r){e(t.exports,"useCrossJoinNudges",()=>s("4S8ti").useCrossJoinNudges),e(t.exports,"CrossJoinNudgesWithFlags",()=>s("4S8ti").CrossJoinNudgesWithFlags),s("8AKrx"),s("4S8ti")}),r("8AKrx",function(e,t){var r=s("dIgcq"),o=s("biOtS"),n=s("hYAxW"),i=s("1Hbkf");let a="crossJoinNudgesV3",c=async({userId:e,cloudId:t,getMSRNudgeRecommendations:r})=>{let o=(0,n.withEligibilityCache)("user_is_too_new",s("aHsHn").isUserTooNew,1);if((0,i.getFeatureVisitedCount)(a)>=3)return{ineligibilityReason:"FEATURE_VISITED_COUNT_MAXED_OUT"};if((0,i.isUserOptedOut)(a))return{ineligibilityReason:"USER_HAS_OPTED_OUT"};if(await (0,s("lRCxi").isSiteOptedOut)(t))return{ineligibilityReason:"SITE_OPTED_OUT"};if(await (0,s("2RNw9").hasAccessToProduct)("jira-software",t))return{ineligibilityReason:"ALREADY_HAVE_ACCESS"};if((0,s("9wGTI").fg)("twcg-1201-cjn-pacing-eligibility-calibration")&&await o(t,e,"confluence_first_active"))return{ineligibilityReason:"USER_IS_TOO_NEW"};let c=await (0,s("69QGC").getUsersFromCollaborationGraph)("crossJoinNudgesV3",t,e);if(void 0===c||0===c.length)return{ineligibilityReason:"NO_COLLABORATORS_FOUND"};let u=await (0,s("fOoLf").getCollaboratorsWithJiraAccess)(t,c);return 0===u.length?{ineligibilityReason:"COLLABORATORS_HAVE_NO_ACCESS"}:await (0,s("iuZ4N").canUserRequestAccess)("jira-software",t)?await (0,s("150tu").isSite7DaysOld)("jira-software",t)?(0,s("6mKj3").expValEquals)("twcg-1237-msr-cjn-m2","isEnabled",!0)&&!(await r()).includes("cjn-conf-jira-v3")?{ineligibilityReason:"MSR_NUDGE_NOT_RECOMMENDED"}:{ineligibilityReason:null,collaborators:u}:{ineligibilityReason:"NEW_SITE_LESS_THAN_7_DAYS_OLD"}:{ineligibilityReason:"NOT_ELIGIBLE_FOR_REQUEST_ACCESS"}},u="crossJoinNudgesConfluenceToJpd",l=async(e,t)=>{let r=(0,n.withEligibilityCache)("user_is_too_new",s("aHsHn").isUserTooNew,1);return(0,i.getFeatureVisitedCount)(u)>=3?{eligible:!1,ineligibilityReason:"FEATURE_VISITED_COUNT_MAXED_OUT"}:(0,i.isUserOptedOut)(u)?{eligible:!1,ineligibilityReason:"USER_HAS_OPTED_OUT"}:await (0,s("lRCxi").isSiteOptedOut)(e)?{eligible:!1,ineligibilityReason:"SITE_OPTED_OUT"}:await (0,s("2RNw9").hasAccessToProduct)("jira-product-discovery",e)?{eligible:!1,ineligibilityReason:"ALREADY_HAVE_ACCESS"}:(0,s("9wGTI").fg)("twcg-1201-cjn-pacing-eligibility-calibration")&&await r(e,t,"confluence_first_active")?{eligible:!1,ineligibilityReason:"USER_IS_TOO_NEW"}:await (0,s("150tu").isSite7DaysOld)("jira-product-discovery",e)?await (0,s("iuZ4N").canUserRequestAccess)("jira-product-discovery",e)?{eligible:!0}:{eligible:!1,ineligibilityReason:"NOT_ELIGIBLE_FOR_REQUEST_ACCESS"}:{eligible:!1,ineligibilityReason:"NEW_SITE_LESS_THAN_7_DAYS_OLD"}},d=async({cloudId:e,userId:t,flags:s,createAnalyticsEvent:u,push:l,getMSRNudgeRecommendations:d})=>{let g=(0,o.getExperimentAnalytics)(a,u);try{if(!t||await (0,i.isFeatureVisited)(a))return;let p=await c({userId:t,cloudId:e,getMSRNudgeRecommendations:d});null===p.ineligibilityReason?(await (0,r.showNudgeFlag)({product:"jira-software",integration:a,userId:t,cloudId:e,collaborators:p.collaborators,createAnalyticsEvent:u,flags:s,pushRoute:l}),(0,i.increaseFeatureVisitedCount)(a),await (0,n.setHasSeenNudgeInLast7Days)()):"SITE_OPTED_OUT"===p.ineligibilityReason?(0,o.fireSiteOptedOutAnalytics)(g):"MSR_NUDGE_NOT_RECOMMENDED"===p.ineligibilityReason&&(0,o.fireMsrNotRecommendedAnalytics)(g,"cjn-conf-jira-v3")}catch(e){(0,o.fireExperimentError)(g,e)}},g=async({cloudId:e,userId:t,createAnalyticsEvent:r,getMSRNudgeRecommendations:n})=>{let a=(0,o.getExperimentAnalytics)(u,r);try{if(!t||await (0,i.isFeatureVisited)(u))return!1;let r=await l(e,t);if(!r.eligible)return"SITE_OPTED_OUT"===r.ineligibilityReason&&(0,o.fireSiteOptedOutAnalytics)(a),!1;if((0,s("6mKj3").expValEquals)("twcg-1237-msr-cjn-m2","isEnabled",!0)&&!(await n()).includes("cjn-conf-jpd"))return(0,o.fireMsrNotRecommendedAnalytics)(a,"cjn-conf-jpd"),!1;return!0}catch(e){return(0,o.fireExperimentError)(a,e),!1}},p=async({cloudId:e,userId:t,flags:a,createAnalyticsEvent:c,push:l})=>{let d=(0,o.getExperimentAnalytics)(u,c);try{if(!t)return;let o=await (0,s("69QGC").getUsersFromCollaborationGraph)(u,e,t),d=await (0,s("fOoLf").getUsersWithProductAccess)("jira-product-discovery",e,o);await (0,r.showNudgeFlag)({product:"jira-product-discovery",integration:u,userId:t,cloudId:e,collaborators:d,createAnalyticsEvent:c,flags:a,pushRoute:l}),(0,i.increaseFeatureVisitedCount)(u),await (0,n.setHasSeenNudgeInLast7Days)()}catch(e){(0,o.fireExperimentError)(d,e)}};e.exports.triggerJiraCrossJoinNudge=d,e.exports.checkJpdCrossJoinNudgeEligibility=g,e.exports.showJpdCrossJoinNudge=p}),r("69QGC",function(e,t){let s=async(e,t,s)=>{let r=await fetch("/gateway/api/collaboration/v1/collaborationgraph/user/user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({context:{contextType:e,principalId:s,siteId:t},modelRequestParams:{experience:"CgUserNearbyUser"},expanded:!0,maxNumberOfResults:50,userId:s})});return(await r.json())?.collaborationGraphEntities?.filter(e=>e?.userProfile!==void 0&&e?.userProfile?.account_type!=="app"&&e?.userProfile?.account_status!=="deactivated"&&e?.userProfile?.account_status!=="deleted").map(({userProfile:{account_id:e,name:t,picture:s}})=>({id:e,name:t,avatar:s}))};e.exports.getUsersFromCollaborationGraph=s}),r("fOoLf",function(e,t){let s=async(e,t)=>{let s=t.map(e=>e.id),r=await fetch("/gateway/api/growth/cross-join-nudges-v3/get-permitted-jira-users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cloudId:e,accountIds:s})}),o=await r.json();return t.filter(e=>o.includes(e.id))},r=async(e,t,s)=>{let r=await fetch("/gateway/api/growth/invite-on-link-insert/get-invitees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cloudId:t,product:e,accountIds:s.map(e=>e.id)})}),o=await r.json();return s.filter(e=>!o.includes(e.id))};e.exports.getCollaboratorsWithJiraAccess=s,e.exports.getUsersWithProductAccess=r}),r("dIgcq",function(e,r){var o=s("42omo"),n=s("1Hbkf"),i=s("biOtS");let a={crossJoinNudgesV3:"/jira",crossJoinNudgesConfluenceToJpd:"/jira/projects",crossJoinNudgesConfluenceToJiraMsr:"/jira",crossJoinNudgesConfluenceToJpdMsr:"/jira/projects"},c=async({product:e,integration:r,userId:c,cloudId:g,collaborators:p,createAnalyticsEvent:f,flags:m,pushRoute:h})=>{let y=(0,n.getFeatureVisitedCount)(r),E={collaborators:p.length,userId:c,featureVisitedCount:y},C=(0,i.getExperimentAnalytics)(r,f,{attributes:E}),S=async(e,t)=>{(0,i.fireFlagDismissed)(C),await t.hideFlag(e)},w=async(e,t)=>{await S(e,t),(0,i.fireFlagSnoozed)(C),(0,n.snoozeFeatureFor30Days)(r)},N=async(e,t)=>{await S(e,t),(0,i.fireUserOptedOut)(C),(0,n.setUserOptedOut)(r)};await m.showFlag({customComponent:n=>t(o).createElement(d,{id:n.id,integration:r,collaborators:p,targetProduct:e,viewCount:y,onDismiss:()=>S(n.id,m),onSnoozeAndDismiss:()=>w(n.id,m),onOptoutAndDismiss:()=>N(n.id,m),onSubmit:async()=>{try{let t=await (0,s("8YEMg").requestAccess)(e,"confluence",r,c,g,f);"ACCESS_GRANTED"===t||"ACCESS_EXISTS"===t||"APPROVED_REQUEST_EXISTS"===t?h(a[r]):"PENDING_REQUEST_CREATED"===t||"PENDING_REQUEST_EXISTS"===t?(await m.hideFlag(n.id),await u(m)):(await m.hideFlag(n.id),await l(m,e))}catch{await m.hideFlag(n.id),await l(m,e)}(0,i.fireJoinButtonClicked)(C)}})}),(0,i.fireFlagShown)(C)},u=async e=>{await e.showFlag({customComponent:r=>t(o).createElement(s("9Luz9").RequestAccessSuccessFlag,{id:r.id,onDismiss:()=>e.hideFlag(r.id)})})},l=async(e,r)=>{await e.showFlag({customComponent:n=>t(o).createElement(s("6go91").RequestAccessErrorFlag,{id:n.id,targetProduct:r,onDismiss:()=>e.hideFlag(n.id)})})};function d({...e}){let{useChoreographedRender:r}=(0,s("lsxnT").useChoreographerAssets)();return r({messageId:"cc-cross-join-nudge"})?t(o).createElement(s("3Cc3L").RequestAccessPromptFlag,e):null}e.exports.showNudgeFlag=c,e.exports.ChoreographerRequestAccessPromptFlag=d,e.exports.showSuccessFlag=u,e.exports.showErrorFlag=l}),r("8YEMg",function(e,t){let s=async(e,t,s,r,o,n)=>{let i=`ari:cloud:${e}::site/${o}`;try{let o=await fetch("/gateway/api/invitations/v1/access-requests/request",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource:i,metadata:{touchpoint:"Crossjoin Nudge",sourceProduct:t}})}),{results:a}=await o.json(),c=a[i];return n({type:"sendTrackEvent",data:{action:"requested",actionSubject:"productAccess",source:s,attributes:{userId:r,products:[e],inviteResult:[{resourceAri:i,status:c}],integration:s}}}).fire(),c}catch(e){throw n({type:"sendOperationalEvent",data:{action:"failed",actionSubject:"requestAccess",source:s,attributes:{message:String(e),details:{...e||{}}}}}).fire(),e}};e.exports.requestAccess=s}),r("6go91",function(e,r){var o=s("l998X");s("42omo");let n=(0,s("cgtv4").defineMessages)({title:{id:"cross-join-nudges.request-access-error-flag.title",defaultMessage:"We couldn't add you to {product}"},description:{id:"cross-join-nudges.request-access-error-flag.description-support-link",defaultMessage:"Try again in a few minutes. If you still aren't able to join, <a>contact support</a>."}}),i="https://support.atlassian.com/contact/",a=(0,s("51kba").withLocalIntl)(({onDismiss:e,targetProduct:r,flagComponent:a=s("eCEXz").default,...c})=>{let{formatMessage:u}=(0,s("8C5kA").default)();return(0,o.jsx)(a,{...c,icon:(0,o.jsx)(t(s("a3fRD")),{spacing:"spacious",label:"Error",color:`var(--ds-icon-danger, ${s("6fnsQ").R300})`}),onDismissed:e,title:u(n.title,{product:(0,s("6LPtl").getProductDisplayName)(r)}),description:u(n.description,{a:e=>(0,s("dh538").fg)("dst-a11y__replace-anchor-with-link__growth-groot")?(0,o.jsx)(s("2Nwuj").default,{href:i,children:e}):(0,o.jsx)("a",{href:i,children:e})})})});e.exports.RequestAccessErrorFlag=a}),r("4opcN",function(t,s){Object.defineProperty(t.exports,"__esModule",{value:!0,configurable:!0}),e(t.exports,"default",()=>r);var r={"cross-join-nudges.common.request-access-prompt-flag.description-jira-confluence-msr-nudge-no-collaborators":"Create project pages to build a shared understanding for better decision-making.","cross-join-nudges.common.request-access-prompt-flag.description-jira-confluence-msr-nudge-with-collaborators":"Organize team knowledge, capture ideas, and share requirements for your Jira projects.","cross-join-nudges.common.request-access-prompt-flag.title-jira-confluence-msr-nudge":"Join your team in using Confluence","cross-join-nudges.request-access-error-flag.description-support-link":"Try again in a few minutes. If you still aren't able to join, <a>contact support</a>.","cross-join-nudges.request-access-error-flag.title":"We couldn't add you to {product}","cross-join-nudges.request-access-prompt-flag.description-jira":"Stay on top of your tasks, unify your project workflow and track your team progress in Jira.","cross-join-nudges.request-access-prompt-flag.description-jira-galaxia":"Stay on top of your tasks, unify your space workflow and track your team progress in Jira.","cross-join-nudges.request-access-prompt-flag.description-jpd-nudge":"Prioritize ideas, share custom roadmaps, and unify your workflow from discovery to delivery.","cross-join-nudges.request-access-prompt-flag.description-loom-nudge":"Use Loom videos to summarize pages and share information.","cross-join-nudges.request-access-prompt-flag.do-not-show-again-button":"Don't show again","cross-join-nudges.request-access-prompt-flag.get-started-button":"Get started","cross-join-nudges.request-access-prompt-flag.join-button":"Join your team","cross-join-nudges.request-access-prompt-flag.not-interested-button":"Not interested","cross-join-nudges.request-access-prompt-flag.remind-me-later-button":"Remind me later","cross-join-nudges.request-access-prompt-flag.title":"Your team is now using {product}","cross-join-nudges.request-access-prompt-flag.title-jira-nudge":"Join your team in using Jira","cross-join-nudges.request-access-prompt-flag.title-jpd-nudge":"Join your team in using Jira Product Discovery","cross-join-nudges.request-access-prompt-flag.title-loom-nudge":"Join your team on Loom","cross-join-nudges.request-access-prompt-flag.title-not-interested":"Your team is waiting for you in {product}","cross-join-nudges.request-access-prompt-flag.title-reminder":"Your team is working in {product}","cross-join-nudges.request-access-success-flag.description":"You'll receive an email once they've reviewed it.","cross-join-nudges.request-access-success-flag.title":"A request was sent to your admins"}}),r("kVIRg",function(e,t){e.exports=s("4mJKd")(5)("aIwO0").then(()=>s("kJXhH"))}),r("4mJKd",function(e,t){e.exports=e=>t=>import(s("8tirZ").shardUrl(s("02nRr").resolve(t),e))}),r("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=i,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=r,e.exports.shardUrl=function(e,t){return globalThis[s]?a(e,t):e},e.exports.shardUrlUnchecked=a;let s="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function r(e,t){let s=t+1,r=e.split("").reduce((e,t)=>{let r=(e<<s)-e+t.charCodeAt(0);return r&r},0);return(r%=s)<0&&(r+=s),r}let o=/-\d+$/;function n(e){if(!o.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function i(e,t){let s=e.indexOf("."),r=0===t?"":`-${t-1}`;if(-1===s)return`${n(e)}${r}`;let o=n(e.slice(0,s));return`${o}${r}${e.slice(s)}`}function a(e,t){let s=new URL(e),o=r(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(s.pathname),t);return s.hostname=i(s.hostname,o),s.toString()}e.exports.domainShardingKey=s}),r("02nRr",function(t,s){e(t.exports,"register",()=>r,e=>r=e),e(t.exports,"resolve",()=>o,e=>o=e);var r,o,n=new Map;r=function(e,t){for(var s=0;s<t.length-1;s+=2)n.set(t[s],{baseUrl:e,path:t[s+1]})},o=function(e){var t=n.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),r("49i1r",function(e,t){e.exports=s("4mJKd")(5)("iwseV").then(()=>s("e9Wyv"))}),r("dasEj",function(e,t){e.exports=s("4mJKd")(5)("eh9w8").then(()=>s("bcTDG"))}),r("lC97I",function(e,t){e.exports=s("4mJKd")(5)("3eWGu").then(()=>s("5UXdT"))}),r("3KIQf",function(e,t){e.exports=s("4mJKd")(5)("8jVst").then(()=>s("kaCr9"))}),r("gzQK5",function(e,t){e.exports=s("4mJKd")(5)("hNk7k").then(()=>s("guYPm"))}),r("ePDTL",function(e,t){e.exports=s("4mJKd")(5)("arXo9").then(()=>s("e65rL"))}),r("jl7HU",function(e,t){e.exports=s("4mJKd")(5)("yuLnu").then(()=>s("e1RZ8"))}),r("c585o",function(e,t){e.exports=s("4mJKd")(5)("2pQv8").then(()=>s("an7BE"))}),r("jAnnr",function(e,t){e.exports=s("4mJKd")(5)("jGBo1").then(()=>s("hPdO5"))}),r("4HVkJ",function(e,t){e.exports=s("4mJKd")(5)("eUrwV").then(()=>s("9zs6n"))}),r("dcU0x",function(e,t){e.exports=s("4mJKd")(5)("2zgDh").then(()=>s("7Xwbr"))}),r("iO7I3",function(e,t){e.exports=s("4mJKd")(5)("bETPT").then(()=>s("hdK8A"))}),r("jat2x",function(e,t){e.exports=s("4mJKd")(5)("ceBZg").then(()=>s("2VxMN"))}),r("cekPs",function(e,t){e.exports=s("4mJKd")(5)("5STWe").then(()=>s("4Wh4F"))}),r("6U9LK",function(e,t){e.exports=s("4mJKd")(5)("EfE3i").then(()=>s("8O7Z4"))}),r("gVZfP",function(e,t){e.exports=s("4mJKd")(5)("hFqXA").then(()=>s("kLJGE"))}),r("emNuY",function(e,t){e.exports=s("4mJKd")(5)("4ArgV").then(()=>s("13H9y"))}),r("17t4T",function(e,t){e.exports=s("4mJKd")(5)("28EDH").then(()=>s("Uq9Kn"))}),r("hOImN",function(e,t){e.exports=s("4mJKd")(5)("k3mTs").then(()=>s("d55ia"))}),r("1Kgrq",function(e,t){e.exports=s("4mJKd")(5)("jJdZ4").then(()=>s("KN7Dc"))}),r("bybL2",function(e,t){e.exports=s("4mJKd")(5)("eZRzs").then(()=>s("iF5yO"))}),r("hzFW1",function(e,t){e.exports=s("4mJKd")(5)("bLQZ9").then(()=>s("6QVDr"))}),r("kjxkN",function(e,t){e.exports=s("4mJKd")(5)("e0E8p").then(()=>s("1N8wK"))}),r("7ttEc",function(e,t){e.exports=s("4mJKd")(5)("4DYJ5").then(()=>s("htQvj"))}),r("7OHuB",function(e,t){e.exports=s("4mJKd")(5)("hfFxJ").then(()=>s("j0WBL"))}),r("jpB0s",function(e,t){e.exports=s("4mJKd")(5)("gofGr").then(()=>s("3MhJQ"))}),r("jCWwP",function(e,t){e.exports=s("4mJKd")(5)("aSjrK").then(()=>s("2w1Sp"))}),r("lHMT3",function(e,t){e.exports=s("4mJKd")(5)("7NpX8").then(()=>s("h8y2B"))}),r("hJ9kV",function(e,t){e.exports=s("4mJKd")(5)("bFU3Y").then(()=>s("aqqCI"))}),r("5rwHI",function(e,t){e.exports=s("4mJKd")(5)("exaJ2").then(()=>s("3xPJL"))}),r("9qEKd",function(e,t){e.exports=s("4mJKd")(5)("hcCcg").then(()=>s("7MFNR"))}),r("a7JZv",function(e,t){e.exports=s("4mJKd")(5)("j9KTb").then(()=>s("5DyPd"))}),r("aD7ie",function(e,t){e.exports=s("4mJKd")(5)("3hjAq").then(()=>s("l8XHM"))}),r("bKGp5",function(e,t){e.exports=s("4mJKd")(5)("2bCHJ").then(()=>s("c3dIt"))}),r("c4Nwk",function(e,t){e.exports=s("4mJKd")(5)("fdXnq").then(()=>s("ekqU6"))}),r("6ZdFN",function(e,t){e.exports=s("4mJKd")(5)("cItJR").then(()=>s("3JMfw"))}),r("kbvK1",function(e,t){e.exports=s("4mJKd")(5)("SctKm").then(()=>s("kNuBD"))}),r("cRhRj",function(e,t){e.exports=s("4mJKd")(5)("1fJz1").then(()=>s("8WL5R"))}),r("ij8LW",function(e,t){e.exports=s("4mJKd")(5)("9yA8o").then(()=>s("hWeMa"))}),r("4AdNi",function(e,t){e.exports=s("4mJKd")(5)("448N7").then(()=>s("fyjTp"))}),r("46LQR",function(e,t){e.exports=s("4mJKd")(5)("gBDdh").then(()=>s("3DOrU"))}),r("fcybv",function(e,t){e.exports=s("4mJKd")(5)("epkdv").then(()=>s("fwHlL"))}),r("clAdA",function(e,t){e.exports=s("4mJKd")(5)("fdczG").then(()=>s("lpvU6"))}),r("1Ixw1",function(e,t){e.exports=s("4mJKd")(5)("3MGOs").then(()=>s("eefyR"))}),r("f6Mq7",function(e,t){e.exports=s("4mJKd")(5)("innCz").then(()=>s("eBv13"))}),r("ak97t",function(e,t){e.exports=s("4mJKd")(5)("ebljE").then(()=>s("8LR5Q"))}),r("glFbo",function(e,t){e.exports=s("4mJKd")(5)("j4dSZ").then(()=>s("5tR4J"))}),r("3Cc3L",function(e,r){var o=s("l998X"),n=s("42omo"),i=s("hQNhB");let a=4,c=({position:e="bottom",data:r,...c})=>{let l="top"===e?2:a,{data:d,overrides:g}=(0,n.useMemo)(()=>u({data:r,maxAvatarCount:l}),[r,l]);return(0,o.jsx)(s("2Pg7f").default,{maxCount:l,data:d,overrides:g,boundariesElement:"scrollParent",tooltipPosition:e,onMoreClick:t(i),...c})},u=({data:e,maxAvatarCount:r=a})=>{let n=e.slice(r-1);return{overrides:{MoreIndicator:{render:(e,r)=>(0,o.jsx)(s("3gadb").default,{content:n.map(e=>e.name).join(", "),position:"top",children:(0,o.jsx)(e,{...r,borderColor:"none",onClick:t(i)})})}},data:e}};s("42omo");let l=({children:e,onClick:t})=>(0,o.jsx)(s("fVUfS").default,{onClick:t,xcss:"_11c82smr _1reo15vq _18m915vq _1rjcze3t _18zrze3t _bfhksm61 _syaz13af _k48p1wq8 _p12f1w81 _9oik1r31 _1bnx8stv _jf4cnqa1",children:e}),d=(0,s("cgtv4").defineMessages)({title:{id:"cross-join-nudges.request-access-prompt-flag.title",defaultMessage:"Your team is now using {product}"},titleReminder:{id:"cross-join-nudges.request-access-prompt-flag.title-reminder",defaultMessage:"Your team is working in {product}"},titleNotInterested:{id:"cross-join-nudges.request-access-prompt-flag.title-not-interested",defaultMessage:"Your team is waiting for you in {product}"},descriptionJira:{id:"cross-join-nudges.request-access-prompt-flag.description-jira",defaultMessage:"Stay on top of your tasks, unify your project workflow and track your team progress in Jira."},joinButton:{id:"cross-join-nudges.request-access-prompt-flag.join-button",defaultMessage:"Join your team"},remindMeLaterButton:{id:"cross-join-nudges.request-access-prompt-flag.remind-me-later-button",defaultMessage:"Remind me later"},notInterestedButton:{id:"cross-join-nudges.request-access-prompt-flag.not-interested-button",defaultMessage:"Not interested"},titleJpdNudge:{id:"cross-join-nudges.request-access-prompt-flag.title-jpd-nudge",defaultMessage:"Join your team in using Jira Product Discovery"},titleJiraNudgeMsr:{id:"cross-join-nudges.request-access-prompt-flag.title-jira-nudge",defaultMessage:"Join your team in using Jira"},descriptionJpdNudge:{id:"cross-join-nudges.request-access-prompt-flag.description-jpd-nudge",defaultMessage:"Prioritize ideas, share custom roadmaps, and unify your workflow from discovery to delivery."},getStartedButton:{id:"cross-join-nudges.request-access-prompt-flag.get-started-button",defaultMessage:"Get started"},doNotShowAgainButton:{id:"cross-join-nudges.request-access-prompt-flag.do-not-show-again-button",defaultMessage:"Don't show again"},descriptionJiraGalaxia:{id:"cross-join-nudges.request-access-prompt-flag.description-jira-galaxia",defaultMessage:"Stay on top of your tasks, unify your space workflow and track your team progress in Jira."},titleJiraConfluenceMsrNudge:{id:"cross-join-nudges.common.request-access-prompt-flag.title-jira-confluence-msr-nudge",defaultMessage:"Join your team in using Confluence"},descriptionJiraConfluenceMsrNudgeNoCollaborators:{id:"cross-join-nudges.common.request-access-prompt-flag.description-jira-confluence-msr-nudge-no-collaborators",defaultMessage:"Create project pages to build a shared understanding for better decision-making."},descriptionJiraConfluenceMsrNudgeWithCollaborators:{id:"cross-join-nudges.common.request-access-prompt-flag.description-jira-confluence-msr-nudge-with-collaborators",defaultMessage:"Organize team knowledge, capture ideas, and share requirements for your Jira projects. "},titleLoomNudge:{id:"cross-join-nudges.request-access-prompt-flag.title-loom-nudge",defaultMessage:"Join your team on Loom"},descriptionLoomNudge:{id:"cross-join-nudges.request-access-prompt-flag.description-loom-nudge",defaultMessage:"Use Loom videos to summarize pages and share information."}}),g={crossJoinNudgesV3:{ctaButton:d.joinButton,remindMeLaterButton:d.remindMeLaterButton,optOutButton:d.notInterestedButton,descriptionWithCollaborators:s("c6GJD").default.getExperimentValue("project-terminology-refresh","isEnabled",!1)?d.descriptionJiraGalaxia:d.descriptionJira,descriptionWithoutCollaborators:s("c6GJD").default.getExperimentValue("project-terminology-refresh","isEnabled",!1)?d.descriptionJiraGalaxia:d.descriptionJira,title:d.title,titleReminder:d.titleReminder,titleNotInterested:d.titleNotInterested},crossJoinNudgesConfluenceToJpd:{ctaButton:d.getStartedButton,remindMeLaterButton:d.remindMeLaterButton,optOutButton:d.doNotShowAgainButton,descriptionWithCollaborators:d.descriptionJpdNudge,descriptionWithoutCollaborators:d.descriptionJpdNudge,title:d.titleJpdNudge,titleReminder:d.titleJpdNudge,titleNotInterested:d.titleJpdNudge},crossJoinNudgesJiraToConfluence:{ctaButton:d.getStartedButton,optOutButton:d.remindMeLaterButton,descriptionWithCollaborators:d.descriptionJiraConfluenceMsrNudgeWithCollaborators,descriptionWithoutCollaborators:d.descriptionJiraConfluenceMsrNudgeNoCollaborators,title:d.titleJiraConfluenceMsrNudge,titleReminder:d.titleJiraConfluenceMsrNudge,titleNotInterested:d.titleJiraConfluenceMsrNudge},crossJoinNudgesJiraToJpd:{ctaButton:d.getStartedButton,optOutButton:d.remindMeLaterButton,descriptionWithCollaborators:d.descriptionJpdNudge,descriptionWithoutCollaborators:d.descriptionJpdNudge,title:d.titleJpdNudge,titleReminder:d.titleJpdNudge,titleNotInterested:d.titleJpdNudge},crossJoinNudgesConfluenceToJiraMsr:{ctaButton:d.getStartedButton,optOutButton:d.remindMeLaterButton,descriptionWithCollaborators:d.descriptionJira,descriptionWithoutCollaborators:d.descriptionJira,title:d.titleJiraNudgeMsr,titleReminder:d.titleJiraNudgeMsr,titleNotInterested:d.titleJiraNudgeMsr},crossJoinNudgesConfluenceToJpdMsr:{ctaButton:d.getStartedButton,optOutButton:d.doNotShowAgainButton,descriptionWithCollaborators:d.descriptionJpdNudge,descriptionWithoutCollaborators:d.descriptionJpdNudge,title:d.titleJpdNudge,titleReminder:d.titleJpdNudge,titleNotInterested:d.titleJpdNudge},crossJoinNudgesConfluenceToLoom:{ctaButton:d.getStartedButton,remindMeLaterButton:d.remindMeLaterButton,optOutButton:d.notInterestedButton,descriptionWithCollaborators:d.descriptionLoomNudge,descriptionWithoutCollaborators:d.descriptionLoomNudge,title:d.titleLoomNudge,titleReminder:d.titleLoomNudge,titleNotInterested:d.titleLoomNudge}},p=(0,s("51kba").withLocalIntl)(({integration:e,collaborators:r,descriptionWithCollaborators:a=null,targetProduct:u,viewCount:d,onSubmit:p,onDismiss:f,onSnoozeAndDismiss:m,onOptoutAndDismiss:h,flagComponent:y=s("eCEXz").default,...E})=>{let C=(0,n.useCallback)(async()=>{await p()},[p]),{formatMessage:S}=(0,s("8C5kA").default)(),w=g[e],N=(0,n.useMemo)(()=>({actions:[{content:"",onClick:t(i)}],linkComponent:()=>{let e=null;return 1===d&&w.remindMeLaterButton?e=(0,o.jsx)(l,{onClick:m,children:S(w.remindMeLaterButton)}):d>1&&(e=(0,o.jsx)(l,{onClick:h,children:S(w.optOutButton)})),(0,o.jsxs)(s("u9agA").default,{alignInline:"start",grow:"fill",alignBlock:"center",separator:"Â·",space:"space.150",children:[(0,o.jsx)(l,{onClick:C,children:S(w.ctaButton)}),e]})}}),[d,C,S,w,m,h]),_=(0,n.useMemo)(()=>r.length>0?(0,o.jsx)(c,{position:"top",data:r.slice(0,10).map(e=>({name:e.name,src:e.avatar,appearance:"circle"})),boundariesElement:"scrollParent",size:"small"}):(0,o.jsx)(t(s("eXmBZ")),{color:"var(--ds-icon-information, #357DE8)",label:""}),[r]),x=S(0===d?w.title:1===d?w.titleReminder:w.titleNotInterested,{product:(0,s("6LPtl").getProductDisplayName)(u)}),b=0===r.length?S(w.descriptionWithoutCollaborators):a||S(w.descriptionWithCollaborators);return(0,o.jsx)(y,{...E,...N,onDismissed:0===d?f:m,title:x,description:(0,o.jsx)(s("gdv5Z").default,{xcss:"_1reoewfl _18m9ewfl _195gze3t _19pkze3t _otyru2gc",children:(0,o.jsx)(s("iXCQx").default,{as:"p",maxLines:3,children:b})}),icon:_})});e.exports.RequestAccessPromptFlag=p}),r("9Luz9",function(e,r){var o=s("l998X");s("42omo");let n=(0,s("cgtv4").defineMessages)({title:{id:"cross-join-nudges.request-access-success-flag.title",defaultMessage:"A request was sent to your admins"},description:{id:"cross-join-nudges.request-access-success-flag.description",defaultMessage:"You'll receive an email once they've reviewed it."}}),i=(0,s("51kba").withLocalIntl)(({onDismiss:e,flagComponent:r=s("eCEXz").default,...i})=>{let{formatMessage:a}=(0,s("8C5kA").default)();return(0,o.jsx)(r,{...i,icon:(0,o.jsx)(t(s("3sFtD")),{spacing:"spacious",label:"Success",color:"var(--ds-icon-success, #6A9A23)"}),onDismissed:e,title:a(n.title),description:a(n.description)})});e.exports.RequestAccessSuccessFlag=i}),r("1Hbkf",function(e,t){let r=async e=>{try{if(a(e)||(n(e),!a(e)))return!0;return!1}catch(e){return!0}},o=e=>parseInt(s("17wUi").confluenceLocalStorageInstance.getItem(l(e)),10)||0,n=e=>{i(e,604800)},i=(e,t)=>{s("17wUi").confluenceLocalStorageInstance.setItem(u(e),!0,t)},a=e=>s("17wUi").confluenceLocalStorageInstance.getItemAsBoolean(u(e));function c(e){switch(e){case"crossJoinNudgesV3":return s("1UApO").keys.CROSS_JOIN_NUDGES_V3_USER_OPT_OUT;case"crossJoinNudgesConfluenceToJpd":return s("1UApO").keys.CROSS_JOIN_NUDGES_JPD_USER_OPT_OUT;case"crossJoinNudgesConfluenceToJpdMsr":case"crossJoinNudgesConfluenceToJiraMsr":return s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_USER_OPT_OUT;case"crossJoinNudgesConfluenceToLoom":return s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_OPT_OUT;default:return""}}function u(e){switch(e){case"crossJoinNudgesV3":return s("1UApO").keys.CROSS_JOIN_NUDGES_V3_VISITED_KEY;case"crossJoinNudgesConfluenceToJpd":return s("1UApO").keys.CROSS_JOIN_NUDGES_JPD_VISITED_KEY;case"crossJoinNudgesConfluenceToLoom":return s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_VISITED_KEY;default:return""}}function l(e){switch(e){case"crossJoinNudgesV3":return s("1UApO").keys.CROSS_JOIN_NUDGES_V3_VISITED_COUNT;case"crossJoinNudgesConfluenceToJpd":return s("1UApO").keys.CROSS_JOIN_NUDGES_JPD_VISITED_COUNT;case"crossJoinNudgesConfluenceToJpdMsr":case"crossJoinNudgesConfluenceToJiraMsr":return s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_VISITED_COUNT;case"crossJoinNudgesConfluenceToLoom":return s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_VISITED_COUNT;default:return""}}e.exports.isFeatureVisited=r,e.exports.getFeatureVisited=a,e.exports.snoozeFeatureFor7Days=n,e.exports.getFeatureVisitedCount=o,e.exports.increaseFeatureVisitedCount=e=>{let t=o(e);s("17wUi").confluenceLocalStorageInstance.setItem(l(e),t+1)},e.exports.snoozeFeatureFor30Days=e=>{i(e,2592e3)},e.exports.setUserOptedOut=e=>{s("17wUi").confluenceLocalStorageInstance.setItem(c(e),!0)},e.exports.isUserOptedOut=e=>s("17wUi").confluenceLocalStorageInstance.getItemAsBoolean(c(e))}),r("biOtS",function(e,t){e.exports.getExperimentAnalytics=(e,t,{attributes:s={}}={})=>(r,o,n,i,a)=>t({type:r,data:{action:n,actionSubject:o,actionSubjectId:i,source:e,attributes:{...s,...a}}}).fire(),e.exports.fireExperimentError=(e,t)=>e("sendOperationalEvent","showCrossJoinNudges","failed",void 0,{message:String(t),details:{...t||{}}}),e.exports.fireFlagDismissed=e=>e("sendUIEvent","flag","dismissed","requestAccessFlag"),e.exports.fireFlagSnoozed=e=>e("sendUIEvent","flag","snoozed","requestAccessFlag"),e.exports.fireUserOptedOut=e=>e("sendUIEvent","user","optedOut","requestAccessFlag"),e.exports.fireFlagShown=e=>e("sendUIEvent","flag","shown","requestAccessFlag"),e.exports.fireJoinButtonClicked=e=>e("sendUIEvent","joinButton","clicked","requestAccessFlag"),e.exports.fireSiteOptedOutAnalytics=e=>{e("sendTrackEvent","eligibility","checked",void 0,{flagKey:"NON_CONTEXTUAL_CROSS_JOIN_NUDGES",ineligibilityReason:"SITE_OPTED_OUT"})},e.exports.fireMsrNotRecommendedAnalytics=(e,t)=>{e("sendTrackEvent","eligibility","checked",void 0,{flagKey:"NON_CONTEXTUAL_CROSS_JOIN_NUDGES",ineligibilityReason:"MSR_NOT_RECOMMENDED",nudgeId:t})},e.exports.getCustomExperimentAnalytics=(e,t,{attributes:s={}}={})=>(r,o,n,i,a)=>t({type:r,data:{action:n,actionSubject:o,actionSubjectId:i,source:e,attributes:{...s,...a}}}).fire(),e.exports.fireCustomExperimentError=(e,t,s,r,o)=>e("sendOperationalEvent",s,r,void 0,{message:String(t),details:{...t||{}},...o}),e.exports.fireMsrCjnEligibilityBlocked=(e,t)=>e("sendTrackEvent","msrCjnEligibility","blocked",void 0,{reason:t}),e.exports.fireMsrCjnEligibilityChecked=(e,t)=>e("sendTrackEvent","msrCjnEligibility","checked",void 0,t),e.exports.fireLoomCjnEligibilityChecked=(e,t)=>e("sendTrackEvent","loomCjnEligibility","checked",void 0,t)}),r("iuZ4N",function(e,t){let s=async(e,t,s,r)=>{let o=`ari:cloud:${e}::site/${t}`,n=new URLSearchParams({resource:o});try{let e=await fetch(`/gateway/api/invitations/v1/access-requests/capabilities?${n.toString()}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)if(400===e.status)return!1;else throw Error(`Unexpected response status: ${e.status}`);let t=(await e.json())?.results[o];return"DIRECT_ACCESS"===t||"REQUEST_ACCESS"===t}catch(e){throw s&&r&&s({type:"sendOperationalEvent",data:{action:"fetchError",actionSubject:"capabilitiesCheck",source:r,attributes:{message:String(e)}}}).fire(),e}};e.exports.canUserRequestAccess=s}),r("2RNw9",function(e,t){let s=async(e,t)=>{let s={permissionId:"write",resourceId:`ari:cloud:${e}::site/${t}`},r=await fetch("/gateway/api/permissions/permitted",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});return(await r.json()).permitted};e.exports.hasAccessToProduct=s}),r("150tu",function(e,t){let s=async(e,t)=>{let s=o[e]||void 0;if(!s)throw Error(`Unknown activation trait key for site product ${e}`);let r=(await i(t)).find(e=>e.name===s);if(r?.value){let e=new Date(r?.value);return e.setDate(e.getDate()+7),new Date>=e}return!1},r=async e=>{let t=o.loom||void 0;if(!t)throw Error("Unknown activation trait key for site product Loom}");let s=(await i(e)).find(e=>e.name===t);if(s?.value){let e=new Date(s?.value);return e.setDate(e.getDate()+7),new Date>=e}return!0},o={"jira-software":"jira-software.ondemand.activationDate","jira-product-discovery":"jira-product-discovery.activationDate",confluence:"confluence.ondemand.activationDate",loom:"loom.activationDate"},n=e=>`/gateway/api/tap-delivery/api/v3/personalization/site/${e}`,i=async e=>{let t=await fetch(n(e),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","x-atlassian-mau-ignore":"true"}}),{attributes:s}=await t.json();return s};e.exports.isSite7DaysOld=s,e.exports.isLoomSite7DaysOld=r}),r("aHsHn",function(e,t){let s=async(e,t,s)=>{let o=(await n(e,t)).find(e=>e.name===s);return!o||"string"!=typeof o.value||r(new Date(o.value),14)},r=(e,t)=>{let s=new Date,r=new Date(e);return r.setDate(e.getDate()+t),s<=r},o=(e,t)=>`/gateway/api/tap-delivery/api/v3/personalization/site/${e}/user/${t}`,n=async(e,t)=>{let s=await fetch(o(e,t),{method:"GET",credentials:"include",headers:{"Content-Type":"application/json","x-atlassian-mau-ignore":"true"}}),{attributes:r}=await s.json();return r};e.exports.isUserTooNew=s}),r("hYAxW",function(e,t){let r=function(e){let t=function(){let e=[],t=!1,s=()=>{if(e.length>0){let t=e.shift();t&&t()}};return{acquireLock:()=>new Promise(r=>{let o=()=>{t=!1,s()},n=()=>{t=!0,r(o)};t?e.push(()=>{n()}):n()})}}();function s(){let t=e.get();return null==t||""===t?{}:t}return{get:async e=>{let r=await t.acquireLock(),o=s()[e];if(null!=o){let{value:{value:e,ttl:t}}=o;return t&&t<Date.now()?void r():(r(),e)}r()},set:async(r,o,n)=>{let i=await t.acquireLock(),a=s(),c={value:{value:o,...n?{ttl:new Date().getTime()+864e5*n}:{}},timestamp:Date.now()};a[r]=c,e.set(a),i()},delete:async s=>{let r=await t.acquireLock(),o=e.get();delete o[s],e.set(o),r()},deleteAll:async()=>{let s=await t.acquireLock();e.delete(),s()}}}({get:()=>s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_ELIGIBILITY_KEY),set:e=>s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_ELIGIBILITY_KEY,e),delete:()=>s("17wUi").confluenceLocalStorageInstance.removeItem(s("1UApO").keys.CROSS_JOIN_NUDGES_ELIGIBILITY_KEY)}),o=function(e,t,s){return async(...o)=>{try{let t=await r.get(e);if(null!=t)return t}catch(e){}let n=await t(...o);try{await r.set(e,n,s)}catch(e){}return n}},n=async()=>(await r.set("local_storage_enabled",!0),!0===await r.get("local_storage_enabled")),i=async()=>{try{await r.set("has_seen_nudge_in_last_7_days",!0)}catch(e){}},a=async()=>{try{return!!await r.get("has_seen_nudge_in_last_7_days")}catch(e){}return!1};e.exports.cjnEligibilityCacheHandler=r,e.exports.withEligibilityCache=o,e.exports.cjnEventCacheController={get:e=>{let t=s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY);if(t)return JSON.parse(t)[e]},set:(e,t)=>{let r=JSON.parse(s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY)??"{}");r[e]=t,s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY,JSON.stringify(r))},delete:e=>{let t=s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY)??{};delete t[e],s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY,JSON.stringify(t))}},e.exports.cjnLoomEventCacheController={get:e=>{let t=s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_EVENT_CACHE_KEY);if(t)return JSON.parse(t)[e]},set:(e,t)=>{let r=JSON.parse(s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_EVENT_CACHE_KEY)??"{}");r[e]=t,s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_EVENT_CACHE_KEY,JSON.stringify(r))},delete:e=>{let t=s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_LOOM_EVENT_CACHE_KEY)??{};delete t[e],s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_EVENT_CACHE_KEY,JSON.stringify(t))}},e.exports.isCacheEnabled=n,e.exports.setHasSeenNudgeInLast7Days=i,e.exports.getHasSeenNudgeInLast7Days=a}),r("dy62u",function(e,t){var r=s("42omo");function o(e){return(t,s)=>{if(Object.prototype.hasOwnProperty.call(e,t)){let s=e[t];if("boolean"==typeof s)return s}return s}}var n=s("dQl1W");let i=({cloudId:e,product:t,subProduct:i,onNoMsrResultsReturned:a,onEligibilityReturned:c,onError:u,getFeatureVisited:l,setFeatureVisited:d,getFeatureVisitedCount:g,setFeatureVisitedCount:p,overrides:f})=>{let m=(0,r.useRef)((0,n.v4)()),h=(0,s("aV1pt").useMSRNudgeRecommendations)({product:t,sessionId:m.current,cloudId:e,subProduct:i}),{blockEligibilityUntilTomorrow:y,blockEligibilityToPreventRace:E,snooze:C}=(0,s("aV1pt").useMsrSnoozeHandler)({setFeatureVisited:d,setFeatureVisitedCount:p,getFeatureVisitedCount:g}),S=o(f);return(0,r.useCallback)(async({nudges:e})=>{try{if(S("feature_visited_too_recently",l()))return;E();let t=(await Promise.all(e.map(async e=>{let t=await e.nudgeEligibility();return c({eligibilityResult:t,key:e.nudgeKey}),{...e,...t}}))).filter(e=>e.isEligible);if(t.length<=0)return;let s=await h(),r=e.map(({nudgeKey:e})=>e);if(s.filter(e=>r.includes(e)).length<=0){y(),a();return}for(let e of s){let r=t.find(t=>t.nudgeKey===e);if(r)return C(),r.showNudge({sessionId:m.current,recommendedNudges:s})}}catch(e){y(),u(e)}},[l,h,y,E,S,C,u,a,c])};var a=s("biOtS"),c=s("hYAxW");let u=()=>{let{createAnalyticsEvent:e}=(0,s("inPa6").useAnalyticsEvents)(),t=(0,a.getCustomExperimentAnalytics)("crossJoinNudges",e);return(0,r.useCallback)(({value:e,key:s})=>{try{let r=c.cjnEventCacheController.get(s);r&&r.isEligible===e.isEligible&&r.reason===e.reason||((0,a.fireMsrCjnEligibilityChecked)(t,{...e,key:s}),c.cjnEventCacheController.set(s,e))}catch(e){}},[t])};var l=s("4smS9");let d=e=>{let t=new URLSearchParams((0,s("QU6QS").useLocation)().search).get(e),r={};return t&&t.split(",").forEach(e=>{r[e.trim()]=!1}),r},g=()=>(0,c.withEligibilityCache)("has_enrolled_msr_v1",async()=>!1)(),p=async()=>!!await (0,c.isCacheEnabled)()&&!(!await g()&&(0,l.hasSeenAnyNudgeExceptMsr)());function f(){return s("17wUi").confluenceLocalStorageInstance.getItemAsBoolean(s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_VISITED_KEY)||!1}function m(e){return s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_VISITED_KEY,!0,86400*e)}function h(){let e=Number(s("17wUi").confluenceLocalStorageInstance.getItem(s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_VISITED_COUNT));return Number.isNaN(e)?0:e}function y(e){return s("17wUi").confluenceLocalStorageInstance.setItem(s("1UApO").keys.CROSS_JOIN_NUDGES_MSR_VISITED_COUNT,e)}e.exports.setEnrolledInMsr=()=>c.cjnEligibilityCacheHandler.set("has_enrolled_msr_v1",!0),e.exports.checkMsrCrossJoinNudgeEligibility=p,e.exports.getMsrFeatureVisitedCount=h,e.exports.useRunMsrNudges=({cloudId:e,userId:t,flags:n,createAnalyticsEvent:c,push:l})=>{let g=d("cjn_msr_overrides"),p=o(g),E=(0,a.getCustomExperimentAnalytics)("crossJoinNudges",c),C=u(),S=i({cloudId:e,getFeatureVisited:f,getFeatureVisitedCount:h,onEligibilityReturned:({eligibilityResult:e,key:t})=>{C({value:e,key:t})},onNoMsrResultsReturned:()=>{(0,a.fireMsrCjnEligibilityBlocked)(E,"no recommendations")},onError:t=>{t instanceof s("aV1pt").RecommendationError?(0,a.fireCustomExperimentError)(E,t.options.cause,"msrCjnFetchRecommendation","failed",{cloudId:e}):(0,a.fireCustomExperimentError)(E,t,"executeMSRNudge","failed",{cloudId:e}),(0,a.fireMsrCjnEligibilityBlocked)(E,"unexpected error")},overrides:g,product:"confluence",subProduct:"",setFeatureVisited:m,setFeatureVisitedCount:y});return(0,r.useCallback)(async()=>{let{getNudges:r}=await s("3Ismv");return S({nudges:r({cloudId:e,userId:t,createAnalyticsEvent:c,flags:n,push:l,withOverrides:p})})},[e,t,c,n,l,S,p])}}),r("4smS9",function(e,t){var r=s("1Hbkf");let o=()=>(0,r.getFeatureVisitedCount)("crossJoinNudgesConfluenceToJpd")>0,n=()=>(0,r.getFeatureVisitedCount)("crossJoinNudgesV3")>0,i=()=>(0,r.getFeatureVisitedCount)("crossJoinNudgesConfluenceToLoom")>0;e.exports.hasSeenAnyNudgeExceptMsr=()=>!!(o()||n()||i())}),r("3Ismv",function(e,t){e.exports=s("4mJKd")(5)("7rE1n").then(()=>s("dkj8B"))}),r("fg10r",function(e,t){e.exports=s("4mJKd")(5)("b2zon").then(()=>s("3hjAC"))}),r("4S8ti",function(e,t){var r=s("42omo"),o=s("9HkI0");let n=()=>{let e=(0,r.useRef)(!1);return(0,r.useCallback)(t=>{e.current||(e.current=!0,t.fire())},[])};var i=s("dy62u"),a=s("biOtS"),c=s("hYAxW");let u=()=>{let{createAnalyticsEvent:e}=(0,s("inPa6").useAnalyticsEvents)(),t=(0,a.getCustomExperimentAnalytics)("crossJoinNudges",e);return(0,r.useCallback)(({value:e,key:s})=>{try{let r=c.cjnLoomEventCacheController.get(s);r&&r.eligible===e.eligible&&r.ineligibilityReason===e.ineligibilityReason||((0,a.fireLoomCjnEligibilityChecked)(t,{...e,key:s}),c.cjnLoomEventCacheController.set(s,e))}catch(e){}},[t])},l=({flags:e,execNudge:t=!1})=>{let{formatMessage:a}=(0,s("8C5kA").default)(),{cloudId:c,userId:l,locale:d}=(0,s("bQm3c").useSessionData)(),{createAnalyticsEvent:g}=(0,s("inPa6").useAnalyticsEvents)(),p=n(),f=n(),m=u(),{push:h}=(0,s("dPJCf").useRouteActions)(),y=(0,i.useRunMsrNudges)({cloudId:c,userId:l,flags:e,createAnalyticsEvent:g,push:h}),E=(0,s("aV1pt").useMSRNudgeRecommendations)({product:"confluence",sessionId:(0,o.v4)(),cloudId:c,subProduct:""});(0,r.useEffect)(()=>{let r=async()=>{let{checkJpdCrossJoinNudgeEligibility:t,showJpdCrossJoinNudge:r,triggerJiraCrossJoinNudge:o}=await Promise.resolve(s("8AKrx"));await t({cloudId:c,userId:l,createAnalyticsEvent:g,getMSRNudgeRecommendations:E})?await r({cloudId:c,userId:l,flags:e,createAnalyticsEvent:g,push:h}):await o({cloudId:c,userId:l,flags:e,createAnalyticsEvent:g,push:h,getMSRNudgeRecommendations:E})},o=async()=>{if(!l||!(d||"").toLowerCase().startsWith("en")||!(0,s("9wGTI").fg)("twcg-443-cjn-confluence-loom-killswitch"))return void await r();let{checkLoomCrossJoinNudgeEligibility:t,showLoomCrossJoinNudge:o}=await s("fg10r"),n=await t({cloudId:c,userId:l,createAnalyticsEvent:g});n.eligible?("not-enrolled"!==(0,s("6mKj3").expVal)("twcg-443-cjn-confluence-loom","cohort","not-enrolled")&&f(g({type:"sendTrackEvent",data:{action:"exposed",actionSubject:"confluenceToLoomNudgeFeature",source:"crossJoinNudges",attributes:{flagKey:"twcg-443-cjn-confluence-loom",cohort:(0,s("6mKj3").expVal)("twcg-443-cjn-confluence-loom","cohort","not-enrolled")}}})),await o({cloudId:c,userId:l,flags:e,createAnalyticsEvent:g,formatMessage:a})):(m({value:n,key:"cjn-conf-loom"}),await r())},n=async()=>{let{checkMsrCrossJoinNudgeEligibility:e,setEnrolledInMsr:t}=await Promise.resolve(s("dy62u"));await e()?(0,s("6mKj3").expValEquals)("twcg-437-cjn-msr-m1","cohort","variation")?(p(g({type:"sendTrackEvent",data:{action:"exposed",actionSubject:"msrCjnExperiment",source:"crossJoinNudges",attributes:{flagKey:"twcg-437-cjn-msr-m1",value:"variation"}}})),t(),await y()):((0,s("6mKj3").expValEquals)("twcg-437-cjn-msr-m1","cohort","control")&&(p(g({type:"sendTrackEvent",data:{action:"exposed",actionSubject:"msrCjnExperiment",source:"crossJoinNudges",attributes:{flagKey:"twcg-437-cjn-msr-m1",value:"control"}}})),t()),await r()):await o()},i=async()=>{await n()};t&&i()},[t,e])},d=(0,s("7aRa9").withFlags)(({flags:e,execNudge:t=!1})=>(l({flags:e,execNudge:t}),null));e.exports.useCrossJoinNudges=l,e.exports.CrossJoinNudgesWithFlags=d}),r("6LPtl",function(e,t){let s={confluence:"Confluence",jira:"Jira","jira-software":"Jira","jira-product-discovery":"Jira Product Discovery",loom:"Loom"};e.exports.getProductDisplayName=e=>s[e]}),r("51kba",function(e,t){var r=s("l998X");s("42omo");let o={...s("4yBJM").default,...s("4opcN").default},n=async e=>{try{let t=e.replace("_","-"),r=new Intl.Locale(t).toString(),[n,i]=await Promise.all([(0,s("h2Pgl").fetchLanguageFile)(r).catch(()=>({default:{}})),(0,s("h2Pgl").fetchGlobalShortcutsLanguageFile)(r).catch(()=>({default:{}}))]),a=n.default||n,c=i.default||i;return{...o,...c,...a}}catch(e){return o}},i=({children:e})=>(0,r.jsx)(s("keVvA").default,{defaultMessages:o,loaderFn:n,children:e});e.exports.withLocalIntl=function(e){return function(t){return(0,r.jsx)(i,{children:(0,r.jsx)(e,{...t})})}}}),r("aV1pt",function(e,t){var r=s("42omo");let o={0:7,1:14,2:30,3:90};class n extends Error{constructor(e,t){super(e),this.options=void 0,this.name="RecommendationError",this.options=t}}e.exports.useMsrSnoozeHandler=({setFeatureVisited:e,getFeatureVisitedCount:t,setFeatureVisitedCount:s})=>{let n=(0,r.useCallback)(()=>{e(.1)},[e]),i=(0,r.useCallback)(()=>{e(1)},[e]);return{snooze:(0,r.useCallback)(()=>{let r=t(),n=Math.min(r,Object.keys(o).length-1);e(o[n]),s(r+1)},[e,s,t]),blockEligibilityUntilTomorrow:i,blockEligibilityToPreventRace:n}},e.exports.RecommendationError=n,e.exports.useMSRNudgeRecommendations=function({product:e,sessionId:t,cloudId:o,subProduct:i}){let a=(0,r.useCallback)(()=>({product:e,useCase:"crossJoinNudgeFlags",tenantId:o,subproduct:i,sessionId:t}),[o,e,i,t]),{getRecommendations:c}=(0,s("83WWS").default)({contextResolver:a});return(0,r.useCallback)(async()=>{try{let{response:{data:e}={}}=await c({first:4,config:{cacheConfig:{ttl:86400}}});return(e??[]).map(e=>e.entityId)}catch(t){let e;throw new n("Get MSR nudge recommendations error",{cause:t instanceof Error?t:t&&t.reason?Error(t.reason):Error(String(t))})}},[c])}}),r("h2Pgl",function(e,t){s("42omo"),e.exports.fetchLanguageFile=function(e){switch(e){case"cs-CZ":case"cs":return s("kVIRg");case"da-DK":case"da":return s("49i1r");case"de-DE":case"de":return s("dasEj");case"en-GB":return s("lC97I");case"en-AU":case"en-US":case"en":default:return Promise.resolve(s("4opcN"));case"en-ZZ":return s("3KIQf");case"es-ES":case"es":return s("gzQK5");case"fi-FI":case"fi":return s("ePDTL");case"fr-FR":case"fr":return s("jl7HU");case"hu-HU":case"hu":return s("c585o");case"it-IT":case"it":return s("jAnnr");case"ja-JP":case"ja":return s("4HVkJ");case"ko-KR":case"ko":return s("dcU0x");case"nb-NB":case"nb":return s("iO7I3");case"nl-NL":case"nl":return s("jat2x");case"pl-PL":case"pl":return s("cekPs");case"pt-BR":case"pt":return s("6U9LK");case"ru-RU":case"ru":return s("gVZfP");case"sv-SE":case"sv":return s("emNuY");case"tr-TR":case"tr":return s("17t4T");case"th-TH":case"th":return s("hOImN");case"uk-UK":case"uk":return s("1Kgrq");case"vi-VI":case"vi":return s("bybL2");case"zh-TW":case"zh-HK":return s("hzFW1");case"zh-ZH":case"zh-CN":case"zh":return s("kjxkN")}},e.exports.fetchGlobalShortcutsLanguageFile=function(e){let t=e.replace("_","-"),r=t.split(/[-_]/)[0]||"en";switch(t){case"cs-CZ":case"cs":return s("7ttEc");case"da-DK":case"da":return s("7OHuB");case"de-DE":case"de":return s("jpB0s");case"en-GB":return s("jCWwP");case"en-AU":case"en-US":case"en":return Promise.resolve(s("4yBJM"));case"en-ZZ":return s("lHMT3");case"es-ES":case"es":return s("hJ9kV");case"fi-FI":case"fi":return s("5rwHI");case"fr-FR":case"fr":return s("9qEKd");case"hu-HU":case"hu":return s("a7JZv");case"it-IT":case"it":return s("aD7ie");case"ja-JP":case"ja":return s("bKGp5");case"ko-KR":case"ko":return s("c4Nwk");case"nb-NB":case"nb":return s("6ZdFN");case"nl-NL":case"nl":return s("kbvK1");case"pl-PL":case"pl":return s("cRhRj");case"pt-BR":case"pt":return s("ij8LW");case"ru-RU":case"ru":return s("4AdNi");case"sv-SE":case"sv":return s("46LQR");case"tr-TR":case"tr":return s("fcybv");case"th-TH":case"th":return s("clAdA");case"uk-UK":case"uk":return s("1Ixw1");case"vi-VI":case"vi":return s("f6Mq7");case"zh-TW":case"zh-HK":return s("ak97t");case"zh-ZH":case"zh-CN":case"zh":return s("glFbo");default:if("en"===r)return Promise.resolve(s("4yBJM"))}return Promise.resolve({default:{}})}}),r("83WWS",function(e,r){var o=s("42omo");e.exports.default=({endpoint:e="/gateway/api/graphql",contextResolver:r})=>({getRecommendations:t(o).useCallback((t,o=[])=>{let{first:n,rerank:i,config:{cacheConfig:a}={cacheConfig:void 0}}="number"==typeof t?{first:t,rerank:o}:t,c=new(0,s("kDMnZ").default)(e),u=new(0,s("egpDV").default)(new(0,s("8JRIT").RecommendationsRequestBroker)),l=(0,s("12DlI").getContext)(r);return u.fetch(c.makeRequest({contextResolver:r,first:n,rerank:i}),{cacheConfig:a?{...a,cacheName:s("lADxa").CACHE_NAME,useCase:l.useCase}:void 0})},[r,e])})}),r("lADxa",function(e,t){e.exports.CACHE_NAME="atlassian-growth-recos"}),r("12DlI",function(e,t){e.exports.getContext=function(e,t=!0){let s="function"==typeof e?e():e;if(t&&("string"!=typeof s?.useCase||s?.useCase.trim().length===0))throw Error("useCase is required");return s}}),r("kDMnZ",function(e,t){class r extends s("gBcV5").default{makeRequest(e){let{contextResolver:t,first:s,rerank:r}=e;return new Request(this.endpoint,{method:"POST",credentials:"include",mode:"cors",headers:this.getHeaders(),body:JSON.stringify({query:o,variables:{first:s,context:this.getContext(t),rerank:r}})})}}let o=`
query GrowthRecQuery($context: GrowthRecContext!, $first: Int!, $rerank: [GrowthRecRerankCandidate!]) {
  growthRecommendations {
    recommendations(context: $context, first: $first, rerank: $rerank) {
      ... on GrowthRecRecommendations {
        __typename
        data {
          __typename
          entityId
          reasons
        }
      }
      ... on QueryError {
        __typename
        identifier
        message
        extensions {
          __typename
          statusCode
          errorType
        }
      }
    }
  }
}
`;e.exports.default=r}),r("8JRIT",function(e,t){e.exports.RecommendationsRequestBroker=class{extract(e){return e?.recommendations?.data??[]}getSuccessResultCreator(e,t){return new(0,s("hvgsK").RecommendationSuccessResultCreator)(e,t)}}}),r("egpDV",function(e,t){e.exports.default=class{fetch(e,{cacheConfig:t}={}){return new Promise(async(r,o)=>{let n=await this.getResponse(e,t);if(!n.ok)return o(new(0,s("beCuV").NonOkQueryResultCreator)(n).makeQueryResult());let i=await n.json();if(i.errors)return o(new(0,s("beCuV").GeneralQueryErrorResultCreator)(i.errors).makeQueryResult());let a=i?.data?.growthRecommendations,c=this.broker.extract(a);return void 0===c?o(new(0,s("beCuV").MissingQueryDataResultCreator)(n).makeQueryResult()):r(this.broker.getSuccessResultCreator(n,c).makeQueryResult())})}async getResponse(e,t){let r=s("aU6a4").default.resolve(t),o=await r.get(e);if(o)return o;let n=e.clone();return fetch(e).then(e=>(e.ok&&r.set(n,e.clone()),e))}constructor(e){this.broker=e}}}),r("gBcV5",function(e,t){e.exports.default=class{getHeaders(){let e=new Headers;return e.append("Content-Type","application/json"),e}getContext(e){return(0,s("12DlI").getContext)(e)}constructor(e){this.endpoint=e}}}),r("hvgsK",function(e,t){class r extends s("beCuV").QuerySuccessResultCreator{makeQueryResult(){return new(0,s("beCuV").GraphQlQueryResult)(this.response.status,this.response.statusText,{data:this.data})}constructor(e,t){super(e,t),this.response=e}}e.exports.RecommendationSuccessResultCreator=r}),r("beCuV",function(e,t){class s{constructor(e,t,s){this.code=e,this.reason=t,this.response=s}}class r{}e.exports.GraphQlQueryResult=s,e.exports.NonOkQueryResultCreator=class extends r{makeQueryResult(){return new s(this.fetchResponse.status,this.fetchResponse.statusText)}constructor(e){super(),this.fetchResponse=e}},e.exports.GeneralQueryErrorResultCreator=class extends r{makeQueryResult(){let[{extensions:e}]=this.errors,[{statusCode:t,errorType:r}]=Array.isArray(e)?e:[e];return new s(t,r,{errors:this.errors.map(e=>e.message)})}constructor(e){super(),this.errors=e}},e.exports.MissingQueryDataResultCreator=class extends r{makeQueryResult(){return new s(this.fetchResponse.status,this.fetchResponse.statusText,{errors:["Received data has missing attributes"]})}constructor(e){super(),this.fetchResponse=e}},e.exports.QuerySuccessResultCreator=class extends r{constructor(e,t){super(),this.response=e,this.data=t}}}),r("aU6a4",function(e,t){e.exports.default=class{static resolve(e){return e?new(0,s("3dIYp").default)(e):new(0,s("iUvbb").default)}}}),r("iUvbb",function(e,t){e.exports.default=class{async get(e){}async set(e,t){}async delete(e){return!0}}}),r("3dIYp",function(e,t){e.exports.default=class{async get(e){if(this.supported)try{let t=await caches.open(this.cacheConfig.cacheName);if(await this.isExpired(e))return void await this.delete(e);return t.match(this.getCacheKey(e))}catch(e){this.cacheConfig.onError(e)}}async set(e,t){if(this.supported)try{let s=await caches.open(this.cacheConfig.cacheName),r=Date.now()+1e3*this.cacheConfig.ttl;await this.expiryStorage.setExpiry(this.getStoreKey(e),r),await s.put(this.getCacheKey(e),t)}catch(e){this.cacheConfig.onError(e)}}async delete(e){if(!this.supported)return!0;try{return caches.open(this.cacheConfig.cacheName).then(async t=>(await t.delete(this.getCacheKey(e)),await this.expiryStorage.deleteExpiry(this.getStoreKey(e)),!0))}catch(e){return this.cacheConfig.onError(e),!1}}async isExpired(e){try{let t=this.getStoreKey(e),s=await this.expiryStorage.getExpiry(t);return Date.now()>(s??0)}catch(e){return this.cacheConfig.onError(e instanceof Error?e:Error("Error checking expiry")),!0}}getCacheKey(e){let t=new URL(e.url);return t.searchParams.set("useCase",this.cacheConfig.useCase),t}getStoreKey(e){return this.getCacheKey(e).toString()}constructor(e){this.supported=void 0,this.expiryStorage=void 0,this.cacheConfig=void 0,this.supported="object"==typeof caches&&"function"==typeof caches.open,this.cacheConfig=new(0,s("795OW").default)(e),this.expiryStorage=new(0,s("ke6Vx").default)(this.cacheConfig)}}}),r("795OW",function(e,t){e.exports.default=class{get cacheName(){return this.cacheProviderConfig.cacheName}get useCase(){return this.cacheProviderConfig.useCase}get ttl(){return this.cacheProviderConfig.ttl??60}get onError(){return this.cacheProviderConfig.onError??(()=>{})}constructor(e){this.cacheProviderConfig=e}}}),r("ke6Vx",function(e,t){e.exports.default=class{async setExpiry(e,t){return new Promise((s,r)=>{let o=this.initDb();o.onsuccess=()=>{this.getObjectStore(o,"readwrite").put(t,e),s()},o.onerror=()=>{o.error&&r(o.error)}})}async getExpiry(e){return new Promise((t,s)=>{let r=this.initDb();r.onsuccess=()=>{let s=this.getObjectStore(r,"readonly").get(e);s.onsuccess=()=>{t(Number(s.result??0))}},r.onerror=()=>{r.error&&s(r.error)}})}async deleteExpiry(e){return new Promise((t,s)=>{let r=this.initDb();r.onsuccess=()=>{this.getObjectStore(r,"readwrite").delete(e),t()},r.onerror=()=>{r.error&&s(r.error)}})}initDb(){let e=indexedDB.open(`${this.cacheConfig.cacheName}-expiry`);return e.onupgradeneeded=()=>{e.result.createObjectStore(this.expiryStoreName)},e}getObjectStore(e,t="readwrite"){return e.result.transaction(this.expiryStoreName,t).objectStore(this.expiryStoreName)}constructor(e){this.cacheConfig=e,this.expiryStoreName="expiries"}}});
//# sourceMappingURL=GlobalComponents.db3089d7.js.map
