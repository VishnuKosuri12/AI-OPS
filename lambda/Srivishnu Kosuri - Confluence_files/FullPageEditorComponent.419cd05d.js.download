function e(e,t,i,o){Object.defineProperty(e,t,{get:i,set:o,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var i=globalThis,o={},n={},a=i.parcelRequired477;null==a&&(a=function(e){var t=o[e];if(void 0!==t)return t.exports;var i=n[e];if(void 0!==i){delete n[e];var a={id:e,exports:{}};return o[e]=a,i.call(a.exports,a,a.exports),a.exports}var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r},a.register=function(e,t){n[e]=t},i.parcelRequired477=a);var r=a.register;i.lb||(i.lb=new Set,i.bq=[],i.rlb=e=>{i.lb.add(e),i.pq()},i.rwr=(e,t,o)=>{i.bq.push({b:e,r:t,d:o}),i.pq()},i.pq=()=>{var e=i.bq.find(e=>e.d.every(e=>i.lb.has(e)));e&&(i.bq=i.bq.filter(t=>t.b!==e.b),e.r(),i.pq())}),r("jhcFr",function(e,t){var i=a("l998X"),o=a("42omo");let n=(0,a("aqrhZ").lazyForPaint)(()=>a("7A8Gh")),r=[{tabKey:"__dummy_plugin__",tabTitle:"DUMMY_PLUGIN",resolve:()=>Promise.resolve({data:[]})}];e.exports.useLinkPickerEditorProps=(e,t)=>{let a=(0,o.useMemo)(()=>e=>(0,i.jsx)(n,{...e,config:t}),[t]);return(0,o.useMemo)(()=>({...e??{},plugins:r,component:a}),[a,e])}}),r("7A8Gh",function(e,t){let i=a("4mJKd")(5);e.exports=Promise.all([i("6wr18"),i("jg5LT"),i("ffEVr"),i("7f9Fz"),i("9XYQ9"),i("6iF9L")]).then(()=>a("hyBPw"))}),r("4mJKd",function(e,t){e.exports=e=>t=>import(a("8tirZ").shardUrl(a("02nRr").resolve(t),e))}),r("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=r,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=o,e.exports.shardUrl=function(e,t){return globalThis[i]?l(e,t):e},e.exports.shardUrlUnchecked=l;let i="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function o(e,t){let i=t+1,o=e.split("").reduce((e,t)=>{let o=(e<<i)-e+t.charCodeAt(0);return o&o},0);return(o%=i)<0&&(o+=i),o}let n=/-\d+$/;function a(e){if(!n.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function r(e,t){let i=e.indexOf("."),o=0===t?"":`-${t-1}`;if(-1===i)return`${a(e)}${o}`;let n=a(e.slice(0,i));return`${n}${o}${e.slice(i)}`}function l(e,t){let i=new URL(e),n=o(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(i.pathname),t);return i.hostname=r(i.hostname,n),i.toString()}e.exports.domainShardingKey=i}),r("02nRr",function(t,i){e(t.exports,"register",()=>o,e=>o=e),e(t.exports,"resolve",()=>n,e=>n=e);var o,n,a=new Map;o=function(e,t){for(var i=0;i<t.length-1;i+=2)a.set(t[i],{baseUrl:e,path:t[i+1]})},n=function(e){var t=a.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),r("agrUc",function(e,i){var o=a("l998X");a("42omo");var n=a("3pLGZ");let r=()=>({...(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("aGTRk").blockCardWithLocalId:a("aGTRk").blockCard,toDOM:e=>{let{url:t}=e.attrs,{data:i}=e.attrs,{layout:o,width:n,datasource:r}=e.attrs;return["div",{"data-block-card":"","data-card-url":t||"","data-card-data":i?JSON.stringify(i):"","data-datasource":r?JSON.stringify(r):"","data-layout":o,"data-width":`${n}`,class:"blockCardView-content-wrap",...(0,a("dh538").fg)("platform_editor_adf_with_localid")?{"data-local-id":e.attrs.localId}:{}},["a",{style:(0,a("24P9d").convertToInlineCss)({padding:"var(--ds-space-025, 2px) 0px",marginLeft:"var(--ds-space-negative-025, -2px)",display:"inline",boxDecorationBreak:"clone",WebkitBoxDecorationBreak:"clone",borderRadius:"var(--ds-radius-small, 4px)",color:`var(--ds-link, ${a("6fnsQ").B400})`,lineHeight:"22px",WebkitTransition:"0.1s all ease-in-out",transition:"0.1s all ease-in-out",userSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",MozUserSelect:"none"}),href:t||""},e?.attrs?.url||" "]]}}),l=()=>({...(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("cfHGv").embedCardWithLocalId:a("cfHGv").embedCard,toDOM:e=>{let{url:t,layout:i,width:o,originalWidth:n,originalHeight:r}=e.attrs,l=n&&r?n/r:a("aFUXX").DEFAULT_EMBED_CARD_WIDTH/a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT;return["div",{"data-embed-card":"","data-card-url":t,"data-layout":i,"data-width":o,"data-original-width":n,"data-original-height":r,class:"embedCardView-content-wrap",style:(0,a("24P9d").convertToInlineCss)({margin:function(e){switch(e){case"wrap-right":return"12px auto 12px 12px";case"wrap-left":return"12px 12px 12px auto";default:return"24px auto"}}(i),width:`${Math.ceil(o/100*784-24)}px`,marginRight:"align-end"===i?"0":"",marginLeft:"align-start"===i?"0":"",float:function(e){switch(e){case"wrap-right":return"right";case"wrap-left":return"left";default:return"none"}}(i)}),...(0,a("dh538").fg)("platform_editor_adf_with_localid")?{"data-local-id":e.attrs.localId}:{}},["a",{style:(0,a("24P9d").convertToInlineCss)({padding:"var(--ds-space-025, 2px) 0px",marginLeft:"var(--ds-space-negative-025, -2px)",display:"inline",boxDecorationBreak:"clone",borderRadius:"var(--ds-radius-small, 4px)",color:`var(--ds-link, ${a("6fnsQ").B400})`,lineHeight:"22px",WebkitTransition:"0.1s all ease-in-out",transition:"0.1s all ease-in-out",userSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",MozUserSelect:"none"})},t??""],["span",{style:(0,a("24P9d").convertToInlineCss)({display:"block",paddingBottom:`calc(${(1/l*100).toFixed(3)}% + var(--ds-space-400, 32px))`})}]]}}),s=()=>({...(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("aqHdD").inlineCardWithLocalId:a("aqHdD").inlineCard,toDOM:e=>{let t={class:"inlineCardView-content-wrap inlineNodeView"},i={"aria-busy":"true",class:"card"},o={"data-inline-card":"",href:e.attrs.url||"","data-card-data":e.attrs.data?JSON.stringify(e.attrs.data):"",style:(0,a("24P9d").convertToInlineCss)({padding:"var(--ds-space-025, 2px) 0px",marginLeft:"var(--ds-space-negative-025, -2px)",display:"inline",boxDecorationBreak:"clone",WebkitBoxDecorationBreak:"clone",borderRadius:"var(--ds-radius-small, 4px)",color:`var(--ds-link, ${a("6fnsQ").B400})`,lineHeight:"22px",WebkitTransition:"0.1s all ease-in-out",transition:"0.1s all ease-in-out",userSelect:"text",WebkitUserSelect:"text",msUserSelect:"text",MozUserSelect:"none"}),...(0,a("dh538").fg)("platform_editor_adf_with_localid")?{"data-local-id":e.attrs.localId}:{}};return e.attrs.url?["span",t,["span",i,["a",o,e.attrs.url]]]:["span",t,["span",i,["a",o]]]}});var d=a("8m4tT"),c=a("1oCLl");let p=(e,t,i)=>{let{selection:o}=e,{parent:n}=o.$from,a=e.schema.nodes.inlineCard;if(!(0,d.flatten)(n,!1).some(({node:e})=>e.type===a))return null;let r=t.coordsAtPos(o.$anchor.pos),l=t.posAtCoords({left:r.left,top:"up"===i?r.top-10:r.bottom+10})?.inside;if("number"==typeof l&&l>-1){let t=e.doc.nodeAt(l);if(t)return t.type!==a||0===(0,d.findChildren)(n,e=>e===t,!1).length||t===o.node?null:l}return null},u=e=>(t,i,o)=>{if(!o||!i)return!1;let n=p(t,o,e);return!!n&&(i(t.tr.setSelection(new(0,a("ks2lK").NodeSelection)(t.doc.resolve(n)))),!0)};var h=a("4enQ2"),m=a("iu6m9"),f=a("6JHzw");let g=e=>{let{isPageSSRed:t}=e;return(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)||t&&(0,c.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)?(0,f.blockCardNodeView)(e):(0,a("ftpVl").withLazyLoading)({nodeName:"blockCard",getNodeViewOptions:()=>{},loader:()=>Promise.resolve(a("6JHzw")).then(({blockCardNodeView:t})=>t(e))})};var b=a("7IyZf");let E=e=>{let{isPageSSRed:t}=e;return(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)||t&&(0,c.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)?(0,b.embedCardNodeView)(e):(0,a("ftpVl").withLazyLoading)({nodeName:"embedCard",getNodeViewOptions:()=>{},loader:()=>Promise.resolve(a("7IyZf")).then(({embedCardNodeView:t})=>t(e))})},T=e=>{let{isPageSSRed:t=!1}=e;return(0,m.editorExperiment)("platform_editor_exp_lazy_node_views",!1)||t?(0,h.inlineCardNodeView)(e):(0,a("ftpVl").withLazyLoading)({nodeName:"inlineCard",getNodeViewOptions:()=>{},loader:()=>Promise.resolve(a("4enQ2")).then(({inlineCardNodeView:t})=>t(e))})},C=(e,t)=>{let i=e.doc.type.schema,o=[],n=[],r=[],l=v(e),s=y(e),d=e.getMeta(a("l9G9n").pmHistoryPluginKey),c=R(d)&&!1===d.redo,p=R(d)&&!0===d.redo,u=S(e,c||p);for(let t=0;t<e.steps.length;t++){let r=e.steps[t],d=r.getMap(),c=[],p=[],u=e.docs[t]??e.before,h=e.docs[t+1]??e.doc;if(r instanceof a("aXG5V").AddMarkStep&&(0,a("7iE7T").isLinkMark)(r.mark,i)){let e=h.nodeAt(r.from);e&&p.push({pos:r.from,node:e,nodeContext:(0,a("5YZhQ").getNodeContext)(h,r.from)})}if(r instanceof a("aXG5V").RemoveMarkStep&&(0,a("7iE7T").isLinkMark)(r.mark,i)){let e=u.nodeAt(r.from);e&&c.push({pos:r.from,node:e,nodeContext:(0,a("5YZhQ").getNodeContext)(u,r.from)})}d.forEach((i,o,n,r)=>{let l=e.docs[t],s=e.docs[t+1]??e.doc,d=[],u=[];d.push(...(0,a("5YZhQ").findInNodeRange)(l,i,o,e=>!!(0,a("5YZhQ").getNodeSubject)(e))),u.push(...(0,a("5YZhQ").findInNodeRange)(s,n,r,e=>!!(0,a("5YZhQ").getNodeSubject)(e))),c.push(...d),p.push(...u)});let m=t=>{if(!l)return t;let i=x(e);return t.filter(e=>!i.includes(e.pos))};s||o.push(...c),n.push(...m(p))}if(0===n.length&&s){let i=A(e,t);n.push(...(0,a("5YZhQ").findAtPositions)(e,i))}if(!u){let{inputMethod:t}=(0,a("doRn8").getLinkMetadataFromTransaction)(e);return!t&&(0,a("5YZhQ").areSameNodes)(o,n)?{removed:[],inserted:[],updated:r}:{removed:o,inserted:n,updated:r}}let h=[],m=[];for(let i=0;i<n.length;i++){if(s){let o=n[i],a=I(t,e.mapping.map(o.pos,-1));r.push({inserted:n[i],previous:{display:a}});continue}if(n.length===o.length){let e=(0,a("5YZhQ").getNodeSubject)(o[i].node),t=(0,a("5YZhQ").getNodeSubject)(n[i].node);k(e,t)||L(e,t)?(h.push(n[i]),m.push(o[i])):r.push({removed:o[i],inserted:n[i]})}}return{inserted:h,removed:m,updated:r}},_=[a("d925B").ACTION.CHANGED_TYPE,a("d925B").ACTION.UPDATED],S=(e,t)=>!!e.steps.find(e=>{if(!(e instanceof a("8EkET").LinkMetaStep))return!1;let{action:i,cardAction:o}=e.getMetadata();return"RESOLVE"===o&&!!t||!!i&&_.includes(i)}),w=e=>"object"==typeof e&&null!==e&&"type"in e,v=e=>O(e.getMeta(a("6SJAP").pluginKey)),O=e=>w(e)&&"QUEUE"===e.type,y=e=>N(e.getMeta(a("6SJAP").pluginKey)),N=e=>w(e)&&"RESOLVE"===e.type,R=e=>"object"==typeof e&&null!==e&&"redo"in e,x=e=>{let t=e.getMeta(a("6SJAP").pluginKey);return O(t)?t.requests.map(({pos:e})=>e):[]},A=(e,t)=>{let i=(0,a("22wcR").getPluginState)(t);if(!i)return[];let o=e.getMeta(a("6SJAP").pluginKey);return N(o)?i.requests.filter(e=>e.url===o.url).map(e=>e.pos):[]},I=(e,t)=>{let i=(0,a("22wcR").getPluginState)(e);if(i)return i.requests.find(e=>e.pos===t)?.previousAppearance},L=(e,t)=>e===a("h92Fd").EVENT_SUBJECT.DATASOURCE&&t===a("h92Fd").EVENT_SUBJECT.LINK,k=(e,t)=>e===a("h92Fd").EVENT_SUBJECT.LINK&&t===a("h92Fd").EVENT_SUBJECT.DATASOURCE,M=["full-width","center","wide"],D=e=>{if(e){let{selection:t,schema:i}=e.state,{blockCard:o}=i.nodes,n=(0,d.findSelectedNodeOfType)([o])(t);if(n&&(0,a("hrFA1").isDatasourceNode)(n.node))return{...n,node:n.node}}return{node:void 0,pos:void 0}},P=e=>M.some(t=>t===e),B=(e,t)=>({...e,requests:e.requests.concat(t.requests)}),W=(e,t)=>{let i=e.requests.reduce((e,i)=>(i.url!==t.url&&e.push(i),e),[]);return{...e,requests:i}},U=(e,t)=>({...e,cards:e.cards.filter(e=>e.pos!==t.info.pos).concat(t.info)}),H=(e,t)=>({...e,cards:e.cards.filter(e=>e.id!==t.info.id)}),F=(e,t)=>({...e,provider:t.provider}),z=(e,t)=>({...e,layout:t.layout}),V=(e,t)=>({...e,datasourceTableRef:t.datasourceTableRef}),G=(e,t)=>({...e,datasourceTableRef:t.datasourceTableRef,layout:t.layout}),j=(e,t)=>({...e,smartLinkEvents:t.smartLinkEvents}),K=(e,t)=>({...e,showLinkingToolbar:"SHOW_LINK_TOOLBAR"===t.type}),$=(e,t)=>({...e,showDatasourceModal:!0,datasourceModalType:"SHOW_DATASOURCE_MODAL"===t.type?t.modalType:void 0}),X=e=>({...e,showDatasourceModal:!1,datasourceModalType:void 0}),Z=e=>({...e,overlayCandidatePosition:void 0}),q=(e,t)=>({...e,cards:t.info?e.cards.filter(e=>e.pos!==t.info?.pos).concat(t.info):e.cards,removeOverlay:t.callback}),Y=(e,t)=>({...e,datasourceStash:{...e.datasourceStash,[t.datasourceStash.url]:{views:t.datasourceStash.views}}}),Q=(e,t)=>{let{[t.url]:i,...o}=e.datasourceStash;return{...e,datasourceStash:o}};var J=(e,t)=>{switch(t.type){case"QUEUE":return B(e,t);case"SET_PROVIDER":return F(e,t);case"RESOLVE":return W(e,t);case"REGISTER":return U(e,t);case"REMOVE_CARD":return H(e,t);case"REGISTER_EVENTS":return j(e,t);case"SET_DATASOURCE_TABLE_REF":return V(e,t);case"SET_CARD_LAYOUT":return z(e,t);case"SET_CARD_LAYOUT_AND_DATASOURCE_TABLE_REF":return G(e,t);case"SHOW_LINK_TOOLBAR":case"HIDE_LINK_TOOLBAR":return K(e,t);case"SHOW_DATASOURCE_MODAL":return $(e,t);case"HIDE_DATASOURCE_MODAL":return X(e);case"CLEAR_OVERLAY_CANDIDATE":return Z(e);case"REGISTER_REMOVE_OVERLAY_ON_INSERTED_LINK":return q(e,t);case"SET_DATASOURCE_STASH":return Y(e,t);case"REMOVE_DATASOURCE_STASH":return Q(e,t)}};let ee=e=>{let{selection:t}=e.state,{$cursor:i,$anchor:o}=t;if(!i||!(0,a("l9G9n").hasDocAsParent)(o))return!1;let n=i.node();return!!n&&"paragraph"===n.type.name&&1===n.childCount},et=(e,t,i,o,n,a)=>{let r=ee(e),l=!!i.shouldReplaceLink;return t.resolve(i.url,i.appearance,l,r).then(eo(e,i,n,a,o),en(e,i,n))},ei=(e,t)=>{if("blockCard"===e.type&&"datasource"in e.attrs){let i=e.attrs.datasource.id;if(!t.allowDatasource||!(0,a("16GCc").canRenderDatasource)(i)){delete e.attrs.datasource,e.type="inlineCard";return}}(e?.type!=="blockCard"||t.allowBlockCards)&&(e?.type!=="embedCard"||t.allowEmbeds)||("embedCard"===e.type&&delete e.attrs.layout,e.type="inlineCard")},eo=(e,t,i,o,n)=>r=>(ei(r,n),(0,a("btzjy").replaceQueuedUrlWithCard)(t.url,r,t.analyticsAction,i,o)(e.state,e.dispatch),r),en=(e,t,i)=>()=>{(0,a("btzjy").handleFallbackWithAnalytics)(t,i)(e.state,e.dispatch)},ea=(e,t,i)=>{t&&t.then(e=>{let{state:t,dispatch:o}=i;o((0,a("9AGwg").setProvider)(e)(t.tr))})},er=e=>{let t=(0,a("22wcR").getPluginState)(e.state);if(t?.overlayCandidatePosition){t.removeOverlay?.();let i=e.state.tr;(0,a("9AGwg").clearOverlayCandidate)(i),e.dispatch(i)}},el=(e,t)=>i=>{let{editorAppearance:o,allowResizing:n,useAlternativePreloader:r,fullWidthMode:l,actionOptions:s,cardPluginEvents:c,showUpgradeDiscoverability:p,allowEmbeds:u,allowBlockCards:m,onClickCallback:f,isPageSSRed:b,provider:_,CompetitorPrompt:S}=e,w=!!p,v=(0,a("bT1qC").getInlineNodeViewProducer)({pmPluginFactoryParams:i,Component:h.InlineCardNodeView,extraComponentProps:{useAlternativePreloader:r,actionOptions:s,enableInlineUpgradeFeatures:w,allowEmbeds:u,allowBlockCards:m,pluginInjectionApi:t,onClickCallback:f,isPageSSRed:b,provider:_,CompetitorPrompt:S}});return new(0,a("1S4f7").SafePlugin)({state:{init:()=>({requests:[],provider:null,cards:[],datasourceStash:{},showLinkingToolbar:!1,smartLinkEvents:void 0,editorAppearance:o,showDatasourceModal:!1,datasourceModalType:void 0,datasourceTableRef:void 0,layout:void 0}),apply(e,t,i){let o=(0,a("22wcR").getPluginStateWithUpdatedPos)(t,e),n=e.getMeta(a("6SJAP").pluginKey);if(c){let t=function(e,t){let i=[];try{let o=e.getMeta("isRemote"),n=e.getMeta("replaceDocument"),r=e.steps.find(e=>e instanceof a("cCTpf").TableSortStep);if(o||n||r)return i;let l=e.getMeta(a("l9G9n").pmHistoryPluginKey),s=R(l)&&!1===l.redo,d=R(l)&&!0===l.redo,{action:c,inputMethod:p,sourceEvent:u}=(0,a("doRn8").getLinkMetadataFromTransaction)(e),{removed:h,inserted:m,updated:f}=C(e,t);if([h,m,f].some(e=>e.length>50))return[];for(let e=0;e<f.length;e++){let t=f[e],{inserted:o}=t,{node:n,nodeContext:r}=o,l=(0,a("5YZhQ").getNodeSubject)(n),h="removed"in t?(0,a("5YZhQ").appearanceForLink)(t.removed.node):t.previous.display??"unknown";l&&i.push({event:a("h92Fd").EVENT.UPDATED,subject:l,data:{node:n,nodeContext:r,action:c,inputMethod:p,sourceEvent:u,isUndo:s,isRedo:d,previousDisplay:h}})}let g=(e,t)=>{for(let o=0;o<e.length;o++){let{node:n,nodeContext:r}=e[o],l=(0,a("5YZhQ").getNodeSubject)(n);l&&i.push({event:t,subject:l,data:{node:n,nodeContext:r,action:c,inputMethod:p,sourceEvent:u,isUndo:s,isRedo:d}})}};return g(h,a("h92Fd").EVENT.DELETED),g(m,a("h92Fd").EVENT.CREATED),i}catch(e){return i}}(e,i);c.push(...t)}if(!n&&t.datasourceTableRef&&(!(e.selection instanceof a("ks2lK").NodeSelection)||!e.selection.node.attrs.datasource))return{...o,datasourceTableRef:void 0};if(!n)return o;if(!w)return J(o,n);let r=J(o,n),l=t?.requests?.length===1&&"inline"===t.requests[0].appearance,s=(0,a("5v798").isLocalStorageKeyDiscovered)("smart-link-upgrade-pulse");if("RESOLVE"!==n.type||!l)return r;let d=t.requests[0].pos,p=m&&(0,a("hrFA1").isBlockSupportedAtPosition)(d,i,"inline"),h=u&&(0,a("hrFA1").isEmbedSupportedAtPosition)(d,i,"inline");return(p||h)&&(r.overlayCandidatePosition=d),!s&&h&&(r.inlineCardAwarenessCandidatePosition=d),r}},filterTransaction:e=>!(e.getMeta("outsideProsemirrorEditorClicked")&&document.getElementById("sllv-active-inline-edit"))&&!0,view(i){let o=i.domAtPos.bind(i),n=[];return e.provider&&ea("cardProvider",e.provider,i),{update(i,r){let l=(0,a("22wcR").getPluginState)(i.state),s=(0,a("22wcR").getPluginState)(r),{state:p,dispatch:u}=i,{selection:h,tr:m,schema:f}=p;if(h instanceof a("ks2lK").NodeSelection&&h.node?.type===f.nodes.blockCard){let e=(0,d.findDomRefAtPos)(h.from,o)?.querySelector(`.${a("0vvte").DATASOURCE_INNER_CONTAINER_CLASSNAME}`),{node:t}=h,i=!!t?.attrs?.datasource,n=e&&l?.datasourceTableRef!==e;if(i&&n){let i=P(t.attrs.layout)?t.attrs.layout:a("hBNGD").DATASOURCE_DEFAULT_LAYOUT;h.$anchor.depth>0||u((0,a("9AGwg").setCardLayoutAndDatasourceTableRef)({datasourceTableRef:e,layout:i})(m))}}else l?.datasourceTableRef&&u((0,a("9AGwg").setDatasourceTableRef)(void 0)(m));if(l&&l.provider){let o=(0,a("22wcR").getNewRequests)(s,l),{provider:r}=l;o.forEach(o=>{let l=(0,a("2P8Ax").default)(()=>et(i,r,o,e,t?.analytics?.actions,t?.analytics?.sharedState.currentState()?.createAnalyticsEvent??void 0));n.push(l.cancel),l()})}c?.flush()},destroy(){n.forEach(e=>e())}}},props:{nodeViews:{inlineCard:T({inlineCardViewProducer:v,isPageSSRed:b}),blockCard:g({pmPluginFactoryParams:i,actionOptions:s,pluginInjectionApi:t,onClickCallback:f,allowDatasource:e.allowDatasource,inlineCardViewProducer:v,isPageSSRed:b,provider:_,CompetitorPrompt:e.CompetitorPrompt}),embedCard:E({allowResizing:n,fullWidthMode:l,pmPluginFactoryParams:i,pluginInjectionApi:t,actionOptions:s,onClickCallback:e.onClickCallback,isPageSSRed:b,provider:_,CompetitorPrompt:e.CompetitorPrompt})},...w&&{handleKeyDown:e=>(er(e),!1),handleClick:e=>(er(e),!1)}},key:a("6SJAP").pluginKey})},es=()=>{let e=[],t=new Set;return{push:(...t)=>{e.push(...t)},flush:()=>{for(;e.length;){let i=e.shift();i&&t.forEach(e=>{e(i)})}},subscribe:e=>(t.add(e),()=>{t.delete(e)}),getSize:()=>e.length}};var ed=a("42omo");let ec=({view:e,cardContext:t,datasourceId:i,componentType:n})=>{let{state:r}=e,l=eu(r),{dispatch:s,state:{tr:d}}=e,c=(0,ed.useCallback)(()=>{s((0,a("9AGwg").hideDatasourceModal)(d))},[s,d]),p=ep(e,l),u=!!(l&&!l?.attrs?.datasource),{id:h=i,views:m=[],parameters:f}=l?.attrs?.datasource||{},{visibleColumnKeys:g,wrappedColumnKeys:b,columnCustomSizes:E}=eh(m),{parameters:T,ready:C}=(0,a("8dcLZ").useFetchDatasourceInfo)({isRegularCardNode:u,url:l?.attrs.url,cardContext:t,nodeParameters:f});return C?(0,o.jsx)(n,{datasourceId:h,viewMode:u?"inline":"table",parameters:T,url:l?.attrs.url,visibleColumnKeys:g,columnCustomSizes:E,wrappedColumnKeys:b,onCancel:c,onInsert:p}):null},ep=(e,t)=>(0,ed.useCallback)((i,o)=>{o&&o.update(e=>({...e,attributes:{...e.attributes,inputMethod:"datasource_config"}})),t?(0,a("btzjy").updateCardViaDatasource)({state:e.state,node:t,newAdf:i,view:e,sourceEvent:o}):(0,a("btzjy").insertDatasource)(e.state,i,e,o)},[t,e]),eu=e=>{let t,{selection:i}=e,o=e.doc.resolve(i.from).marks().some(t=>t.type===e.schema.marks.link);return i instanceof a("ks2lK").NodeSelection?t=i.node:o&&(t=e.doc.nodeAt(i.from)??void 0),t},eh=e=>{let[t]=e,i=[],o=[],n={},a=t?.properties?.columns;if(a)for(let{key:e,width:t,isWrapped:r}of a)i.push(e),t&&(n[e]=t),r&&o.push(e);return{visibleColumnKeys:i,wrappedColumnKeys:o,columnCustomSizes:n}},em=e=>({showDatasourceModal:e.cardState?.showDatasourceModal,datasourceModalType:e.cardState?.datasourceModalType}),ef=({api:e,editorView:t})=>{let i=(0,a("eIleF").useSmartLinkContext)(),{showDatasourceModal:n,datasourceModalType:r}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e,["card"],em);if(!n||!r)return null;let{datasourceId:l,componentType:s}=eb[r];return(0,o.jsx)(a("dQwlz").DatasourceErrorBoundary,{view:t,datasourceModalType:r,children:(0,o.jsx)(ec,{view:t,cardContext:i,datasourceId:l,componentType:s})})},eg=t(ed).memo(({api:e,editorView:t})=>(0,o.jsx)(a("eIleF").EditorSmartCardProviderValueGuard,{children:(0,o.jsx)(ef,{api:e,editorView:t})})),eb={jira:{componentType:a("iB8ko").default,datasourceId:a("iB8ko").JIRA_LIST_OF_LINKS_DATASOURCE_ID},"confluence-search":{componentType:a("jPEjP").default,datasourceId:a("jPEjP").CONFLUENCE_SEARCH_DATASOURCE_ID},assets:{componentType:a("bEi27").default,datasourceId:a("bEi27").ASSETS_LIST_OF_LINKS_DATASOURCE_ID}},eE=e=>t=>{let{isUndo:i,isRedo:o}=t;return i?"undo":o?"redo":e(t)},eT=eE(({inputMethod:e,sourceEvent:t})=>{switch(e=e??t?.payload?.attributes?.inputMethod){case a("d925B").INPUT_METHOD.CLIPBOARD:return"editor_paste";case a("d925B").INPUT_METHOD.FLOATING_TB:return"editor_floatingToolbar";case a("d925B").INPUT_METHOD.AUTO_DETECT:case a("d925B").INPUT_METHOD.FORMATTING:return"editor_type";case a("d925B").INPUT_METHOD.TYPEAHEAD:return"linkpicker_searchResult";case a("d925B").INPUT_METHOD.MANUAL:return"linkpicker_manual";case a("d925B").INPUT_METHOD.DATASOURCE:return"datasource_config";default:return"unknown"}}),eC=eE(({action:e})=>{switch(e){case a("d925B").ACTION.CHANGED_TYPE:return"display_update";case a("d925B").ACTION.UPDATED:return"link_update";default:return"unknown"}}),e_=eE(({action:e})=>e===a("d925B").ACTION.UNLINK?"unlink":"delete"),eS=e=>e.sourceEvent instanceof a("6v6KC").default?e.sourceEvent:null;function ew(e,t){let{url:i,datasource:{id:o,parameters:n}}=e,r=e.datasource.views[0]?.type,l="",s=[];t.inputMethod?l=eT(t)??"":t.sourceEvent instanceof a("6v6KC").default&&(l=t.sourceEvent.payload.attributes?.inputMethod,s=t.sourceEvent.payload.attributes?.actions);let d=e.datasource.views[0]?.properties?.columns?.length??void 0,c=function(e,t){if("editor_paste"===e||"editor_type"===e)return"";let{sourceEvent:i}=t;return i instanceof a("6v6KC").default?i.payload.attributes?.searchMethod:"unknown"}(l,t);return{actions:s,inputMethod:l,datasourceId:o,display:r,displayedColumnCount:d,parameters:n,searchMethod:c,url:i}}let ev=({cardPluginEvents:e})=>{let{datasourceCreated:t,datasourceUpdated:i,datasourceDeleted:o}=(0,a("7pxpu").useDatasourceLifecycleAnalytics)(),n=(0,ed.useMemo)(()=>({[a("h92Fd").EVENT.CREATED]:({node:e,nodeContext:i,...o})=>{let{actions:n,inputMethod:a,datasourceId:r,display:l,displayedColumnCount:s,parameters:d,searchMethod:c,url:p}=ew(e.attrs,o);t({datasourceId:r,parameters:d,url:p},null,{actions:n,creationMethod:a,display:l,..."number"==typeof s?{displayedColumnCount:s}:{},nodeContext:i,searchMethod:c})},[a("h92Fd").EVENT.UPDATED]:({node:e,nodeContext:t,...o})=>{let{actions:n,datasourceId:a,display:r,displayedColumnCount:l,inputMethod:s,parameters:d,searchMethod:c,url:p}=ew(e.attrs,o);i({datasourceId:a,parameters:d,url:p},null,{actions:n,display:r,displayedColumnCount:l,nodeContext:t,searchMethod:c,updateMethod:s})},[a("h92Fd").EVENT.DELETED]:({node:e,nodeContext:t,...i})=>{let{datasourceId:n,display:a,displayedColumnCount:r,inputMethod:l,parameters:s,searchMethod:d,url:c}=ew(e.attrs,i);o({datasourceId:n,parameters:s,url:c},null,{deleteMethod:l,display:a,displayedColumnCount:r,nodeContext:t,searchMethod:d})}}),[t,i,o]);return(0,ed.useEffect)(()=>{let t=e.subscribe(({event:e,subject:t,data:i})=>{t===a("h92Fd").EVENT_SUBJECT.DATASOURCE&&n[e](i)});return()=>t()},[n,e]),null},eO=e=>{if("url"===e)return"link"},ey=({cardPluginEvents:e})=>{let{linkCreated:t,linkUpdated:i,linkDeleted:o}=(0,a("7pxpu").useSmartLinkLifecycleAnalytics)(),n=(0,ed.useMemo)(()=>({[a("h92Fd").EVENT.CREATED]:({node:e,nodeContext:i,...o})=>{let n=(0,a("5YZhQ").getUrl)(e);if(!n)return;let r=(0,a("5YZhQ").appearanceForLink)(e),l=eO(r);t({url:n,displayCategory:l},eS(o),{display:r,nodeContext:i,creationMethod:eT(o)})},[a("h92Fd").EVENT.UPDATED]:({node:e,nodeContext:t,previousDisplay:o,...n})=>{let r=(0,a("5YZhQ").getUrl)(e);if(!r)return;let l=(0,a("5YZhQ").appearanceForLink)(e),s=eO(l),d=eS(n);i({url:r,displayCategory:s},d,{display:l,previousDisplay:o,nodeContext:t,updateMethod:eT(n),updateType:eC(n)})},[a("h92Fd").EVENT.DELETED]:({node:e,nodeContext:t,...i})=>{let n=(0,a("5YZhQ").getUrl)(e);if(!n)return;let r=(0,a("5YZhQ").appearanceForLink)(e),l=eO(r),s=eS(i);o({url:n,displayCategory:l},s,{display:r,nodeContext:t,deleteMethod:eT(i),deleteType:e_(i)})}}),[t,i,o]);return(0,ed.useEffect)(()=>{let t=e.subscribe(({event:e,subject:t,data:i})=>{t===a("h92Fd").EVENT_SUBJECT.LINK&&n[e](i)});return()=>t()},[n,e]),null};class eN extends t(ed).PureComponent{render(){return(0,c.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!this.props.editorView?null:(0,o.jsx)(a("eIleF").EditorSmartCardProvider,{children:(0,o.jsx)(a("eIleF").EditorSmartCardProviderValueGuard,{children:(0,o.jsxs)(a("aJdNi").EditorAnalyticsContext,{editorView:this.props.editorView,children:[(0,o.jsx)(ey,{...this.props}),(0,o.jsx)(ev,{...this.props})]})})})}}let eR=({editorView:e})=>{let t=(0,a("dLAsE").useSmartLinkEvents)();return(0,ed.useEffect)(()=>{!t||(0,c.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!e||e.dispatch((0,a("9AGwg").registerSmartCardEvents)(t)(e.state.tr))},[t,e]),null},ex=(0,a("9K4OG").css)({background:`var(--ds-background-neutral, ${a("6fnsQ").N20A})`,color:`var(--ds-icon, ${a("6fnsQ").N300})`,":hover":{background:`var(--ds-background-neutral-hovered, ${a("6fnsQ").B300})`,color:"var(--ds-icon, white) !important"}}),eA=({onLayoutChange:e,layout:i=a("hBNGD").DATASOURCE_DEFAULT_LAYOUT,intl:{formatMessage:o},mountPoint:n,boundariesElement:r,scrollableElement:l,targetElement:s,testId:d="datasource-table-layout-button"})=>{let c=(0,ed.useCallback)(()=>{e&&e((0,a("fJNzZ").getNextBreakoutMode)(i))},[i,e]),p=(0,ed.useMemo)(()=>o((0,a("fJNzZ").getTitle)(i)),[o,i]);return s?(0,a("9K4OG").jsx)(a("jwWgu").default,{mountTo:n,boundariesElement:r,scrollableElement:l,target:s,alignY:"start",alignX:"end",forcePlacement:!0,stick:!0,ariaLabel:p},(0,a("9K4OG").jsx)(a("a4eZN").default,{testId:d,css:ex,title:p,onClick:c,iconBefore:"full-width"===i?(0,a("9K4OG").jsx)(t(a("64M9v")),{label:p}):(0,a("9K4OG").jsx)(t(a("1kVeP")),{label:p})})):null},eI=e=>({layout:e.cardState?.layout,datasourceTableRef:e.cardState?.datasourceTableRef});var eL=(0,a("gmMgo").default)(({editorView:e,mountPoint:t,scrollableElement:i,boundariesElement:o,intl:n,api:r})=>{let{node:l,pos:s}=D(e),{layout:d=l?.attrs?.layout||void 0,datasourceTableRef:c}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(r,["card"],eI);return(0,a("hrFA1").isDatasourceNode)(l)?(0,a("9K4OG").jsx)(eA,{mountPoint:t,scrollableElement:i,boundariesElement:o,targetElement:c,layout:P(d)?d:void 0,onLayoutChange:t=>{if(void 0===s)return;let{state:i,dispatch:o}=e,n=D(e).node??l,r=i.tr.setNodeMarkup(s,void 0,{...n?.attrs,layout:t});r.setMeta("scrollIntoView",!1),o((0,a("9AGwg").setCardLayout)(t)(r))},intl:n}):null}),ek=a("9Rg2N");e.exports.cardPlugin=({config:e={},api:t})=>{let i,d=es();return t?.base?.actions.registerMarks(({tr:e,node:t,pos:i})=>{let{doc:o}=e,{schema:n}=o.type,{inlineCard:a}=n.nodes;if(t.type===a){let o=t.attrs.url,a=e.mapping.map(i);e.replaceWith(a,a+t.nodeSize,n.text(o,t.marks))}}),{name:"card",getSharedState:e=>e&&a("6SJAP").pluginKey.getState(e)||null,nodes(){let t=[{name:"inlineCard",node:s()},{name:"blockCard",node:r()}];return e.allowEmbeds&&t.push({name:"embedCard",node:l()}),t},pmPlugins(){let i=e.allowBlockCards??!0,o=e.allowResizing??!0,n=e.useAlternativePreloader??!0,r=e.allowWrapping??!0,l=e.allowAlignment??!0,s=e.allowDatasource??!1,p=e.showUpgradeDiscoverability??!0,h=[{name:"card",plugin:el({...e,allowBlockCards:i,allowResizing:o,useAlternativePreloader:n,allowWrapping:r,allowAlignment:l,allowDatasource:s,cardPluginEvents:d,showUpgradeDiscoverability:p},t)}];return h.push({name:"cardKeymap",plugin:({featureFlags:e})=>(function(e){let t={},i=(0,c.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser;return i.chrome&&i.chrome_version>90&&((0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveUp.common,u("up"),t),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveDown.common,u("down"),t)),(0,a("dus6D").keymap)(t)})(0)}),h},contentComponent({editorView:i,popupsMountPoint:n,popupsScrollableElement:a,popupsBoundariesElement:r}){if(!i)return null;let l="full-page"===e.editorAppearance;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(eR,{editorView:i}),(0,o.jsx)(eN,{cardPluginEvents:d,editorView:i}),l&&(0,o.jsx)(eL,{api:t,editorView:i,mountPoint:n,scrollableElement:a,boundariesElement:r}),(0,o.jsx)(eg,{api:t,editorView:i})]})},actions:{setProvider:async o=>{let n=await o;return i!==n&&e?.provider!==o&&(i=n,t?.core.actions.execute(({tr:e})=>(0,a("9AGwg").setProvider)(n)(e))??!1)},hideLinkToolbar:a("9AGwg").hideLinkToolbar,queueCardsFromChangedTr:a("btzjy").queueCardsFromChangedTr,getStartingToolbarItems:(0,ek.getStartingToolbarItems)(e,t),getEndingToolbarItems:(0,ek.getEndingToolbarItems)(e,t)},pluginsOptions:{floatingToolbar:(0,ek.floatingToolbar)(e,e.lpLinkPicker??!1,e.linkPicker,t,e.disableFloatingToolbar),quickInsert:({formatMessage:t})=>{let i=[];return e.allowDatasource&&(i.push({id:"datasource",title:t((0,a("dh538").fg)("confluence-issue-terminology-refresh")?a("3RxtY").messages.datasourceJiraIssueIssueTermRefresh:a("3RxtY").messages.datasourceJiraIssue),description:t((0,a("dh538").fg)("confluence-issue-terminology-refresh")?a("3RxtY").messages.datasourceJiraIssueDescriptionIssueTermRefresh:a("3RxtY").messages.datasourceJiraIssueDescription),isDisabledOffline:!0,categories:["external-content","development"],keywords:["jira"],featured:!0,icon:()=>(0,o.jsx)(n.IconDatasourceJiraIssue,{}),action(e){let t=e(void 0);return(0,a("9AGwg").showDatasourceModal)("jira")(t),t}}),(0,a("16GCc").canRenderDatasource)(a("bEi27").ASSETS_LIST_OF_LINKS_DATASOURCE_ID)&&i.push({id:"datasource",title:t(a("3RxtY").messages.datasourceAssetsObjectsGeneralAvailability),description:t(a("3RxtY").messages.datasourceAssetsObjectsDescription),isDisabledOffline:!0,categories:["external-content","development"],keywords:["assets"],icon:()=>(0,o.jsx)(n.IconDatasourceAssetsObjects,{}),action(e){let t=e(void 0);return(0,a("9AGwg").showDatasourceModal)("assets")(t),t}}),(0,a("hrFA1").isDatasourceConfigEditable)(a("jPEjP").CONFLUENCE_SEARCH_DATASOURCE_ID)&&i.push({id:"datasource",title:t(a("3RxtY").messages.datasourceConfluenceSearch),description:t(a("3RxtY").messages.datasourceConfluenceSearchDescription),isDisabledOffline:!0,categories:["external-content","development"],keywords:["confluence"],featured:!0,icon:()=>(0,o.jsx)(n.IconDatasourceConfluenceSearch,{}),action(e){let t=e(void 0);return(0,a("9AGwg").showDatasourceModal)("confluence-search")(t),t}})),i}}}}}),r("eKaDU",function(e,t){var i,o,n=((i={}).SINGLE_COL="singleColumn",i.TWO_COLS_EQUAL="twoColumnsEqual",i.THREE_COLS_EQUAL="threeColumnsEqual",i.LEFT_SIDEBAR="twoColumnsLeftSidebar",i.RIGHT_SIDEBAR="twoColumnsRightSidebar",i.THREE_WITH_SIDEBARS="threeColumnsWithSidebars ",i.FOUR_COLS_EQUAL="fourColumnsEqual",i.FIVE_COLS_EQUAL="fiveColumnsEqual",i),a=((o={}).INLINE_CARD="inline",o.BLOCK_CARD="block",o.URL="url",o);e.exports.LAYOUT_TYPE=n,e.exports.SMART_LINK_TYPE=a}),r("4enQ2",function(e,i){var o=a("l998X"),n=a("42omo"),r=a("cUcZ5"),l=a("hpUsb"),s=a("9CM6e"),d=a("1oCLl"),c=a("iu6m9"),p=a("9Rg2N"),u=({url:e,linkPosition:t,cardContext:i,pluginInjectionApi:o,isPulseEnabled:r,isOverlayEnabled:l})=>{let[s,d]=(0,n.useState)(i?.store?.getState()[e]),{overlayCandidatePosition:c,inlineCardAwarenessCandidatePosition:p}=o?.card?.sharedState?.currentState()||{};(0,n.useEffect)(()=>{let t=i?.store?.subscribe(()=>{d(i?.store?.getState()[e])});return()=>{t&&t()}},[i?.store,e]);let u=(0,n.useMemo)(()=>s?.status==="resolved"&&!!i?.extractors?.getPreview(e,"web"),[i?.extractors,e,s?.status]),h=(0,n.useMemo)(()=>r&&t===p&&u,[u,r,t,p]),m=s?.status==="resolved"&&l,f=c===t;return{shouldShowToolbarPulse:(0,n.useMemo)(()=>r&&!(0,a("5v798").isLocalStorageKeyDiscovered)(a("5v798").LOCAL_STORAGE_DISCOVERY_KEY_TOOLBAR)&&u,[u,r]),shouldShowLinkPulse:h,shouldShowLinkOverlay:m,isLinkMostRecentlyInserted:f}},h=a("jSnXV");let m=(e,t)=>e.current?e.current.querySelector(t):void 0,f=(e,t)=>{let i=e.getBoundingClientRect().left;return t.getBoundingClientRect().left-i},g=(e,t)=>e.getBoundingClientRect().top===t.getBoundingClientRect().top,b=(e,t)=>{let i=e.getBoundingClientRect().width,o=i-t.getBoundingClientRect().width;return{max:i,min:o}},E=e=>{let t=window&&parseFloat(window.getComputedStyle(e).fontSize);return!t||t<20?"small":"medium"},T="ak-editor-card-overlay-icon-and-label",C="ak-editor-card-overlay-label",_="ak-editor-card-overlay-gradient",S="ak-editor-card-overlay-marker",w=`var(--ds-surface-raised, ${a("6fnsQ").N0})`,v=`var(--ds-background-selected, ${a("6fnsQ").B100})`,O=e=>`linear-gradient(270deg, ${e} 0%, rgba(255, 255, 255, 0.00) 100%)`,y=(0,a("9K4OG").css)({position:"relative",lineHeight:"normal",":active":{[`.${T}`]:{background:v},[`.${_}`]:{background:O(v)}}}),N={name:"1ckkn26",styles:"visibility:hidden;position:absolute;display:inline-flex;justify-content:flex-end;align-items:center;vertical-align:text-top;height:1lh;@supports not (height: 1lh){height:1.2em;}overflow:hidden;z-index:2;pointer-events:none"},R={name:"1st01id",styles:"position:relative;visibility:visible"},x={name:"ulzjoo",styles:"span{display:flex;}"},A={name:"cf1bvh",styles:'font:var(--ds-font-body, normal 400 14px/20px ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Ubuntu, "Helvetica Neue", sans-serif);font-weight:var(--ds-font-weight-semibold, 600);width:max-content'},I=(0,a("9K4OG").css)({display:"flex",alignItems:"center",height:"100%",gap:"var(--ds-space-050, 4px)",paddingRight:"var(--ds-space-050, 4px)",marginRight:"var(--ds-space-025, 2px)",background:w,color:`var(--ds-text-subtlest, ${a("6fnsQ").N700})`}),L={name:"16sud",styles:"display:flex;flex-direction:row-reverse;align-items:center;width:max-content;height:100%"},k=(0,a("9K4OG").css)({width:"2.5rem",height:"100%",background:O(w)});var M=({children:e,isSelected:i=!1,isVisible:o=!1,testId:r="inline-card-overlay",url:l,...s})=>{let[d,c]=(0,n.useState)(!1),[p,u]=(0,n.useState)(!0),[w,v]=(0,n.useState)(void 0),O=(0,n.useRef)(0),M=(0,n.useRef)(16),D=(0,n.useRef)(0),P=(0,n.useRef)("small"),B=(0,n.useRef)(null),W=(0,n.useCallback)(()=>{if(!B.current||!O.current)return;let e=m(B,`.${S}`);if(e)try{let t=g(B.current,e),o=f(B.current,e)-4-18*!!t;v(o);let n=o>O.current;u(n);let a=o>M.current&&!i;c(a)}catch{c(!1)}},[i]);(0,n.useLayoutEffect)(()=>{if(B.current){if(!O.current){let e=m(B,`.${T}`),t=m(B,`.${C}`);if(e&&t){let{max:i,min:o}=b(e,t);O.current=i,M.current=o,P.current=E(t)}}o&&W()}},[W,o]),(0,n.useEffect)(()=>{let e=B?.current?.closest("p,h1,h2,h3,h4,h5,h6");if(!e)return;let i=new ResizeObserver(t(h)(e=>{if(!o)return;let t=e?.[0]?.contentBoxSize?.[0]?.inlineSize;t&&(D.current||(D.current=t),D.current!==t&&(D.current=t,W()))},5));return i.observe(e),()=>{i.disconnect()}},[o,W]);let U=(0,a("8C5kA").default)().formatMessage(a("3RxtY").messages.inlineOverlay);return(0,a("9K4OG").jsx)("span",{...s,css:y,ref:B},e,o&&(0,a("9K4OG").jsx)(t(n).Fragment,null,(0,a("9K4OG").jsx)("span",{"aria-hidden":"true",className:S},a("TfRUG").ZERO_WIDTH_JOINER),(0,a("9K4OG").jsx)("a",{css:[N,d&&R],style:{marginLeft:w&&-w,width:w},"data-testid":r,href:l,onClick:e=>e.preventDefault(),tabIndex:-1},(0,a("9K4OG").jsx)("span",{css:L},(0,a("9K4OG").jsx)("span",{css:I,className:T},(0,a("9K4OG").jsx)("span",{css:x},(0,a("9K4OG").jsx)(t(a("isYda")),{label:U,LEGACY_size:P.current,testId:`${r}-icon`})),p&&(0,a("9K4OG").jsx)("span",{css:A,className:C,"data-testid":`${r}-label`},U)),(0,a("9K4OG").jsx)("span",{css:k,className:_,"data-testid":`${r}-gradient`})))))};let D={name:"8ncb35",styles:".loader-wrapper{line-height:normal;}"},P=({cardContext:e,children:t,getPos:i,isInserted:o,isOverlayEnabled:r,isSelected:l,isResolvedViewRendered:s,isPulseEnabled:d,markMostRecentlyInsertedLink:p,pluginInjectionApi:h,setOverlayHoveredStyles:m,url:f,appearance:g})=>{let[b,E]=(0,n.useState)(!1),T=(0,n.useMemo)(()=>{if(!i||"boolean"==typeof i)return;let e=i();return"number"==typeof e?e:void 0},[i]),{shouldShowLinkPulse:C,shouldShowToolbarPulse:_,shouldShowLinkOverlay:S,isLinkMostRecentlyInserted:w}=u({url:f,linkPosition:T||-1,cardContext:e?.value,pluginInjectionApi:h,isOverlayEnabled:r,isPulseEnabled:d});l&&_&&!(0,a("5v798").isLocalStorageKeyDiscovered)(a("5v798").LOCAL_STORAGE_DISCOVERY_KEY_TOOLBAR)&&(0,a("5v798").markLocalStorageKeyDiscovered)(a("5v798").LOCAL_STORAGE_DISCOVERY_KEY_SMART_LINK),(0,n.useEffect)(()=>{S&&w&&p(!0)},[w,p,S]);let v=(0,n.useCallback)(e=>{E(e),m(e)},[m]),O=(0,n.useMemo)(()=>!S||(0,c.editorExperiment)("platform_editor_controls","variant1")||(0,c.editorExperiment)("platform_editor_preview_panel_linking_exp",!0)?t:(0,a("9K4OG").jsx)(M,{isSelected:l,isVisible:s&&(o||b||l),onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),url:f},t),[S,t,l,s,o,b,f,v]),y="inline"===g,N=T||0;return(0,n.useMemo)(()=>(0,a("9K4OG").jsx)("span",{css:C&&D,className:"card","data-vc":"awareness-wrapper","data-ssr-placeholder":`awareness-wrapper-${N}`,"data-ssr-placeholder-replace":`awareness-wrapper-${N}`},(0,a("9K4OG").jsx)(a("bYRk6").default,{data:{attributes:(0,a("hrFA1").getResolvedAttributesFromStore)(f,"inline",e?.value?.store)}},(0,a("9K4OG").jsx)(a("jqKkl").DiscoveryPulse,{localStorageKey:a("5v798").LOCAL_STORAGE_DISCOVERY_KEY_SMART_LINK,localStorageKeyExpirationInMs:a("5v798").ONE_DAY_IN_MILLISECONDS,discoveryMode:"start",shouldShowPulse:s&&C,testId:"link-discovery-pulse",isInline:y},O))),[C,f,e?.value?.store,s,O,y,N])};var B=a("h8cpw");let W=({url:e,appearance:t,children:i})=>{let a=(0,B.useSmartLinkActions)({url:e,appearance:t}),r=(0,n.useMemo)(()=>a.find(e=>"preview-content"===e.id),[a]),l=(0,n.useCallback)(()=>{try{r?.invoke()}catch{}},[r]);return(0,o.jsx)(o.Fragment,{children:i({canPreview:!!r,invokePreview:l})})};var U=a("4enQ2");let H=e=>({mode:e.editorViewModeState?.mode,selection:e.selectionState?.selection}),F=(0,n.memo)(({node:e,cardContext:t,actionOptions:i,useAlternativePreloader:r,view:l,getPos:s,pluginInjectionApi:p,onClick:u,isPulseEnabled:h,isOverlayEnabled:m,isSelected:f,isPageSSRed:g,provider:b,appearance:E})=>{let[T,C]=(0,n.useState)(!1),[_,S]=(0,n.useState)(!1),[w,v]=(0,n.useState)(!1),O=p?.card.sharedState.currentState()?.editorAppearance,y=(0,n.useCallback)((e,t)=>{let i=e.getMeta(a("6SJAP").pluginKey);i&&"REGISTER"===i.type?(0,a("9AGwg").registerRemoveOverlay)(()=>S(!1),i.info)(e):(0,a("9AGwg").registerRemoveOverlay)(()=>S(!1))(e),t&&v(!0)},[]),N=(0,n.useCallback)(e=>{m&&S(e)},[m]),R=(0,n.useCallback)(e=>{m&&C(e)},[m]),{mode:x,selection:A}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(p,["selection","editorViewMode"],H),I=(A instanceof a("ks2lK").NodeSelection&&A.node)!==e&&(0,c.editorExperiment)("platform_editor_preview_panel_linking_exp",!0,{exposure:!0}),L=(0,n.useMemo)(()=>(0,o.jsx)(a("7FiWH").default,{isVisible:w,url:e.attrs.url,compactPadding:"comment"===O||"chromeless"===O,editorAnalyticsApi:p?.analytics?.actions,view:l,children:(0,o.jsx)(U.InlineCard,{node:e,view:l,getPos:s,useAlternativePreloader:r,actionOptions:i,onResolve:y,onClick:u,cardContext:t,isHovered:T,isPageSSRed:g,provider:b,pluginInjectionApi:p,disablePreviewPanel:!0})}),[w,e,O,l,s,r,i,y,u,t,T,g,b,p]),k=(0,n.useMemo)(()=>(0,o.jsx)(U.InlineCard,{node:e,view:l,getPos:s,useAlternativePreloader:r,actionOptions:i,onResolve:y,onClick:u,cardContext:t,isHovered:T,isPageSSRed:g,provider:b,pluginInjectionApi:p,showHoverPreview:!1}),[i,t,s,T,e,u,y,r,l,g,b,p]),M=(0,n.useMemo)(()=>{let e="chromeless"===O;return("edit"===x||"comment"===O||e)&&((0,c.editorExperiment)("platform_editor_controls","variant1")||(0,c.editorExperiment)("platform_editor_preview_panel_linking_exp",!0,{exposure:!0}))},[x,O])?L:k;if("view"===x&&(0,c.editorExperiment)("platform_editor_preview_panel_linking_exp",!0,{exposure:!0})){let n=e.attrs.url,c=t?.value?.store?.getState()[n];if(c){let h=(0,a("226XV").getObjectAri)(c.details),m=(0,a("226XV").getObjectName)(c.details),f=(0,a("226XV").getObjectIconUrl)(c.details),E=h&&t?.value?.isPreviewPanelAvailable?.({ari:h}),C=t?.value?.openPreviewPanel,_=!!(C&&E),S=({previewType:e})=>{let i=t?.value?.store,o=i?.getState()[n||""];p?.analytics?.actions&&p?.analytics?.actions?.fireAnalyticsEvent({action:a("d925B").ACTION.CLICKED,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.HOVER_LABEL,eventType:a("d925B").EVENT_TYPE.UI,attributes:{previewType:e,destinationProduct:o?.details?.meta?.product??null,destinationSubproduct:o?.details?.meta?.subproduct??null}})};M=(0,o.jsx)(W,{url:n,appearance:"inline",children:({canPreview:E,invokePreview:v})=>{let N=!!(E&&v),R=_||N,A=(0,d.expValEquals)("platform_hover_card_preview_panel_modal","cohort","test")&&(0,a("7ee1w").isWithinPreviewPanelIFrame)();return R?(0,o.jsx)(a("7FiWH").default,{isVisible:w,url:n,compactPadding:"comment"===O||"chromeless"===O,editorAnalyticsApi:p?.analytics?.actions,view:l,showPanelButton:A?_:R,showPanelButtonIcon:R&&_?"panel":"modal",onClick:e=>{_?(e.preventDefault(),C?.({url:n,ari:h||"",name:m||"",iconUrl:f,panelData:{embedUrl:(0,d.expValEquals)("platform_hover_card_preview_panel","cohort","test")?(0,a("79vw2").extractSmartLinkEmbed)(c?.details)?.src:void 0}}),S({previewType:"panel"})):N&&(e.preventDefault(),v?.(),S({previewType:"modal"}))},children:(0,o.jsx)(U.InlineCard,{node:e,view:l,getPos:s,useAlternativePreloader:r,actionOptions:i,onResolve:y,onClick:u,cardContext:t,isHovered:T,isPageSSRed:g,provider:b,pluginInjectionApi:p,showHoverPreview:"view"===x&&I,disablePreviewPanel:!0})}):(0,o.jsx)(U.InlineCard,{node:e,view:l,getPos:s,useAlternativePreloader:r,actionOptions:i,onResolve:y,onClick:u,cardContext:t,isHovered:T,isPageSSRed:g,provider:b,pluginInjectionApi:p,showHoverPreview:"view"===x&&I})}})}}let D="function"==typeof s?s:void 0,B=D?.()||0;return m||h?(0,o.jsx)(P,{isOverlayEnabled:m,isPulseEnabled:h,cardContext:t,getPos:s,isHovered:T,isInserted:_,url:e.attrs.url,isSelected:f,isResolvedViewRendered:w,markMostRecentlyInsertedLink:N,pluginInjectionApi:p,setOverlayHoveredStyles:R,appearance:E,children:M}):(0,o.jsx)("span",{className:"card","data-vc":"editor-plugin-inline-card","data-ssr-placeholder":`editor-plugin-inline-card-${B}`,"data-ssr-placeholder-replace":`editor-plugin-inline-card-${B}`,children:M})}),z=(0,n.memo)(({node:e,cardContext:i,actionOptions:u,useAlternativePreloader:h,view:m,getPos:f,onClick:g,onResolve:b,isHovered:E,showHoverPreview:T,hoverPreviewOptions:C,isPageSSRed:_,provider:S,pluginInjectionApi:w,disablePreviewPanel:v})=>{let{url:O,data:y}=e.attrs,N=(0,n.useRef)(t(r)());(0,n.useEffect)(()=>{let e=N.current;return()=>{let{tr:t}=m.state;(0,a("9AGwg").removeCard)({id:e})(t),m.dispatch(t)}},[f,m]);let R=(0,n.useMemo)(()=>(0,a("7YjFd").findOverflowScrollParent)(m.dom)||void 0,[m.dom]),x=(0,n.useCallback)(e=>{if(!f||"boolean"==typeof f)return;let{title:t,url:i}=e;(0,a("2P8Ax").default)(()=>{let e=f();if("number"!=typeof e)return;let o=m.state.tr;(0,a("9AGwg").registerCard)({title:t,url:i,pos:e,id:N.current})(o),b?.(o,t),m.dispatch(o)})()},[f,m,b]),A=(0,n.useCallback)(e=>{let{url:t,err:i}=e;if(i)throw i;x({url:t})},[x]),I=(0,n.useCallback)(e=>{if(e.metaKey||e.ctrlKey){let{actions:e}=w?.analytics??{};(0,p.visitCardLinkAnalytics)(e,a("d925B").INPUT_METHOD.META_CLICK)(m.state,m.dispatch),window.open(O,"_blank")}else g?.(e)},[g,O,m,w]),L=(0,c.editorExperiment)("platform_editor_controls","variant1")?I:g,k=(0,n.useMemo)(()=>_&&O?(0,o.jsx)(s.CardSSR,{url:O,appearance:"inline",onClick:L,container:R,onResolve:x,onError:A,inlinePreloaderStyle:h?"on-right-without-skeleton":void 0,actionOptions:u,isHovered:E,showHoverPreview:T,hoverPreviewOptions:C,disablePreviewPanel:v,hideIconLoadingSkeleton:(0,d.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)},O):(0,o.jsx)(l.Card,{url:O??y.url,appearance:"inline",onClick:L,container:R,onResolve:x,onError:A,inlinePreloaderStyle:h?"on-right-without-skeleton":void 0,actionOptions:u,isHovered:E,showHoverPreview:T,hoverPreviewOptions:C,disablePreviewPanel:v},O),[O,y,L,R,x,A,h,u,E,T,C,_,v]);return i&&i.value?(0,o.jsx)(i.Provider,{value:i.value,children:k}):y?k:null}),V=(0,a("cOfDZ").Card)(F,a("gndLe").default),G=e=>({mode:e.editorViewModeState?.mode});e.exports.InlineCard=z,e.exports.InlineCardNodeView=function(e){let{useAlternativePreloader:t,node:i,view:n,getPos:r,actionOptions:l,allowEmbeds:s,allowBlockCards:d,enableInlineUpgradeFeatures:c,pluginInjectionApi:p,onClickCallback:u,isPageSSRed:h,provider:m,CompetitorPrompt:f}=e,{mode:g}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(p,["editorViewMode"],G),b=i.attrs.url,E=f&&b?(0,o.jsx)(f,{sourceUrl:b,linkType:"inline"}):null;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(V,{node:i,view:n,getPos:r,actionOptions:l,useAlternativePreloader:t,pluginInjectionApi:p,onClickCallback:u,isPageSSRed:h,provider:m,appearance:"inline",...c&&(0,a("hrFA1").getAwarenessProps)(n.state,r,s,d,"view"===g)}),(0,a("dh538").fg)("prompt_whiteboard_competitor_link_gate")&&E]})},e.exports.inlineCardNodeView=({inlineCardViewProducer:e})=>(t,i,o,n)=>e(t,i,o,n)}),r("6xEOh",function(e,i){var o=a("42omo"),n=a("8m4tT"),r=a("1oCLl");let l=[{id:"editor.media.alignLeft",value:"align-start",icon:()=>t(o).createElement(t(a("1dusJ")),{color:"currentColor",spacing:"spacious",label:"media-toolbar-align-left-icon"})},{id:"editor.media.alignCenter",value:"center",icon:()=>t(o).createElement(t(a("dxgIg")),{color:"currentColor",spacing:"spacious",label:"media-toolbar-align-center-icon"})},{id:"editor.media.alignRight",value:"align-end",icon:()=>t(o).createElement(t(a("9Y9Mx")),{color:"currentColor",spacing:"spacious",label:"media-toolbar-align-right-icon"})}],s=[{id:"editor.media.alignLeft",value:"align-start",icon:()=>t(o).createElement(t(a("6bJyJ")),{color:"currentColor",spacing:"spacious",label:""}),keyboardShortcut:a("hgeg8").alignLeft},{id:"editor.media.alignCenter",value:"center",icon:()=>t(o).createElement(t(a("kiZiu")),{color:"currentColor",spacing:"spacious",label:""}),keyboardShortcut:a("hgeg8").alignCenter},{id:"editor.media.alignRight",value:"align-end",icon:()=>t(o).createElement(t(a("cOZT3")),{color:"currentColor",spacing:"spacious",label:""}),keyboardShortcut:a("hgeg8").alignRight}],d=[{id:"editor.media.wrapLeft",value:"wrap-left",icon:()=>t(o).createElement(t(a("9Ctkw")),{color:"currentColor",spacing:"spacious",label:"media-toolbar-wrap-left-icon"})},{id:"editor.media.wrapRight",value:"wrap-right",icon:()=>t(o).createElement(t(a("kVA9C")),{color:"currentColor",spacing:"spacious",label:"media-toolbar-wrap-right-icon"})}],c=[{value:"wide",icon:t(a("kDG8M"))},{value:"full-width",icon:t(a("gzsfl"))}],p={"wrap-left":a("gVDfZ").toolbarMessages.wrapLeft,center:a("61p3e").default.alignImageCenter,"wrap-right":a("gVDfZ").toolbarMessages.wrapRight,wide:a("61p3e").default.layoutWide,"full-width":a("61p3e").default.layoutFullWidth,"align-end":a("61p3e").default.alignImageRight,"align-start":a("61p3e").default.alignImageLeft},u=(e,t)=>{let{embedCard:i}=t.nodes;return e.type===i?e.attrs.originalWidth||a("aFUXX").DEFAULT_EMBED_CARD_WIDTH:e.firstChild&&e.firstChild.attrs.width||e.attrs.width},h=(e,t,i,o,n)=>(r,l)=>{let{node:s}=r.selection,{layout:d}=s.attrs,{mediaSingle:c}=r.schema.nodes;if(!l)return!1;let p=i?.sharedState.currentState();if(!s||s.type!==t||!p)return!1;let h=u(s,r.schema),m=n?{...s.attrs,layout:e}:(0,a("lqWNh").alignAttributes)(e,s.attrs,void 0,h,p.lineLength),f=r.tr.setNodeMarkup(r.selection.from,void 0,m);f.setMeta("scrollIntoView",!1),f.setSelection(a("ks2lK").NodeSelection.create(f.doc,r.selection.from));let{doc:{type:{schema:{nodes:{paragraph:g}}}}}=f;if(e.startsWith("wrap")&&g&&!f.doc.nodeAt(r.selection.to)&&((0,a("4KOFJ").insideTable)(r)||(0,a("kTbzR").isInLayoutColumn)(r))){let e=g.createAndFill();e&&f.insert(r.selection.to,e)}return o?.attachAnalyticsEvent({eventType:a("d925B").EVENT_TYPE.TRACK,action:a("d925B").ACTION.SELECTED,actionSubject:a("d925B").ACTION_SUBJECT[s.type===c?"MEDIA_SINGLE":"EMBEDS"],actionSubjectId:a("d925B").ACTION_SUBJECT_ID.RICH_MEDIA_LAYOUT,attributes:{previousLayoutType:d,currentLayoutType:e}})(f),l(f),!0},m=(e,t)=>a("lqWNh").nonWrappedLayouts.includes(e)&&t?"center":e,f=(e,t,i,o,n,a,r,l)=>e.map(e=>{let{id:s,value:d}=e;return{id:s,type:"button",icon:e.icon,title:i.formatMessage(p[d]),selected:m(t,l)===d,onClick:h(d,o,n,a,l),...r&&{disabled:"center"!==d}}}),g=({icons:e,layout:i,intl:n,nodeType:r,widthPluginDependencyApi:l,analyticsApi:s,isChangingLayoutDisabled:d,allowPixelResizing:c})=>e.map(e=>{let{id:u,value:f}=e;return{id:u,icon:t(o).createElement(e.icon,{label:""}),title:n.formatMessage(p[f]),selected:m(i,c)===f,onClick:h(f,r,l,s,c),...e.keyboardShortcut&&{elemAfter:t(o).createElement(a("807Mc").Shortcut,null,(0,a("hgeg8").tooltip)(e.keyboardShortcut))},...d&&{disabled:"center"!==f}}}),b=(e,{nodes:t},i)=>(0,n.hasParentNodeOfType)([t.bodiedExtension,t.extensionFrame,t.listItem,...(0,r.expValEquals)("editor_enable_image_alignment_in_expand","isEnabled",!0)?[]:[t.expand,t.nestedExpand],...i?[]:[t.table]].filter(Boolean))(e),E=(e,t)=>{let i=t.attrs.layout;return e.find(e=>e.value===(a("lqWNh").nonWrappedLayouts.includes(i)?"center":i))},T=(e,t)=>e&&t?[{type:"separator"}]:[],C=(e,t,i)=>!i&&(e||t)?[{type:"separator"}]:[];e.exports.alignmentIcons=l,e.exports.wrappingIcons=d,e.exports.layoutToMessages=p,e.exports.buildLayoutDropdown=(e,t,i,o,n,r,l,u=!0,h=!0,m,f)=>{let{selection:T}=e;if(!(T instanceof a("ks2lK").NodeSelection)||!T.node||!i||b(T,e.schema,l))return[];let{layout:C}=T.node.attrs,_=[];if(h&&_.push(...s),u&&_.push(...d),r||_.push(...c),0===_.length)return[];let S=E(_,T.node)||_[0];if(!S)return[];let w=g({icons:_,layout:C,intl:t,nodeType:i,widthPluginDependencyApi:o,analyticsApi:n,isChangingLayoutDisabled:m,allowPixelResizing:f});return[{type:"dropdown",title:t.formatMessage(p[S.value]),icon:S.icon,options:w,shouldFitContainer:!1,testId:`${i.name}-layout-dropdown-trigger-button`}]},e.exports.default=(e,t,i,o,n,r,s,p=!0,u=!0,h,m)=>{let{selection:g}=e;if(!(g instanceof a("ks2lK").NodeSelection)||!g.node||!i||b(g,e.schema,s))return[];let{layout:E}=g.node.attrs,_=u?f(l,E,t,i,o,n,h,m):[],S=p?f(d,E,t,i,o,n,h,m):[],w=r?[]:f(c,E,t,i,o,n,m);return[..._,...T(u,p),...S,...C(u,p,r),...w]}}),r("6JHzw",function(e,i){var o=a("l998X"),n=a("42omo"),r=a("cUcZ5"),l=a("hpUsb"),s=a("9CM6e"),d=a("1oCLl");let c=e=>{if(e&&"boolean"!=typeof e)try{return e()}catch(e){}};class p extends t(n).PureComponent{updateTableProperties(e,t,i){let{state:o,dispatch:n}=this.props.view,a=c(this.props.getPos);if(void 0===a)return;let r=[{type:"table",properties:{columns:(e.length>0?e:Array.from(new Set([...Object.keys(t),...i]))).map(e=>{let o=t[e],n=i.includes(e);return{key:e,...o?{width:o}:{},...n?{isWrapped:n}:{}}})}}],l=this.props.node.attrs,s=o.tr.setNodeMarkup(a,void 0,{...l,datasource:{...l.datasource,views:r}});s.setMeta("addToHistory",!1),s.setMeta("scrollIntoView",!1),n(s)}getColumnsInfo(){let e,t=this.getTableView(),i=t?.properties?.columns,o=i?.map(({key:e})=>e),n=i?.filter(e=>!!e.width);return n&&(e=Object.fromEntries(n.map(e=>[e.key,e.width]))),{visibleColumnKeys:o,columnCustomSizes:e,wrappedColumnKeys:i?.filter(e=>e.isWrapped).map(e=>e.key)}}render(){let e=this.getDatasource(),t=this.props.node.attrs;if(this.getTableView()){let{visibleColumnKeys:i,columnCustomSizes:o,wrappedColumnKeys:n}=this.getColumnsInfo();return(0,a("9K4OG").jsx)(a("eIleF").EditorSmartCardProviderValueGuard,null,(0,a("9K4OG").jsx)(a("aJdNi").EditorAnalyticsContext,{editorView:this.props.view},(0,a("9K4OG").jsx)(a("eIleF").EditorSmartCardProvider,null,(0,a("9K4OG").jsx)(a("eLQM6").default,{datasourceId:e.id,parameters:e.parameters,visibleColumnKeys:i,onVisibleColumnKeysChange:this.handleColumnChange,url:t?.url,onColumnResize:this.handleColumnResize,columnCustomSizes:o,onWrappedColumnChange:this.handleWrappedColumnChange,wrappedColumnKeys:n}))))}return null}constructor(e){super(e),this.getDatasource=()=>this.props.node.attrs.datasource,this.getTableView=()=>this.getDatasource().views.find(e=>"table"===e.type)||void 0,this.handleColumnChange=e=>{let{wrappedColumnKeys:t=[],columnCustomSizes:i={}}=this.getColumnsInfo();this.updateTableProperties(e,i,t)},this.handleColumnResize=(e,t)=>{let{wrappedColumnKeys:i=[],columnCustomSizes:o={},visibleColumnKeys:n=[]}=this.getColumnsInfo(),a={...o,[e]:t};this.updateTableProperties(n,a,i)},this.handleWrappedColumnChange=(e,t)=>{let{wrappedColumnKeys:i=[],columnCustomSizes:o={},visibleColumnKeys:n=[]}=this.getColumnsInfo(),a=new Set(i);t?a.add(e):a.delete(e),this.updateTableProperties(n,o,Array.from(a))},this.onError=({err:e})=>{if(e)throw e}}}class u extends a("2gkmX").default{validUpdate(e,t){return!!t.attrs?.datasource}update(e,t,i){return super.update(e,t,i,this.validUpdate)}createDomRef(){let e=document.createElement("div");return e.setAttribute("contenteditable","true"),e.classList.add(a("cV5SN").SmartCardSharedCssClassName.DATASOURCE_CONTAINER),e}stopEvent(e){return!![HTMLButtonElement,HTMLInputElement].some(t=>e.target instanceof t)}render(){let{attrs:e}=this.node;return this.domRef?.setAttribute("draggable","false"),(0,a("9K4OG").jsx)(a("dQwlz").DatasourceErrorBoundary,{unsupportedComponent:a("gndLe").default,view:this.view,url:e.url,datasourceId:e?.datasource?.id},(0,a("9K4OG").jsx)("div",{className:a("0vvte").DATASOURCE_INNER_CONTAINER_CLASSNAME,style:{minWidth:this.isNodeNested?"100%":(0,a("fJNzZ").calcBreakoutWidth)(e.layout||a("hBNGD").DATASOURCE_DEFAULT_LAYOUT,this.tableWidth)}},(0,a("9K4OG").jsx)(p,{node:this.node,view:this.view,getPos:this.getPos})))}constructor(e){super(e.node,e.view,e.getPos,e.portalProviderAPI,e.eventDispatcher,e),this.tableWidth=void 0,this.isNodeNested=void 0;let t=e?.pluginInjectionApi?.width?.sharedState;this.tableWidth=t?.currentState()?.width,this.isNodeNested=e.isNodeNested,t?.onChange(({nextSharedState:e})=>{e?.width&&this.tableWidth!==e?.width&&(this.tableWidth=e?.width,this.update(this.node,[]))})}}class h extends t(n).PureComponent{componentWillUnmount(){this.removeCard()}removeCard(){if(this.removeCardDispatched)return;this.removeCardDispatched=!0;let{tr:e}=this.props.view.state;(0,a("9AGwg").removeCard)({id:this.props.id})(e),this.props.view.dispatch(e)}render(){let{node:e,cardContext:t,actionOptions:i,onClick:n,CompetitorPrompt:a,isPageSSRed:r}=this.props,{url:c,data:p}=e.attrs,u=(0,d.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)&&r?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.CardSSR,{url:c??p.url,container:this.scrollContainer,appearance:"block",onClick:n,onResolve:this.onResolve,onError:this.onError,platform:"web",actionOptions:i,CompetitorPrompt:a,hideIconLoadingSkeleton:!0},c),this.gapCursorSpan()]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.Card,{url:c??p.url,container:this.scrollContainer,appearance:"block",onClick:n,onResolve:this.onResolve,onError:this.onError,platform:"web",actionOptions:i,CompetitorPrompt:a},c),this.gapCursorSpan()]});return(0,o.jsx)("div",{children:t&&t.value?(0,o.jsx)(t.Provider,{value:t.value,children:u}):p?u:null})}constructor(e){super(e),this.scrollContainer=void 0,this.onResolve=e=>{let{getPos:t,view:i}=this.props;if(!t||"boolean"==typeof t)return;let{title:o,url:n}=e;(0,a("2P8Ax").default)(()=>{let e=t();"number"==typeof e&&i.dispatch((0,a("9AGwg").registerCard)({title:o,url:n,pos:e,id:this.props.id})(i.state.tr))})()},this.removeCardDispatched=!1,this.gapCursorSpan=()=>{let e=(0,d.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser;if(!e.ie||!(e.ie_version<79))return(0,o.jsx)("span",{contentEditable:!0})},this.onError=({err:e})=>{if(e)throw e},this.scrollContainer=(0,a("7YjFd").findOverflowScrollParent)(e.view.dom)||void 0}}let m=(0,a("cOfDZ").Card)(h,a("iq4lN").default);class f extends a("2gkmX").default{createDomRef(){let e=document.createElement("div");return this.unsubscribe=this.reactComponentProps.pluginInjectionApi?.editorViewMode?.sharedState.onChange(({nextSharedState:t})=>this.updateContentEditable(t,e)),this.updateContentEditable(this.reactComponentProps.pluginInjectionApi?.editorViewMode?.sharedState.currentState(),e),e.setAttribute("spellcheck","false"),e}validUpdate(e,t){let i=!(0,a("hrFA1").isDatasourceNode)(e),o=(0,a("hrFA1").isDatasourceNode)(t);return!(i&&o)}update(e,t,i){return super.update(e,t,i,this.validUpdate)}render(){let{actionOptions:e,pluginInjectionApi:t,onClickCallback:i,CompetitorPrompt:n,isPageSSRed:a,provider:r}=this.reactComponentProps;return(0,o.jsx)(m,{node:this.node,view:this.view,getPos:this.getPos,actionOptions:e,pluginInjectionApi:t,onClickCallback:i,id:this.id,CompetitorPrompt:n,isPageSSRed:a,provider:r})}destroy(){this.unsubscribe?.(),super.destroy()}constructor(...e){super(...e),this.id=t(r)(),this.unsubscribe=void 0,this.updateContentEditable=(e,t)=>{t.contentEditable=e?.mode==="view"?"false":"true"}}}e.exports.BlockCardComponent=h,e.exports.blockCardNodeView=({pmPluginFactoryParams:e,actionOptions:t,pluginInjectionApi:i,onClickCallback:o,allowDatasource:n,inlineCardViewProducer:r,CompetitorPrompt:l,isPageSSRed:s,provider:d})=>(c,p,h,m)=>{let{portalProviderAPI:g,eventDispatcher:b}=e;if((0,a("hrFA1").isDatasourceNode)(c))if(!(n&&(0,a("16GCc").canRenderDatasource)(c?.attrs?.datasource?.id)))return r(c,p,h,m);else{let e="function"==typeof h&&h(),t=e&&p.state.doc.resolve(e);return new u({node:c,view:p,getPos:h,portalProviderAPI:g,eventDispatcher:b,pluginInjectionApi:i,isNodeNested:!!(t&&t.depth>0)}).init()}return new f(c,p,h,g,b,{actionOptions:t,pluginInjectionApi:i,onClickCallback:o,CompetitorPrompt:l,isPageSSRed:s,provider:d},void 0).init()}}),r("7IyZf",function(e,i){var o=a("l998X"),n=a("42omo"),r=a("cUcZ5"),l=a("hpUsb"),s=a("9CM6e"),d=a("1oCLl"),c=a("iu6m9");let p=e=>(0,a("9K4OG").css)("&>div{",(0,a("1OLls").MediaSingleDimensionHelper)(e),";position:relative;clear:both;>div{position:absolute;height:100%;width:100%;}}");var u=a("8m4tT");class h extends t(n).Component{componentDidUpdate(e){let t=this.calcOffsetLeft();t!==this.state.offsetLeft&&t>=0&&this.setState({offsetLeft:t}),this.props.layout!==e.layout&&this.checkLayout(e.layout,this.props.layout)}get wrappedLayout(){return a("3UbBx").wrappedLayouts.indexOf(this.props.layout)>-1}checkLayout(e,t){let{resizedPctWidth:i}=this.state;if(a("3UbBx").wrappedLayouts.indexOf(e)>-1&&"center"===t&&i){let e=this.calcUnwrappedLayout(i,this.calcPxWidth(t));this.props.updateSize(i,e)}}get $pos(){if("function"!=typeof this.props.getPos)return null;let e=this.props.getPos();return Number.isNaN(e)||"number"!=typeof e?null:this.props.view.state.doc.resolve(e)}get gridWidth(){let{gridSize:e}=this.props;return this.wrappedLayout||this.insideInlineLike?e:e/2}calcOffsetLeft(){let e=0;if(this.wrapper&&this.insideInlineLike){let t=this.wrapper.getBoundingClientRect(),i=this.props.view.dom.getBoundingClientRect();e=t.left-i.left}return e}get wideLayoutWidth(){let{lineLength:e}=this.props;return e?Math.ceil(e*a("aFUXX").breakoutWideScaleRatio):a("aFUXX").akEditorWideLayoutWidth}isNestedInTable(){let{table:e}=this.props.view.state.schema.nodes;return!!this.$pos&&!!(0,u.findParentNodeOfTypeClosestToPos)(this.$pos,e)}calcSnapPoints(){let{offsetLeft:e}=this.state,{containerWidth:t,lineLength:i}=this.props,o=[];for(let t=0;t<this.gridWidth;t++)o.push((0,a("3UbBx").calcPxFromColumns)(t,i,this.gridWidth)-e);o.push(i-e);let n=(0,a("3UbBx").calcPxFromColumns)(this.wrappedLayout||this.insideInlineLike?1:2,i,this.props.gridSize),r=o.filter(e=>e>=n),l=this.$pos;if(!l)return r;if("doc"===l.parent.type.name){r.push(this.wideLayoutWidth);let e=t-a("aFUXX").akEditorBreakoutPadding;e>this.wideLayoutWidth&&r.push(e)}return r}get insideInlineLike(){let e=this.$pos;if(!e)return!1;let{listItem:t}=this.props.view.state.schema.nodes;return!!(0,u.findParentNodeOfTypeClosestToPos)(e,[t])}getHeightDefiningComponent(){let e,{height:t,aspectRatio:i}=this.props;return e=t?{height:`${t}px`}:{paddingBottom:`calc(${(1/i*100).toFixed(3)}% + ${a("kVnOi").embedHeaderHeight}px)`},(0,a("9K4OG").jsx)("span",{"data-testid":"resizable-embed-card-height-definer",style:{display:"block",fontSize:0,lineHeight:0,...e}})}render(){let{layout:e,pctWidth:t,containerWidth:i,fullWidthMode:o,isResizeDisabled:n,children:r}=this.props,l={width:this.calcPxWidth(),innerPadding:a("aFUXX").akEditorMediaResizeHandlerPadding},s={};return a("7U0RE").handleSides.forEach(t=>{if(n){s[t]=!1;return}let i="left"===t?"right":"left";s[t]=["full-width","wide","center"].concat(`wrap-${i}`).concat(`align-${a("7U0RE").imageAlignmentMap[i]}`).indexOf(e)>-1,"left"===t&&this.insideInlineLike&&(s[t]=!1)}),(0,a("9K4OG").jsx)("div",{"data-testid":"resizable-embed-card-spacing"},(0,a("9K4OG").jsx)("div",{css:p({layout:e,isResized:!!t,containerWidth:i||a("aFUXX").DEFAULT_EMBED_CARD_WIDTH,fullWidthMode:o})},(0,a("9K4OG").jsx)(a("5dl3F").default,{...this.props,enable:s,calcNewSize:this.calcNewSize,snapPoints:this.calcSnapPoints(),scaleFactor:this.wrappedLayout||this.insideInlineLike?1:2,highlights:this.highlights,nodeType:"embed",handleStyles:(e=>{if(e)return{left:{left:"calc(var(--ds-space-negative-025, -0.125em) * 0.5)",paddingLeft:"0px"},right:{right:"calc(var(--ds-space-negative-025, -0.125em) * 0.5)",paddingRight:"0px"}}})(this.isNestedInTable()),...l},r,this.getHeightDefiningComponent())))}constructor(...e){super(...e),this.state={offsetLeft:this.calcOffsetLeft()},this.calcNewSize=(e,t)=>{let{layout:i,view:{state:o}}=this.props,n=100*(0,a("3UbBx").calcPctFromPx)(e,this.props.lineLength);this.setState({resizedPctWidth:n});let r=(0,u.hasParentNodeOfType)(o.schema.nodes.table)(o.selection)?i:this.calcUnwrappedLayout(n,e);return n<=100?(this.wrappedLayout&&(!t||100!==n)&&(r=i),{width:n,layout:r}):{width:this.props.pctWidth||null,layout:r}},this.calcUnwrappedLayout=(e,t)=>e<=100?"center":t<=this.wideLayoutWidth?"wide":"full-width",this.calcColumnLeftOffset=()=>{let{offsetLeft:e}=this.state;return this.insideInlineLike?(0,a("3UbBx").calcColumnsFromPx)(e,this.props.lineLength,this.props.gridSize):0},this.wrapper=void 0,this.calcPxWidth=e=>{let{layout:t,pctWidth:i,lineLength:o,containerWidth:n,fullWidthMode:r,getPos:l,view:{state:s}}=this.props,{resizedPctWidth:d}=this.state,c="function"==typeof l?l():void 0;return(0,a("3UbBx").calcMediaPxWidth)({origWidth:a("aFUXX").DEFAULT_EMBED_CARD_WIDTH,origHeight:a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT,pctWidth:i,state:s,containerWidth:{width:n,lineLength:o},isFullWidthModeEnabled:r,layout:e||t,pos:c,resizedPctWidth:d})},this.highlights=(e,t)=>{let i=(0,a("7U0RE").snapTo)(e,t),{layoutColumn:o,table:n,expand:r,nestedExpand:l}=this.props.view.state.schema.nodes;if(this.$pos&&(0,u.findParentNodeOfTypeClosestToPos)(this.$pos,[o,n,r,l].filter(Boolean)))return[];if(i>this.wideLayoutWidth)return["full-width"];let{layout:s,lineLength:d,gridSize:c}=this.props,p=(0,a("3UbBx").calcColumnsFromPx)(i,d,c),h=Math.round(p),m=[];return"wrap-left"===s||"align-start"===s?m.push(0,h):"wrap-right"===s||"align-end"===s?m.push(c,c-h):this.insideInlineLike?m.push(Math.round(p+this.calcColumnLeftOffset())):m.push(Math.floor((c-h)/2),Math.ceil((c+h)/2)),m}}}h.defaultProps={aspectRatio:a("aFUXX").DEFAULT_EMBED_CARD_WIDTH/a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT};var m=a("6JHzw");let f=e=>({widthStateLineLength:e.widthState?.lineLength||0,widthStateWidth:e.widthState?.width||0,editorDisabled:e.editorDisabledState?.editorDisabled}),g=({pluginInjectionApi:e,getPosSafely:t,getLineLength:i,view:n,smartCard:r,updateSize:l,getPos:s,aspectRatio:d,allowResizing:c,hasPreview:p,heightAlone:u,cardProps:m,dispatchAnalyticsEvent:g})=>{let{widthStateLineLength:b,widthStateWidth:E,editorDisabled:T}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e,["width","editorDisabled"],f),C=t();if(void 0===C)return null;let _=i(n,C,b),S=(0,a("lqWNh").isRichMediaInsideOfBlockNode)(n,C)?_:E;if(!c||!p){let e=a("aFUXX").DEFAULT_EMBED_CARD_WIDTH/a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT,t=1,i=d||e;return u&&(t=u,i=void 0),(0,o.jsx)(a("6CRn4").default,{...m,height:t,width:i,nodeType:"embedCard",hasFallbackContainer:p,lineLength:_,containerWidth:S,children:r})}return(0,o.jsx)(h,{...m,height:u,aspectRatio:d,view:n,getPos:s,lineLength:_,gridSize:12,containerWidth:S,displayGrid:(t,i,o)=>e?.grid?.actions?.displayGrid(n)({visible:t,gridType:i,highlight:o}),updateSize:l,dispatchAnalyticsEvent:g,isResizeDisabled:T,children:r})};class b extends t(n).PureComponent{componentWillUnmount(){this.removeCard()}removeCard(){if(this.removeCardDispatched)return;this.removeCardDispatched=!0;let{tr:e}=this.props.view.state;(0,a("9AGwg").removeCard)({id:this.props.id})(e),this.props.view.dispatch(e)}render(){let{node:e,allowResizing:t,fullWidthMode:i,view:n,dispatchAnalyticsEvent:r,getPos:c,pluginInjectionApi:p,actionOptions:u,onClick:h,CompetitorPrompt:m,isPageSSRed:f}=this.props,{url:b,width:E,layout:T,originalHeight:C,originalWidth:_}=e.attrs,{hasPreview:S,liveHeight:w,initialAspectRatio:v}=this.state,O=w??(!_&&C||void 0),y=!O&&(v||C&&_&&_/C)||void 0,N=(0,d.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)&&f?(0,o.jsx)(s.CardSSR,{url:b,appearance:"embed",onClick:h,onResolve:this.onResolve,onError:this.onError,frameStyle:"show",inheritDimensions:!0,platform:"web",container:this.scrollContainer,embedIframeRef:this.embedIframeRef,actionOptions:u,CompetitorPrompt:m,hideIconLoadingSkeleton:!0},b):(0,o.jsx)(l.Card,{url:b,appearance:"embed",onClick:h,onResolve:this.onResolve,onError:this.onError,frameStyle:"show",inheritDimensions:!0,platform:"web",container:this.scrollContainer,embedIframeRef:this.embedIframeRef,actionOptions:u,CompetitorPrompt:m},b);return(0,o.jsx)(a("9ISlX").EmbedResizeMessageListener,{embedIframeRef:this.embedIframeRef,onHeightUpdate:this.onHeightUpdate,children:(0,o.jsx)(g,{pluginInjectionApi:p,smartCard:N,hasPreview:S,getPosSafely:this.getPosSafely,view:n,getLineLength:this.getLineLength,eventDispatcher:this.props.eventDispatcher,updateSize:this.updateSize,getPos:c,aspectRatio:y,allowResizing:t,heightAlone:O,cardProps:{layout:T,pctWidth:E,fullWidthMode:i},dispatchAnalyticsEvent:r})})}constructor(e){super(e),this.scrollContainer=void 0,this.embedIframeRef=t(n).createRef(),this.state=void 0,this.getPosSafely=()=>{let{getPos:e}=this.props;if(e&&"boolean"!=typeof e)try{return e()}catch{}},this.onResolve=e=>{let{view:t}=this.props,{title:i,url:o,aspectRatio:n}=e,{originalHeight:r,originalWidth:l}=this.props.node.attrs;!n||r||l||(this.setState({initialAspectRatio:n}),this.saveOriginalDimensionsAttributes(a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT,a("aFUXX").DEFAULT_EMBED_CARD_HEIGHT*n)),(0,a("2P8Ax").default)(()=>{let e=this.getPosSafely();if(void 0!==e)return t.dispatch((0,a("9AGwg").registerCard)({title:i,url:o,pos:e,id:this.props.id})(t.state.tr))})();try{let e=this.props.cardContext?.value?this.props.cardContext?.value:void 0;o&&e&&e.extractors.getPreview(o,"web")||this.setState({hasPreview:!1})}catch{}},this.updateSize=(e,t)=>{let{state:i,dispatch:o}=this.props.view,n=this.getPosSafely();if(void 0===n)return;let a=i.tr.setNodeMarkup(n,void 0,{...this.props.node.attrs,width:e,layout:t});return a.setMeta("scrollIntoView",!1),o(a),!0},this.scheduleLineLengthRemeasureRaf=(0,a("2P8Ax").default)(e=>{e&&this.forceUpdate()}),this.getLineLength=(e,t,i)=>{if("number"==typeof t&&(0,a("lqWNh").isRichMediaInsideOfBlockNode)(e,t)){let o=e.state.doc.resolve(t),n=e.nodeDOM(o.pos);if(o.nodeAfter&&a("lqWNh").floatingLayouts.indexOf(o.nodeAfter.attrs.layout)>-1&&n&&n.parentElement)return n.parentElement.offsetWidth;if(n instanceof HTMLElement){let t=n.offsetWidth;return t<=1&&(0,d.expValEquals)("editor_fix_embed_width_expand","isEnabled",!0)?(this.scheduleLineLengthRemeasureRaf(e),i):t}}return i},this.saveOriginalDimensionsAttributes=(e,t)=>{let{view:i}=this.props,o=({key:"tableFlexiColumnResizing$",getState:e=>e.tableFlexiColumnResizing$}).getState(i.state);o?.dragging||(0,a("2P8Ax").default)(()=>{let o=this.getPosSafely();void 0!==o&&i.dispatch(i.state.tr.step(new(0,a("9YoeD").SetAttrsStep)(o,{originalHeight:e,originalWidth:t})).setMeta("addToHistory",!1))})()},this.onHeightUpdate=e=>{this.setState({liveHeight:e}),this.saveOriginalDimensionsAttributes(e,void 0)},this.onError=({err:e})=>{if(e)throw e},this.removeCardDispatched=!1,this.scrollContainer=(0,a("7YjFd").findOverflowScrollParent)(e.view.dom)||void 0,this.state={hasPreview:!0}}}let E=(0,a("9JpPs").componentWithCondition)(()=>(0,c.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0}),e=>{let t=(0,a("b3YrF").useSharedPluginStateSelector)(e.pluginInjectionApi,"width.width");return t&&t<=a("aFUXX").akEditorFullPageNarrowBreakout?(0,o.jsx)(m.BlockCardComponent,{id:e.id,node:e.node,view:e.view,getPos:e.getPos,pluginInjectionApi:e.pluginInjectionApi,actionOptions:e.actionOptions,onClick:e.onClick,CompetitorPrompt:e.CompetitorPrompt,allowResizing:e.allowResizing,fullWidthMode:e.fullWidthMode,dispatchAnalyticsEvent:e.dispatchAnalyticsEvent,eventDispatcher:e.eventDispatcher,cardContext:e.cardContext,smartCard:e.smartCard,hasPreview:e.hasPreview,liveHeight:e.liveHeight,initialAspectRatio:e.initialAspectRatio,isPageSSRed:e.isPageSSRed,provider:e.provider}):(0,o.jsx)(b,{id:e.id,node:e.node,view:e.view,getPos:e.getPos,pluginInjectionApi:e.pluginInjectionApi,actionOptions:e.actionOptions,onClick:e.onClick,CompetitorPrompt:e.CompetitorPrompt,allowResizing:e.allowResizing,fullWidthMode:e.fullWidthMode,dispatchAnalyticsEvent:e.dispatchAnalyticsEvent,eventDispatcher:e.eventDispatcher,cardContext:e.cardContext,smartCard:e.smartCard,hasPreview:e.hasPreview,liveHeight:e.liveHeight,initialAspectRatio:e.initialAspectRatio,isPageSSRed:e.isPageSSRed,provider:e.provider})},b),T=(0,a("cOfDZ").Card)(E,a("iq4lN").default);class C extends a("2gkmX").default{viewShouldUpdate(e){return this.node.attrs!==e.attrs||super.viewShouldUpdate(e)}createDomRef(){let e=document.createElement("div");return this.unsubscribe=this.reactComponentProps.pluginInjectionApi?.editorViewMode?.sharedState.onChange(({nextSharedState:t})=>this.updateContentEditable(t,e)),this.updateContentEditable(this.reactComponentProps.pluginInjectionApi?.editorViewMode?.sharedState.currentState(),e),e.setAttribute("spellcheck","false"),e}render(){let{eventDispatcher:e,allowResizing:t,fullWidthMode:i,dispatchAnalyticsEvent:n,pluginInjectionApi:a,onClickCallback:r,CompetitorPrompt:l,isPageSSRed:s,provider:d}=this.reactComponentProps;return(0,o.jsx)(T,{node:this.node,view:this.view,eventDispatcher:e,getPos:this.getPos,allowResizing:t,fullWidthMode:i,dispatchAnalyticsEvent:n,pluginInjectionApi:a,onClickCallback:r,id:this.id,CompetitorPrompt:l,isPageSSRed:s,provider:d})}destroy(){this.unsubscribe?.(),super.destroy()}constructor(...e){super(...e),this.id=t(r)(),this.unsubscribe=void 0,this.updateContentEditable=(e,t)=>{t.contentEditable=e?.mode==="view"?"false":"true"}}}e.exports.embedCardNodeView=({allowResizing:e,fullWidthMode:t,pmPluginFactoryParams:i,pluginInjectionApi:o,actionOptions:n,onClickCallback:a,CompetitorPrompt:r,isPageSSRed:l,provider:s})=>(d,c,p)=>{let{portalProviderAPI:u,eventDispatcher:h,dispatchAnalyticsEvent:m}=i;return new C(d,c,p,u,h,{eventDispatcher:h,allowResizing:e,fullWidthMode:t,dispatchAnalyticsEvent:m,pluginInjectionApi:o,actionOptions:n,onClickCallback:a,CompetitorPrompt:r,isPageSSRed:l,provider:s}).init()}}),r("9YoeD",function(e,t){class i extends a("cO9ey").Step{apply(e){let t=e.nodeAt(this.pos);if(!t)return a("aXG5V").StepResult.fail("No node at given position");if(t.isText)return a("aXG5V").StepResult.fail("Target is a text node. Attributes are not allowed.");let i={...t.attrs||{},...this.attrs||{}},o=t.type.create(i,a("5SAOw").Fragment.empty,t.marks),n=new(0,a("5SAOw").Slice)(a("5SAOw").Fragment.from(o),0,+!t.isLeaf);return a("aXG5V").StepResult.fromReplace(e,this.pos,this.pos+1,n)}invert(e){let t=e.nodeAt(this.pos);return new i(this.pos,t?t.attrs:{})}map(e){let t=e.mapResult(this.pos,1);return t.deleted?null:new i(t.pos,this.attrs)}toJSON(){return{stepType:"setAttrs",pos:this.pos,attrs:this.attrs}}static fromJSON(e,t){if("number"!=typeof t.pos||null!==t.attrs&&"object"!=typeof t.attrs)throw RangeError("Invalid input for SetAttrsStep.fromJSON");return new i(t.pos,t.attrs)}constructor(e,t){super(),this.pos=void 0,this.attrs=void 0,this.pos=e,this.attrs=t}}a("cO9ey").Step.jsonID("setAttrs",i),e.exports.SetAttrsStep=i}),r("7U0RE",function(e,t){e.exports.snapTo=(e,t)=>0===t.length?e:t.reduce((t,i)=>Math.abs(i-e)<Math.abs(t-e)?i:t),e.exports.handleSides=["left","right"],e.exports.imageAlignmentMap={left:"start",right:"end"}}),r("5dl3F",function(e,i){var o=a("42omo"),n=a("2daQU"),r=a("9MZd8"),l=a("1oCLl");let s=(e,t,i)=>{let o="embed"===e?a("d925B").ACTION_SUBJECT.EMBEDS:a("d925B").ACTION_SUBJECT.MEDIA_SINGLE;return{action:a("d925B").ACTION.EDITED,actionSubject:o,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.RESIZED,attributes:{size:t,layout:i},eventType:a("d925B").EVENT_TYPE.UI}},d=(e,t)=>t.length?Math.min(Math.max(e,t[0]),t[t.length-1]):e;class c extends t(o).Component{render(){let e,i={},s={},d={},{innerPadding:c=0,width:p,pctWidth:u,selected:h,layout:m,enable:f,children:g,ratio:b,handleComponentFunc:E,handleStyles:T}=this.props,{isResizing:C}=this.state;a("7U0RE").handleSides.forEach(e=>{s[e]=`richMedia-resize-handle-${e}`,i[e]={width:"24px",[e]:`${-13-c}px`,zIndex:a("aFUXX").akRichMediaResizeZIndex,pointerEvents:"auto"};let t=E&&E(e);t&&(d[e]=t)});let _={left:{...i.left,...T?.left},right:{...i.right,...T?.right}},S=t(n)(a("gnMzP").richMediaClassName,`image-${m}`,this.props.className,{"is-resizing":C,"not-resized":!u,"richMedia-selected":h,"rich-media-wrapped":"wrap-left"===m||"wrap-right"===m});b&&(e={position:"absolute",width:"100%",paddingBottom:`${b}%`,top:0,pointerEvents:"none"});let w=(0,l.expValEquals)("platform_editor_smart_card_otp","isEnabled",!0)?p||"100%":p;return t(o).createElement(r.Resizable,{ref:this.resizable,size:{width:w,height:"auto"},className:S,handleClasses:s,handleStyles:_,handleWrapperStyle:e,handleComponent:d,enable:f,onResize:this.handleResize,onResizeStop:this.handleResizeStop,onResizeStart:this.handleResizeStart},g)}constructor(...e){super(...e),this.resizable=t(o).createRef(),this.state={isResizing:!1},this.handleResizeStart=e=>{let{innerPadding:t=0,highlights:i,displayGrid:o,layout:n,width:r,snapPoints:l}=this.props;e.preventDefault(),this.setState({isResizing:!0},()=>{let e=i(r+t,l);o?.(e.length>0,(0,a("eYlm5").gridTypeForLayout)(n),e)})},this.handleResize=(e,t,i,o)=>{let{highlights:n,calcNewSize:r,scaleFactor:l,snapPoints:s,displayGrid:c,layout:p,updateSize:u,innerPadding:h=0}=this.props,m=this.resizable.current,{isResizing:f}=this.state;if(!m||!m.state.original||!f)return;let g=d(m.state.original.width+o.width*(l||1),s),b=r(g+h,!1);b.layout!==p&&u(b.width,b.layout);let E=n(g,s);c?.(E.length>0,(0,a("eYlm5").gridTypeForLayout)(b.layout),E),m.updateSize({width:g,height:"auto"}),m.setState({isResizing:!0})},this.handleResizeStop=(e,t,i,o)=>{let{highlights:n,calcNewSize:r,snapPoints:l,displayGrid:c,layout:p,updateSize:u,dispatchAnalyticsEvent:h,nodeType:m}=this.props,f=this.resizable.current,{isResizing:g}=this.state;if(!f||!f.state.original||!g)return;let b=d(f.state.original.width+o.width,l),E=r((0,a("7U0RE").snapTo)(b,l),!0),T=n(b,l);h&&h(s(m,E.width,E.layout)),c?.(T.length>0,(0,a("eYlm5").gridTypeForLayout)(E.layout),T),this.setState({isResizing:!1},()=>{u(E.width,E.layout),c?.(!1,(0,a("eYlm5").gridTypeForLayout)(p),[])})}}}e.exports.default=c}),r("hdx2V",function(e,t){function i(e,t,i,o){var n=null==o||"number"==typeof o||"boolean"==typeof o?o:i(o),a=t.get(n);return void 0===a&&(a=e.call(this,o),t.set(n,a)),a}function o(e,t,i){var o=Array.prototype.slice.call(arguments,3),n=i(o),a=t.get(n);return void 0===a&&(a=e.apply(this,o),t.set(n,a)),a}function n(){return JSON.stringify(arguments)}function a(){this.cache=Object.create(null)}a.prototype.has=function(e){return e in this.cache},a.prototype.get=function(e){return this.cache[e]},a.prototype.set=function(e,t){this.cache[e]=t};var r={create:function(){return new a}};e.exports=function(e,t){var a=t&&t.cache?t.cache:r,l=t&&t.serializer?t.serializer:n;return(t&&t.strategy?t.strategy:function(e,t){var n,a,r=1===e.length?i:o;return n=t.cache.create(),a=t.serializer,r.bind(this,e,n,a)})(e,{cache:a,serializer:l})},e.exports.strategies={variadic:function(e,t){var i,n;return i=t.cache.create(),n=t.serializer,o.bind(this,e,i,n)},monadic:function(e,t){var o,n;return o=t.cache.create(),n=t.serializer,i.bind(this,e,o,n)}}}),r("cCTpf",function(e,t){let i="atlaskit-table-sorting-ordering";class o extends a("cO9ey").Step{invert(){return new o(this.pos,this.next,this.prev)}apply(e){return a("aXG5V").StepResult.ok(e)}map(){return null}getMap(){return new(0,a("aXG5V").StepMap)([0,0,0])}toJSON(){return{stepType:i}}static fromJSON(){return new(0,a("aXG5V").ReplaceStep)(0,0,a("5SAOw").Slice.empty)}constructor(e,t,i){super(),this.prev=void 0,this.next=void 0,this.pos=void 0,this.prev=t,this.next=i,this.pos=e}}a("cO9ey").Step.jsonID(i,o),e.exports.TableSortStep=o}),r("fYKTL",function(e,i){var o=a("l998X");a("42omo");var n=a("2daQU"),r=a("1oCLl");let l=new(0,a("ks2lK").PluginKey)("gridPlugin"),s=e=>t=>{let{dispatch:i,state:o}=e;return i(o.tr.setMeta(l,t)),!0},d=["left","right"],c=(e,t,i,o)=>{if(!e.length)return!1;let n=e.filter(e=>"number"==typeof e),a=Math.min(...n),r=Math.max(...n);return"left"===t?a<0&&a<=-i&&("number"!=typeof o||a>=-(i+o)):r>12&&r>=12+i&&("number"!=typeof o||r<=12+o)},p=(e,i,r,l)=>{let s=[];if(!l)return s;let p=(e*a("aFUXX").breakoutWideScaleRatio-e)/2;return d.forEach(l=>{s.push((0,o.jsx)("div",{className:t(n)("gridLine",c(r,l,0,4)?"highlight":""),style:{position:"absolute",[l]:`-${p}px`}},l)),s.push((0,o.jsx)("div",{className:t(n)("gridLine",r.indexOf("full-width")>-1?"highlight":""),style:{position:"absolute",[l]:`-${(i-e-a("aFUXX").akEditorBreakoutPadding)/2}px`}},l+"-bk"))}),s},u=e=>{let i=[];for(let a=0;a<=12;a++){let r={paddingLeft:"8.333333333333334%"};i.push((0,o.jsx)("div",{className:t(n)("gridLine",e.indexOf(a)>-1?"highlight":""),style:a<12?r:void 0},a))}return i},h=(0,a("6dGgK").b)(({highlight:e,shouldCalcBreakoutGridLines:i,theme:a,containerElement:r,editorWidth:l,gridType:s,visible:d})=>{let c=a.layoutMaxWidth,h=[...u(e),...p(c,l,e,i)];return(0,o.jsx)("div",{className:"gridParent",children:(0,o.jsx)("div",{className:t(n)("gridContainer",s),style:{height:`${r.scrollHeight}px`,display:d?"block":"none"},"data-testid":"gridContainer",children:h})})}),m=e=>({width:e.widthState?.width,visible:e.gridState?.visible,gridType:e.gridState?.gridType,highlight:e.gridState?.highlight}),f=({api:e,editorView:t,options:i})=>{let{width:n,visible:r,gridType:l,highlight:s}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e,["width","grid"],m);return void 0!==r&&s?(0,o.jsx)(h,{shouldCalcBreakoutGridLines:i&&i.shouldCalcBreakoutGridLines,editorWidth:n??a("aFUXX").akEditorFullPageMaxWidth,containerElement:t.dom,visible:r,gridType:l??"full",highlight:s}):null},g={visible:!1,highlight:[]},b=new(0,a("1S4f7").SafePlugin)({key:l,state:{init:()=>g,apply(e,t){let i=e.getMeta(l);return i||t}}});e.exports.gridPlugin=({config:e,api:t})=>({name:"grid",getSharedState:e=>e&&l.getState(e)||null,actions:{displayGrid:s},pmPlugins:()=>[{name:"grid",plugin:()=>b}],contentComponent:({editorView:i})=>!i||(0,r.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&(0,a("eTj7Y").isSSR)()?null:(0,o.jsx)(f,{editorView:i,options:e,api:t})})}),r("4HPW1",function(e,t){var i=a("iu6m9");let o=e=>"number"==typeof e&&!isNaN(e)&&isFinite(e),n=(e,t=a("aFUXX").akEditorDefaultLayoutWidth)=>{if(e.type!==e.type.schema.nodes.mediaSingle)return null;let i=e.firstChild,{width:o,height:n}=i?.attrs||{};if(!o||!n)return null;let r=parseFloat((n/o).toFixed(2));if(!e.attrs.width)return{width:o,height:n,originalWidth:o,originalHeight:n,ratio:r};let l=(0,a("kfJSC").getMediaSinglePixelWidth)(e.attrs.width,t,e.attrs.widthType);return{width:(0,a("kfJSC").roundToNearest)(l),height:(0,a("kfJSC").roundToNearest)(l*r),originalWidth:o,originalHeight:n,ratio:r}};e.exports.isVerticalPosition=e=>o(e.x),e.exports.getGuidelineTypeFromKey=(e,t)=>0===t.length?"none":e.some(e=>["grid_","wide_","full_width"].some(t=>e.indexOf(t)>=0))?"default":e.some(e=>["media_"].some(t=>e.indexOf(t)>=0))?"temporary":e.some(e=>["relative_"].some(t=>e.indexOf(t)>=0))?"relative":"none",e.exports.getContainerWidthOrFullEditorWidth=e=>{let t=e<=a("aFUXX").akEditorFullPageNarrowBreakout&&(0,i.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?a("aFUXX").akEditorGutterPaddingReduced:(0,a("aFUXX").akEditorGutterPaddingDynamic)();return Math.min(e-2*t,a("aFUXX").akEditorFullWidthLayoutWidth)/2},e.exports.getMediaSingleDimensions=n}),r("6MTPr",function(e,t){let i=e=>({...e,active:!0,show:!0});e.exports.getGuidelinesWithHighlights=(e,t,o,n)=>o.length?n.map(n=>o.includes(n.key)&&e<t?i(n):n):n}),r("8b5jG",function(i,o){e(i.exports,"default",()=>u);var n=a("42omo"),r=a("2daQU"),l=a("9MZd8"),s=a("iu6m9");let d=(0,a("ecnYn").xcss)({position:"absolute",bottom:"var(--ds-space-0, 0)",width:"100%",overflow:"visible",display:"flex",justifyContent:"center",alignItems:"center",height:"var(--ds-space-0, 0px)",zIndex:"layer"}),c=["left","right"],p={position:"inherit",height:"inherit",width:"inherit",display:"inherit",flexDirection:"inherit",justifyContent:"inherit",alignItems:"inherit"};var u=(0,n.forwardRef)((e,i)=>{let[o,u]=(0,n.useState)(!1),h=(0,n.useRef)(null),m=(0,n.useRef)(null);(0,n.useImperativeHandle)(i,()=>({getResizerThumbEl:()=>m.current}),[m]);let{width:f,children:g,handleClassName:b,className:E,handleResize:T,handleResizeStart:C,handleResizeStop:_,handleSize:S="medium",handleAlignmentMethod:w="center",handlePositioning:v="overlap",appearance:O,handleStyles:y,resizeRatio:N=1,snap:R,snapGap:x,isHandleVisible:A=!1,handleHighlight:I="none",handleTooltipContent:L,needExtendedResizeZone:k=!0,childrenDOMRef:M,labelComponent:D,...P}=e,B=(0,n.useCallback)(e=>{e.preventDefault(),u(!0),C()},[C]),W=(0,n.useCallback)((e,t,i,o)=>{if(!T)return;let n=h.current;n&&n.state.original&&T({x:n.state.original.x,y:n.state.original.y,width:n.state.original.width,height:n.state.original.height},o)},[T]),U=(0,n.useCallback)((e,t,i,o)=>{let n=h.current;if(!n||!n.state.original)return;let a={x:n.state.original.x,y:n.state.original.y,width:n.state.original.width,height:n.state.original.height};u(!1),_(a,o)},[_]),H={left:t(r)(b??a("7QdQz").resizerHandleClassName,"left",S,w),right:t(r)(b??a("7QdQz").resizerHandleClassName,"right",S,w)},F={width:"adjacent"===v?"var(--ds-space-100, 8px)":"var(--ds-space-300, 24px)",zIndex:a("7QdQz").resizerHandleZIndex,pointerEvents:"auto",alignItems:"adjacent"===v?"center":void 0},z="adjacent"===v?`calc(${F.width} * -1)`:`calc(${F.width} * -0.5)`,V=c.reduce((e,t)=>({...e,[t]:{...F,[t]:z,...y?.[t]}}),{}),G=t(r)(E,a("7QdQz").resizerItemClassName,{"is-resizing":o,"display-handle":A,[a("7QdQz").resizerDangerClassName]:"danger"===O}),j=t(r)(a("7QdQz").resizerHoverZoneClassName,{[a("7QdQz").resizerExtendedZone]:k}),{formatMessage:K}=(0,a("8C5kA").default)(),$=(0,n.useMemo)(()=>c.reduce((e,i)=>{let o=t(n).createElement("button",{className:a("7QdQz").resizerHandleThumbClassName,"data-testid":`resizer-handle-${i}-thumb`,"aria-label":K(a("5duTD").messages.resizeHandle),contentEditable:!1,ref:m,type:"button",tabIndex:-1});if((!I||"none"===I)&&!L)return{...e,[i]:o};let l=t(n).createElement(t(n).Fragment,null,o,t(n).createElement("div",{className:t(r)(a("7QdQz").resizerHandleTrackClassName,I),"data-testid":`resizer-handle-${i}-track`}));return L?{...e,[i]:t(n).createElement("div",{contentEditable:!1,style:p},t(n).createElement(a("3gadb").default,{content:L,hideTooltipOnClick:!0,position:"mouse",mousePosition:"auto-start",testId:`resizer-handle-${i}-tooltip`},l))}:{...e,[i]:t(n).createElement("div",{contentEditable:!1,style:p},l)}},{}),[I,L,K]),X=(0,n.useMemo)(()=>{if(R&&(R.x?.length!==0||R.y?.length!==0))return x},[R,x]);return t(n).createElement(l.Resizable,{ref:h,size:{width:f??"auto",height:"auto"},className:G,handleClasses:H,handleWrapperClass:a("7QdQz").handleWrapperClass,handleStyles:V,onResizeStart:B,onResize:W,onResizeStop:U,resizeRatio:N,snapGap:X,snap:R,handleComponent:$,...P},t(n).createElement("span",{className:j,ref:e=>M&&M(e)},g),D&&(0,s.editorExperiment)("single_column_layouts",!0)&&t(n).createElement(a("6f0Oj").default,{xcss:d},D))})}),r("7QdQz",function(e,t){let i="resizer-item",o="resizer-hover-zone",n="resizer-is-extended",r="resizer-handle",l=`${r}-track`,s=`${r}-thumb`,d=`${r}-danger`,c="resizer-handle-wrapper",p=(0,a("9K4OG").css)(".",i,"{will-change:width;&:hover,&.display-handle{&>.",c,">.",r,"{visibility:visible;opacity:1;}}&.is-resizing{& .",s,"{background:var(--ds-border-focused, #4688EC);}}&.",d,"{& .",s,"{transition:none;background:",`var(--ds-icon-danger, ${a("aFUXX").akEditorDeleteIconColor})`,";}}}.",r,"{display:flex;visibility:hidden;opacity:0;flex-direction:column;justify-content:center;align-items:center;width:7px;transition:visibility 0.2s,opacity 0.2s;& div[role='presentation']{width:100%;height:100%;display:flex;flex-direction:column;justify-content:center;align-items:center;margin-top:var(--ds-space-negative-200, -16px);white-space:normal;}&.left{align-items:flex-start;}&.right{align-items:flex-end;}&.small{& .",s,"{height:43px;}}&.medium{& .",s,"{height:64px;}}&.large{& .",s,"{height:96px;}}&.clamped{& .",s,"{height:clamp(43px, calc(100% - 32px), 96px);}}&.sticky{& .",s,"{position:sticky;top:var(--ds-space-150, 12px);bottom:var(--ds-space-150, 12px);}}&:hover{& .",s,"{background:var(--ds-border-focused, #4688EC);}& .",l,"{visibility:visible;opacity:0.5;}}}.",s,"{content:' ';display:flex;width:3px;margin:0 var(--ds-space-025, 2px);height:64px;transition:background-color 0.2s;border-radius:6px;border:0;padding:0;z-index:2;outline:none;min-height:24px;background:var(--ds-border, #0B120E24);&:hover{cursor:col-resize;}&:focus{background:var(--ds-border-selected, #0C66E4);&::after{content:'';position:absolute;top:var(--ds-space-negative-050, -4px);right:var(--ds-space-negative-050, -4px);bottom:var(--ds-space-negative-050, -4px);left:var(--ds-space-negative-050, -4px);border:2px solid var(--ds-border-focused, #388BFF);border-radius:inherit;z-index:-1;}}}.",l,"{visibility:hidden;position:absolute;width:7px;height:calc(100% - 40px);border-radius:4px;opacity:0;transition:background-color 0.2s,visibility 0.2s,opacity 0.2s;&.none{background:none;}&.shadow{background:var(--ds-background-selected, #E9F2FE);}&.full-height{background:var(--ds-background-selected, #E9F2FE);height:100%;min-height:36px;}}.","ak-editor-selected-node","{& .",s,"{background:var(--ds-border-focused, #4688EC);}}.",o,"{position:relative;display:flow-root;width:100%;&.",n,"{padding:0 var(--ds-space-150, 12px);left:var(--ds-space-negative-150, -12px);}}table .",o,",table .",o,".",n,"{padding:unset;left:unset;}");e.exports.resizerItemClassName=i,e.exports.resizerHoverZoneClassName=o,e.exports.resizerExtendedZone=n,e.exports.resizerHandleClassName=r,e.exports.resizerHandleTrackClassName=l,e.exports.resizerHandleThumbClassName=s,e.exports.resizerDangerClassName=d,e.exports.handleWrapperClass=c,e.exports.resizerHandleThumbWidth=3,e.exports.resizerHandleZIndex=1,e.exports.resizerStyles=p}),r("2yr9J",function(e,t){let i=({node:e,tr:t,position:i})=>{let{$from:{pos:o},$to:{pos:n}}=i;if(e.isText)return t.replaceWith(o,n,e);if(e.isBlock){let i=(0,a("zT4ZO").normaliseNestedLayout)(t,e);if((0,a("zT4ZO").safeInsert)(i,o)(t))return t;let n=a("5SAOw").Slice.maxOpen(a("5SAOw").Fragment.from(i)),{from:r,to:l}=function(e,t,i){let o=e.resolve(t),n=(e,t)=>({from:e,to:t||e});for(let e=o.depth;e>=0;e--){let t=o.node(e),a=Math.max(e-1,0),r=o.node(a),l="paragraph"===t.type.name&&0===t.content.size,s=o.index(a),d=r.canReplaceWith(s,s,i.type);if(l&&d){let e=o.posAtIndex(s,a);return n(e,e+t.nodeSize)}let c=o.indexAfter(a);if(r.canReplaceWith(c,c,i.type))return n(o.posAtIndex(c,a))}return n(0)}(t.doc,o,i);t.replaceWith(r,l,e);let s=Math.min(r+(e.isAtom?e.nodeSize:n.openStart),t.doc.content.size),d=a("ks2lK").TextSelection.findFrom(t.doc.resolve(s),1,!0);if(d)return t.setSelection(d)}return t},o=({maybeFragment:e,tr:t,position:i,selectInlineNode:o})=>{let{$from:{pos:n},$to:{pos:r}}=i,l=e instanceof a("5SAOw").Node?a("5SAOw").Fragment.from(e):e;return(t.replaceWith(n,r,l),o)?t.setSelection(a("ks2lK").NodeSelection.create(t.doc,n)):t.setSelection(a("ks2lK").TextSelection.near(t.doc.resolve(n+(l?.size||0))))},n=({tr:e,node:t,position:n,selectNodeInserted:r})=>{t instanceof a("5SAOw").Node&&t.isBlock?i({node:t,tr:e,position:n}):o({maybeFragment:t,tr:e,position:n,selectInlineNode:r})},r=({node:e,options:t})=>i=>{let o=t.insertAt??i.selection;return!!(e instanceof a("5SAOw").Node||e instanceof a("5SAOw").Fragment)&&(n({tr:i,node:e,position:o,selectNodeInserted:t.selectNodeInserted}),i.scrollIntoView(),!0)},l=e=>({actions:{insert:({state:t,dispatch:i,node:o,options:n})=>{if(!t||!i)return!1;let{tr:a}=t;return r({node:o,options:n})(a),n.analyticsPayload&&e?.attachAnalyticsEvent(n.analyticsPayload)(a),i(a),!0}},commands:{insert:({node:t,options:i})=>({tr:o})=>(r({node:t,options:i})(o),i.analyticsPayload&&e?.attachAnalyticsEvent(i.analyticsPayload)(o),o)}});e.exports.contentInsertionPlugin=({api:e})=>{let{actions:t,commands:i}=l(e?.analytics?.actions);return{name:"contentInsertion",actions:t,commands:i}}}),r("7x0qS",function(e,i){var o=a("42omo");let n=(0,a("ecnYn").xcss)({height:"var(--ds-space-400, 32px)",display:"flex",backgroundColor:"elevation.surface.overlay",borderRadius:"radius.small",boxShadow:"elevation.shadow.overlay",boxSizing:"border-box",alignItems:"center"}),r=(0,a("ecnYn").xcss)({marginLeft:"space.100",marginRight:"space.100",paddingLeft:"space.075",paddingRight:"space.075",paddingTop:"space.050",paddingBottom:"space.050"});e.exports.ResizerBreakoutModeLabel=({layout:e})=>{let{formatMessage:i}=(0,a("8C5kA").default)(),l=t(o).useMemo(()=>{switch(e){case"max":return i(a("5duTD").messages.maxWidthLabel);case"full-width":return i(a("5duTD").messages.fullWidthLabel);case"wide":return i(a("5duTD").messages.wideWidthLabel);default:return null}},[e,i]);return l&&t(o).createElement(a("6f0Oj").default,{testId:"resizer-breakout-mode-label",xcss:n},t(o).createElement(a("dcJ7R").default,{xcss:r},l))}}),r("5DsxN",function(e,t){var i=a("l998X");a("42omo");var o=a("3pLGZ"),n=a("8m4tT");let r=(e,t,i,o,n)=>{if(!e.selection.empty)return null;let r=null,{rule:l}=e.schema.nodes;return r=e.tr.replaceWith(t,i,a("5SAOw").Fragment.empty),(r=(0,a("zT4ZO").safeInsert)(l.createChecked(),r.selection.from)(r))||(r=e.tr.replaceRange(t,i,new(0,a("5SAOw").Slice)(a("5SAOw").Fragment.from(e.schema.nodes.rule.createChecked()),0,0))),n?.attachAnalyticsEvent({action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.DIVIDER,attributes:{inputMethod:o},eventType:a("d925B").EVENT_TYPE.TRACK})(r),r},l=(e,t,i,o)=>{let{listItem:l}=e.schema.nodes;return(0,n.hasParentNodeOfType)(l)(e.selection)?null:r(e,t,i,a("d925B").INPUT_METHOD.FORMATTING,o)};var s=function(e,t){let i=[];if(e.nodes.rule&&(i.push((0,a("l03WE").createRule)(/^(\-\-\-|\*\*\*)$/,(e,i,o,n)=>l(e,o,n,t))),i.push((0,a("l03WE").createRule)(RegExp(`${a("14sLv").leafNodeReplacementCharacter}(\\-\\-\\-|\\*\\*\\*)`),(e,i,o,n)=>{let{hardBreak:a}=e.schema.nodes;return e.doc.resolve(o).nodeAfter.type!==a?null:l(e,o,n,t)}))),0!==i.length)return new(0,a("1S4f7").SafePlugin)((0,a("aIMBk").createPlugin)("rule",i,{isBlockNodeRule:!0}))};let d=e=>t=>(i,o)=>{let n=r(i,i.selection.from,i.selection.to,t,e);return!!n&&(o&&o(n),!0)};var c=function(e){let t={};return(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").insertRule.common,d(e)(a("d925B").INPUT_METHOD.SHORTCUT),t),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").escape.common,()=>!0,t),(0,a("dus6D").keymap)(t)};e.exports.rulePlugin=({api:e})=>({name:"rule",nodes:()=>[{name:"rule",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("bLhD4").ruleWithLocalId:a("bLhD4").rule}],actions:{insertHorizontalRule:d(e?.analytics?.actions)},pmPlugins:()=>[{name:"ruleInputRule",plugin:({schema:t})=>s(t,e?.analytics?.actions)},{name:"ruleKeymap",plugin:()=>c(e?.analytics?.actions)}],pluginsOptions:{quickInsert:({formatMessage:t})=>[{id:"rule",title:t(a("4HWgE").toolbarInsertBlockMessages.horizontalRule),description:t(a("4HWgE").toolbarInsertBlockMessages.horizontalRuleDescription),keywords:["horizontal","rule","line","hr"],priority:1200,keyshortcut:"---",icon:()=>(0,i.jsx)(o.IconDivider,{}),action(t,i){let o=t(i.schema.nodes.rule.createChecked());return e?.analytics?.actions.attachAnalyticsEvent({action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.DIVIDER,attributes:{inputMethod:a("d925B").INPUT_METHOD.QUICK_INSERT},eventType:a("d925B").EVENT_TYPE.TRACK})(o),o}}]}})}),r("eeGWn",function(e,i){var o,n,r,l,s,d=a("l998X"),c=a("42omo"),p=a("cQMhV"),u=a("8m4tT");function h(e){if(!(e.selection instanceof a("7XFGZ").CellSelection))return null;let t=[];return e.selection.forEachCell((e,i)=>{t.push(a("ftzrq").Decoration.node(i,i+e.nodeSize,{class:"selectedCell"}))}),a("ftzrq").DecorationSet.create(e.doc,t)}let m=new(0,a("ks2lK").PluginKey)("selectingCells"),f=new(0,a("ks2lK").PluginKey)("fix-tables");var g=a("iu6m9");let b=(0,a("dus6D").keydownHandler)({ArrowLeft:T("horiz",-1),ArrowRight:T("horiz",1),ArrowUp:T("vert",-1),ArrowDown:T("vert",1),"Shift-ArrowLeft":C("horiz",-1),"Shift-ArrowRight":C("horiz",1),"Shift-ArrowUp":C("vert",-1),"Shift-ArrowDown":C("vert",1),Backspace:_,"Mod-Backspace":_,Delete:_,"Mod-Delete":_});function E(e,t,i){return!i.eq(e.selection)&&(t&&t(e.tr.setSelection(i).scrollIntoView()),!0)}function T(e,t){return(i,o,n)=>{if(o){let r,l=i.selection;if(l instanceof a("7XFGZ").CellSelection)return E(i,o,a("ks2lK").Selection.near(l.$headCell,t));if("horiz"!==e&&!l.empty)return!1;let s=n?w(n,e,t):null;if(null===s)return!1;if("horiz"===e)return E(i,o,a("ks2lK").Selection.near(i.doc.resolve(l.head+t),t));let d=i.doc.resolve(s),c=(0,a("3gZJH").nextCell)(d,e,t);return r=c?a("ks2lK").Selection.near(c,1):t<0?a("ks2lK").Selection.near(i.doc.resolve(d.before(-1)),-1):a("ks2lK").Selection.near(i.doc.resolve(d.after(-1)),1),E(i,o,r)}return!0}}function C(e,t){return(i,o,n)=>{let r=i.selection;if(!(r instanceof a("7XFGZ").CellSelection)){let o=n?w(n,e,t):null;if(null===o)return!1;let{selection:{$head:l,$anchor:s}}=i,d=l.blockRange(s);if(!["tableCell","tableHeader"].includes(d?.parent?.type.name||""))return!1;r=new(0,a("7XFGZ").CellSelection)(i.doc.resolve(o))}let l=(0,a("3gZJH").nextCell)(r.$headCell,e,t);return!!l&&(!o||E(i,o,new(0,a("7XFGZ").CellSelection)(r.$anchorCell,l)))}}function _(e,t){let i=e.selection;if(!(i instanceof a("7XFGZ").CellSelection))return!1;if(t){let{tr:o}=e,n=(0,a("d1kIV").tableNodeTypes)(e.schema).cell.createAndFill().content;i.forEachCell((e,t)=>{e.content.eq(n)||o.replace(o.mapping.map(t+1),o.mapping.map(t+e.nodeSize-1),new(0,a("5SAOw").Slice)(n,0,0))}),o.docChanged&&t(o)}return!0}function S(e,t){let{doc:i}=e.state,o=(0,a("3gZJH").cellAround)(i.resolve(t));return!!o&&(e.dispatch(e.state.tr.setSelection(new(0,a("7XFGZ").CellSelection)(o))),!0)}function w(e,t,i){if(!(e.state.selection instanceof a("ks2lK").TextSelection))return null;let{$head:o}=e.state.selection;for(let n=o.depth-1;n>=0;n--){let a=o.node(n);if((i<0?o.index(n):o.indexAfter(n))!==(i<0?0:a.childCount))break;if("cell"===a.type.spec.tableRole||"header_cell"===a.type.spec.tableRole){let a=o.before(n),r="vert"===t?i>0?"down":"up":i>0?"right":"left";return e.endOfTextblock(r)?a:null}}return null}function v(e,t){let i=t;for(;i&&i!==e.dom;i=i.parentNode)if("TD"===i.nodeName||"TH"===i.nodeName)return i;return null}function O(e,t){let i=e.posAtCoords({left:t.clientX,top:t.clientY});return i?(0,a("3gZJH").cellAround)(e.state.doc.resolve(i.pos)):null}function y(e,t){let i=e.posAtCoords({left:t.clientX,top:t.clientY});if(!i)return!1;let o=e.state.doc.resolve(i.pos),n=(0,a("id9O1").findTableClosestToPos)(o);if(!n)return!1;let r=e.state.doc.resolve(n.pos).parent,l=e.state.schema.nodes;return[l.tableHeader,l.tableCell].includes(r.type)}var N=a("1oCLl"),R=a("kB2tR");function x(e,t=0,i){let{isFullWidthModeEnabled:o}=i;if(o){let e=(0,a("aFUXX").akEditorGutterPaddingDynamic)();return t<=a("aFUXX").akEditorFullPageNarrowBreakout&&(0,g.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})&&(e=a("aFUXX").akEditorGutterPaddingReduced),t?Math.min(t-2*e,a("aFUXX").akEditorFullWidthLayoutWidth):a("aFUXX").akEditorFullWidthLayoutWidth}let n=(0,a("1zav4").calcTableWidth)(e,t,!0);return"inherit"!==n?n:a("6fQl1").layoutToWidth[e]||t}function A(e){return"row"===e.parent.type.spec.tableRole&&e.nodeAfter}function I(e,t,{colspan:i,colwidth:o}){let n=o&&o[o.length-1];if(n)return n;let a=e.domAtPos(t+1).node.offsetWidth,r=i||0;if(o)for(let e=0;e<(i||0);e++)o[e]&&(a-=o[e],r--);return a/r}let L=({table:e,tableStart:t,state:i,layout:o,getEditorContainerWidth:n})=>{let r=n(),l=(0,a("6fQl1").getParentNodeWidth)(t,i,r)||e.attrs.width||x(o,r.width,{});return e.attrs.isNumberColumnEnabled&&(l-=a("aFUXX").akEditorTableNumberColumnWidth),l},k=e=>$(e)?(0,a("caYZ2").calcTableColumnWidths)(e).reduce((e,t)=>e+t,0):M(e),M=e=>(0,a("6fQl1").getTableContainerWidth)(e),D=(e,t,i)=>{let o=i?`min(calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2)), ${(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800}px)`:`min(calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2) - var(--ak-editor--resizer-handle-spacing)), ${(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800}px)`;return e||t?"100%":o},P=(e,t,i)=>{let o=(0,a("6fQl1").getTableContainerWidth)(e);if(e.attrs.width||!t&&!i)return o},B=(e,t,i)=>{let o=P(e,t,i);return o?`${o}px`:"auto"},W=(e,t)=>{let i=M(e);return t?`min(calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2)), ${i}px)`:`min(calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2) - var(--ak-editor--resizer-handle-spacing)), ${i}px)`},U=(e,t,i)=>{let o=M(e),n=((t?.parentElement?.clientWidth||o)-1)/o;return Math.min(n=Math.max(n,1-(i?.4:.3)),1)},H=(e,t)=>{if(X(e)){let i=(0,a("caYZ2").calcTableColumnWidths)(e).reduce((e,t)=>e+t,0);return((t?.parentElement?.clientWidth||i)-1)/i}return 1},F=(e,t,i)=>{let o=(t-1)/M(e);return Math.min(o=Math.max(o,1-(i?.4:.3)),1)},z=(e,t)=>e-1/t,V=(e,t,i,o,n,r,l,s,d)=>{let c=!o&&!i;if(n||o)return d?`width: max(${e}px, ${a("1zav4").tableCellMinWidth}px)`:`width: ${a("1zav4").tableCellMinWidth}px)`;if(c||!c&&s){let i=l?`calc(calc(var(--ak-editor-table-width) - ${a("aFUXX").akEditorTableNumberColumnWidth}px - 1px)/${t})`:`calc(calc(var(--ak-editor-table-width) - 1px)/${t})`;return`width: max(calc(${e}px * ${1-(r?.4:.3)}), calc(${e} * ${i}), ${a("1zav4").tableCellMinWidth}px)`}if(d){let i=l?`calc(calc(var(--ak-editor-table-width) - ${a("aFUXX").akEditorTableNumberColumnWidth}px - 1px)/${t})`:`calc(calc(var(--ak-editor-table-width) - 1px)/${t})`;return`width: max(calc(${e} * ${i}), ${a("1zav4").tableCellMinWidth}px)`}return`width: ${a("1zav4").tableCellMinWidth}px`},G=(e,t,i,o,n,r)=>{let l=[],s=a("LmqWp").TableMap.get(e),d=!!e.attrs.width,c=e.attrs.isNumberColumnEnabled||!1,p=!i&&!t;return e.content.firstChild.content.forEach(u=>{let h=u.attrs.colspan||1;Array.isArray(u.attrs.colwidth)?u.attrs.colwidth.slice(0,h).forEach(u=>{let h=z(u,s.width),m=p||!p&&d?M(e):(0,a("caYZ2").calcTableColumnWidths)(e).reduce((e,t)=>e+t,0);n?l.push(["col",{style:V(h,m,t,i,o,r,c,d,!0)}]):l.push(["col",{style:`width: max(${h}px, ${a("1zav4").tableCellMinWidth}px)`}])}):n?l.push(...Array.from({length:h},n=>{let a=M(e);return["col",{style:V(z(a/s.width||0,s.width||0),a,t,i,o,r,c,d)}]})):l.push(...Array.from({length:h},e=>["col",{style:`width: ${a("1zav4").tableCellMinWidth}px;`}]))}),l},j=(e,t,i,o)=>{let n=[],r=a("LmqWp").TableMap.get(e);return e.content.firstChild.content.forEach(l=>{let s=l.attrs.colspan||1;if(Array.isArray(l.attrs.colwidth))if(t){let d=1;d=o&&!e.attrs?.width?H(e,t):U(e,t,i),l.attrs.colwidth.slice(0,s).forEach(e=>{let t=Math.max(z(e,r.width)*d,a("1zav4").tableCellMinWidth);n.push(["col",{style:`width: ${t}px;`}])})}else l.attrs.colwidth.slice(0,s).forEach(e=>{n.push(["col",{style:`width: ${z(e?Math.max(e,a("1zav4").tableCellMinWidth):a("1zav4").tableCellMinWidth,r.width)}px;`}])});else n.push(...Array.from({length:s},e=>["col",{style:`width: ${a("1zav4").tableCellMinWidth}px;`}]))}),n},K=(e,t,i=!1,o=!0,n=!1,r=!1)=>{var l,s,d,c;let p=e?.querySelector("colgroup");return p&&o&&e?.removeChild(p),l=t,s=i?e??void 0:void 0,d=n,c=r,p=a("5SAOw").DOMSerializer.renderSpec(document,["colgroup",{},...j(l,s,d,c)]).dom,o&&e?.insertBefore(p,e?.firstChild),p.children},$=e=>!!(0,a("3Ter7").getFragmentBackingArray)(e.content.firstChild.content).find(e=>e.attrs.colwidth),X=$,Z=e=>(0,a("3Ter7").getFragmentBackingArray)(e.content.firstChild.content).every(e=>e.attrs.colwidth&&e.attrs.colwidth[0]===a("1zav4").tableCellMinWidth||null===e.attrs.colwidth),q=e=>a("LmqWp").TableMap.get(e).width,Y=e=>48*Math.min(3,q(e))+1,Q="align-start",J="center",ee=e=>e===J||e===Q?e:J,et=(e,t,i,o)=>!!(e&&t&&t.attrs.layout===Q&&i&&o>i&&i<1800),ei={display:"flex",justifyContent:"center"},eo={display:"flex",justifyContent:"flex-start"},en=e=>e===Q?eo:ei,ea=e=>({...e.isNestingSupported?a("63Ztt").tableWithNestedTable:a("63Ztt").table,toDOM:i=>{let o=Object.entries(en(i.attrs.layout)).map(([e,i])=>`${t(R)(e)}: ${t(R)(i)}`).join(";"),n=Y(i),r=!e.isChromelessEditor&&!e.isCommentEditor,l={"data-number-column":i.attrs.isNumberColumnEnabled,"data-layout":i.attrs.layout,"data-autosize":i.attrs.__autoSize,"data-table-local-id":i.attrs.localId,"data-table-width":i.attrs.width,"data-ssr-placeholder":`table-${i.attrs.localId}`,"data-ssr-placeholder-replace":`table-${i.attrs.localId}`},s=r?W(i,e.isTableScalingEnabled):"calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2))",d="";e.allowColumnResizing&&(d=["colgroup",{},...G(i,e.isCommentEditor,e.isChromelessEditor,e.isNested,e.isTableScalingEnabled,e.shouldUseIncreasedScalingPercent)]);let c=["div",{class:"pm-table-container","data-number-column":i.attrs.isNumberColumnEnabled,"data-layout":i.attrs.layout,"data-testid":"table-container"},["div",{class:"pm-table-sticky-sentinel-top","data-testid":"sticky-sentinel-top"}],["div",{class:"pm-table-row-controls-wrapper"},["div"]],["div",{class:"pm-table-wrapper"},["table",l,d,["tbody",0]]],["div",{class:"pm-table-sticky-sentinel-bottom","data-testid":"sticky-sentinel-bottom"}]];return!e.tableResizingEnabled||e.isNested?["div",{class:"tableView-content-wrap","data-prosemirror-initial-toDOM-render":"true",style:(0,a("24P9d").convertToInlineCss)({"--ak-editor-table-width":s})},c]:["div",{class:"tableView-content-wrap","data-prosemirror-initial-toDOM-render":"true"},["div",{"data-testid":"table-alignment-container",style:o},["div",{class:"pm-table-resizer-container",style:(0,a("24P9d").convertToInlineCss)({"--ak-editor-table-gutter-padding":e.isTableScalingEnabled?"calc(var(--ak-editor--large-gutter-padding) * 2)":"calc(var(--ak-editor--large-gutter-padding) * 2 - var(--ak-editor-resizer-handle-spacing))","--ak-editor-table-width":s,width:"var(--ak-editor-table-width)"})},["div",{class:"resizer-item display-handle",style:(0,a("24P9d").convertToInlineCss)({position:"relative",userSelect:"auto",boxSizing:"border-box","--ak-editor-table-max-width":`${(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800}px`,"--ak-editor-table-min-width":`${n}px`,minWidth:"var(--ak-editor-table-min-width)",maxWidth:D(e.isCommentEditor,e.isChromelessEditor,e.isTableScalingEnabled),width:B(i,e.isCommentEditor,e.isChromelessEditor)})},["span",{class:"resizer-hover-zone"},c]]]]]}});var er=a("a4TK8");let el=e=>t=>{let i=(0,a("id9O1").findTable)(t);if(!i)return;let o=a("LmqWp").TableMap.get(i.node);return(Array.isArray(e)?e:[e]).filter(e=>e>=0&&e<=o.width-1).reduce((e,t)=>{let n=o.cellsInRect({left:t,right:t+1,top:0,bottom:o.height});return e.concat(n.map(e=>{let t=i.node.nodeAt(e),o=e+i.start;return{pos:o,start:o+1,node:t,depth:i.depth+2}}))},[])},es=e=>t=>{let i=(0,a("id9O1").findTable)(t);if(!i)return;let o=a("LmqWp").TableMap.get(i.node);return(Array.isArray(e)?e:[e]).filter(e=>e>=0&&e<=o.height-1).reduce((e,t)=>{let n=o.cellsInRect({left:0,right:o.width,top:t,bottom:t+1});return e.concat(n.map(e=>{let t=i.node.nodeAt(e),o=e+i.start;return{pos:o,start:o+1,node:t,depth:i.depth+2}}))},[])},ed=e=>{let{$from:t}=e.selection;for(let i=t.depth;i>0;i--)if("table"===t.node(i).type.spec.tableRole)return(0,a("8usfh").cloneTr)(e.delete(t.before(i),t.after(i)));return e},ec=(e,t)=>i=>e?(i.setNodeMarkup(e.pos,void 0,Object.assign({},e.node.attrs,t)),(0,a("8usfh").cloneTr)(i)):i;var ep=((o={}).ALL_CONTROLS_HOVER="CONTROLS_HOVER",o.ROW_CONTROLS_HOVER="ROW_CONTROLS_HOVER",o.COLUMN_CONTROLS_HOVER="COLUMN_CONTROLS_HOVER",o.TABLE_CONTROLS_HOVER="TABLE_CONTROLS_HOVER",o.CELL_CONTROLS_HOVER="CELL_CONTROLS_HOVER",o.COLUMN_CONTROLS_DECORATIONS="COLUMN_CONTROLS_DECORATIONS",o.COLUMN_DROP_TARGET_DECORATIONS="COLUMN_DROP_TARGET_DECORATIONS",o.COLUMN_SELECTED="COLUMN_SELECTED",o.COLUMN_RESIZING_HANDLE="COLUMN_RESIZING_HANDLE",o.COLUMN_RESIZING_HANDLE_WIDGET="COLUMN_RESIZING_HANDLE_WIDGET",o.COLUMN_RESIZING_HANDLE_LINE="COLUMN_RESIZING_HANDLE_LINE",o.COLUMN_INSERT_LINE="COLUMN_INSERT_LINE",o.ROW_INSERT_LINE="ROW_INSERT_LINE",o.LAST_CELL_ELEMENT="LAST_CELL_ELEMENT",o);let eu={...a("1zav4").TableSharedCssClassName,COLUMN_CONTROLS:`${a("63Ztt").tablePrefixSelector}-column-controls`,COLUMN_CONTROLS_DECORATIONS:`${a("63Ztt").tablePrefixSelector}-column-controls-decoration`,COLUMN_SELECTED:`${a("63Ztt").tablePrefixSelector}-column__selected`,ROW_CONTROLS_WRAPPER:`${a("63Ztt").tablePrefixSelector}-row-controls-wrapper`,ROW_CONTROLS:`${a("63Ztt").tablePrefixSelector}-row-controls`,ROW_CONTROLS_INNER:`${a("63Ztt").tablePrefixSelector}-row-controls__inner`,ROW_CONTROLS_BUTTON_WRAP:`${a("63Ztt").tablePrefixSelector}-row-controls__button-wrap`,ROW_CONTROLS_BUTTON:`${a("63Ztt").tablePrefixSelector}-row-controls__button`,CONTROLS_BUTTON:`${a("63Ztt").tablePrefixSelector}-controls__button`,CONTROLS_BUTTON_ICON:`${a("63Ztt").tablePrefixSelector}-controls__button-icon`,CONTROLS_INSERT_BUTTON:`${a("63Ztt").tablePrefixSelector}-controls__insert-button`,CONTROLS_INSERT_BUTTON_INNER:`${a("63Ztt").tablePrefixSelector}-controls__insert-button-inner`,CONTROLS_INSERT_BUTTON_WRAP:`${a("63Ztt").tablePrefixSelector}-controls__insert-button-wrap`,CONTROLS_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-controls__insert-line`,CONTROLS_BUTTON_OVERLAY:`${a("63Ztt").tablePrefixSelector}-controls__button-overlay`,DRAG_CONTROLS_INSERT_BUTTON:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button`,DRAG_CONTROLS_INSERT_BUTTON_INNER:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button-inner`,DRAG_CONTROLS_INSERT_BUTTON_INNER_COLUMN:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button-inner-column`,DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button-inner-row`,DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW_CHROMELESS:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button-inner-row-chromeless`,DRAG_CONTROLS_INSERT_BUTTON_WRAP:`${a("63Ztt").tablePrefixSelector}-controls__drag-insert-button-wrap`,CONTROLS_INSERT_MARKER:`${a("63Ztt").tablePrefixSelector}-controls__insert-marker`,CONTROLS_INSERT_COLUMN:`${a("63Ztt").tablePrefixSelector}-controls__insert-column`,CONTROLS_INSERT_ROW:`${a("63Ztt").tablePrefixSelector}-controls__insert-row`,CONTROLS_DELETE_BUTTON_WRAP:`${a("63Ztt").tablePrefixSelector}-controls__delete-button-wrap`,CONTROLS_DELETE_BUTTON:`${a("63Ztt").tablePrefixSelector}-controls__delete-button`,CONTROLS_FLOATING_BUTTON_COLUMN:`${a("63Ztt").tablePrefixSelector}-controls-floating__button-column`,CONTROLS_FLOATING_BUTTON_ROW:`${a("63Ztt").tablePrefixSelector}-controls-floating__button-row`,CORNER_CONTROLS:`${a("63Ztt").tablePrefixSelector}-corner-controls`,CORNER_CONTROLS_INSERT_ROW_MARKER:`${a("63Ztt").tablePrefixSelector}-corner-controls__insert-row-marker`,CORNER_CONTROLS_INSERT_COLUMN_MARKER:`${a("63Ztt").tablePrefixSelector}-corner-controls__insert-column-marker`,CONTROLS_CORNER_BUTTON:`${a("63Ztt").tablePrefixSelector}-corner-button`,DRAG_ROW_CONTROLS_WRAPPER:`${a("63Ztt").tablePrefixSelector}-drag-row-controls-wrapper`,DRAG_ROW_CONTROLS:`${a("63Ztt").tablePrefixSelector}-drag-row-controls`,DRAG_ROW_FLOATING_INSERT_DOT_WRAPPER:`${a("63Ztt").tablePrefixSelector}-drag-row-floating-insert-dot-wrapper`,DRAG_ROW_FLOATING_INSERT_DOT:`${a("63Ztt").tablePrefixSelector}-drag-row-floating-insert-dot`,DRAG_ROW_FLOATING_DRAG_HANDLE:`${a("63Ztt").tablePrefixSelector}-drag-row-floating-drag-handle`,DRAG_COLUMN_CONTROLS:`${a("63Ztt").tablePrefixSelector}-drag-column-controls`,DRAG_COLUMN_FLOATING_INSERT_DOT_WRAPPER:`${a("63Ztt").tablePrefixSelector}-drag-columns-floating-insert-dot-wrapper`,DRAG_COLUMN_FLOATING_INSERT_DOT:`${a("63Ztt").tablePrefixSelector}-drag-columns-floating-insert-dot`,DRAG_COLUMN_CONTROLS_WRAPPER:`${a("63Ztt").tablePrefixSelector}-col-controls-wrapper`,DRAG_COLUMN_DROP_TARGET_CONTROLS:`${a("63Ztt").tablePrefixSelector}-col-drop-target-controls`,DRAG_COLUMN_CONTROLS_INNER:`${a("63Ztt").tablePrefixSelector}-col-controls__inner`,DRAG_HANDLE_BUTTON_CONTAINER:`${a("63Ztt").tablePrefixSelector}-drag-handle-button-container`,DRAG_HANDLE_BUTTON_CLICKABLE_ZONE:`${a("63Ztt").tablePrefixSelector}-drag-handle-button-clickable-zone`,DRAG_CORNER_BUTTON:`${a("63Ztt").tablePrefixSelector}-drag-corner-button`,DRAG_CORNER_BUTTON_INNER:`${a("63Ztt").tablePrefixSelector}-drag-corner-button-inner`,NESTED_TABLE_WITH_CONTROLS:`${a("63Ztt").tablePrefixSelector}-nested-table-with-controls`,DRAG_HANDLE_DISABLED:`${a("63Ztt").tablePrefixSelector}-drag-handle-disabled`,DRAG_HANDLE_MINIMISED:`${a("63Ztt").tablePrefixSelector}-drag-handle-minimised`,DRAG_SUBMENU:`${a("63Ztt").tablePrefixSelector}-drag-submenu`,DRAG_SUBMENU_ICON:`${a("63Ztt").tablePrefixSelector}-drag-submenu-icon`,NUMBERED_COLUMN:`${a("63Ztt").tablePrefixSelector}-numbered-column`,NUMBERED_COLUMN_BUTTON:`${a("63Ztt").tablePrefixSelector}-numbered-column__button`,NUMBERED_COLUMN_BUTTON_DISABLED:`${a("63Ztt").tablePrefixSelector}-numbered-column__button-disabled`,HOVERED_COLUMN:`${a("63Ztt").tablePrefixSelector}-hovered-column`,HOVERED_ROW:`${a("63Ztt").tablePrefixSelector}-hovered-row`,HOVERED_TABLE:`${a("63Ztt").tablePrefixSelector}-hovered-table`,HOVERED_NO_HIGHLIGHT:`${a("63Ztt").tablePrefixSelector}-hovered-no-highlight`,HOVERED_CELL:`${a("63Ztt").tablePrefixSelector}-hovered-cell`,HOVERED_CELL_IN_DANGER:"danger",HOVERED_CELL_ACTIVE:"active",HOVERED_CELL_WARNING:`${a("63Ztt").tablePrefixSelector}-hovered-cell__warning`,HOVERED_DELETE_BUTTON:`${a("63Ztt").tablePrefixSelector}-hovered-delete-button`,WITH_CONTROLS:`${a("63Ztt").tablePrefixSelector}-with-controls`,RESIZING_PLUGIN:`${a("63Ztt").tablePrefixSelector}-resizing-plugin`,RESIZE_CURSOR:`${a("63Ztt").tablePrefixSelector}-resize-cursor`,IS_RESIZING:`${a("63Ztt").tablePrefixSelector}-is-resizing`,RESIZE_HANDLE_DECORATION:`${a("63Ztt").tablePrefixSelector}-resize-decoration`,CONTEXTUAL_SUBMENU:`${a("63Ztt").tablePrefixSelector}-contextual-submenu`,CONTEXTUAL_MENU_BUTTON_WRAP:`${a("63Ztt").tablePrefixSelector}-contextual-menu-button-wrap`,CONTEXTUAL_MENU_BUTTON:`${a("63Ztt").tablePrefixSelector}-contextual-menu-button`,CONTEXTUAL_MENU_BUTTON_FIXED:`${a("63Ztt").tablePrefixSelector}-contextual-menu-button-fixed`,CONTEXTUAL_MENU_ICON:`${a("63Ztt").tablePrefixSelector}-contextual-submenu-icon`,CONTEXTUAL_MENU_ICON_SMALL:`${a("63Ztt").tablePrefixSelector}-contextual-submenu-icon-small`,SELECTED_CELL:"selectedCell",NODEVIEW_WRAPPER:"tableView-content-wrap",TABLE_SELECTED:`${a("63Ztt").tablePrefixSelector}-table__selected`,TABLE_CELL:a("63Ztt").tableCellSelector,TABLE_HEADER_CELL:a("63Ztt").tableHeaderSelector,TABLE_STICKY:`${a("63Ztt").tablePrefixSelector}-sticky`,TABLE_CHROMELESS:`${a("63Ztt").tablePrefixSelector}-chromeless`,TOP_LEFT_CELL:"table > tbody > tr:nth-child(2) > td:nth-child(1)",LAST_ITEM_IN_CELL:`${a("63Ztt").tablePrefixSelector}-last-item-in-cell`,WITH_COLUMN_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-column-insert-line`,WITH_COLUMN_INSERT_LINE_INACTIVE:`${a("63Ztt").tablePrefixSelector}-column-insert-line__inactive`,WITH_FIRST_COLUMN_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-first-column-insert-line`,WITH_FIRST_COLUMN_INSERT_LINE_INACTIVE:`${a("63Ztt").tablePrefixSelector}-first-column-insert-line__inactive`,WITH_LAST_COLUMN_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-last-column-insert-line`,WITH_LAST_COLUMN_INSERT_LINE_INACTIVE:`${a("63Ztt").tablePrefixSelector}-last-column-insert-line__inactive`,WITH_RESIZE_LINE:`${a("63Ztt").tablePrefixSelector}-column-resize-line`,WITH_RESIZE_LINE_LAST_COLUMN:`${a("63Ztt").tablePrefixSelector}-column-resize-line-last-column`,WITH_DRAG_RESIZE_LINE:`${a("63Ztt").tablePrefixSelector}-drag-column-resize-line`,WITH_DRAG_RESIZE_LINE_LAST_COLUMN:`${a("63Ztt").tablePrefixSelector}-drag-column-resize-line-last-column`,WITH_ROW_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-row-insert-line`,WITH_ROW_INSERT_LINE_INACTIVE:`${a("63Ztt").tablePrefixSelector}-row-insert-line__inactive`,WITH_LAST_ROW_INSERT_LINE:`${a("63Ztt").tablePrefixSelector}-last-row-insert-line`,WITH_LAST_ROW_INSERT_LINE_INACTIVE:`${a("63Ztt").tablePrefixSelector}-last-row-insert-line__inactive`,NATIVE_STICKY:`${a("63Ztt").tablePrefixSelector}-row-native-sticky`,NATIVE_STICKY_ACTIVE:`${a("63Ztt").tablePrefixSelector}-row-native-sticky-active`,NO_OVERFLOW:`${a("63Ztt").tablePrefixSelector}-no-overflow`};(n={}).SHOW_BEFORE_SHADOW="showBeforeShadow",n.SHOW_AFTER_SHADOW="showAfterShadow";let eh=new(0,a("ks2lK").PluginKey)("tablePlugin"),em=new(0,a("ks2lK").PluginKey)("tableWidthPlugin"),ef=(e,t,i,o,n,r,l)=>new(0,a("1S4f7").SafePlugin)({key:em,state:{init:()=>({resizing:!1,tableLocalId:"",tableRef:null}),apply(t,i){let o=t.getMeta(em);if(o&&Object.keys(o).some(e=>i[e]!==o[e])){let t={...i,...o};return e(em,t),t}return i}},appendTransaction:(e,t,s)=>{let d=(0,a("2pjJ5").isReplaceDocOperation)(e,t),c=e.find(e=>e.getMeta("referentialityTableInserted")),p=i&&n,u=i&&r;if(!d&&(!p&&!u||!c))return null;let{table:h}=s.schema.nodes,m=s.tr;return d&&!l&&s.doc.forEach((e,t)=>{if(e.type===h){let n=e.attrs.width,r=e.attrs.layout;if(!n&&r){let n;if(o)n=a("aFUXX").akEditorMaxWidthLayoutWidth;else if(i)n=a("aFUXX").akEditorFullWidthLayoutWidth;else switch(r){case"wide":n=a("aFUXX").akEditorWideLayoutWidth;break;case"full-width":n=a("aFUXX").akEditorFullWidthLayoutWidth;break;default:n=a("aFUXX").akEditorDefaultLayoutWidth}let{width:l,...s}=e.attrs;n&&m.step(new(0,a("9YoeD").SetAttrsStep)(t,{width:n,...s}))}}}),c&&c.steps.forEach(e=>{e.getMap().forEach((e,t,i,o)=>{s.doc.nodesBetween(i,o,(e,t)=>{e.type===h&&(p&&e.attrs.width!==((0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800)&&m.setNodeAttribute(t,"width",(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800),u&&m.setNodeAttribute(t,"layout",Q))})})}),m}});var eg=a("cUcZ5");let eb=({startIndex:e,endIndex:t,includeTooltip:i})=>{let{formatMessage:o}=(0,a("8C5kA").default)();return i?(0,a("9K4OG").jsx)(a("3gadb").default,{content:(0,a("9K4OG").jsx)(a("hgeg8").ToolTipContent,{description:o(a("2CQVV").messages.adjustColumns),keymap:a("hgeg8").startColumnResizing}),hideTooltipOnClick:!0,hideTooltipOnMouseDown:!0,position:"mouse",mousePosition:"auto-start"},i=>(0,a("9K4OG").jsx)("div",{className:eu.RESIZE_HANDLE_DECORATION,"data-start-index":e,"data-end-index":t,...i})):(0,a("9K4OG").jsx)("div",{className:eu.RESIZE_HANDLE_DECORATION,"data-start-index":e,"data-end-index":t})},eE=(e,t)=>t.find(void 0,void 0,t=>t.key.indexOf(e)>-1),eT=e=>eE(ep.COLUMN_SELECTED,e),eC=e=>eE(ep.ALL_CONTROLS_HOVER,e),e_=e=>e.map(e=>a("ftzrq").Decoration.node(e.pos,e.pos+e.node.nodeSize,{class:eu.HOVERED_CELL_WARNING},{key:ep.CELL_CONTROLS_HOVER})),eS=(e,t,i,o,n,r,l)=>{let s=(0,a("id9O1").findTable)(i.selection);if(!s)return[];let d=a("LmqWp").TableMap.get(s.node),[c,p]=e.reduce(([e,t],i)=>((null===e||i.pos<e)&&(e=i.pos),(null===t||i.pos>t)&&(t=i.pos),[e,t]),[null,null]);if(null===c||null===p)return[];let u=e.map(e=>e.pos);if(r&&"table"!==t){let{selection:e}=i,t=(0,a("id9O1").findTable)(e),o=(0,a("iP1et").getSelectionRect)(e);t&&o&&(u=d.cellsInRect(o).map(e=>e+t.start))}return u.map(e=>{let n,s=i.doc.nodeAt(e),d=[eu.HOVERED_CELL];switch(r&&d.push(eu.HOVERED_CELL_IN_DANGER),l&&d.push(eu.SELECTED_CELL),o?("column"===t||"row"===t)&&(d.pop(),d.push(eu.HOVERED_NO_HIGHLIGHT)):d.push("column"===t?eu.HOVERED_COLUMN:"row"===t?eu.HOVERED_ROW:eu.HOVERED_TABLE),t){case"row":n=ep.ROW_CONTROLS_HOVER;break;case"column":n=ep.COLUMN_CONTROLS_HOVER;break;default:n=ep.TABLE_CONTROLS_HOVER}return a("ftzrq").Decoration.node(e,e+s.nodeSize,{class:d.join(" ")},{key:n})})},ew=e=>{let{selection:t,doc:i}=e,o=(0,a("id9O1").findTable)(t),n=(0,a("iP1et").getSelectionRect)(t);return o&&n?a("LmqWp").TableMap.get(o.node).cellsInRect(n).map((e,t)=>{let n=i.nodeAt(e+o.start);return a("ftzrq").Decoration.node(e+o.start,e+o.start+n.nodeSize,{class:eu.COLUMN_SELECTED},{key:`${ep.COLUMN_SELECTED}_${t}`})}):[]},ev=e=>{let t=es(0)(e)||[],i=0;return t.map(e=>{let t=e.node.attrs.colspan||1,o=i,n=o+t;return i=n,a("ftzrq").Decoration.widget(e.pos+1,()=>{let e=document.createElement("div");return e.classList.add(eu.COLUMN_CONTROLS_DECORATIONS),e.dataset.startIndex=`${o}`,e.dataset.endIndex=`${n}`,e},{key:`${ep.COLUMN_CONTROLS_DECORATIONS}_${n}`,side:-100})})},eO=(e,t,i,o)=>{let n=eE(o,t);return t.remove(n).add(e,i)},ey=e=>Array.from(Array(e).keys()),eN=(e,i,o,n=!1,r,l)=>{let s=[[],[]],d=(0,a("id9O1").findTable)(e.selection);if(!d||!d.node)return s;let p=a("LmqWp").TableMap.get(d.node);if(!p.width)return s;let u=(e,i,o,s,d)=>{let p=t(eg)(),u=s+d.nodeSize-1;return a("ftzrq").Decoration.widget(u,()=>{let t=document.createElement("div");return l.render(()=>(0,c.createElement)(a("gmMgo").Provider,{value:r()},(0,c.createElement)(eb,{startIndex:e.left,endIndex:e.right,includeTooltip:n})),t,p),t},{key:`${ep.COLUMN_RESIZING_HANDLE_WIDGET}_${o}_${i}_${n?"with":"no"}-tooltip`,destroy:e=>{l.remove(p)}})},h=(e,t,i)=>{let o;return(i.forEach((e,n,a)=>{if(a===i.childCount-1){let i=n+t+1;o={from:i,to:i+e.nodeSize}}}),o)?a("ftzrq").Decoration.node(o.from,o.to,{class:eu.LAST_ITEM_IN_CELL},{key:`${ep.LAST_CELL_ELEMENT}_${e.left}_${e.right}`}):null},m=[],f=[];for(let t=0;t<p.height;t++){let n={};if(t===i)for(let i=0;i<p.width;i++){let a=p.map[p.width*t+i];if(n[a])continue;n[a]=!0;let r=d.start+a,l=e.doc.nodeAt(r);if(!l)continue;let s=l.attrs.colspan||1,c=i,g=s+c;if(g!==o.right)continue;let b=u({left:c,right:g},i,t,r,l),E=h({left:c,right:g},r,l);m.push(b),f.push(E)}}return[m,f.filter(a("kTbzR").nonNullable)]},eR=(e,t,i)=>{let o=(0,a("id9O1").findTable)(e);if(!o||null===t.right)return[];let n=t.right,r=a("LmqWp").TableMap.get(o.node),l=n===r.width;l&&(n-=1);let s=i?l?eu.WITH_DRAG_RESIZE_LINE_LAST_COLUMN:eu.WITH_DRAG_RESIZE_LINE:l?eu.WITH_RESIZE_LINE_LAST_COLUMN:eu.WITH_RESIZE_LINE;return ey(r.height).map(e=>r.map[r.width*e+n]).filter((e,t)=>!!l||e!==r.map[r.width*t+n-1]).map(e=>({pos:e+o.start,node:o.node.nodeAt(e)})).map((e,i)=>{if(e&&e.node)return a("ftzrq").Decoration.node(e.pos,e.pos+e.node.nodeSize,{class:s},{key:`${ep.COLUMN_RESIZING_HANDLE_LINE}_${t.right}_${i}`})}).filter(a("kTbzR").nonNullable)},ex=(e,t,i)=>{let o,n=(0,a("id9O1").findTable)(t);if(!n)return[];let r=a("LmqWp").TableMap.get(n.node),l=0===e,s=e===r.width;return s&&(e-=1),o=i?l?eu.WITH_FIRST_COLUMN_INSERT_LINE_INACTIVE:s?eu.WITH_LAST_COLUMN_INSERT_LINE_INACTIVE:eu.WITH_COLUMN_INSERT_LINE_INACTIVE:l?eu.WITH_FIRST_COLUMN_INSERT_LINE:s?eu.WITH_LAST_COLUMN_INSERT_LINE:eu.WITH_COLUMN_INSERT_LINE,ey(r.height).map(t=>r.map[r.width*t+e]).filter((t,i)=>!!s||t!==r.map[r.width*i+e-1]).map(e=>({pos:e+n.start,node:n.node.nodeAt(e)})).map((e,t)=>{if(e&&e.node)return a("ftzrq").Decoration.node(e.pos,e.pos+e.node.nodeSize,{class:o},{key:`${ep.COLUMN_INSERT_LINE}_${t}`})}).filter(a("kTbzR").nonNullable)},eA=(e,t,i)=>{let o,n=(0,a("id9O1").findTable)(t);if(!n)return[];let r=e===a("LmqWp").TableMap.get(n.node).height;r&&(e-=1);let l=es(e)(t);return l?(o=i?r?eu.WITH_LAST_ROW_INSERT_LINE_INACTIVE:eu.WITH_ROW_INSERT_LINE_INACTIVE:r?eu.WITH_LAST_ROW_INSERT_LINE:eu.WITH_ROW_INSERT_LINE,l.map((e,t)=>{if(e&&e.node)return a("ftzrq").Decoration.node(e.pos,e.pos+e.node.nodeSize,{class:o},{key:`${ep.ROW_INSERT_LINE}_${t}`})}).filter(a("kTbzR").nonNullable)):[]},eI=e=>({decorationSet:t,tr:i})=>e.reduce((e,t)=>t({decorationSet:e,tr:i}),t),eL=e=>e.selection instanceof a("7XFGZ").CellSelection&&e.selection.isColSelection(),ek=({decorationSet:e})=>e.remove(eC(e)),eM=({decorationSet:e,tr:t})=>eL(t)?eO(t.doc,e,ew(t),ep.COLUMN_SELECTED):e,eD=({decorationSet:e,tr:t})=>(0,a("id9O1").findTable)(t.selection)?eO(t.doc,e,ev(t.selection),ep.COLUMN_CONTROLS_DECORATIONS):e,eP=({decorationSet:e})=>e.remove(eT(e)),eB=e=>!!eT(e).length,eW=({decorationSet:e,tr:t})=>eB(e)?eP({decorationSet:e,tr:t}):e,eU=({decorationSet:e,tr:t,options:i})=>i.isDragAndDropEnabled?eI([eP,ek,eM])({decorationSet:e,tr:t}):eI([eP,ek,eM,eD])({decorationSet:e,tr:t}),eH=new(0,a("ks2lK").PluginKey)("tableDecorationsPlugin"),eF=e=>eH.getState(e),ez=(e,t,i,o)=>{let n=em.getState(o)?.resizing,r=em.getState(i)?.resizing,{isDragAndDropEnabled:l=!1,isInDanger:s,isTableHovered:d}=eh.getState(o)||{};if(n)return a("ftzrq").DecorationSet.empty;if(e.docChanged||e.selection instanceof a("7XFGZ").CellSelection||n!==r)return eU({decorationSet:t,tr:e,options:{isDragAndDropEnabled:l}});if(e.selectionSet){if(!e.docChanged&&e.selectionSet&&e.getMeta("pointer")||i.selection instanceof a("7XFGZ").CellSelection)return eW({decorationSet:t,tr:e});if((s||d)&&(!(0,a("4KOFJ").insideTable)(o)||(0,a("id9O1").findTable)(o.selection)?.node!==(0,a("id9O1").findTable)(i.selection)?.node))return eU({decorationSet:t,tr:e,options:{isDragAndDropEnabled:l}})}return t},eV=()=>new(0,a("1S4f7").SafePlugin)({state:{init:()=>a("ftzrq").DecorationSet.empty,apply:(e,t,i,o)=>{let n=t,a=e.getMeta(eh);return(a&&a.data&&a.data.decorationSet&&(n=a.data.decorationSet),e.docChanged||e.selectionSet||e.getMeta(em))?(n=n.map(e.mapping,e.doc),ez(e,n,i,o)):n}},key:eH,props:{decorations:e=>eF(e)}}),eG=[[],[]],ej=e=>({decorationSet:t,tr:i})=>eO(i.doc,t,e,ep.COLUMN_RESIZING_HANDLE_WIDGET),eK=e=>({decorationSet:t,tr:i})=>eO(i.doc,t,e,ep.LAST_CELL_ELEMENT),e$=(e,t,i,o,n)=>({tr:a,decorationSet:r})=>{let[l,s]=t<0?eG:eN(a,e,{right:t},i,o,n);return eI([ej(l),eK(s)])({decorationSet:r,tr:a})},eX=()=>({tr:e,decorationSet:t})=>{let[i,o]=eG;return eI([ej(i),eK(o)])({decorationSet:t,tr:e})},eZ={hoveredColumns:[],hoveredRows:[]},eq={hoveredCell:{rowIndex:void 0,colIndex:void 0}},eY=new(0,a("ks2lK").PluginKey)("tableFlexiColumnResizing"),eQ=()=>({tableIsCollapsible:!1}),eJ=e=>{let t=e.selection,i=e.doc.type.schema,o=(0,a("id9O1").findTable)(t);if(!o)return eQ();let n=i.nodes.expand,{node:r,pos:l}=o,s=e.doc.resolve(l),d=new(0,a("5SAOw").NodeRange)(s,e.doc.resolve(l+r.nodeSize),s.depth);if(!d)return eQ();let c=(0,a("aXG5V").findWrapping)(d,n);return null===c?eQ():{tableIsCollapsible:!0,range:d,findWrappingRes:c}},e0=e=>{let t=eJ(e),i=e.doc.type.schema.nodes.expand;if(t.range&&t.tableIsCollapsible)return e.wrap(t.range,[{type:i}]).setMeta("scrollIntoView",!0),e},e1=e=>!!e.type.spec.isolating,e2=e=>{let t=a("LmqWp").TableMap.get(e),i=t.cellsInRect({left:0,top:0,right:1,bottom:t.height});for(let t=0;t<i.length;t++)try{let o=e.nodeAt(i[t]);if(o&&o.type!==e.type.schema.nodes.tableHeader)return!1}catch(e){return!1}return!0},e9=e=>{let t=a("LmqWp").TableMap.get(e);for(let i=0;i<t.width;i++){let o=e.nodeAt(t.map[i]);if(o&&o.type!==e.type.schema.nodes.tableHeader)return!1}return!0},e4=e=>tt(e,a("id9O1").findTable,e2,!1),e5=e=>tt(e,a("id9O1").findTable,e9,!1),e3=e=>tt(e,a("id9O1").findTable,e=>!!e.attrs.isNumberColumnEnabled,!1),e8=e=>ti(e).reduce((e,t)=>e+t,0),e6=(e,t)=>{let i=ti(e),o=ti(t);return i.length!==o.length||!1===i.every((e,t)=>e===o[t])},e7=(e,t)=>{let i=a("LmqWp").TableMap.get(t),o=a("LmqWp").TableMap.get(e);return i.width!==o.width},te=(e,t)=>{let i=a("LmqWp").TableMap.get(t),o=a("LmqWp").TableMap.get(e);return i.height!==o.height};function tt(e,t,i,o){let n=t(e);return n?i(n.node,n.pos):o}function ti(e){if(!e.content.firstChild)return[];let t=[];return e.content.firstChild.content.forEach(e=>{if(Array.isArray(e.attrs.colwidth)){let i=e.attrs.colspan||1;t.push(...e.attrs.colwidth.slice(0,i))}}),t}let to=(e,t=0)=>{let i=e.doc.resolve(t),o=i.parent,n=e.schema.nodes;return(0,a("dh538").fg)("platform_editor_change_table_nesting_check")?i.depth>0:o.type===n.layoutColumn||o.type===n.expand||o.type===n.bodiedExtension||o.type===n.extensionFrame||o.type===n.tableHeader||o.type===n.tableCell},tn=(e,t=0)=>e.doc.resolve(t).depth>2,ta=e=>(0,a("3Ter7").mapChildren)(e,e=>e.attrs.rowspan||0).some(e=>e>1),tr=e=>{let t=(0,a("3Ter7").mapChildren)(e,e=>"tableHeader"===e.type.name).every(Boolean),i=ta(e);return t&&!i},tl=(e,t)=>{let i=e.steps.find(e=>e instanceof a("cCTpf").TableSortStep);return i&&t&&t.pos===i.pos?i.next:void 0},ts=(e,t)=>{if(!e.getMeta(eY))return t},td=({tr:e,table:t})=>i=>{if(!(t&&t.node))return{...i,targetCellPosition:void 0};let{tableCell:o,tableHeader:n}=e.doc.type.schema.nodes,a=(0,u.findParentNodeOfType)([o,n])(e.selection),r=a?a.pos:void 0;return i.targetCellPosition===r?i:{...i,targetCellPosition:r}},tc=({tr:e,table:t})=>i=>{let o=t&&t.node;return!o||(0,a("5mxQU").isTextInput)(e)?i:{...i,...eZ,tableNode:o,ordering:tl(e,t),resizeHandleColumnIndex:ts(e,i.resizeHandleColumnIndex),isNumberColumnEnabled:e3(e.selection),isHeaderColumnEnabled:e4(e.selection),isHeaderRowEnabled:e5(e.selection)}},tp=({tr:e,table:t})=>i=>{let o=t&&t.node,n=e.doc.type.schema,a=i.pluginConfig.allowCollapse,r=void 0!==n.nodes.expand;if(!i.editorHasFocus||!(a&&r)||!o)return i;let l=n.nodes.expand,s=l&&!!(0,u.findParentNodeOfType)(l)(e.selection),d=eJ(e).tableIsCollapsible,c=!!i.tableNode&&!s&&!!d;return i.isTableCollapsed!==s||i.canCollapseTable!==c?{...i,isTableCollapsed:s,canCollapseTable:c}:i},tu=e=>t=>i=>t.table?e.reduce((e,i)=>i(t)(e),i):i.targetCellPosition?{...i,targetCellPosition:void 0}:i,th=(e,t)=>tu([td,tc,tp])({tr:e,table:(0,a("id9O1").findTable)(e.selection)})(t),{createPluginState:tm,createCommand:tf,getPluginState:tg}=(0,a("lkJUe").pluginFactory)(eh,(e,t)=>{switch(t.type){case"TOGGLE_HEADER_COLUMN":return{...e,isHeaderColumnEnabled:!e.isHeaderColumnEnabled};case"TOGGLE_HEADER_ROW":return{...e,isHeaderRowEnabled:!e.isHeaderRowEnabled};case"CLEAR_HOVER_SELECTION":return{...e,...t.data,...eZ};case"SELECT_COLUMN":case"SET_TARGET_CELL_POSITION":return{...e,...t.data,isContextualMenuOpen:!1};case"TOGGLE_CONTEXTUAL_MENU":return{...e,isContextualMenuOpen:!e.isContextualMenuOpen};case"SHOW_INSERT_ROW_BUTTON":if(t.data.insertRowButtonIndex===e.insertRowButtonIndex)return e;return{...e,...t.data,insertColumnButtonIndex:void 0};case"SHOW_INSERT_COLUMN_BUTTON":if(t.data.insertColumnButtonIndex===e.insertColumnButtonIndex)return e;return{...e,...t.data,insertRowButtonIndex:void 0};case"HIDE_INSERT_COLUMN_OR_ROW_BUTTON":if(void 0!==e.insertRowButtonIndex||void 0!==e.insertColumnButtonIndex)return{...e,insertRowButtonIndex:void 0,insertColumnButtonIndex:void 0};return e;case"HIDE_RESIZE_HANDLE_LINE":return{...e,...t.data,resizeHandleColumnIndex:void 0,resizeHandleRowIndex:void 0};case"START_KEYBOARD_COLUMN_RESIZE":case"ADD_RESIZE_HANDLE_DECORATIONS":if(t.data.resizeHandleColumnIndex===e.resizeHandleColumnIndex&&t.data.resizeHandleRowIndex===e.resizeHandleRowIndex&&t.data.resizeHandleIncludeTooltip===e.resizeHandleIncludeTooltip&&t.data.isKeyboardResize===e.isKeyboardResize)return e;return{...e,...t.data,isResizeHandleWidgetAdded:!0};case"UPDATE_RESIZE_HANDLE_DECORATIONS":let{resizeHandleColumnIndex:i,resizeHandleRowIndex:o,resizeHandleIncludeTooltip:n}=t.data;if((i===e.resizeHandleColumnIndex||!Number.isFinite(i))&&(o===e.resizeHandleRowIndex||!Number.isFinite(o))&&(n===e.resizeHandleIncludeTooltip||void 0===n))return e;return{...e,resizeHandleColumnIndex:i??e.resizeHandleColumnIndex,resizeHandleRowIndex:o??e.resizeHandleRowIndex,resizeHandleIncludeTooltip:n??e.resizeHandleIncludeTooltip};case"STOP_KEYBOARD_COLUMN_RESIZE":case"REMOVE_RESIZE_HANDLE_DECORATIONS":if(!e.isResizeHandleWidgetAdded)return e;return{...e,...t.data,resizeHandleColumnIndex:void 0,resizeHandleRowIndex:void 0,isResizeHandleWidgetAdded:!1,isKeyboardResize:void 0};case"UPDATE_TABLE_WIDTH_TO_WIDEST":case"SET_TABLE_REF":case"HOVER_ROWS":case"HOVER_COLUMNS":case"HOVER_TABLE":case"TABLE_HOVERED":case"HOVER_MERGED_CELLS":case"HOVER_CELL":case"SHOW_RESIZE_HANDLE_LINE":case"SET_EDITOR_FOCUS":case"SET_CELL_MENU_OPEN":return{...e,...t.data};default:return e}},{mapping:(e,t)=>{if(e.docChanged){let i={};if(t.targetCellPosition){let{pos:o,deleted:n}=e.mapping.mapResult(t.targetCellPosition);i={targetCellPosition:n?void 0:o}}let o={};if(t.tablePos){let{pos:i,deleted:n}=e.mapping.mapResult(t.tablePos,-1);o={tablePos:n?void 0:i}}return{...t,...i,...o}}return t},onDocChanged:th,onSelectionChanged:th}),tb=e=>e?parseInt(e,10):0;function tE(e,t,i=[],o=document.createElement("canvas")){return function(e,t,i,o){let n=[],a=0;for(let r=0;r<e.childNodes.length;r++){let l=e.childNodes[r];if(l.nodeType!==Node.COMMENT_NODE)if(l.nodeType===Node.TEXT_NODE){let e=l.parentNode,r=getComputedStyle(e),s=0;s="CODE"===e.nodeName||"PRE"===e.nodeName?function(e,t,i,o){let n=t;"CODE"===t.nodeName&&(n=t.parentNode);let a=getComputedStyle(n);return i&&"pre"===a.whiteSpace?i.split("\n").reduce((t,i)=>Math.max(tT(e,i,o),t),0):tT(e,i,o)}(i,e,l.textContent,r.font):tT(i,l.textContent,r.font);let d=e.offsetLeft-t.offsetLeft;n.push(a),a+=s+d,"nowrap"===r.whiteSpace&&o.push(e.offsetWidth+3)}else{let e=getComputedStyle(l);e.minWidth&&e.minWidth.endsWith("px")&&"0px"!==e.minWidth&&o.push(tb(e.minWidth));let{width:r}=tE(l,t,o,i);e.display&&e.display.indexOf("inline")>-1?a+=r:(n.push(a),a=r)}}return n.push(a),{minWidth:o.reduce((e,t)=>Math.max(t,e),0),width:n.reduce((e,t)=>Math.max(t,e),0)}}(e,t||e,o,i)}function tT(e,t,i){let o=e.getContext("2d");return o?(i&&(o.font=i),Math.round(o.measureText(t||"").width)):0}let tC=(e,t,i)=>{var o;let n=tw(e,tO),r=n<i?a("1zav4").tableNewColumnMinWidth:tw(e,(o=i,(e,t,i)=>{if(i&&i>1)return tb(e.width);let{minWidth:n}=tE(t,t);return Math.max(tv(n,e),n,o)}));return{index:t,width:n<i?a("1zav4").tableNewColumnMinWidth:n,minWidth:r}},t_=e=>Math.max(e.width-e.minWidth,0),tS=(e,t,i,o)=>{let n=a("LmqWp").TableMap.get(t),r=n.cellsInRect({left:e,right:e+1,top:0,bottom:n.height}),l=[];return r.forEach(e=>{let t=(0,u.findDomRefAtPos)(e+i,o);t&&l.push(t)}),l},tw=(e,t)=>{let i=0,o=0;return e.forEach(e=>{let n=getComputedStyle(e),a=Number(e.getAttribute("colspan")||1);if(a>1){o=t(n,e,a);return}n&&(i=Math.max(t(n,e,a),i))}),i||o},tv=(e,t)=>e+tb(t.paddingLeft)+tb(t.paddingRight);function tO(e){return tb(e.width)}let ty=({colspan:e,rowspan:t,tableLocalId:i},o)=>{e&&e<0&&o({nodeType:"tableCell",attribute:"colspan",reason:"negative value",tableLocalId:i,spanValue:e}),t&&t<0&&o({nodeType:"tableCell",attribute:"rowspan",reason:"negative value",tableLocalId:i,spanValue:t})},tN=(e,t,i,o)=>{let n=!1;return i=tI(i,e,t,t=>{let{colwidth:i,colspan:a,rowspan:r}=t.attrs;return(o&&ty({colspan:a,rowspan:r,tableLocalId:e.attrs.localId},o),i&&i.length>a)?(n=!0,t.type.createChecked({...t.attrs,colwidth:i.slice(0,a)},t.content,t.marks)):t}),!!n},tR=(e,t)=>{let i=!1;if(e.doc.descendants((o,n)=>{"table"===o.type.name&&(i=tN(o,e.mapping.map(n),e,t))}),i)return e},tx=(e,t,i,o,n)=>{let{tr:r}=e.state,l=function(e,t,i,o){let n=o.querySelector("tr");if(!n)return[];let r=[];for(let l=0;l<n.childElementCount;l++){let s=Number(n.children[l].getAttribute("colspan")||1);for(let n=0;n<s;n++){let s=l+n,d=tw(tS(s,t,i,e),(e,t)=>tE(t,o).width);r[s]=Math.max(d,a("1zav4").tableCellMinWidth)}}return r}(e.domAtPos.bind(e),t,o+1,i),s=l.reduce((e,t)=>e+t,0),d=tA(s),c=x(d,n.containerWidth,{}),p=1;s!==c&&(p=c/s);let u=l.map(e=>Math.floor(e*p));return(r=tI(r,t,o,(e,t,i)=>{let o=u.slice(i,i+e.attrs.colspan);return e.type.createChecked({...e.attrs,colwidth:o.length?o:null},e.content,e.marks)})).setNodeMarkup(o,void 0,{...t.attrs,layout:d,__autoSize:!1}).setMeta("addToHistory",!1)},tA=e=>e>a("aFUXX").akEditorWideLayoutWidth?"full-width":e>a("aFUXX").akEditorDefaultLayoutWidth&&e<a("aFUXX").akEditorWideLayoutWidth?"wide":"default",tI=(e,t,i,o)=>{let n=[],a=0;for(let e=0;e<t.childCount;e++){let i=t.child(e),r=[];for(let t=0;t<i.childCount;t++){let n=i.child(t),l=o(n,e,t);!1===l.sameMarkup(n)&&a++,r.push(l)}r.length&&n.push(i.type.createChecked(i.attrs,r,i.marks))}if(n.length&&0!==a){let o=t.type.createChecked(t.attrs,n,t.marks);return e.replaceWith(i,i+t.nodeSize,o)}return e},tL=(e,t,i)=>eO(e.doc,eF(e),t,i),tk=e=>tf({type:"SET_EDITOR_FOCUS",data:{editorHasFocus:e}}),tM=e=>tf(t=>{let i=(0,a("id9O1").findTable)(t.selection),o=e&&i?i.node:void 0,n=e&&i?i.pos:void 0,r=(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_NODE_WRAPPER}`)||void 0,{isDragAndDropEnabled:l}=tg(t);return{type:"SET_TABLE_REF",data:{tableRef:e,tableNode:o,tablePos:n,tableWrapperTarget:r,isNumberColumnEnabled:e3(t.selection),isHeaderRowEnabled:e5(t.selection),isHeaderColumnEnabled:e4(t.selection),decorationSet:l?void 0:tL(t,ev(t.selection),ep.COLUMN_CONTROLS_DECORATIONS),resizeHandleRowIndex:void 0,resizeHandleColumnIndex:void 0}}},e=>e.setMeta("addToHistory",!1)),tD=(e,t)=>{let{tableCell:i,tableHeader:o}=t.nodes;return(0,a("3Ter7").mapSlice)(e,e=>{if(e.type===i||e.type===o){let t={...e.attrs};return t.background=void 0,e.type.createChecked(t,e.content,e.marks)}return e})},tP=(e,t)=>{let{tableCell:i,tableHeader:o}=t.nodes;return(0,a("3Ter7").mapSlice)(e,e=>{if(e.type===i||e.type===o){let t={...e.attrs};return(e.type===i&&"#1f1f21"===t.background||e.type===o&&"#303134"===t.background)&&(t.background=void 0),e.type.createChecked(t,e.content,e.marks)}return e})},tB=(e,t)=>{let{table:i,tableHeader:o,tableRow:n}=t.nodes;return(0,a("3Ter7").mapSlice)(e,e=>{if(e.type===i){let t=e.firstChild;if(t){let i=[];t.forEach(e=>{i.push(o.createChecked(e.attrs,e.content,e.marks))});let a=n.createChecked(t.attrs,i,t.marks);return e.copy(e.content.replaceChild(0,a))}}return e})},tW=(e,t)=>{let{tableHeader:i,tableCell:o}=t.nodes;return(0,a("3Ter7").mapSlice)(e,e=>e.type===o||e.type===i?e.attrs.colwidth?e.type.createChecked({...e.attrs,colwidth:void 0},e.content,e.marks):e:e)},tU=(e,t,i)=>{let{tableHeader:o,tableCell:n}=t.nodes,a=0;return i&&e.content.descendants(e=>{if(e.type===n||e.type===o)return a+="row"===i?e.attrs.colspan:e.attrs.rowspan,!1}),a},tH=e=>{if(e instanceof a("7XFGZ").CellSelection)return e.isRowSelection()?"row":e.isColSelection()?"column":void 0},tF=(e,t)=>{let{schema:{nodes:{tableRow:i,table:o}}}=t,n=(0,a("id9O1").findTable)(t.tr.selection);if(e.content.firstChild&&(e.content.firstChild.type===o||e.content.firstChild.type===i)&&n){if(1===e.content.childCount&&e.content.firstChild.type===i)return"row";try{let t=a("LmqWp").TableMap.get(n.node),i=a("LmqWp").TableMap.get(e.content.firstChild);return t.width===i.width?"row":t.height===i.height?"column":void 0}catch(e){return}}},tz=(e,t)=>{let i=(0,a("id9O1").findTable)(e);if(!i||!t)return!1;let o=a("LmqWp").TableMap.get(i.node),n=(0,a("id9O1").findCellClosestToPos)(e.$anchor);if(!n)return!1;let r=n.pos-i.pos-1,l=o.map.findIndex(e=>e===r);return"row"===t?l%o.width==0:l<o.width},tV=(e,t)=>(t&&t(ed(e.tr)),!0),tG=(e,t)=>!!(0,a("iYC9s").isTableSelected)(e.selection)&&tV(e,t),tj=(e,t)=>{let i,o,{$cursor:n}=e.selection;if(!n||n.parentOffset>0)return!1;if(!e1(n.parent))for(let e=n.depth-1;!i&&e>=0&&(n.index(e)>0&&(o=n.before(e+1),i=n.node(e).child(n.index(e)-1)),!e1(n.node(e)));e--);if(!i||i.type!==e.schema.nodes.table)return!1;let r=n.node(n.depth-1);if(n.parent.type!==e.schema.nodes.paragraph||r&&r.type!==e.schema.nodes.doc)return!1;let{tr:l}=e,s=(o||0)-4;l.setSelection(new(0,a("ks2lK").TextSelection)(e.doc.resolve(s)));let{$from:d}=l.selection,c=d.start(-1)+d.parent.nodeSize-1;l.setSelection(new(0,a("ks2lK").TextSelection)(e.doc.resolve(c)));let p=n.node(),u=e.doc.content.size,h=n.pos-1,m=n.pos+1;return 0===p.content.size&&n.pos+1!==u&&l.delete(h,m),t&&t(l),!0},tK=(e,t)=>(i,o)=>{let n,{tr:r}=i,{targetCellPosition:l}=tg(i);if((0,a("BW42l").isSelectionType)(r.selection,"cell")){let t=r.selection;t.forEachCell((t,i)=>{let o=r.doc.resolve(r.mapping.map(i+1));r=ec((0,a("id9O1").findCellClosestToPos)(o),e)(r)}),n=t.$headCell.pos}else if(l){let t=(0,a("id9O1").findCellClosestToPos)(r.doc.resolve(l+1));r=ec(t,e)(r),n=t.pos}return!!r.docChanged&&void 0!==n&&(o&&(void 0!==n&&(t?.focus(),r.setSelection(new(0,a("ks2lK").TextSelection)(r.doc.resolve(n)))),o(r)),!0)},t$=(e,t,i=!1)=>tf(i=>{let o=el(e)(i.tr.selection);if(!o||!o.length||"number"!=typeof o[0].pos)return!1;let n=ew((0,a("kEbNW").selectColumn)(e,t)(i.tr)),r=tL(i,n,ep.COLUMN_SELECTED);return{type:"SELECT_COLUMN",data:{targetCellPosition:o[0].pos,decorationSet:r}}},o=>(0,a("kEbNW").selectColumn)(e,t)(o).setMeta("addToHistory",!1).setMeta("selectedColumnViaKeyboard",i)),tX=e=>tf(t=>{if(!e)return!1;let i=e.map(e=>el(e)(t.tr.selection)).flat();if(!i||!i.length||i.some(e=>e&&"number"!=typeof e.pos))return!1;let o=ew((0,a("kEbNW").selectColumns)(e)(t.tr)),n=tL(t,o,ep.COLUMN_SELECTED),r=el(Math.min(...e))(t.tr.selection);return!!r&&0!==r.length&&{type:"SELECT_COLUMN",data:{targetCellPosition:r[0].pos,decorationSet:n}}},t=>(0,a("kEbNW").selectColumns)(e)(t).setMeta("addToHistory",!1)),tZ=(e,t,i=!1)=>tf(t=>{let i,o=es(e)(t.tr.selection);return o&&o.length&&(i=o[0].pos),{type:"SET_TARGET_CELL_POSITION",data:{targetCellPosition:i}}},o=>(0,a("kEbNW").selectRow)(e,t)(o).setMeta("addToHistory",!1).setMeta("selectedRowViaKeyboard",i)),tq=e=>tf(t=>{if(0===e.length)return!1;let i=e.map(e=>es(e)(t.tr.selection)).flat();if(!i||!i.length||i.some(e=>e&&"number"!=typeof e.pos))return!1;let o=es(Math.min(...e))(t.tr.selection);return!!o&&0!==o.length&&{type:"SET_TARGET_CELL_POSITION",data:{targetCellPosition:o[0].pos}}},t=>(0,a("kEbNW").selectRows)(e)(t).setMeta("addToHistory",!1)),tY=e=>tf(t=>e>-1&&{type:"SHOW_INSERT_COLUMN_BUTTON",data:{insertColumnButtonIndex:e}},e=>e.setMeta("addToHistory",!1)),tQ=e=>tf(t=>e>-1&&{type:"SHOW_INSERT_ROW_BUTTON",data:{insertRowButtonIndex:e}},e=>e.setMeta("addToHistory",!1)),tJ=()=>tf({type:"HIDE_INSERT_COLUMN_OR_ROW_BUTTON"},e=>e.setMeta("addToHistory",!1)),t0=(e,t,i,o,n)=>tf(r=>{let l=(0,a("id9O1").findTable)(r.selection),{pluginConfig:{allowColumnResizing:s},getIntl:d}=tg(r);return!!l&&!!s&&{type:"ADD_RESIZE_HANDLE_DECORATIONS",data:{decorationSet:e$(e,t,i,d,o)({tr:r.tr,decorationSet:eF(r)}),resizeHandleRowIndex:e,resizeHandleColumnIndex:t,resizeHandleIncludeTooltip:i,isKeyboardResize:n||!1}}},e=>e.setMeta("addToHistory",!1)),t1=(e,t,i,o)=>tf(n=>{let r=(0,a("id9O1").findTable)(n.selection),{resizeHandleRowIndex:l,resizeHandleColumnIndex:s,resizeHandleIncludeTooltip:d,pluginConfig:{allowColumnResizing:c},getIntl:p}=tg(n);if(!r||!c)return!1;let u=t??l,h=i??s,m=o??d;return void 0!==u&&void 0!==h&&void 0!==m&&{type:"UPDATE_RESIZE_HANDLE_DECORATIONS",data:{decorationSet:e$(u,h,m,p,e)({tr:n.tr,decorationSet:eF(n)}),resizeHandleRowIndex:t,resizeHandleColumnIndex:i,resizeHandleIncludeTooltip:o}}},e=>e.setMeta("addToHistory",!1)),t2=()=>tf(e=>({type:"REMOVE_RESIZE_HANDLE_DECORATIONS",data:{decorationSet:eX()({tr:e.tr,decorationSet:eF(e)})}}),e=>e.setMeta("addToHistory",!1)),t9=(e,t,i,o,n)=>"number"==typeof o&&(e.dispatch(tx(e,t,i,o,n)),!0),t4=e=>(t,i)=>{let{tr:o}=t;if((0,a("kTbzR").isTextSelection)(o.selection)&&o.selection.$cursor&&null==o.storedMarks&&o.selection.$from.depth===e.depth+1&&4===e.node.nodeSize&&(0,a("7iE7T").isParagraph)(e.node.firstChild,t.schema)){let{strong:e}=t.schema.marks;return o.setStoredMarks([e?.create()]).setMeta("addToHistory",!1),i&&i(o),!0}return!1},t5=e=>tf(i=>{let{widthToWidest:o}=tg(i);return!t(er)(e,o)&&{type:"UPDATE_TABLE_WIDTH_TO_WIDEST",data:{widthToWidest:{...o,...e}}}}),t3=(e,t)=>({tr:i})=>{let o=(0,a("id9O1").findTable)(i.selection);if(!o)return null;let n={...o.node.attrs,layout:e};return o.node.attrs.width||t||(n.width=(0,a("6fQl1").getTableContainerWidth)(o.node)),i.setNodeMarkup(o.pos,void 0,n).setMeta("scrollIntoView",!1),i},t8=(e,t)=>({tr:i})=>{let o=t.node,n={...o.attrs,layout:e};return o.attrs.width||(n.width=(0,a("6fQl1").getTableContainerWidth)(o)),i.setNodeMarkup(t.pos,void 0,n).setMeta("scrollIntoView",!1),i},t6=(e=!0,t)=>tf(()=>({type:"SET_CELL_MENU_OPEN",data:{isCellMenuOpenByKeyboard:e}}),e=>(t||e).setMeta("addToHistory",!1));var t7=((r={})[r.UpdateOverflowTriggerNameAction=0]="UpdateOverflowTriggerNameAction",r[r.UpdateRowOrColumnMovedAction=1]="UpdateRowOrColumnMovedAction",r[r.RemoveRowOrColumnMovedAction=2]="RemoveRowOrColumnMovedAction",r[r.RemoveOverFlowTriggerNameAction=3]="RemoveOverFlowTriggerNameAction",r[r.UpdateRowOrColumnMovedAndOverflowTrigger=4]="UpdateRowOrColumnMovedAndOverflowTrigger",r);let ie=new(0,a("ks2lK").PluginKey)("tableAnalyticPlugin"),it={rowOrColumnMoved:{type:void 0,numberOfCells:void 0,currentActions:[]}},{createPluginState:ii,createCommand:io,getPluginState:ia}=(0,a("lkJUe").pluginFactory)(ie,(e,t)=>{switch(t.type){case t7.UpdateRowOrColumnMovedAction:return{...e,rowOrColumnMoved:{...e.rowOrColumnMoved,...t.data}};case t7.RemoveRowOrColumnMovedAction:return{...e,rowOrColumnMoved:it.rowOrColumnMoved};default:return e}}),ir=(e,t,i)=>"pasted"===t?i&&i.currentActions.includes("copyOrCut")&&i.currentActions.includes("addRowOrColumn")&&i.numberOfCells===e.numberOfCells&&i.type===e.type?"pasted":"none":t,il=(e,t,i)=>{let o=ir(e,t,i);return"none"===o?it.rowOrColumnMoved:i.type!==e.type?{currentActions:[o],numberOfCells:e?.numberOfCells,type:e.type}:{currentActions:i.currentActions.includes(o)?i.currentActions:[...i.currentActions,o],numberOfCells:e?.numberOfCells||i.numberOfCells,type:e?.type}},is=(e,t)=>io(i=>{let{rowOrColumnMoved:o}=ia(i),n=il(e,t,o);return{type:t7.UpdateRowOrColumnMovedAction,data:n}},e=>e.setMeta("addToHistory",!1)),id=()=>e=>{let t={type:t7.RemoveRowOrColumnMovedAction};return e.setMeta(ie,t)},ic=(e,t)=>(i,o)=>{let{rowOrColumnMoved:n}=ia(i),a=il(e,t,n),r={type:t7.UpdateRowOrColumnMovedAction,data:a};return o.setMeta(ie,r)},ip=(e,t)=>new(0,a("1S4f7").SafePlugin)({key:ie,state:ii(e,it),appendTransaction:(e,i,o)=>{let n=e.find(e=>e.getMeta(ie)?.data?.currentActions?.includes("pasted"));if(n){let e=o.tr;return t({action:a("3824I").TABLE_ACTION.ROW_OR_COLUMN_MOVED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{type:n.getMeta(ie)?.data?.type}}),id()(e)}},props:{handlePaste:({state:e,dispatch:t},i,o)=>{let{schema:n}=e,a=tF(o,e);a&&tz(e.selection,a)&&is({numberOfCells:tU(o,n,a),type:a},"pasted")(e,t)},transformCopied:(e,{state:t,dispatch:i})=>{let{schema:o}=t,n=tH(t.selection);return is({numberOfCells:tU(e,o,n),type:n},"copyOrCut")(t,i),e}}}),iu=e=>t=>{let i=(0,a("id9O1").findTable)(t.selection);if(i){let o=a("LmqWp").TableMap.get(i.node);if(e>=0&&e<=o.width)return(0,a("8usfh").cloneTr)((0,a("9b9Mr").addColumn)(t,{map:o,tableStart:i.start,table:i.node},e))}return t},ih=(e,t)=>i=>{let o=[],n=es(e)(i.selection);if(n)for(let e=n.length-1;e>=0;e--)t(n[e],i)&&o.push(n[e]);return o},im=e=>t=>{let i=(0,a("id9O1").findTable)(t.selection);if(i){let o=a("LmqWp").TableMap.get(i.node);if(e>=0&&e<=o.height){let n=i.node,r=(0,a("d1kIV").tableNodeTypes)(n.type.schema),l=i.start;for(let t=0;t<e+1;t++)l+=n.child(t).nodeSize;let s=n.child(e),d=[],c=0;if(s.forEach(e=>{if(1===e.attrs.rowspan){c+=e.attrs.colspan;let t=r[e.type.spec.tableRole].createAndFill(e.attrs,[],e.marks);t&&d.push(t)}}),c<o.width){let i=[];for(let o=e;o>=0;o--){let n=ih(o,(t,i)=>{let n=t.node.attrs.rowspan,a=o+n;return n>1&&a>e})(t);i.push(...n)}i.length&&i.forEach(e=>{t=ec(e,{rowspan:e.node.attrs.rowspan+1})(t)})}return(0,u.safeInsert)(r.row.create(s.attrs,d),l)(t)}}return t},ig=(e,t)=>i=>{let o=(0,a("id9O1").findTable)(i.selection);if(o){let n=a("LmqWp").TableMap.get(o.node),r=e-1;if(t&&r>=0)return(0,a("8usfh").cloneTr)(im(r)(i));if(e>=0&&e<=n.height)return(0,a("8usfh").cloneTr)((0,a("9MzzS").addRow)(i,{map:n,tableStart:o.start,table:o.node},e))}return i},ib=new(0,a("ks2lK").PluginKey)("tableOverflowAnalyticsPlugin"),iE={OVERFLOW_TRIGGER:"tableOverflowTrigger",OVERFLOW_STATE_CHANGED:"tableOverflowStateChanged"},iT=(e,t,i)=>new(0,a("1S4f7").SafePlugin)({key:ib,state:{init:()=>({lastTrigger:void 0}),apply(t,i){let o=t.getMeta(iE.OVERFLOW_TRIGGER),n={...i};return o?(n.lastTrigger={...o},e(ib,n),n):i}},appendTransaction:(e,o,n)=>{let r=ib.getState(n),l=!1,s=r?.lastTrigger?.name||a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.EXTERNAL;if(e.forEach(e=>{let o=e.getMeta(iE.OVERFLOW_STATE_CHANGED);o&&(t({action:a("3824I").TABLE_ACTION.OVERFLOW_CHANGED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{editorWidth:o.editorWidth,parentWidth:o.parentWidth,isOverflowing:o.isOverflowing,wasOverflowing:o.wasOverflowing,width:o.width,tableResizingEnabled:i,trigger:s}}),l=!0)}),l)return n.tr.setMeta(iE.OVERFLOW_TRIGGER,{})}});function iC(e){let t,i=0,o=0,n=(0,a("id9O1").findTable)(e);return n&&(i=(t=a("LmqWp").TableMap.get(n.node)).height,o=t.width),{table:n,map:t,totalRowCount:i,totalColumnCount:o}}function i_(e){let t=1,i=1,o=1,{table:n,map:r,totalRowCount:l,totalColumnCount:s}=iC(e);if(n&&r){let n=(0,a("iP1et").getSelectionRect)(e);n&&(o=r.cellsInRect(n).length,t=n.right-n.left,i=n.bottom-n.top)}return{totalRowCount:l,totalColumnCount:s,horizontalCells:t,verticalCells:i,totalCells:o}}let iS=e=>t=>i=>(o,n,a)=>i(o,i=>{let a=e instanceof Function?e(o):e;return a&&t?.attachAnalyticsEvent(a)(i),n&&n(i),!0},a),iw=e=>{let t=a("LmqWp").TableMap.get(e.resizedNode);return{action:a("3824I").TABLE_ACTION.RESIZED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{newWidth:e.resizedNode.attrs.width,prevWidth:e.originalNode.attrs.width??null,nodeSize:e.resizedNode.nodeSize,totalTableWidth:$(e.resizedNode)?e8(e.resizedNode):null,totalRowCount:t.height,totalColumnCount:t.width}}},iv=e=>{if(!(e.length>1))return e;{let t=Math.round(e.reduce((e,t,i)=>0===i?e:e+t,0)/(e.length-1));return[e[0],t]}},iO=e=>iv(e.frameRateSamples).map((t,i)=>({action:a("3824I").TABLE_ACTION.RESIZE_PERF_SAMPLING,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,eventType:a("d925B").EVENT_TYPE.OPERATIONAL,attributes:{frameRate:t,nodeSize:e.originalNode.nodeSize,docSize:e.docSize,isInitialSample:0===i}})),iy=(e={})=>{let{maxSamples:t=10,minFrames:i=5,minTimeMs:o=500,sampleRateMs:n=1e3,timeoutMs:a=200}=e,r=(0,c.useRef)(0),l=(0,c.useRef)(0),s=(0,c.useRef)(),d=(0,c.useRef)([]);(0,c.useEffect)(()=>()=>{s.current&&clearTimeout(s.current)},[]);let p=(e=0)=>{let t=performance.now()-l.current-e;if(t>o&&r.current>=i){let e=Math.round(r.current/(t/1e3));d.current.push(e)}r.current=0,l.current=0};return{startMeasure:()=>{r.current=0,l.current=performance.now()},endMeasure:()=>{let e=d.current;return d.current=[],e},countFrames:()=>{if(d.current.length>=t&&s.current)return void clearTimeout(s.current);0===l.current&&(l.current=performance.now()),r.current++,s.current&&clearTimeout(s.current),performance.now()-l.current>n?p():s.current=setTimeout(()=>p(a),a)}}},iN=new Set(["layoutSection","layoutColumn","expand","nestedExpand","extension","bodiedExtension","multiBodiedExtension","extensionFrame","table","tableCell","tableHeader","tableRow"]),iR=(e,t)=>{let i=[];if(e.state.doc.nodesBetween(0,e.state.doc.content.size,(t,o,n)=>{if(!iN.has(t.type.name))return!1;if("table"===t.type.name){let t=e.domAtPos(o+1),a=t.node?.parentElement,r=n?.type.name==="tableCell"||n?.type.name==="tableHeader";a instanceof HTMLTableElement&&i.push({tableWidth:a.scrollWidth,isNestedTable:r,hasScrollbar:!!a.parentElement&&a?.parentElement.clientWidth<a.scrollWidth})}}),0===i.length)return;let o=Math.max(...i.map(e=>e.tableWidth));return{action:a("3824I").TABLE_ACTION.TABLE_WIDTH_INFO,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{editorWidth:t,editorWidthBreakpoint:(0,a("lWghV").getBreakpointKey)(t),hasTableWithScrollbar:i.some(e=>e.hasScrollbar),hasTableWiderThanEditor:o>t,maxTableWidthBreakpoint:(0,a("lWghV").getBreakpointKey)(o),tableWidthInfo:i,mode:"editor"},eventType:a("d925B").EVENT_TYPE.OPERATIONAL}},ix=e=>{let t=[],i=e.dom.closest(".fabric-editor-popup-scroll-parent");if(!i)return;let o=i.clientHeight,n=i.scrollHeight>o;if(e.state.doc.nodesBetween(0,e.state.doc.content.size,(i,o,n)=>{if(!iN.has(i.type.name))return!1;if("table"===i.type.name){let i=e.domAtPos(o+1),a=i.node?.parentElement,r=n?.type.name==="tableCell"||n?.type.name==="tableHeader";a instanceof HTMLTableElement&&t.push({isNestedTable:r,tableHeight:a.scrollHeight})}}),0===t.length)return;let r=Math.max(...t.map(e=>e.tableHeight));return{action:a("3824I").TABLE_ACTION.TABLE_EDITOR_HEIGHT_INFO,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{editorScrollParentClientHeight:o,isEditorScrollable:n,maxTableToEditorHeightRatio:r/o,tableHeightInfo:t},eventType:a("d925B").EVENT_TYPE.OPERATIONAL}},iA=`var(--ds-surface, ${a("6fnsQ").N0})`,iI=`var(--ds-background-accent-gray-subtlest, ${a("aFUXX").akEditorTableHeaderCellBackground})`;a("aFUXX").akEditorTableToolbar;let iL=`var(--ds-text-subtlest, ${a("6fnsQ").N200})`,ik=`var(--ds-background-accent-gray-subtler, ${a("aFUXX").akEditorTableBorder})`;a("6fnsQ").N20;let iM=`var(--ds-blanket-selected, ${a("aFUXX").akEditorTableCellBlanketSelected})`,iD=`var(--ds-background-selected-pressed, ${a("6fnsQ").B200})`,iP=`var(--ds-background-selected-pressed, ${a("6fnsQ").B200})`,iB=`var(--ds-border-focused, ${a("aFUXX").akEditorTableBorderSelected})`,iW=`var(--ds-icon-subtle, ${a("6fnsQ").N300})`,iU=`var(--ds-background-accent-gray-subtlest, ${a("6fnsQ").N20A})`,iH=`var(--ds-blanket-danger, ${a("aFUXX").akEditorTableCellBlanketDeleted})`,iF=`var(--ds-border-danger, ${a("6fnsQ").R400})`,iz=`var(--ds-background-danger-pressed, ${a("6fnsQ").R75})`,iV=`var(--ds-background-danger-bold, ${a("6fnsQ").R300})`,iG=a("aFUXX").akEditorTableToolbarSize,ij=a("1zav4").tableMarginTop+8-a("1zav4").tableCellBorderWidth,iK=10*a("aFUXX").akEditorUnitZIndex,i$=iK+1,iX=10*a("aFUXX").akEditorUnitZIndex,iZ=iK+a("aFUXX").akRichMediaResizeZIndex,iq=iZ+2,iY=a("aFUXX").akEditorTableCellOnStickyHeaderZIndex-5,iQ=iY+1,iJ=iY-1,i0=e=>{let{selection:t}=e.state,i=[],o=(0,a("id9O1").findTable)(t);if(o){let t=a("LmqWp").TableMap.get(o.node),n=e.domAtPos.bind(e);i=Array.from({length:t.width});for(let e=0;e<t.width;e++)if(!t.isCellMergedTopLeft(0,e)){let a=o.node.nodeAt(t.map[e]),r=t.map[e]+o.start,l=(0,u.findDomRefAtPos)(r,n),s=l.getBoundingClientRect();i[e]=(s?s.width:l.offsetWidth)+1,e+=a.attrs.colspan-1}}return i},i1=(e,t)=>{let i=(0,a("iP1et").getSelectionRect)(t);if(!i)return null;let o=0,n=0;for(let t=0;t<i.left;t++){let i=e[t];i&&(n+=i-1)}let r=[];for(let t=i.left;t<i.right;t++){let i=e[t];i&&(o+=i,r.push(t))}return{left:n+o/2-8,indexes:r}},i2=(e,t)=>{let i=0,o=[];return e.forEach(e=>{let n=t.slice(i,i+e).reduce((e,t)=>e+t,0);i+=e,o.push(n)}),o},i9=({width:e,colspan:t,colwidth:i})=>{if(1===t||!i)return Array(t).fill(e/t);let o=i.split(",").map(e=>Number(e)),n=o.reduce((e,t)=>e+t,0);return o.map(t=>t/n*e)},i4=e=>{let t=(0,a("4vlwG").maphElem)(e,e=>Number(e.getAttribute("colspan")||1)),i=e.nextElementSibling||e;if(i){let e=(0,a("4vlwG").maphElem)(i,e=>({width:e.getBoundingClientRect().width,colspan:Number(e.getAttribute("colspan")||1),colwidth:e.dataset.colwidth})),o=[];if(e.map(e=>{o.push(...i9(e))}),0!==e.reduce((e,t)=>e+t.width,0))return i2(t,o).map(e=>`${e}px`).join(" ")}let o=t.reduce((e,t)=>e+t,0);return t.map(e=>e/o*100).map(e=>`${e}%`).join(" ")},i5=(e,t,i)=>{let o=i.width,n=i.map,a=0;if(0===t){for(let t=0;t<o;t++)if((0===t||n[t]!==n[t-1])&&a++,a-1===e)return t}else for(let i=0;i<o;i++){let r=t*o+i,l=(t-1)*o+i;if(i>0?n[r]!==n[r-1]&&n[r]!==n[l]&&a++:n[r]!==n[l]&&a++,a-1===e)return i}return 0},i3=(e,t,i)=>{let o=i.width,n=i.map,a=[],r=0,l=0;if(0===t)return e;for(let e=0;e<o;e++)0===e||n[e]!==n[e-1]?(l>0&&(r+=l,l=0),r++):n[e]===n[e-1]&&l++,a[e]=r-1;return a[e]},i8=e=>{let t=[],i=e.querySelector("tbody");if(i){let e=i.childNodes;for(let i=0,o=e.length;i<o;i++){let o=e[i];if(t[i]=o.getBoundingClientRect().height+1,o.classList.contains("sticky")&&0===i){let e=window.getComputedStyle(o),n=(0,a("4vlwG").parsePx)(e.paddingTop||"");t[i]-=n?n+1:1}}}return t},i6=(e,t,i=0)=>{let o=(0,a("iP1et").getSelectionRect)(t);if(!o)return null;let n=0,r=i;for(let t=0;t<o.top;t++){let i=e[t];i&&(r+=i-1)}let l=[];for(let t=o.top;t<o.bottom;t++){let i=e[t];i&&(n+=i-1,l.push(t))}return{top:r+n/2-8,indexes:l}},i7=e=>{let t=[];for(let i=0,o=e.length;i<o;i++){let o=e[i];if(!o)continue;let n=e.length;for(let t=i+1,o=e.length;t<o;t++)if(e[t]){n=t;break}t.push({startIndex:i,endIndex:n,height:o})}return t},oe=(e,t,i=[],o,n)=>{let r=[];return((0,a("iYC9s").isRowSelected)(e)(t)||i.indexOf(e)>-1&&!n)&&(r.push(eu.HOVERED_CELL_ACTIVE),o&&r.push(eu.HOVERED_CELL_IN_DANGER)),r.join(" ")},ot=e=>t=>i=>{let o=(0,a("id9O1").findTable)(i.selection);if(!o)return i;let n=a("LmqWp").TableMap.get(o.node),r=t-1;if(t<=0)throw Error("Row Index less or equal 0 isn't not allowed since there is not a previous to copy");if(t>n.height)return i;let l=o.node,{nodes:{tableRow:s}}=e,d=n.cellsInRect({left:0,right:n.width,top:r,bottom:r+1}),c=r*n.width,p=t*n.width,h=n.map.slice(c,c+n.width),m=n.map.slice(p,p+n.width),f=[],g=[];for(let e=0;e<h.length;){let t=h[e],n=t+o.start,a=i.doc.nodeAt(n);if(!a)continue;let r={...a.attrs,colspan:1,rowspan:1},l=a.type.createAndFill(r);if(!l)return i;if(m.indexOf(t)>-1)g.push({pos:n,node:a});else if(d.indexOf(t)>-1){if(a.attrs.colspan>1){let t=a.type.createAndFill({...r,colspan:a.attrs.colspan});if(!t)return i;f.push(t),e+=a.attrs.colspan;continue}f.push(l)}else f.push(l);e++}g.forEach(e=>{i.setNodeMarkup(e.pos,void 0,{...e.node.attrs,rowspan:e.node.attrs.rowspan+1})});let b=l.child(r),E=o.start;for(let e=0;e<t;e++)E+=l.child(e).nodeSize;return(0,u.safeInsert)(s.createChecked(b.attrs,f,b.marks),E)(i)},oi=()=>e=>{let{tableRef:t}=tg(e);if(!t||!t.querySelector("tr"))return;let i=t.parentElement;if(!(i&&i.parentElement))return;let o=i.parentElement.querySelectorAll(`.${eu.ROW_CONTROLS_BUTTON_WRAP}`),n=i.parentElement.querySelectorAll(eu.NUMBERED_COLUMN_BUTTON);ol(t);let a=i8(t);for(let e=0,t=o.length;e<t;e++){let t=a[e];t&&(o[e].style.height=`${t}px`,n.length&&(n[e].style.height=`${t}px`))}},oo=(e,t)=>{let i=t.x-e.clientX,o=t.y-e.clientY;return i*i+o*o<100},on=(e,t)=>{let i=t.target;if(!(0,a("4vlwG").containsClassName)(i,eu.RESIZE_HANDLE_DECORATION))return null;let o=(0,a("4vlwG").closestElement)(i,"td, th");return o?e.posAtDOM(o,0)-1:null},oa=e=>{let t=e.querySelector("tr.sticky");if(!t){e.style.marginTop="";return}let i=(0,a("4vlwG").parsePx)(window.getComputedStyle(t).paddingTop||"")||0,o=t.getBoundingClientRect().height-i-a("1zav4").tableCellBorderWidth;e.style.marginTop=`${a("1zav4").tableMarginTop+o}px`},or=(e,t)=>{let i=i4(t);i&&(t.style.gridTemplateColumns=i)},ol=e=>{if(!e)return;let t=e.querySelector("tr[data-header-row]");t&&(or(e.querySelector("colgroup"),t),os(e,t))},os=(e,t)=>{let i=e.querySelector("tbody"),o=e.parentElement;if(i&&o){let e=Math.min(i.offsetWidth+1,o.offsetWidth);t.style.width=`${e}px`,t.scrollLeft=o.scrollLeft}},od=({minWidth:e,maxSize:t,table:i,tableRef:o,start:n,domAtPos:r,isTableScalingEnabled:l=!1,shouldUseIncreasedScalingPercent:s=!1,isCommentEditor:d=!1})=>{if(l&&!d||l&&d&&i.attrs?.width){let t=U(i,o,s);e=Math.ceil(e/t)}if($(i)){let o=(0,a("caYZ2").calcTableColumnWidths)(i).map((t,i)=>({width:0===t?a("1zav4").tableNewColumnMinWidth:t,minWidth:0===t?a("1zav4").tableNewColumnMinWidth:e,index:i})),n=o.map(e=>e.width),r=n.reduce((e,t)=>e+t,0);return{cols:o,widths:n,maxSize:t,tableWidth:r,overflow:r>t,isScaled:l}}let c=K(o,i,l,!l,s,d),p=Array.from(c).map((o,s)=>l?{index:s,width:(d&&!i.attrs?.width?t:(0,a("6fQl1").getTableContainerWidth)(i))/c.length,minWidth:e}:tC(tS(s,i,n,r),s,e)),u=p.map(e=>e.width),h=u.reduce((e,t)=>e+t,0);return{cols:p,widths:u,maxSize:t,tableWidth:h,overflow:h>t,isScaled:l}},oc=(e,t,i,o,n)=>{let r=t?.querySelectorAll(":scope > colgroup > col"),l=r?.length;o&&i?e.cols.filter(e=>e&&!!e.width).forEach((e,t)=>{let i=Math.max(z(e.width,l??0)*(n||1),a("1zav4").tableCellMinWidth);r?.[t]&&(r[t].style.width=`${i}px`)}):e.cols.filter(e=>e&&!!e.width).forEach((e,t)=>{r?.[t]&&(r[t].style.width=`${z(e.width,l??0)}px`)}),ol(t)},op=({cols:e})=>e.reduce((e,t)=>e+t.width,0),ou=(e,t)=>{let i=t-op(e);if(i>0||i<0&&Math.abs(i)<a("1zav4").tableCellMinWidth){let t=!1;return{...e,cols:e.cols.map(e=>!t&&e.width+i>e.minWidth?(t=!0,{...e,width:e.width+i}):e)}}return e},oh=e=>{let t=op(e),i=Math.floor(t/e.cols.length),o=e.cols.map(e=>({...e,width:i}));return ou({...e,cols:o},t)},om=(e,t,i)=>e.slice(t,i).map(e=>e.width).reduce((e,t)=>e+t,0),of=(e,t)=>{let i=e.cols,o=om(i,t.left,t.right),n=om(i,0,i.length)/i.length,a=o/(t.right-t.left);return n===a?{...e,widths:i.map(()=>a),cols:e.cols.map(e=>({...e,width:0}))}:{...e,widths:i.map((e,i)=>i>=t.left&&i<t.right?a:e.width),cols:i.map((e,i)=>({...e,width:i>=t.left&&i<t.right?a:e.width}))}},og=(e,t,i)=>{let o=op(e),n=t.indexOf(i)>-1?i:i+1,a=e.cols[n],r={},l=[],s=e.cols.map(e=>{if(t.indexOf(e.index)>-1){let t=e.width-a.width;return 0!==t&&l.push(t),{...e,width:a.width}}return e}),d={...e,cols:s.map(e=>{if(t.indexOf(e.index)>-1||t.indexOf(i)>-1&&e.index<n)return e;for(;l.length;){let t=l.shift()||0,i=r[e.index]||e,o=i.width+t;if(o>i.minWidth)r[i.index]={...i,width:o};else{l.push(o-i.minWidth),r[i.index]={...i,width:i.minWidth};break}}return r[e.index]||e})},c=e.maxSize,p=op(d);if(t.length===e.cols.length&&p<c)if(o===c)return e;else{let t=Math.floor((c-a.width)/(d.cols.length-1));d={...e,cols:d.cols.map(e=>e.index===a.index?e:{...e,width:t})}}return ou(d,e.maxSize)},ob=e=>{switch(e){case"wide":case"full-width":return e;default:return"default"}},oE=(e,t,i,o,n=!1,r=!1,l=!1)=>{if(e.right-e.left<=1)return;let{totalRowCount:s,totalColumnCount:d,table:c}=iC(t.selection);if(!c||!$(c.node))return;let p=i(c.start).node,u=p instanceof HTMLElement?p:null,h=u?.closest("table");if(!h)return;let m=ob(h?.dataset.layout),f=L({table:c.node,tableStart:c.start,state:t,layout:m,getEditorContainerWidth:o}),g=n,b=n&&r;b&&(g="fixed"!==c.node.attrs.displayMode);let E=b;n&&l&&(g=!0,E=!0);let T=od({minWidth:a("1zav4").tableCellMinWidth,maxSize:f,table:c.node,tableRef:h,start:c.start,domAtPos:i,isTableScalingEnabled:g,shouldUseIncreasedScalingPercent:E,isCommentEditor:l}),C=of(T,e),_=T.widths,S=C.widths;return{resizeState:C,table:c,changed:T.widths.some((e,t)=>e!==S[t]),attributes:{position:e.left,count:e.right-e.left,totalRowCount:s,totalColumnCount:d,widthsBefore:_,widthsAfter:S}}},oT=(e,t,i,o)=>{if(!e.cols[t]||!e.cols[t+1])return e;let n=oS(e,t+1,t,i),a=i-n.amount,r=n.state;return(a>0&&(r=ow(r,t,a).state),o&&o.length>1)?og(r,o,t):r},oC=(e,t,i,o)=>{if(!e.cols[t])return e;let n=oS(e,t,t+1,-i),a=n.state,r=op(a)>a.maxSize;if(!a.cols[t+1]&&!r)return a;let l=i+n.amount;return(l<0&&(a=ow(a,t+1,l).state),o&&o.length>1)?og(a,o,t):a};var o_=((l=o_||{}).SOURCE="src",l.DEST="dest",l);function oS(e,t,i,o,n=!0){let a=e.cols[t],r=e.cols[i];if(n){let e=t_(a);ov("dest")(o)>e&&(o=o>0?e:-e)}0>ov("src")(o)&&oO("src")(o,a,r)<a.minWidth&&(o=a.width-a.minWidth);let l=r?{...r,width:oO("dest")(o,a,r)}:void 0;if(!l&&0>ov("src")(o)){let t=op(e);t-a.width+oO("src")(o,a,r)<e.maxSize&&(o=e.maxSize-(t-a.width)-a.width-1)}let s={...a,width:oO("src")(o,a,r)},d=e.cols.map((e,o)=>o===t?s:o===i?l:e).filter(Boolean);return{state:{...e,cols:d},amount:o}}function ow(e,t,i){let o=function(e,t,i){let o=e.cols;return i<0?o.slice(0,t):o.slice(t+1)}(e,t,i);for(;o.length&&i;){let n=function(e,t){if(0===e.length)return -1;"left"==(t<0?"left":"right")&&(e=e.slice().reverse());let i=-1;return(e.forEach(e=>{t_(e)&&-1===i&&(i=e.index)}),-1===i)?-1:i}(o,i);if(-1===n){if(i>0)return{state:{...e,cols:[...e.cols.slice(0,t),{...e.cols[t],width:e.cols[t].width+i},...e.cols.slice(t+1)]},remaining:i};break}let a=o.find(e=>e.index===n);if(!a||0>=t_(a))break;let r=oS(e,a.index,t,i);e=r.state,i-=r.amount,o=o.filter(e=>e.index!==n)}return{state:e,remaining:i}}function ov(e){return t=>"src"===e?t>0?-t:t:t<0?-t:t}function oO(e){return(t,i,o)=>("src"===e?i:o).width+ov(e)(t)}let oy=(e,t,i,o=!1,n=!1,r=!1)=>{let{node:l,containerWidth:s,previousContainerWidth:d,prevNode:c,start:p,layoutChanged:u,isTableResizingEnabled:h}=t,m=h?(0,a("6fQl1").getTableContainerWidth)(l):x(l.attrs.layout,s,{}),f=e8(c),g=h?(0,a("6fQl1").getTableContainerWidth)(l):x(c.attrs.layout,d,{}),b=m;return u&&f>g&&(b=f<m?m:Math.floor(f/g*b)),l.attrs.isNumberColumnEnabled&&(b-=a("aFUXX").akEditorTableNumberColumnWidth),oR(od({minWidth:a("1zav4").tableCellMinWidth,maxSize:m,table:l,tableRef:e,start:p,domAtPos:i,isTableScalingEnabled:o,shouldUseIncreasedScalingPercent:n,isCommentEditor:r}),b)},oN=(e,t,i,o,n,r=!1,l=!1,s=!1)=>{let d=od({minWidth:a("1zav4").tableCellMinWidth,maxSize:t,table:i,tableRef:e,start:o,domAtPos:n,isTableScalingEnabled:r,shouldUseIncreasedScalingPercent:l,isCommentEditor:s});return i.attrs.isNumberColumnEnabled&&(t-=a("aFUXX").akEditorTableNumberColumnWidth),oR(d,Math.floor(t))};function oR(e,t){let i=t/op(e),o={...e,maxSize:t,cols:e.cols.map(e=>{let{minWidth:t,width:o}=e,n=Math.floor(o*i);return n<t&&(n=t),{...e,width:n}})},n=op(o);return n>t&&(o=function(e,t,i=[]){let o=t;for(;o>0;){let t=e.cols.filter(e=>t_(e)&&-1===i.indexOf(e.index));if(0===t.length)break;let n=Math.floor(o/t.length);if(0===n)break;t.forEach(t=>{let i=t.width-n;if(i<t.minWidth){let e=t.minWidth-i;i=t.minWidth,o=o-n+e}else o-=n;e={...e,cols:[...e.cols.slice(0,t.index),{...t,width:i},...e.cols.slice(t.index+1)]}})}return e}(o,n-t)),ou(o,t)}let ox=(e,t,i,o=!1,n=!1,r=!1)=>{let{node:l,start:s,parentWidth:d}=t;if(!e)return;if(d){let t=l.attrs.isNumberColumnEnabled?d-a("aFUXX").akEditorTableNumberColumnWidth:d;e.style.width=`${t}px`}let c=o,p=o&&n;if(p&&(c=o&&"fixed"!==l.attrs.displayMode),!$(l)&&!c)return void ol(e);let u=p||o&&r,h=d?oN(e,d,l,s,i,!1,u):oy(e,t,i,!1,u);h&&oc(h,e,l,!1,1)},oA=(e,t,i,o,n=!1,a=!1,r=!1)=>l=>{let s;if(!e)return l;let{node:d,start:c,parentWidth:p,layoutChanged:u}=t;return!1===$(d)?(n||K(e,d,!1,void 0,a,r),l.setMeta("scrollIntoView",!1)):(s=p?oN(e,p,d,c,i,n,a):oy(e,t,i,n,a))&&(l=oI(s,d,c,o)(l)).docChanged&&(l.setMeta("scrollIntoView",!1),u||l.setMeta("scaleTable",!0)),l},oI=(e,t,i,o)=>n=>{let r=a("LmqWp").TableMap.get(t),l={},s=[];for(let i=0;i<r.width;i++)for(let o=0;o<r.height;o++){let{width:n}=e.cols[i];e.isScaled&&(n=Math.floor(n));let a=o*r.width+i,s=r.map[a],d=l[s]||{...t.nodeAt(s).attrs},c=d.colspan||1;if(d.colwidth&&d.colwidth.length>c&&(d.colwidth=d.colwidth.slice(0,c)),o&&r.map[a]===r.map[a-r.width])continue;let p=1===c?0:i-r.colCount(s);if(d.colwidth&&d.colwidth[p]===n)continue;let u=d.colwidth?d.colwidth.slice():Array.from({length:c},e=>0);u[p]=n,u.length>c&&(u=u.slice(0,c)),l[s]={...d,colwidth:u.includes(0)?void 0:u}}let d={};for(let e=0;e<r.height;e++)for(let o=0;o<r.width;o++){let n=e*r.width+o,c=r.map[n],p=t.nodeAt(c);!d[c]&&p&&(l[c]&&s.push(new(0,a("aXG5V").AttrStep)(c+i,"colwidth",void 0===l[c].colwidth?null:l[c].colwidth)),d[c]=!0)}if(o?.batchAttributeUpdates){let e=o.batchAttributeUpdates.actions.batchSteps({steps:s,doc:n.doc});n.step(e)}else s.forEach(e=>{n.step(e)});return n},oL=(e=!1,t=!1,i=!1,o,n=!1)=>(r,l)=>s=>{if(!l)return s;let d=s.doc.nodeAt(r.pos),c=l.domAtPos.bind(l),p=c(r.start).node,u=p instanceof HTMLElement?p:null,h=u?.closest("table");if(!h||!d)return s;let m=$(r.node),f={width:0,possibleMaxWidth:0,isResized:m},g=l.state.doc.resolve(r.pos).depth,b=e&&0===g;b&&t&&(b="fixed"!==d.attrs.displayMode),f=b?{width:k(r.node),possibleMaxWidth:M(r.node),isResized:m}:{width:m?h.clientWidth-1:h.clientWidth,possibleMaxWidth:h?.parentElement?.clientWidth||0,isResized:m};let E={noOfColumns:a("LmqWp").TableMap.get(d).width};if(!E.noOfColumns||E.noOfColumns<=0)return s;let T=f.width/E.noOfColumns;if(!f.isResized&&T>a("1zav4").tableCellMinWidth)return s;let C=f.width>f.possibleMaxWidth;if(!f.isResized&&T<=a("1zav4").tableCellMinWidth||f.isResized&&Z(r.node)){let e=Array(E.noOfColumns).fill(a("1zav4").tableCellMinWidth);return oI({cols:e.map((e,t)=>({width:a("1zav4").tableCellMinWidth,minWidth:a("1zav4").tableCellMinWidth,index:t})),widths:e,maxSize:f.possibleMaxWidth,tableWidth:f.width,overflow:C},r.node,r.start,o)(s)}let _=od({minWidth:a("1zav4").tableCellMinWidth,table:r.node,start:r.start,tableRef:h,domAtPos:c,maxSize:f.possibleMaxWidth,isTableScalingEnabled:b,shouldUseIncreasedScalingPercent:i,isCommentEditor:n});return(!C&&_.overflow||_.tableWidth<_.maxSize)&&(_=oR(_,f.possibleMaxWidth)),oI(_,r.node,r.start,o)(s)},ok=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),oM=!1,oD={setStatic(e){oM=e},generate:()=>oM||ok()},oP=(e,t)=>t?e.createChecked(null,t):e.createAndFill(),oB=({schema:e,rowsCount:t=3,colsCount:i=3,withHeaderRow:o=!0,cellContent:n,tableWidth:r,layout:l})=>{let{cell:s,header_cell:d,row:c,table:p}=(0,a("d1kIV").tableNodeTypes)(e),u=[],h=[];for(let e=0;e<i;e++){let e=oP(s,n);if(e&&u.push(e),o){let e=oP(d,n);e&&h.push(e)}}let m=[];for(let e=0;e<t;e++)m.push(c.createChecked(null,o&&0===e?h:u));return p.createChecked({localId:oD.generate(),width:"inherit"===r?void 0:void 0===r?760:r,layout:l},m)},oW=({isTableScalingEnabled:e,isTableAlignmentEnabled:t,isFullWidthModeEnabled:i,isMaxWidthModeEnabled:o,isCommentEditor:n,isChromelessEditor:a,isTableResizingEnabled:r,isNestedTable:l,createTableProps:s})=>d=>{let c={};return l&&(c.rowsCount=s?.rowsCount?s?.rowsCount:2,c.colsCount=s?.colsCount?s?.colsCount:2),e&&!n&&(((0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&o?c.tableWidth=4e3:i&&(c.tableWidth=1800)),t&&(i||((0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&o||n)&&(c.layout="align-start"),(n&&r||a)&&(c.tableWidth="inherit"),oB({schema:d,...s,...c})};function oU(e){let t=tg(e);return!!t&&!!t.pluginConfig.allowAddColumnWithCustomStep}function oH(e,t=!1,i,o,n){return(r,l=!1,s)=>d=>{let c=d;if(l)c=(e=>{let t=(0,a("id9O1").findTable)(e.selection);return t?e.step(a("1rJN9").AddColumnStep.create(e.doc,t.pos,r)):e})(c);else c=iu(r)(c);let p=(0,a("id9O1").findTable)(c.selection);return p&&(c=oL(t,i,o,e,n)(p,s)(c)),s&&(c=ic({type:"column"},"addRowOrColumn")(s.state,c)),c.setMeta(iE.OVERFLOW_TRIGGER,{name:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.ADDED_COLUMN}),c}}let oF=(e,t=!1,i=!1,o=!1,n=!1)=>(r,l,s)=>{if(!(0,a("id9O1").findTable)(r.selection))return!1;if(l){let d=(0,a("2QyFu").selectedRect)(r);l(oH(e,t,i,o,n)(d.left,oU(r),s)(r.tr))}return!0},oz=(e,t,i,o,n)=>(r,l,s)=>{if(!(0,a("id9O1").findTable)(r.selection))return!1;if(l){let d=(0,a("2QyFu").selectedRect)(r);l(oH(e,t,i,o,n)(d.right,oU(r),s)(r.tr))}return!0},oV=(e,t=!1,i,o,n)=>r=>(l,s,d)=>{let c=oH(e,t,i,o,n)(r,oU(l),d)(l.tr),p=(0,a("id9O1").findTable)(c.selection);if(!p)return!1;let u=a("LmqWp").TableMap.get(p.node).positionAt(0,r,p.node);return s&&s(c.setSelection(a("ks2lK").Selection.near(c.doc.resolve(p.start+u)))),!0},oG=(e,t)=>(i,o)=>{let n=e5(i.selection),r=n&&e>1||!n&&e>0;if(0===e&&n)return!1;let l=r?ot(i.schema)(e)(i.tr):ig(e,void 0)(i.tr),s=(0,a("id9O1").findTable)(l.selection);if(!s)return!1;if(o){let{selection:n}=i;if(t){let t=a("LmqWp").TableMap.get(s.node).positionAt(e,0,s.node);l.setSelection(a("ks2lK").Selection.near(l.doc.resolve(s.start+t)))}else l.setSelection(n.map(l.doc,l.mapping));ic({type:"row"},"addRowOrColumn")(i,l),o(l)}return!0},oj=({isTableScalingEnabled:e=!1,isTableAlignmentEnabled:t=!1,isFullWidthModeEnabled:i=!1,isMaxWidthModeEnabled:o=!1,isCommentEditor:n=!1,isChromelessEditor:r=!1,isTableResizingEnabled:l=!1,createTableProps:s={}},d,c)=>({tr:p})=>{let h,{schema:m}=p.doc.type,f=!1;if((0,u.hasParentNodeOfType)(m.nodes.table)(p.selection)&&(0,a("sxTNo").isNestedTablesSupported)(m)&&(0,a("dh538").fg)("platform_editor_use_nested_table_pm_nodes"))if((0,g.editorExperiment)("nested-tables-in-tables",!1,{exposure:!0})||(0,a("sxTNo").getParentOfTypeCount)(m.nodes.table)(p.selection.$from)>1){let e=(0,a("sxTNo").getPositionAfterTopParentNodeOfType)(m.nodes.table)(p.selection.$from);if(!e)return p;h=a("ks2lK").TextSelection.create(p.doc,e)}else f=!0;let b=oW({isTableScalingEnabled:e,isTableAlignmentEnabled:t,isFullWidthModeEnabled:i,isMaxWidthModeEnabled:o,isCommentEditor:n,isChromelessEditor:r,isTableResizingEnabled:l,isNestedTable:f,createTableProps:s})(m);return d?.contentInsertion?.commands?.insert({node:b,options:{selectNodeInserted:!1,analyticsPayload:c?{...c,attributes:{...c.attributes,localId:b.attrs.localId}}:void 0,insertAt:h}})({tr:p}),p},oK=(e={})=>e.advanced?{allowBackgroundColor:!0,allowColumnResizing:!0,allowHeaderColumn:!0,allowHeaderRow:!0,allowMergeCells:!0,allowNumberColumn:!0,permittedLayouts:"all",allowControls:!0,...e}:e;var o$=a("2v1PW"),oX=a("bSjaC"),oZ=a("4T4vf");let oq=e=>!!(e&&(["TH","TD"].indexOf(e.tagName)>-1||(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_HEADER_CELL}`)||(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_CELL}`))),oY=e=>(0,a("4vlwG").containsClassName)(e,eu.CONTROLS_CORNER_BUTTON),oQ=e=>(0,a("4vlwG").containsClassName)(e,eu.CONTROLS_INSERT_ROW)||(0,a("4vlwG").closestElement)(e,`.${eu.CONTROLS_INSERT_ROW}`)||(0,a("4vlwG").containsClassName)(e,eu.CONTROLS_BUTTON_OVERLAY)&&(0,a("4vlwG").closestElement)(e,`.${eu.ROW_CONTROLS}`),oJ=e=>[parseInt(e.getAttribute("data-start-index")||"-1",10),parseInt(e.getAttribute("data-end-index")||"-1",10)],o0=e=>(0,a("4vlwG").containsClassName)(e,eu.COLUMN_CONTROLS_DECORATIONS),o1=e=>(0,a("4vlwG").containsClassName)(e,eu.ROW_CONTROLS_BUTTON)||(0,a("4vlwG").containsClassName)(e,eu.NUMBERED_COLUMN_BUTTON),o2=e=>(0,a("4vlwG").containsClassName)(e,eu.RESIZE_HANDLE_DECORATION),o9=e=>(0,a("4vlwG").containsClassName)(e,eu.CONTROLS_BUTTON)||(0,a("4vlwG").containsClassName)(e,eu.ROW_CONTROLS_BUTTON_WRAP),o4=e=>(0,a("4vlwG").containsClassName)(e,eu.TABLE_CONTAINER)||(0,a("4vlwG").containsClassName)(e,eu.TABLE_NODE_WRAPPER),o5=e=>(0,a("4vlwG").containsClassName)(e,eu.DRAG_ROW_FLOATING_INSERT_DOT_WRAPPER),o3=e=>(0,a("4vlwG").containsClassName)(e,eu.DRAG_COLUMN_FLOATING_INSERT_DOT_WRAPPER),o8=e=>(0,a("4vlwG").containsClassName)(e,eu.DRAG_CORNER_BUTTON)||(0,a("4vlwG").containsClassName)(e,eu.DRAG_CORNER_BUTTON_INNER),o6=(e,t,i)=>{let o=e.target;if(o instanceof HTMLElement){let n=o.clientWidth,a=Number.isNaN(t)?e.offsetX:t;if(n<=0)return null;if(!i)return a/n>.5?"right":"left";if(a<=i)return"left";if(a>=n-i)return"right"}return null},o7=e=>{let t=e.target;if(t instanceof HTMLElement){let i=t.getBoundingClientRect();return i.height<=0?null:(e.clientY-i.top)/i.height>.5?"bottom":"top"}return null},ne=({columnEndIndexTarget:e,target:t})=>{let i=(0,a("4vlwG").closestElement)(t,"table");if(!i)return!1;let o=[`.${eu.RESIZE_HANDLE_DECORATION}`,`[data-end-index="${e}"]`],n=i.querySelectorAll(o.join(""));return!!n&&0!==n.length},nt=e=>{let t=e.parentElement;if(!t)return null;let i=t.parentElement;if(!i)return null;let o=i.parentElement;return o?{wrapper:o,table:i}:null},ni=e=>!e||e instanceof Window?0:e?.getBoundingClientRect?.()?.top??0,no=(e,t)=>{let i=document.elementsFromPoint(e,t).find(e=>"TD"===e.nodeName.toUpperCase()||"TH"===e.nodeName.toUpperCase()),o=i?.parentElement??void 0;if(Number.isFinite(o?.rowIndex)&&Number.isFinite(i?.cellIndex))return{row:o.rowIndex,col:i.cellIndex}},nn=(e,t,i)=>{if("column"===t){let t=Math.max(Math.min(e,i.width-1),0);return{left:t,right:t===e?t+1:t,top:0,bottom:i.height}}{let t=Math.max(Math.min(e,i.height-1),0);return{left:0,right:i.width,top:t,bottom:t===e?t+1:t}}},na=(e,t)=>i=>{let o=(0,a("id9O1").findTable)(i);if(!o)return!1;let n=a("LmqWp").TableMap.get(o.node),r=new Set,l=new Set;if(n.map.forEach(e=>{r.has(e)?l.add(e):r.add(e)}),!l.size)return!1;let s=(e,t)=>{let i=nn(e,t,n);if(!(i.left<i.right&&i.top<i.bottom))return[];let o=n.cellsInRect(i),a=[];return[...new Set(("column"===t?n.map.filter((t,i)=>i%n.width===e):n.map.filter((t,i)=>Math.floor(i/n.width)===e)).filter(e=>!o.includes(e)||l.has(e)))]},d=e.map(e=>s(e,t));return d[0].some(e=>d[1].includes(e))},nr=(e,t)=>{let i=(0,a("id9O1").findTable)(t);if(!i)return!1;let o=a("LmqWp").TableMap.get(i.node),{width:n}=o;if(n<=1||e<0||e>n-1)return!1;let{map:r}=o,l=0===e,s=e===n-1;for(let t=e;t<r.length;t+=n)if(!l&&r[t]===r[t-1]||!s&&r[t]===r[t+1])return!0;return!1},nl=(e,t)=>{let i=(0,a("id9O1").findTable)(t);if(!i)return!1;let o=a("LmqWp").TableMap.get(i.node),{height:n}=o;if(n<=1||e<0||e>n-1)return!1;let{map:r,width:l}=o,s=e*l,d=s+l-1,c=0===e,p=e===n-1;for(let e=s;e<=d;e++)if(!c&&r[e]===r[e-l]||!p&&r[e]===r[e+l])return!0;return!1},ns=(e,t)=>i=>{let o=(0,a("id9O1").findTable)(i);if(!o)return!1;let n=a("LmqWp").TableMap.get(o.node);return!!n.hasMergedCells()&&nd(e,n,t)},nd=(e,t,i)=>{let{mapByRow:o,mapByColumn:n}=t,a="row"===i?o:n,r="row"===i?t.width:t.height,l=Math.min(...e),s=Math.max(...e),d=!1,c=!1,p=!a[l-1]||!a[l],u=!a[s+1]||!a[s];if(l>0&&!p){let e=a[l-1],t=a[l];for(let i=0;i<r;i++)if(e[i]===t[i]){d=!0;break}}if(s<a.length-1&&!u){let e=a[s+1],t=a[s];for(let i=0;i<r;i++)if(e[i]===t[i]){c=!0;break}}return d||c},nc=e=>e?e.filter((t,i)=>e.indexOf(t)!==i):[],np={SET_DROP_TARGET:"SET_DROP_TARGET",CLEAR_DROP_TARGET:"CLEAR_DROP_TARGET",TOGGLE_DRAG_MENU:"TOGGLE_DRAG_MENU"};function nu(e,t,i){let o=0,n=e.nodeAt(t.map[0]);if(o|=n&&n.type===i.header_cell?1:0,t.width>1){let n=e.nodeAt(t.map[1]);o|=n&&n.type===i.header_cell?2:4*(1&o)}if(t.height>1){let n=e.nodeAt(t.map[t.width]);o|=n&&n.type===i.header_cell?4:2*(1&o)}return{rowHeaderEnabled:7===o||3===o,columnHeaderEnabled:7===o||5===o}}let nh=(e,t=e)=>i=>{let o,n=e,a=t;for(let t=e;t>=0;t--){let e=el(t)(i.selection);e&&e.forEach(e=>{let i=e.node.attrs.colspan+t-1;i>=n&&(n=t),i>a&&(a=i)})}for(let t=e;t<=a;t++){let e=el(t)(i.selection);e&&e.forEach(e=>{let i=e.node.attrs.colspan+t-1;e.node.attrs.colspan>1&&i>a&&(a=i)})}let r=[];for(let e=n;e<=a;e++){let t=el(e)(i.selection);t&&t.length&&r.push(e)}n=r[0],a=r[r.length-1];let l=el(n)(i.selection),s=es(0)(i.selection);if(!l||!s)return;let d=i.doc.resolve(l[l.length-1].pos);for(let e=a;e>=n;e--){let t=el(e)(i.selection);if(t&&t.length){for(let e=s.length-1;e>=0;e--)if(s[e].pos===t[0].pos){o=t[0];break}if(o)break}}if(o)return{$anchor:d,$head:i.doc.resolve(o.pos),indexes:r}},nm=(e,t)=>{let i=[],o=a("LmqWp").TableMap.get(e);for(let n=0;n<o.height;n++){let a=e.child(n),r=[];for(let i=0;i<o.width;i++){if(!t[n][i])continue;let a=o.map[n*o.width+i],l=t[n][i],s=e.nodeAt(a);if(!l||!s)continue;let d=s.type.createChecked(Object.assign({},l.attrs),l.content,l.marks);r.push(d)}i.push(a.type.createChecked(a.attrs,r,a.marks))}return e.type.createChecked(e.attrs,i,e.marks)},nf=e=>{let t=a("LmqWp").TableMap.get(e),i=[];for(let o=0;o<t.height;o++){let n=[],a={};for(let i=0;i<t.width;i++){let r=t.map[o*t.width+i],l=e.nodeAt(r),s=t.findCell(r);if(!l||a[r]||s.top!==o){n.push(null);continue}a[r]=!0,n.push(l)}i.push(n)}return i},ng=(e,t,i,o)=>{let n=e>t?-1:1,a=`Target position is invalid, you can't move the ${o} ${e} to ${t}, the target can't be split. You could use tryToFit option.`;if(1===n){if(-1!==i.slice(0,i.length-1).indexOf(t))throw Error(a)}else if(-1!==i.slice(1).indexOf(t))throw Error(a);return!0},nb=(e,t,i,o,n={tryToFit:!1,direction:0,selectAfterClone:!1})=>r=>{var l;let s=(0,a("id9O1").findTable)(r.selection);if(!s)return r;Array.isArray(t)||(t=[t]);let d=a("LmqWp").TableMap.get(s.node),c=nh(Math.min(...t),Math.max(...t))(r),p=nh(i)(r),u=c?.indexes??[],h=p?.indexes??[],m=u[0],f=u[u.length-1];!n.tryToFit&&h.length>1&&ng(t[0],i,h,"column");let g=(0,a("d1kIV").tableNodeTypes)(e.schema),b=function(e,t){let i=(t?.direction??0)<0?"start":"end";return t?.tryToFit&&t?.direction?i:e}(o,n),E=Math["start"===b?"min":"max"](...h),{rowHeaderEnabled:T,columnHeaderEnabled:C}=nu(s.node,d,g),_=(l=s,e=>{let t=l.node.nodeAt(e),i=e+l.start;return{pos:i,start:i+1,node:t,depth:l.depth+2}}),S=(0,a("8usfh").cloneTr)(r),w=[];for(let e=0;e<d.height;e++){w.push([]);for(let t=m;t<=f;t++){if(d.isCellMergedTopLeft(e,t))continue;let i=d.map[e*d.width+t];w[e].push(_(i))}if(C&&0===E&&"start"===b){let t=0===m?f+1:E,{pos:i,node:o}=_(d.map[e*d.width+t]);S.setNodeMarkup(i,0!==E||T&&0===e?g.header_cell:g.cell,o.attrs)}}if(w.forEach((e,t)=>{if(!e.length)return;let i=function(e,t,i){if(i.isCellMergedTopLeft(e,t)){for(let o=t-1;o>=0;o--)if(!i.isCellMergedTopLeft(e,o))return i.map[e*i.width+o];for(let o=t+1;o<i.width;o++)if(!i.isCellMergedTopLeft(e,o))return i.map[e*i.width+o]}return i.map[e*i.width+t]}(t,E,d),o=s.node.nodeAt(i),n=s.start+i,a="end"===b?S.mapping.map(n+o.nodeSize,1):S.mapping.map(n,-1);return S.insert(a,e.map(({node:e},i)=>(function(e,t,i,o){let n=t||i?o.header_cell:o.cell;return e.type!==n?n.create(e.attrs,e.content,e.marks):e})(e,T&&0===t,C&&0===E&&0===i&&"start"===b,g)))}),n.selectAfterClone){let e=+("end"===b),t=nh(E+e,E+e+u.length-1)(S);t&&S.setSelection(new(0,a("7XFGZ").CellSelection)(t.$anchor,t.$head))}return S},nE=(e,t=e)=>i=>{let o,n=e,a=t;for(let t=e;t>=0;t--){let e=es(t)(i.selection);e&&e.forEach(e=>{let i=e.node.attrs.rowspan+t-1;i>=n&&(n=t),i>a&&(a=i)})}for(let t=e;t<=a;t++){let e=es(t)(i.selection);e&&e.forEach(e=>{let i=e.node.attrs.rowspan+t-1;e.node.attrs.rowspan>1&&i>a&&(a=i)})}let r=[];for(let e=n;e<=a;e++){let t=es(e)(i.selection);t&&t.length&&r.push(e)}n=r[0],a=r[r.length-1];let l=es(n)(i.selection),s=el(0)(i.selection);if(!l||!s)return;let d=i.doc.resolve(l[l.length-1].pos);for(let e=a;e>=n;e--){let t=es(e)(i.selection);if(t&&t.length){for(let e=s.length-1;e>=0;e--)if(s[e].pos===t[0].pos){o=t[0];break}if(o)break}}if(o)return{$anchor:d,$head:i.doc.resolve(o.pos),indexes:r}},nT=(e,t,i,o,n={tryToFit:!1,direction:0,selectAfterClone:!1})=>r=>{let l=(0,a("id9O1").findTable)(r.selection);if(!l)return r;Array.isArray(t)||(t=[t]);let s=a("LmqWp").TableMap.get(l.node),[d,c]=t.reduce(([e,t],i)=>[Math.min(e,i),Math.max(t,i)],[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER]),p=nE(d,c)(r),u=nE(i)(r),h=p?.indexes||[],m=u?.indexes||[];if(d<0||d===Number.MAX_SAFE_INTEGER||c>=s.height||c===Number.MIN_SAFE_INTEGER)return r;!n.tryToFit&&m.length>1&&ng(d,i,m,"row");let f=(0,a("d1kIV").tableNodeTypes)(e.schema),g=function(e,t){let i=(t?.direction??0)<0?"start":"end";return t?.tryToFit&&t?.direction?i:e}(o,n),b=Math["start"===g?"min":"max"](...m),E=h.map(e=>s.positionAt(e,0,l.node)+l.pos).reduce((e,t)=>{let i=r.doc.nodeAt(r.mapping.map(t));return i?[...e,{pos:t,node:i}]:e},[]),T=s.positionAt(b,0,l.node)+l.pos,C=r.doc.nodeAt(r.mapping.map(T));if(E?.length&&C){let e=(0,a("8usfh").cloneTr)(r),{rowHeaderEnabled:t,columnHeaderEnabled:i}=nu(l.node,s,f);if(t&&0===b&&"start"===g){let t=s.positionAt(0===d?c+1:b,0,l.node)+l.pos,o=e.doc.nodeAt(e.mapping.map(t));o&&o.forEach((o,n,a)=>{let r=e.mapping.map(t+1+n);e.setNodeMarkup(r,0!==b||i&&0===a?f.header_cell:f.cell,o.attrs)})}let o="end"===g?e.mapping.map(T+C.nodeSize,1):e.mapping.map(T,-1);if(e.insert(o,E.map(({node:e},o)=>(function(e,t,i,o){let n=[];return e.forEach((e,a,r)=>{let l=t||i&&0===r?o.header_cell:o.cell;n.push(e.type!==l?l.create(e.attrs,e.content,e.marks):e)}),e.type.create(e.attrs,n,e.marks)})(e,t&&0===b&&0===o&&"start"===g,i,f))),n.selectAfterClone){let t=+("end"===g),i=nE(b+t,b+t+E.length-1)(e);i&&e.setSelection(new(0,a("7XFGZ").CellSelection)(i.$anchor,i.$head))}return e}return r};function nC(e,t,i){let o=(i?.direction??0)<0?"start":"end";return i?.tryToFit&&i?.direction?o:e<t?"end":"start"}let n_=(e,t,i,o={tryToFit:!1,direction:0,selectAfterMove:!1})=>n=>{var r;let l=(0,a("id9O1").findTable)(n.selection);if(!l)return n;Array.isArray(t)||(t=[t]);let s=a("LmqWp").TableMap.get(l.node),d=nh(Math.min(...t),Math.max(...t))(n),c=nh(i)(n),p=d?.indexes??[],u=c?.indexes??[],h=p[0],m=p[p.length-1];if(p.includes(i))return n;!o.tryToFit&&u.length>1&&ng(t[0],i,u,"column");let f=(0,a("d1kIV").tableNodeTypes)(e.schema),g=nC(h,i,o),b=Math["start"===g?"min":"max"](...u),{rowHeaderEnabled:E,columnHeaderEnabled:T}=nu(l.node,s,f),C=(r=l,e=>{let t=r.node.nodeAt(e),i=e+r.start;return{pos:i,start:i+1,node:t,depth:r.depth+2}}),_=(0,a("8usfh").cloneTr)(n),S=[];for(let e=0;e<s.height;e++){S.push([]);for(let t=h;t<=m;t++){if(s.isCellMergedTopLeft(e,t))continue;let i=s.map[e*s.width+t];S[e].push(C(i))}if(T&&(0===h||0===b)){let t=0===h?m+1:b,{pos:i,node:o}=C(s.map[e*s.width+t]);_.setNodeMarkup(i,0!==b||E&&0===e?f.header_cell:f.cell,o.attrs)}}if(S.forEach((e,t)=>{if(!e.length)return;let i=function(e,t,i){if(i.isCellMergedTopLeft(e,t)){for(let o=t-1;o>=0;o--)if(!i.isCellMergedTopLeft(e,o))return i.map[e*i.width+o];for(let o=t+1;o<i.width;o++)if(!i.isCellMergedTopLeft(e,o))return i.map[e*i.width+o]}return i.map[e*i.width+t]}(t,b,s),o=l.node.nodeAt(i),n=l.start+i,a="end"===g||s.isCellMergedTopLeft(t,b)?_.mapping.map(n+o.nodeSize,1):_.mapping.map(n,-1);_.insert(a,e.map(({node:e},i)=>(function(e,t,i,o){let n=t||i?o.header_cell:o.cell;return e.type!==n?n.create(e.attrs,e.content,e.marks):e})(e,E&&0===t,T&&0===b&&0===i,f)));let r=e[0],d=e[e.length-1];return _.delete(_.mapping.map(r.pos,1),_.mapping.map(d.pos+d.node.nodeSize,-1))}),o.selectAfterMove){let e=p.length-1,t=nh(b-("end"===g?e:0),b+("start"===g?e:0))(_);t&&_.setSelection(new(0,a("7XFGZ").CellSelection)(t.$anchor,t.$head))}return _},nS=(e,t,i,o={tryToFit:!1,direction:0,selectAfterMove:!1})=>n=>{let r=(0,a("id9O1").findTable)(n.selection);if(!r||(Array.isArray(t)||(t=[t]),t.includes(i)))return n;let l=a("LmqWp").TableMap.get(r.node),[s,d]=t.reduce(([e,t],i)=>[Math.min(e,i),Math.max(t,i)],[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER]),c=nE(s,d)(n),p=nE(i)(n),u=c?.indexes||[],h=p?.indexes||[];if(s<0||s===Number.MAX_SAFE_INTEGER||d>=l.height||d===Number.MIN_SAFE_INTEGER||i>=s&&i<=d)return n;!o.tryToFit&&h.length>1&&ng(s,i,h,"row");let m=(0,a("d1kIV").tableNodeTypes)(e.schema),f=nC(s,i,o),g=Math["start"===f?"min":"max"](...h),b=u.map(e=>l.positionAt(e,0,r.node)+r.pos).reduce((e,t)=>{let i=n.doc.nodeAt(n.mapping.map(t));return i?[...e,{pos:t,node:i}]:e},[]),E=l.positionAt(g,0,r.node)+r.pos,T=n.doc.nodeAt(n.mapping.map(E));if(b?.length&&T){let e=(0,a("8usfh").cloneTr)(n),{rowHeaderEnabled:t,columnHeaderEnabled:i}=nu(r.node,l,m);if(t&&(0===s||0===g)){let t=l.positionAt(0===s?d+1:g,0,r.node)+r.pos,o=e.doc.nodeAt(e.mapping.map(t));o&&o.forEach((o,n,a)=>{let r=e.mapping.map(t+1+n);e.setNodeMarkup(r,0!==g||i&&0===a?m.header_cell:m.cell,o.attrs)})}let c="end"===f?e.mapping.map(E+T.nodeSize,1):e.mapping.map(E,-1);if(e.insert(c,b.map(({node:e},o)=>(function(e,t,i,o){let n=[];return e.forEach((e,a,r)=>{let l=t||i&&0===r?o.header_cell:o.cell;n.push(e.type!==l?l.create(e.attrs,e.content,e.marks):e)}),e.type.create(e.attrs,n,e.marks)})(e,t&&0===g&&0===o,i,m))),o.selectAfterMove){let t=+("end"===f),i=nE(g+t,g+t+b.length-1)(e);i&&e.setSelection(new(0,a("7XFGZ").CellSelection)(i.$anchor,i.$head))}return b.forEach(({pos:t,node:i})=>{e.delete(e.mapping.map(t,1),e.mapping.map(t+i.nodeSize,-1))}),e}return n},nw={NONE:"none",ROW:"row",COLUMN:"column"},nv=new(0,a("ks2lK").PluginKey)("dragAndDropPlugin"),{createPluginState:nO,createCommand:ny,getPluginState:nN}=(0,a("lkJUe").pluginFactory)(nv,(e,t)=>{switch(t.type){case np.SET_DROP_TARGET:return{...e,decorationSet:t.data.decorationSet,dropTargetType:t.data.type,dropTargetIndex:t.data.index,isDragging:!0};case np.CLEAR_DROP_TARGET:return{...e,decorationSet:t.data.decorationSet,dropTargetType:nw.NONE,dropTargetIndex:0,isDragging:!1};case np.TOGGLE_DRAG_MENU:return{...e,isDragMenuOpen:t.data.isDragMenuOpen,dragMenuDirection:t.data.direction,dragMenuIndex:t.data.index,isKeyboardModeActive:t.data.isKeyboardModeActive};default:return e}},{mapping:(e,t)=>{if(e.docChanged){let i=t.decorationSet,o=e.getMeta(eh);return o&&o.data&&o.data.decorationSet&&(i=o.data.decorationSet),i&&(i=i.map(e.mapping,e.doc)),{...t,decorationSet:i}}return t}}),nR=e=>nv.getState(e)?.decorationSet||a("ftzrq").DecorationSet.empty,nx=(e,t,i)=>eO(e.doc,nR(e),t,i),nA=(e,t,i,o)=>ny(o=>{let{dropTargetType:n,dropTargetIndex:r}=nN(o);if(n===e&&r===t)return!1;let l=a("ftzrq").DecorationSet.empty;return"column"===e?l=nx(o,ex(t,o.selection,i),ep.COLUMN_INSERT_LINE):"row"===e&&(l=nx(o,eA(t,o.selection,i),ep.ROW_INSERT_LINE)),{type:np.SET_DROP_TARGET,data:{decorationSet:l,type:e,index:t}}},e=>(o||e).setMeta("addToHistory",!1)),nI=e=>ny(e=>{let{dropTargetType:t,dropTargetIndex:i}=nN(e);return(t!==nw.NONE||0!==i)&&{type:np.CLEAR_DROP_TARGET,data:{decorationSet:a("ftzrq").DecorationSet.empty}}},t=>(e||t).setMeta("addToHistory",!1)),nL=(e,t,i,o)=>ny(e=>({type:np.CLEAR_DROP_TARGET,data:{decorationSet:a("ftzrq").DecorationSet.empty}}),(n,a)=>{let r=o||n;return t.includes(i)?r.setMeta("addToHistory",!1):("table-row"===e?nS:n_)(a,t,i,{selectAfterMove:!0})(r)}),nk=(e,t,i,o="mouse")=>ny(n=>{let a,{isDragMenuOpen:r,dragMenuDirection:l,dragMenuIndex:s}=nN(n);return(r!==e||l!==t||s!==i)&&(a=void 0!==e?e:!0===r&&l!==t||!0===r&&l===t&&s!==i||!r,{type:np.TOGGLE_DRAG_MENU,data:{isDragMenuOpen:a,direction:t??l,index:i??s,isKeyboardModeActive:a&&"keyboard"===o}})},e=>e.setMeta("addToHistory",!1)),nM=(e,t,i,o,n)=>ny(e=>({type:np.CLEAR_DROP_TARGET,data:{decorationSet:a("ftzrq").DecorationSet.empty}}),(a,r)=>("table-row"===e?nT:nb)(r,t,i,o,{selectAfterClone:!0})(n||a));a("42omo");var nD=a("aaI8u");let nP=[];function nB(e){return(t,i)=>{let o,n,r=t.selection;if(r instanceof a("7XFGZ").CellSelection){if(r.$anchorCell.pos!==r.$headCell.pos)return!1;o=r.$anchorCell.nodeAfter,n=r.$anchorCell.pos}else{if(!(o=function(e){for(let t=e.depth;t>0;t--){let i=e.node(t).type.spec.tableRole;if("cell"===i||"header_cell"===i)return e.node(t)}return null}(r.$from)))return!1;let e=(0,a("3gZJH").cellAround)(r.$from);n=e&&e.pos}if(o&&1===o.attrs.colspan&&1===o.attrs.rowspan)return!1;if(o&&i){let l=o.attrs,s=[],d=l.colwidth;l.rowspan&&l.rowspan>1&&(l={...l,rowspan:1}),l.colspan&&l.colspan>1&&(l={...l,colspan:1});let c=(0,a("2QyFu").selectedRect)(t),p=t.tr;for(let e=0;e<c.right-c.left;e++)s.push(d?{...l,colwidth:d&&d[e]?[d[e]]:null}:l);let u=null;for(let t=c.top;t<c.bottom;t++){let i=c.map.positionAt(t,c.left,c.table);t===c.top&&(i+=o.nodeSize);for(let n=c.left,a=0;n<c.right;n++,a++){if(n===c.left&&t===c.top)continue;let r=e({node:o,row:t,col:n}).createAndFill(s[a]);r&&p.insert(u=p.mapping.map(i+c.tableStart,1),r)}}"number"==typeof n&&p.setNodeMarkup(n,e({node:o,row:c.top,col:c.left}),s[0]);let h=u&&p.doc.resolve(u);if(r instanceof a("7XFGZ").CellSelection&&h instanceof a("5SAOw").ResolvedPos){let e=new(0,a("7XFGZ").CellSelection)(p.doc.resolve(r.$anchorCell.pos),h);p.setSelection(e)}i(p)}return!0}}a("63Ztt").tableBackgroundColorPalette.forEach((e,t)=>{let i=e.toLowerCase().replace(" ","-"),o=(0,a("hMewq").default)(a("fWSjz").default,i);nP.push({value:t,label:e,border:a("63Ztt").tableBackgroundBorderColor,message:o})});let nW=(e,t)=>{let i=(0,a("d1kIV").tableNodeTypes)(e.schema);return nB(({node:e})=>i[e.type.spec.tableRole])(e,t)},nU=e=>{let t=(0,a("id9O1").findTable)(e.selection);if(!t)return[];let i=a("LmqWp").TableMap.get(t.node),o=new Set,n=[];return i.map.forEach(e=>{o.has(e)?n.push(e):o.add(e)}),n},nH=(e,t,i)=>{let{formatMessage:o}=i,n=a("LmqWp").TableMap.get(e),r=a("LmqWp").TableMap.get(t);if(r.width!==n.width){let e=Math.abs(r.width-n.width);if(r.width>n.width)return o(a("2CQVV").messages.columnsAreInserted,{count:e});if(r.width<n.width)return o(a("2CQVV").messages.columnsAreRemoved,{count:e})}if(r.height!==n.height){let e=Math.abs(r.height-n.height);if(r.height>n.height)return o(a("2CQVV").messages.rowsAreInserted,{count:e});if(r.height<n.height)return o(a("2CQVV").messages.rowsAreRemoved,{count:e})}return""},nF=e=>Array.from(Array(e).keys()),nz=()=>tf(e=>{let t=nU(e.tr);if(!t.length)return!1;let i=(0,a("id9O1").findTable)(e.tr.selection);return!!i&&{type:"HOVER_MERGED_CELLS",data:{decorationSet:tL(e,e_(t.map(e=>({pos:e+i.start,start:e+i.start+1,node:i.node.nodeAt(e)}))),ep.CELL_CONTROLS_HOVER)}}},e=>e.setMeta("addToHistory",!1)),nV=(e,t)=>tf(i=>{let o=el(e)(i.tr.selection),{isDragAndDropEnabled:n}=tg(i);if(!o)return!1;let a=eS(o,"column",i.tr,n,e,t);return{type:"HOVER_COLUMNS",data:{decorationSet:tL(i,a,ep.COLUMN_CONTROLS_HOVER),hoveredColumns:e,isInDanger:t}}},e=>e.setMeta("addToHistory",!1)),nG=(e,t)=>tf(i=>{let o=es(e)(i.selection);if(!o)return!1;let{isDragAndDropEnabled:n}=tg(i),a=eS(o,"row",i.tr,n,e,t);return{type:"HOVER_ROWS",data:{decorationSet:tL(i,a,ep.ROW_CONTROLS_HOVER),hoveredRows:e,isInDanger:t}}},e=>e.setMeta("addToHistory",!1)),nj=(e,t)=>tf(i=>{let o=(0,a("id9O1").findTable)(i.selection);if(!o)return!1;let n=a("LmqWp").TableMap.get(o.node),r=nF(n.width),l=nF(n.height),s=es(l)(i.selection);if(!s)return!1;let{isDragAndDropEnabled:d}=tg(i),c=eS(s,"table",i.tr,d,[],e,t);return{type:"HOVER_TABLE",data:{decorationSet:tL(i,c,ep.TABLE_CONTROLS_HOVER),hoveredColumns:r,hoveredRows:l,isInDanger:e,isWholeTableInDanger:e}}},e=>e.setMeta("addToHistory",!1)),nK=()=>tf(e=>({type:"CLEAR_HOVER_SELECTION",data:{decorationSet:tL(e,[],ep.ALL_CONTROLS_HOVER),isInDanger:!1,isWholeTableInDanger:!1}})),n$=e=>tf(t=>{let{isDragAndDropEnabled:i}=tg(t);return{type:"SHOW_RESIZE_HANDLE_LINE",data:{decorationSet:tL(t,eR(t.selection,e,i),ep.COLUMN_RESIZING_HANDLE_LINE)}}}),nX=()=>tf(e=>({type:"HIDE_RESIZE_HANDLE_LINE",data:{decorationSet:tL(e,[],ep.COLUMN_RESIZING_HANDLE_LINE)}})),nZ=e=>tf(()=>({type:"TABLE_HOVERED",data:{isTableHovered:e}}),e=>e.setMeta("addToHistory",!1)),nq=(e,t)=>tf(i=>{let{hoveredCell:o}=tg(i),n=void 0===e&&void 0===t,a=n?void 0:e??o.rowIndex,r=n?void 0:t??o.colIndex;return(a!==o.rowIndex||r!==o.colIndex)&&{type:"HOVER_CELL",data:{hoveredCell:{rowIndex:a,colIndex:r}}}},e=>e.setMeta("addToHistory",!1)),nY=e=>tf({type:"UPDATE_STATE",data:{element:void 0}},(t,i)=>e?(0,a("5GR8v").removeConnectedNodes)(i,e):t),nQ=(0,a("lkJUe").pluginFactory)(eY,(e,t)=>{switch(t.type){case"STOP_RESIZING":return{...e,resizeHandlePos:null,dragging:null};case"SET_RESIZE_HANDLE_POSITION":return{...e,resizeHandlePos:t.data.resizeHandlePos};case"SET_DRAGGING":return{...e,dragging:t.data.dragging};case"SET_LAST_CLICK":let{lastClick:i}=t.data;return{...e,lastClick:i,resizeHandlePos:i?e.resizeHandlePos:null};default:return e}},{mapping:function(e,t){return t&&null!==t.resizeHandlePos?{...t,resizeHandlePos:e.mapping.map(t.resizeHandlePos)}:t}}),nJ=nQ.createCommand,n0=nQ.createPluginState,n1=nQ.getPluginState,n2=({resizeState:e,table:t,start:i,event:o,api:n})=>(r,l)=>{if(!(0,a("iYC9s").isTableSelected)(r.selection))return!1;let{lastClick:s}=n1(r),d=Date.now();if(s&&d-s.time<500&&oo(o,s)){let o=oh(e);return n8(null,e=>oI(o,t,i,n)(e))(r,l),!0}return n8({x:o.clientX,y:o.clientY,time:d})(r,l),!1},n9=(e,t,i)=>(o,n)=>{if(n){let r=oI(e,t.node,t.start,i)(o.tr);r.setMeta(iE.OVERFLOW_TRIGGER,{name:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.DISTRIBUTED_COLUMNS}),n5(r)(o,n)}return!0},n4=e=>nJ({type:"SET_RESIZE_HANDLE_POSITION",data:{resizeHandlePos:e}}),n5=e=>nJ({type:"STOP_RESIZING"},t=>(e||t).setMeta("scrollIntoView",!1).setMeta("is-resizer-resizing",!1)),n3=(e,t)=>nJ({type:"SET_DRAGGING",data:{dragging:e}},e=>(t||e).setMeta("is-resizer-resizing",!0)),n8=(e,t)=>nJ({type:"SET_LAST_CLICK",data:{lastClick:e}},t);function n6(e){let{selection:t}=e;if(!(t instanceof a("7XFGZ").CellSelection)||t.$anchorCell.pos===t.$headCell.pos)return!1;let i=(0,a("iP1et").getSelectionRect)(t);if(!i)return!1;let o=t.$anchorCell.node(-1);return!function({width:e,height:t,map:i},o){let n=o.top*e+o.left,a=n,r=(o.bottom-1)*e+o.left,l=n+(o.right-o.left-1);for(let t=o.top;t<o.bottom;t++){if(o.left>0&&i[a]===i[a-1]||o.right<e&&i[l]===i[l+1])return!0;a+=e,l+=e}for(let a=o.left;a<o.right;a++){if(o.top>0&&i[n]===i[n-e]||o.bottom<t&&i[r]===i[r+e])return!0;n++,r++}return!1}(a("LmqWp").TableMap.get(o),i)}function n7(e){let{content:t}=e;return 1===t.childCount&&t.firstChild&&t.firstChild.isTextblock&&0===t.firstChild.childCount}function ae(e){let t=[],i=a("LmqWp").TableMap.get(e),o=function(e){let t=a("LmqWp").TableMap.get(e),i=new Set;for(let e=0;e<t.width;e++)t.cellsInRect({left:e,right:e+1,top:0,bottom:t.height}).length||i.add(e);return i}(e);if(0===o.size)return e;for(let n=0;n<i.height;n++){let a={};for(let t=i.width-1;t>=0;t--){let r=i.map[t+n*i.width],l=i.findCell(r),s=a[l.left]||e.nodeAt(r);if(l.top===n){if(o.has(t)){let{colspan:e,colwidth:t}=s.attrs;e>1&&(s=s.type.createChecked({...s.attrs,colspan:e-1,colwidth:t?t.slice(0,e):null},s.content,s.marks))}a[l.left]=s}}let r=Object.values(a),l=e.child(n);l&&t.push(l.type.createChecked(l.attrs,r,l.marks))}return t.length?e.type.createChecked(e.attrs,t,e.marks):null}let at=(e,t=!1)=>i=>{let o=(0,a("id9O1").findTable)(i.selection);if(!o)return i;let n=[],r=a("LmqWp").TableMap.get(o.node);for(let i=e.top;i<e.bottom;i++)if(t){let e=o.node.nodeAt(r.map[i*r.width]);e&&e.type!==e.type.schema.nodes.tableHeader&&n.push(i)}else n.push(i);if(!n.length)return i;let l=[],s={},d={};for(let e=0;e<r.height;e++){let t=[],i=o.node.child(e);for(let i=0;i<r.width;i++){let a=r.map[e*r.width+i],l=o.node.nodeAt(a);if(!l)continue;let c=r.cellsInRect({left:0,top:e,right:r.width,bottom:e+1});if(-1!==n.indexOf(e)||s[a])c.indexOf(a)>-1&&(d[a]=!0);else{if(c.indexOf(a)>-1){let i=0;if(n.forEach(t=>{e<t&&l.attrs.rowspan+e-1>=t&&(i+=1)}),i>0){let e=l.type.createChecked({...l.attrs,rowspan:l.attrs.rowspan-i},l.content,l.marks);t.push(e),s[a]=!0;continue}}else if(d[a]){let e={...l.attrs,colspan:1,rowspan:1};if(l.attrs.colwidth){let t=i>0?i-r.colCount(a):0;e.colwidth=l.attrs.colwidth.slice().splice(t,1)}let o=l.type.createChecked(e,l.type.schema.nodes.paragraph.createChecked(),l.marks);t.push(o);continue}s[a]||(s[a]=!0,t.push(l))}}t.length&&l.push(i.type.createChecked(i.attrs,t,i.marks))}if(!l.length)return i;let c=o.node.type.createChecked(o.node.attrs,l,o.node.marks),p=ae(c);if(null===p)return i;let u=function(e,t){let i=Math.min(...t),o=a("LmqWp").TableMap.get(e);return o.map[(i>0?i-1:0)*o.width]}(c,n);return i.setMeta(eh,{type:"CLEAR_HOVER_SELECTION",data:{isInDanger:!1,isWholeTableInDanger:!1}}),i.replaceWith(o.pos,o.pos+o.node.nodeSize,p).setSelection(a("ks2lK").Selection.near(i.doc.resolve(o.pos+u)))},ai=(e,t)=>i=>{if(e){let o=(0,a("d1kIV").tableNodeTypes)(t).cell.createAndFill();if(o&&!e.node.content.eq(o.content))return i.replaceWith(e.pos+1,e.pos+e.node.nodeSize,o.content),(0,a("8usfh").cloneTr)(i)}return i},ao=e=>(t,i)=>{let o,{tr:n}=t;if((0,a("BW42l").isSelectionType)(n.selection,"cell")){let e=n.selection;e.forEachCell((e,i)=>{let o=n.doc.resolve(n.mapping.map(i+1));n=ai((0,a("id9O1").findCellClosestToPos)(o),t.schema)(n)}),o=e.$headCell.pos}else if(e){let i=(0,a("id9O1").findCellClosestToPos)(n.doc.resolve(e+1));n=ai(i,t.schema)(n),o=i.pos}if(n.docChanged&&o){let e=n.doc.resolve(n.mapping.map(o)),t=a("ks2lK").Selection.findFrom(e,1,!0);return t&&n.setSelection(t),i&&i(n),!0}return!1},an=(e,t)=>{let i=e0(e.tr);return!!i&&(t&&t(i),!0)},aa=(e,t,i,o,n,a,r=!1,l=1)=>{let s=i;r&&(s=i/l);let d=s>0?oT(e,t,s,a):s<0?oC(e,t,s,a):e;return oc(d,o,n,r,l),d},ar=e=>{let t=[];for(let i=e.left;i<e.right;i++)t.push(i);return t},al=e=>{let t=[];for(let i=e.top;i<e.bottom;i++)t.push(i);return t},as=(e,t)=>tf(()=>e,e=>(t||e).setMeta("addToHistory",!1)),ad=(e,t,i,o)=>(n,a)=>{let r=n.tr,{pluginConfig:{allowColumnResizing:l},getIntl:s,isDragAndDropEnabled:d}=tg(n);if(!l)return!1;let c=e$(e,t,!0,s,o)({tr:r,decorationSet:eF(n)}),p=eO(r.doc,c,eR(n.selection,{right:t},d),ep.COLUMN_RESIZING_HANDLE_LINE);return as({type:"START_KEYBOARD_COLUMN_RESIZE",data:{resizeHandleRowIndex:e,resizeHandleColumnIndex:t,resizeHandleIncludeTooltip:!0,isKeyboardResize:!0,decorationSet:p}},r)(n,e=>{r=e}),r.setMeta(eY,{type:"SET_RESIZE_HANDLE_POSITION",data:{resizeHandlePos:i}}),!!a&&(a(r),!0)},ac=({ariaNotify:e,getIntl:t,nodeViewPortalProviderAPI:i})=>(o,n,r)=>{let{selection:l}=o,s=(0,a("BW42l").isSelectionType)(l,"cell")?(0,a("iP1et").getSelectionRect)(l):(0,a("id9O1").findCellRectClosestToPos)(l.$from),d=(0,a("id9O1").findCellClosestToPos)(l.$from);return e&&t&&e(t().formatMessage(a("2CQVV").messages.startedColumnResize),{priority:"important"}),!!s&&!!d&&!!r&&ad(s.top,s.right,d.pos,i)(o,n)},ap=({direction:e,ariaNotify:t,getIntl:i,nodeViewPortalProviderAPI:o})=>(n,r,l)=>{let{resizeHandlePos:s}=n1(n)||{};if(!s)return!1;let{selection:d}=n;if(!(0,a("id9O1").findCellClosestToPos)(d.$from))return!1;let c=n.doc.resolve(s);if(!c)return!1;let p=c.node(-1),u=(0,a("id9O1").findTableClosestToPos)(c),h=a("LmqWp").TableMap.get(p);if(!p||!u||!h)return!1;let m=h.findCell(c.pos-c.start(-1)),f=(0,a("3gZJH").nextCell)(c,"horiz",e);if(t&&i&&(1===e&&t(i().formatMessage(a("2CQVV").messages.focusedOtherResize,{direction:"right"}),{priority:"important"}),-1===e&&t(i().formatMessage(a("2CQVV").messages.focusedOtherResize,{direction:"left"}),{priority:"important"})),f){let e=f.pos-f.start(-1),t=h.findCell(e);return ad(t.top,t.right,f.pos,o)(n,r,l)}if(0===m.left){let e=h.positionAt(m.top,h.width-1,p)+u.start,t=n.doc.resolve(e);return ad(m.top,h.width,t.pos,o)(n,r,l)}if(h.width===m.right){let e=h.positionAt(m.top,0,p)+u.start,t=n.doc.resolve(e);return ad(m.top,1,t.pos,o)(n,r)}return!1},au=({stepSize:e,getEditorContainerWidth:t,isTableScalingEnabled:i,isTableFixedColumnWidthsOptionEnabled:o,isCommentEditor:n,ariaNotify:r,api:l,getIntl:s})=>(d,c,p)=>{let u=d.tr,{resizeHandlePos:h}=n1(d),m=(0,a("id9O1").findCellClosestToPos)(d.selection.$from);if(!p||!h||!m)return!1;let f=d.doc.resolve(h),g=f.start(-1),b=f.node(-1),E=a("LmqWp").TableMap.get(b),T=p.domAtPos.bind(p),C=E.colCount(f.pos-g)+(f.nodeAfter?f.nodeAfter.attrs.colspan:1)-1,_=null,S=T(g);(_=S.node instanceof HTMLTableElement?S.node:null)&&"TABLE"!==_.nodeName&&(_=_.closest("table"));let w=m?.node.attrs;nJ({type:"SET_DRAGGING",data:{dragging:{startX:0,startWidth:I(p,m?.pos,w)}}})(d,e=>{u=e});let v=L({table:b,tableStart:g,state:d,layout:b.attrs.layout,getEditorContainerWidth:t}),O=i,y=i&&o;y&&(O="fixed"!==b.attrs.displayMode);let N=y;i&&n&&(O=!0,N=!0);let R=od({minWidth:a("1zav4").tableCellMinWidth,maxSize:v,table:b,tableRef:_,start:g,domAtPos:T,isTableScalingEnabled:O,shouldUseIncreasedScalingPercent:N,isCommentEditor:n});oi()(d);let x=(0,a("iP1et").getSelectionRect)(d.selection),A=x?ar(x):[],k=A.indexOf(C)>-1||A.indexOf(C+1)>-1,M=i&&n&&!b.attrs?.width?H(b,_):U(b,_,N),D=aa(R,C,e,_,b,k?A:void 0,i,M);return u=oI(D,b,g,l)(u),c&&c(u),r&&s&&(r(s().formatMessage(a("2CQVV").messages.changedColumnWidth,{width:Math.floor(D.cols[C].width)})),D.cols.length===C+1&&(!0===D.overflow&&r(s().formatMessage(a("2CQVV").messages.columnResizeLast),{priority:"important"}),!1===D.overflow&&r(s().formatMessage(a("2CQVV").messages.columnResizeOverflow),{priority:"important"}))),!0},ah=({ariaNotify:e,getIntl:t,originalTr:i})=>(o,n)=>{let r=i||o.tr,l=e=>{r=e},s=eX()({tr:r,decorationSet:eF(o)});return as({type:"STOP_KEYBOARD_COLUMN_RESIZE",data:{decorationSet:eO(r.doc,s,[],ep.COLUMN_RESIZING_HANDLE_LINE)}},r)(o,l),nJ({type:"STOP_RESIZING"},()=>r.setMeta("scrollIntoView",!1))(o,l),e&&t&&e(t().formatMessage(a("2CQVV").messages.columnResizeStop),{priority:"important"}),!!n&&(n(r),!0)},am=e=>t=>{let i=(0,a("id9O1").findTable)(t.selection);if(!i)return t;!function(e,t,i,o){let n=e.mapping.maps.length,r=e.doc.nodeAt(t);if(!r)return;let l=e.doc.resolve(t).start(1),s=a("LmqWp").TableMap.get(r);for(let t=i;t<o;t++)for(let i=0;i<s.height;i++){let o=i*s.width+t,a=s.map[o],d=t>0&&s.map[o-1]===a||i>0&&s.map[(i-1)*s.width+t]===a,c=t<s.width-1&&s.map[o+1]===a||i<s.height-1&&s.map[(i+1)*s.width+t]===a;if(!d&&c){let o=r.nodeAt(a);if(!o)continue;let{colwidth:d,colspan:c=1,rowspan:p=1}=o.attrs,u=e.mapping.slice(n),h={...o.attrs,colspan:1,rowspan:1};for(let a=i;a<i+p;a++)for(let i=0;i<c;i++){let c=e.mapping.slice(n),p=s.positionAt(a,t+i,r);e.insert(c.map(p+l),o.type.createAndFill({...h,colwidth:d?[d[i]]:void 0}))}u=e.mapping.slice(n),e.delete(u.map(a+l),u.map(a+l+o.nodeSize)),p&&p>1&&(i+=p-1)}}}(t,i.pos,e.left,e.right);let o=t.mapping.maps.length,n=t.doc,r=[];for(let l=e.left;l<e.right;l++){let e=a("1rJN9").AddColumnStep.create(n,i.pos,l,!0);r.push(l),t.step(e.map(t.mapping.slice(o)))}let l=t.mapping.mapResult(i.pos);if(l.deleted){let e=Math.min(l.pos,t.doc.nodeSize-1);t.setSelection(a("ks2lK").Selection.near(t.doc.resolve(e)))}else{let e=t.doc.nodeAt(l.pos);if(e){let o=ag(e,r);t.setSelection(a("ks2lK").Selection.near(t.doc.resolve(i.pos+o)))}}return t},af=e=>t=>{let i=(0,a("id9O1").findTable)(t.selection);if(!i)return t;let o=[];for(let t=e.left;t<e.right;t++)o.push(t);if(!o.length)return t;let n=a("LmqWp").TableMap.get(i.node),r=[],l={},s={};for(let e=0;e<n.height;e++){let t=[],a=i.node.child(e);for(let a=0;a<n.width;a++){let r=n.map[e*n.width+a],d=i.node.nodeAt(r);if(!d)continue;let c=n.cellsInRect({left:a,top:0,right:a+1,bottom:n.height});if(-1===o.indexOf(a)){if(c.indexOf(r)>-1&&!l[r]){let e=0;if(o.forEach(t=>{a<t&&d.attrs.colspan+a-1>=t&&(e+=1)}),e>0){let i={...d.attrs,colspan:d.attrs.colspan-e};if(d.attrs.colwidth){let t=Math.min(...o),a=t>0?t-n.colCount(r):0,l=d.attrs.colwidth.slice()||[];l.splice(a,e),i.colwidth=l}let a=d.type.createChecked(i,d.content,d.marks);t.push(a),l[r]=!0;continue}}else if(s[r]){let e={...d.attrs,colspan:1,rowspan:1};if(d.attrs.colwidth){let t=a>0?a-n.colCount(r):0;e.colwidth=d.attrs.colwidth.slice().splice(t,1)}let i=d.type.createChecked(e,d.type.schema.nodes.paragraph.createChecked(),d.marks);t.push(i);continue}l[r]||(l[r]=!0,t.push(d))}else c.indexOf(r)>-1&&(s[r]=!0)}t.length&&r.push(a.type.createChecked(a.attrs,t,a.marks))}if(!r.length)return t;let d=i.node.type.createChecked(i.node.attrs,r,i.node.marks),c=function(e){let t=a("LmqWp").TableMap.get(e),i=function(e){let t=[];for(let i=0;i<e.childCount;i++){let o=[],n=e.child(i);for(let e=0;e<n.childCount;e++){let t=n.child(e);o.push(t.attrs.rowspan)}t[i]=Math.min(...o)}return t}(e);if(!i.some(e=>e>1))return e;let o=[];for(let n=0;n<t.height;n++){let t=e.child(n);if(1===i[n])o.push(t);else{let e=[];for(let o=0;o<t.childCount;o++){let a=t.child(o),r=a.attrs.rowspan-i[n]+1;if(r<1)return null;let l=a.type.createChecked({...a.attrs,rowspan:r},a.content,a.marks);e.push(l)}o.push(t.type.createChecked(t.attrs,e,t.marks))}}return o.length?e.type.createChecked(e.attrs,o,e.marks):null}(d);if(null===c)return t;let p=ag(d,o);return t.replaceWith(i.pos,i.pos+i.node.nodeSize,c).setSelection(a("ks2lK").Selection.near(t.doc.resolve(i.pos+p)))};function ag(e,t){let i=Math.min(...t);return a("LmqWp").TableMap.get(e).map[i>0?i-1:0]}let ab=(e,t,i,o,n=!1,r=!1,l=!1,s=!1)=>d=>{let c=d;c.setMeta(iE.OVERFLOW_TRIGGER,{name:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.DELETED_COLUMN}),c=t?am(e)(c):af(e)(c);let p=(0,a("id9O1").findTable)(c.selection);return p&&(c=oL(n,r,l,i,s)(p,o)(c)),c},aE=(e,t,i=!1,o=!1,n=!1,a=!1)=>(r,l,s)=>{let d=ab(e,oU(r),t,s,i,o,n,a)(r.tr);return d.setMeta(eh,{type:"CLEAR_HOVER_SELECTION",data:{isInDanger:!1,isWholeTableInDanger:!1}}),!!l&&(l(d),!0)},aT=({tr:e})=>{let t=(0,a("id9O1").findTable)(e.selection);if(!t)return null;let{displayMode:i}=t.node.attrs;return e.setNodeMarkup(t.pos,e.doc.type.schema.nodes.table,{...t.node.attrs,displayMode:i&&"default"!==i?"default":"fixed"}),e.setMeta("scrollIntoView",!1)},aC=e=>{let{data:t}=e;if(t&&(t.name||t.title))return t.name||t.title;let{url:i}=e;return i},a_=(e,t=a("5rHEx").SortOrder.DESC)=>tf(()=>({type:"SORT_TABLE",data:{ordering:{columnIndex:e,order:t}}}),(i,o)=>{let n,r=(0,a("id9O1").findTable)(i.selection);if(!r||!r.node)return i;let l=(0,a("BW42l").isSelectionType)(i.selection,"cell")?(0,a("iP1et").getSelectionRect)(i.selection):(0,a("id9O1").findCellRectClosestToPos)(i.selection.$from);if(!l)return i;let s=tg(o),d=nf(r.node);s.isHeaderRowEnabled&&(n=d.shift());let c=(0,a("d4WtM").createCompareNodes)({getInlineCardTextFromStore:aC},t),p=d.sort((t,i)=>c(t[e],i[e]));n&&p.unshift(n);let u=nm(r.node,p);i.replaceWith(r.pos,r.pos+r.node.nodeSize,u);let h=a("LmqWp").TableMap.get(r.node).positionAt(l.top,e,r.node),m=s.ordering;return i.step(new(0,a("cCTpf").TableSortStep)(r.pos,m,{columnIndex:e,order:t})),i.setSelection(a("ks2lK").Selection.near(i.doc.resolve(r.start+h)))}),aS=(e,t)=>{let i=tg(e),{tableHeader:o,tableCell:n}=e.schema.nodes;return!t||nB(({row:e,col:t})=>0===e&&i.isHeaderRowEnabled||0===t&&i.isHeaderColumnEnabled?o:n)(e,t)},aw=(e,t)=>(0,a("2vynv").toggleHeader)("row")(e,i=>tf({type:"TOGGLE_HEADER_ROW"},()=>i.setMeta("scrollIntoView",!1))(e,t)),av=(e,t)=>(0,a("2vynv").toggleHeader)("column")(e,i=>tf({type:"TOGGLE_HEADER_COLUMN"},()=>i.setMeta("scrollIntoView",!1))(e,t)),aO=(e,t)=>{let{tr:i}=e,{node:o,pos:n}=(0,a("id9O1").findTable)(e.selection),r=o.attrs.isNumberColumnEnabled;i.setNodeMarkup(n,e.schema.nodes.table,{...o.attrs,isNumberColumnEnabled:!r}),i.setMeta("scrollIntoView",!1);let l=r?a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.DISABLED_NUMBERED_COLUMN:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.ENABLED_NUMBERED_COLUMN;return i.setMeta(iE.OVERFLOW_TRIGGER,{name:l}),t&&t(i),!0},ay=()=>tf({type:"TOGGLE_CONTEXTUAL_MENU"},e=>e.setMeta("addToHistory",!1)),aN=e=>(t,i)=>iS(({selection:e})=>{let{horizontalCells:i,verticalCells:o,totalRowCount:n,totalColumnCount:r}=i_(e);return{action:a("3824I").TABLE_ACTION.CLEARED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,horizontalCells:i,verticalCells:o,totalRowCount:n,totalColumnCount:r},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(ao(i)),aR=e=>t=>iS(({selection:e})=>{let{horizontalCells:i,verticalCells:o,totalCells:n,totalRowCount:r,totalColumnCount:l}=i_(e);return{action:a("3824I").TABLE_ACTION.MERGED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,horizontalCells:i,verticalCells:o,totalCells:n,totalRowCount:r,totalColumnCount:l},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((e,t)=>(t&&t(function(e){let t,{selection:i}=e;if(!(i instanceof a("7XFGZ").CellSelection)||!n6(e))return e;let o=(0,a("iP1et").getSelectionRect)(i),n=(0,a("id9O1").findTable)(i),r=a("LmqWp").TableMap.get(n.node),l=[],s=r.cellsInRect(o),d=[];for(let i=0;i<r.height;i++){let c=[],p=n.node.child(i);for(let d=0;d<r.width;d++){let p=r.map[i*r.width+d],u=n.node.nodeAt(p);if(!(!u||l.indexOf(p)>-1))if(l.push(p),d===o.left&&i===o.top){t=p;let i=n7(u)?a("5SAOw").Fragment.empty:u.content,l=[t];for(let e=o.top;e<o.bottom;e++)for(let t=o.left;t<o.right;t++){let o=r.map[e*r.width+t];if(-1===l.indexOf(o)){l.push(o);let e=n.node.nodeAt(o);e&&!n7(e)&&(i=i.append(e.content))}}let s=o.bottom-o.top;if(s<1)return e;let d=function(e,t,i=1){let o={...e,colspan:(e.colspan||1)+i};if(o.colwidth){o.colwidth=o.colwidth.slice();for(let e=0;e<i;e++)o.colwidth.splice(t,0,0)}return o}({...u.attrs,rowspan:s},u.attrs.colspan,o.right-o.left-u.attrs.colspan),h=i===a("5SAOw").Fragment.empty?u.type.createAndFill(d,i,u.marks):u.type.createChecked(d,i,u.marks);c.push(h)}else -1===s.indexOf(p)&&c.push(u)}if(c.length)d.push(p.type.createChecked(p.attrs,c,p.marks));else for(let t=d.length-1;t>=0;t--){let i=d[t],o=[],n=!1;for(let a=0;a<i.childCount;a++){let r=i.child(a),{rowspan:l}=r.attrs;if(l&&l+t-1>=d.length){if(n=!0,l<2)return e;o.push(r.type.createChecked({...r.attrs,rowspan:l-1},r.content,r.marks))}else o.push(r)}n&&(d[t]=p.type.createChecked(i.attrs,o,i.marks))}}if(!d.length)return e;let c=ae(n.node.type.createChecked(n.node.attrs,d,n.node.marks));return null===c?e:e.replaceWith(n.pos,n.pos+n.node.nodeSize,c).setSelection(a("ks2lK").Selection.near(e.doc.resolve((t||0)+n.start)))}(e.tr)),!0)),ax=e=>t=>iS(({selection:e})=>{let{totalRowCount:i,totalColumnCount:o}=i_(e),n=(0,a("id9O1").findCellClosestToPos)(e.$anchor);if(n){let{rowspan:e,colspan:r}=n.node.attrs;return{action:a("3824I").TABLE_ACTION.SPLIT,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,horizontalCells:r,verticalCells:e,totalCells:r*e,totalRowCount:i,totalColumnCount:o},eventType:a("d925B").EVENT_TYPE.TRACK}}})(e)(aS),aA=e=>(t,i,o)=>iS(({selection:e})=>{let{horizontalCells:o,verticalCells:n,totalCells:r,totalRowCount:l,totalColumnCount:s}=i_(e);return{action:a("3824I").TABLE_ACTION.COLORED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,cellColor:(a("63Ztt").tableBackgroundColorPalette.get(i.toLowerCase())||i).toLowerCase(),horizontalCells:o,verticalCells:n,totalCells:r,totalRowCount:l,totalColumnCount:s},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(tK({background:i},o)),aI=e=>t=>(i,o)=>{let{selection:n}=i,r=n instanceof a("7XFGZ").CellSelection,l=r?(0,a("iP1et").getSelectionRect)(n):(0,a("id9O1").findCellRectClosestToPos)(n.$from);if(!l)return!1;let s=r&&"TOP"===t?l.top:l.bottom-1;return aL(e)(a("d925B").INPUT_METHOD.SHORTCUT,{index:s+ +("BOTTOM"===t),moveCursorToInsertedRow:!1})(i,o)},aL=e=>(t,i)=>iS(e=>{let{totalRowCount:o,totalColumnCount:n}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.ADDED_ROW,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,position:i.index,totalRowCount:o,totalColumnCount:n},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(oG(i.index,i.moveCursorToInsertedRow)),ak=(e,t)=>(i,o,n,r,l,s,d,c)=>iS(e=>{let{table:t,totalRowCount:o,totalColumnCount:n}=iC(e.selection),{hoveredCell:{colIndex:r}}=tg(e);return{action:a("3824I").TABLE_ACTION.COLUMN_RESIZED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{colIndex:r,resizedDelta:i,isLastColumn:r===n-1,tableWidth:t?.node.attrs.width,inputMethod:s,totalRowCount:o,totalColumnCount:n}}})(e)(au({stepSize:i,getEditorContainerWidth:o,isTableScalingEnabled:n,isTableFixedColumnWidthsOptionEnabled:r,isCommentEditor:l,ariaNotify:d,getIntl:c,api:t})),aM=(e,t,i=!1,o=!1,n=!1,r=!1)=>(l,s)=>iS(e=>{let{totalRowCount:t,totalColumnCount:i}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.ADDED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:l,position:s,totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(t)(oV(e,i,o,n,r)(s)),aD=e=>(t,i,o)=>iS(({selection:e})=>{let{totalRowCount:o,totalColumnCount:n}=iC(e);return{action:a("3824I").TABLE_ACTION.DELETED_ROW,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,position:i.top,count:i.bottom-i.top,totalRowCount:o,totalColumnCount:n},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((e,t)=>(t&&t(at(i,o)(e.tr)),!0)),aP=(e,t,i=!1,o=!1,n=!1,r=!1)=>(l,s)=>iS(({selection:e})=>{let{totalRowCount:t,totalColumnCount:i}=iC(e);return{action:a("3824I").TABLE_ACTION.DELETED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:l,position:s.left,count:s.right-s.left,totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(aE(s,t,i,o,n,r)),aB=(e,t,i,o,n)=>(r,l)=>{let{selection:s}=r;if(!(s instanceof a("7XFGZ").CellSelection))return!1;let d=(0,a("iP1et").getSelectionRect)(s);if(!d)return!1;let c=tH(s);if("row"===c){let{pluginConfig:t}=tg(r),i=t.isHeaderRowRequired||!1;return aD(e)(a("d925B").INPUT_METHOD.SHORTCUT,d,i)(r,l)}return"column"===c&&aP(e,t,i,o,n)(a("d925B").INPUT_METHOD.SHORTCUT,d)(r,l)},aW=(e,t)=>{let{totalRowCount:i,totalColumnCount:o}=iC(e);return{action:a("3824I").TABLE_ACTION.DELETED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{inputMethod:t,totalRowCount:i,totalColumnCount:o},eventType:a("d925B").EVENT_TYPE.TRACK}},aU=e=>iS(({selection:e})=>aW(e,a("d925B").INPUT_METHOD.FLOATING_TB))(e)(tV),aH=e=>t=>iS(({selection:e})=>aW(e,t))(e)(tG),aF=e=>iS(e=>{let{totalRowCount:t,totalColumnCount:i}=iC(e.selection),{isHeaderRowEnabled:o}=tg(e);return{action:a("3824I").TABLE_ACTION.TOGGLED_HEADER_ROW,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{newState:!o,totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(aw),az=e=>iS(e=>{let{totalRowCount:t,totalColumnCount:i}=iC(e.selection),{isHeaderColumnEnabled:o}=tg(e);return{action:a("3824I").TABLE_ACTION.TOGGLED_HEADER_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{newState:!o,totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(av),aV=e=>iS(e=>{let{totalRowCount:t,totalColumnCount:i}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.TOGGLED_NUMBER_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{newState:!e3(e.selection),totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(aO),aG=e=>(t,i,o)=>iS(e=>{let{totalRowCount:n,totalColumnCount:r}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.SORTED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{inputMethod:t,totalRowCount:n,totalColumnCount:r,position:i,sortOrder:o,mode:"editor"},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(a_(i,o)),aj=(e,t)=>(i,{resizeState:o,table:n,attributes:r})=>iS(()=>({action:a("3824I").TABLE_ACTION.DISTRIBUTED_COLUMNS_WIDTHS,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:i,...r},eventType:a("d925B").EVENT_TYPE.TRACK}))(e)((e,i)=>(i&&n9(o,n,t)(e,i),!0)),aK=e=>iS(e=>{let{totalRowCount:t,totalColumnCount:i}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.COLLAPSED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{totalRowCount:t,totalColumnCount:i},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)(an),a$=(e,t)=>iS(e=>{let i,o,{table:n,totalRowCount:r,totalColumnCount:l}=iC(e.selection);switch(n?.node.attrs.displayMode){case"fixed":i=a("3824I").TABLE_DISPLAY_MODE.FIXED,o=a("3824I").TABLE_DISPLAY_MODE.DEFAULT;break;case"default":i=a("3824I").TABLE_DISPLAY_MODE.DEFAULT,o=a("3824I").TABLE_DISPLAY_MODE.FIXED;break;default:i=a("3824I").TABLE_DISPLAY_MODE.INITIAL,o=a("3824I").TABLE_DISPLAY_MODE.FIXED}return{action:a("3824I").TABLE_ACTION.CHANGED_DISPLAY_MODE,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{inputMethod:t,previousDisplayMode:i,newDisplayMode:o,tableWidth:n?.node.attrs.width,totalRowCount:r,totalColumnCount:l},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((0,a("gmyMu").editorCommandToPMCommand)(aT)),aX=(e,t)=>(i,o,n,r)=>iS(e=>{let{table:t,totalRowCount:l,totalColumnCount:s}=iC(e.selection);return{action:a("3824I").TABLE_ACTION.CHANGED_ALIGNMENT,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{tableWidth:t?.node.attrs.width,newAlignment:i,previousAlignment:"center"===o||"align-start"===o?o:null,totalRowCount:l,totalColumnCount:s,inputMethod:n,reason:r}}})(e)((0,a("gmyMu").editorCommandToPMCommand)(t3(i,t))),aZ=e=>(t,i,o,n,r)=>iS(()=>{let e=a("LmqWp").TableMap.get(o.node),l=e.height,s=e.width,d={tableWidth:o.node.attrs.width,newAlignment:t,previousAlignment:i,totalRowCount:l,totalColumnCount:s,inputMethod:n,reason:r};return{action:a("3824I").TABLE_ACTION.CHANGED_ALIGNMENT,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:d}})(e)((0,a("gmyMu").editorCommandToPMCommand)(t8(t,o))),aq=(0,a("ecnYn").xcss)({marginLeft:"space.100"}),aY=({alignmentButtons:e,dispatchCommand:t,areAnyNewToolbarFlagsEnabled:i})=>(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:aq},(0,a("9K4OG").jsx)(a("hArLp").default,null,e.map((e,o)=>{switch(e.type){case"separator":return(0,a("9K4OG").jsx)(a("faH35").default,{key:o,areAnyNewToolbarFlagsEnabled:i});case"button":let n=e.icon;return(0,a("9K4OG").jsx)(a("3P0Cg").default,{key:o,icon:e.icon?(0,a("9K4OG").jsx)(n,{label:e.title}):void 0,title:e.title,selected:e.selected,disabled:e.disabled,onClick:()=>{t(e.onClick)},areAnyNewToolbarFlagsEnabled:i})}}))),aQ=(e,i,{formatMessage:o},n,r=!1,l=!1)=>{let s="item-checkbox",d=[{id:"editor.table.lockColumnWidths",title:o(a("2CQVV").messages.lockColumnWidths),onClick:a$(n,a("d925B").INPUT_METHOD.FLOATING_TB),selected:l,hidden:!r,domItemOptions:{type:s}},{id:"editor.table.headerRow",title:o(a("2CQVV").messages.headerRow),onClick:aF(n),selected:i.isHeaderRowEnabled,hidden:!e.allowHeaderRow,domItemOptions:{type:s}},{id:"editor.table.headerColumn",title:o(a("2CQVV").messages.headerColumn),onClick:az(n),selected:i.isHeaderColumnEnabled,hidden:!e.allowHeaderColumn,domItemOptions:{type:s}},{id:"editor.table.numberedColumn",title:o(a("2CQVV").messages.numberedColumn),onClick:aV(n),selected:i.isNumberColumnEnabled,hidden:!e.allowNumberColumn,domItemOptions:{type:s}},{id:"editor.table.collapseTable",title:o(a("2CQVV").messages.collapseTable),onClick:aK(n),selected:!!i.isTableCollapsed,disabled:!i.canCollapseTable,hidden:!e.allowCollapse,domItemOptions:{type:s}}],c=r?192:void 0;return i.isDragAndDropEnabled?{id:"editor.table.tableOptions",type:"dropdown",testId:"table_options",icon:(0,a("dh538").fg)("platform-visual-refresh-icons")?void 0:t(a("isYda")),iconBefore:(0,a("dh538").fg)("platform-visual-refresh-icons")?t(a("isYda")):void 0,title:o(a("2CQVV").messages.tableOptions),hidden:d.every(e=>e.hidden),options:d,dropdownWidth:c}:{id:"editor.table.tableOptions",type:"dropdown",testId:"table_options",title:o(a("2CQVV").messages.tableOptions),hidden:d.every(e=>e.hidden),options:d,dropdownWidth:c}},aJ=(e,t,i,{formatMessage:o},n,r,l,s=!1,d=!1,c=!1,p=!1,u=!1)=>{let{top:h,bottom:m,right:f,left:g}=i,b=f-g,E=m-h,T=tg(e),C=[{id:"editor.table.insertColumn",title:o(a("2CQVV").messages.insertColumn),onClick:(e,t,i)=>{let o=a0(e),n=o?.right;return n&&aM(r,l,s,d,c,p)(a("d925B").INPUT_METHOD.FLOATING_TB,n)(e,t,i),!0},selected:!1,disabled:!1,elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").addColumnAfter))},{id:"editor.table.insertRow",title:o(a("2CQVV").messages.insertRow),onClick:(e,t)=>{let i=a0(e),o=i?.bottom;return o&&aL(l)(a("d925B").INPUT_METHOD.FLOATING_TB,{index:o,moveCursorToInsertedRow:!0})(e,t),!0},selected:!1,disabled:!1,elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").addRowAfter))},{id:"editor.table.removeColumns",title:o(a("2CQVV").messages.removeColumns,{0:b}),onClick:(e,t,i)=>{let o=a0(e);return o&&aP(l,r,s,d,c,p)(a("d925B").INPUT_METHOD.FLOATING_TB,o)(e,t,i),!0},onFocus:re,onBlur:nK(),onMouseOver:re,onMouseLeave:nK(),selected:!1,disabled:!1},{id:"editor.table.removeRows",title:o(a("2CQVV").messages.removeRows,{0:E}),onClick:(e,t)=>{let i=a0(e);return i&&aD(l)(a("d925B").INPUT_METHOD.FLOATING_TB,i,!1)(e,t),!0},onFocus:a7,onBlur:nK(),onMouseOver:a7,onMouseLeave:nK(),selected:!1,disabled:!1}];if(T.pluginConfig.allowMergeCells&&C.push({id:"editor.table.mergeCells",title:o(a("2CQVV").messages.mergeCells),onClick:aR(l)(a("d925B").INPUT_METHOD.FLOATING_TB),selected:!1,disabled:!n6(e.tr)},{id:"editor.table.splitCell",title:o(a("2CQVV").messages.splitCell),onClick:ax(l)(a("d925B").INPUT_METHOD.FLOATING_TB),selected:!1,disabled:!nW(e)}),T?.pluginConfig?.allowDistributeColumns){let c,h=!0;(0,N.expValEquals)("cc_editor_limited_mode_table_align_bttn","isEnabled",!0)&&u||(c=t?oE(i,e,t.domAtPos.bind(t),n,s,d,p):void 0,h=c?.changed??!1),C.push({id:"editor.table.distributeColumns",title:o(a("2CQVV").messages.distributeColumns),onClick:(e,t,o)=>{if((0,N.expValEquals)("cc_editor_limited_mode_table_align_bttn","isEnabled",!0)&&u){if(o){let c=oE(i,e,o.domAtPos.bind(o),n,s,d,p);if(c)return aj(l,r)(a("d925B").INPUT_METHOD.FLOATING_TB,c)(e,t),!0}return!1}return!!c&&(aj(l,r)(a("d925B").INPUT_METHOD.FLOATING_TB,c)(e,t),!0)},selected:!1,disabled:!h})}if(T?.pluginConfig?.allowColumnSorting){let t=nU(e.tr).length>0,n=t?o(a("2CQVV").messages.canNotSortTable):void 0;C.push({id:"editor.table.sortColumnAsc",title:o(a("2CQVV").messages.sortColumnASC),onMouseOver:(e,t)=>0!==nU(e.tr).length&&(nz()(e,t),!0),onMouseOut:(e,t)=>(nK()(e,t),!0),onClick:(e,t)=>(aG(l)(a("d925B").INPUT_METHOD.FLOATING_TB,i.left,a("5rHEx").SortOrder.ASC)(e,t),!0),selected:!1,disabled:t,tooltip:n}),C.push({id:"editor.table.sortColumnDesc",title:o(a("2CQVV").messages.sortColumnDESC),onMouseOver:(e,t)=>0!==nU(e.tr).length&&(nz()(e,t),!0),onMouseOut:(e,t)=>(nK()(e,t),!0),onClick:(e,t)=>(aG(l)(a("d925B").INPUT_METHOD.FLOATING_TB,i.left,a("5rHEx").SortOrder.DESC)(e,t),!0),selected:!1,disabled:t,tooltip:n})}return C.push({id:"editor.table.clearCells",title:o(a("2CQVV").messages.clearCells,{0:Math.max(b,E)}),onClick:(e,t)=>{let{targetCellPosition:i}=tg(e);return aN(l)(a("d925B").INPUT_METHOD.FLOATING_TB,i)(e,t),!0},selected:!1,disabled:!1,elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").backspace))}),{id:"editor.table.cellOptions",testId:"cell_options",type:"dropdown",title:o(a("2CQVV").messages.cellOptions),options:C,dropdownWidth:230,showSelected:!1}},a0=e=>{let t=e.selection;return(0,a("BW42l").isSelectionType)(t,"cell")?(0,a("iP1et").getSelectionRect)(t):(0,a("id9O1").findCellRectClosestToPos)(t.$from)},a1=e=>{let t=e.selection,i=(0,a("id9O1").findTable)(e.selection);if(!i)return;let o=a("LmqWp").TableMap.get(i.node),n=new(0,a("LmqWp").Rect)(0,0,o.width,o.height);return(0,a("BW42l").isSelectionType)(t,"cell")?(0,a("iP1et").getSelectionRect)(t):n},a2=(e,i,o,n,r,l=!1,s=!1)=>d=>(c,p)=>{let h=(0,a("id9O1").findTable)(c.selection),m=tg(c),f=eY.getState(c),b=em.getState(c),E=r?.isTableScalingEnabled||!1,T=c.schema.nodes.table,C="Table floating controls",_=(0,a("iHzeA").areToolbarFlagsEnabled)(!!i?.toolbar);if((0,g.editorExperiment)("platform_editor_controls","variant1")){let e=!1,t=!1;if(r?.dragAndDropEnabled){let{isDragMenuOpen:i=!1,isDragging:o=!1}=nN(c);e=i,t=o}let o=!!(f?.dragging||b?.resizing),n=m.isContextualMenuOpen||e,a=t||o||n,l=i?.editorViewMode?.sharedState.currentState()?.mode==="view";if(a&&m.editorHasFocus&&!l)return{title:C,items:[],nodeType:T,__suppressAllToolbars:!(i?.userIntent&&(0,N.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0))||void 0}}let S=b?.resizing;if(h&&m.editorHasFocus&&!S){let g,b=m.tablePos&&to(c,m.tablePos),S=E&&l&&!b,w="fixed"===h.node.attrs.displayMode,v=n(),O=aQ(d,m,p,o,S,w),y=d.allowTableAlignment&&!b?rt(c,p,o,e,v,s,_,r?.fullWidthEnabled,r?.isCommentEditor):[],N=i?.limitedMode?.sharedState.currentState()?.enabled??!1,R=m.isDragAndDropEnabled?[]:a4(c,v,p,e,i,o,E,l,s,r?.isCommentEditor,N),x=m.isDragAndDropEnabled?a3(c,v,p,e,i,o,E,l,r?.isCommentEditor,N):[],A=_?[]:a8(c,O,p,o,n);if((0,a("5GR8v").isReferencedSource)(c,h.node)){let e=p.formatMessage(a("2CQVV").messages.unnamedSource);g=()=>({title:p.formatMessage(a("2CQVV").messages.deleteElementTitle),okButtonLabel:p.formatMessage(a("2CQVV").messages.confirmDeleteLinkedModalOKButton),message:p.formatMessage(a("2CQVV").messages.confirmDeleteLinkedModalMessage,{nodeName:(0,a("5GR8v").getNodeName)(c,h.node)||e}),messagePrefix:p.formatMessage(a("2CQVV").messages.confirmDeleteLinkedModalMessagePrefix),isReferentialityDialog:!0,getChildrenInfo:()=>(0,a("5GR8v").getChildrenInfo)(c,h.node),checkboxLabel:p.formatMessage(a("2CQVV").messages.confirmModalCheckboxLabel),onConfirm:(e=!1)=>a6(e,h.node)})}let I={id:"editor.table.delete",type:"button",appearance:"danger",icon:t(a("gKvd9")),onClick:aU(o),disabled:!!f&&!!f.dragging,onMouseEnter:nj(!0),onFocus:nj(!0),onBlur:nK(),onMouseLeave:nK(),title:p.formatMessage(a("61p3e").default.remove),focusEditoronEnter:!0,confirmDialog:g},L={type:"copy-button",supportsViewMode:!0,items:[{state:c,formatMessage:p.formatMessage,nodeType:T,onMouseEnter:nj(!1,!0),onMouseLeave:nK(),onFocus:nj(!1,!0),onBlur:nK()}]},k=(0,a("sxTNo").isNestedTablesSupported)(c.schema)&&(0,a("dh538").fg)("platform_editor_use_nested_table_pm_nodes")&&(0,a("sxTNo").isSelectionTableNestedInTable)(c),M=(e,t)=>({onMouseEnter:nj(e,t),onMouseLeave:nK(),onFocus:nj(e,t),onBlur:nK()}),D=i?.extension?.sharedState?.currentState(),P=i?.extension?.actions.api();return{title:C,getDomRef:e=>{let t,i=e.domAtPos.bind(e),o=(0,u.findParentDomRefOfType)(T,i)(c.selection);if(o){let e=o.querySelector("table")||void 0;e&&(t=(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_NODE_WRAPPER}`)||void 0)}return t},nodeType:T,offset:[0,18],absoluteOffset:{top:-6},zIndex:a("aFUXX").akEditorFloatingPanelZIndex+1,items:[O,..._?[]:[a9(O.hidden)],...y,..._?[]:[a9(0===y.length)],...R,...x,...A,..._?[_&&{type:"separator",fullHeight:!0},{type:"overflow-dropdown",testId:"table-overflow-dropdown-trigger",dropdownWidth:220,options:[{type:"custom",fallback:[],render:(e,t)=>e&&P&&D?.extensionProvider?(0,a("9K4OG").jsx)(nD.DropdownMenuExtensionItems,{node:h.node,editorView:e,extension:{extensionProvider:D?.extensionProvider?Promise.resolve(D.extensionProvider):void 0,extensionApi:P},dropdownOptions:t,disabled:e=>k&&["referentiality:connections","chart:insert-chart"].includes(e),areAnyNewToolbarFlagsEnabled:_}):null},...P&&D?.extensionProvider&&!_?[{type:"separator"}]:[],{title:p.formatMessage(a("61p3e").default.copyToClipboard),onClick:()=>(i?.core?.actions.execute(i?.floatingToolbar?.commands.copyNode(T,a("d925B").INPUT_METHOD.FLOATING_TB)),!0),icon:(0,a("9K4OG").jsx)(t(a("2MuFw")),{label:p.formatMessage(a("61p3e").default.copyToClipboard)}),...M(!1,!0)},{title:p.formatMessage(a("61p3e").default.delete),onClick:aU(o),icon:(0,a("9K4OG").jsx)(t(a("gKvd9")),{label:p.formatMessage(a("61p3e").default.delete)}),...M(!0),confirmDialog:(0,a("dh538").fg)("platform_editor_fix_confirm_table_removal")?g:void 0}]}]:[{type:"extensions-placeholder",separator:"end"},L,{type:"separator"},I]],scrollable:!0}}},a9=e=>({type:"separator",hidden:e}),a4=(e,t,{formatMessage:i},o,n,a,r=!1,l=!1,s=!1,d=!1,c=!1)=>{let p=a0(e);if(p){let u=aJ(e,t,p,{formatMessage:i},o,n,a,r,l,s,d,c);return[u,a9(u.hidden)]}return[]},a5=(e,t,i,o=!1,n=!1,r=!1)=>(l,s,d)=>{let c=a1(l);if(!d||!c)return!1;let p=oE(c,l,d.domAtPos.bind(d),e,o,n,r);return!!p&&(aj(i,t)(a("d925B").INPUT_METHOD.FLOATING_TB,p)(l,s),!0)},a3=(e,i,{formatMessage:o},n,r,l,s=!1,d=!1,c=!1,p=!1)=>{let u,h=tg(e),m=a1(e);if(!m||!i)return[];let f=!0;(0,N.expValEquals)("cc_editor_limited_mode_table_align_bttn","isEnabled",!0)&&p||(u=oE(m,e,i.domAtPos.bind(i),n,s,d,c),f=u?.changed??!1);let g=[];return h?.pluginConfig?.allowDistributeColumns&&h.isDragAndDropEnabled&&g.push({id:"editor.table.distributeColumns",type:"button",title:o(a("2CQVV").messages.distributeColumns),icon:()=>(0,a("9K4OG").jsx)(t(a("iBNSQ")),{spacing:"spacious",label:""}),onClick:(e,t,i)=>a5(n,r,l,s,d,c)(e,t,i),disabled:!f}),0===g.length||(0,a("iHzeA").areToolbarFlagsEnabled)(!!r?.toolbar)||g.push({type:"separator"}),g},a8=(e,t,{formatMessage:i},o,n)=>{let{targetCellPosition:r,pluginConfig:l}=tg(e);if(!l.allowBackgroundColor)return[];let s=r?e.doc.nodeAt(r):void 0,d=s?.attrs?.background||"#ffffff",c=nP.find(e=>e.value===d)||{label:"Custom",value:d,border:a("lhtyR").DEFAULT_BORDER_COLOR};return[{id:"editor.table.colorPicker",title:i(a("2CQVV").messages.cellBackground),type:"select",isAriaExpanded:!0,selectType:"color",defaultValue:c,options:nP,returnEscToButton:!0,onChange:e=>aA(o)(a("d925B").INPUT_METHOD.FLOATING_TB,e.value,n())},a9(t.hidden)]},a6=(e,t,i)=>(o,n)=>!!t&&(e?(nY(t)(o,n),!0):aU(i)(o,n)),a7=(e,t)=>{let i=a0(e);return!!i&&(nG(al(i),!0)(e,t),!0)},re=(e,t)=>{let i=a0(e);return!!i&&(nV(ar(i),!0)(e,t),!0)},rt=(e,{formatMessage:i},o,n,r,l,s,d,c)=>{let p=(0,a("id9O1").findTable)(e.selection);if(!p)return[];let u=[{id:"editor.table.alignLeft",value:"align-start",icon:()=>(0,a("9K4OG").jsx)(t(a("1dusJ")),{color:"currentColor",spacing:"spacious",label:"table-align-start-icon"})},{id:"editor.table.alignCenter",value:"center",icon:()=>(0,a("9K4OG").jsx)(t(a("dxgIg")),{color:"currentColor",spacing:"spacious",label:"table-align-center-icon"})}],h={center:a("2CQVV").messages.alignTableCenter,"align-start":a("2CQVV").messages.alignTableLeft},m=u.map(e=>{let{id:t,value:s,icon:u}=e,m=p.node.attrs.layout;return{id:t,type:"button",icon:u,title:i(h[s]),selected:ee(m)===s,onClick:aX(o,c||!1)(s,m,a("d925B").INPUT_METHOD.FLOATING_TB,a("3824I").CHANGE_ALIGNMENT_REASON.TOOLBAR_OPTION_CHANGED),...ro(p.node,n,r,l,d)&&{disabled:"center"!==s}}}),f=ri(u,p.node);return[{id:"table-layout",testId:"table-layout-dropdown",type:"dropdown",options:{render:e=>(0,a("9K4OG").jsx)(aY,{alignmentButtons:m,...e,areAnyNewToolbarFlagsEnabled:s}),width:74,height:32},title:i(a("2CQVV").messages.tableAlignmentOptions),icon:f?.icon}]},ri=(e,t)=>{let i=t.attrs.layout;return e.find(e=>e.value===ee(i))},ro=(e,t,i,o,n)=>{let{lineLength:r}=t(),l=(0,a("6fQl1").getTableContainerWidth)(e);if(i){let t=F(e,l,o);l*=t}return!!e&&!n&&!!r&&!!(l+1>=r)},rn=(e,t)=>Math[t<0?"min":"max"](...e)+t,ra=(e,t,i,o,n)=>{if(!n)return!1;let a="table-row"===e,r=a?al(n):ar(n),l=rn(r,t);return!(!(l>=0&&l<i)||(a?nl(l,o):nr(l,o))||ns(r,a?"row":"column")(o))},rr=e=>{let t=a0(e);return!!t&&ar(t).length>1},rl={left:0,top:0,right:0,bottom:0},rs=(e,i,o,n,r,l,s,c,p,u,h,m=!1,f=!1,g=!1,b,E=!1)=>{let{selection:T}=n.state,{getIntl:C}=tg(n.state),_="row"===e?[{label:"above",offset:0,icon:()=>(0,d.jsx)(t(a("kDG2N")),{spacing:"spacious",label:""}),keymap:a("hgeg8").addRowBefore},{label:"below",offset:1,icon:()=>(0,d.jsx)(t(a("4s9K9")),{spacing:"spacious",label:""}),keymap:a("hgeg8").addRowAfter}]:[{label:"left",offset:0,icon:()=>(0,d.jsx)(t(a("luItc")),{spacing:"spacious",label:""}),keymap:a("hgeg8").addColumnBefore},{label:"right",offset:1,icon:()=>(0,d.jsx)(t(a("6p8nb")),{spacing:"spacious",label:""}),keymap:a("hgeg8").addColumnAfter}],S="row"===e?[{label:"up",icon:()=>(0,d.jsx)(t(a("gzmk4")),{spacing:"spacious",label:""}),keymap:a("hgeg8").moveRowUp,canMove:ra("table-row",-1,l?.height??0,T,p),getOriginIndexes:al,getTargetIndex:e=>e.top-1},{label:"down",icon:()=>(0,d.jsx)(t(a("krMwx")),{spacing:"spacious",label:""}),keymap:a("hgeg8").moveRowDown,canMove:ra("table-row",1,l?.height??0,T,p),getOriginIndexes:al,getTargetIndex:e=>e.bottom}]:[{label:"left",icon:()=>(0,d.jsx)(t(a("lvYQd")),{spacing:"spacious",label:""}),keymap:a("hgeg8").moveColumnLeft,canMove:ra("table-column",-1,l?.width??0,T,p),getOriginIndexes:ar,getTargetIndex:e=>e.left-1},{label:"right",icon:()=>(0,d.jsx)(t(a("batr4")),{spacing:"spacious",label:""}),keymap:a("hgeg8").moveColumnRight,canMove:ra("table-column",1,l?.width??0,T,p),getOriginIndexes:ar,getTargetIndex:e=>e.right}],w=[...("column"===e?[{label:"increasing",order:a("5rHEx").SortOrder.ASC,icon:()=>(0,d.jsx)(t(a("4c0se")),{spacing:"spacious",label:""})},{label:"decreasing",order:a("5rHEx").SortOrder.DESC,icon:()=>(0,d.jsx)(t(a("dmsGX")),{spacing:"spacious",label:""})}]:[]).map(({label:e,order:t,icon:i})=>({id:`sort_column_${t}`,title:`Sort ${e}`,disabled:o,icon:i,onClick:(e,i)=>(aG(u)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,s??0,t)(e,i),!0)}))],v=[..._.map(({label:t,offset:i,icon:o,keymap:l})=>({id:`add_${e}_${t}`,title:`Add ${e} ${t}`,icon:o,onClick:(t,o)=>("row"===e?aL(u)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,{index:(s??0)+i,moveCursorToInsertedRow:!0})(t,o):aM(r,u,m,f,g)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,(s??0)+i)(t,o,n),!0),keymap:l&&(0,a("hgeg8").tooltip)(l)})),"column"===e?{id:"distribute_columns",title:"Distribute columns",disabled:!rr(n.state),onClick:(e,t)=>{let o=a0(e);if(o){let l=oE(o,e,n.domAtPos.bind(n),i,m,f,E);if(l)return aj(u,r)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,l)(e,t),!0}return!1},icon:()=>(0,d.jsx)(t(a("iBNSQ")),{spacing:"spacious",label:""})}:void 0,{id:"clear_cells",title:"Clear cells",onClick:(e,t)=>(aN(u)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,c)(e,t),!0),icon:()=>(0,d.jsx)(t(a("iV7dk")),{spacing:"spacious",label:""}),keymap:(0,a("hgeg8").tooltip)(a("hgeg8").backspace)},{id:`delete_${e}`,title:`Delete ${e}`,onClick:(t,i)=>("row"===e?aD(u)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,p??rl,!!h)(t,i):aP(u,r,m,f,g,E)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,p??rl)(t,i,n),!0),icon:"row"===e?()=>(0,d.jsx)(t(a("HbwpQ")),{spacing:"spacious",label:""}):()=>(0,d.jsx)(t(a("4Ilrk")),{spacing:"spacious",label:""}),keymap:"row"===e?(0,a("hgeg8").tooltip)(a("hgeg8").deleteRow):(0,a("hgeg8").tooltip)(a("hgeg8").deleteColumn)},...S.map(({label:t,canMove:i,icon:o,keymap:r,getOriginIndexes:l,getTargetIndex:s})=>({id:`move_${e}_${t}`,title:`Move ${e} ${t}`,disabled:!i,icon:o,onClick:(t,o)=>!!i&&(requestAnimationFrame(()=>{rc(u,b,C)(a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU,`table-${e}`,l(p),s(p))(n.state,n.dispatch)}),!0),keymap:r&&(0,a("hgeg8").tooltip)(r)}))];return v.unshift(...w),v.filter(Boolean)},rd=e=>(t,i,o,n,r)=>iS(({selection:e})=>{let{totalRowCount:r,totalColumnCount:l}=iC(e);return{action:"table-row"===i?a("3824I").TABLE_ACTION.MOVED_ROW:a("3824I").TABLE_ACTION.MOVED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,count:o?.length??0,distance:0,status:n,totalRowCount:r,totalColumnCount:l},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((e,t)=>(t&&nI(r)(e,t),!0)),rc=(e,t,i)=>(o,n,r,l,s)=>iS(({selection:e})=>{let t=r[0]>l?-1:1,{totalRowCount:i,totalColumnCount:s}=iC(e);return{action:"table-row"===n?a("3824I").TABLE_ACTION.MOVED_ROW:a("3824I").TABLE_ACTION.MOVED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:o,count:r.length,distance:Math.min(...r.map(e=>Math.abs(l-e)))*t,status:r.includes(l)?a("3824I").TABLE_STATUS.CANCELLED:a("3824I").TABLE_STATUS.SUCCESS,totalRowCount:i,totalColumnCount:s},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((e,d)=>{if(d&&(nL(n,r,l,s)(e,d),(o===a("d925B").INPUT_METHOD.TABLE_CONTEXT_MENU||a("d925B").INPUT_METHOD.SHORTCUT)&&1===r.length&&t&&i)){let o=r[0]>l?-1:1,{totalRowCount:s,totalColumnCount:d}=iC(e.selection);t(i().formatMessage("table-row"===n?o>0?a("2CQVV").messages.rowMovedDown:a("2CQVV").messages.rowMovedUp:o>0?a("2CQVV").messages.columnMovedRight:a("2CQVV").messages.columnMovedLeft,{index:l+1,total:"table-row"===n?s:d}),{priority:"important"})}return!0}),rp=(e,t,i)=>(o,n)=>(r,l)=>{let{selection:s}=r,d=s instanceof a("7XFGZ").CellSelection?(0,a("iP1et").getSelectionRect)(s):(0,a("id9O1").findCellRectClosestToPos)(s.$from);if(!d)return!1;let c="table-row"===o,p=c?al(d):ar(d);if(0===p.length)return!1;let{totalRowCount:u,totalColumnCount:h}=iC(s);if(!ra(o,n,c?u:h,s,d))return!1;let m=rn(p,n);return rc(e,t,i)(a("d925B").INPUT_METHOD.SHORTCUT,o,p,m)(r,l)},ru=e=>(t,i,o,n,r,l)=>iS(({selection:e})=>{let r=o[0]>n?-1:1,{totalRowCount:l,totalColumnCount:s}=iC(e);return{action:"table-row"===i?a("3824I").TABLE_ACTION.CLONED_ROW:a("3824I").TABLE_ACTION.CLONED_COLUMN,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{inputMethod:t,count:o.length,distance:Math.min(...o.map(e=>Math.abs(n-e)))*r,status:o.includes(n)?a("3824I").TABLE_STATUS.CANCELLED:a("3824I").TABLE_STATUS.SUCCESS,totalRowCount:l,totalColumnCount:s},eventType:a("d925B").EVENT_TYPE.TRACK}})(e)((e,t)=>(t&&nM(i,o,n,r,l)(e,t),!0)),rh=({altKey:e,ctrlKey:t})=>(((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).mac?e:t)?"clone":"move",rm=({location:e,source:t})=>{let i=e.current.dropTargets.at(0);if(!i)return;let{indexes:o,type:n,localId:r}=t.data,{targetIndex:l,type:s,localId:d}=i.data;if(!o||l<0||n!==s||r!==d)return;let c=(0,a("2WHHL").extractClosestEdge)(i.data)??("table-row"===s?"top":"left"),p=Math.min(...o),u=Math.max(...o);return{sourceType:n,sourceLocalId:r,sourceIndexes:o,targetType:s,targetLocalId:d,targetIndex:l,targetAdjustedIndex:l+ +("right"===c||"bottom"===c),targetClosestEdge:c,targetDirection:"top"===c||"left"===c?"start":"end",direction:l>=p&&l<=u?0:p>=l?-1:1,behaviour:rh(e.current.input)}},rf=(e,t,i,o,n,r)=>{let l=document.querySelector(".fabric-editor-popup-scroll-parent"),s=l?[(0,oZ.monitorForElements)({canMonitor({source:e}){let{type:t}=e.data;return"table-row"===t},onDragStart(){(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.startFeature("tableDragAndDrop"),l.style.setProperty("scroll-behavior","unset")},onDrop(){(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableDragAndDrop"),l.style.setProperty("scroll-behavior",null)}}),(0,a("51lK8").autoScrollForElements)({element:l,canScroll:({source:e})=>{let{type:t}=e.data;return"table-row"===t}})]:[];return(0,oX.combine)(...s,(0,oZ.monitorForElements)({canMonitor({source:t}){let{type:i,localId:o,indexes:n}=t.data;if(!n||!o||"table-row"!==i&&"table-column"!==i)return!1;let{tableNode:a}=tg(e.state);return o===a?.attrs.localId},onDragStart:({location:t})=>{(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.startFeature("tableDragAndDrop"),nk(!1)(e.state,e.dispatch),(0,N.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0)&&r?.core.actions.execute(r?.userIntent?.commands.setCurrentUserIntent("dragging"))},onDrag(t){let i=rm(t);if(!i)return void nI()(e.state,e.dispatch);let{sourceType:o,targetAdjustedIndex:n}=i,a="table-row"===o?nw.ROW:nw.COLUMN,l=na([n-1,n],a)(e.state.selection);nA(a,n,l)(e.state,e.dispatch),(0,N.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0)&&r?.core.actions.execute(r?.userIntent?.commands.setCurrentUserIntent("dragging"))},onDrop(l){let s=rm(l),{hoveredCell:d}=tg(e.state),c=no(l.location.current.input.clientX,l.location.current.input.clientY),p=e.state.tr,u={type:"HOVER_CELL",data:{hoveredCell:{rowIndex:c?.row??d.rowIndex,colIndex:c?.col??d.colIndex}}};if(p.setMeta(eh,u),(0,N.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0)&&r?.userIntent?.sharedState.currentState()?.currentUserIntent==="dragging"&&r?.core.actions.execute(r?.userIntent?.commands.setCurrentUserIntent("default")),!s)return((0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableDragAndDrop"),l?.source?.data?.type==="table-row"||l?.source?.data?.type==="table-column")?rd(t)(a("d925B").INPUT_METHOD.DRAG_AND_DROP,l.source.data.type,l.source.data?.indexes,a("3824I").TABLE_STATUS.CANCELLED,p)(e.state,e.dispatch):nI(p)(e.state,e.dispatch);let{sourceType:h,sourceIndexes:m,targetIndex:f,targetAdjustedIndex:g,targetDirection:b,direction:E,behaviour:T}=s;if("table-row"===h?u.data.hoveredCell.rowIndex=f:u.data.hoveredCell.colIndex=f,na([g-1,g],"table-row"===h?nw.ROW:nw.COLUMN)(e.state.selection)){rd(t)(a("d925B").INPUT_METHOD.DRAG_AND_DROP,h,m,a("3824I").TABLE_STATUS.INVALID,p)(e.state,e.dispatch),(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableDragAndDrop");return}requestAnimationFrame(()=>{if("clone"===T?ru(t)(a("d925B").INPUT_METHOD.DRAG_AND_DROP,h,m,f,b,p)(e.state,e.dispatch):rc(t)(a("d925B").INPUT_METHOD.DRAG_AND_DROP,h,m,g+(1===E?-1:0),p)(e.state,e.dispatch),"table-column"===h){let{tableRef:t,tableNode:a}=tg(e.state);if(t&&a){let e=i,r=i&&o;r&&(e="fixed"!==a.attrs.displayMode),i&&n&&(e=!0),K(t,a,e,void 0,r||i&&n,n)}}e.focus(),(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableDragAndDrop")})}}))},rg=(e,t,i=!1,o=!1,n=!1,r)=>new(0,a("1S4f7").SafePlugin)({state:nO(e,e=>({decorationSet:a("ftzrq").DecorationSet.empty,dropTargetType:nw.NONE,dropTargetIndex:0,isDragMenuOpen:!1,dragMenuIndex:0,isDragging:!1,isKeyboardModeActive:!1})),key:nv,appendTransaction:(e,t,i)=>{let{targetCellPosition:o}=tg(t),{targetCellPosition:n}=tg(i),{isDragMenuOpen:r=!1,dragMenuIndex:l}=nN(i);if(e.forEach(e=>{if(e.getMeta("selectedRowViaKeyboard")){let e=document.querySelector("#drag-handle-button-row");e&&e.focus()}if(e.getMeta("selectedColumnViaKeyboard")){let e=document.querySelector("#drag-handle-button-column");e&&e.focus()}}),o!==n&&r){let e=i.tr,t={type:np.TOGGLE_DRAG_MENU,data:{isDragMenuOpen:!1,direction:void 0}};if(void 0===n)return e.setMeta(nv,t);{let i=es(l)(e.selection),o=e.selection instanceof a("7XFGZ").CellSelection;if(i&&i.length&&i[0].node!==e.doc.nodeAt(n)&&!o)return e.setMeta(nv,t)}}},view:e=>({destroy:rf(e,t,i,o,n,r)}),props:{decorations:e=>{let{decorationSet:t}=nN(e);return t},handleKeyDown:(e,t)=>{let{state:{tr:i}}=e,o=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"];if(t.ctrlKey&&t.shiftKey&&t.altKey){let{verticalCells:e,horizontalCells:n,totalRowCount:r,totalColumnCount:l}=(0,a("9KolL").getSelectedCellInfo)(i.selection);if((n===l||e===r)&&o.includes(t.key)&&t.repeat)return!0}let n=["drag-handle-button-row","drag-handle-button-column"].includes((t.target||null)?.id),r=["Enter"," "],{isDragMenuOpen:l=!1}=nN(e.state);return!n||l||r.includes(t.key)?!!(n&&r.includes(t.key)||l&&o.includes(t.key))||void 0:(e.dom.focus(),!0)}}}),rb=new(0,a("ks2lK").PluginKey)("editorContentAreaHeightPlugin"),rE=()=>new(0,a("1S4f7").SafePlugin)({key:rb,state:{init:()=>({height:1200}),apply(e,t){let i=e.getMeta(rb);return i?{...t,...i}:t}},view:e=>{let t,i=e.dom.closest(".ak-editor-content-area-region");return i&&(t=new ResizeObserver(t=>{for(let i of t){let t=i.contentRect.height,o=e.state.tr.setMeta(rb,{height:t,isObserved:!0});e.dispatch(o)}})).observe(i),{destroy(){t?.disconnect()}}}}),rT=(e,t,i)=>o=>(n,r,l)=>{let s=(0,a("id9O1").findTable)(n.selection);if(!s)return!1;if(tg(n)?.isKeyboardResize)return ah({ariaNotify:t,getIntl:i})(n,r,l),!0;let d=a("LmqWp").TableMap.get(s.node),{tableCell:c,tableHeader:p}=n.schema.nodes,h=(0,u.findParentNodeOfType)([c,p])(n.selection),m=d.positionAt(0,0,s.node)+s.start,f=d.positionAt(d.height-1,d.width-1,s.node)+s.start;if(m===h.pos&&-1===o)return aL(e)(a("d925B").INPUT_METHOD.KEYBOARD,{index:0,moveCursorToInsertedRow:!0})(n,r),!0;if(f===h.pos&&1===o)return aL(e)(a("d925B").INPUT_METHOD.KEYBOARD,{index:d.height,moveCursorToInsertedRow:!0})(n,r),!0;if(r)return function(e,t){if(!(0,a("bMyNT").isInTable)(e))return!1;let i=(0,a("bzgWU").selectionCell)(e.selection);if(!i)return!1;let n=function(e,t){if(-1===t){let t=e.nodeBefore;if(t)return e.pos-t.nodeSize;for(let t=e.index(-1)-1,i=e.before();t>=0;t--){let o=e.node(-1).child(t);if(o.childCount&&o.lastChild)return i-1-o.lastChild.nodeSize;i-=o.nodeSize}}else{if(e.index()<e.parent.childCount-1&&e.nodeAfter)return e.pos+e.nodeAfter.nodeSize;let t=e.node(-1);e.node(-4)&&"table"===e.node(-4).type.name&&(t=e.node(-4));for(let i=e.indexAfter(-1),o=e.after();i<t.childCount;i++){let e=t.child(i);if(e.childCount)return o+1;o+=e.nodeSize}}}(i,o);if(void 0===n)return!1;if(t){let i=e.doc.resolve(n);t(e.tr.setSelection(a("ks2lK").TextSelection.between(i,function(e){let t=e.nodeAfter?e.nodeAfter.nodeSize:0;return e.node(0).resolve(e.pos+t)}(i))).scrollIntoView())}return!0}(n,r);return!0},rC=e=>(t,i)=>{var o,n,r,l;let s,{selection:d}=t,c=(0,a("sxTNo").isSelectionTableNestedInTable)(t);if(!(d instanceof a("ks2lK").NodeSelection)&&!c)return!1;let p=(0,a("id9O1").findTable)(d),u=(0,a("id9O1").findCellClosestToPos)(t.doc.resolve(d.from)),h=d.from;if(p&&c&&(0,a("iYC9s").isTableSelected)(d)){let e=p.pos;p=(0,a("id9O1").findTableClosestToPos)(t.doc.resolve(e)),u=(0,a("id9O1").findCellClosestToPos)(t.doc.resolve(e)),h=e}if(!p||!u||!u.pos)return!1;let{tableCell:m,tableHeader:f}=t.schema.nodes;if(o=u.node,n=u.pos,r=h,l=e,s=!1,o.content.forEach((e,t)=>{let i=n+1+t,o=i+e.nodeSize;1===l&&i>r&&e.isBlock?s=!0:-1===l&&o<=r&&e.isBlock&&(s=!0)}),s)return!1;let g=a("LmqWp").TableMap.get(p.node).nextCell(u.pos-p.start,"vert",e);if(i&&g){let o=p.start+g,n=t.doc.resolve(o);if(n.nodeAfter?.type&&[m,f].includes(n.nodeAfter?.type)){let r=function(e,t,i){let o=t+1;if(e.content.size>0){if(1===i){let i=e.firstChild;i&&i.isBlock&&(o=t+1+ +!i.isLeaf)}else if(-1===i){let i,n=0;e.content.forEach((e,t)=>{e.isBlock&&(i=e,n=t)}),i&&(o=t+1+n+(i.isLeaf?0:i.nodeSize-1))}}return o}(n.nodeAfter,o,e);return i(t.tr.setSelection(a("ks2lK").TextSelection.create(t.doc,r))),!0}}return!1},r_=(0,a("2XqLN").default)(()=>!!window.CSS&&!!window.CSS.supports&&window.CSS.supports("anchor-name: --anchor")),rS=e=>!!Number.isNaN((0,a("d7ZU3").getBrowserInfo)().safari_version)&&r_()&&e;a("42omo"),a("42omo");var rw=a("2daQU");function rv({axis:e,side:t}){return function({clientRect:i,overflow:o,config:n}){let{mainAxis:r,crossAxis:l}=a("8e8VQ").axisLookup[e],s=r[t],d=o[s],c=a("lFBSq").getOverElementHitbox[s]({clientRect:i,config:n});return{insideOfEdge:DOMRect.fromRect({[r.point]:c[r.point],[r.size]:c[r.size],[l.point]:c[l.point]-d[l.start],[l.size]:c[l.size]+d[l.start]+d[l.end]}),outsideOfEdge:DOMRect.fromRect({[r.point]:"start"===t?i[r.point]-d[r.start]:i[r.end],[l.point]:i[l.point]-d[l.start],[r.size]:"start"===t?d[r.start]:d[r.end],[l.size]:d[l.start]+i[l.size]+d[l.end]})}}}let rO={top:rv({axis:"vertical",side:"start"}),right:rv({axis:"horizontal",side:"end"}),bottom:rv({axis:"vertical",side:"end"}),left:rv({axis:"horizontal",side:"start"})};function ry(e){return"inside-of-edge"===e.type}function rN(e){return{top:e?.top??0,right:e?.right??0,bottom:e?.bottom??0,left:e?.left??0}}let rR=function({monitor:e}){let t=new Map;return(0,a("jtbk8").getScheduler)(e).onFrame(function({latestArgs:e,underUsersPointer:i,timeSinceLastFrame:o}){!function({input:e,source:t,entries:i,timeSinceLastFrame:o,underUsersPointer:n}){for(let r of i){if(r.element.contains(n))continue;let i={input:e,source:t,element:r.element};if(r.canScroll&&!r.canScroll(i))continue;let l=(0,a("h9dtK").getInternalConfig)(r.getConfiguration?.(i)),s=r.getAllowedAxis?.(i)??"all",d=function({entry:e,timeSinceLastFrame:t,input:i,config:o,allowedAxis:n}){var r;let l={x:i.clientX,y:i.clientY},s=e.element.getBoundingClientRect(),d={top:rN((r=e.getOverflow()).forTopEdge),right:rN(r.forRightEdge),bottom:rN(r.forBottomEdge),left:rN(r.forLeftEdge)},c=a("ajYex").edges.map(e=>{let{insideOfEdge:t,outsideOfEdge:i}=rO[e]({clientRect:s,overflow:d,config:o});return(0,a("6UNNA").isWithin)({client:l,clientRect:i})?{edge:e,hitbox:i,type:"outside-of-edge"}:!!(0,a("6UNNA").isWithin)({client:l,clientRect:t})&&{edge:e,hitbox:t,type:"inside-of-edge"}}).filter(e=>!!e);if(!c.length)return null;let p=(0,a("1PEak").markAndGetEngagement)(e.element),u=c.filter(t=>(0,a("eIOs5").isAxisAllowed)(a("ajYex").edgeAxisLookup[t.edge],n)&&a("hhm38").canScrollOnEdge[t.edge](e.element));if(!u.length)return null;let h=new Map(u.map(e=>[e.edge,e]));return{left:(()=>{let e="horizontal",i=h.get("left");if(i)return(0,a("wfJXn").getScrollChange)({client:l,isDistanceDampeningEnabled:ry(i),hitbox:i.hitbox,edge:"left",axis:e,timeSinceLastFrame:t,engagement:p,config:o});let n=h.get("right");return n?(0,a("wfJXn").getScrollChange)({client:l,isDistanceDampeningEnabled:ry(n),hitbox:n.hitbox,edge:"right",axis:e,timeSinceLastFrame:t,engagement:p,config:o}):0})(),top:(()=>{let e="vertical",i=h.get("bottom");if(i)return(0,a("wfJXn").getScrollChange)({client:l,isDistanceDampeningEnabled:ry(i),hitbox:i.hitbox,edge:"bottom",axis:e,timeSinceLastFrame:t,engagement:p,config:o});let n=h.get("top");return n?(0,a("wfJXn").getScrollChange)({client:l,isDistanceDampeningEnabled:ry(n),hitbox:n.hitbox,edge:"top",axis:e,timeSinceLastFrame:t,engagement:p,config:o}):0})()}}({entry:r,input:e,timeSinceLastFrame:o,allowedAxis:s,config:l});d&&r.element.scrollBy(d)}}({input:e.location.current.input,source:e.source,entries:Array.from(t).map(([e,t])=>t),underUsersPointer:i,timeSinceLastFrame:o})}),{unsafeOverflowAutoScroll:function(e){return t.set(e.element,e),()=>t.delete(e.element)}}}({monitor:oZ.monitorForElements}).unsafeOverflowAutoScroll,rx=({tableWrapper:e,getNode:t})=>[(0,a("51lK8").autoScrollForElements)({element:e,canScroll:({source:e})=>{let{localId:i,type:o}=e.data,n=t();return i===n?.attrs.localId&&"table-column"===o}}),rR({element:e,canScroll:({source:e})=>{let{localId:i,type:o}=e.data,n=t();return i===n?.attrs.localId&&"table-column"===o},getOverflow:()=>({forTopEdge:{top:150,right:150,left:150},forRightEdge:{right:150,top:150,bottom:150},forLeftEdge:{top:150,left:150,bottom:150}})})],rA=new(0,a("ks2lK").PluginKey)("stickyHeadersPlugin"),rI=(e,t)=>{if(!e||void 0===t)return;let i=e.find(e=>e.pos===t+1);if(i)return i.sticky?i:void 0},rL=e=>e instanceof FocusEvent&&e.relatedTarget instanceof HTMLElement&&"calendar"===e.relatedTarget.getAttribute("aria-label"),rk=e=>e instanceof FocusEvent&&e.relatedTarget instanceof HTMLElement&&e.relatedTarget.closest('[role="dialog"]'),rM=e=>e instanceof FocusEvent&&e.relatedTarget instanceof HTMLElement&&e.relatedTarget.closest('[role="toolbar"]'),rD=e=>e instanceof FocusEvent&&e.relatedTarget instanceof HTMLElement&&e.relatedTarget.closest("button")&&"true"===e.relatedTarget.getAttribute("draggable"),rP=e=>e instanceof FocusEvent&&e.relatedTarget instanceof HTMLElement&&e.relatedTarget.closest("button")&&e.relatedTarget.classList.contains(eu.DRAG_HANDLE_BUTTON_CLICKABLE_ZONE),rB=(e,t)=>{let{state:i,dispatch:o}=e;return 11===a("d7ZU3").browser.ie_version||rL(t)||rk(t)||rM(t)||rD(t)||rP(t)||tk(!1)(i,o),t.preventDefault(),!1},rW=(e,t)=>{let{state:i,dispatch:o}=e;return tk(!0)(i,o),t.preventDefault(),!1},rU=(e,t)=>{if(!(t.target instanceof HTMLElement))return!1;let i=t.target,o=(0,a("id9O1").findTable)(e.state.selection);if(t instanceof MouseEvent&&o0(i)){let[o]=oJ(i),{state:n,dispatch:a}=e;return t$(o,t.shiftKey)(n,a)}let n=i.matches?i.matches:i.msMatchesSelector;if(!o||!(0,a("kTbzR").isElementInTableCell)(i)||!n||n.call(i,"table .image, table p, table .image div"))return!1;let r=a("LmqWp").TableMap.get(o.node),l=(0,a("4vlwG").closestElement)(i,"td")||(0,a("4vlwG").closestElement)(i,"th"),s=l&&l.cellIndex,d=(0,a("4vlwG").closestElement)(i,"tr"),c=d&&d.rowIndex,p=r.width*c+s,{dispatch:u,state:{tr:h,schema:{nodes:{paragraph:m}}}}=e,f=r.map[p];if(isNaN(f)||void 0===f||"number"!=typeof f)return!1;let g=o.node.nodeAt(f);if((0,a("kTbzR").isLastItemMediaGroup)(g)){let t=r.map[p]+g.nodeSize;h.insert(t+o.pos,m.create()),u(h),(0,a("kTbzR").setNodeSelection)(e,t+o.pos)}return!0},rH=(e,t)=>{if(!(t.target instanceof HTMLElement))return!1;let{state:i,dispatch:o}=e,n=t.target,{insertColumnButtonIndex:r,insertRowButtonIndex:l,isTableHovered:s}=tg(i);if(oQ(n)){let[e,a]=oJ(n);return tQ("bottom"===o7(t)?a:e)(i,o)}if(o0(n)){let[t]=oJ(n),{state:i,dispatch:o}=e;return nV([t],!1)(i,o)}if((0,a("sxTNo").getParentOfTypeCount)(i.schema.nodes.table)(i.selection.$from)>1){let e=(0,a("4vlwG").closestElement)(n,"table"),t=(0,u.findParentNodeOfTypeClosestToPos)(i.doc.resolve(i.selection.from),[i.schema.nodes.table]),s=(0,u.findParentNodeOfTypeClosestToPos)(i.doc.resolve(t?.pos||0),[i.schema.nodes.table]);if(e?.dataset.tableLocalId!==s?.node.attrs.localId&&(oq(n)||oY(n))&&("number"==typeof r||"number"==typeof l))return tJ()(i,o)}else if((oq(n)||oY(n))&&("number"==typeof r||"number"==typeof l))return tJ()(i,o);if(o2(n)){let[e,t]=oJ(n);return n$({left:e,right:t})(i,o)}return!s&&nZ(!0)(i,o)},rF=(e,t)=>{if(!(t instanceof MouseEvent))return!1;let{state:i,dispatch:o}=e,{insertColumnButtonIndex:n,tableNode:r,tableRef:l}=tg(i);if(void 0!==n&&l&&l.parentElement&&r){let{width:e}=a("LmqWp").TableMap.get(r),t=n+1;if(e===t){let e=l.clientWidth;return l.parentElement.scrollTo(e,0),tY(t)(i,o)}}return!1},rz=(e,t)=>{let i=!!(t.target&&t.target instanceof HTMLElement&&(o4(t.target)||o0(t.target)||o1(t.target)||o8(t.target)));return i&&t.preventDefault(),i},rV=(e,t)=>{if(!(t instanceof MouseEvent)||!(t.target instanceof HTMLElement))return!1;let i=t.target;if(o0(i)){let{state:t,dispatch:i}=e;return nK()(t,i)}let o=t.relatedTarget;if(o2(i)&&!o2(o)){let{state:t,dispatch:i}=e,{isKeyboardResize:o}=tg(t);return!o&&nX()(t,i)}return!1},rG=(e,t)=>{let{state:i,dispatch:o}=e,{isTableHovered:n}=tg(i);return!n&&nZ(!0)(i,o)},rj=(e,t)=>{if(!(t.target instanceof HTMLElement))return!1;let{state:i,dispatch:o}=e,{insertColumnButtonIndex:n,insertRowButtonIndex:a,isDragAndDropEnabled:r,isTableHovered:l}=tg(i);if(l){if(r){let{isDragMenuOpen:e=!1}=nN(i);e||nZ(!1)(i,o)}else nZ(!1)(i,o);return!0}return!!rq(e)&&!!(o9(t.target)||(void 0!==n||void 0!==a)&&tJ()(i,o))},rK=e=>(0,a("2P8Ax").default)((t,i,o)=>{if(!(i.target instanceof HTMLElement))return!1;let n=i.target;if(o0(n)||o3(n)){let{state:e,dispatch:a}=t,{insertColumnButtonIndex:r}=tg(e),[l,s]=oJ(n),d="right"===o6(i,o,void 0)?s:l;if(d!==r)return tY(d)(e,a)}if(o1(n)||o5(n)){let{state:e,dispatch:o}=t,{insertRowButtonIndex:a}=tg(e),[r,l]=oJ(n),s="bottom"===o7(i)?l:r;if(s!==a)return tQ(s)(e,o)}if(!o2(n)&&oq(n)){let r=o6(i,o,30);if(null!==r){let{state:i,dispatch:o}=t,{resizeHandleColumnIndex:l,resizeHandleRowIndex:s}=tg(i),d=tg(i).isKeyboardResize,c=(0,a("4vlwG").closestElement)(n,"td, th"),p=t.posAtDOM(c,0),u=(0,a("id9O1").findCellRectClosestToPos)(i.doc.resolve(p));if(u){let t="left"===r?u.left:u.right,a=u.top;if((t!==l||a!==s||!ne({target:n,columnEndIndexTarget:t}))&&!d)return t0(a,t,!0,e)(i,o)}}}return!1}),r$=e=>(t,i)=>i.target instanceof HTMLElement&&(rK(e)(t,i,a("d7ZU3").browser.gecko?i.offsetX:NaN),!1);function rX(e,t){let{state:i,dispatch:o}=e,n=(0,a("3gZJH").cellAround)(i.doc.resolve(t));if(!n)return!1;let r=i.doc.nodeAt(n.pos);if(r){let e=a("ks2lK").Selection.findFrom(n,1,!0),t=a("ks2lK").Selection.findFrom(i.doc.resolve(n.pos+r.nodeSize),-1,!0);if(e&&t)return o(i.tr.setSelection(new(0,a("ks2lK").TextSelection)(e.$from,t.$to))),!0}return!1}let rZ=(e,t,i,o,n,r,l=!1,s=!1,d=!1)=>{let c=t.tr.selection,{tr:p}=i;if(c instanceof a("7XFGZ").CellSelection){let u=e.doc.resolve(e.mapping.map(c.$anchorCell.pos)),h=e.doc.resolve(e.mapping.map(c.$headCell.pos)),m=new(0,a("7XFGZ").CellSelection)(u,h);if(p.setSelection(m),p.selection instanceof a("7XFGZ").CellSelection){let e=(0,a("iP1et").getSelectionRect)(m);if(e){let{verticalCells:c,horizontalCells:u,totalCells:h,totalRowCount:m,totalColumnCount:f}=i_(p.selection);if(n?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.CUT,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{verticalCells:c,horizontalCells:u,totalCells:h,totalRowCount:m,totalColumnCount:f},eventType:a("d925B").EVENT_TYPE.TRACK})(p),p.selection instanceof a("7XFGZ").CellSelection)if(p.selection.isRowSelection()&&p.selection.isColSelection())p=ed(p);else if(p.selection.isRowSelection()){let{pluginConfig:{isHeaderRowRequired:t}}=tg(i);p=at(e,t)(p)}else p.selection.isColSelection()&&(p=ab(e,oU(t),o,r,l,s,d)(p))}}}return p},rq=e=>!!tg(e.state)?.tableNode&&!n1(e.state)?.dragging,rY=(e,t)=>(i,o)=>!!rq(i)&&t?.editorViewMode?.sharedState.currentState()?.mode!=="view"&&e(i,o),rQ=(e,t)=>{let i=t.target,o=(0,a("kTbzR").isElementInTableCell)(i),{tableNode:n,tableRef:r}=tg(e.state),l=(0,a("4vlwG").closestElement)(i,"table");if(l?.dataset?.tableLocalId&&l.dataset.tableLocalId!==n?.attrs.localId||!o||!r)return;let s=o.cellIndex,d=(0,a("4vlwG").closestElement)(i,"tr"),c=d&&d.rowIndex,p=n&&a("LmqWp").TableMap.get(n),u=s;p&&(u=i3(i5(s,c,p),c,p)),nq(c,u)(e.state,e.dispatch)},rJ=e=>(t,i)=>(tg(t.state).isDragAndDropEnabled&&nN(t.state)&&!nN(t.state).isDragging&&rQ(t,i),e(t,i));var r0=a("jTxSS"),r1=a("afUmf");a("42omo"),a("42omo");let r2=({style:e})=>(0,d.jsxs)("svg",{width:"28",height:"20",viewBox:"0 0 28 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:e,children:[(0,d.jsx)("rect",{x:"1",y:"1",width:"26",height:"18",rx:"5",fill:"var(--ds-background-accent-blue-subtle, #579DFF)"}),(0,d.jsx)("rect",{x:"9",y:"6",width:"2",height:"8",rx:"1",fill:"var(--ds-border-inverse, #FFFFFF)"}),(0,d.jsx)("rect",{x:"13",y:"6",width:"2",height:"8",rx:"1",fill:"var(--ds-border-inverse, #FFFFFF)"}),(0,d.jsx)("rect",{x:"17",y:"6",width:"2",height:"8",rx:"1",fill:"var(--ds-border-inverse, #FFFFFF)"}),(0,d.jsx)("rect",{x:"1",y:"1",width:"26",height:"18",rx:"5",stroke:"var(--ds-border-inverse, #FFFFFF)",strokeWidth:"2"})]}),r9=(0,a("ecnYn").xcss)({borderColor:"color.border.focused",borderStyle:"solid",borderRadius:"radius.small",borderWidth:"border.width.focused",backgroundColor:"color.blanket.selected"}),r4=({direction:e,width:t,height:i})=>(0,d.jsx)(a("6f0Oj").default,{xcss:r9,style:{width:`${t}px`,height:`${i}px`},children:(0,d.jsx)(r2,{style:{position:"absolute",marginLeft:`${"row"===e?-14:t/2-14}px`,marginTop:`${"row"===e?i/2-14:-10}px`,transform:"row"===e?"rotate(90deg)":"none"}})});a("42omo"),a("42omo");let r5=({style:e})=>(0,d.jsxs)("svg",{width:"24",height:"16",viewBox:"0 0 24 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:e,"data-testid":"drag-icon-disabled",children:[(0,d.jsx)("rect",{width:"24",height:"16",rx:"4"}),(0,d.jsxs)("g",{children:[(0,d.jsx)("rect",{x:"7",y:"4",width:"2",height:"8",rx:"1"}),(0,d.jsx)("rect",{x:"11",y:"4",width:"2",height:"8",rx:"1"}),(0,d.jsx)("rect",{x:"15",y:"4",width:"2",height:"8",rx:"1"})]})]});a("42omo");let r3=()=>(0,d.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"16",fill:"none","data-testid":"drag-icon-enabled",children:[(0,d.jsx)("rect",{width:"24",height:"16",rx:"4"}),(0,d.jsx)("g",{children:(0,d.jsx)("path",{d:"M9 10a1 1 0 1 0-2 0 1 1 0 0 0 2 0ZM9 6a1 1 0 1 0-2 0 1 1 0 0 0 2 0ZM17 10a1 1 0 1 0-2 0 1 1 0 0 0 2 0ZM17 6a1 1 0 1 0-2 0 1 1 0 0 0 2 0ZM13 10a1 1 0 1 0-2 0 1 1 0 0 0 2 0ZM13 6a1 1 0 1 0-2 0 1 1 0 0 0 2 0Z"})})]});a("42omo");let r8=()=>(0,d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"5",fill:"none",children:(0,d.jsx)("rect",{className:eu.DRAG_HANDLE_MINIMISED,width:"24",height:"5",rx:"3"})}),r6=e=>{let{forceDefaultHandle:t,isHandleHovered:i,hasMergedCells:o}=e;return i||t?o?(0,d.jsx)(r5,{}):(0,d.jsx)(r3,{}):(0,d.jsx)(r8,{})},r7=(0,a("gmMgo").default)(({isDragMenuTarget:e,tableLocalId:i,direction:o="row",appearance:n="default",indexes:r,forceDefaultHandle:l=!1,previewWidth:s,previewHeight:p,onMouseOver:u,onMouseOut:h,toggleDragMenu:m,hoveredCell:f,onClick:g,editorView:b,intl:{formatMessage:E}})=>{let T=(0,c.useRef)(null),[C,_]=(0,c.useState)(null),{state:S,state:{selection:w}}=b,{isDragMenuOpen:v=!1}=nN(S),[O,y]=(0,c.useState)(!1),R="row"===o,x="column"===o,A=(0,c.useMemo)(()=>{let e=(0,a("id9O1").findTable)(w);if(!e)return!1;let t=a("LmqWp").TableMap.get(e?.node);if(!t.hasMergedCells()||r.length<1)return!1;let{mapByColumn:i,mapByRow:n}=t;if(f&&void 0!==f.rowIndex&&void 0!==f.colIndex&&w instanceof a("ks2lK").TextSelection){let{rowIndex:e,colIndex:t}=f,a=nc(n[e]),r=nc(i[t]),l="column"===o?a.includes(n[0][t]):r.includes(i[0][e]);if("column"===o?0===f.rowIndex&&l:0===f.colIndex&&l){let a="column"===o?n[0].filter(e=>e===n[0][t]).length:i[0].filter(t=>t===i[0][e]).length;return ns("column"===o?[t,t+a-1]:[e,e+a-1],o)(w)}}return ns(r,o)(w)},[r,w,o,f]),I={forceDefaultHandle:l,isHandleHovered:O,hasMergedCells:A};(0,c.useEffect)(()=>{let e=T.current,t=(0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser;if(e)return(0,oZ.draggable)({element:e,canDrag:()=>!A,getInitialData:()=>({localId:i,type:`table-${o}`,indexes:r}),onGenerateDragPreview:({nativeSetDragImage:e})=>{(0,r1.setCustomNativeDragPreview)({getOffset:({container:e})=>{let i=e.getBoundingClientRect();return(t.safari&&(e.style.left=`-${i.width-1e-4}px`),R)?{x:12,y:i.height/2}:{x:i.width/2+4,y:12}},render:function({container:e}){return _(e),()=>_(null)},nativeSetDragImage:e})}})},[i,o,r,R,b.state.selection,A]);let L=(0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{type:"button",className:eu.DRAG_HANDLE_BUTTON_CLICKABLE_ZONE,"data-testid":"table-drag-handle-clickable-zone-button",style:{height:R?"calc(100% - 16px)":"var(--ds-space-200, 16px)",width:R?"var(--ds-space-200, 16px)":"calc(100% - 16px)",left:R?"var(--ds-space-050, 4px)":void 0,bottom:x?"var(--ds-space-0, 0px)":void 0,alignSelf:x?"none":"center",zIndex:x?"-1":"auto",pointerEvents:"auto"},onMouseUp:e=>{b.focus(),v&&m&&m("mouse",e)},onClick:g,"aria-label":(0,N.expValEquals)("platform_editor_enghealth_table_plugin_lable_rule","isEnabled",!0)?E(a("2CQVV").messages.dragHandleZone):void 0}),(0,d.jsx)("button",{type:"button",id:e?R?"drag-handle-button-row":"drag-handle-button-column":void 0,className:t(rw)(eu.DRAG_HANDLE_BUTTON_CONTAINER,n,{[eu.DRAG_HANDLE_DISABLED]:A}),ref:T,style:{transform:x?"none":"rotate(90deg)",alignSelf:x?"none":"center"},"data-testid":"table-drag-handle-button","aria-label":E(R?a("2CQVV").messages.rowDragHandle:a("2CQVV").messages.columnDragHandle),"aria-expanded":v&&e?"true":"false","aria-haspopup":"menu",onMouseOver:e=>{y(!0),u&&u(e)},onMouseOut:e=>{y(!1),h&&h(e)},onMouseUp:e=>{b.focus(),m&&m("mouse",e)},onClick:g,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&m&&m("keyboard")},children:"placeholder"!==n?L.gecko?(0,d.jsx)(r6,{...I}):(0,d.jsx)("span",{style:{pointerEvents:"none"},children:(0,d.jsx)(r6,{...I})}):null}),C&&void 0!==s&&void 0!==p&&t(r0).createPortal((0,d.jsx)(r4,{direction:o,width:s,height:p}),C)]})}),le=e=>{if(e instanceof a("7XFGZ").CellSelection&&e.isColSelection()){let t=(0,a("iP1et").getSelectionRect)(e);return t?ar(t):[]}return[]},lt=({editorView:e,tableActive:t,tableRef:i,hoveredCell:o,stickyTop:n,localId:r,isInDanger:l,rowHeights:s,colWidths:p,isTableHovered:u,tableContainerWidth:h,isNumberColumnEnabled:m,isDragging:f,getScrollOffset:g,api:b})=>{let E=(0,c.useRef)(null),{selection:T}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(b,["selection"],e=>({selection:e.selectionState?.selection})),C=p?.map(e=>e?n?`${e-2}px`:`${e-1}px`:"0px").join(" ")??"0px",_=i7(p??[]),S=o?.colIndex,w=le(T||e.state.selection),v=i.querySelector("tr"),O=!!v&&v.getAttribute("data-header-row"),y=(0,c.useCallback)(t=>{let{state:i,dispatch:o}=e,n=w.length>=1&&!w.includes(S);(!w||0===w.length||n)&&t$(S,t.shiftKey)(i,o),w.length>1&&w.includes(S)&&!t.shiftKey&&tX(w)(i,o)},[S,w,e]),N=(0,c.useCallback)(()=>{let{state:t,dispatch:i}=e;nV([S])(t,i)},[S,e]),R=(0,c.useCallback)(i=>{let o=i.nativeEvent.target.closest(`.${eu.DRAG_COLUMN_CONTROLS}`),n=i.nativeEvent.target.getAttribute("data-start-index");if(!o||!n)return;let{state:a,dispatch:r}=e;t&&nq(0,Number(n))(a,r)},[e,t]),x=(0,c.useCallback)(()=>{if(t){let{state:t,dispatch:i}=e;nK()(t,i)}},[e,t]),A=(0,c.useCallback)((t,i)=>{let{state:o,dispatch:n}=e;i?.shiftKey||nk(void 0,"column",S,t)(o,n)},[e,S]),I=(0,c.useMemo)(()=>[S],[S]);n&&E.current&&(E.current.scrollLeft=g?.()??0);let L=(t,i,n,l)=>{let c="hover"===t,u="placeholder"===i,h=s?.reduce((e,t)=>e+t,0)??0,m=p?.reduce((e,t,i)=>e+(t??a("1zav4").tableCellMinWidth)*!!l.includes(i),0)??a("1zav4").tableCellMinWidth;return(0,d.jsx)("div",{contentEditable:!1,style:{gridColumn:n,gridRow:"1",display:"flex",justifyContent:"center",alignItems:"center",height:"fit-content",placeSelf:"center",zIndex:99,width:"100%",position:"relative"},"data-testid":`table-floating-column-${c?S:u?i:w[0]}-drag-handle`,children:(0,d.jsx)(r7,{isDragMenuTarget:!c,direction:"column",tableLocalId:r||"",indexes:l,hoveredCell:o,previewWidth:m,forceDefaultHandle:!c,previewHeight:h,appearance:i,onClick:y,onMouseOver:N,onMouseOut:x,toggleDragMenu:A,editorView:e})},t)},k=m&&h?h-a("aFUXX").akEditorTableNumberColumnWidth:h;return(0,d.jsx)("div",{className:eu.DRAG_COLUMN_CONTROLS,onMouseMove:R,children:(0,d.jsxs)("div",{ref:E,className:eu.DRAG_COLUMN_CONTROLS_INNER,"data-testid":"table-floating-column-controls",style:{gridTemplateColumns:C,marginTop:O&&void 0!==n?45:0,width:n?k:void 0,overflowX:n?"hidden":"visible",pointerEvents:f?"none":void 0},children:[_.map(({startIndex:e,endIndex:t},i)=>(0,d.jsx)("div",{style:{gridColumn:`${e+1} / span 1`},"data-start-index":e,"data-end-index":t,className:eu.DRAG_COLUMN_FLOATING_INSERT_DOT_WRAPPER,contentEditable:!1,children:(0,d.jsx)("div",{className:eu.DRAG_COLUMN_FLOATING_INSERT_DOT,style:_.length-1===i?{right:"0"}:{}})},i)),(()=>{let e=[],i=w.length>0,n=(p||[]).length>w.length;if(!t)return null;let a=i&&n?l?"danger":"selected":"placeholder";return e.push(L("selected",a,"placeholder"===a?"1 / span 1":`${w[0]+1} / span ${w.length}`,w)),o&&u&&void 0!==S&&!w.includes(S)&&e.push(L("hover","default",`${S+1} / span 1`,I)),e})()]})})},li=({index:e,localId:t,width:i,height:o,marginTop:n})=>{let r=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(r.current)return(0,oZ.dropTargetForElements)({element:r.current,canDrop({source:i,input:o}){let n=i.data,a=rh(o),r="move"===a?n.indexes?.indexOf(e)===-1:"clone"===a;return"table-column"===n.type&&n.localId===t&&!!n.indexes?.length&&r},getDropEffect:({input:e})=>"clone"===rh(e)?"copy":"move",getIsSticky:()=>!0,getData({source:i,input:o,element:n}){let r=i.data,l="move"===rh(o)?r.indexes?.reduce((t,i)=>(i-e==-1&&t.shift(),i-e==1&&t.pop(),t),["left","right"]):["left","right"];return(0,a("2WHHL").attachClosestEdge)({localId:t,type:"table-column",targetIndex:e},{input:o,element:n,allowedEdges:l})}})},[e,t]),(0,d.jsx)("div",{ref:r,style:{width:i&&`${i-1}px`,height:o&&`${o}px`,marginTop:n&&`${n}px`,pointerEvents:"auto",flexShrink:0},"data-drop-target-index":e,"data-drop-target-localid":t,"data-testid":"table-floating-column-controls-drop-target"})},lo=({tableRef:e,tableHeight:t,localId:i,colWidths:o,isHeaderSticky:n,getScrollOffset:a})=>{let r=(0,c.useRef)(null);return e?(n&&r.current&&(r.current.style.marginLeft=`-${a?.()??0}px`),(0,d.jsx)("div",{ref:r,className:eu.DRAG_COLUMN_DROP_TARGET_CONTROLS,contentEditable:!1,children:(0,d.jsx)("div",{className:eu.DRAG_COLUMN_CONTROLS_INNER,"data-testid":"table-floating-column-controls-drop-targets",children:o?.map((e,o)=>(0,d.jsx)(li,{index:o,localId:i,width:e,height:t,marginTop:0},o))})})):null};var ln=({editorView:e,tableRef:t,getNode:i,tableActive:o,hasHeaderRow:n,hoveredCell:a,isResizing:r,stickyHeader:l,selection:s,isInDanger:p,isTableHovered:u,tableContainerWidth:h,isNumberColumnEnabled:m,getScrollOffset:f,tableWrapperHeight:g,api:b,isChromelessEditor:E,isDragAndDropEnabled:T})=>{let[C,_]=(0,c.useState)(!1),S=(0,c.useRef)(null),w=i(),v=w?.attrs.localId,O=e2(w),y=l&&l.sticky&&n?l.top:void 0;(0,c.useEffect)(()=>(0,oZ.monitorForElements)({canMonitor({source:e}){let{type:t,localId:i,indexes:o}=e.data;return"table-column"===t&&!!o?.length&&i===v},onDragStart(){_(!0)},onDrop(){_(!1)}}),[e,v]);let R=(0,c.useMemo)(()=>t&&g?i8(t):[0],[t,g]);if(!t||!o||r)return null;let x=i0(e);y?S?.current?.style.setProperty("top","-12px"):S?.current?.style.removeProperty("top");let A={};if(rS(T??!1)&&(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")){let e=t.querySelector("tr")?.style.getPropertyValue("anchor-name");A={positionAnchor:""===e?t.querySelector("tr")?.dataset.nodeAnchor:e}}return(0,d.jsxs)("div",{ref:S,className:eu.DRAG_COLUMN_CONTROLS_WRAPPER+(E?" "+eu.TABLE_CHROMELESS:""),"data-testid":"table-floating-column-controls-wrapper",style:A,children:[(0,d.jsx)(lt,{editorView:e,hoveredCell:a,tableRef:t,tableActive:o,isTableHovered:u,stickyTop:o?y:void 0,localId:v,isInDanger:p,rowHeights:R,colWidths:x,hasHeaderColumn:O,tableContainerWidth:h,isNumberColumnEnabled:m,isDragging:C,getScrollOffset:f,api:b}),C&&(0,d.jsx)(lo,{tableRef:t,isHeaderSticky:l?.sticky&&n,tableHeight:g,localId:v,colWidths:x,getScrollOffset:f})]})};let la=(0,a("gmMgo").default)(({editorView:e,isInDanger:i,isResizing:o,intl:{formatMessage:n},api:r})=>{let{selection:l}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(r,["selection"],e=>({selection:e.selectionState?.selection})),s=(0,c.useMemo)(()=>l?!!(0,a("id9O1").findTable)(l)&&(0,a("iYC9s").isTableSelected)(l):void 0,[l]);return o?null:(0,d.jsx)("button",{className:t(rw)(eu.DRAG_CORNER_BUTTON,{active:s,danger:s&&i}),"aria-label":n(a("2CQVV").messages.cornerControl),type:"button",onClick:()=>{let{state:t,dispatch:i}=e;i((0,a("kEbNW").selectTable)(t.tr).setMeta("addToHistory",!1))},onMouseOut:()=>{let{state:t,dispatch:i}=e;nK()(t,i)},contentEditable:!1,children:(0,d.jsx)("div",{className:eu.DRAG_CORNER_BUTTON_INNER})})});(0,a("gmMgo").default)(({editorView:e,isInDanger:i,isResizing:o,intl:{formatMessage:n}})=>{let r=(0,c.useMemo)(()=>{let{selection:t}=e.state;return!!(0,a("id9O1").findTable)(t)&&(0,a("iYC9s").isTableSelected)(t)},[e.state]);return o?null:(0,d.jsx)("button",{className:t(rw)(eu.DRAG_CORNER_BUTTON,{active:r,danger:r&&i}),"aria-label":n(a("2CQVV").messages.cornerControl),type:"button",onClick:()=>{let{state:t,dispatch:i}=e;i((0,a("kEbNW").selectTable)(t.tr).setMeta("addToHistory",!1))},onMouseOut:()=>{let{state:t,dispatch:i}=e;nK()(t,i)},contentEditable:!1,children:(0,d.jsx)("div",{className:eu.DRAG_CORNER_BUTTON_INNER})})}),a("42omo");class lr extends c.Component{render(){let{isInDanger:e,tableRef:i,isHeaderColumnEnabled:o,isHeaderRowEnabled:n,intl:{formatMessage:r}}=this.props;if(!i)return null;let l=this.isActive();return(0,d.jsxs)("div",{className:t(rw)(eu.CORNER_CONTROLS,{active:l,sticky:void 0!==this.props.stickyTop}),style:{top:void 0!==this.props.stickyTop?"0px":void 0},contentEditable:!1,children:[(0,d.jsx)("button",{"aria-label":r(a("2CQVV").messages.cornerControl),type:"button",className:t(rw)(eu.CONTROLS_CORNER_BUTTON,{danger:l&&e}),onClick:this.selectTable,onMouseOver:this.hoverTable,onMouseOut:this.clearHoverSelection}),!n&&(0,d.jsx)("div",{className:eu.CORNER_CONTROLS_INSERT_ROW_MARKER,children:(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_MARKER})}),!o&&(0,d.jsx)("div",{className:eu.CORNER_CONTROLS_INSERT_COLUMN_MARKER,children:(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_MARKER})})]})}constructor(...e){super(...e),this.isActive=()=>{let{editorView:e,hoveredRows:t,isResizing:i}=this.props,{selection:o}=e.state,n=(0,a("id9O1").findTable)(o);return!!n&&((0,a("iYC9s").isTableSelected)(o)||t&&t.length===a("LmqWp").TableMap.get(n.node).height&&!i)},this.clearHoverSelection=()=>{let{state:e,dispatch:t}=this.props.editorView;nK()(e,t)},this.selectTable=()=>{let{state:e,dispatch:t}=this.props.editorView;t((0,a("kEbNW").selectTable)(e.tr).setMeta("addToHistory",!1))},this.hoverTable=()=>{let{state:e,dispatch:t}=this.props.editorView;nj()(e,t)}}}let ll=(0,a("gmMgo").default)(lr);class ls extends c.Component{render(){let{editorView:e,tableRef:t,hoveredRows:i,isInDanger:o,isResizing:n,intl:{formatMessage:r},selection:l}=this.props;if(!t)return null;let{selection:s}=e.state,c=i8(t),p=i7(c),u=t.querySelector("tr"),h=!!u&&u.getAttribute("data-header-row");return(0,d.jsx)("div",{className:eu.ROW_CONTROLS,children:(0,d.jsx)("div",{className:eu.ROW_CONTROLS_INNER,children:p.map(({startIndex:e,endIndex:t,height:p},u)=>{let m=-1;1===u&&h&&void 0!==this.props.stickyTop&&(m+=c[u-1]+iG);let f=void 0!==this.props.stickyTop&&0===u&&h;return(0,d.jsxs)("div",{className:`${eu.ROW_CONTROLS_BUTTON_WRAP} ${oe(e,l||s,i,o,n)} ${f?"sticky":""}`,style:{height:p,marginTop:`${m}px`,top:f?"3px":void 0,paddingTop:f?`${(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?ij-2:ij}px`:void 0},children:[(0,d.jsx)("button",{"aria-label":r(a("2CQVV").messages.rowControl),type:"button",className:`${eu.ROW_CONTROLS_BUTTON} ${eu.CONTROLS_BUTTON}`,onClick:t=>this.props.selectRow(e,t.shiftKey),onMouseOver:()=>this.props.hoverRows([e]),onMouseOut:this.clearHoverSelection,"data-start-index":e,"data-end-index":t}),(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_MARKER})]},e)})})})}constructor(...e){super(...e),this.clearHoverSelection=()=>{let{state:e,dispatch:t}=this.props.editorView;nK()(e,t)}}}let ld=(0,a("gmMgo").default)(ls),lc=({editorView:e,tableRef:t,isInDanger:i,isResizing:o,isHeaderRowEnabled:n,isHeaderColumnEnabled:r,hoveredRows:l,stickyTop:s,hoverRows:c,selectRow:p,tableActive:u,api:h})=>{let{selection:m}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(h,["selection"],e=>({selection:e.selectionState?.selection}));return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(ll,{editorView:e,tableRef:t,isInDanger:i,isResizing:o,isHeaderRowEnabled:n,isHeaderColumnEnabled:r,hoveredRows:l,stickyTop:u?s:void 0}),(0,d.jsx)(ld,{selection:m,editorView:e,tableRef:t,hoverRows:c,hoveredRows:l,isInDanger:i,isResizing:o,selectRow:p,stickyTop:u?s:void 0})]})};class lp extends c.Component{render(){let{tableRef:e,hasHeaderRow:t,isDragAndDropEnabled:i,tableActive:o,updateCellHoverLocation:n}=this.props,r=i8(e);return(0,a("eTj7Y").isSSR)()?(0,d.jsx)("div",{className:eu.NUMBERED_COLUMN,style:{marginTop:t&&void 0!==this.props.stickyTop?r[0]:void 0,borderLeft:i&&o?`1px solid ${ik}`:void 0,visibility:"hidden"},contentEditable:!1}):(0,d.jsx)("div",{className:eu.NUMBERED_COLUMN,style:{marginTop:t&&void 0!==this.props.stickyTop?r[0]:void 0,borderLeft:i&&o?`1px solid ${ik}`:void 0,visibility:"visible"},contentEditable:!1,children:r.map((e,o)=>i?(0,d.jsx)("div",{className:this.getClassNames(o,!0),"data-index":o,style:this.getCellStyles(o,e),onMouseOver:()=>n(o),children:t?o>0?o:null:o+1},`wrapper-${o}`):(0,d.jsx)("div",{className:this.getClassNames(o),"data-index":o,style:this.getCellStyles(o,e),onClick:e=>this.selectRow(o,e),onMouseOver:()=>this.hoverRows(o),onMouseOut:this.clearHoverSelection,children:t?o>0?o:null:o+1},`wrapper-${o}`))})}constructor(...e){super(...e),this.hoverRows=e=>this.props.tableActive?this.props.hoverRows([e]):null,this.selectRow=(e,t)=>{let{tableActive:i,editorView:o,selectRow:n}=this.props;if(!i&&t.target&&t.target instanceof Node){let{doc:e,selection:i,tr:n}=o.state,r=o.posAtDOM(t.target,1),l=e.resolve(r),s=i.head>r?a("ks2lK").Selection.near(e.resolve(r+(l.parent.nodeSize-3)),-1):a("ks2lK").Selection.near(l);o.dispatch(n.setSelection(s))}n(e,t.shiftKey)},this.clearHoverSelection=()=>{let{tableActive:e,editorView:t}=this.props;if(e){let{state:e,dispatch:i}=t;nK()(e,i)}},this.getCellStyles=(e,t)=>{let{stickyTop:i,hasHeaderRow:o}=this.props;return i&&o&&0===e?{height:t,top:"0px"}:{height:t}},this.getClassNames=(e,i=!1)=>{let{hoveredRows:o,editorView:n,isInDanger:r,isResizing:l,tableActive:s}=this.props,d=(0,a("iYC9s").isRowSelected)(e)(n.state.selection)||-1!==(o||[]).indexOf(e)&&!l;return t(rw)(eu.NUMBERED_COLUMN_BUTTON,{[eu.NUMBERED_COLUMN_BUTTON_DISABLED]:i,[eu.HOVERED_CELL_IN_DANGER]:s&&d&&r,[eu.HOVERED_CELL_ACTIVE]:s&&d})}}}var lu=({index:e,localId:t,style:i})=>{let o=(0,c.useRef)(null);return(0,c.useEffect)(()=>{if(o.current)return(0,oZ.dropTargetForElements)({element:o.current,canDrop({source:i,input:o}){let n=i.data,a=rh(o),r="move"===a?n.indexes?.indexOf(e)===-1:"clone"===a;return"table-row"===n.type&&n.localId===t&&!!n.indexes?.length&&r},getDropEffect:({input:e})=>"clone"===rh(e)?"copy":"move",getIsSticky:()=>!0,getData({source:i,input:o,element:n}){let r=i.data,l="move"===rh(o)?r.indexes?.reduce((t,i)=>(i-e==-1&&t.shift(),i-e==1&&t.pop(),t),["top","bottom"]):["top","bottom"];return(0,a("2WHHL").attachClosestEdge)({localId:t,type:"table-row",targetIndex:e},{input:o,element:n,allowedEdges:l})}})},[e,t]),(0,d.jsx)("div",{ref:o,style:i,"data-drop-target-index":e,"data-drop-target-localid":t,"data-testid":"table-floating-row-controls-drop-target"})};let lh=e=>{if(e instanceof a("7XFGZ").CellSelection&&e.isRowSelection()){let t=(0,a("iP1et").getSelectionRect)(e);return t?al(t):[]}return[]},lm=({tableRef:e,tableNode:t,tableWidth:i,hoveredCell:o,tableActive:n,editorView:a,isInDanger:r,isResizing:l,isTableHovered:s,hoverRows:p,selectRow:u,selectRows:h,updateCellHoverLocation:m,api:f,selection:g})=>{let[b,E]=(0,c.useState)(!1),T=i8(e),C=i7(T),_=T.map(e=>`${e-1}px`).join(" "),S=lh(g??a.state.selection),w=t?.attrs?.localId??"";(0,c.useEffect)(()=>(0,oZ.monitorForElements)({canMonitor({source:e}){let{type:t,localId:i,indexes:o}=e.data;if(!o||!i||"table-row"!==t)return!1;let{tableNode:n}=tg(a.state);return i===n?.attrs.localId},onDragStart(){E(!0)},onDrop(){E(!1)}}),[a]);let v=(0,c.useCallback)((e,t)=>{t?.shiftKey||nk(void 0,"row",o?.rowIndex,e)(a.state,a.dispatch)},[a,o?.rowIndex]),O=o?.rowIndex,y=(0,c.useCallback)(()=>{if(n){let{state:e,dispatch:t}=a;nK()(e,t)}},[a,n]),R=(0,c.useCallback)(e=>{let t=e.nativeEvent.target instanceof Element?e.nativeEvent.target:null,i=t?.closest(`.${eu.DRAG_ROW_CONTROLS}`),o=t?.getAttribute("data-start-index");i&&o&&m(Number(o))},[m]),x=(0,c.useMemo)(()=>[O],[O]),A=(0,c.useCallback)(()=>{p([O])},[p,O]),I=(0,c.useCallback)(e=>{let t=S.length>=1&&!S.includes(O);(!S||0===S.length||t)&&u(O,e.shiftKey),S.length>1&&S.includes(O)&&!e.shiftKey&&h(S)},[O,u,h,S]),L=(e,t,n,r)=>{let l="hover"===e,s=T.reduce((e,t,i)=>e+!!r.includes(i)*t,0);return(0,d.jsx)("div",{style:{gridRow:n,gridColumn:"2",display:"flex",width:"9px",height:"100%",position:"relative",right:"-0.5px",pointerEvents:"none"},className:(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")?eu.DRAG_ROW_FLOATING_DRAG_HANDLE:void 0,"data-testid":`table-floating-row-${l?O:S[0]}-drag-handle`,"data-row-index":O,"data-selected-row-index":S[0],"data-handle-appearance":t,children:(0,d.jsx)(r7,{isDragMenuTarget:!l,direction:"row",tableLocalId:w,indexes:r,forceDefaultHandle:!l,previewWidth:i,previewHeight:s,appearance:t,hoveredCell:o,onClick:I,onMouseOver:A,onMouseOut:y,toggleDragMenu:v,editorView:a})},e)};return l?null:(0,d.jsxs)("div",{className:eu.DRAG_ROW_CONTROLS,style:{gridTemplateRows:_,gridTemplateColumns:b?`150px 14px ${i}px`:"0px 14px 0px",left:b?"-152px":"var(--ds-space-negative-025, -2px)"},onMouseMove:R,contentEditable:!1,children:[C.map(({startIndex:e,endIndex:t},i)=>(0,d.jsxs)(c.Fragment,{children:[(0,d.jsx)("div",{style:{gridRow:`${i+1} / span 1`,gridColumn:"2"},"data-start-index":e,"data-end-index":t,className:eu.DRAG_ROW_FLOATING_INSERT_DOT_WRAPPER,contentEditable:!1,children:(0,d.jsx)("div",{className:eu.DRAG_ROW_FLOATING_INSERT_DOT})},`insert-dot-${i}`),b&&(0,d.jsx)(lu,{index:i,localId:w,style:{gridColumn:"1 / span 3",gridRow:`${i+1} / span 1`,height:"100%",pointerEvents:"auto",position:"relative",left:"var(--ds-space-negative-100, -8px)"}},`drop-target-${i}`)]},i)),(()=>{let e=[],t=S.length>0,i=T.length>S.length;return n?(e.push(L("selected",t&&i?r?"danger":"selected":"placeholder",`${S[0]+1} / span ${S.length}`,S)),o&&s&&void 0!==O&&!S.includes(O)&&O<T.length&&e.push(L("hover","default",`${O+1} / span 1`,x)),e):null})()]})},lf=({editorView:e,tableRef:t,tableNode:i,tableWidth:o,tableActive:n,hoveredCell:r,isInDanger:l,isTableHovered:s,isResizing:c,hoverRows:p,selectRow:u,selectRows:h,updateCellHoverLocation:m,api:f})=>{let{selection:g}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(f,["selection"],e=>({selection:e.selectionState?.selection}));return(0,d.jsx)(lm,{editorView:e,tableRef:t,tableNode:i,tableWidth:o,tableActive:n,hoveredCell:r,isInDanger:l,isTableHovered:s,isResizing:c,hoverRows:p,selectRow:u,selectRows:h,updateCellHoverLocation:m,api:f,selection:g})},lg={name:"lr2r3w",styles:"&:has(~ .pm-table-wrapper-no-overflow){margin-top:0;}"};var lb=({editorView:e,tableRef:t,tableNode:i,isInDanger:o,isResizing:n,isNumberColumnEnabled:r,isHeaderRowEnabled:l,isHeaderColumnEnabled:s,tableActive:d,hasHeaderRow:p,hoveredRows:u,stickyHeader:h,isDragAndDropEnabled:m,hoveredCell:f,isTableHovered:g,tableWrapperWidth:b,api:E,isChromelessEditor:T})=>{let C=(0,c.useCallback)((t,i)=>{let{state:o,dispatch:n}=e;11===((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).ie_version&&e.dom.blur(),tZ(t,i)(o,n)},[e]),_=(0,c.useCallback)(t=>{let{state:i,dispatch:o}=e;11===((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).ie_version&&e.dom.blur(),tq(t)(i,o)},[e]),S=(0,c.useCallback)((t,i)=>{let{state:o,dispatch:n}=e;nG(t,i)(o,n)},[e]),w=(0,c.useCallback)(t=>{let{state:i,dispatch:o}=e;d&&nq(t,0)(i,o)},[e,d]);if(!t)return null;let v=h&&h.sticky&&p?h.top:void 0,O=m?T?eu.DRAG_ROW_CONTROLS_WRAPPER+" "+eu.TABLE_CHROMELESS:eu.DRAG_ROW_CONTROLS_WRAPPER:eu.ROW_CONTROLS_WRAPPER,y=(0,a("id9O1").findTable)(e.state.selection)?.pos,R=void 0!==y&&to(e.state,y)&&!(0,a("dh538").fg)("platform_editor_nested_dnd_styles_changes");return(0,a("9K4OG").jsx)("div",{className:O,css:[(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&lg]},(0,a("9K4OG").jsx)("div",{onMouseDown:e=>!m&&e.preventDefault()},r?(0,a("9K4OG").jsx)(lp,{editorView:e,hoverRows:S,tableRef:t,tableActive:d,hoveredRows:u,hasHeaderRow:p,isInDanger:o,isResizing:n,selectRow:C,updateCellHoverLocation:w,stickyTop:v,isDragAndDropEnabled:m}):null,d&&(0,a("9K4OG").jsx)(c.Fragment,null,m?(0,a("9K4OG").jsx)(c.Fragment,null,R&&(0,a("9K4OG").jsx)(la,{editorView:e,tableRef:t,isInDanger:o,isResizing:n,api:E}),(0,a("9K4OG").jsx)(lf,{tableRef:t,tableNode:i,hoveredCell:f,isTableHovered:g,editorView:e,tableActive:d,isInDanger:o,isResizing:n,tableWidth:b,hoverRows:S,selectRow:C,selectRows:_,updateCellHoverLocation:w,api:E})):(0,a("9K4OG").jsx)(lc,{editorView:e,tableRef:t,isInDanger:o,isResizing:n,isHeaderRowEnabled:l,isHeaderColumnEnabled:s,hoveredRows:u,stickyTop:d?v:void 0,tableActive:d,hoverRows:S,selectRow:C,api:E}))))};let lE=({editorView:e,node:t,getScrollOffset:i,getTableWrapperWidth:o})=>{let[n,r]=(0,c.useState)(!1),l=t?.attrs.localId;if((0,c.useEffect)(()=>(0,oZ.monitorForElements)({canMonitor({source:e}){let{type:t,indexes:i,localId:o}=e.data;return"table-column"===t&&!!i?.length&&o===l},onDragStart(){r(!0)},onDrop(){r(!1)}}),[l,e]),!n)return null;let s=i0(e);return(0,d.jsx)("div",{style:{width:o(),overflow:"hidden",position:"absolute",top:`-${150-a("1zav4").tableMarginTop}px`,pointerEvents:"auto",zIndex:"14"},"data-testid":"table-floating-column-extended-drop-targets",children:(0,d.jsx)("div",{style:{display:"flex",marginLeft:`-${i()}px`},children:s?.map((e,t)=>(0,d.jsx)(li,{index:t,localId:l,width:e,height:150,marginTop:0},t))})})};var lT=a("dZ8uq");let lC=(e,t=!1)=>Array.from(new Set(e)).reduce((i,o,n)=>{let a=.5*o;return 0===o?[...i,{left:0,right:0,length:o}]:a&&Number.isFinite(o)?[...i,{left:-a,right:a,length:o,...t&&n===e.length-1?{isFullWidth:!0}:{}}]:i},[]),l_=(e,t="guide",i=!1)=>lC(e,i).reduce((e,{left:i,right:o,length:n,isFullWidth:a})=>0===n?[...e,{key:`${t}-${n}-centre`,position:{x:i}}]:[...e,{key:`${t}-${n}-left`,position:{x:i}},{key:`${t}-${n}-right`,position:{x:o},...a?{isFullWidth:!0}:{}}],[]),lS=(e,t)=>Array(Math.round(e/2)-1).fill(t/e).map((e,t)=>e*(t+1)*2),lw=(e=0)=>[...lS(12,a("aFUXX").akEditorDefaultLayoutWidth+e),a("aFUXX").akEditorDefaultLayoutWidth+e,a("aFUXX").akEditorCalculatedWideLayoutWidth+e,a("aFUXX").akEditorFullWidthLayoutWidth+e],lv=e=>e<=a("aFUXX").akEditorFullPageNarrowBreakout&&(0,g.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?a("aFUXX").akEditorGutterPaddingReduced:(0,a("aFUXX").akEditorGutterPaddingDynamic)(),lO=(e=0,t=a("aFUXX").akEditorFullWidthLayoutWidth,i={innerGuidelines:!1,breakoutPoints:!1})=>{let o=lv(t),n=t-2*o>=a("aFUXX").akEditorFullWidthLayoutWidth?a("aFUXX").akEditorFullWidthLayoutWidth:t-2*o,r=t-2*o>=a("aFUXX").akEditorMaxWidthLayoutWidth?a("aFUXX").akEditorMaxWidthLayoutWidth:t-2*o,l=[n-e];return((0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0))&&l.push(r-e),i.breakoutPoints||l.unshift(a("aFUXX").akEditorDefaultLayoutWidth+e,a("aFUXX").akEditorCalculatedWideLayoutWidth+e),i.innerGuidelines||l.unshift(0,...lS(12,a("aFUXX").akEditorDefaultLayoutWidth+e)),l},ly=lw(),lN=(e,t,i={innerGuidelines:!1,breakoutPoints:!1})=>{let o=lv(t);return t-2*o>a("aFUXX").akEditorFullWidthLayoutWidth?lw():lO(e,t,i)},lR=(e,t,i,o=0,n=0)=>{let r=t.reduce((i,o,n)=>Math.abs(o-e)<Math.abs(t[i]-e)?n:i,0),l=Math.abs(t[r]-e);if(l<o){let e=Math.round(t[r]);return{gap:l,keys:i.reduce((t,i)=>{let o=Math.round(2*Math.abs((0,a("4HPW1").isVerticalPosition)(i.position)?i.position.x:i.position.y));return e>=o-n&&e<=o+n&&t.push(i.key),t},[])}}return{gap:l,keys:[]}},lx=l_([0,...lw(-1)]),lA=(e,t,i={innerGuidelines:!1,breakoutPoints:!1})=>l_(lO(e,t,i),void 0,!0),lI={right:!0},lL={right:{right:"-14px",marginTop:"var(--ds-space-150, 12px)"}},lk=e=>{let t=e?.clientHeight??0;return t>=96?"large":t>46?"medium":"small"},lM=e=>48*Math.min(3,q(e))+1,lD=e=>e<=a("aFUXX").akEditorFullPageNarrowBreakout&&(0,g.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?a("aFUXX").akEditorGutterPaddingReduced:(0,a("aFUXX").akEditorGutterPaddingDynamic)(),lP=(e,t,i,o,n)=>{let a=-68;if(o){let e=lD(t);a=n?2:-2*e+2}let r=o&&n?i:t;return e.filter(e=>e.position&&void 0!==e.position.x&&"number"==typeof e.position.x&&Math.abs(2*e.position.x)<r+a)},lB=e=>({widthToWidest:e.tableState?.widthToWidest}),lW=({children:e,width:i,maxWidth:o,containerWidth:n,lineLength:r,updateWidth:l,onResizeStop:s,onResizeStart:p,editorView:u,getPos:h,node:m,tableRef:f,displayGuideline:g,attachAnalyticsEvent:b,displayGapCursor:E,isTableScalingEnabled:T,isTableWithFixedColumnWidthsOptionEnabled:C,isTableAlignmentEnabled:_,isWholeTableInDanger:S,shouldUseIncreasedScalingPercent:w,pluginInjectionApi:v,isFullWidthModeEnabled:O,isCommentEditor:y,disabled:R})=>{let x=(0,c.useRef)(0),A=(0,c.useRef)(!1),I=(0,c.useRef)(!1),L=(0,c.useRef)(null),k=(0,a("b3YrF").useSharedPluginStateSelector)(v,"interaction.interactionState"),{widthToWidest:M}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(v,["table"],lB),D=t(c).useRef(),[P,B]=(0,c.useState)(!1),{formatMessage:W}=(0,a("8C5kA").default)(),U=!!v?.toolbar,H=u.state?.selection,F=(0,c.useMemo)(()=>(0,a("id9O1").findTable)(H),[H]),z=F?.pos,V=(0,c.useMemo)(()=>{let e;if("number"!=typeof z||"hasNotHadInteraction"===k)return!1;try{e=h()}catch(e){return(0,a("hWRJP").logException)(e,{location:"editor-plugin-table/table-resizer"}),!1}return z===e},[z,k,h]),G=lM(m),j=lk(f),{startMeasure:K,endMeasure:$,countFrames:X}=iy(),Z=(0,c.useMemo)(()=>({innerGuidelines:!!_,breakoutPoints:!!(_&&O)}),[O,_]),q=(0,c.useCallback)(({gap:e,keys:t})=>{if(e!==x.current){x.current=e;let i=lP(T?lA(-1,O?r+2*lD(n):n,Z):lx,n,r,!!T,!!O);g((0,a("6MTPr").getGuidelinesWithHighlights)(e,9,t,i))}},[T,Z,n,g,r,O]),Y=(0,c.useMemo)(()=>P?{x:T?lN(0,O?r+2*lD(n):n,Z):ly}:void 0,[P,T,Z,n,r,O]),ei=(0,c.useCallback)((e,t,i,o,n)=>!!et(_,t,r,i)&&!!A.current&&(aZ(v?.analytics?.actions)(J,Q,{pos:e,node:t},a("d925B").INPUT_METHOD.AUTO,a("3824I").CHANGE_ALIGNMENT_REASON.EDITOR_APPEARANCE_CHANGED)(o,n),!0),[_,r,v?.analytics?.actions]);(0,c.useEffect)(()=>()=>{if(A.current){let{dispatch:e,state:{tr:t}}=u;E(!0),g([]),t.setMeta(em,{resizing:!1,tableLocalId:"",tableRef:null}),e(t)}},[u,g,E]);let eo=(0,c.useCallback)(()=>{(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.startFeature("tableResize"),K(),A.current=!0;let{dispatch:e,state:{tr:t}}=u;E(!1),t.setMeta(em,{resizing:!0,tableLocalId:m.attrs.localId,tableRef:f}),t.setMeta("is-resizer-resizing",!0),t.setMeta(iE.OVERFLOW_TRIGGER,{name:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.RESIZED}),((0,lT.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)||U||(0,lT.expValEqualsNoExposure)("platform_editor_lovability_user_intent","isEnabled",!0))&&v?.userIntent?.commands.setCurrentUserIntent("resizing")({tr:t}),e(t),B(g(lP(T?lA(-1,O?r+2*lD(n):n,Z):lx,n,r,!!T,!!O))),p&&p()},[K,u,E,m.attrs.localId,f,U,T,O,r,n,Z,g,p,v?.userIntent?.commands]),en=(0,c.useCallback)((e,t)=>{let i;X();let o=e.width+t.width;try{i=h()}catch{return}if("number"!=typeof i)return;let s=O?r+2*lD(n):n,d=!y&&lR(o,T?lN(0,s,Z):ly,T?lA(-1,s,Z):lx,10,2);d&&q(d);let{state:c,dispatch:p}=u,g=m?.attrs?.localId??"",b=lA(-1,s,Z).filter(e=>e.isFullWidth)[0],E=(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?d&&b&&d.keys.includes(b.key):d&&d.keys.includes(b.key),_=y?Math.floor(n-64):(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800,S=y?_<=o:!!T&&E;return ox(f,{node:m,prevNode:m,start:i+1,parentWidth:y&&S?_:o},u.domAtPos.bind(u),T,C,y),(0,a("astHL").chainCommands)((e,t)=>ei(i,m,o,e,t),t5({[g]:S}))(c,p),l(S?_:o),o},[X,y,T,C,O,Z,f,m,u,q,n,r,l,h,ei]),ea=(0,c.useMemo)(()=>(0,a("2P8Ax").default)(en),[en]),er=(0,c.useCallback)((e,t)=>{A.current=!1;let i=e.width+t.width,o=i,{state:n,dispatch:r}=u,d=h(),c=m?.attrs?.localId??"",p=y?void 0:(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800;i=M&&c&&M[c]?p:i;let C=n.tr.setMeta(em,{resizing:!1,tableLocalId:"",tableRef:null});C.setMeta("is-resizer-resizing",!1),((0,lT.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)||U||(0,lT.expValEqualsNoExposure)("platform_editor_lovability_user_intent","isEnabled",!0))&&v?.userIntent?.commands.setCurrentUserIntent("default")({tr:C});let _=$();if(_.length>0&&iO({docSize:n.doc.nodeSize,frameRateSamples:_,originalNode:m}).forEach(e=>{b(e)?.(C)}),"number"==typeof d){let e=(C=oA(f,{node:(C=C.setNodeMarkup(d,void 0,{...m.attrs,width:i,layout:m.attrs.layout!==Q&&m.attrs.layout!==J?J:m.attrs.layout})).doc.nodeAt(d),prevNode:m,start:d+1,parentWidth:y?o:i},u.domAtPos.bind(u),v,T,w||!1,y)(C)).doc.nodeAt(d);b(iw({originalNode:m,resizedNode:e}))?.(C)}return E(!0),r(C),t.width<0&&void 0!==i?v?.accessibilityUtils?.actions.ariaNotify(W(a("2CQVV").messages.tableSizeDecreaseScreenReaderInformation,{newWidth:i})):t.width>0&&void 0!==i&&v?.accessibilityUtils?.actions.ariaNotify(W(a("2CQVV").messages.tableSizeIncreaseScreenReaderInformation,{newWidth:i})),g([]),void 0!==i&&l(i),ea.cancel(),s&&s(),(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableResize"),i},[u,h,m,y,M,U,$,E,g,l,ea,s,v,b,f,T,w,W]),el=(0,c.useCallback)(e=>{i+e<G||er({width:i,x:0,y:0,height:0},{width:e,height:0})},[i,er,G]),es=(0,c.useCallback)(()=>{u?.focus()},[u]),ed=(0,c.useCallback)(e=>{let t="BracketRight"===e.code||"BracketLeft"===e.code,i=((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).mac?e.metaKey:e.ctrlKey;(e.altKey||i||e.shiftKey)&&(I.current=!0),e.altKey&&i?t&&(e.preventDefault(),el("BracketRight"===e.code?10:-10)):I.current||es()},[es,el]),ec=(0,c.useCallback)(e=>{(e.altKey||e.metaKey)&&(I.current=!1)},[I]);(0,c.useLayoutEffect)(()=>{if(!L.current)return;let e=L.current.getResizerThumbEl(),t=t=>{let i=((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).mac?t.metaKey:t.ctrlKey;if(V&&t.altKey&&t.shiftKey&&i&&"KeyR"===t.code){if(t.preventDefault(),!e)return;e.focus(),e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},i=u?.dom;return i?.addEventListener("keydown",t),e?.addEventListener("keydown",ed),e?.addEventListener("keyup",ec),()=>{i?.removeEventListener("keydown",t),e?.removeEventListener("keydown",ed),e?.removeEventListener("keyup",ec)}},[L,u,er,V,ed,ec]),(0,c.useLayoutEffect)(()=>{D.current?.()},[i]);let ep=!_||_&&ee(m.attrs.layout)===J?2:1;return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(a("8b5jG").default,{ref:L,enable:R?{}:lI,width:i,handleAlignmentMethod:"sticky",handleSize:j,handleStyles:lL,handleResizeStart:eo,handleResize:ea,handleResizeStop:er,resizeRatio:ep,minWidth:G,maxWidth:o,snapGap:9,snap:Y,handlePositioning:"adjacent",isHandleVisible:V,needExtendedResizeZone:!V,appearance:V&&S?"danger":void 0,handleHighlight:"shadow",handleTooltipContent:({update:e})=>(D.current=e,(0,d.jsx)(a("hgeg8").ToolTipContent,{description:W(a("2CQVV").messages.resizeTable),keymap:a("hgeg8").focusTableResizer})),"data-vc-nvs":"true",children:e})})},lU=(0,c.forwardRef)(({className:e,style:t,node:i,children:o},n)=>(0,d.jsx)("div",{ref:n,style:t,className:e,"data-number-column":i.attrs.isNumberColumnEnabled,"data-layout":i.attrs.layout,"data-testid":"table-container",children:o})),lH=({node:e,children:t,pluginInjectionApi:i,getPos:o,editorView:n})=>{let r=e.attrs.layout!==Q?J:Q,{isFullWidthModeEnabled:l,wasFullWidthModeEnabled:s}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(i,["table"],e=>({isFullWidthModeEnabled:e.tableState?.isFullWidthModeEnabled,wasFullWidthModeEnabled:e.tableState?.wasFullWidthModeEnabled}));(0,c.useEffect)(()=>{if(n&&o){let{state:t,dispatch:d}=n;if(s&&void 0!==l&&!l&&r!==J&&e.attrs.width>a("aFUXX").akEditorDefaultLayoutWidth){let n=o&&o();if("number"!=typeof n)return;aZ(i?.analytics?.actions)(J,r,{pos:n,node:e},a("d925B").INPUT_METHOD.AUTO,a("3824I").CHANGE_ALIGNMENT_REASON.EDITOR_APPEARANCE_CHANGED)(t,d)}}},[n,l,s,e]);let p=(0,c.useMemo)(()=>en(r),[r]);return(0,d.jsx)("div",{"data-testid":"table-alignment-container","data-ssr-placeholder":`table-${e.attrs.localId}`,"data-ssr-placeholder-replace":`table-${e.attrs.localId}`,style:p,children:t})},lF=({isTableAlignmentEnabled:e,node:t,children:i,pluginInjectionApi:o,getPos:n,editorView:a})=>e?(0,d.jsx)(lH,{node:t,pluginInjectionApi:o,getPos:n,editorView:a,children:i}):(0,d.jsx)("div",{"data-testid":"table-alignment-container","data-ssr-placeholder":`table-${t.attrs.localId}`,"data-ssr-placeholder-replace":`table-${t.attrs.localId}`,style:{display:"flex",justifyContent:"center"},children:i}),lz=e=>({tableState:e.tableState,editorViewModeState:e.editorViewModeState}),lV=e=>e<=a("aFUXX").akEditorFullPageNarrowBreakout&&(0,g.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?a("aFUXX").akEditorGutterPaddingReduced:(0,a("aFUXX").akEditorGutterPaddingDynamic)(),lG=t(c).memo(({children:e,className:i,node:o,containerWidth:n,lineLength:r,editorView:l,getPos:s,tableRef:p,isResizing:u,pluginInjectionApi:h,tableWrapperHeight:m,isWholeTableInDanger:f,isTableScalingEnabled:g,isTableWithFixedColumnWidthsOptionEnabled:b,isTableAlignmentEnabled:E,shouldUseIncreasedScalingPercent:T,isCommentEditor:C,isChromelessEditor:_})=>{let S=(0,a("6fQl1").getTableContainerWidth)(o),w=(0,c.useRef)(null),v=(0,c.useRef)(a("aFUXX").akEditorDefaultLayoutWidth),[O,y]=(0,c.useState)(!1),{tableState:R,editorViewModeState:x}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(h,["table","editorViewMode"],lz),A=R?.isFullWidthModeEnabled,I=x?.mode,L=(0,c.useCallback)(e=>{let t=w.current?.getElementsByClassName("pm-table-sticky");if(!t||t.length<1)return"number"==typeof e?`${e+40.5}px`:"auto";{let t=w.current?.getElementsByTagName("th")[0].getBoundingClientRect().height||0;return"number"==typeof e?`${e+t+39.5}px`:"auto"}},[]),k=(0,c.useCallback)(()=>{y(!0)},[]),M=(0,c.useCallback)(()=>{y(!1)},[]),P=(0,c.useCallback)(e=>{w.current&&w.current.style.width!==`${e}px`&&(w.current.style.width=`${e}px`)},[]),B=(0,c.useCallback)(e=>h?.guideline?.actions?.displayGuideline(l)({guidelines:e})??!1,[h,l]),U=(0,c.useCallback)(e=>h?.analytics?.actions.attachAnalyticsEvent(e),[h]),H=(0,c.useCallback)(e=>h?.core?.actions.execute(h?.selection?.commands.displayGapCursor(e))??!1,[h]),F=!C&&!_,{width:z,maxResizerWidth:V}=(0,c.useMemo)(()=>{let e=0,t=lV(n);return A?(e=g?r:n-2*t-12,(0,a("dh538").fg)("platform_editor_table_fw_numcol_overflow_fix")&&g&&!Number.isFinite(e)&&(e=n-2*t-12)):e=C?n-64:g?n-2*t:n-2*t-12,{width:Math.max(!o.attrs.width&&C?e:Math.min(S,e),Math.min(.5*e,300)),maxResizerWidth:C?e:Math.min(e,(0,N.expValEquals)("editor_tinymce_full_width_mode","isEnabled",!0)||(0,N.expValEquals)("confluence_max_width_content_appearance","isEnabled",!0)?4e3:1800)}},[n,C,A,g,r,o.attrs.width,S]);(0,c.useEffect)(()=>{u||(v.current=z)},[z,u]);let G=(0,c.useMemo)(()=>W(o,g),[o,g]),j=t(c).useMemo(()=>{let e=C||_?V:D(C,_,g);return u?V:e},[C,_,g,u,V]),K="view"===I;return(0,d.jsx)(lF,{isTableAlignmentEnabled:E,node:o,pluginInjectionApi:h,getPos:s,editorView:l,children:(0,d.jsx)("div",{style:{"--ak-editor-table-gutter-padding":"calc(var(--ak-editor--large-gutter-padding) * 2)","--ak-editor-table-width":F?G:`${v.current}px`,width:"var(--ak-editor-table-width)",height:O?L(m??"auto"):"auto",position:K?"relative":"unset"},className:eu.TABLE_RESIZER_CONTAINER,ref:w,children:(0,d.jsx)(lW,{...{width:z,maxWidth:j,containerWidth:n,lineLength:r,updateWidth:P,editorView:l,getPos:s,node:o,tableRef:p,displayGuideline:B,attachAnalyticsEvent:U,displayGapCursor:H,isTableAlignmentEnabled:E,isFullWidthModeEnabled:A,isTableScalingEnabled:g,isTableWithFixedColumnWidthsOptionEnabled:b,isWholeTableInDanger:f,shouldUseIncreasedScalingPercent:T,pluginInjectionApi:h,onResizeStart:k,onResizeStop:M,isCommentEditor:C},disabled:K,children:(0,d.jsx)(lU,{className:i,node:o,children:e})})})})}),lj=({children:e,node:i,className:o,containerWidth:{width:n,lineLength:r},editorView:l,getPos:s,tableRef:c,isNested:p,tableWrapperHeight:u,isResizing:h,pluginInjectionApi:m,isWholeTableInDanger:f,isTableResizingEnabled:g,isTableScalingEnabled:b,isTableWithFixedColumnWidthsOptionEnabled:E,isTableAlignmentEnabled:T,shouldUseIncreasedScalingPercent:C,isCommentEditor:_,isChromelessEditor:S})=>{if(g&&!p)return(0,d.jsx)(lG,{className:o,node:i,containerWidth:n,lineLength:r,editorView:l,getPos:s,tableRef:c,tableWrapperHeight:u,isResizing:h,pluginInjectionApi:m,isTableScalingEnabled:b,isTableWithFixedColumnWidthsOptionEnabled:E,isWholeTableInDanger:f,isTableAlignmentEnabled:T,shouldUseIncreasedScalingPercent:C,isCommentEditor:_,isChromelessEditor:S,children:e});let{isDragAndDropEnabled:w}=tg(l.state),v=_||S?"calc(100cqw - calc(var(--ak-editor--large-gutter-padding) * 2))":W(i,b);return(0,d.jsx)(lU,{node:i,className:t(rw)(o,{"less-padding":n<a("aFUXX").akEditorMobileBreakoutPoint&&!p&&!(S&&w)}),style:{width:"inherit",marginLeft:S?18:void 0,"--ak-editor-table-width":v},children:e})};class lK{dispose(){this.stickyScrollbarContainerElement&&this.stickyScrollbarContainerElement.removeEventListener("scroll",this.handleScroll),this.deleteIntersectionObserver()}scrollLeft(e){this.stickyScrollbarContainerElement&&(this.stickyScrollbarContainerElement.scrollLeft=e)}init(){this.wrapper&&(this.stickyScrollbarContainerElement=this.wrapper.parentElement?.querySelector(`.${eu.TABLE_STICKY_SCROLLBAR_CONTAINER}`),this.stickyScrollbarContainerElement&&this.stickyScrollbarContainerElement.addEventListener("scroll",this.handleScroll,{passive:!0}),this.createIntersectionObserver())}createIntersectionObserver(){if(this.editorScrollableElement=(0,a("7YjFd").findOverflowScrollParent)(this.view.dom)||window.document,!this.editorScrollableElement||!this.wrapper)return;this.intersectionObserver=new IntersectionObserver((e,t)=>{this.stickyScrollbarContainerElement&&e.forEach(e=>{let t=e.target;e.rootBounds?.height!==0&&(t.classList.contains(eu.TABLE_STICKY_SCROLLBAR_SENTINEL_BOTTOM)&&this.sentinelBottomCallback(e),t.classList.contains(eu.TABLE_STICKY_SCROLLBAR_SENTINEL_TOP)&&this.sentinelTopCallback(e))})},{root:this.editorScrollableElement});let e=this.wrapper?.parentElement?.getElementsByClassName(eu.TABLE_STICKY_SCROLLBAR_SENTINEL_BOTTOM);this.sentinels.bottom=e?.item(e.length-1),this.sentinels.top=this.wrapper?.parentElement?.getElementsByClassName(eu.TABLE_STICKY_SCROLLBAR_SENTINEL_TOP)?.item(0),[this.sentinels.bottom,this.sentinels.top].forEach(e=>{null!==e&&this.intersectionObserver&&this.intersectionObserver.observe(e)})}deleteIntersectionObserver(){this.intersectionObserver&&(this.sentinels.bottom&&this.intersectionObserver.unobserve(this.sentinels.bottom),this.intersectionObserver.disconnect())}sentinelBottomCallback(e){let t=e.boundingClientRect.top<(e.rootBounds?.top||0)||e.boundingClientRect.top<.2*(e.rootBounds?.height||0);this.bottomSentinelState=t?"above":e.isIntersecting?"visible":"below",this.toggle()}sentinelTopCallback(e){let t=(e.rootBounds?.bottom||0)<e.boundingClientRect.top;this.topSentinelState=t?"below":e.isIntersecting?"visible":"above",this.toggle()}toggle(){("visible"===this.topSentinelState||"above"===this.topSentinelState)&&"below"===this.bottomSentinelState?this.show():this.hide()}hide(){this.stickyScrollbarContainerElement&&"none"!==this.stickyScrollbarContainerElement.style.display&&(this.stickyScrollbarContainerElement.style.display="none")}show(){this.stickyScrollbarContainerElement&&"block"!==this.stickyScrollbarContainerElement.style.display&&(this.stickyScrollbarContainerElement.style.display="block")}constructor(e,t){this.wrapper=void 0,this.view=void 0,this.editorScrollableElement=void 0,this.intersectionObserver=void 0,this.stickyScrollbarContainerElement=void 0,this.sentinels={},this.topSentinelState=void 0,this.bottomSentinelState=void 0,this.handleScroll=e=>{this.stickyScrollbarContainerElement&&this.wrapper&&e.target===this.stickyScrollbarContainerElement&&(this.wrapper.scrollLeft=this.stickyScrollbarContainerElement.scrollLeft)},this.wrapper=e,this.view=t,(0,g.editorExperiment)("platform_editor_exp_lazy_node_views",!0)?requestAnimationFrame(()=>{this.init()}):this.init()}}class l$ extends t(c).Component{componentDidMount(){let{observe:e}=(0,a("92LVN").nodeVisibilityManager)(this.props.view.dom);this.table&&(this.nodeVisibilityObserverCleanupFn=e({element:this.table,onFirstVisible:()=>{this.initialiseEventListenersAfterMount(),this.wrapper&&(this.wrapperWidth=this.wrapper?.clientWidth)}}),window.addEventListener("resize",this.handleWindowResizeNewDebounced))}initialiseEventListenersAfterMount(){let{allowColumnResizing:e,allowTableResizing:t,eventDispatcher:i,isDragAndDropEnabled:o,getNode:n}=this.props,r=11===((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).ie_version;this?.table?.addEventListener("mouseenter",this.handleMouseEnter),this?.table?.addEventListener("mouseout",this.handleMouseOut),this?.table?.addEventListener("mouseover",this.handleMouseOver),this.wrapper&&(this.wrapperReisizeObserver=new ResizeObserver(e=>{for(let t of e)this.wrapperWidth=t.contentRect?.width}),this.wrapperReisizeObserver.observe(this.wrapper)),e&&this.wrapper&&!r&&(this.wrapper.addEventListener("scroll",this.handleScrollDebounced,{passive:!0}),this.table&&!this.isNestedInTable&&(this.stickyScrollbar=new lK(this.wrapper,this.props.view)),o&&(this.dragAndDropCleanupFn=(0,oX.combine)(...rx({tableWrapper:this.wrapper,getNode:n})))),e&&(t||window.addEventListener("resize",this.handleWindowResizeDebounced),this.handleTableResizingDebounced());let l=rA.getState(this.props.view.state);l&&this.onStickyState(l),i.on(rA.key,this.onStickyState)}componentWillUnmount(){let{allowColumnResizing:e,allowTableResizing:t,eventDispatcher:i,isDragAndDropEnabled:o,view:n,isInDanger:r}=this.props,l=11===((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).ie_version;this.wrapper&&!l&&this.wrapper.removeEventListener("scroll",this.handleScrollDebounced),o&&this.dragAndDropCleanupFn&&this.dragAndDropCleanupFn(),this.nodeVisibilityObserverCleanupFn&&this.nodeVisibilityObserverCleanupFn(),this.resizeObserver?.disconnect(),this.wrapperReisizeObserver?.disconnect(),this.stickyScrollbar&&this.stickyScrollbar.dispose(),this.handleScrollDebounced.cancel(),this.scaleTableDebounced.cancel(),this.handleTableResizingDebounced.cancel(),this.handleAutoSizeDebounced.cancel(),t||this.handleWindowResizeDebounced.cancel(),this.handleWindowResizeNewDebounced.cancel(),r&&nK()(n.state,n.dispatch),!t&&e&&window.removeEventListener("resize",this.handleWindowResizeDebounced),window.removeEventListener("resize",this.handleWindowResizeNewDebounced),this?.table?.removeEventListener("mouseenter",this.handleMouseEnter),this?.table?.removeEventListener("mouseout",this.handleMouseOut),this?.table?.removeEventListener("mouseover",this.handleMouseOver),i.off(rA.key,this.onStickyState),this.initialOverflowCaptureTimerId&&clearTimeout(this.initialOverflowCaptureTimerId)}removeInlineTableWidth(){let{isResizing:e,getNode:t,view:i,getPos:o}=this.props;if(!this.table)return;let n=t().attrs.width,a=o()||0;0===i.state.doc.resolve(a).depth&&(e||null!==n||(this.table.style.width=""))}handleColgroupUpdates(e=!1){let{getNode:t,containerWidth:i,isResizing:o,view:n,getPos:r,getEditorFeatureFlags:l,options:s}=this.props;if(!this.table)return;this.table.style.width="";let d=t(),c=r()||0;if(0!==n.state.doc.resolve(c).depth)return;let p=(0,a("6fQl1").getTableContainerWidth)(d),u=1800===p&&this.wasResizing&&!o,h=p!==this.tableNodeWidth,m=s?.isCommentEditor?i.width-65:i.width-76;p=s?.isCommentEditor&&!d.attrs.width?m:p;let f=m<p,g=d.attrs.isNumberColumnEnabled!==this.node.attrs.isNumberColumnEnabled,b=e7(d,this.node),{width:E,lineLength:T}=i,C=this.containerWidth?.lineLength!==T,_=this.updateColGroupFromFullWidthChange&&C,S=f||h||u&&!s?.isCommentEditor||g||b||this.state.windowResized;if(e||S||_){let t=this.containerWidth?.width!==E,i=$(this.node),r=$(d),s=this.node.attrs.displayMode!==d.attrs.displayMode,p=this.shouldUpdateColgroup({isWindowResized:this.state.windowResized,isWidthChanged:t,isTableWidthChanged:h,isColumnsDistributed:i&&!r,isTableResizedFullWidth:u,isTableDisplayModeChanged:s,isNumberColumnChanged:g,isNumberOfColumnsChanged:b,isFullWidthModeAndLineLengthChanged:_,isTableResized:r}),{tableWithFixedColumnWidthsOption:f=!1}=l(),T=!!this.props.options?.isTableScalingEnabled&&f,C=T||!!this.props.options?.isTableScalingEnabled&&!!this.props.options?.isCommentEditor;if(e||!o&&p){let e=od({minWidth:48,maxSize:d.attrs.isNumberColumnEnabled?m-a("aFUXX").akEditorTableNumberColumnWidth:m,table:d,tableRef:this.table,start:c,domAtPos:n.domAtPos.bind(n),isTableScalingEnabled:!0,shouldUseIncreasedScalingPercent:C,isCommentEditor:!!this.props.options?.isCommentEditor}),t=!1;this.props.options?.isTableScalingEnabled&&!f&&(t=!0),T&&"fixed"!==d.attrs.displayMode&&(t=!0),this.props.options?.isTableScalingEnabled&&this.props.options?.isCommentEditor&&(t=!0);let i=1;requestAnimationFrame(()=>{i=!this.props.options?.isCommentEditor||this.props.options?.isCommentEditor&&d.attrs.width?U(d,this.table,C):H(d,this.table),oc(e,this.table,d,t,i)})}}_&&(this.updateColGroupFromFullWidthChange=!1),this.tableNodeWidth=p,this.wasResizing=o,this.containerWidth=i}componentDidUpdate(e,t){let{getNode:i,isMediaFullscreen:o,allowColumnResizing:n,allowTableResizing:a,isResizing:r,options:l,isTableScalingEnabled:s,getPos:d,getEditorFeatureFlags:c}=this.props,p=!1,u=!1,{tableWithFixedColumnWidthsOption:h=!1}=c();s&&!h&&(p=!0,u=!0);let m=!!s&&h,f=m||!!s&&!!this.props.options?.isCommentEditor;m&&"fixed"!==i().attrs.displayMode&&(p=!0,u=!0),u&&this.handleColgroupUpdates(),this.props.options?.isCommentEditor&&a&&!l?.isTableScalingEnabled&&this.removeInlineTableWidth();let g=i(),b=this.node,E=e7(g,b),T=te(g,b);if((E||T)&&this.props.pluginInjectionApi?.accessibilityUtils?.actions.ariaNotify(nH(b,g,this.props.intl),{priority:"important"}),g.attrs.__autoSize)this.handleAutoSizeDebounced();else if(n&&this.table&&!o){if(e6(g,b)||E){let{view:e}=this.props;if(!a||!r||E&&r){let t=d()||0;p=0===e.state.doc.resolve(t).depth&&p,K(this.table,g,p,void 0,f,l?.isCommentEditor)}oi()(e.state)}this.handleTableResizingDebounced()}}observeTable(e){e&&this.resizeObserver?.observe(e)}render(){let e,{view:i,getNode:o,isResizing:n,allowControls:r=!0,isHeaderRowEnabled:l,ordering:s,isHeaderColumnEnabled:c,tableActive:p,containerWidth:u,options:h,getPos:m,pluginInjectionApi:f,isDragAndDropEnabled:g,getEditorFeatureFlags:b,isTableScalingEnabled:E,allowTableResizing:T,allowTableAlignment:C,selection:_,isInDanger:S,hoveredRows:w,hoveredCell:v,isTableHovered:O,isWholeTableInDanger:y}=this.props,N=o(),R=this.table||void 0,x=R?R.querySelector("tr[data-header-row]"):void 0,A=e9(N),I=(0,d.jsx)(lb,{editorView:i,tableRef:R,tableNode:N,tableActive:p,hoveredRows:w,hoveredCell:v,isTableHovered:O,isInDanger:S,isResizing:n,isNumberColumnEnabled:N.attrs.isNumberColumnEnabled,isHeaderRowEnabled:l,isDragAndDropEnabled:g,ordering:s,isHeaderColumnEnabled:c,hasHeaderRow:A,selection:i.state.selection,headerRowHeight:x?x.offsetHeight:void 0,stickyHeader:this.props.limitedMode?void 0:this.state.stickyHeader,tableWrapperWidth:this.state.tableWrapperWidth,api:f,isChromelessEditor:h?.isChromelessEditor}),L=(0,a("6fQl1").getTableContainerWidth)(N),k=g?(0,d.jsx)(ln,{editorView:i,tableRef:R,getNode:o,tableActive:p,isInDanger:S,hoveredRows:w,hoveredCell:v,isTableHovered:O,isResizing:n,ordering:s,hasHeaderRow:A,selection:i.state.selection,headerRowHeight:x?x.offsetHeight:void 0,stickyHeader:this.props.limitedMode?void 0:this.state.stickyHeader,getEditorFeatureFlags:b,tableContainerWidth:L,isNumberColumnEnabled:N.attrs.isNumberColumnEnabled,getScrollOffset:()=>this.wrapper?.scrollLeft||0,tableWrapperHeight:this.state.tableWrapperHeight,api:f,isChromelessEditor:h?.isChromelessEditor,isDragAndDropEnabled:g}):null;try{e=m?m():void 0}catch(t){e=void 0}let M=to(i.state,e),{tableWithFixedColumnWidthsOption:D=!1}=b(),P=!!E&&(D||!!this.props.options?.isCommentEditor);return(0,d.jsxs)(lj,{className:t(rw)(eu.TABLE_CONTAINER,{[eu.WITH_CONTROLS]:r&&p,[eu.TABLE_STICKY]:!this.props.limitedMode&&this.state.stickyHeader&&A,[eu.HOVERED_DELETE_BUTTON]:S,[eu.TABLE_SELECTED]:(0,a("iYC9s").isTableSelected)(_??i.state.selection),[eu.NESTED_TABLE_WITH_CONTROLS]:p&&r&&this.isNestedInTable}),editorView:i,getPos:m,node:N,tableRef:R,containerWidth:u,isNested:M,pluginInjectionApi:f,tableWrapperHeight:this.state.tableWrapperHeight,isTableResizingEnabled:T,isResizing:n,isTableScalingEnabled:E,isTableWithFixedColumnWidthsOptionEnabled:D,isWholeTableInDanger:y,isTableAlignmentEnabled:C,shouldUseIncreasedScalingPercent:P,isCommentEditor:h?.isCommentEditor,isChromelessEditor:h?.isChromelessEditor,children:[(0,d.jsx)("div",{className:eu.TABLE_STICKY_SENTINEL_TOP,"data-testid":"sticky-sentinel-top"}),!this.isNestedInTable&&(0,d.jsx)("div",{className:eu.TABLE_STICKY_SCROLLBAR_SENTINEL_TOP,"data-testid":"sticky-scrollbar-sentinel-top"}),r&&I,g&&(0,d.jsx)(lE,{editorView:i,node:N,getScrollOffset:()=>this.wrapper?.scrollLeft||0,getTableWrapperWidth:()=>this.wrapper?.clientWidth||760}),(0,d.jsx)("div",{className:t(rw)(eu.TABLE_NODE_WRAPPER),ref:e=>{if(this.wrapper=e,e){this.props.contentDOM(e);let t=e.querySelector("table");t!==this.table&&(this.table=t,this.observeTable(this.table))}},children:r&&k}),this.isNestedInTable?(0,d.jsx)("div",{style:{width:R?.clientWidth,height:"100%"},"data-vc-nvs":"true"}):(0,d.jsx)("div",{className:eu.TABLE_STICKY_SCROLLBAR_CONTAINER,"data-vc-nvs":"true",style:{height:"var(--ds-space-250, 20px)",display:"none",width:n?"var(--ds-space-0, 0px)":"100%"},children:(0,d.jsx)("div",{style:{width:R?.clientWidth,height:"100%"},"data-vc-nvs":"true"})}),(0,d.jsx)("div",{className:eu.TABLE_STICKY_SENTINEL_BOTTOM,"data-testid":"sticky-sentinel-bottom"}),!this.isNestedInTable&&(0,d.jsx)("div",{className:eu.TABLE_STICKY_SCROLLBAR_SENTINEL_BOTTOM,"data-testid":"sticky-scrollbar-sentinel-bottom"}),(0,d.jsx)("div",{contentEditable:!1,className:eu.TABLE_LEFT_BORDER,"data-with-numbered-table":N.attrs.isNumberColumnEnabled,"data-testid":"table-left-border"}),(0,d.jsx)("div",{contentEditable:!1,className:eu.TABLE_RIGHT_BORDER,"data-testid":"table-right-border"})]})}constructor(e){super(e),this.state={parentWidth:void 0,tableWrapperWidth:void 0,tableWrapperHeight:void 0,windowResized:!1},this.wrapper=void 0,this.table=void 0,this.node=void 0,this.containerWidth=void 0,this.wasResizing=void 0,this.tableNodeWidth=void 0,this.layoutSize=void 0,this.stickyScrollbar=void 0,this.isNestedInTable=void 0,this.initialOverflowCaptureTimerId=void 0,this.resizeObserver=void 0,this.wrapperWidth=void 0,this.wrapperReisizeObserver=void 0,this.updateColGroupFromFullWidthChange=void 0,this.dragAndDropCleanupFn=void 0,this.nodeVisibilityObserverCleanupFn=void 0,this.handleMouseOut=e=>!!rq(this.props.view)&&rV(this.props.view,e),this.handleMouseOver=e=>!!rq(this.props.view)&&rJ(rH)(this.props.view,e),this.handleMouseEnter=()=>{let e=this.props.getNode(),t=this.props.getPos(),i=this.props.view.state.tr,o=e.attrs.localId;i.setMeta("mouseEnterTable",[o,e,t]),this.props.view.dispatch(i)},this.onStickyState=e=>{let t=this.props.getPos();if(!(0,a("kTbzR").isValidPosition)(t,this.props.view.state))return;let i=rI(e,t);i!==this.state.stickyHeader&&this.setState({stickyHeader:i})},this.prevTableState=null,this.handleScroll=e=>{if(this.wrapper&&e.target===this.wrapper){if(this.stickyScrollbar&&this.stickyScrollbar.scrollLeft(this.wrapper.scrollLeft),this.table){let e=this.table.querySelectorAll("tr[data-header-row]");for(let t=0;t<e.length;t++){let i=e[t];i.scrollLeft=this.wrapper.scrollLeft,i.style.marginRight="2px"}}this.forceUpdate()}},this.handleTableResizing=()=>{let{getNode:e,containerWidth:t,options:i,allowTableResizing:o}=this.props,n=this.node,a=e(),r=n.attrs,l=to(this.props.view.state,this.props.getPos()),s=this.getParentNodeWidth();if(l&&tn(this.props.view.state,this.props.getPos())){let e=this.wrapperWidth||0,t=Math.abs(e-(this.state.parentWidth||0));s=(t<=2||t>20)&&e>1?e:this.state.parentWidth}let d=s&&s!==this.state.parentWidth,c=this.tableNodeLayoutSize(a,t.width,i),p=r.isNumberColumnEnabled!==a.attrs.isNumberColumnEnabled,u=e7(a,n);(d||p||c!==this.layoutSize||u)&&(o&&(!o||!l)||p||u||this.scaleTable({parentWidth:s},p),o&&p&&!$(n)&&this.scaleTable({parentWidth:a.attrs.width},!0),this.updateParentWidth(s)),this.node=a,this.containerWidth=t,this.layoutSize=c},this.scaleTable=(e,t=!1)=>{let{view:i,getNode:o,getPos:n,containerWidth:r,options:l}=this.props,s=o(),{state:d,dispatch:c}=i,p=n();if("number"!=typeof p||!(0,a("kTbzR").isValidPosition)(p,d))return;let u=i.domAtPos.bind(i),{width:h}=r;this.scaleTableDebounced.cancel();let m=oA(this.table,{...e,node:s,prevNode:this.node||s,start:p+1,containerWidth:h,previousContainerWidth:this.containerWidth.width||h,...l},u,this.props.pluginInjectionApi,!1,!1)(d.tr);t||((0,a("h3X17").tintDirtyTransaction)(m),m.setMeta("addToHistory",!1)),c(m)},this.handleAutoSize=()=>{if(this.table){let{view:e,getNode:t,getPos:i,containerWidth:o}=this.props,n=t(),r=i();(0,a("kTbzR").isValidPosition)(r,e.state)&&t9(e,n,this.table,r,{containerWidth:o.width})}},this.handleWindowResize=()=>{let{getNode:e,containerWidth:t}=this.props,i=e(),o=this.tableNodeLayoutSize(i);if(t.width>o)return;let n=this.getParentNodeWidth();this.scaleTableDebounced({parentWidth:n})},this.handleWindowResizeNew=()=>{this.state.windowResized||this.setState({windowResized:!0})},this.getParentNodeWidth=()=>{let{getPos:e,containerWidth:t,options:i,view:{state:o}}=this.props,n=e();if((0,a("kTbzR").isValidPosition)(n,o))return(0,a("6fQl1").getParentNodeWidth)(n,o,t,i&&i.isFullWidthModeEnabled)},this.updateParentWidth=e=>{this.setState({parentWidth:e})},this.tableNodeLayoutSize=(e,t,i)=>x(e.attrs.layout,t||this.props.containerWidth.width,i||this.props.options||{}),this.shouldUpdateColgroup=e=>{let{isWindowResized:t,isWidthChanged:i,isTableWidthChanged:o,isColumnsDistributed:n,isTableResizedFullWidth:a,isTableDisplayModeChanged:r,isNumberColumnChanged:l,isNumberOfColumnsChanged:s,isFullWidthModeAndLineLengthChanged:d}=e;return this.props.options?.isCommentEditor||this.props.options?.isChromelessEditor?i||o||n||!!a||r||l||s||!!d:!!t||n||!!a||r||l||s||!!d},this.scaleTableDebounced=(0,a("2P8Ax").default)(this.scaleTable),this.handleTableResizingDebounced=(0,a("2P8Ax").default)(this.handleTableResizing),this.handleScrollDebounced=(0,a("2P8Ax").default)(this.handleScroll),this.handleAutoSizeDebounced=(0,a("2P8Ax").default)(this.handleAutoSize),this.handleWindowResizeDebounced=(0,a("2P8Ax").default)(this.handleWindowResize),this.handleWindowResizeNewDebounced=(0,a("2P8Ax").default)(this.handleWindowResizeNew);let{options:t,containerWidth:i,getNode:o}=e;this.node=o(),this.containerWidth=i;let n=e.getPos();this.isNestedInTable=!!n&&(0,a("sxTNo").getParentOfTypeCount)(e.view.state.schema.nodes.table)(e.view.state.doc.resolve(n))>0,this.updateColGroupFromFullWidthChange||(this.updateColGroupFromFullWidthChange=t?.isFullWidthModeEnabled&&!t?.wasFullWidthModeEnabled);let r=!!t&&t.wasFullWidthModeEnabled;this.layoutSize=this.tableNodeLayoutSize(this.node,i.width,{isFullWidthModeEnabled:r}),this.resizeObserver=new ResizeObserver(e=>{for(let t of e)this.setState(e=>e?.tableWrapperWidth===t.contentRect?.width&&e?.tableWrapperHeight===t.contentRect?.height?e:{...e,tableWrapperWidth:t.contentRect.width,tableWrapperHeight:t.contentRect.height})}),"execCommand"in document&&["enableObjectResizing","enableInlineTableEditing"].forEach(e=>{document.queryCommandSupported(e)&&document.execCommand(e,!1,"false")})}}l$.displayName="TableComponent";var lX=(0,a("gmMgo").default)(l$);let lZ=({view:e,options:t,getNode:i,dispatchAnalyticsEvent:o,api:n,getEditorFeatureFlags:r,eventDispatcher:l,allowColumnResizing:s,allowControls:c,getPos:p,forwardRef:u,allowTableAlignment:h,allowTableResizing:m})=>{let f,{isTableResizing:g,isHeaderColumnEnabled:b,isHeaderRowEnabled:E,ordering:T,isResizing:C,isInDanger:_,hoveredCell:S,hoveredRows:w,isTableHovered:v,isWholeTableInDanger:O,interaction:y,isFullscreen:N,lineLength:R,mode:x,selection:A,width:I}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(n,["table","width","media","selection","editorViewMode","interaction"],e=>({isTableResizing:e.tableState?.isTableResizing,isHeaderColumnEnabled:e.tableState?.isHeaderColumnEnabled,isHeaderRowEnabled:e.tableState?.isHeaderRowEnabled,ordering:e.tableState?.ordering,isResizing:e.tableState?.isResizing,isInDanger:e.tableState?.isInDanger,hoveredCell:e.tableState?.hoveredCell,hoveredRows:e.tableState?.hoveredRows,isTableHovered:e.tableState?.isTableHovered,isWholeTableInDanger:e.tableState?.isWholeTableInDanger,targetCellPosition:e.tableState?.targetCellPosition,isFullscreen:e.mediaState?.isFullscreen,selection:e.selectionState?.selection,mode:e.editorViewModeState?.mode,width:e.widthState?.width,lineLength:e.widthState?.lineLength,interaction:e.interactionState?.interactionState})),L="view"===x;try{f=p?p():void 0}catch(e){f=void 0}let k=(0,a("id9O1").findTable)(e.state.selection),M=k&&k.start-1,D="number"==typeof f&&"number"==typeof M&&f===M&&!g;return(0,d.jsx)(lX,{view:e,allowColumnResizing:s,eventDispatcher:l,getPos:p,isMediaFullscreen:N,options:t,allowControls:c,isHeaderRowEnabled:E??!1,isHeaderColumnEnabled:b??!1,isDragAndDropEnabled:t?.isDragAndDropEnabled&&!L,isTableScalingEnabled:t?.isTableScalingEnabled,allowTableAlignment:h,allowTableResizing:m,tableActive:D&&!L&&"hasNotHadInteraction"!==y,ordering:T,isResizing:C,getNode:i,containerWidth:{width:I??0,lineLength:R},contentDOM:u,getEditorFeatureFlags:r,dispatchAnalyticsEvent:o,pluginInjectionApi:n,isInDanger:!!_,hoveredRows:w,hoveredCell:S,isTableHovered:v,isWholeTableInDanger:O,selection:A})},lq=e=>({"data-number-column":e.attrs.isNumberColumnEnabled,"data-layout":e.attrs.layout,"data-autosize":e.attrs.__autoSize,"data-table-local-id":e.attrs.localId||"","data-table-width":e.attrs.width||"inherit","data-table-display-mode":e.attrs.displayMode}),lY=(e,t,i,o,n)=>{if(!e.attrs.width&&t?.isChromelessEditor||!e.attrs.width&&t?.isCommentEditor&&n)return;let r=n&&!to(i,o),l=(0,a("6fQl1").getTableContainerWidth)(e);return e.attrs.isNumberColumnEnabled&&(l-=a("aFUXX").akEditorTableNumberColumnWidth),r?l:void 0},lQ=(e,t)=>{e&&t&&e.style.setProperty("width",`${t}px`)};class lJ extends a("2gkmX").default{getContentDOM(){let e=to(this.view.state,this.getPos()),t=ea({allowColumnResizing:!!this.reactComponentProps.allowColumnResizing,tableResizingEnabled:!!this.reactComponentProps.allowTableResizing,getEditorContainerWidth:this.reactComponentProps.getEditorContainerWidth,isTableScalingEnabled:this.reactComponentProps.options?.isTableScalingEnabled,shouldUseIncreasedScalingPercent:this.reactComponentProps.options?.shouldUseIncreasedScalingPercent,isCommentEditor:this.reactComponentProps.options?.isCommentEditor,isChromelessEditor:this.reactComponentProps.options?.isChromelessEditor,isNested:e}).toDOM(this.node),i=a("5SAOw").DOMSerializer.renderSpec(document,t);if(i.dom){let e=i.dom.querySelector("table");if(this.table=e||i.dom,this.renderedDOM=i.dom,!this.options?.isTableScalingEnabled||this.options?.isTableScalingEnabled&&this.getEditorFeatureFlags?.().tableWithFixedColumnWidthsOption&&"fixed"===this.node.attrs.displayMode){let e=lY(this.node,this.reactComponentProps.options,this.reactComponentProps.view.state,this.reactComponentProps.getPos(),this.reactComponentProps.allowTableResizing);e&&lQ(this.table,e)}}return i}_handleTableRef(e){let t,i,o=!1;e&&this.table&&!e.contains(this.table)&&(t=this.ignoreMutation,this.ignoreMutation=e=>{let t="selection"===e.type;return t||(o=!0),!t},this.view.state.selection.visible&&(i=this.view.state.selection.getBookmark()),this.dom&&(this.dom.setAttribute("data-ssr-placeholder",`table-nodeview-${this.node.attrs.localId}`),this.dom.setAttribute("data-ssr-placeholder-replace",`table-nodeview-${this.node.attrs.localId}`)),this.dom&&this.renderedDOM&&this.dom.removeChild(this.renderedDOM),e.appendChild(this.table),requestAnimationFrame(()=>{if(this.ignoreMutation=t,i&&o){let e=i.resolve(this.view.state.tr.doc);if(!e.eq(this.view.state.selection)){let t=this.view.state.tr.setSelection(e);t.setMeta("source","TableNodeView:_handleTableRef:selection-resync"),this.view.dispatch(t)}}}))}setDomAttrs(e){if(!this.table)return;let t=lq(e);if(Object.keys(t).forEach(e=>{this.table.setAttribute(e,t[e])}),!this.options?.isTableScalingEnabled||this.options?.isTableScalingEnabled&&this.getEditorFeatureFlags?.().tableWithFixedColumnWidthsOption&&"fixed"===e.attrs.displayMode){let t=lY(e,this.reactComponentProps.options,this.view.state,this.getPos(),this.reactComponentProps.allowTableResizing);!em.getState(this.view.state)?.resizing&&t&&lQ(this.table,t)}}render(e,t){return(0,d.jsx)(lZ,{forwardRef:t,getNode:this.getNode,view:e.view,options:e.options,eventDispatcher:e.eventDispatcher,api:e.pluginInjectionApi,allowColumnResizing:e.allowColumnResizing,allowTableAlignment:e.allowTableAlignment,allowTableResizing:e.allowTableResizing,allowControls:e.allowControls,getPos:e.getPos,getEditorFeatureFlags:e.getEditorFeatureFlags,dispatchAnalyticsEvent:e.dispatchAnalyticsEvent})}viewShouldUpdate(e){let{hoveredRows:t}=tg(this.view.state),i=!!t?.length!==this.hasHoveredRows;if(e.attrs.isNumberColumnEnabled&&i)return this.hasHoveredRows=!!t?.length,!0;let o=this.getNode();if(typeof o.attrs!=typeof e.attrs)return!0;let n=Object.keys(o.attrs),r=Object.keys(e.attrs);if(n.length!==r.length)return!0;let l=a("LmqWp").TableMap.get(o),s=a("LmqWp").TableMap.get(e);return l.width!==s.width||n.some(t=>o.attrs[t]!==e.attrs[t])}ignoreMutation(e){let{type:t,target:{nodeName:i,firstChild:o}}=e;return("selection"!==t||i?.toUpperCase()!=="DIV"||o?.nodeName.toUpperCase()!=="TABLE")&&("selection"!==t||i?.toUpperCase()!=="TABLE"||o?.nodeName.toUpperCase()!=="COLGROUP"&&o?.nodeName.toUpperCase()!=="SPAN")&&(!this.contentDOM||!this.contentDOM.contains(e.target)&&"selection"!==e.type)}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.eventDispatcher?.emit("TABLE_DELETED",this.node),super.destroy()}constructor(e){super(e.node,e.view,e.getPos,e.portalProviderAPI,e.eventDispatcher,e,void 0,void 0,!0),this.table=void 0,this.renderedDOM=void 0,this.resizeObserver=void 0,this.eventDispatcher=void 0,this.getPos=void 0,this.options=void 0,this.getEditorFeatureFlags=void 0,this.getNode=()=>this.node,this.hasHoveredRows=!1,this.getPos=e.getPos,this.eventDispatcher=e.eventDispatcher,this.options=e.options,this.getEditorFeatureFlags=e.getEditorFeatureFlags,this.handleRef=e=>this._handleTableRef(e)}}let l0=(e,t,i,o,n,a,r,l,s,d,c)=>{let{pluginConfig:p,isDragAndDropEnabled:u,isTableScalingEnabled:h}=tg(t.state),m=s?.table?.sharedState.currentState(),{allowColumnResizing:f,allowControls:g,allowTableResizing:b,allowTableAlignment:E}=oK(p),T=r?.().tableWithFixedColumnWidthsOption||!1,C=h&&(T||d);return new lJ({node:e,view:t,allowColumnResizing:f,allowTableResizing:b,allowTableAlignment:E,allowControls:g,portalProviderAPI:o,eventDispatcher:n,getPos:i,options:{isFullWidthModeEnabled:m?.isFullWidthModeEnabled,wasFullWidthModeEnabled:m?.wasFullWidthModeEnabled,isDragAndDropEnabled:u,isTableScalingEnabled:h,isCommentEditor:d,isChromelessEditor:c,shouldUseIncreasedScalingPercent:C},getEditorContainerWidth:a,getEditorFeatureFlags:r,dispatchAnalyticsEvent:l,pluginInjectionApi:s}).init()};class l1{constructor(e,t,i,o){this.node=e,this.view=t,this.getPos=i,this.eventDispatcher=o,this.dom=void 0,this.contentDOM=void 0;let{dom:n,contentDOM:r}=a("5SAOw").DOMSerializer.renderSpec(document,e.type.spec.toDOM(e));this.dom=n,this.contentDOM=r}}let l2=/^VAR\(--.*\)$/;class l9 extends l1{update(e){let t=this.updateNodeView(e);return t&&(this.node=e),t}updateNodeView(e){if(this.node.type!==e.type)return!1;let t=(0,a("63Ztt").getCellDomAttrs)(this.node),i=(0,a("63Ztt").getCellDomAttrs)(e),{colspan:o,rowspan:n}=(0,a("63Ztt").getCellAttrs)(this.dom);if(o!==(e.attrs.colspan||1)||n!==(e.attrs.rowspan||1))return!1;let r=Object.entries(i).filter(([e,i])=>t[e]!==i),l=Object.keys(t).filter(e=>!i.hasOwnProperty(e));return r.length||l.length?(r.forEach(([e,t])=>this.dom.setAttribute(e,t||"")),l.forEach(e=>this.dom.removeAttribute(e)),!0):!!this.node.sameMarkup(e)}constructor(e,t,i,o,n){super(e,t,i,o),this.delayHandle=void 0,this.destroy=()=>{this.delayHandle&&"undefined"!=typeof window&&(window?.cancelIdleCallback?.(this.delayHandle),window?.cancelAnimationFrame?.(this.delayHandle))},l2.test(e.attrs.background)&&(this.delayHandle=function(e){if("undefined"!=typeof window)return void 0!==window.requestIdleCallback?window.requestIdleCallback(()=>e(),{timeout:500}):window.requestAnimationFrame(()=>e())}(()=>{let o=i();if(o){let i=t.state.tr;i.setNodeAttribute(o,"background",e.attrs.background.toLowerCase()).setMeta("addToHistory",!1),n?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.TABLE_CELL_BACKGROUND_FIXED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,eventType:a("d925B").EVENT_TYPE.TRACK})(i),t.dispatch(i)}}))}}var l4=a("jSnXV"),l5=a("8Yfbq");let{createPluginState:l3,createCommand:l8}=(0,a("lkJUe").pluginFactory)(rA,(e,t)=>{if("UPDATE"===t.name){let i=!1,o=e.map(e=>{let o=e.pos===t.state.pos;return o&&(i=!0),o?t.state:e});return i||o.push(t.state),o}return"REMOVE"===t.name?e.filter(e=>e.pos!==t.pos):e},{mapping:(e,t)=>e.docChanged?t.map(t=>{let i=e.mapping.mapResult(t.pos);return i?{...t,pos:i.pos}:void 0}).filter(e=>void 0!==e):t}),l6=e=>l8({name:"UPDATE",state:e},e=>e.setMeta("addToHistory",!1));class l7 extends l1{subscribeWhenRowVisible(){!this.listening&&(this.dom.setAttribute("data-header-row","true"),this.isStickyHeaderEnabled&&this.subscribe())}update(e,...t){if(e===this.node)return!0;let i=tr(e);if(this.isHeaderRow!==i)return!1;if(this.node=e,!this.isHeaderRow)return!0;if(this.isStickyHeaderEnabled){let e=this.dom.parentElement;ol(e&&e.parentElement)}return!0}destroy(){if(this.isStickyHeaderEnabled){this.unsubscribe(),this.nodeVisibilityObserverCleanupFn&&this.nodeVisibilityObserverCleanupFn();let e=nt(this.dom);e&&this.makeRowHeaderNotSticky(e.table,!0),this.emitOff(!0)}document.removeEventListener("limited-mode-activated",this.cleanup),this.tableContainerObserver&&this.tableContainerObserver.disconnect()}ignoreMutation(e){let t="selection"===e.type&&"TR"===e.target.nodeName,i="childList"===e.type&&"TR"===e.target.nodeName&&e.addedNodes.length;return!t&&!i}subscribe(){this.editorScrollableElement=(0,a("7YjFd").findOverflowScrollParent)(this.view.dom)||window,this.editorScrollableElement&&(this.initObservers(),this.topPosEditorElement=ni(this.editorScrollableElement)),this.eventDispatcher.on("widthPlugin",this.updateStickyHeaderWidth.bind(this)),this.eventDispatcher.on(eh.key,this.onTablePluginState.bind(this)),this.listening=!0,this.dom.addEventListener("wheel",this.headerRowMouseScroll.bind(this),{passive:!0}),this.dom.addEventListener("touchmove",this.headerRowMouseScroll.bind(this),{passive:!0})}unsubscribe(){this.listening&&(this.intersectionObserver&&(this.intersectionObserver.disconnect(),[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&delete e.dataset.isObserved})),this.resizeObserver&&this.resizeObserver.disconnect(),this.eventDispatcher.off("widthPlugin",this.updateStickyHeaderWidth),this.eventDispatcher.off(eh.key,this.onTablePluginState),this.listening=!1,this.dom.removeEventListener("wheel",this.headerRowMouseScroll),this.dom.removeEventListener("touchmove",this.headerRowMouseScroll))}initObservers(){this.dom&&!this.dom.dataset.isObserved&&(this.dom.dataset.isObserved="true",this.createIntersectionObserver(),this.createResizeObserver(),this.intersectionObserver&&this.resizeObserver&&(this.resizeObserver.observe(this.dom),this.editorScrollableElement&&this.resizeObserver.observe(this.editorScrollableElement),window.requestAnimationFrame(()=>{let e=()=>nt(this.dom)?.wrapper.closest(`.${eu.NODEVIEW_WRAPPER}`),t=e();if(t){let i=()=>t&&t.getElementsByClassName(eu.TABLE_STICKY_SENTINEL_TOP).item(0),o=()=>{let e=t&&t.getElementsByClassName(eu.TABLE_STICKY_SENTINEL_BOTTOM);return e&&e.item(e.length-1)},n=()=>null!==i()&&null!==o(),a=()=>{this.sentinels.top=i(),this.sentinels.bottom=o(),[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&!e.dataset.isObserved&&(e.dataset.isObserved="true",this.intersectionObserver.observe(e))})},r=t.hasAttribute("data-prosemirror-initial-toDOM-render");if(n()&&!r)a();else{this.tableContainerObserver=new MutationObserver(()=>{t&&t.isConnected||(t=e()),n()&&(a(),this.tableContainerObserver?.disconnect())});let i=t;i&&this.tableContainerObserver&&this.tableContainerObserver.observe(i,{subtree:!0,childList:!0})}}})))}createResizeObserver(){this.resizeObserver=new ResizeObserver(e=>{let t=nt(this.dom);if(!t)return;let{table:i}=t;e.forEach(e=>{if(e.target.className===this.editorScrollableElement?.className)this.updateStickyHeaderWidth();else{let t=e.contentRect?e.contentRect.height:e.target.offsetHeight;this.sentinels.bottom&&Math.abs(t-(this.stickyRowHeight||0))>1&&(this.stickyRowHeight=t,this.sentinels.bottom.style.bottom=`${23+t}px`,oa(i))}})})}createIntersectionObserver(){this.intersectionObserver=new IntersectionObserver((e,t)=>{let i=this.editorScrollableElement?.getBoundingClientRect?.();e.forEach(e=>{let{target:t,isIntersecting:o,boundingClientRect:n}=e,a=t.classList.contains(eu.TABLE_STICKY_SENTINEL_TOP)?"top":"bottom";this.sentinelData[a]={isIntersecting:o,boundingClientRect:n,rootBounds:i??e.rootBounds},this.sentinelData["top"===a?"bottom":a].rootBounds=i??e.rootBounds}),this.refreshStickyState()},{threshold:0,root:this.editorScrollableElement})}refreshStickyState(){let e=nt(this.dom);if(!e)return;let{table:t}=e,i=this.shouldSticky();if(this.isSticky!==i)if(i){let t=this.sentinelData.top.rootBounds??this.sentinelData.bottom.rootBounds;this.makeHeaderRowSticky(e,t?.top)}else this.makeRowHeaderNotSticky(t)}shouldSticky(){if(navigator.userAgent.includes("AppleWebKit")&&!navigator.userAgent.includes("Chrome")){let e=this.getPos();if("number"==typeof e){let t=this.view.state.doc.resolve(e);if(t.depth>=3&&(0,u.findParentNodeClosestToPos)(t,e=>"layoutColumn"===e.type.name)?.node)return!1}}return this.isHeaderSticky()}isHeaderSticky(){let{top:e,bottom:t}=this.sentinelData,i=e.rootBounds??t.rootBounds;if(!i||!e.boundingClientRect||!t.boundingClientRect)return!1;let o=e.boundingClientRect.bottom,n=t.boundingClientRect.top,a=this.stickyRowHeight&&this.stickyRowHeight>.5*window.innerHeight,r=!e.isIntersecting&&o<=i.top,l=t.isIntersecting||n>i.bottom;return r&&l&&o<n&&!a}onTablePluginState(e){let t=e.tableRef,i=nt(this.dom);if(!i)return;e.isHeaderRowEnabled||[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&delete e.dataset.isObserved});let o=t===i.table;o&&!e.isHeaderRowEnabled&&i&&this.makeRowHeaderNotSticky(i.table),this.focused=o;let{wrapper:n}=i,a=n.parentElement,r=a?.parentElement,l=r&&r.parentElement,s=l&&l.getAttribute("data-layout-content");r&&(o?(this.colControlsOffset=ij,s&&(r.style.paddingLeft="11px")):(this.colControlsOffset=0,s&&r.style.removeProperty("padding-left"))),setTimeout(()=>{ol(i.table)},0)}updateStickyHeaderWidth(){let e=nt(this.dom);e&&ol(e.table)}refireIntersectionObservers(){this.isSticky&&[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&this.intersectionObserver&&(this.intersectionObserver.unobserve(e),this.intersectionObserver.observe(e))})}makeHeaderRowSticky(e,t){if(this.isSticky||this.stickyRowHeight&&this.stickyRowHeight>window.innerHeight/2||this.isInNestedTable)return;let{table:i,wrapper:o}=e,n=this.dom.parentElement;if(!n?.firstChild?.isEqualNode(this.dom))return;let a=this.getCurrentTableTop(e);t||(t=ni(this.editorScrollableElement));let r=a>0?t:t+a;this.isSticky||(ol(i),this.dom.classList.add("sticky"),i.classList.add(eu.TABLE_STICKY),this.isSticky=!0,this.editorScrollableElement?.addEventListener("scrollend",this.refireIntersectionObservers,{passive:!0,once:!0}),setTimeout(()=>{this.refireIntersectionObservers()},500)),this.dom.style.top="0px",oa(i),this.dom.scrollLeft=o.scrollLeft,this.emitOn(r,this.colControlsOffset)}makeRowHeaderNotSticky(e,t=!1){this.isSticky&&e&&this.dom&&(this.dom.style.removeProperty("width"),this.dom.classList.remove("sticky"),e.classList.remove(eu.TABLE_STICKY),this.isSticky=!1,this.dom.style.top="",e.style.removeProperty("margin-top"),this.emitOff(t))}getWrapperoffset(e=!1){return(e?!this.focused:this.focused)?0:ij}getWrapperRefTop(e){return Math.round(ni(e))+this.getWrapperoffset()}getScrolledTableTop(e){return this.getWrapperRefTop(e)-this.topPosEditorElement}getCurrentTableTop(e){return this.getScrolledTableTop(e.wrapper)+e.table.clientHeight}emitOn(e,t){if(e===this.top&&t===this.padding)return;this.top=e,this.padding=t;let i=this.getPos();Number.isFinite(i)&&l6({pos:i,top:e,sticky:!0,padding:t})(this.view.state,this.view.dispatch,this.view)}emitOff(e){if(0===this.top&&0===this.padding)return;this.top=0,this.padding=0;let t=this.getPos();!e&&Number.isFinite(t)&&l6({pos:t,sticky:!1,top:this.top,padding:this.padding})(this.view.state,this.view.dispatch,this.view)}constructor(e,i,o,n,r){super(e,i,o,n),this.nodeVisibilityObserverCleanupFn=void 0,this.cleanup=()=>{if(this.isStickyHeaderEnabled){this.unsubscribe(),this.nodeVisibilityObserverCleanupFn&&this.nodeVisibilityObserverCleanupFn();let e=nt(this.dom);e&&this.makeRowHeaderNotSticky(e.table,!0),this.emitOff(!1)}this.tableContainerObserver&&this.tableContainerObserver.disconnect()},this.isHeaderRow=void 0,this.isInNestedTable=void 0,this.isStickyHeaderEnabled=void 0,this.editorScrollableElement=void 0,this.colControlsOffset=0,this.focused=!1,this.topPosEditorElement=0,this.isSticky=void 0,this.intersectionObserver=void 0,this.resizeObserver=void 0,this.tableContainerObserver=void 0,this.sentinels={},this.sentinelData={top:{isIntersecting:!1,boundingClientRect:null,rootBounds:null},bottom:{isIntersecting:!1,boundingClientRect:null,rootBounds:null}},this.stickyRowHeight=void 0,this.listening=!1,this.padding=0,this.top=0,this.headerRowMouseScrollEnd=t(l4)(()=>{this.dom.classList.remove("no-pointer-events")},400),this.headerRowMouseScroll=t(l5)(()=>{this.isSticky&&(this.dom.classList.add("no-pointer-events"),this.headerRowMouseScrollEnd())},200),this.isHeaderRow=tr(e),this.isSticky=!1;let{pluginConfig:l}=tg(i.state);this.isStickyHeaderEnabled=!!l.stickyHeaders,r?.limitedMode?.sharedState.currentState()?.limitedModePluginKey.getState(i.state)?.documentSizeBreachesThreshold&&(this.isStickyHeaderEnabled=!1,document.addEventListener("limited-mode-activated",this.cleanup));let s=this.getPos();if(this.isInNestedTable=!1,(0,a("dh538").fg)("platform_editor_ai_aifc_patch_ga"))try{s&&(this.isInNestedTable=(0,a("sxTNo").getParentOfTypeCount)(i.state.schema.nodes.table)(i.state.doc.resolve(s))>1)}catch(e){}else s&&(this.isInNestedTable=(0,a("sxTNo").getParentOfTypeCount)(i.state.schema.nodes.table)(i.state.doc.resolve(s))>1);if(this.isHeaderRow){this.dom.setAttribute("data-vc-nvs","true");let{observe:e}=(0,a("92LVN").nodeVisibilityManager)(i.dom);this.nodeVisibilityObserverCleanupFn=e({element:this.contentDOM,onFirstVisible:()=>{this.subscribeWhenRowVisible()}})}}}class se extends l1{subscribeWhenRowVisible(){!this.listening&&(this.dom.setAttribute("data-header-row","true"),this.isStickyHeaderEnabled&&this.subscribe())}update(e,...t){if(e===this.node)return!0;let i=tr(e);if(this.isHeaderRow!==i)return!i&&this.isHeaderRow&&this.dom.closest(`.${eu.TABLE_NODE_WRAPPER}`)?.classList.remove(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),!1;if(this.node=e,!this.isHeaderRow)return!0;if(this.isStickyHeaderEnabled){let e=this.dom.parentElement;ol(e&&e.parentElement)}return!0}destroy(){if(this.isStickyHeaderEnabled){this.unsubscribe(),this.overflowObserver&&this.overflowObserver.disconnect(),this.overflowObserverEntries=void 0,this.stickyStateObserver&&this.stickyStateObserver.disconnect(),this.nodeVisibilityObserver?.disconnect(),this.nodeVisibilityObserverCleanupFn&&this.nodeVisibilityObserverCleanupFn();let e=nt(this.dom);e&&this.makeRowHeaderNotLegacySticky(e.table,!0),this.emitOff(!0)}document.removeEventListener("limited-mode-activated",this.cleanup),this.tableContainerObserver&&this.tableContainerObserver.disconnect()}ignoreMutation(e){let t="selection"===e.type&&"TR"===e.target.nodeName,i="childList"===e.type&&"TR"===e.target.nodeName&&e.addedNodes.length;return!t&&!i}subscribe(){this.editorScrollableElement=(0,a("7YjFd").findOverflowScrollParent)(this.view.dom)||window,this.editorScrollableElement&&(this.initObservers(),this.topPosEditorElement=ni(this.editorScrollableElement),(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_5")&&(this.scrollListener=()=>{if(this.hasScrolledSinceLoad||(this.hasScrolledSinceLoad=!0,!this.overflowObserver))return;let e=this.overflowObserverEntries??this.overflowObserver.takeRecords();this.overflowObserverEntries=void 0,e.forEach(e=>{let t=this.dom.closest(`.${eu.TABLE_NODE_WRAPPER}`);t&&t instanceof HTMLElement&&(e.isIntersecting?(t.classList.add(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),this.dom.classList.add(eu.NATIVE_STICKY),this.isNativeSticky=!0):(t.classList.remove(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),this.dom.classList.remove(eu.NATIVE_STICKY),this.isNativeSticky=!1),this.refreshLegacyStickyState())})},this.editorScrollableElement.addEventListener("scroll",this.scrollListener,{passive:!0,once:!0}))),this.eventDispatcher.on("widthPlugin",this.updateStickyHeaderWidth.bind(this)),this.eventDispatcher.on(eh.key,this.onTablePluginState.bind(this)),this.listening=!0,this.dom.addEventListener("wheel",this.headerRowMouseScroll.bind(this),{passive:!0}),this.dom.addEventListener("touchmove",this.headerRowMouseScroll.bind(this),{passive:!0})}unsubscribe(){this.listening&&(this.intersectionObserver&&(this.intersectionObserver.disconnect(),[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&delete e.dataset.isObserved})),this.resizeObserver&&this.resizeObserver.disconnect(),this.scrollListener&&this.editorScrollableElement&&(this.editorScrollableElement.removeEventListener("scroll",this.scrollListener),this.scrollListener=void 0),this.eventDispatcher.off("widthPlugin",this.updateStickyHeaderWidth),this.eventDispatcher.off(eh.key,this.onTablePluginState),this.listening=!1,this.dom.removeEventListener("wheel",this.headerRowMouseScroll),this.dom.removeEventListener("touchmove",this.headerRowMouseScroll))}initOverflowObserver(){let e=this.dom.closest(`.${eu.TABLE_NODE_WRAPPER}`);e&&(this.overflowObserver=new IntersectionObserver((e,t)=>{e.forEach(i=>{if(t.root instanceof HTMLElement){if(!this.hasScrolledSinceLoad&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_5")){this.overflowObserverEntries=e;return}i.isIntersecting?((0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")?(t.root.classList.add(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),this.disableNativeSticky||this.dom.classList.add(eu.NATIVE_STICKY)):(t.root.classList.add(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),this.dom.classList.add(eu.NATIVE_STICKY)),this.isNativeSticky=!0):((0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4"),t.root.classList.remove(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW),this.dom.classList.remove(eu.NATIVE_STICKY),this.isNativeSticky=!1),this.refreshLegacyStickyState()}})},{root:e,threshold:1}))}initStickyStateObserver(){if(!this.editorScrollableElement||!(this.editorScrollableElement instanceof Element))return;let e={root:this.editorScrollableElement,rootMargin:`-${a("1zav4").tableMarginTop+1}px 0px 0px 0px`,threshold:1};this.stickyStateObserver=new IntersectionObserver(e=>{e.forEach(e=>{let t=this.dom.closest(`.${eu.TABLE_CONTAINER}`);e.intersectionRect.top!==e.rootBounds?.top||this.disableNativeSticky&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")?(this.dom.classList.remove(eu.NATIVE_STICKY_ACTIVE),t&&t instanceof HTMLElement&&((0,a("dh538").fg)("platform_editor_table_sticky_header_patch_3")?delete t.dataset.tableHeaderIsStuck:t.dataset.tableHeaderIsStuck="false")):(this.dom.classList.add(eu.NATIVE_STICKY_ACTIVE),t&&t instanceof HTMLElement&&(t.dataset.tableHeaderIsStuck="true"))})},e)}initObservers(){if(this.dom&&!this.dom.dataset.isObserved&&(this.dom.dataset.isObserved="true",this.createIntersectionObserver(),this.createResizeObserver(),this.intersectionObserver&&this.resizeObserver)){if(this.isHeaderRow&&!this.isInNestedTable){(0,N.expValEquals)("platform_editor_native_anchor_with_dnd","isEnabled",!0)&&this.dom.style.setProperty("anchor-name",this.dom.getAttribute("data-node-anchor")??""),this.initOverflowObserver(),(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")&&this.initNodeVisibilityObserver();let e=this.dom.closest("table");e&&(this.overflowObserver?.observe(e),(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")&&this.nodeVisibilityObserver?.observe(e)),this.initStickyStateObserver(),this.stickyStateObserver?.observe(this.dom)}this.resizeObserver.observe(this.dom),this.editorScrollableElement&&this.resizeObserver.observe(this.editorScrollableElement),window.requestAnimationFrame(()=>{let e=()=>nt(this.dom)?.wrapper.closest(`.${eu.NODEVIEW_WRAPPER}`),t=e();if(t){let i=()=>t&&t.getElementsByClassName(eu.TABLE_STICKY_SENTINEL_TOP).item(0),o=()=>{let e=t&&t.getElementsByClassName(eu.TABLE_STICKY_SENTINEL_BOTTOM);return e&&e.item(e.length-1)},n=()=>null!==i()&&null!==o(),a=()=>{this.sentinels.top=i(),this.sentinels.bottom=o(),[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&!e.dataset.isObserved&&(e.dataset.isObserved="true",this.intersectionObserver.observe(e))})},r=t.hasAttribute("data-prosemirror-initial-toDOM-render");if(n()&&!r)a();else{this.tableContainerObserver=new MutationObserver(()=>{t&&t.isConnected||(t=e()),n()&&(a(),this.tableContainerObserver?.disconnect())});let i=t;i&&this.tableContainerObserver&&this.tableContainerObserver.observe(i,{subtree:!0,childList:!0})}}})}}initNodeVisibilityObserver(){this.nodeVisibilityObserver=new IntersectionObserver(e=>{e.forEach(e=>{this.isNativeSticky&&(0===e.intersectionRatio||1===e.intersectionRatio)&&(!0===this.disableNativeSticky&&this.dom.classList.remove(eu.NATIVE_STICKY),!1===this.disableNativeSticky&&this.dom.classList.add(eu.NATIVE_STICKY))})},{threshold:[0,.05,.95,1]})}createResizeObserver(){this.resizeObserver=new ResizeObserver(e=>{let t=nt(this.dom);if(!t)return;let{table:i}=t;e.forEach(e=>{if(e.target.className===this.editorScrollableElement?.className)this.updateStickyHeaderWidth();else{let t=e.contentRect?e.contentRect.height:e.target.offsetHeight;if(this.sentinels.bottom&&Math.abs(t-(this.stickyRowHeight||0))>1&&(this.stickyRowHeight=t,this.sentinels.bottom.style.bottom=`${23+t}px`,oa(i)),(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")){let e=this.editorContentAreaHeight??1200;this.toggleDisableNativeSticky(t,e)}}})})}createIntersectionObserver(){this.intersectionObserver=new IntersectionObserver((e,t)=>{let i=this.editorScrollableElement?.getBoundingClientRect?.();e.forEach(e=>{let{target:t,isIntersecting:o,boundingClientRect:n}=e,a=t.classList.contains(eu.TABLE_STICKY_SENTINEL_TOP)?"top":"bottom";this.sentinelData[a]={isIntersecting:o,boundingClientRect:n,rootBounds:i??e.rootBounds},this.sentinelData["top"===a?"bottom":a].rootBounds=i??e.rootBounds}),this.refreshLegacyStickyState()},{threshold:0,root:this.editorScrollableElement})}refreshLegacyStickyState(){let e=nt(this.dom);if(!e)return;let{table:t}=e;if(this.isNativeSticky)return void this.makeRowHeaderNotLegacySticky(t);let i=this.shouldSticky();if(this.isLegacySticky!==i)if(i){let t=this.sentinelData.top.rootBounds??this.sentinelData.bottom.rootBounds;this.makeHeaderRowLegacySticky(e,t?.top)}else this.makeRowHeaderNotLegacySticky(t)}shouldSticky(){if(navigator.userAgent.includes("AppleWebKit")&&!navigator.userAgent.includes("Chrome")){let e=this.getPos();if("number"==typeof e){let t=this.view.state.doc.resolve(e);if(t.depth>=3&&(0,u.findParentNodeClosestToPos)(t,e=>"layoutColumn"===e.type.name)?.node)return!1}}return this.isHeaderSticky()}isHeaderSticky(){let{top:e,bottom:t}=this.sentinelData,i=e.rootBounds??t.rootBounds;if(!i||!e.boundingClientRect||!t.boundingClientRect)return!1;let o=e.boundingClientRect.bottom,n=t.boundingClientRect.top,a=this.stickyRowHeight&&this.stickyRowHeight>.5*window.innerHeight,r=!e.isIntersecting&&o<=i.top,l=t.isIntersecting||n>i.bottom;return r&&l&&o<n&&!a}onTablePluginState(e){let t=e.tableRef,i=nt(this.dom);if(!i)return;e.isHeaderRowEnabled||[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&delete e.dataset.isObserved});let o=t===i.table;o&&!e.isHeaderRowEnabled&&i&&this.makeRowHeaderNotLegacySticky(i.table),this.focused=o;let{wrapper:n}=i,a=n.parentElement,r=a?.parentElement,l=r&&r.parentElement,s=l&&l.getAttribute("data-layout-content");r&&(o?(this.colControlsOffset=ij,s&&(r.style.paddingLeft="11px")):(this.colControlsOffset=0,s&&r.style.removeProperty("padding-left"))),setTimeout(()=>{ol(i.table)},0)}updateStickyHeaderWidth(){let e=nt(this.dom);e&&ol(e.table)}refireIntersectionObservers(){this.isLegacySticky&&[this.sentinels.top,this.sentinels.bottom].forEach(e=>{e&&this.intersectionObserver&&(this.intersectionObserver.unobserve(e),this.intersectionObserver.observe(e))})}makeHeaderRowLegacySticky(e,t){if(this.isLegacySticky||this.stickyRowHeight&&this.stickyRowHeight>window.innerHeight/2||this.isInNestedTable)return;let{table:i,wrapper:o}=e,n=this.dom.parentElement;if(!n?.firstChild?.isEqualNode(this.dom))return;let a=this.getCurrentTableTop(e);t||(t=ni(this.editorScrollableElement));let r=a>0?t:t+a;this.isLegacySticky||(ol(i),this.dom.classList.add("sticky"),i.classList.add(eu.TABLE_STICKY),this.isLegacySticky=!0,this.editorScrollableElement?.addEventListener("scrollend",this.refireIntersectionObservers,{passive:!0,once:!0}),setTimeout(()=>{this.refireIntersectionObservers()},500)),this.dom.style.top="0px",oa(i),this.dom.scrollLeft=o.scrollLeft,this.emitOn(r,this.colControlsOffset)}makeRowHeaderNotLegacySticky(e,t=!1){this.isLegacySticky&&e&&this.dom&&(this.dom.style.removeProperty("width"),this.dom.classList.remove("sticky"),e.classList.remove(eu.TABLE_STICKY),this.isLegacySticky=!1,this.dom.style.top="",e.style.removeProperty("margin-top"),this.emitOff(t))}getWrapperoffset(e=!1){return(e?!this.focused:this.focused)?0:ij}getWrapperRefTop(e){return Math.round(ni(e))+this.getWrapperoffset()}getScrolledTableTop(e){return this.getWrapperRefTop(e)-this.topPosEditorElement}getCurrentTableTop(e){return this.getScrolledTableTop(e.wrapper)+e.table.clientHeight}emitOn(e,t){if(e===this.top&&t===this.padding)return;this.top=e,this.padding=t;let i=this.getPos();Number.isFinite(i)&&l6({pos:i,top:e,sticky:!0,padding:t})(this.view.state,this.view.dispatch,this.view)}emitOff(e){if(0===this.top&&0===this.padding)return;this.top=0,this.padding=0;let t=this.getPos();!e&&Number.isFinite(t)&&l6({pos:t,sticky:!1,top:this.top,padding:this.padding})(this.view.state,this.view.dispatch,this.view)}constructor(e,i,o,n,r){super(e,i,o,n),this.nodeVisibilityObserverCleanupFn=void 0,this.cleanup=()=>{if(this.isStickyHeaderEnabled){this.unsubscribe(),this.nodeVisibilityObserverCleanupFn&&this.nodeVisibilityObserverCleanupFn();let e=nt(this.dom);e&&this.makeRowHeaderNotLegacySticky(e.table,!0),this.emitOff(!1)}this.tableContainerObserver&&this.tableContainerObserver.disconnect(),this.onEditorContentAreaHeightChange?.()},this.isHeaderRow=void 0,this.isInNestedTable=void 0,this.isStickyHeaderEnabled=void 0,this.editorScrollableElement=void 0,this.colControlsOffset=0,this.focused=!1,this.topPosEditorElement=0,this.isLegacySticky=void 0,this.intersectionObserver=void 0,this.resizeObserver=void 0,this.tableContainerObserver=void 0,this.sentinels={},this.sentinelData={top:{isIntersecting:!1,boundingClientRect:null,rootBounds:null},bottom:{isIntersecting:!1,boundingClientRect:null,rootBounds:null}},this.stickyRowHeight=void 0,this.listening=!1,this.padding=0,this.top=0,this.overflowObserver=void 0,this.stickyStateObserver=void 0,this.hasScrolledSinceLoad=!1,this.scrollListener=void 0,this.overflowObserverEntries=void 0,this.isNativeSticky=void 0,this.disableNativeSticky=!1,this.onEditorContentAreaHeightChange=void 0,this.editorContentAreaHeight=void 0,this.nodeVisibilityObserver=void 0,this.headerRowMouseScrollEnd=t(l4)(()=>{this.dom.classList.remove("no-pointer-events")},400),this.headerRowMouseScroll=t(l5)(()=>{this.isLegacySticky&&(this.dom.classList.add("no-pointer-events"),this.headerRowMouseScrollEnd())},200),this.toggleDisableNativeSticky=(e,t)=>{!this.disableNativeSticky&&e>.5*t&&(this.disableNativeSticky=!0,void 0===this.isNativeSticky&&this.dom.classList.remove(eu.NATIVE_STICKY)),this.disableNativeSticky&&e<=.5*t&&(this.disableNativeSticky=!1)},this.isHeaderRow=tr(e),this.isLegacySticky=!1;let{pluginConfig:l}=tg(i.state);this.isStickyHeaderEnabled=!!l.stickyHeaders,r?.limitedMode?.sharedState.currentState()?.limitedModePluginKey.getState(i.state)?.documentSizeBreachesThreshold&&(this.isStickyHeaderEnabled=!1,document.addEventListener("limited-mode-activated",this.cleanup));let s=this.getPos();if(this.isInNestedTable=!1,s&&(this.isInNestedTable=(0,a("sxTNo").getParentOfTypeCount)(i.state.schema.nodes.table)(i.state.doc.resolve(s))>1),this.isHeaderRow){this.dom.setAttribute("data-vc-nvs","true");let{observe:e}=(0,a("92LVN").nodeVisibilityManager)(i.dom);this.nodeVisibilityObserverCleanupFn=e({element:this.contentDOM,onFirstVisible:()=>{this.subscribeWhenRowVisible()}})}this.isHeaderRow&&this.isStickyHeaderEnabled&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")&&(this.onEditorContentAreaHeightChange=r?.table?.sharedState.onChange(({nextSharedState:e})=>{e?.editorContentAreaHeight&&e?.editorContentAreaHeight!==this.editorContentAreaHeight&&(this.editorContentAreaHeight=e.editorContentAreaHeight,this.toggleDisableNativeSticky(this.stickyRowHeight??0,e.editorContentAreaHeight))}))}}let st=e=>(t,i,o)=>l0(t,i,o,e.portalProviderAPI,e.eventDispatcher,e.getEditorContainerWidth,e.getEditorFeatureFlags,e.dispatchAnalyticsEvent,e.pluginInjectionApi,e.isCommentEditor,e.isChromelessEditor),si=e=>(t,i,o)=>new l9(t,i,o,e.eventDispatcher,e.pluginInjectionApi?.analytics?.actions),so=e=>(t,i,o)=>new l9(t,i,o,e.eventDispatcher,e.pluginInjectionApi?.analytics?.actions),sn=e=>(t,i,o)=>rS(e.isDragAndDropEnabled??!1)&&(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")?new se(t,i,o,e.eventDispatcher,e.pluginInjectionApi):new l7(t,i,o,e.eventDispatcher,e.pluginInjectionApi),sa=(e,t,i,o)=>{if((0,a("iYC9s").isTableSelected)(e.selection)){let n=(0,a("id9O1").findTable)(e.selection);if(n){let r="string"==typeof t?new(0,a("5SAOw").Slice)(a("5SAOw").Fragment.from(e.schema.text(t)),0,0):t,l=e.tr.replace(n.pos,n.pos+n.node.nodeSize,r);l.setSelection(a("ks2lK").TextSelection.create(l.doc,n.pos+r.size+1));let{totalRowCount:s,totalColumnCount:d}=iC(e.selection);return o?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.REPLACED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,attributes:{totalColumnCount:d,totalRowCount:s,inputMethod:i},eventType:a("d925B").EVENT_TYPE.TRACK})(l),l}}return e.tr},sr=e=>{let{schema:t}=e.type;if(e.type===t.nodes.table){let i=[],{tableCell:o,tableHeader:n}=t.nodes;return e.descendants(e=>e.type!==o&&e.type!==n||(i.push(...(0,u.flatten)(e,!1).map(e=>e.node)),!1)),i}return e},sl=(e,t,i,o=0)=>{let n=(e,o)=>e.type===t.nodes.table&&o>=i?sr(e):e,r=[];for(let l=0,s=e.childCount;l<s;l++){let s=e.child(l),d=n(s.isLeaf?s:s.copy(a("5SAOw").Fragment.fromArray(sl(s.content,t,i,s.type===t.nodes.table?o+1:o))),o);d&&(Array.isArray(d)?r.push(...d):r.push(d))}return r},ss=(e,t,i)=>{let o=(0,g.editorExperiment)("nested-tables-in-tables",!0),{table:n,tableCell:r,tableHeader:l}=t.nodes,s=e.openEnd,d=(0,a("3Ter7").flatmap)(e.content,(d,c,p)=>{let h=1,m=i instanceof a("7XFGZ").CellSelection,f=(0,u.hasParentNodeOfType)([n,r,l])(i),g=(0,a("sxTNo").getParentOfTypeCount)(t.nodes.table)(i.$from)>1,b=(0,a("dh538").fg)("platform_editor_paste_full_table_inside_empty_cell"),E=f&&1===e.content.childCount&&e.content.firstChild?.type===n&&(!b||0!==e.openStart&&0!==e.openEnd);if(o?(h=2,d.type===t.nodes.table&&(h=1,f&&(h=0),g&&(h=1),(E||m)&&(h=1,g&&(h=0))),e.openEnd>=7&&e.content.childCount>1&&e.content.lastChild?.type===n&&f&&(s=4)):d.type===t.nodes.table&&(h=0),m&&!E)return sl(a("5SAOw").Fragment.fromArray([d]),t,h);{let e=sl(d.content,t,h);return d.copy(a("5SAOw").Fragment.fromArray(e))}});return new(0,a("5SAOw").Slice)(d,e.openStart,s)},sd=(e,t)=>{let{paragraph:i,table:o,hardBreak:n}=t.nodes,r=i.createAndFill(),l=n?.createAndFill(),s=r?r.nodeSize:0,d=l?l.nodeSize:0;if(2===e.content.childCount&&e.content.firstChild&&e.content.lastChild&&e.content.firstChild.type===o&&e.content.lastChild.type===i&&e.content.lastChild.nodeSize===s+d){let t=sr(e.content.firstChild);if(t instanceof Array)return new(0,a("5SAOw").Slice)(a("5SAOw").Fragment.from(t[0]),e.openStart,e.openEnd)}return e},sc=(e,t)=>1===e.childCount&&e.firstChild?.type===t.nodes.tableRow&&1===e.firstChild.childCount&&(e.firstChild.firstChild?.type===t.nodes.tableCell||e.firstChild.firstChild?.type===t.nodes.tableHeader),sp=(e,t)=>1===e.childCount&&null!==e.firstChild&&sc(e.firstChild,t),su=(e,t)=>{let i=!1,{table:o,tableCell:n,tableHeader:a}=t.nodes;return e.forEach(e=>{e.isBlock&&![o,n,a].includes(e.type)&&(i=!0)}),i},sh=(e,t)=>{if(e.openStart>=7&&e.openEnd>=7){let i=e,o=0;if(sp(e.content,t)&&e.content.firstChild?.descendants(n=>{if(sc(n,t))o+=2;else if(n.type===t.nodes.table)return!1;else if(su(n.content,t))return o+=2,i=new(0,a("5SAOw").Slice)(n.content,e.openStart-o-2,e.openEnd-o-2),!1}),!i.eq(e))return i}if(e.openStart>=4&&e.openEnd>=4&&1===e.content.childCount&&e.content.firstChild.type===t.nodes.table){let i=e;return e.content.firstChild?.content?.firstChild?.content?.firstChild?.type===t.nodes.table&&(i=new(0,a("5SAOw").Slice)(e.content.firstChild.content.firstChild.content,e.openStart-2,e.openEnd-2)),new(0,a("5SAOw").Slice)((0,a("3Ter7").flatmap)(i.content,sr),i.openStart-3,i.openEnd-3)}return e.openStart>=4&&e.content.childCount>1&&e.content.firstChild?.type===t.nodes.table?new(0,a("5SAOw").Slice)(e.content,1,e.openEnd):e},sm=(e,t)=>{let{tableCell:i,tableHeader:o}=t.nodes;return(0,a("3Ter7").mapSlice)(e,e=>e&&(e.type===i||e.type===o)&&!e.content.childCount&&e.type.createAndFill(e.attrs)||e)},sf=(e,t)=>{let{table:i}=t.nodes,o=[];return(0,a("3Ter7").mapChildren)(e.content,e=>{e.type===i&&"default"===e.attrs.layout?o.push(i.createChecked({...e.attrs,layout:"center"},e.content,e.marks)):o.push(e)}),new(0,a("5SAOw").Slice)(a("5SAOw").Fragment.fromArray(o),e.openStart,e.openEnd)},sg=(e,t,i,o,n,r,l,s,d,c,p,h,m,f,g,b,E,T)=>{let C=tm(t,{pluginConfig:r,isTableHovered:!1,insertColumnButtonIndex:void 0,insertRowButtonIndex:void 0,isFullWidthModeEnabled:c,wasFullWidthModeEnabled:p,isHeaderRowEnabled:!!r.allowHeaderRow,isHeaderColumnEnabled:!1,isDragAndDropEnabled:h,isTableScalingEnabled:g,...eq,...eZ,getIntl:d}),_=[],S=null,w=f?.accessibilityUtils?.actions.ariaNotify,v=()=>{let e=S;return e?e.state:null},O={table:st({portalProviderAPI:i,eventDispatcher:n,getEditorContainerWidth:l,getEditorFeatureFlags:s,dispatchAnalyticsEvent:e,pluginInjectionApi:f,isCommentEditor:E,isChromelessEditor:T}),tableRow:sn({eventDispatcher:n,pluginInjectionApi:f,isDragAndDropEnabled:h}),tableCell:si({eventDispatcher:n,pluginInjectionApi:f}),tableHeader:so({eventDispatcher:n,pluginInjectionApi:f})};return new(0,a("1S4f7").SafePlugin)({state:C,key:eh,appendTransaction:(t,i,o)=>{let n=t.find(e=>"cut"===e.getMeta("uiEvent"));if(n){let{tableWithFixedColumnWidthsOption:e=!1}=s(),t=rZ(n,i,o,f,m,S||void 0,g,e,b);return tR(t)||t}if(t.find(e=>e.docChanged))return tR(o.tr,function(t){_.find(e=>e===t.tableLocalId)||(_.push(t.tableLocalId),e({action:a("d925B").ACTION.INVALID_DOCUMENT_ENCOUNTERED,actionSubject:a("d925B").ACTION_SUBJECT.EDITOR,eventType:a("d925B").EVENT_TYPE.OPERATIONAL,attributes:{nodeType:t.nodeType,reason:`${t.attribute}: ${t.reason}`,tableLocalId:t.tableLocalId,spanValue:t.spanValue}}))})},view:e=>{let t=e.domAtPos.bind(e);return S=e,{update:(e,i)=>{let o,{state:n,dispatch:r}=e,{selection:l}=n,s=tg(n);if(s.editorHasFocus){let e=(0,u.findParentDomRefOfType)(n.schema.nodes.table,t)(l);e&&(o=e.querySelector("table")||void 0);let s=(0,a("id9O1").findTable)(n.selection),c=tg(i);if(c.isResizeHandleWidgetAdded&&c.isKeyboardResize){let e=c?.tableNode!==s?.node;c?.tableNode&&s&&e?(a("LmqWp").TableMap.get(c.tableNode).height!==a("LmqWp").TableMap.get(s.node).height||s.node.attrs.localId!==c.tableNode.attrs.localId)&&ah({ariaNotify:w,getIntl:d})(n,r):s||ah({ariaNotify:w,getIntl:d})(n,r)}}if(s.tableRef!==o&&tM(o)(n,r),s.editorHasFocus&&s.tableRef){let{$cursor:e}=n.selection;if(e){let e=(0,u.findParentNodeOfType)(n.schema.nodes.tableHeader)(n.selection);e&&t4(e)(n,r)}}else s.isResizeHandleWidgetAdded&&t2()(n,r)}}},props:{transformPasted(e){let t=v();if(!t)return e;let{schema:i}=t;return!(0,a("4KOFJ").insideTable)(t)&&function(e){let t=tg(e);return t&&t.pluginConfig.isHeaderRowRequired}(t)&&(e=tB(e,i)),!(0,a("4KOFJ").insideTable)(t)&&E&&r.allowTableAlignment&&g&&(e=sf(e,i)),e=sd(e,i),e=(0,a("edTnG").transformSliceToRemoveOpenLayoutNodes)(e,i),e=(0,a("hcbpx").transformSliceToRemoveOpenExpand)(e,i),e=sh(e=(0,a("igNsz").transformSliceToRemoveOpenBodiedExtension)(e,i),i),e=sm(e=(0,a("igNsz").transformSliceToRemoveOpenMultiBodiedExtension)(e,i),i),r.allowColumnResizing||(e=tW(e,i)),e=r.allowBackgroundColor?tP(e,i):tD(e,i),e=(0,a("hcbpx").transformSliceToRemoveOpenNestedExpand)(e,i),(0,a("sxTNo").isNestedTablesSupported)(i)&&(0,a("dh538").fg)("platform_editor_use_nested_table_pm_nodes")&&(e=ss(e,i,t.selection)),e},handleClick:({state:e,dispatch:t},i,o)=>{let n=eH.getState(e),r=(0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser;if(eC(n).length&&nK()(e,t),r.chrome&&o.target){let e=o.target.classList;if(e.contains(eu.CONTROLS_BUTTON)||e.contains(eu.CONTEXTUAL_MENU_BUTTON)||e.contains(eu.DRAG_HANDLE_BUTTON_CLICKABLE_ZONE)||e.contains(eu.DRAG_HANDLE_BUTTON_CONTAINER))return!0}return!1},handleScrollToSelection:e=>{let{tableHeader:t}=e.state.schema.nodes,i=(0,u.findParentDomRefOfType)(t,e.domAtPos.bind(e))(e.state.selection),o=(0,a("4vlwG").closestElement)(i,"tr");return!!o&&o.classList.contains("sticky")},handleTextInput:(e,t,i,o)=>{let{state:n,dispatch:r}=e,{isKeyboardResize:l}=tg(n);if(l)return ah({ariaNotify:w,getIntl:d})(n,r),!1;let s=sa(n,o,a("d925B").INPUT_METHOD.KEYBOARD,m);return!!s.selectionSet&&(r(s),!0)},nodeViews:O,handleDOMEvents:{focus:rW,blur:rB,mousedown:rJ(rz),mouseleave:rj,mousemove:rY(r$(o),f),mouseenter:rG,mouseup:rY(rF),click:rJ(rY(rU))},handleTripleClick:rX}})},sb=new(0,a("ks2lK").PluginKey)("tableSafariDeleteCompositionTextIssueWorkaround"),sE=()=>new(0,a("1S4f7").SafePlugin)({key:sb,state:{init:()=>({renderSpan:!1,decorations:a("ftzrq").DecorationSet.empty}),apply:(e,t)=>{let i,o=e.getMeta(sb);if(void 0===o)return t;if(o){let{$from:t}=e.selection,o=t.before(t.depth),n=a("ftzrq").Decoration.widget(o,()=>document.createElement("span"));i=a("ftzrq").DecorationSet.create(e.doc,[n])}else i=a("ftzrq").DecorationSet.empty;return{renderSpan:o,decorations:i}}},props:{decorations:e=>sb.getState(e)?.decorations,handleDOMEvents:{beforeinput:(e,t)=>{if(t?.inputType!=="deleteCompositionText")return!1;let i=window.getSelection();if(!i||i.rangeCount<=0||"Range"!==i.type)return!1;let{startContainer:o,endContainer:n,endOffset:a,startOffset:r}=i.getRangeAt(0);if(o.nodeType===Node.TEXT_NODE&&o===n&&0===r&&a===o.length){let{tr:t}=e.state;t.setMeta(sb,!0),e.dispatch(t)}return!1},input:(e,t)=>{if(t?.inputType!=="deleteCompositionText"||!window.getSelection())return!1;let{tr:i}=e.state;return i.setMeta(sb,!1),e.dispatch(i),!1}}}}),sT=(e,t=()=>[])=>new(0,a("1S4f7").SafePlugin)({state:l3(e,t),key:rA});var sC=a("dQl1W");class s_{static getForNode(e){if(this.cache.has(e))return this.cache.get(e)||"";let i=t(sC)();return this.cache.set(e,i),i}}s_.cache=new WeakMap;let sS=e=>{let t=s_.getForNode(e);return`--table-${e.type.name}-${t}`},sw=e=>{let t=[];return e.doc.nodesBetween(0,e.doc.content.size,(e,i,o,n)=>{let r="tableHeader"===e.type.name,l="tableRow"===e.type.name,s=o?.type.name==="tableRow";if(l&&0===n||r){let o=sS(e);t.push(a("ftzrq").Decoration.node(i,i+e.nodeSize,{"data-node-anchor":o}))}return!(r||s)}),a("ftzrq").DecorationSet.create(e.doc,t)},sv=new(0,a("ks2lK").PluginKey)("tableAnchorNamesPlugin"),sO=()=>new(0,a("1S4f7").SafePlugin)({state:{init:(e,t)=>sw(t),apply:(e,t,i,o)=>e.docChanged?sw(o):t},key:sv,props:{decorations:e=>sv.getState(e)||a("ftzrq").DecorationSet.empty}}),sy=new(0,a("ks2lK").PluginKey)("tableLocalIdPlugin"),sN=e=>e&&sy.getState(e),sR=e=>new(0,a("1S4f7").SafePlugin)({key:sy,state:{init:()=>({parsedForLocalIds:!1}),apply(t,i){let o=t.getMeta(sy);if(o&&Object.keys(o).some(e=>i[e]!==o[e])){let t={...i,...o};return e(sy,t),t}return i}},view:()=>({update(e){let{state:t}=e,i=sN(t);if(!i||i.parsedForLocalIds)return;let{table:o}=t.schema.nodes;(0,a("2P8Ax").default)(()=>{let t=e.state.tr,i=!1;e.state.doc.descendants((e,n)=>{let r=e.type===o,l=e.attrs.localId;return!r||!!l||(i=!0,t.setNodeMarkup(n,void 0,{...e.attrs,localId:a("fO7hX").uuid.generate()}),!1)}),i&&(t.setMeta("addToHistory",!1),e.dispatch(t))})(),e.dispatch(t.tr.setMeta(sy,{parsedForLocalIds:!0}))}}),appendTransaction:(e,t,i)=>{let o=!1,n=i.tr,{table:r}=i.schema.nodes,l=new Set,s=new Map,d=new Set;if(e.forEach(e=>{if(e.docChanged&&"cut"!==e.getMeta("uiEvent"))for(let t of e.steps)(0,a("kTbzR").stepHasSlice)(t)&&t.slice.content.descendants(e=>(e.type===r&&l.add(e),!0))}),l.size){for(let e of(i.doc.descendants((e,t)=>l.has(e)?(s.set(e,t),!1):e.type!==r||(d.add(e.attrs.localId),!1)),l))if(!e.attrs.localId||d.has(e.attrs.localId)){let t=s.get(e);if(void 0===t)continue;n.setNodeMarkup(t,void 0,{...e.attrs,localId:a("fO7hX").uuid.generate()}),o=!0}if(o)return n}}}),sx=(e,t,i,o,n,r,l,s,d,c)=>{let{state:p,dispatch:u}=e,h=!e.editable,m=e.domAtPos.bind(e),{width:f}=o();if(h||null===i||!A(p.doc.resolve(i)))return!1;let{isKeyboardResize:g}=tg(p);t.preventDefault(),(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.startFeature("tableColumnResize");let b=e.state.tr;b.setMeta(iE.OVERFLOW_TRIGGER,{name:a("3824I").TABLE_OVERFLOW_CHANGE_TRIGGER.RESIZED_COLUMN}),u(b);let E=t.timeStamp,T=p.doc.nodeAt(i),C=p.doc.resolve(i),_=C.node(-1),S=C.start(-1),w=p.doc.resolve(S).start(-1),v=p.doc.resolve(w).depth,O=m(S).node;O&&"TABLE"!==O.nodeName&&(O=O.closest("table"));let y=0;y=r&&c&&!_.attrs?.width?f-64:L({table:_,tableStart:S,state:p,layout:_.attrs.layout,getEditorContainerWidth:o});let R=0===v&&r,{tableWithFixedColumnWidthsOption:x=!1}=n(),k=r&&x;k&&(R=R&&"fixed"!==_.attrs.displayMode);let M=k;r&&c&&(R=0===v,M=!0);let D=od({minWidth:a("1zav4").tableCellMinWidth,maxSize:y,table:_,tableRef:O,start:S,domAtPos:m,isTableScalingEnabled:R,shouldUseIncreasedScalingPercent:M,isCommentEditor:c||!1});if(n2({resizeState:D,table:_,start:S,event:t,api:l})(p,u))return B(t),!0;let P=I(e,i,T.attrs);function B(t){window.removeEventListener("mouseup",B),window.removeEventListener("mousemove",W);let{clientX:i}=t,{state:o,dispatch:n}=e,{dragging:s,resizeHandlePos:p}=n1(o),{isTableHovered:u}=tg(o);if(null===p)return(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableColumnResize"),n5()(o,n);if(!A(o.doc.resolve(p))){(0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableColumnResize");return}let h=o.doc.resolve(p),m=h.start(-1),f=h.node(-1),b=o.doc.resolve(m).start(-1),T=o.doc.resolve(b).depth;if(s&&i===s.startX)return((0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableColumnResize"),g||!u)?ah({})(o,n,e):n5()(o,n);let{tr:C}=o;if(s){let{startX:p}=s;if(!e7(_,f)){let e=a("LmqWp").TableMap.get(f),n=e.colCount(h.pos-m)+(h.nodeAfter?h.nodeAfter.attrs.colspan:1)-1,s=(0,a("iP1et").getSelectionRect)(o.selection),u=s?ar(s):[],g=u.indexOf(n)>-1||u.indexOf(n+1)>-1,b=0===T&&r;k&&(b=b&&"fixed"!==_.attrs.displayMode);let S=i-p,w=k||r&&!!c,v=r&&c&&!f.attrs?.width?H(_,O):U(_,O,w);if(C=oI(aa(D,n,S,O,_,g?u:void 0,b,v),f,m,l)(C),n===e.width-1){let e=t.timeStamp;d?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.ATTEMPTED_TABLE_WIDTH_CHANGE,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{type:"table-border",position:"right",duration:e-E,delta:Math.abs(S)},eventType:a("d925B").EVENT_TYPE.UI})(C)}d?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.COLUMN_RESIZED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{colIndex:n,resizedDelta:S,isLastColumn:n===e.width-1,tableWidth:f.attrs.width,inputMethod:a("d925B").INPUT_METHOD.MOUSE,totalRowCount:e.height,totalColumnCount:e.width}})(C)}return((0,N.expValEquals)("cc_editor_interactivity_monitoring","isEnabled",!0)&&o$.insm.session?.endFeature("tableColumnResize"),g||!u)?ah({originalTr:C})(o,n,e):n5(C)(o,n)}}function W(t){let{clientX:i,which:o}=t,{state:n}=e,{dragging:l,resizeHandlePos:s}=n1(n),{isTableHovered:d}=tg(n),p=n.doc.resolve(S).start(-1);if(!o||!l||null===s||!A(n.doc.resolve(s))||!d)return B(t);let u=n.doc.resolve(s),h=u.node(-1),m=n.doc.resolve(p).depth,f=a("LmqWp").TableMap.get(h).colCount(u.pos-u.start(-1))+u.nodeAfter.attrs.colspan-1,g=0===m&&r,b=k||r&&c;k&&(g=g&&"fixed"!==_.attrs.displayMode);let E=i-l.startX,T=r&&c&&!h.attrs?.width?H(h,O):U(_,O,b);aa(D,f,E,O,h,void 0,g,T),oi()(n)}return n3({startX:t.clientX,startWidth:P})(p,u),t1(s,void 0,void 0,!1)(p,u),window.addEventListener("mouseup",B),window.addEventListener("mousemove",W),!0};var sA=((s=sA||{}).TopToBottom="TopToBottom",s.BottomToTop="BottomToTop",s);let sI=e=>()=>(t,i)=>{let{selection:o}=t;return o instanceof a("7XFGZ").CellSelection?sk(e)(o)(t,i):o instanceof a("adhil").GapCursorSelection?sB(e)(o)(t,i):o instanceof a("ks2lK").TextSelection&&sU(e)(o)(t,i)},sL=e=>()=>(t,i)=>{let{selection:o}=t;return o instanceof a("7XFGZ").CellSelection?sM(e)(o)(t,i):o instanceof a("adhil").GapCursorSelection?sW(e)(o)(t,i):o instanceof a("ks2lK").TextSelection&&sH(e)(o)(t,i)},sk=e=>t=>(i,o)=>{if((0,a("iYC9s").isTableSelected)(i.selection)&&e){let n=e.sharedState.currentState()||{};if(n?.selectionRelativeToNode===a("cQ4aK").RelativeSelectionPos.Start)return sG(e)()(i,o);if(n?.selectionRelativeToNode===a("cQ4aK").RelativeSelectionPos.End)return sV(e)(t)(i,o);if(n?.selectionRelativeToNode===void 0)return sz(e)(t,a("cQ4aK").RelativeSelectionPos.Before)(i,o)}return!1},sM=e=>t=>(i,o)=>{if((0,a("iYC9s").isTableSelected)(i.selection)&&e){let{selectionRelativeToNode:n}=e.sharedState.currentState()||{};if(n===a("cQ4aK").RelativeSelectionPos.Start)return sz(e)(t)(i,o);if(n===a("cQ4aK").RelativeSelectionPos.End||void 0===n)return sj(e)()(i,o)}return!1},sD=(e,t,i)=>(o=!1)=>(n,r)=>{let{selection:l}=n,s=(0,a("id9O1").findTable)(l),d=(0,a("2QyFu").selectedRect)(n);if(s&&(0,a("iYC9s").isRowSelected)(d.top)(l))return sF(e)({node:s.node,startPos:s.start,dir:"BottomToTop"})(n,r);if(s&&d){let e=t$(d.left,void 0,o)(n,r),l=a("LmqWp").TableMap.get(s.node);return t&&i&&t(i().formatMessage(a("2CQVV").messages.columnSelected,{index:d.left+1,total:l.width}),{priority:"important"}),e}return!1},sP=(e,t,i)=>(o=!1)=>(n,r)=>{let{selection:l}=n,s=(0,a("id9O1").findTable)(l),d=(0,a("2QyFu").selectedRect)(n);if(s&&(0,a("iYC9s").isColumnSelected)(d.left)(l))return sF(e)({node:s.node,startPos:s.start,dir:"BottomToTop"})(n,r);if(s&&d){let e=tZ(d.top,void 0,o)(n,r),l=a("LmqWp").TableMap.get(s.node);return t&&i&&t(i().formatMessage(a("2CQVV").messages.rowSelected,{index:d.top+1,total:l.height}),{priority:"important"}),e}return!1},sB=e=>t=>(i,o)=>{let{doc:n}=i,{$from:r,from:l,side:s}=t;if(s===a("adhil").Side.RIGHT){if(r.nodeBefore&&"table"===r.nodeBefore.type.name)return sF(e)({node:r.nodeBefore,startPos:n.resolve(l-1).start(r.depth+1),dir:"TopToBottom"})(i,o)}else if(s===a("adhil").Side.LEFT){let n=(0,a("id9O1").findTable)(t);if(n&&sK(r,t)&&e){let t=e.sharedState.currentState()||{};return t?.selectionRelativeToNode===a("cQ4aK").RelativeSelectionPos.Before?sG(e)()(i,o):sF(e)({node:n.node,startPos:n.start,dir:"BottomToTop"})(i,o)}}return!1},sW=e=>t=>(i,o)=>{let{$from:n,from:r,$to:l,side:s}=t;if(s===a("adhil").Side.LEFT){if(n.nodeAfter&&"table"===n.nodeAfter.type.name)return sF(e)({node:n.nodeAfter,startPos:r+1,dir:"BottomToTop"})(i,o)}else if(s===a("adhil").Side.RIGHT){let n=(0,a("id9O1").findTable)(t);if(n&&s$(l,t))return sF(e)({node:n.node,startPos:n.start,dir:"TopToBottom"})(i,o)}return!1},sU=e=>t=>(i,o)=>{let n=(0,a("id9O1").findTable)(t);if(n){let{$from:r}=t,l=tg(i)||{},s=!!l?.isKeyboardResize;if(sK(r,t)&&"paragraph"===r.parent.type.name&&r.depth===n.depth+3&&e&&!s){let t=e.sharedState.currentState()||{};return t?.selectionRelativeToNode===a("cQ4aK").RelativeSelectionPos.Before?sG(e)()(i,o):sF(e)({node:n.node,startPos:n.start,dir:"BottomToTop"})(i,o)}}return!1},sH=e=>t=>(i,o)=>{let n=(0,a("id9O1").findTable)(t);if(n){let{$to:a}=t,r=tg(i)||{},l=!!r?.isKeyboardResize;if(s$(a,t)&&"paragraph"===a.parent.type.name&&a.depth===n.depth+3&&!l)return sF(e)({node:n.node,startPos:n.start,dir:"TopToBottom"})(i,o)}return!1},sF=e=>({node:t,startPos:i,dir:o})=>(n,r)=>{let l,s,{doc:d}=n,{map:c}=a("LmqWp").TableMap.get(t),p=d.resolve(i+c[0]),u=d.resolve(i+c[c.length-1]);if("TopToBottom"===o?(l=new(0,a("7XFGZ").CellSelection)(p,u),s=a("cQ4aK").RelativeSelectionPos.End):(l=new(0,a("7XFGZ").CellSelection)(u,p),s=a("cQ4aK").RelativeSelectionPos.Start),e){let t=e.actions.selectNearNode({selectionRelativeToNode:s,selection:l})(n);if(r)return r(t),!0}return!1},sz=e=>(t,i)=>(o,n)=>{let{$anchorCell:r,$headCell:l}=t,s=r.pos<l.pos?r:l,d=o.doc.resolve(s.pos+1),c=a("adhil").GapCursorSelection.valid(d)?new(0,a("adhil").GapCursorSelection)(d,a("adhil").Side.LEFT):a("ks2lK").Selection.findFrom(d,1);if(e){let t=e.actions.selectNearNode({selectionRelativeToNode:i,selection:c})(o);if(n)return n(t),!0}return!1},sV=e=>(t,i)=>(o,n)=>{let{$anchorCell:r,$headCell:l}=t,s=r.pos>l.pos?r:l,d=s.pos+(s.nodeAfter?s.nodeAfter.content.size:0)+1,c=o.doc.resolve(d),p=a("adhil").GapCursorSelection.valid(c)?new(0,a("adhil").GapCursorSelection)(c,a("adhil").Side.RIGHT):a("ks2lK").Selection.findFrom(c,-1);if(e){let t=e.actions.selectNearNode({selectionRelativeToNode:i,selection:p})(o);if(n)return n(t),!0}return!1},sG=e=>()=>(t,i)=>{let o=(0,a("id9O1").findTable)(t.selection);if(o){let n=t.doc.resolve(o.pos);if(a("adhil").GapCursorSelection.valid(n)){let o=new(0,a("adhil").GapCursorSelection)(n,a("adhil").Side.LEFT);if(e){let n=e.actions.selectNearNode({selectionRelativeToNode:void 0,selection:o})(t);if(i)return i(n),!0}}}return!1},sj=e=>()=>(t,i)=>{let o=(0,a("id9O1").findTable)(t.selection);if(o){let n=t.doc.resolve(o.pos+o.node.nodeSize);if(a("adhil").GapCursorSelection.valid(n)){let o=new(0,a("adhil").GapCursorSelection)(n,a("adhil").Side.RIGHT);if(e){let n=e.actions.selectNearNode({selectionRelativeToNode:void 0,selection:o})(t);if(i)return i(n),!0}}}return!1},sK=(e,t)=>(0,a("l6okE").isSelectionAtStartOfNode)(e,(0,a("id9O1").findTable)(t)?.node),s$=(e,t)=>(0,a("l6okE").isSelectionAtEndOfNode)(e,(0,a("id9O1").findTable)(t)?.node),sX=e=>()=>(t,i)=>{let{selection:o}=t,n=(0,a("id9O1").findTable)(o),r=a0(t),l=r?.top;return!!n&&0===l&&sF(e)({node:n.node,startPos:n.start,dir:"BottomToTop"})(t,i)},sZ=e=>()=>(t,i)=>{let{selection:o}=t,n=(0,a("id9O1").findTable)(o);if(!n)return!1;let{$from:r,$to:l}=o;return!(0,a("iYC9s").isTableSelected)(o)&&r.pos>n.start+1&&l.pos<n.start+n.node.nodeSize&&sF(e)({node:n.node,startPos:n.start,dir:"BottomToTop"})(t,i)},sq=new(0,a("ks2lK").PluginKey)("tableSizeSelectorPlugin"),sY=e=>new(0,a("1S4f7").SafePlugin)({key:sq,state:{init:()=>({isSelectorOpen:!1}),apply:(t,i)=>{let o=t.getMeta(sq);if(o&&Object.keys(o).some(e=>i[e]!==o[e])){let t={...i,...o};return e(sq,t),t}return i}}}),sQ=new(0,a("ks2lK").PluginKey)("tableWidthInCommentFixPlugin"),sJ=e=>e&&sQ.getState(e),s0=(e,t)=>new(0,a("1S4f7").SafePlugin)({key:sQ,state:{init:()=>({documentHasLoadedOnce:!1}),apply(t,i){let o=t.getMeta(sQ);if(o&&Object.keys(o).some(e=>i[e]!==o[e])){let t={...i,...o};return e(sQ,t),t}return i}},view:()=>({update(e){let{state:i}=e,o=sJ(i);if(!o)return;let{documentHasLoadedOnce:n}=o;if(n)return;let{table:r}=i.schema.nodes;(0,a("2P8Ax").default)(()=>{let i=e.state.tr,o=!1;e.state.doc.descendants((e,n)=>{let l=e.type===r,s=e.attrs.width,d=e.attrs.layout;return l&&s===a("aFUXX").akEditorDefaultLayoutWidth&&"default"===d&&(o=!0,i.setNodeMarkup(n,void 0,{...e.attrs,width:null,layout:t?Q:"default"})),!1}),o&&(i.setMeta("addToHistory",!1),e.dispatch(i))})(),e.dispatch(i.tr.setMeta(sQ,{documentHasLoadedOnce:!0}))}})});a("42omo");let s1=e=>{let{mode:t}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e.api,["editorViewMode"],e=>({mode:e.editorViewModeState?.mode}));return"edit"===t?null:(0,d.jsx)(a("7f6CO").default,{...e})},s2="view-mode-sorting-icon",s9="is-disabled",s4="data-sort-index",s5=new(0,a("ks2lK").PluginKey)("tableViewModeSortPlugin"),s3=(e,t)=>{let i=t.querySelector(":scope > tbody"),o=t.querySelectorAll(":scope > tbody > tr");[...e].sort((e,t)=>e.value-t.value).forEach(e=>{i?.appendChild(o[e.index+1])})},s8=(e,t,i)=>{let o=(0,a("caYZ2").convertProsemirrorTableNodeToArrayOfRows)(e);o.shift();let n=o.map((e,t)=>({node:e,originalIndex:t})),r=(0,a("d4WtM").createCompareNodes)({getInlineCardTextFromStore:()=>null},i);return[{value:-1,index:-1},...n.sort((e,i)=>r(e.node[t],i.node[t])).map((e,t)=>({value:e.originalIndex,index:t}))]},s6=(e,t,i)=>{let o=t.target;if(!(o instanceof HTMLElement))return;let n=o.closest(`.${s2}`);if(n?.classList.contains(s9)||!n)return;let r=o?.closest(".ProseMirror-widget")?.getAttribute(s4),l=e.state.tr,s=o.closest("table");if(!s||!r)return;let d=e.posAtDOM(s,0),c=e.state.doc.nodeAt(d-1),p=c?.attrs.localId;if(!p||!c||c?.type?.name!=="table")return;let{index:u,direction:h,order:m}=i?.[p]||{};h!==a("2QYOD").SortOrder.NO_ORDER&&void 0!==m&&s3(m,s);let f=parseInt(r);if(f===u)switch(h){case a("2QYOD").SortOrder.NO_ORDER:h=a("2QYOD").SortOrder.ASC;break;case a("2QYOD").SortOrder.ASC:h=a("2QYOD").SortOrder.DESC;break;case a("2QYOD").SortOrder.DESC:h=a("2QYOD").SortOrder.NO_ORDER}else h=a("2QYOD").SortOrder.ASC;let g=s8(c,f,h);h===a("2QYOD").SortOrder.NO_ORDER?l.setMeta("tableSortMeta",{[p]:{}}):l.setMeta("tableSortMeta",{[p]:{index:f,direction:h,order:g,tableElement:s}}),e.dispatch(l)},s7=e=>{let t=document.querySelector(`table[data-table-local-id="${e}"]`);return{tbody:t?.querySelector(":scope > tbody"),rows:t?.querySelectorAll(":scope > tbody > tr")}},de=(e,i)=>new(0,a("1S4f7").SafePlugin)({state:{init:()=>({decorations:a("ftzrq").DecorationSet.empty,sort:{},allTables:[]}),apply(o,n,r){let{mode:l}=e.editorViewMode?.sharedState.currentState()||{};if("view"!==l){let e=n?.decorations?.find(void 0,void 0,e=>e?.type==="sorting-decoration");return{...n,decorations:n?.decorations?.remove(e)}}let{decorations:s,sort:d,allTables:p}=n,u=o.getMeta("tableSortMeta"),h=o.getMeta("mouseEnterTable"),m=o.getMeta("removeTable"),f="";m?p=p.filter(([e])=>e!==m):f=h?.[0],d={...d,...u};let g=p.some(([e])=>e===f);h&&(p=p.filter(([e])=>e!==h[0])).push(h);let b=[],E=n.decorations.find(void 0,void 0,e=>e.tableId===f&&"sorting-decoration"===e.type);return(h&&!g||u||g&&!E.length)&&(p.forEach(l=>{let[s,p,u]=l,h=o.doc.nodeAt(o.mapping.map(u));if(!h||"table"!==h.type.name)return n;let m=a("LmqWp").TableMap.get(h),f=new Set(m.map).size!==m.map.length;m.mapByRow[0].forEach((o,n)=>{let l=t(eg)();b.push(a("ftzrq").Decoration.widget(o+u+2,()=>{let t,o=document.createElement("div");o.setAttribute(s4,`${n}`),o.classList.add(s2),f&&o.classList.add(s9),t=n===d[s]?.index?d[s]?.direction:a("2QYOD").SortOrder.NO_ORDER;let{getIntl:p}=tg(r);return i.render(()=>(0,c.createElement)(a("gmMgo").Provider,{value:p()},(0,c.createElement)(s1,{isSortingAllowed:!f,sortOrdered:t,onClick:()=>{},onKeyDown:()=>{},api:e})),o,l),o},{destroy:e=>{i.remove(l)},type:"sorting-decoration",tableId:s}))})}),s=a("ftzrq").DecorationSet.create(o.doc,b)),o.docChanged&&(s=s.map(o.mapping,o.doc),p=p.map(e=>[e[0],e[1],o.mapping.map(e[2])])),{decorations:s,sort:d,allTables:p}}},key:s5,appendTransaction:(t,i,o)=>{let{mode:n}=e?.editorViewMode?.sharedState.currentState()||{};if("view"!==n)return o.tr;let r=s5.getState(o)?.allTables||[];for(let e of t){let t=e.getMeta("mouseEnterTable");t&&(r=r.filter(([e])=>e!==t[0])).push(t);let n=e.getMeta("isRemote"),l=e.docChanged,s=n&&l,d=s5.getState(i),c=s5.getState(o);for(let t of r){let[i,r,l]=t,{order:p,direction:u,index:h}=d?.sort?.[i]||{};if(s){let t=e.doc.nodeAt(l);if(t?.attrs?.localId!==i||!r.eq(t)){let e=o.tr;if(e.setMeta("tableSortMeta",{[i]:{}}),e.setMeta("removeTable",i),void 0!==p){let{rows:t,tbody:o}=s7(i);if(!t||!o)return e;return[...p].sort((e,t)=>e.value-t.value).forEach((e,i)=>{o.appendChild(t[e.index+1])}),e}}}let{order:m,direction:f,index:g}=c?.sort?.[i]||{};if((u!==f||h!==g)&&!n&&f!==a("2QYOD").SortOrder.NO_ORDER){let{rows:e,tbody:t}=s7(i);e&&m&&m.forEach((i,o)=>{t?.appendChild(e[i.value+1])})}}}return o.tr},props:{handleDOMEvents:{keydown:(e,t)=>{if("Enter"===t.key||" "===t.key){let i=s5.getState(e.state)?.sort||{};s6(e,t,i)}},click:(e,t)=>{let i=s5.getState(e.state)?.sort||{};s6(e,t,i)}},decorations:e=>s5.getState(e)?.decorations||a("ftzrq").DecorationSet.empty}});a("42omo");var dt=a("aeAfU");let di=`
  -ms-overflow-style: -ms-autohiding-scrollbar;

  &::-webkit-scrollbar {
    overflow: hidden,
  }

  &::-webkit-scrollbar-corner {
    display: none;
  }

  &::-webkit-scrollbar-thumb {
    background-color: var(--ds-background-neutral-subtle, #00000000);
  }

  &:hover::-webkit-scrollbar-thumb {
    background-color: var(--ds-background-neutral-bold, #292A2E);
    border-radius: 8px;
  }

  &::-webkit-scrollbar-thumb:hover {
    background-color: var(--ds-background-neutral-bold-hovered, #3B3D42);
  }
`,dn=e=>(0,a("9K4OG").css)(".",eu.CONTROLS_INSERT_LINE,"{background:",iB,";display:none;position:absolute;z-index:",a("aFUXX").akEditorUnitZIndex,";",e,";}"),da=()=>(0,a("9K4OG").css)({backgroundColor:ik,position:"absolute",height:"4px",width:"4px",borderRadius:"var(--ds-radius-full, 9999px)",pointerEvents:"none"}),dr=e=>(0,a("9K4OG").css)(".",eu.CONTROLS_INSERT_MARKER,"{",da(),";",e,";}"),dl=e=>(0,a("9K4OG").css)("border-radius:var(--ds-radius-small, 3px);border-width:0px;display:inline-flex;max-width:100%;text-align:center;margin:0px;padding:0px;text-decoration:none;transition:background 0.1s ease-out 0s,box-shadow 0.15s cubic-bezier(0.47, 0.03, 0.49, 1.38) 0s;outline:none!important;cursor:none;>.",eu.CONTROLS_BUTTON_ICON,"{display:inline-flex;max-height:100%;max-width:100%;}",e,";"),ds=e=>(0,a("9K4OG").css)(".",eu.CONTROLS_BUTTON,"{background:",iI,";border:1px solid ",ik,";display:block;box-sizing:border-box;padding:0;",e,";:focus{outline:none;}}.",eu.ROW_CONTROLS_BUTTON,"::after{content:' ';background-color:transparent;left:-15px;top:0;position:absolute;width:15px;height:100%;z-index:1;}.active .",eu.CONTROLS_BUTTON,"{color:",`var(--ds-icon-inverse, ${a("6fnsQ").N0})`,";background-color:",iP,";border-color:",iB,";}"),dd=()=>(0,a("9K4OG").css)(".",eu.CONTROLS_BUTTON,":hover{color:",`var(--ds-icon-inverse, ${a("6fnsQ").N0})`,";background-color:",iP,";border-color:",iB,";cursor:pointer;}"),dc=()=>(0,a("9K4OG").css)(".",eu.HOVERED_CELL_IN_DANGER," .",eu.CONTROLS_BUTTON,"{background-color:",iz,";border-color:",iF,";position:relative;z-index:",a("aFUXX").akEditorUnitZIndex,";}"),dp=()=>(0,a("9K4OG").css)(".",eu.CONTROLS_INSERT_BUTTON_INNER,"{position:absolute;z-index:",a("aFUXX").akEditorUnitZIndex+10,";bottom:0;}.",eu.CONTROLS_INSERT_BUTTON_INNER,",.",eu.CONTROLS_INSERT_BUTTON,"{height:",20,"px;width:",20,"px;}.",eu.CONTROLS_INSERT_BUTTON,"{",dl(`
      background: var(--ds-surface-overlay, white);
      box-shadow: var(--ds-shadow-overlay, 0 4px 8px -2px ${a("6fnsQ").N60A}, 0 0 1px ${a("6fnsQ").N60A});
      color: var(--ds-icon, ${a("6fnsQ").N300});
    `),";}.",eu.CONTROLS_INSERT_LINE,"{display:none;}&:hover .",eu.CONTROLS_INSERT_LINE,"{display:flex;}"),du=()=>(0,a("9K4OG").css)(".",eu.CONTROLS_INSERT_BUTTON,":hover{background:",`var(--ds-background-brand-bold, ${a("6fnsQ").B300})`,";color:var(--ds-icon-inverse, white);cursor:pointer;}"),dh=()=>(0,a("9K4OG").css)(".",eu.DRAG_CONTROLS_INSERT_BUTTON_INNER,"{position:absolute;z-index:",a("aFUXX").akEditorUnitZIndex+10,";}.",eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_COLUMN,"{bottom:-3px;left:2px;}.",eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW,"{left:-3px;bottom:-2px;}.",eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW_CHROMELESS,"{left:6px;bottom:-2px;}.",eu.DRAG_CONTROLS_INSERT_BUTTON,"{",dl(`
    background: var(--ds-surface-overlay, white);
    color: var(--ds-icon, ${a("6fnsQ").N300});
    border: 1px solid var(--ds-background-accent-gray-subtler, #C1C7D0);
    border-radius: 50%;
    height: 16px;
    width: 16px;
  `),";}.",eu.DRAG_CONTROLS_INSERT_BUTTON,":hover{background:",`var(--ds-background-brand-bold, ${a("6fnsQ").B300})`,";border:1px solid ",`var(--ds-background-brand-bold, ${a("6fnsQ").B300})`,";color:var(--ds-icon-inverse, white);cursor:pointer;}"),dm=()=>(0,a("9K4OG").css)(".",eu.DRAG_CORNER_BUTTON,"{width:15px;height:15px;display:flex;justify-content:center;align-items:center;position:absolute;top:-17px;left:-5px;background-color:transparent;border:none;padding:0;outline:none;z-index:",99*a("aFUXX").akEditorUnitZIndex,";&.active .",eu.DRAG_CORNER_BUTTON_INNER,"{background-color:var(--ds-border-selected, #0C66E4);width:10px;height:10px;border-width:2px;border-radius:4px;top:3px;left:2px;}&:hover{cursor:pointer;.",eu.DRAG_CORNER_BUTTON_INNER,"{width:10px;height:10px;border-radius:4px;top:3px;left:2px;}}}.",eu.DRAG_CORNER_BUTTON_INNER,"{border:1px solid var(--ds-border-inverse, #FFF);background-color:var(--ds-background-accent-gray-subtler, #DCDFE4);border-radius:2px;width:5px;height:5px;position:relative;}"),df=()=>(0,a("9K4OG").css)(dp(),du(),dn(`
    width: 2px;
    left: 9px;
  `)),dg=()=>(0,a("9K4OG").css)(dp(),du(),dn(`
    height: 2px;
    top: -11px;
	
    left: 19px;
  `)),db=()=>(0,a("9K4OG").css)(".",eu.TABLE_CONTAINER,".",eu.WITH_CONTROLS," table tr:first-of-type td,.",eu.TABLE_CONTAINER,".",eu.WITH_CONTROLS," table tr:first-of-type th{position:relative;}"),dE=()=>(0,a("9K4OG").css)(".",eu.CONTROLS_DELETE_BUTTON_WRAP,",.",eu.CONTROLS_DELETE_BUTTON,"{height:",16,"px;width:",16,"px;}.",eu.CONTROLS_DELETE_BUTTON_WRAP,"{.",eu.CONTROLS_DELETE_BUTTON,"{",dl(`
        background: ${iU};
        color: ${iW};
      `),";}}.",eu.CONTROLS_DELETE_BUTTON,":hover{background:",iV,";color:","var(--ds-icon-inverse, white)",";cursor:pointer;}"),dT=e=>(0,a("9K4OG").css)(".",eu.TABLE_RIGHT_SHADOW,",.",eu.TABLE_LEFT_SHADOW,"{display:block;height:calc(100% - ",a("1zav4").tableMarginTop,"px);position:absolute;pointer-events:none;top:",a("1zav4").tableMarginTop,"px;z-index:",a("aFUXX").akEditorShadowZIndex,";width:",32,"px;}.",eu.TABLE_LEFT_SHADOW,"{background:linear-gradient(\n				to left,\n				transparent 0,\n				",`var(--ds-shadow-overflow-spread, ${a("6fnsQ").N40A})`," 140%\n			),linear-gradient(\n				to right,\n				var(--ds-shadow-overflow-perimeter, transparent) 0px,\n				transparent 1px\n			);left:0px;}.",eu.TABLE_CONTAINER,"[data-number-column='true']>:not(.",eu.TABLE_STICKY_SHADOW,").",eu.TABLE_LEFT_SHADOW,"{left:",a("aFUXX").akEditorTableNumberColumnWidth-1,"px;}.",eu.TABLE_RIGHT_SHADOW,"{background:linear-gradient(\n				to right,\n				transparent 0,\n				",`var(--ds-shadow-overflow-spread, ${a("6fnsQ").N40A})`," 140%\n			),linear-gradient(\n				to left,\n				var(--ds-shadow-overflow-perimeter, transparent) 0px,\n				transparent 1px\n			);left:calc(100% - ",32,"px);}.",eu.WITH_CONTROLS,"{",dC(e)," .",eu.TABLE_LEFT_SHADOW,"{border-left:1px solid ",ik,";}}"),dC=e=>{if(!e)return(0,a("9K4OG").css)(".",eu.TABLE_RIGHT_SHADOW,",.",eu.TABLE_LEFT_SHADOW,"{height:calc(100% - ",a("1zav4").tableMarginTopWithControl,"px);top:",a("1zav4").tableMarginTopWithControl,"px;}")},d_=e=>(0,a("9K4OG").css)({background:iI,display:"block",boxSizing:"border-box",padding:0,":focus":{outline:"none"}},e),dS=()=>(0,a("9K4OG").css)({color:`var(--ds-text-inverse, ${a("6fnsQ").N0})`,backgroundColor:iP,borderColor:iB,zIndex:i$}),dw=()=>(0,a("9K4OG").css)("tr th:last-child .",eu.COLUMN_CONTROLS_DECORATIONS,"::before,tr td:last-child .",eu.COLUMN_CONTROLS_DECORATIONS,"::before{content:'';background-color:",ik,";position:absolute;height:",4,"px;width:",4,"px;border-radius:50%;pointer-events:none;top:var(--ds-space-025, 2px);right:0px;}"),dv=()=>(0,a("9K4OG").css)(".",eu.DRAG_COLUMN_DROP_TARGET_CONTROLS,"{box-sizing:border-box;position:absolute;top:0;.",eu.DRAG_COLUMN_CONTROLS_INNER,"{display:flex;flex-direction:row;}}.",eu.DRAG_COLUMN_CONTROLS,"{box-sizing:border-box;.",eu.DRAG_COLUMN_CONTROLS_INNER,"{display:grid;justify-items:center;}}"),dO=()=>(0,a("9K4OG").css)("div.",eu.WITH_CONTROLS,">.",eu.DRAG_ROW_CONTROLS_WRAPPER,"::after{display:none;}div.",eu.WITH_CONTROLS,">.",eu.ROW_CONTROLS_WRAPPER,"::after{content:' ';background-color:",ik,";position:absolute;height:",4,"px;width:",4,"px;border-radius:50%;pointer-events:none;top:-",iG+a("1zav4").tableCellBorderWidth,"px;right:-1px;}"),dy=()=>(0,a("9K4OG").css)(".",eu.COLUMN_CONTROLS_DECORATIONS,"{display:none;cursor:pointer;position:absolute;width:100%;left:0;top:-",25+a("1zav4").tableCellBorderWidth,"px;height:",25,"px;&::before{content:' ';background-color:",ik,";position:absolute;height:",4,"px;width:",4,"px;border-radius:50%;pointer-events:none;top:2px;right:var(--ds-space-negative-025, -2px);}&::after{content:' ';",d_(`
        border-right: ${a("1zav4").tableCellBorderWidth}px solid ${ik};
        border-top: ${a("1zav4").tableCellBorderWidth}px solid ${ik};
        border-bottom: ${a("1zav4").tableCellBorderWidth}px solid ${ik};
        box-sizing: content-box;
        height: ${iG-1}px;
        width: 100%;
        position: absolute;
        top: ${25-iG}px;
        left: 0px;
        z-index: ${iK};
      `),";}}",dw()," .",eu.WITH_CONTROLS," .",eu.COLUMN_CONTROLS_DECORATIONS,"{display:block;}table tr:first-of-type td.",eu.TABLE_CELL,",table tr:first-of-type th.",eu.TABLE_HEADER_CELL,"{&.",eu.COLUMN_SELECTED,",&.",eu.HOVERED_TABLE,"{.",eu.COLUMN_CONTROLS_DECORATIONS,"::after{",dS(),";}&.",eu.HOVERED_CELL_IN_DANGER," .",eu.COLUMN_CONTROLS_DECORATIONS,"::after{background-color:",iz,";border-color:",iF,";z-index:",100*a("aFUXX").akEditorUnitZIndex,";}}}table tr:first-of-type td.",eu.TABLE_CELL,",table tr:first-of-type th.",eu.TABLE_HEADER_CELL,"{&.",eu.COLUMN_SELECTED,",&.",eu.HOVERED_COLUMN,"{.",eu.COLUMN_CONTROLS_DECORATIONS,"::after{",dS(),";border-left:",a("1zav4").tableCellBorderWidth,"px solid ",iB,";left:-",a("1zav4").tableCellBorderWidth,"px;}}}table tr:first-of-type td.",eu.TABLE_CELL,",table tr:first-of-type th.",eu.TABLE_HEADER_CELL,"{&.",eu.HOVERED_COLUMN,"{.",eu.COLUMN_CONTROLS_DECORATIONS,"::after{",dS(),";}&.",eu.HOVERED_CELL_IN_DANGER," .",eu.COLUMN_CONTROLS_DECORATIONS,"::after{background-color:",iz,";border-color:",iF,";border-left:",a("1zav4").tableCellBorderWidth,"px solid ",iF,";left:-",a("1zav4").tableCellBorderWidth,"px;z-index:",100*a("aFUXX").akEditorUnitZIndex,";}}}.",eu.TABLE_SELECTED," table tr:first-of-type td.",eu.TABLE_CELL,",.",eu.TABLE_SELECTED," table tr:first-of-type th.",eu.TABLE_HEADER_CELL,"{.",eu.COLUMN_CONTROLS_DECORATIONS,"::after{",dS(),";}}"),dN=()=>(0,a("9K4OG").css)(".",eu.TABLE_CONTAINER,".",eu.HOVERED_DELETE_BUTTON,"{.",eu.SELECTED_CELL,",.",eu.COLUMN_SELECTED,",.",eu.HOVERED_CELL,"{border:1px solid ",iF,";}.",eu.SELECTED_CELL,"::after{background:",iH,";}.",eu.TABLE_NODE_WRAPPER,">table{td.",eu.HOVERED_NO_HIGHLIGHT,"::after{background:",iH,";border:1px solid ",iF,";}th.",eu.HOVERED_NO_HIGHLIGHT,"{background-color:unset;}th.",eu.HOVERED_NO_HIGHLIGHT,"::after{background:",iH,";border:1px solid ",iF,";}}}"),dR=()=>(0,a("9K4OG").css)(":not(.",eu.IS_RESIZING,") .",eu.TABLE_CONTAINER,":not(.",eu.HOVERED_DELETE_BUTTON,"){.",eu.HOVERED_CELL,"{position:relative;border:1px solid ",iB,";}.",eu.HOVERED_CELL,".",eu.HOVERED_NO_HIGHLIGHT,"{position:relative;border:1px solid ",ik,";}}"),dx=(0,a("9K4OG").css)(":not(.",eu.IS_RESIZING,") .",eu.TABLE_CONTAINER,":not(.",eu.HOVERED_DELETE_BUTTON,"){td.",eu.HOVERED_CELL_WARNING,"{background-color:",`var(--ds-background-warning, ${a("6fnsQ").Y50})`,"!important;border:1px solid ",`var(--ds-border-warning, ${a("6fnsQ").Y200})`,";}}"),dA=()=>(0,a("9K4OG").css)("th.",eu.WITH_DRAG_RESIZE_LINE,"::before,td.",eu.WITH_DRAG_RESIZE_LINE,"::before{content:' ';position:absolute;left:var(--ds-space-negative-025, -2px);top:-1px;width:",2,"px;height:calc(100% + 2px);background-color:",iB,";z-index:",2*iK,";}th.",eu.WITH_DRAG_RESIZE_LINE_LAST_COLUMN,"::before,td.",eu.WITH_DRAG_RESIZE_LINE_LAST_COLUMN,"::before{content:' ';position:absolute;right:-1px;top:-1px;width:",2,"px;height:calc(100% + 2px);background-color:",iB,";z-index:",2*iK,";}td.",eu.WITH_RESIZE_LINE,"::before{content:' ';position:absolute;left:var(--ds-space-negative-025, -2px);top:-1px;width:",2,"px;height:calc(100% + 2px);background-color:",iB,";z-index:",2*iK,";}th.",eu.WITH_RESIZE_LINE,"::before{content:' ';left:var(--ds-space-negative-025, -2px);position:absolute;width:",2,"px;height:calc(100% + ",iG+a("1zav4").tableCellBorderWidth,"px);background-color:",iB,";z-index:",2*iK,";top:-",iG+a("1zav4").tableCellBorderWidth,"px;}td.",eu.WITH_RESIZE_LINE_LAST_COLUMN,"::before{content:' ';position:absolute;right:-1px;top:-1px;width:",2,"px;height:calc(100% + 2px);background-color:",iB,";z-index:",2*iK,";}th.",eu.WITH_RESIZE_LINE_LAST_COLUMN,"::before{content:' ';right:-1px;position:absolute;width:",2,"px;height:calc(100% + ",iG+a("1zav4").tableCellBorderWidth,"px);background-color:",iB,";z-index:",2*iK,";top:-",iG+a("1zav4").tableCellBorderWidth,"px;}"),dI=()=>(0,a("9K4OG").css)(".",eu.TABLE_CONTAINER,"{.",eu.RESIZE_HANDLE_DECORATION,"{background-color:transparent;position:absolute;width:",10,"px;height:100%;top:0;right:-",5,"px;cursor:col-resize;z-index:",iZ,";}tr th:last-child .",eu.RESIZE_HANDLE_DECORATION,",tr td:last-child .",eu.RESIZE_HANDLE_DECORATION,"{background-color:transparent;position:absolute;width:",5,"px;height:100%;top:0;right:0;cursor:col-resize;z-index:",iZ,";}",dA()," table tr:first-of-type th.",eu.WITH_DRAG_RESIZE_LINE," .",eu.RESIZE_HANDLE_DECORATION,"::after,table tr:first-of-type td.",eu.WITH_DRAG_RESIZE_LINE," .",eu.RESIZE_HANDLE_DECORATION,"::after,table tr:first-of-type th.",eu.WITH_RESIZE_LINE," .",eu.RESIZE_HANDLE_DECORATION,"::after,table tr:first-of-type td.",eu.WITH_RESIZE_LINE," .",eu.RESIZE_HANDLE_DECORATION,"::after{top:-",iG+a("1zav4").tableCellBorderWidth,"px;height:calc(100% + ",iG+a("1zav4").tableCellBorderWidth,"px);}}"),dL=(0,a("9K4OG").css)({content:"' '",position:"absolute",height:`calc(100% + ${2*a("1zav4").tableCellBorderWidth}px)`,width:"3px",zIndex:2*iK}),dk=(0,a("9K4OG").css)({content:"' '",position:"absolute",left:"var(--ds-space-negative-025, -2px)",height:"3px",width:`calc(100% + ${2*a("1zav4").tableCellBorderWidth}px)`,zIndex:2*iK}),dM=(0,a("9K4OG").css)({backgroundColor:iB}),dD=(0,a("9K4OG").css)({backgroundColor:`var(--ds-background-accent-gray-subtler, ${a("aFUXX").akEditorTableBorder})`}),dP=()=>(0,a("9K4OG").css)(".",eu.TABLE_CONTAINER,"{td.",eu.WITH_FIRST_COLUMN_INSERT_LINE,"::before{",dL," left:-1px;top:-1px;",dM,";}td.",eu.WITH_FIRST_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," left:-1px;top:-1px;",dD,";}th.",eu.WITH_FIRST_COLUMN_INSERT_LINE,"::before{",dL," left:-1px;top:-",a("1zav4").tableCellBorderWidth,"px;",dM,";}th.",eu.WITH_FIRST_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," left:-1px;top:-",a("1zav4").tableCellBorderWidth,"px;",dD,";}td.",eu.WITH_COLUMN_INSERT_LINE,"::before{",dL," left:var(--ds-space-negative-025, -2px);top:-1px;",dM,";}td.",eu.WITH_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," left:var(--ds-space-negative-025, -2px);top:-1px;",dD,";}th.",eu.WITH_COLUMN_INSERT_LINE,"::before{",dL," left:var(--ds-space-negative-025, -2px);top:-",a("1zav4").tableCellBorderWidth,"px;",dM,";}th.",eu.WITH_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," left:var(--ds-space-negative-025, -2px);top:-",a("1zav4").tableCellBorderWidth,"px;",dD,";}td.",eu.WITH_LAST_COLUMN_INSERT_LINE,"::before{",dL," right:-1px;top:-1px;",dM,";}td.",eu.WITH_LAST_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," right:-1px;top:-1px;",dD,";}th.",eu.WITH_LAST_COLUMN_INSERT_LINE,"::before{",dL," right:-1px;top:-",a("1zav4").tableCellBorderWidth,"px;",dM,";}th.",eu.WITH_LAST_COLUMN_INSERT_LINE_INACTIVE,"::before{",dL," right:-1px;top:-",a("1zav4").tableCellBorderWidth,"px;",dD,";}td.",eu.WITH_ROW_INSERT_LINE,"::before{",dk," top:-1px;",dM,";}td.",eu.WITH_ROW_INSERT_LINE_INACTIVE,"::before{",dk," top:-1px;",dD,";}th.",eu.WITH_ROW_INSERT_LINE,"::before{",dk," top:-1px;",dM,";}th.",eu.WITH_ROW_INSERT_LINE_INACTIVE,"::before{",dk," top:-1px;",dD,";}td.",eu.WITH_LAST_ROW_INSERT_LINE,"::before{",dk," bottom:0;",dM,";}td.",eu.WITH_LAST_ROW_INSERT_LINE_INACTIVE,"::before{",dk," bottom:0;",dD,";}th.",eu.WITH_LAST_ROW_INSERT_LINE,"::before{",dk," bottom:0;",dM,";}th.",eu.WITH_LAST_ROW_INSERT_LINE_INACTIVE,"::before{",dk," bottom:0;",dD,";}}"),dB=iG+1,dW=`
.${eu.NODEVIEW_WRAPPER}.${a("aFUXX").akEditorSelectedNodeClassName} table tbody tr {
  th,td {
    ${(0,a("ieXGd").getSelectionStyles)([a("b38UX").SelectionStyle.Blanket,a("b38UX").SelectionStyle.Border])}

    // The non-break space /00a0 in :after selector caused a table scroll issue when pressing Cmd+A to select table
    // This line is to override the content of :after selector from the shared getSelectionStyles
    &::after {
      content: '';
    }
  }
}
`,dU=`
.${eu.NODEVIEW_WRAPPER}.${a("aFUXX").akEditorSelectedNodeClassName} .pm-table-left-border,
.${eu.NODEVIEW_WRAPPER}.${a("aFUXX").akEditorSelectedNodeClassName} .pm-table-right-border {
	  background: ${a("aFUXX").akEditorSelectedBorderColor};
}
`,dH=`.${eu.TABLE_CONTAINER} {
  > .${eu.TABLE_STICKY_SENTINEL_TOP}, > .${eu.TABLE_STICKY_SENTINEL_BOTTOM} {
    position: absolute;
    width: 100%;
    height: 1px;
    margin-top: -1px;
    // need this to avoid sentinel being focused via keyboard
    // this still allows it to be detected by intersection observer
    visibility: hidden;
  }
  > .${eu.TABLE_STICKY_SENTINEL_TOP} {
    top: 25px;
  }
  > .${eu.TABLE_STICKY_SENTINEL_BOTTOM} {
      bottom: 62px;
  }
  &.${eu.WITH_CONTROLS} {
    > .${eu.TABLE_STICKY_SENTINEL_TOP} {
      top: 0px;
    }
    > .${eu.TABLE_STICKY_SENTINEL_BOTTOM} {
      margin-bottom: 25px;
    }
  }
}`,dF=`.${eu.TABLE_CONTAINER} {
 > .${eu.TABLE_STICKY_SCROLLBAR_SENTINEL_BOTTOM},
 > .${eu.TABLE_STICKY_SCROLLBAR_SENTINEL_TOP} {
    position: absolute;
    width: 100%;
    height: 1px;
    margin-top: -1px;
    // need this to avoid sentinel being focused via keyboard
    // this still allows it to be detected by intersection observer
    visibility: hidden;
  }
  > .${eu.TABLE_STICKY_SCROLLBAR_SENTINEL_TOP} {
    top: 157px;
  }
  > .${eu.TABLE_STICKY_SCROLLBAR_SENTINEL_BOTTOM} {
    bottom: ${a("aFUXX").MAX_BROWSER_SCROLLBAR_HEIGHT}px;
  }
}`,dz=`.${eu.TABLE_CONTAINER} {
  > .${eu.TABLE_STICKY_SCROLLBAR_CONTAINER} {
    width: 100%;
    display: none;
    overflow-x: auto;
    position: sticky;
    bottom: 0;
    z-index: 1;
  }
}`,dV=`${dz} ${dF}`,dG=`
  .${eu.TABLE_SHADOW_SENTINEL_LEFT},
  .${eu.TABLE_SHADOW_SENTINEL_RIGHT} {
    position: absolute;
    top: 0;
    height: 100%;
    width: 1px;
    visibility: hidden;
  }
  .${eu.TABLE_SHADOW_SENTINEL_LEFT} {
    left: 0;
  }
  .${eu.TABLE_SHADOW_SENTINEL_RIGHT} {
    right: 0;
  }
`,dj=()=>(0,a("9K4OG").css)(">*:not([data-mark-type='fragment']) .",eu.NODEVIEW_WRAPPER," .",eu.TABLE_CONTAINER,"{margin-left:unset!important;width:100%!important;}>[data-mark-type='fragment'] * .",eu.NODEVIEW_WRAPPER," .",eu.TABLE_CONTAINER,"{margin-left:unset!important;width:100%!important;}"),dK=()=>(0,a("9K4OG").css)("th{.",s2,"{+p{margin-top:0!important;}}>.",s2,"{&:has(.is-active){.",a("1j8OE").SORTABLE_COLUMN_ICON_CLASSNAME,"{opacity:1;}}}>.",s2,"{.",a("1j8OE").SORTABLE_COLUMN_ICON_CLASSNAME,"{opacity:0;&:focus{opacity:1;}}}&:hover:not(:has(.",eu.TABLE_CONTAINER,":hover)){>.",s2,"{.",a("1j8OE").SORTABLE_COLUMN_ICON_CLASSNAME,"{opacity:1;}}}}"),d$=()=>`border-color: ${iF}`,dX=()=>(0,a("9K4OG").css)(".",eu.TABLE_STICKY," .",eu.COLUMN_CONTROLS_DECORATIONS,"{z-index:0;left:-1px;}.",eu.TABLE_STICKY," .",eu.COLUMN_CONTROLS_DECORATIONS,"::after{border-left:1px solid ",ik,";}.",eu.TABLE_STICKY," tr:first-of-type th.",eu.TABLE_HEADER_CELL,"{&.",eu.COLUMN_SELECTED,",&.",eu.HOVERED_COLUMN,"{.",eu.COLUMN_CONTROLS_DECORATIONS,"::after{left:0;}}}"),dZ=()=>{if(((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).gecko)return(0,a("9K4OG").css)(".",eu.TABLE_STICKY,">tbody::before{content:'';}")},dq=e=>(0,a("9K4OG").css)(db(),";",dN(),";",dR(),";",dx,";",dP(),";",dI(),";",dW,";",(0,a("dh538").fg)("platform_editor_table_numbered_table_border")&&dU,";",dK(),";",(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&dJ,";.",eu.LAST_ITEM_IN_CELL,"{margin-bottom:0;}.",eu.TABLE_NODE_WRAPPER,"{td.",eu.TABLE_CELL,",th.",eu.TABLE_HEADER_CELL,"{position:relative;overflow:visible;}td.",eu.TABLE_CELL,"{background-color:",iA,";&::after{height:100%;content:'';border-left:1px solid ",ik,";border-bottom:1px solid ",ik,";position:absolute;right:0px;top:0px;bottom:0;width:100%;display:inline-block;pointer-events:none;}}}.",eu.CONTROLS_FLOATING_BUTTON_COLUMN,"{",df(),";}.",eu.CONTROLS_FLOATING_BUTTON_ROW,"{",dg(),";}",dh()," ",dm(),dE(),(0,a("dh538").fg)("platform_editor_nested_tables_sticky_header_bug")?`
		.${eu.TABLE_STICKY} > .${e.isDragAndDropEnabled?eu.DRAG_ROW_CONTROLS_WRAPPER:eu.ROW_CONTROLS_WRAPPER} .${eu.NUMBERED_COLUMN} .${eu.NUMBERED_COLUMN_BUTTON}:first-of-type {
			margin-top: ${(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?8:10}px;
			width: ${a("aFUXX").akEditorTableNumberColumnWidth}px;

			position: fixed !important;
			z-index: ${a("aFUXX").akEditorStickyHeaderZIndex} !important;
			box-shadow: 0px -8px var(--ds-surface, white);
			border-right: 0 none;
			/* top set by NumberColumn component */
		}
		`:`
    	.${eu.TABLE_STICKY} .${eu.NUMBERED_COLUMN} .${eu.NUMBERED_COLUMN_BUTTON}:first-of-type {
			margin-top: ${(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?8:10}px;
			width: ${a("aFUXX").akEditorTableNumberColumnWidth}px;

			position: fixed !important;
			z-index: ${a("aFUXX").akEditorStickyHeaderZIndex} !important;
			box-shadow: 0px -8px var(--ds-surface, white);
			border-right: 0 none;
			/* top set by NumberColumn component */
		}
		`," .",eu.TABLE_STICKY," .",eu.CORNER_CONTROLS,".sticky{position:fixed!important;z-index:",a("aFUXX").akEditorSmallZIndex,"!important;background:var(--ds-surface, white);width:",iG,"px;height:",iG,"px;}.",eu.CORNER_CONTROLS,".sticky .",eu.CONTROLS_CORNER_BUTTON,"{border-bottom:0px none;border-right:0px none;height:",iG,"px;width:",iG,"px;}",dX()," ",dZ()," .",eu.TABLE_STICKY," .",eu.ROW_CONTROLS," .",eu.ROW_CONTROLS_BUTTON_WRAP,".sticky{position:fixed!important;z-index:",a("aFUXX").akEditorStickyHeaderZIndex,"!important;display:flex;border-left:",iG,"px solid var(--ds-surface, white);margin-left:-",iG,"px;}.",eu.TABLE_STICKY," col:first-of-type{border-right:1px solid var(--ds-surface, green);}tr.sticky{padding-top:",8,"px;position:fixed;display:grid;z-index:",a("aFUXX").akEditorTableCellOnStickyHeaderZIndex-5,";overflow-y:visible;overflow-x:hidden;grid-auto-flow:column;background:var(--ds-surface, white);box-sizing:content-box;box-shadow:0 6px 4px -4px ",`var(--ds-shadow-overflow-perimeter, ${a("6fnsQ").N40A})`,";margin-left:-1px;&.no-pointer-events{pointer-events:none;}}.",eu.TABLE_STICKY," .",eu.TABLE_STICKY_SHADOW,"{left:unset;position:fixed;z-index:",a("aFUXX").akEditorTableCellOnStickyHeaderZIndex,";}.",eu.WITH_CONTROLS,".",eu.TABLE_STICKY," .",eu.TABLE_STICKY_SHADOW,"{padding-bottom:",iG,"px;}.tableView-content-wrap:has(.tableView-content-wrap):has(\n			.",eu.NESTED_TABLE_WITH_CONTROLS,"\n		){padding-left:unset;}.tableView-content-wrap:has(.",eu.NESTED_TABLE_WITH_CONTROLS,"){padding-left:15px;}tr.sticky th{border-bottom:",1,"px solid ",ik,";margin-right:-1px;}.",eu.TABLE_STICKY," tr.sticky>th:last-child{border-right-width:1px;}.",eu.TABLE_STICKY," tr.sticky>th:first-of-type{margin-left:0px;}.",eu.TABLE_STICKY," tr.sticky::after{content:' ';width:",11,"px;}.",eu.TABLE_STICKY," .sticky+tr{min-height:0px;}.",eu.TABLE_CONTAINER,".",eu.TABLE_STICKY,"{tr.sticky td.",eu.WITH_RESIZE_LINE,",tr.sticky th.",eu.WITH_RESIZE_LINE,"{.",eu.RESIZE_HANDLE_DECORATION,"::after{right:",5,"px;}}tr.sticky td.",eu.WITH_RESIZE_LINE,".",eu.SELECTED_CELL,",tr.sticky th.",eu.WITH_RESIZE_LINE,".",eu.SELECTED_CELL,"{.",eu.RESIZE_HANDLE_DECORATION,"::after{right:",4,"px;}}}tr.sticky .",eu.HOVERED_CELL,",tr.sticky .",eu.SELECTED_CELL,"{z-index:1;}tr.",eu.NATIVE_STICKY,"{position:sticky;top:",a("1zav4").tableMarginTop,"px;z-index:calc(",a("aFUXX").akEditorTableCellOnStickyHeaderZIndex," - 5);box-shadow:inset -1px 1px ",ik,",inset 1px -1px ",ik,";",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`th.${eu.TABLE_HEADER_CELL}::after {
				height: 100%;
				content: '';
				border-left: 1px solid ${ik};
				border-bottom: 1px solid ${ik};
				position: absolute;
				right: 0px;
				top: 0px;
				bottom: 0;
				width: 100%;
				display: inline-block;
				pointer-events: none;
			}`:"",";&.",eu.NATIVE_STICKY_ACTIVE,"{box-shadow:inset -1px 1px ",ik,",inset 1px -1px ",ik,",0 6px 4px -4px var(--ds-shadow-overflow-perimeter, #1E1F211f);}}.",eu.TABLE_NODE_WRAPPER,":has(tr.",eu.NATIVE_STICKY,")::before{content:' ';display:block;top:0;box-sizing:border-box;width:100%;height:0;margin-bottom:-",a("1zav4").tableMarginTop,"px;position:sticky;border-top:",a("1zav4").tableMarginTop,"px solid var(--ds-surface, #FFFFFF);z-index:",iq,";}",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_2")?`
		.${eu.TABLE_NODE_WRAPPER}:has(tr.${eu.NATIVE_STICKY})::before {
			border-top: ${a("1zav4").tableMarginTop}px solid transparent;
		}

		.${eu.TABLE_NODE_WRAPPER}:has(tr.${eu.NATIVE_STICKY_ACTIVE})::before {
			border-top: ${a("1zav4").tableMarginTop}px solid var(--ds-surface, #FFFFFF);
		}`:(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`
			.${eu.TABLE_NODE_WRAPPER}:has(tr.${eu.NATIVE_STICKY})::before {
				margin-top: 1px;
			}`:"",".",eu.TABLE_CONTAINER,":has(.",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW,")>.",eu.DRAG_ROW_CONTROLS_WRAPPER,">div>.",eu.DRAG_ROW_CONTROLS,"{top:",24,"px;z-index:",iQ,";}.",eu.TABLE_CONTAINER,"[data-table-header-is-stuck='true']:has(.",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW,")>.",eu.DRAG_ROW_CONTROLS_WRAPPER,">div>.",eu.DRAG_ROW_CONTROLS,"{z-index:",iJ,";}.",eu.TABLE_CONTAINER,":has(.",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," ",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")?`tr.${eu.NATIVE_STICKY}`:"",")>.",eu.DRAG_ROW_CONTROLS_WRAPPER,">div>.",eu.NUMBERED_COLUMN,"{top:",24,"px;}.pm-table-wrapper:has([data-number-column='true'] tr.",eu.NATIVE_STICKY,")::before{margin-left:-",a("aFUXX").akEditorTableNumberColumnWidth,"px;width:calc(100% + ",a("aFUXX").akEditorTableNumberColumnWidth,"px);}.",eu.TABLE_CONTAINER,".",eu.WITH_CONTROLS,"[data-table-header-is-stuck='true'] .",eu.DRAG_ROW_FLOATING_DRAG_HANDLE,":is([data-row-index='0'], [data-selected-row-index='0']:not([data-handle-appearance='default'])){visibility:hidden;}.",eu.WITH_CONTROLS," tr.",eu.NATIVE_STICKY,"{top:",a("1zav4").tableMarginTop,"px;}.",eu.WITH_CONTROLS," tr.sticky{padding-top:",ij,"px;}",(0,a("dh538").fg)("platform_editor_nested_tables_sticky_header_bug")?`
		.${eu.WITH_CONTROLS}.${eu.TABLE_STICKY} > .${eu.DRAG_ROW_CONTROLS_WRAPPER}
			.${eu.NUMBERED_COLUMN}
			.${eu.NUMBERED_COLUMN_BUTTON}:first-of-type {
			margin-top: ${(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?ij:ij+2}px;
		}
		`:`
		.${eu.WITH_CONTROLS}.${eu.TABLE_STICKY}
			.${eu.NUMBERED_COLUMN}
			.${eu.NUMBERED_COLUMN_BUTTON}:first-of-type {
			margin-top: ${(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?ij:ij+2}px;
		}
		`," .",eu.CORNER_CONTROLS,".sticky{border-top:",(0,a("dh538").fg)("platform_editor_number_column_sticky_header_bug")?ij-iG:ij-iG+2,"px solid var(--ds-surface, white);}",dH," ",dT(e.featureFlags?.tableDragAndDrop)," ",dV," .",eu.TABLE_STICKY," .",eu.TABLE_STICKY_SHADOW,"{height:0;}.less-padding{padding:0 ",8,"px;.",eu.DRAG_ROW_CONTROLS_WRAPPER,",.",eu.ROW_CONTROLS_WRAPPER,"{padding:0 ",8,"px;&::after{right:6px!important;}}.",eu.DRAG_ROW_CONTROLS_WRAPPER,".",eu.TABLE_CHROMELESS,"{left:-4px;}.",eu.DRAG_COLUMN_CONTROLS_WRAPPER,"{padding:0 ",8,"px;}.",eu.DRAG_COLUMN_CONTROLS_WRAPPER,".",eu.TABLE_CHROMELESS,"{left:-8px;}&.",eu.TABLE_CONTAINER,"[data-number-column='true']{padding-left:",a("aFUXX").akEditorTableNumberColumnWidth+8-1,"px;}.",eu.TABLE_LEFT_SHADOW,",.",eu.TABLE_RIGHT_SHADOW,"{width:",8,"px;}.",eu.TABLE_LEFT_SHADOW,"{left:6px;}.",eu.TABLE_LEFT_SHADOW,".",eu.TABLE_CHROMELESS,"{left:8px;}.",eu.TABLE_RIGHT_SHADOW,"{left:calc(100% - 6px);}.",eu.TABLE_RIGHT_SHADOW,".",eu.TABLE_CHROMELESS,"{left:calc(100% - 16px);}}>.",eu.NODEVIEW_WRAPPER,"{/**\n       * Prevent margins collapsing, aids with placing the gap-cursor correctly\n       * @see https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Box_Model/Mastering_margin_collapsing\n       *\n       * TODO: Enable this, many tests will fail!\n       * border-top: 1px solid transparent;\n       */}",dj()," ",dy(),";",dO(),";.",eu.CORNER_CONTROLS,"{width:",iG+1,"px;height:",dB,"px;display:none;.",eu.CORNER_CONTROLS_INSERT_ROW_MARKER,"{position:relative;",dr(`
          left: -11px;
          top: 9px;
        `),";}}.",eu.CORNER_CONTROLS,".sticky{.",eu.CORNER_CONTROLS_INSERT_ROW_MARKER,"{display:none!important;}}.",eu.CONTROLS_CORNER_BUTTON,"{position:absolute;top:0;width:",iG+1,"px;height:",iG+1,"px;border:1px solid ",ik,";border-radius:0;border-top-left-radius:",3,"px;background:",iI,";box-sizing:border-box;padding:0;:focus{outline:none;}}.active .",eu.CONTROLS_CORNER_BUTTON,"{border-color:",iB,";background:",iP,";}.",eu.TABLE_CONTAINER,"[data-number-column='true']{.",eu.CORNER_CONTROLS,",.",eu.CONTROLS_CORNER_BUTTON,"{width:",a("aFUXX").akEditorTableToolbarSize+a("aFUXX").akEditorTableNumberColumnWidth+1,"px;}.",eu.ROW_CONTROLS," .",eu.CONTROLS_BUTTON,"{border-right-width:0;}}:not(.",eu.IS_RESIZING,") .",eu.CONTROLS_CORNER_BUTTON,":hover{border-color:",iB,";background:",iP,";cursor:pointer;}:not(.",eu.IS_RESIZING,") .",eu.CONTROLS_CORNER_BUTTON,".",eu.HOVERED_CELL_IN_DANGER,"{border-color:",iF,";background:",iz,";}.",eu.ROW_CONTROLS,"{width:",iG,"px;box-sizing:border-box;display:none;position:relative;",dr(`
        bottom: -1px;
        left: -11px;
      `),";",ds(`
        border-bottom: 1px solid ${ik};
        border-right: 0px;
        border-radius: 0;
        height: 100%;
        width: ${iG}px;

        .${eu.CONTROLS_BUTTON_OVERLAY} {
          position: absolute;
          width: 30px;
          height: 50%;
          right: 0;
          bottom: 0;
        }
        .${eu.CONTROLS_BUTTON_OVERLAY}:first-of-type {
          top: 0;
        }
      `),";.",eu.ROW_CONTROLS_INNER,"{display:flex;flex-direction:column;}.",eu.ROW_CONTROLS_BUTTON_WRAP,":last-child>button{border-bottom-left-radius:",3,"px;}.",eu.ROW_CONTROLS_BUTTON_WRAP,"{position:relative;margin-top:-1px;}.",eu.ROW_CONTROLS_BUTTON_WRAP,":hover,.",eu.ROW_CONTROLS_BUTTON_WRAP,".active,.",eu.CONTROLS_BUTTON,":hover{z-index:",a("aFUXX").akEditorUnitZIndex,";}}.",eu.DRAG_ROW_CONTROLS,"{display:grid;align-items:center;position:absolute;z-index:",iX+4,";.",eu.DRAG_ROW_FLOATING_INSERT_DOT_WRAPPER,"{position:absolute;align-self:end;height:100%;width:18px;}.",eu.DRAG_ROW_FLOATING_INSERT_DOT,"{position:absolute;bottom:-3px;left:2px;background-color:var(--ds-background-accent-gray-subtler, #C1C7D0);height:4px;width:4px;border-radius:50%;pointer-events:none;}}.",eu.DRAG_COLUMN_CONTROLS,"{.",eu.DRAG_COLUMN_CONTROLS_INNER,"{height:",24,"px;position:absolute;top:var(--ds-space-negative-150, -12px);z-index:",iZ,";}.",eu.DRAG_COLUMN_FLOATING_INSERT_DOT_WRAPPER,"{position:absolute;height:",24,"px;width:100%;}.",eu.DRAG_COLUMN_FLOATING_INSERT_DOT,"{background-color:var(--ds-background-accent-gray-subtler, #C1C7D0);height:4px;width:4px;border-radius:50%;position:absolute;right:-2px;}}.",eu.DRAG_HANDLE_BUTTON_CLICKABLE_ZONE,"{background:none;border:none;outline:none;position:absolute;margin:0;padding:0;display:flex;align-items:center;cursor:pointer;:focus{outline:none;}}.",eu.DRAG_HANDLE_BUTTON_CONTAINER,"{cursor:grab;pointer-events:auto;line-height:0;padding:0;border-radius:6px;width:max-content;border:2px solid ",`var(--ds-surface, ${a("6fnsQ").N0})`,";display:flex;justify-content:center;align-items:center;background:transparent;outline:none;&.placeholder{background-color:transparent;border:2px solid transparent;}&.",eu.DRAG_HANDLE_DISABLED,"{cursor:pointer;& svg{&>rect.",eu.DRAG_HANDLE_MINIMISED,"{fill:var(--ds-background-accent-gray-subtler, #DCDFE4);}&>rect{fill:var(--ds-background-accent-gray-subtlest, #F4F5F7);}&>g>rect{fill:var(--ds-icon-disabled, #BFDBF847);}}}&:not(.",eu.DRAG_HANDLE_DISABLED,"){& svg{rect{fill:var(--ds-background-accent-gray-subtler, #DCDFE4);}g{fill:var(--ds-icon-subtle, #626f86);}}&:hover{svg{rect{fill:var(--ds-background-accent-blue-subtle, #579DFF);}g{fill:var(--ds-icon-inverse, #FFF);}}}&:active{cursor:grabbing;}&.selected{:focus{outline:2px solid var(--ds-border-focused, #2684FF);outline-offset:1px;}&:active{outline:none;}svg{rect{fill:var(--ds-background-accent-blue-subtle, #579dff);}g{fill:var(--ds-icon-inverse, #fff);}}}&.danger{svg{rect{fill:var(--ds-background-accent-red-subtler-pressed, #F87462);}g{fill:var(--ds-border-inverse, #FFF);}}}}}",dv()," :not(.",eu.IS_RESIZING,") .",eu.ROW_CONTROLS,"{",dd()," ",dc(),";}.",eu.NUMBERED_COLUMN,"{position:relative;float:right;margin-left:",a("aFUXX").akEditorTableToolbarSize,"px;top:",e.isDragAndDropEnabled||(0,g.editorExperiment)("support_table_in_comment_jira",!0)?0:a("aFUXX").akEditorTableToolbarSize,"px;width:",a("aFUXX").akEditorTableNumberColumnWidth+1,"px;box-sizing:border-box;}.",eu.NUMBERED_COLUMN_BUTTON,"{border:1px solid ",ik,";box-sizing:border-box;margin-top:-1px;padding-bottom:2px;padding:",(0,N.expValEquals)("confluence_compact_text_format","isEnabled",!0)||(0,N.expValEquals)("cc_editor_ai_content_mode","variant","test")&&(0,a("dh538").fg)("platform_editor_content_mode_button_mvp")?(0,a("aFUXX").relativeSizeToBaseFontSize)(10):"10px"," 2px;text-align:center;font-size:",(0,N.expValEquals)("confluence_compact_text_format","isEnabled",!0)||(0,N.expValEquals)("cc_editor_ai_content_mode","variant","test")&&(0,a("dh538").fg)("platform_editor_content_mode_button_mvp")?(0,a("aFUXX").relativeSizeToBaseFontSize)(14):(0,a("aFUXX").relativeFontSizeToBase16)(14),";background-color:",iI,";color:",iL,";border-color:",ik,";:first-child:not(style),style:first-child+*{margin-top:0;}:last-child{border-bottom:1px solid ",ik,";}}",(0,a("dh538").fg)("platform_editor_nested_tables_sticky_header_bug")?`
		.${eu.TABLE_STICKY} > .${e.isDragAndDropEnabled?eu.DRAG_ROW_CONTROLS_WRAPPER:eu.ROW_CONTROLS_WRAPPER} {
				.${eu.NUMBERED_COLUMN_BUTTON_DISABLED}:first-of-type::after {
				content: '';
				display: block;
				height: 33px;
				width: 100%;
				background-color: var(--ds-surface, white);
				position: absolute;

				/* the extra pixel is accounting for borders */
				top: -34px;
				left: -1px;
			}
		}
		`:`
		.${eu.TABLE_STICKY} {
			.${eu.NUMBERED_COLUMN_BUTTON_DISABLED}:first-of-type::after {
				content: '';
				display: block;
				height: 33px;
				width: 100%;
				background-color: var(--ds-surface, white);
				position: absolute;

				/* the extra pixel is accounting for borders */
				top: -34px;
				left: -1px;
			}
		}
		`," .",eu.WITH_CONTROLS,"{.",eu.CORNER_CONTROLS,",.",eu.ROW_CONTROLS,"{display:block;}.",eu.NUMBERED_COLUMN,"{padding-left:0px;.",eu.NUMBERED_COLUMN_BUTTON,"{border-left:0 none;}.",eu.NUMBERED_COLUMN_BUTTON,".active{border-bottom:1px solid ",iB,";border-color:",iB,";background-color:",iP,";position:relative;z-index:",a("aFUXX").akEditorUnitZIndex,";color:",`var(--ds-text-selected, ${a("6fnsQ").N0})`,";}}.",eu.TABLE_CONTAINER,"{.",eu.NUMBERED_COLUMN_BUTTON,"{border-left:1px solid ",ik,";}}}:not(.",eu.IS_RESIZING,") .",eu.WITH_CONTROLS,"{.",eu.NUMBERED_COLUMN_BUTTON,":not(.",eu.NUMBERED_COLUMN_BUTTON_DISABLED,"){cursor:pointer;}.",eu.NUMBERED_COLUMN_BUTTON,":not(.",eu.NUMBERED_COLUMN_BUTTON_DISABLED,"):hover{border-bottom:1px solid ",iB,";border-color:",iB,";background-color:",iP,";position:relative;z-index:",a("aFUXX").akEditorUnitZIndex,";color:",`var(--ds-text-selected, ${a("6fnsQ").N0})`,";}.",eu.NUMBERED_COLUMN_BUTTON,".",eu.HOVERED_CELL_IN_DANGER,"{background-color:",iz,";border:1px solid ",iF,";border-left:0;color:",`var(--ds-text-danger, ${a("6fnsQ").R500})`,";position:relative;z-index:",a("aFUXX").akEditorUnitZIndex,";}}",(0,lT.expValEqualsNoExposure)("platform_editor_block_menu","isEnabled",!0)?`.tableView-content-wrap.danger {
		:not(.${eu.IS_RESIZING}) .${eu.WITH_CONTROLS} {
			.${eu.NUMBERED_COLUMN_BUTTON} {
				background-color: ${iz};
				border: 1px solid ${iF};
				border-left: 0;
				color: var(--ds-text-danger, ${a("6fnsQ").R500});
				position: relative;
				z-index: ${a("aFUXX").akEditorUnitZIndex};
			}
		}
	}`:"",".",eu.TABLE_NODE_WRAPPER,">table{table-layout:fixed;white-space:normal;border-top:none;margin-right:-1px;position:relative;>tbody>tr{white-space:pre-wrap;}.",eu.COLUMN_CONTROLS_DECORATIONS,"+*{margin-top:0;}th.",eu.TABLE_HEADER_CELL,">.fabric-editor-block-mark{>h1:first-of-type,>h2:first-of-type,>h3:first-of-type,>h4:first-of-type,>h5:first-of-type,>h6:first-of-type{margin-top:0;}}.",eu.SELECTED_CELL,",.",eu.HOVERED_CELL_IN_DANGER,"{position:relative;}.",eu.SELECTED_CELL,"::after,.",eu.HOVERED_CELL_IN_DANGER,"::after{z-index:",a("aFUXX").akEditorSmallZIndex,";position:absolute;content:'';left:0;right:0;top:0;bottom:0;width:100%;pointer-events:none;}.",eu.SELECTED_CELL,"{border:1px solid ",iB,";}.",eu.SELECTED_CELL,"::after{background:",iM,";z-index:",a("aFUXX").akEditorSmallZIndex,";}th.",eu.HOVERED_CELL_IN_DANGER,"::after,td.",eu.HOVERED_CELL_IN_DANGER,"::after{background:",iH,";z-index:",100*a("aFUXX").akEditorUnitZIndex,";}td.",eu.HOVERED_CELL,",td.",eu.SELECTED_CELL,",th.",eu.TABLE_HEADER_CELL,".",eu.SELECTED_CELL,",th.",eu.TABLE_HEADER_CELL,".",eu.HOVERED_CELL,"{&::after{height:100%;width:100%;border:1px solid ",iB,";content:'';position:absolute;left:-1px;top:-1px;bottom:0;z-index:",a("aFUXX").akEditorSmallZIndex,";display:inline-block;pointer-events:none;}&.",eu.HOVERED_CELL_IN_DANGER,"::after{",d$(),";z-index:",100*a("aFUXX").akEditorUnitZIndex,";}&.",eu.HOVERED_NO_HIGHLIGHT,".",eu.HOVERED_CELL_IN_DANGER,"::after{",d$(),";z-index:",100*a("aFUXX").akEditorUnitZIndex,";}}}.",eu.DRAG_ROW_CONTROLS_WRAPPER,"{position:absolute;margin-top:",a("1zav4").tableMarginTop,"px;left:-",iG+1,"px;}.",eu.ROW_CONTROLS_WRAPPER,"{position:absolute;",e.isDragAndDropEnabled?`
			margin-top: ${a("1zav4").tableMarginTop}px;
			top: 0;
			left: -${iG+1}px;
		`:`
			/* top of corner control is table margin top - corner control height + 1 pixel of table border. */
			top: ${a("1zav4").tableMarginTop-dB+1}px;
			margin-top: 0;
			left: -${iG}px;
		`,";}.",eu.DRAG_ROW_CONTROLS_WRAPPER,".",eu.TABLE_LEFT_SHADOW,",.",eu.ROW_CONTROLS_WRAPPER,".",eu.TABLE_LEFT_SHADOW,"{z-index:",a("aFUXX").akEditorUnitZIndex,";}.",eu.DRAG_COLUMN_CONTROLS_WRAPPER,"{position:absolute;top:",a("1zav4").tableMarginTop,"px;}",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`
	.${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} > .${eu.DRAG_COLUMN_CONTROLS_WRAPPER} {
		/* +2px is to overlap the table border on the sides */
		width: calc(anchor-size(width) + 2px);
		height: ${a("1zav4").tableMarginTop}px;
		background: var(--ds-surface, #FFFFFF);
		top: unset;
		position: fixed;
		position-area: top center;
		position-visibility: anchors-visible;
		z-index: ${iY+1};
	}`:`.${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} > .${eu.DRAG_COLUMN_CONTROLS_WRAPPER} {
		/* +2px is to overlap the table border on the sides */
		width: calc(anchor-size(width) + 2px);
		height: ${a("1zav4").tableMarginTop}px;
		background: var(--ds-surface, #FFFFFF);
		position: fixed;
		position-area: top center;
		position-visibility: anchors-visible;
		z-index: ${iY+1};
	}`,".",eu.TABLE_CONTAINER,'[data-number-column="true"] .',eu.TABLE_NODE_WRAPPER_NO_OVERFLOW,">.",eu.DRAG_COLUMN_CONTROLS_WRAPPER,"::before{content:'';position:relative;display:inline-block;margin-left:-",a("aFUXX").akEditorTableNumberColumnWidth+14,"px;width:",a("aFUXX").akEditorTableNumberColumnWidth+14,"px;height:",a("1zav4").tableMarginTop,"px;background:var(--ds-surface, #FFFFFF);z-index:",iY-1,";}.",eu.TABLE_CONTAINER,'[data-number-column="true"] .',eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," tr:first-of-type th:first-of-type::before{content:'';position:absolute;display:inline-block;box-sizing:border-box;left:0;width:",a("aFUXX").akEditorTableNumberColumnWidth-1,"px;height:100%;margin-left:-",a("aFUXX").akEditorTableNumberColumnWidth,"px;margin-top:-",8,"px;outline:1px solid ",ik,";border-left:1px solid ",ik,";background:var(--ds-background-accent-gray-subtlest, #F0F1F2);",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`border-top: 1px solid ${ik};`:"",";}.",eu.TABLE_CONTAINER,'[data-number-column="true"].',eu.TABLE_SELECTED," .",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," tr:first-of-type th.",eu.SELECTED_CELL,":not(.",eu.HOVERED_CELL_IN_DANGER,"):first-of-type::before,.",eu.TABLE_CONTAINER,'[data-number-column="true"] .',eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," tr:first-of-type th.",eu.SELECTED_CELL,":not(.",eu.HOVERED_CELL_IN_DANGER,", .",eu.COLUMN_SELECTED,"):first-of-type::before{outline:none;border-left-color:",iB,";",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`border-top-color: ${iB};`:""," background:",iD,";}",(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?`.${eu.TABLE_CONTAINER}[data-number-column="true"] .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th.${eu.HOVERED_CELL_IN_DANGER}:first-of-type::before, .${eu.TABLE_CONTAINER}[data-number-column="true"] .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th.${eu.HOVERED_CELL_IN_DANGER}:not(.${eu.COLUMN_SELECTED}):first-of-type::before {
			outline: none;
			border-left: unset;
			border-top: unset;
			background: ${iH};
		}
		.${eu.TABLE_CONTAINER}[data-number-column="true"].${eu.TABLE_SELECTED}.${eu.HOVERED_DELETE_BUTTON} .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th:first-of-type::before, .${eu.TABLE_CONTAINER}[data-number-column="true"].${eu.HOVERED_DELETE_BUTTON} .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th.${eu.SELECTED_CELL}:not(.${eu.COLUMN_SELECTED}):first-of-type::before {
		outline: none;
		border-left-color: ${iF};
		border-top-color: ${iF};
		background: ${iH};
		}`:`	.${eu.TABLE_CONTAINER}[data-number-column="true"] .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th.${eu.HOVERED_CELL_IN_DANGER}:not(.${eu.COLUMN_SELECTED}):first-of-type::before {
				outline: none;
				background: ${iH};
			}
			.${eu.TABLE_CONTAINER}[data-number-column="true"].${eu.HOVERED_DELETE_BUTTON} .${eu.TABLE_NODE_WRAPPER_NO_OVERFLOW} tr:first-of-type th.${eu.SELECTED_CELL}:not(.${eu.COLUMN_SELECTED}):first-of-type::before {
				outline: none;
				border-left-color: ${iF};
				background: ${iH};
		}`," .",eu.TABLE_CONTAINER,'[data-number-column="true"] .',eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," .",eu.NATIVE_STICKY_ACTIVE," th:first-of-type::before{box-shadow:0 6px 4px -4px var(--ds-shadow-overflow-perimeter, #1E1F211f);}.",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW," .",eu.DRAG_COLUMN_CONTROLS_INNER,":not(.",eu.NESTED_TABLE_WITH_CONTROLS," *){margin-top:",a("1zav4").tableMarginTop,"px!important;}.",eu.TABLE_STICKY," .",eu.DRAG_COLUMN_CONTROLS_WRAPPER,"{position:fixed;z-index:",a("aFUXX").akEditorTableCellOnStickyHeaderZIndex-4,";}",(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_6")?`.${eu.TABLE_CONTAINER}.${eu.WITH_CONTROLS}:has(tr.sticky) .${eu.NUMBERED_COLUMN} .${eu.NUMBERED_COLUMN_BUTTON}:first-of-type {
			box-shadow: 0 -5px 0 1px ${ik};
		}`:"",".",eu.TABLE_CONTAINER,"{.",eu.TABLE_STICKY," .",eu.DRAG_COLUMN_CONTROLS_WRAPPER,"{position:absolute;z-index:",a("aFUXX").akEditorUnitZIndex,";}}.",eu.TABLE_NODE_WRAPPER,"{padding-bottom:0px;overflow:auto;overflow-y:hidden;position:relative;}.",eu.TABLE_NODE_WRAPPER,".",eu.TABLE_NODE_WRAPPER_NO_OVERFLOW,"{overflow:visible;}"),dY=e=>(0,a("9K4OG").css)((0,a("1zav4").tableSharedStyle)(),";",dq(e),";"),dQ=e=>(0,a("9K4OG").css)(".ProseMirror{",(0,N.expValEquals)("platform_editor_ssr_renderer","isEnabled",!0)?dq(e):dY(e),";}.ProseMirror.",eu.IS_RESIZING,"{.",eu.TABLE_NODE_WRAPPER,"{overflow-x:auto;",di,";}}.ProseMirror.",eu.RESIZE_CURSOR,"{cursor:col-resize;}",dG,";");(0,a("9K4OG").css)(".ProseMirror .",eu.TABLE_NODE_WRAPPER,">table{margin-left:0;margin-right:-1px;width:100%;}"),(0,a("9K4OG").css)(".ProseMirror .",eu.TABLE_NODE_WRAPPER,">table{margin-left:0;margin-right:0;",di,";}");let dJ=(0,a("9K4OG").css)(".pm-table-with-controls .pm-table-wrapper-no-overflow [data-prosemirror-node-name='tableHeader']{anchor-name:var(",a("04H9b").ANCHOR_VARIABLE_NAME,", attr(data-node-anchor type(<custom-ident>)));}.pm-table-with-controls .pm-table-wrapper-no-overflow [data-prosemirror-node-name='tableRow']{anchor-name:var(",a("04H9b").ANCHOR_VARIABLE_NAME,", attr(data-node-anchor type(<custom-ident>)));}"),d0=({buttonWidth:e,cellRectLeft:t,cellRefWidth:i,offset:o})=>t+i-e-o,d1=(e,t)=>{let i=e.getBoundingClientRect(),o=t.getBoundingClientRect(),n=e.scrollLeft;return o.left-i.left+n};var d2=({children:e,isContextualMenuOpen:t,mountTo:i,offset:o,stickyHeader:n,tableWrapper:r,targetCellPosition:l,targetCellRef:s})=>{let p=(0,c.useRef)(null),u=(0,c.useRef)(null),h=(0,c.useRef)(0),m=(0,c.useRef)(0);(0,c.useEffect)(()=>{let e=u.current,t=p.current;if(t&&e){h.current=r.scrollLeft,m.current=0,t.style.visibility="hidden";let i=d1(r,t);e.style.marginLeft=`${i}px`;let o=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?t.style.visibility="visible":t.style.visibility="hidden"})},{root:r,rootMargin:"0px 10px 0px 0px",threshold:1}),n=(0,a("2P8Ax").default)(e=>{if(p.current){let t=e.target.scrollLeft-h.current,i=`translateX(${m.current-t}px)`;p.current.style.transform=i,h.current=e.target.scrollLeft,m.current=m.current-t}});return o.observe(e),r.addEventListener("scroll",n),()=>{r.removeEventListener("scroll",n),t.style.transform="",o.unobserve(e)}}},[p,u,r,l,s,t]);let f=(0,c.useMemo)(()=>{let e=s.closest('[data-editor-container="true"]');return e?.getBoundingClientRect().left||0},[s]),g=(0,c.useMemo)(()=>d0({buttonWidth:20,cellRectLeft:s.getBoundingClientRect().left,cellRefWidth:s.clientWidth,offset:o})-f,[f,s,o]);return(0,r0.createPortal)((0,d.jsx)("div",{ref:u,style:{position:"absolute",top:"var(--ds-space-0, 0px)",left:"var(--ds-space-0, 0px)",width:"var(--ds-space-250, 20px)",height:"var(--ds-space-250, 20px)"},children:(0,d.jsx)("div",{ref:p,style:{position:"fixed",top:0+n.padding+2*o,zIndex:a("aFUXX").akEditorTableCellOnStickyHeaderZIndex,left:g,width:"var(--ds-space-250, 20px)",height:"var(--ds-space-250, 20px)"},className:eu.CONTEXTUAL_MENU_BUTTON_FIXED,children:e})}),i)};let d9=()=>(0,a("9K4OG").css)({"> div":{background:`var(--ds-surface, ${a("6fnsQ").N20})`,borderRadius:"var(--ds-radius-small, 3px)",display:"flex",height:"18px",flexDirection:"column",...(0,a("dh538").fg)("platform-visual-refresh-icons")&&{width:"var(--ds-space-250, 20px)"}},"&& button":{background:"var(--ds-background-neutral, none)",flexDirection:"column",margin:"var(--ds-space-025, 2px)",outline:`2px solid var(--ds-surface, ${a("6fnsQ").N0})`,borderRadius:"1px",padding:0,height:"calc(100% - 4px)",display:"flex"},"&& button:hover":{background:`var(--ds-background-neutral-hovered, ${a("6fnsQ").N30A})`},"&& button:active":{background:"var(--ds-background-neutral-pressed, rgba(179, 212, 255, 0.6))"},"&& button > span":{margin:"0px var(--ds-space-negative-050, -4px)"},"&& span":{pointerEvents:"none"}}),d4=()=>(0,a("9K4OG").css)({"&& button":{background:`var(--ds-background-selected, ${a("6fnsQ").N700})`},"&& button:hover":{background:`var(--ds-background-selected-hovered, ${a("6fnsQ").N700})`},"&& button:active":{background:`var(--ds-background-selected-pressed, ${a("6fnsQ").N700})`}}),d5=(0,a("9K4OG").css)({position:"absolute",positionVisibility:"anchors-visible",zIndex:2}),d3=t(c).memo(e=>{let{editorView:i,isContextualMenuOpen:o,mountPoint:n,scrollableElement:r,stickyHeader:l,tableWrapper:s,targetCellPosition:d,isCellMenuOpenByKeyboard:p,isDragAndDropEnabled:h,intl:{formatMessage:m}}=e,f=i.domAtPos.bind(i),g=(0,u.findDomRefAtPos)(d,f);if((0,c.useEffect)(()=>{if(p&&!o){let{state:e,dispatch:t}=i;ay()(e,t)}},[p,o,i]),!g||!(g instanceof HTMLElement))return null;let b=m(a("2CQVV").messages.cellOptions),E=(0,a("9K4OG").jsx)("div",{css:[d9(),o&&d4()]},(0,a("9K4OG").jsx)(a("a4eZN").default,{className:eu.CONTEXTUAL_MENU_BUTTON,selected:o,title:b,keymap:a("hgeg8").focusToContextMenuTrigger,onClick:()=>{let{state:e,dispatch:t}=i;o||ay()(e,t)},iconBefore:(0,a("9K4OG").jsx)(t(a("7kzZ3")),{label:"",color:"currentColor",size:"small"}),"aria-label":b,"aria-expanded":o})),T=g.parentElement&&g.parentElement.className.indexOf("sticky")>-1;if(g.parentElement&&((0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")?s?.classList.contains(eu.TABLE_NODE_WRAPPER_NO_OVERFLOW):g.parentElement.classList.contains(eu.NATIVE_STICKY))&&"TH"===g.nodeName&&rS(h??!1)&&(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")){let e=g.parentElement?.style.getPropertyValue("anchor-name"),t=g.style.getPropertyValue("anchor-name");return""===e&&(e=g.parentElement?.dataset.nodeAnchor),""===t&&(t=g?.dataset.nodeAnchor),(0,a("9K4OG").jsx)("div",{css:d5,style:{top:`calc(3px + anchor(${e} top))`,right:`calc(3px + anchor(${t} right))`,positionAnchor:t},"data-testid":"table-cell-options-anchor-wrapper"},E)}return l&&T&&s?(0,a("9K4OG").jsx)(d2,{offset:3,stickyHeader:l,tableWrapper:s,targetCellPosition:d,targetCellRef:g,mountTo:s,isContextualMenuOpen:o},E):(0,a("9K4OG").jsx)(a("jwWgu").default,{alignX:"right",alignY:"start",target:g,mountTo:s||n,boundariesElement:g,scrollableElement:r,offset:[3,-3],forcePlacement:!0,allowOutOfBounds:!0,zIndex:a("aFUXX").akEditorSmallZIndex},E)}),d8=(0,a("gmMgo").default)(d3);function d6(e){return(0,a("9K4OG").jsx)(a("7fmpI").ErrorBoundary,{component:a("d925B").ACTION_SUBJECT.FLOATING_CONTEXTUAL_BUTTON,dispatchAnalyticsEvent:e.dispatchAnalyticsEvent,fallbackComponent:null},(0,a("9K4OG").jsx)(d8,e))}var d7=a("h4TOP");let ce=e=>(0,a("9K4OG").css)({"&::before":{background:e}}),ct=e=>(0,a("9K4OG").css)(".",eu.CONTEXTUAL_SUBMENU,"{border-radius:var(--ds-radius-small, 3px);background:var(--ds-surface-overlay, white);box-shadow:",`var(--ds-shadow-overlay, 0 4px 8px -2px ${a("6fnsQ").N60A}, 0 0 1px ${a("6fnsQ").N60A})`,";display:block;position:absolute;top:0;left:",e?250:180,"px;padding:var(--ds-space-100, 8px);>div{padding:0;}}.",eu.CONTEXTUAL_MENU_ICON,"{display:flex;&::before{content:'';display:block;border:1px solid ",a("63Ztt").tableBackgroundBorderColor,";border-radius:var(--ds-radius-small, 3px);width:20px;height:20px;}&::after{content:'';margin-left:var(--ds-space-050, 4px);line-height:20px;color:",`var(--ds-icon, ${a("6fnsQ").N90})`,";}}.",eu.CONTEXTUAL_MENU_ICON_SMALL,"{display:flex;&::before{content:'';display:block;border:1px solid ",a("63Ztt").tableBackgroundBorderColor,";border-radius:var(--ds-radius-small, 3px);width:14px;height:14px;}&::after{content:'';margin-left:var(--ds-space-050, 4px);line-height:14px;color:",`var(--ds-icon, ${a("6fnsQ").N90})`,";}}"),ci=new Set(["ArrowRight","ArrowLeft"]),co=(0,a("ecnYn").xcss)({marginRight:"space.negative.075",display:"flex"});class cn extends c.Component{componentDidMount(){let{isCellMenuOpenByKeyboard:e}=this.props;e&&this.setState({...this.state,isOpenAllowed:e})}componentDidUpdate(){let{isDragAndDropEnabled:e,isContextualMenuOpen:t}=tg(this.props.editorView.state);e&&this.props.isDragMenuOpen&&t&&(0,dt.expValNoExposure)("platform_editor_lovability_user_intent","isEnabled",!1)&&ay()(this.props.editorView.state,this.props.editorView.dispatch)}render(){let{isOpen:e,offset:t,boundariesElement:i,editorView:o,isCellMenuOpenByKeyboard:n,api:r}=this.props,{isDragAndDropEnabled:l}=tg(o.state),s=l?this.createNewContextMenuItems():this.createOriginalContextMenuItems(),d=!1;d=n?this.state.isOpenAllowed:e;let c=()=>(0,a("9K4OG").jsx)("div",{"data-testid":"table-cell-contextual-menu",onMouseLeave:this.closeSubmenu,ref:this.dropdownMenuRef},(0,a("9K4OG").jsx)(d7.default,{arrowKeyNavigationProviderOptions:{type:a("5v8Ta").ArrowKeyNavigationType.MENU,disableArrowKeyNavigation:!n||this.state.isSubmenuOpen},items:s,isOpen:d,onOpenChange:this.handleOpenChange,onItemActivated:this.onMenuItemActivated,onMouseEnter:this.handleItemMouseEnter,onMouseLeave:this.handleItemMouseLeave,fitHeight:188,fitWidth:l?250:180,shouldFocusFirstItem:()=>!!n,boundariesElement:i,offset:t,section:l?{hasSeparator:!0}:void 0,allowEnterDefaultBehavior:this.state.isSubmenuOpen}));return(0,lT.expValEqualsNoExposure)("platform_editor_lovability_user_intent","isEnabled",!0)?(0,a("9K4OG").jsx)(a("1eLzC").UserIntentPopupWrapper,{userIntent:"tableContextualMenuPopupOpen",api:r},c()):c()}constructor(...e){super(...e),this.state={isSubmenuOpen:!1,isOpenAllowed:!1},this.dropdownMenuRef=t(c).createRef(),this.handleSubMenuRef=e=>{let t=this.props.editorView.dom,i=(0,a("4vlwG").closestElement)(t,".fabric-editor-popup-scroll-parent")||(0,a("4vlwG").closestElement)(t,".ak-editor-content-area");if(!(i&&e))return;let o=i.getBoundingClientRect(),n=e.getBoundingClientRect();if(this.props.mountPoint)return;let r=e?.offsetParent;if(!r)return;let l=r.getBoundingClientRect(),s=l.right+n.width-o.right,d=o.left-(l.left-n.width);s>d&&(e.style.left=`-${n.width}px`),d>0&&s>0&&(s<d?e.style.left=`${l.width-s}px`:e.style.left=`-${n.width-d}px`)},this.createBackgroundColorItem=()=>{let{allowBackgroundColor:e,editorView:{state:i},isOpen:o,intl:{formatMessage:n},editorView:r,isCellMenuOpenByKeyboard:l}=this.props,{isSubmenuOpen:s}=this.state,{targetCellPosition:d,isDragAndDropEnabled:c}=tg(r.state);if(e){let e=o&&d?i.doc.nodeAt(d):null,r=(0,a("6icEc").hexToEditorBackgroundPaletteColor)(e?.attrs?.background||"#ffffff"),p=(0,a("ahQKW").getSelectedRowAndColumnFromPalette)(nP,r,7),u=p.selectedRowIndex,h=p.selectedColumnIndex;return{content:n(c?a("2CQVV").messages.backgroundColor:a("2CQVV").messages.cellBackground),value:{name:"background"},elemBefore:c?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("7TXtV")),{color:"currentColor",spacing:"spacious",label:n(a("2CQVV").messages.backgroundColor)})):void 0,elemAfter:(0,a("9K4OG").jsx)("div",{className:a("lwMQJ").DropdownMenuSharedCssClassName.SUBMENU},(0,a("9K4OG").jsx)("div",{css:ce(r),className:c?eu.CONTEXTUAL_MENU_ICON_SMALL:eu.CONTEXTUAL_MENU_ICON}),s&&(0,a("9K4OG").jsx)("div",{className:eu.CONTEXTUAL_SUBMENU,ref:this.handleSubMenuRef},(0,a("9K4OG").jsx)(a("9Z3I5").ArrowKeyNavigationProvider,{type:a("5v8Ta").ArrowKeyNavigationType.COLOR,selectedRowIndex:u||0,selectedColumnIndex:h||0,handleClose:()=>{if(this.setState({isSubmenuOpen:!1}),this.dropdownMenuRef&&this.dropdownMenuRef.current){let e=this.dropdownMenuRef.current.querySelectorAll('div[tabindex="-1"]:not([disabled])');e&&e.length&&e[0].focus()}},isPopupPositioned:!0,isOpenedByKeyboard:l},(0,a("9K4OG").jsx)(a("hxEux").default,{cols:7,onClick:this.setColor,selectedColor:e?.attrs?.background||"#ffffff",paletteOptions:{palette:nP,paletteColorTooltipMessages:a("8LFdJ").backgroundPaletteTooltipMessages,hexToPaletteColor:a("6icEc").hexToEditorBackgroundPaletteColor}})))),"aria-expanded":s}}},this.newDistributeColumnsItem=()=>{let{intl:{formatMessage:e}}=this.props;return this.createDistributeColumnsItemInternal({elemBefore:(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("iBNSQ")),{color:"currentColor",spacing:"spacious",label:e(a("2CQVV").messages.distributeColumns)}))})},this.createMergeSplitCellItems=()=>{let{allowMergeCells:e,editorView:{state:i},intl:{formatMessage:o},editorView:n}=this.props,{isDragAndDropEnabled:r}=tg(n.state);return e?[{content:o(a("2CQVV").messages.mergeCells),value:{name:"merge"},isDisabled:!n6(i.tr),elemBefore:r?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("lZgFC")),{color:"currentColor",spacing:"spacious",label:o(a("2CQVV").messages.mergeCells)})):void 0},{content:o(a("2CQVV").messages.splitCell),value:{name:"split"},isDisabled:!nW(i),elemBefore:r?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("4nv4H")),{color:"currentColor",spacing:"spacious",label:o(a("2CQVV").messages.splitCell)})):void 0}]:[]},this.createInsertColumnItem=()=>{let{intl:{formatMessage:e},editorView:i}=this.props,{isDragAndDropEnabled:o}=tg(i.state),n=e(o?a("2CQVV").messages.addColumnRight:a("2CQVV").messages.insertColumn);return{content:n,value:{name:"insert_column"},elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").addColumnAfter)),elemBefore:o?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("6p8nb")),{color:"currentColor",spacing:"spacious",label:e(a("2CQVV").messages.addColumnRight)})):void 0,"aria-label":(0,a("hgeg8").tooltip)(a("hgeg8").addColumnAfter,String(n))}},this.createInsertRowItem=()=>{let{intl:{formatMessage:e},editorView:i}=this.props,{isDragAndDropEnabled:o}=tg(i.state),n=e(o?a("2CQVV").messages.addRowBelow:a("2CQVV").messages.insertRow);return{content:n,value:{name:"insert_row"},elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").addRowAfter)),elemBefore:o?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("4s9K9")),{color:"currentColor",spacing:"spacious",label:e(a("2CQVV").messages.addRowBelow)})):void 0,"aria-label":(0,a("hgeg8").tooltip)(a("hgeg8").addRowAfter,String(n))}},this.createClearCellsItem=()=>{let{selectionRect:e,intl:{formatMessage:i},editorView:o}=this.props,{isDragAndDropEnabled:n}=tg(o.state),{top:r,bottom:l,right:s,left:d}=e,c=s-d,p=l-r,u=i(a("2CQVV").messages.clearCells,{0:Math.max(c,p)});return{content:u,value:{name:"clear"},elemAfter:(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},(0,a("hgeg8").tooltip)(a("hgeg8").backspace)),elemBefore:n?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("iV7dk")),{color:"currentColor",spacing:"spacious",label:i(a("2CQVV").messages.clearCells,{0:Math.max(c,p)})})):void 0,"aria-label":(0,a("hgeg8").tooltip)(a("hgeg8").backspace,String(u))}},this.createDeleteColumnItem=()=>{let{selectionRect:e,intl:{formatMessage:i},editorView:o}=this.props,{isDragAndDropEnabled:n}=tg(o.state),{right:r,left:l}=e,s=r-l;return{content:i(a("2CQVV").messages.removeColumns,{0:s}),value:{name:"delete_column"},elemBefore:n?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("4Ilrk")),{color:"currentColor",spacing:"spacious",label:i(a("2CQVV").messages.removeColumns,{0:s})})):void 0}},this.createDeleteRowItem=()=>{let{selectionRect:e,intl:{formatMessage:i},editorView:o}=this.props,{isDragAndDropEnabled:n}=tg(o.state),{bottom:r,top:l}=e,s=r-l;return{content:i(a("2CQVV").messages.removeRows,{0:s}),value:{name:"delete_row"},elemBefore:n?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:co},(0,a("9K4OG").jsx)(t(a("HbwpQ")),{color:"currentColor",spacing:"spacious",label:i(a("2CQVV").messages.removeRows,{0:s})})):void 0}},this.createDistributeColumnsItemInternal=e=>{let{selectionRect:t,editorView:i,getEditorContainerWidth:o,getEditorFeatureFlags:n,intl:{formatMessage:r}}=this.props,{isTableScalingEnabled:l=!1}=tg(i.state),{tableWithFixedColumnWidthsOption:s=!1}=n?n():{},d=oE(t,i.state,i.domAtPos.bind(i),o,l,s),c=d?.changed??!1;return{content:r(a("2CQVV").messages.distributeColumns),value:{name:"distribute_columns"},isDisabled:!c,...e}},this.createDistributeColumnsItem=()=>{let{editorView:e}=this.props,{isDragAndDropEnabled:t,pluginConfig:{allowDistributeColumns:i}}=tg(e.state);return i&&!t?this.createDistributeColumnsItemInternal():null},this.createSortColumnItems=()=>{let{intl:{formatMessage:e},editorView:t,allowColumnSorting:i}=this.props,{isDragAndDropEnabled:o}=tg(t.state);if(i&&!o){let i=nU(t.state.tr).length>0?{tooltipDescription:e(a("2CQVV").messages.canNotSortTable),isDisabled:!0}:{};return[{content:e(a("2CQVV").messages.sortColumnASC),value:{name:"sort_column_asc"},...i},{content:e(a("2CQVV").messages.sortColumnDESC),value:{name:"sort_column_desc"},...i}]}return null},this.createOriginalContextMenuItems=()=>{let e=[],t=this.createSortColumnItems(),i=this.createBackgroundColorItem(),o=this.createDistributeColumnsItem();return t&&e.push(...t),i&&e.push(i),e.push(this.createInsertColumnItem()),e.push(this.createInsertRowItem()),e.push(this.createDeleteColumnItem()),e.push(this.createDeleteRowItem()),e.push(...this.createMergeSplitCellItems()),o&&e.push(o),e.push(this.createClearCellsItem()),[{items:e}]},this.createNewContextMenuItems=()=>{let e=this.createBackgroundColorItem(),t=this.createMergeSplitCellItems(),i=this.createInsertColumnItem(),o=this.createInsertRowItem(),n=this.createClearCellsItem(),a=this.createDeleteColumnItem(),r=this.createDeleteRowItem(),l=[{items:[]},{items:[]}];return e&&l[0].items.push(e),l[0].items.push(...t),l[1].items.push(i),l[1].items.push(o),(0,g.editorExperiment)("platform_editor_controls","variant1")&&l[1].items.push(this.newDistributeColumnsItem()),l[1].items.push(n),l[1].items.push(a),l[1].items.push(r),l},this.onMenuItemActivated=({item:e})=>{let{editorView:t,selectionRect:i,editorAnalyticsAPI:o,getEditorContainerWidth:n,getEditorFeatureFlags:r,isCellMenuOpenByKeyboard:l,isCommentEditor:s}=this.props,{state:d,dispatch:c}=t,{targetCellPosition:p,isTableScalingEnabled:u=!1}=tg(d),{tableWithFixedColumnWidthsOption:h=!1}=r?r():{};if(l&&("background"!==e.value.name||"background"===e.value.name&&this.state.isSubmenuOpen)){let{tr:e}=d;e.setMeta(eh,{type:"SET_CELL_MENU_OPEN",data:{isCellMenuOpenByKeyboard:!1}}),c(e),t.dom.focus()}let m=u&&(h||s);switch(e.value.name){case"sort_column_desc":aG(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU,i.left,a("5rHEx").SortOrder.DESC)(d,c),this.toggleOpen();break;case"sort_column_asc":aG(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU,i.left,a("5rHEx").SortOrder.ASC)(d,c),this.toggleOpen();break;case"merge":aR(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU)(d,c),this.toggleOpen();break;case"split":ax(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU)(d,c),this.toggleOpen();break;case"distribute_columns":let f=oE(i,d,t.domAtPos.bind(t),n,u,h,s);f&&(aj(o,this.props.api)(a("d925B").INPUT_METHOD.CONTEXT_MENU,f)(d,c),this.toggleOpen());break;case"clear":aN(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU,p)(d,c),this.toggleOpen();break;case"insert_column":aM(this.props.api,o,u,h,m,s)(a("d925B").INPUT_METHOD.CONTEXT_MENU,i.right)(d,c,t),this.toggleOpen();break;case"insert_row":aL(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU,{index:i.bottom,moveCursorToInsertedRow:!0})(d,c),this.toggleOpen();break;case"delete_column":aP(o,this.props.api,u,h,m,s)(a("d925B").INPUT_METHOD.CONTEXT_MENU,i)(d,c,t),this.toggleOpen();break;case"delete_row":let{pluginConfig:{isHeaderRowRequired:g}}=tg(d);aD(o)(a("d925B").INPUT_METHOD.CONTEXT_MENU,i,!!g)(d,c),this.toggleOpen();break;case"background":l&&!this.state.isSubmenuOpen&&this.setState({isSubmenuOpen:!0})}},this.toggleOpen=()=>{let{isOpen:e,editorView:{state:t,dispatch:i}}=this.props;ay()(t,i),e||this.setState({isSubmenuOpen:!1})},this.handleOpenChange=e=>{let{editorView:{state:t,dispatch:i,dom:o},isCellMenuOpenByKeyboard:n}=this.props;if(e){let{event:a}=e;a&&a instanceof KeyboardEvent?this.state.isSubmenuOpen||(ci.has(a.key)&&a.preventDefault(),ay()(t,i),this.setState({isSubmenuOpen:!1}),t6(!1)(t,i),o.focus()):(ay()(t,i),this.setState({isSubmenuOpen:!1}),n&&t6(!1)(t,i))}},this.handleItemMouseEnter=({item:e})=>{let{editorView:{state:t,dispatch:i},selectionRect:o}=this.props;"background"!==e.value.name||this.state.isSubmenuOpen||this.setState({isSubmenuOpen:!0}),"delete_column"===e.value.name&&nV(ar(o),!0)(t,i),"delete_row"===e.value.name&&nG(al(o),!0)(t,i),["sort_column_asc","sort_column_desc"].indexOf(e.value.name)>-1&&0!==nU(t.tr).length&&nz()(t,i)},this.handleItemMouseLeave=({item:e})=>{let{state:t,dispatch:i}=this.props.editorView;"background"===e.value.name&&this.closeSubmenu(),["sort_column_asc","sort_column_desc","delete_column","delete_row"].indexOf(e.value.name)>-1&&nK()(t,i)},this.closeSubmenu=()=>{this.state.isSubmenuOpen&&this.setState({isSubmenuOpen:!1})},this.setColor=e=>{let{editorView:t,editorAnalyticsAPI:i}=this.props,{state:o,dispatch:n}=t;aA(i)(a("d925B").INPUT_METHOD.CONTEXT_MENU,e)(o,n),this.toggleOpen()}}}cn.defaultProps={boundariesElement:"undefined"!=typeof document?document.body:void 0};var ca=(0,a("gmMgo").default)(cn);let cr=({mountPoint:e,boundariesElement:t,scrollableElement:i,editorView:o,isOpen:n,pluginConfig:r,editorAnalyticsAPI:l,getEditorContainerWidth:s,getEditorFeatureFlags:d,isCellMenuOpenByKeyboard:c,isCommentEditor:p,isDragMenuOpen:h,api:m})=>{if((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)&&!o)return null;let{targetCellPosition:f,isDragAndDropEnabled:g}=tg(o.state);if(!n||!f||o.state.doc.nodeSize<=f)return null;let{selection:b}=o.state,E=(0,a("BW42l").isSelectionType)(b,"cell")?(0,a("iP1et").getSelectionRect)(b):(0,a("id9O1").findCellRectClosestToPos)(b.$from);if(!E)return null;let T=o.domAtPos.bind(o),C=(0,u.findDomRefAtPos)(f,T);if(!C)return null;let _=C.parentElement&&C.parentElement.className.indexOf("sticky")>-1;return(0,a("9K4OG").jsx)(a("jwWgu").default,{alignX:"right",alignY:"top",target:C,mountTo:e,boundariesElement:t,scrollableElement:i,fitHeight:188,fitWidth:g?250:180,zIndex:_?a("aFUXX").akEditorFloatingDialogZIndex:a("aFUXX").akEditorFloatingOverlapPanelZIndex,forcePlacement:!0,offset:[-7,0],stick:!0},(0,a("9K4OG").jsx)("div",{css:ct(g)},(0,a("9K4OG").jsx)(ca,{editorView:o,offset:[8,-16],isOpen:n,targetCellPosition:f,allowColumnSorting:r&&r.allowColumnSorting,allowMergeCells:r.allowMergeCells,allowBackgroundColor:r.allowBackgroundColor,selectionRect:E,mountPoint:e,boundariesElement:t,editorAnalyticsAPI:l,getEditorContainerWidth:s,getEditorFeatureFlags:d,isCellMenuOpenByKeyboard:c,isCommentEditor:p,api:m,isDragMenuOpen:(0,dt.expValNoExposure)("platform_editor_lovability_user_intent","isEnabled",!1)?h:void 0})))};cr.displayName="FloatingContextualMenu",a("42omo");var cl=(0,a("gmMgo").default)(({style:e,onClick:t,onMouseEnter:i,onMouseLeave:o,removeLabel:n,intl:{formatMessage:a}})=>(0,d.jsx)("div",{className:eu.CONTROLS_DELETE_BUTTON_WRAP,style:e,onMouseEnter:i,onMouseLeave:o,children:(0,d.jsx)("button",{type:"button","aria-label":a(n,{0:1}),className:eu.CONTROLS_DELETE_BUTTON,onMouseDown:t,onMouseMove:e=>e.preventDefault(),children:(0,d.jsx)("svg",{className:eu.CONTROLS_BUTTON_ICON,children:(0,d.jsx)("path",{d:"M12.242 10.828L9.414 8l2.828-2.829a.999.999 0 1 0-1.414-1.414L8 6.587l-2.829-2.83a1 1 0 0 0-1.414 1.414l2.83 2.83-2.83 2.827a1 1 0 0 0 1.414 1.414l2.83-2.828 2.827 2.828a.999.999 0 1 0 1.414-1.414",fill:"currentColor",fillRule:"evenodd"})})})}));let cs=iG+16+6;class cd extends c.Component{shouldComponentUpdate(e,t){return this.state.selectionType!==t.selectionType||this.state.left!==t.left||this.state.top!==t.top||this.state.scrollLeft!==t.scrollLeft}componentDidMount(){this.updateWrapper()}componentDidUpdate(){this.updateWrapper()}componentWillUnmount(){this.wrapper&&this.wrapper.removeEventListener("scroll",this.onWrapperScrolled)}static getDerivedStateFromProps(e,t){let i=function(e){if(!(0,a("iYC9s").isTableSelected)(e)&&e instanceof a("7XFGZ").CellSelection){if(e.isRowSelection())return"row";if(e.isColSelection())return"column"}}(e.selection),o=e.stickyHeaders&&e.stickyHeaders.sticky,n=(0,a("iP1et").getSelectionRect)(e.selection),r=n&&0===n.top&&1===n.bottom,l=o&&r,s=e.stickyHeaders?e.stickyHeaders.top+e.stickyHeaders.padding:0;if(i)switch(i){case"column":{let t=i1(i0(e.editorView),e.editorView.state.selection);if(t)return{...t,top:o?e.stickyHeaders.top:0,position:o?"sticky":void 0,selectionType:i};return null}case"row":if(e.tableRef){let t=i8(e.tableRef),n=o?-t[0]:0,a=i6(t,e.editorView.state.selection,l?s:n);if(a)return{...a,position:l?"sticky":void 0,left:0,selectionType:i}}return null}return t.selectionType!==i?{selectionType:void 0,top:0,left:0,indexes:[]}:null}render(){let{mountPoint:e,boundariesElement:t,tableRef:i}=this.props,{selectionType:o}=this.state;if(!o||!i)return null;let n=(0,a("4vlwG").closestElement)(i,`.${eu.TABLE_CONTAINER}`),r=(0,d.jsx)(cl,{removeLabel:"column"===o?a("2CQVV").messages.removeColumns:a("2CQVV").messages.removeRows,onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),l=function({left:e,top:t,selectionType:i,tableWrapper:o}){switch(i){case"column":return{alignX:"left",alignY:"start",offset:[e,cs],shouldRenderPopup(){if(o){let t=o.getBoundingClientRect().width+o.scrollLeft-16,i=o.scrollLeft;return t-e>0&&e>i}return!0}};case"row":return{alignX:"left",alignY:"start",forcePlacement:!0,offset:[0,-t],onPositionCalculated:e=>({...e,left:-cs})};default:return{}}}({left:this.state.left,top:this.state.top,selectionType:this.state.selectionType,tableWrapper:this.wrapper}),s=n||e;if("sticky"===this.state.position&&s){let e=i.querySelector("tr.sticky");if(e){let t=e.getBoundingClientRect(),i=(l.onPositionCalculated||(e=>e))({left:this.state.left,top:this.state.top});return(0,r0.createPortal)((0,d.jsx)("div",{style:{position:"fixed",top:i.top,zIndex:iq,left:t.left+(i.left||0)-("column"===this.state.selectionType?this.state.scrollLeft:0)-(this.props.isNumberColumnEnabled?a("aFUXX").akEditorTableNumberColumnWidth:0)},children:r}),s)}}return(0,d.jsx)(a("jwWgu").default,{target:i,mountTo:s,boundariesElement:n||t,scrollableElement:this.wrapper||void 0,forcePlacement:!0,allowOutOfBounds:!0,...l,children:r})}constructor(e){super(e),this.wrapper=null,this.updateWrapper=()=>{let e=(0,a("4vlwG").closestElement)(this.props.tableRef,`.${eu.TABLE_NODE_WRAPPER}`);e?(this.wrapper=e,this.wrapper.addEventListener("scroll",this.onWrapperScrolled),this.setState({scrollLeft:e.scrollLeft})):(this.wrapper&&(this.wrapper.removeEventListener("scroll",this.onWrapperScrolled),this.setState({scrollLeft:0})),this.wrapper=null)},this.onWrapperScrolled=e=>{let t=e.target;this.setState({scrollLeft:t.scrollLeft})},this.handleMouseEnter=()=>{let{state:e,dispatch:t}=this.props.editorView;switch(this.state.selectionType){case"row":return nG(this.state.indexes,!0)(e,t,this.props.editorView);case"column":return nV(this.state.indexes,!0)(e,t,this.props.editorView)}return!1},this.handleMouseLeave=()=>{let{state:e,dispatch:t}=this.props.editorView;return nK()(e,t)},this.handleClick=e=>{e.preventDefault();let{editorAnalyticsAPI:t}=this.props,{state:i,dispatch:o}=this.props.editorView,{pluginConfig:{isHeaderRowRequired:n}}=tg(i),r=(0,a("iP1et").getSelectionRect)(i.selection);if(r)switch(this.state.selectionType){case"column":aP(t,this.props.api)(a("d925B").INPUT_METHOD.BUTTON,r)(i,o,this.props.editorView);return;case"row":aD(t)(a("d925B").INPUT_METHOD.BUTTON,r,!!n)(i,o);return}({state:i,dispatch:o}=this.props.editorView),nK()(i,o)},this.state={selectionType:void 0,top:0,left:0,indexes:[],scrollLeft:0}}}cd.displayName="FloatingDeleteButton",a("42omo");let cc=(0,a("efG2U").default)(e=>{let i=t(c).useContext(a("efG2U").OutsideClickTargetRefContext);return(0,d.jsx)(a("9CaSN").default,{onDroplistRef:i,...e})}),cp=({items:e,section:t,disableKeyboardHandling:i,onItemActivated:o,handleClose:n,onMouseEnter:r,onMouseLeave:l,fitWidth:s,fitHeight:p,direction:u,mountPoint:h,boundariesElement:m,scrollableElement:f})=>{let[g,b]=(0,c.useState)(["bottom","left"]),[E,T]=(0,c.useState)(null),C="row"===u?"bottom"===g[0]?-8:-34:0,_="column"===u?"left"===g[1]?0:-7:0,S=(0,c.useCallback)(()=>n("handle"),[n]),w=(0,c.useCallback)(t=>{let i=e.flatMap(e=>"items"in e?e.items:e),n=["row_numbers","header_row","header_column"],a=0,r=i.findIndex(e=>{let t=e.key;return void 0!==t&&n.includes(t)});if(-1===r||t<=r){o&&o({item:i[t]});return}for(let e=r;e<i.length;e+=1){let l=i[e].key;if(void 0!==l&&n.includes(l)&&(a+=1),r%2==0&&t-a===e||r%2==1&&t-a===e){o&&o({item:i[e]});return}}},[e,o]);return(0,d.jsxs)("div",{className:"drag-dropdown-menu-wrapper",children:[(0,d.jsx)("div",{className:"drag-dropdown-menu-popup-ref",ref:e=>{T(e)}}),(0,d.jsx)(a("jwWgu").default,{target:E,mountTo:h,boundariesElement:m,scrollableElement:f,onPlacementChanged:e=>{b(e)},fitHeight:p,fitWidth:s,zIndex:a("aFUXX").akEditorFloatingPanelZIndex,offset:[_,C],allowOutOfBounds:!0,children:(0,d.jsx)(a("9Z3I5").ArrowKeyNavigationProvider,{closeOnTab:!i,type:a("5v8Ta").ArrowKeyNavigationType.MENU,handleClose:S,onSelection:w,disableArrowKeyNavigation:i,children:(0,d.jsxs)(cc,{isOpen:!0,shouldFitContainer:!0,position:g.join(" "),handleClickOutside:()=>n("editor"),handleEscapeKeydown:()=>{i||n("handle")},handleEnterKeydown:e=>{i||(e.preventDefault(),e.stopPropagation())},targetRef:E,children:[(0,d.jsx)("div",{style:{height:0,minWidth:250}}),(0,d.jsx)(a("2SlZp").default,{role:"menu",children:e.map((e,i)=>(0,d.jsx)(a("7rvPL").default,{hasSeparator:t?.hasSeparator&&i>0,title:t?.title,children:e.items.map(e=>(0,d.jsx)(d7.DropdownMenuItem,{shouldUseDefaultRole:!1,item:e,onItemActivated:o,onMouseEnter:r,onMouseLeave:l},e.key??String(e.content)))},i))})]})})})]})},cu=e=>(0,a("9K4OG").css)({"&::before":{background:e}}),ch=()=>(0,a("9K4OG").css)(".",eu.DRAG_SUBMENU,"{border-radius:var(--ds-radius-small, 3px);background:var(--ds-surface-overlay, white);box-shadow:",`var(--ds-shadow-overlay, 0 4px 8px -2px ${a("6fnsQ").N60A}, 0 0 1px ${a("6fnsQ").N60A})`,";display:block;position:absolute;top:",102,"px;left:",250,"px;padding:var(--ds-space-100, 8px);>div{padding:0;}}.",eu.DRAG_SUBMENU_ICON,"{display:flex;&::before{content:'';display:block;border:1px solid ",a("63Ztt").tableBackgroundBorderColor,";border-radius:var(--ds-radius-small, 3px);width:14px;height:14px;}&::after{content:'';margin-left:var(--ds-space-050, 4px);line-height:14px;color:",`var(--ds-icon, ${a("6fnsQ").N90})`,";}}"),cm={name:"16vi1vz",styles:"display:flex;input[type='checkbox']{width:30px;height:14px;pointer-events:initial;cursor:pointer;}> label{margin:0px;pointer-events:none;> span{pointer-events:none;}}"},cf={add_row_above:{message:a("2CQVV").messages.addRowAbove,plural:null},add_row_below:{message:a("2CQVV").messages.addRowBelow,plural:null},add_column_left:{message:a("2CQVV").messages.addColumnLeft,plural:null},add_column_right:{message:a("2CQVV").messages.addColumnRight,plural:null},distribute_columns:{message:a("2CQVV").messages.distributeColumns,plural:"noOfCols"},clear_cells:{message:a("2CQVV").messages.clearCells,plural:"noOfCells"},delete_row:{message:a("2CQVV").messages.removeRows,plural:"noOfRows"},delete_column:{message:a("2CQVV").messages.removeColumns,plural:"noOfCols"},move_column_left:{message:a("2CQVV").messages.moveColumnLeft,plural:"noOfCols"},move_column_right:{message:a("2CQVV").messages.moveColumnRight,plural:"noOfCols"},move_row_up:{message:a("2CQVV").messages.moveRowUp,plural:"noOfRows"},move_row_down:{message:a("2CQVV").messages.moveRowDown,plural:"noOfRows"},sort_column_asc:{message:a("2CQVV").messages.sortColumnIncreasing,plural:null},sort_column_desc:{message:a("2CQVV").messages.sortColumnDecreasing,plural:null}},cg=()=>{let e=[["add_row_above","add_row_below","add_column_left","add_column_right","distribute_columns","clear_cells","delete_row","delete_column"],["move_column_left","move_column_right","move_row_up","move_row_down"]];return e.unshift(["sort_column_asc","sort_column_desc"]),e},cb=(0,a("ecnYn").xcss)({marginRight:"space.negative.075",display:"flex"}),cE=(e,t,i)=>{let o=cg(),n=[...Array(o.length)].map(()=>[]),r={};return e.forEach(e=>{let l=o.findIndex(t=>t.includes(e.id));if(-1===l)return;let s=!!cf[e.id]?.plural,d=0;if(s&&i){let{top:t,bottom:o,right:n,left:a}=i;switch(cf[e.id].plural){case"noOfCols":d=n-a;break;case"noOfRows":d=o-t;break;case"noOfCells":d=Math.max(n-a,o-t)}}let c=s?{0:d}:void 0;n[l].push({key:e.id,content:t(cf[e.id].message,c),value:{name:e.id},isDisabled:e.disabled,elemBefore:e.icon?(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:cb},(0,a("9K4OG").jsx)(e.icon,{color:"currentColor",spacing:"spacious",label:t(cf[e.id].message,c)})):void 0,elemAfter:e.keymap?(0,a("9K4OG").jsx)("div",{css:a("6f5RK").shortcutStyle},e.keymap):void 0}),e.onClick&&(r[e.id]=e.onClick)}),{menuItems:n.reduce((e,t)=>(t?.length>0&&e.push({items:t}),e),[]),menuCallback:r}},cT=t(c).memo(({direction:e="row",index:i,target:o,isOpen:n,editorView:r,tableNode:l,targetCellPosition:s,getEditorContainerWidth:d,api:p,editorAnalyticsAPI:u,pluginConfig:h,intl:{formatMessage:m},fitHeight:f,fitWidth:g,mountPoint:b,scrollableElement:E,boundariesElement:T,isTableScalingEnabled:C,shouldUseIncreasedScalingPercent:_,isTableFixedColumnWidthsOptionEnabled:S,ariaNotifyPlugin:w,isCommentEditor:v})=>{let{state:O,dispatch:y}=r,{selection:R}=O,x=l?a("LmqWp").TableMap.get(l):void 0,[A,I]=(0,c.useState)(!1),{isKeyboardModeActive:L}=nN(O),k=(0,a("BW42l").isSelectionType)(R,"cell")?(0,a("iP1et").getSelectionRect)(R):(0,a("id9O1").findCellRectClosestToPos)(R.$from),M=x?.hasMergedCells()??!1,D=h?.allowBackgroundColor??!1,{menuItems:P,menuCallback:B}=cE(rs(e,d,M,r,p,x,i,s,k,u,h?.isHeaderRowRequired,C,S,_,w,v),m,k),W=!!p?.toolbar,U=e=>{let t=r.dom,i=(0,a("4vlwG").closestElement)(t,".fabric-editor-popup-scroll-parent")||(0,a("4vlwG").closestElement)(t,".ak-editor-content-area");if(!(i&&e))return;let o=i.getBoundingClientRect(),n=e.getBoundingClientRect();if(b)return;let l=e?.offsetParent;if(!l)return;let s=l.getBoundingClientRect(),d=s.right+n.width-o.right,c=o.left-(s.left-n.width);d>c&&(e.style.left=`-${n.width}px`),c>0&&d>0&&(d<c?e.style.left=`${s.width-d}px`:e.style.left=`-${n.width-c}px`)},H=e=>{let{state:t,dispatch:i}=r;aA(u)(a("d925B").INPUT_METHOD.CONTEXT_MENU,e)(t,i),K(),I(!1)},F=()=>{az(u)(O,y)},z=()=>{aF(u)(O,y)},V=()=>{aV(u)(O,y)},G=()=>({key:"row_numbers",content:m(a("2CQVV").messages.rowNumbers),value:{name:"row_numbers"},elemAfter:(0,a("9K4OG").jsx)("div",{css:cm},(0,a("9K4OG").jsx)(a("82gXq").default,{id:"toggle-row-numbers",label:(0,N.expValEquals)("platform_editor_enghealth_table_plugin_lable_rule","isEnabled",!0)?m(a("2CQVV").messages.numberedColumn):void 0,onChange:V,isChecked:e3(R)}))}),j=t=>{let{isDragMenuOpen:o,dragMenuDirection:n,dragMenuIndex:a}=nN(t);return(!0!==o||n===e)&&(!0!==o||n!==e||a===i)},K=(t="handle")=>{let{state:n,dispatch:a}=r;j(n)&&(o&&"handle"===t?o?.focus():r.dom.focus(),nk(!1,e,i)(n,a))};if((0,c.useEffect)(()=>{if(n&&o&&L){let e=new KeyboardEvent("keydown",{key:"ArrowDown",bubbles:!0});o.dispatchEvent(e)}},[n,o,L]),!P)return null;D&&P[1].items.unshift((()=>{let{targetCellPosition:e}=tg(r.state),i=e?O.doc.nodeAt(e):null,n=(0,a("6icEc").hexToEditorBackgroundPaletteColor)(i?.attrs?.background||"#ffffff"),{selectedRowIndex:l,selectedColumnIndex:s}=(0,a("ahQKW").getSelectedRowAndColumnFromPalette)(nP,n,7);return{key:"background",content:m(a("2CQVV").messages.backgroundColor),value:{name:"background"},elemBefore:(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:cb},(0,a("9K4OG").jsx)(t(a("7TXtV")),{color:"currentColor",spacing:"spacious",label:m(a("2CQVV").messages.backgroundColor)})),elemAfter:(0,a("9K4OG").jsx)("div",{className:a("lwMQJ").DropdownMenuSharedCssClassName.SUBMENU,css:ch()},(0,a("9K4OG").jsx)("div",{css:cu(n),className:eu.DRAG_SUBMENU_ICON}),A&&(0,a("9K4OG").jsx)("div",{className:eu.DRAG_SUBMENU,ref:U},(0,a("9K4OG").jsx)(a("9Z3I5").ArrowKeyNavigationProvider,{type:a("5v8Ta").ArrowKeyNavigationType.COLOR,selectedRowIndex:l,selectedColumnIndex:s,handleClose:()=>{let e=new KeyboardEvent("keydown",{key:"ArrowDown",bubbles:!0});I(!1),o?.focus(),o?.dispatchEvent(e)},isPopupPositioned:!0,isOpenedByKeyboard:L},(0,a("9K4OG").jsx)(a("hxEux").default,{cols:7,onClick:e=>{H(e)},selectedColor:n,paletteOptions:{palette:nP,paletteColorTooltipMessages:a("8LFdJ").backgroundPaletteTooltipMessages,hexToPaletteColor:a("6icEc").hexToEditorBackgroundPaletteColor}}))))}})()),0===i&&P.push({items:["column"===e?{key:"header_column",content:m(a("2CQVV").messages.headerColumn),value:{name:"header_column"},elemAfter:(0,a("9K4OG").jsx)("div",{css:cm},(0,a("9K4OG").jsx)(a("82gXq").default,{id:"toggle-header-column",label:(0,N.expValEquals)("platform_editor_enghealth_table_plugin_lable_rule","isEnabled",!0)?m(a("2CQVV").messages.headerColumn):void 0,onChange:F,isChecked:e4(R)}))}:{key:"header_row",content:m(a("2CQVV").messages.headerRow),value:{name:"header_row"},elemAfter:(0,a("9K4OG").jsx)("div",{css:cm},(0,a("9K4OG").jsx)(a("82gXq").default,{id:"toggle-header-row",label:(0,N.expValEquals)("platform_editor_enghealth_table_plugin_lable_rule","isEnabled",!0)?m(a("2CQVV").messages.headerRow):void 0,onChange:z,isChecked:e5(R)}))}]}),"row"===e&&(0===i?P[P.length-1].items.push(G()):P.push({items:[G()]}));let $=(0,a("9K4OG").jsx)(cp,{disableKeyboardHandling:A,section:{hasSeparator:!0},items:P,onItemActivated:({item:e})=>{switch(B[e.value.name]?.(O,y),e.value.name){case"background":I(!A);break;case"header_column":F();break;case"header_row":z();break;case"row_numbers":V()}-1>=["header_column","header_row","row_numbers","background"].indexOf(e.value.name)&&K("editor")},onMouseEnter:({item:e})=>{k&&("background"!==e.value.name||A||I(!0),e.value.name?.startsWith("delete")&&("delete_column"===e.value.name?nV(ar(k),!0):nG(al(k),!0))(O,y))},onMouseLeave:({item:e})=>{"background"===e.value.name&&A&&I(!1),["sort_column_asc","sort_column_desc","delete_column","delete_row"].indexOf(e.value.name)>-1&&nK()(O,y)},handleClose:K,fitHeight:f,fitWidth:g,direction:e,boundariesElement:T,scrollableElement:E});return W||(0,N.expValEquals)("platform_editor_lovability_user_intent","isEnabled",!0)?(0,a("9K4OG").jsx)(a("1eLzC").UserIntentPopupWrapper,{api:p,userIntent:(0,lT.expValEqualsNoExposure)("platform_editor_lovability_user_intent","isEnabled",!0)?"tableDragMenuPopupOpen":void 0},$):$});var cC=(0,a("gmMgo").default)(cT);let c_=({mountPoint:e,boundariesElement:t,scrollableElement:i,editorView:o,isOpen:n,tableNode:r,direction:l,index:s,targetCellPosition:c,getEditorContainerWidth:p,editorAnalyticsAPI:u,stickyHeaders:h,pluginConfig:m,isTableScalingEnabled:f,getEditorFeatureFlags:g,ariaNotifyPlugin:b,api:E,isCommentEditor:T})=>{if(!n||!c||o.state.doc.nodeSize<=c)return null;let C=h?.sticky,_="row"===l?document.querySelector("#drag-handle-button-row"):document.querySelector("#drag-handle-button-column");if(!_||!(o.state.selection instanceof a("7XFGZ").CellSelection))return null;let{tableWithFixedColumnWidthsOption:S=!1}=g?.()??{},w=f&&(S||T);return(0,d.jsx)(a("jwWgu").default,{alignX:"row"===l?"right":void 0,alignY:"row"===l?"start":void 0,target:_,mountTo:e,boundariesElement:t,scrollableElement:i,fitWidth:250,fitHeight:188,zIndex:C?a("aFUXX").akEditorFloatingDialogZIndex:a("aFUXX").akEditorFloatingOverlapPanelZIndex,forcePlacement:!0,offset:"row"===l?[-9,0]:[0,-7],stick:!0,children:(0,d.jsx)(cC,{editorView:o,isOpen:n,tableNode:r,direction:l,index:s,target:_||void 0,targetCellPosition:c,getEditorContainerWidth:p,editorAnalyticsAPI:u,pluginConfig:m,fitWidth:250,fitHeight:188,mountPoint:e,boundariesElement:t,scrollableElement:i,isTableScalingEnabled:f,shouldUseIncreasedScalingPercent:w,isTableFixedColumnWidthsOptionEnabled:S,ariaNotifyPlugin:b,api:E,isCommentEditor:T||!1})})};c_.displayName="FloatingDragMenu";let cS=-10+a("aFUXX").akEditorTableNumberColumnWidth,cw=iG+3,cv=-(iG+3+20);var cO=function(e,t,i,o,n){switch(e){case"column":let a={alignX:"end",alignY:"top",offset:[-10,o?3:cw],onPositionCalculated(e){let{left:o}=e;if(!o)return e;if(0===t)return{...e,left:i?cS:-10};let a=n?n.getBoundingClientRect():null;return{...e,left:a&&o>a.width?a.width:o}}};return 0===t?{...a,alignX:"left",alignY:"top"}:a;case"row":let r;return r={alignX:"left",alignY:"bottom",offset:[0,10]},0===t&&(r={...r,alignY:"top",offset:[0,-10]}),{...r,onPositionCalculated:e=>({...e,left:o?-18:cv})};default:return{}}};a("42omo");let cy=(e,t,i)=>{let o=t?e.getBoundingClientRect().top-a("1zav4").tableMarginTop*(i?3:4)-3:iG+3;return e.offsetHeight+o},cN=e=>{let t=(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_CONTAINER}`);return t&&t.querySelector(`.${eu.NUMBERED_COLUMN}`)?iG+a("aFUXX").akEditorTableNumberColumnWidth-1:iG},cR=(e,t)=>{let i=(0,a("4vlwG").closestElement)(e,`.${eu.TABLE_CONTAINER}`);return i&&t&&i.querySelector(`.${eu.NUMBERED_COLUMN}`)?a("aFUXX").akEditorTableNumberColumnWidth-1:0},cx=(e,t,i)=>{let{parentElement:o,offsetWidth:n}=e,a=o.offsetWidth,{scrollLeft:r}=o,l=t?0:cN(e);return Math.min(n+l,a+l-Math.max(r-(n-a),0))+(t?i?14:6:4)+cR(e,t)},cA=e=>"row"===e?a("2CQVV").messages.insertRow:a("2CQVV").messages.insertColumn,cI=(0,a("gmMgo").default)(({onMouseDown:e,tableRef:i,type:o,intl:{formatMessage:n},hasStickyHeaders:r,isChromelessEditor:l})=>{let s="row"===o,c=(0,d.jsx)(a("3gadb").default,{content:(0,d.jsx)(a("hgeg8").ToolTipContent,{description:n(s?a("2CQVV").messages.insertRowDrag:a("2CQVV").messages.insertColumnDrag),keymap:s?a("hgeg8").addRowAfter:a("hgeg8").addColumnAfter}),position:"top",children:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:t(rw)(eu.DRAG_CONTROLS_INSERT_BUTTON_INNER,{[eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW]:s&&!l,[eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_COLUMN]:!s,[eu.DRAG_CONTROLS_INSERT_BUTTON_INNER_ROW_CHROMELESS]:s&&l}),children:(0,d.jsx)("button",{type:"button",className:eu.DRAG_CONTROLS_INSERT_BUTTON,onMouseDown:e,children:(0,d.jsx)("svg",{className:eu.CONTROLS_BUTTON_ICON,width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,d.jsx)("path",{d:"M8 4C7.44771 4 7 4.44771 7 5V7H5C4.44771 7 4 7.44771 4 8C4 8.55229 4.44771 9 5 9H7V11C7 11.5523 7.44771 12 8 12C8.55229 12 9 11.5523 9 11V9H11C11.5523 9 12 8.55229 12 8C12 7.44771 11.5523 7 11 7H9V5C9 4.44771 8.55229 4 8 4Z",fill:"currentColor"})})})}),(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_LINE,style:"row"===o?{width:cx(i,!0,l),left:"var(--ds-space-150, 12px)"}:{height:cy(i,r,!0)-8,top:"-3px"}})]})}),p=s?eu.CONTROLS_FLOATING_BUTTON_ROW:eu.CONTROLS_FLOATING_BUTTON_COLUMN;return(0,d.jsx)("div",{className:p,children:(0,d.jsx)("div",{className:`${eu.DRAG_CONTROLS_INSERT_BUTTON_WRAP} ${eu.CONTROLS_INSERT_ROW}`,children:c})})});var cL=(0,a("gmMgo").default)(({onMouseDown:e,tableRef:t,type:i,intl:{formatMessage:o},hasStickyHeaders:n})=>{let r=(0,d.jsx)(a("3gadb").default,{content:(0,d.jsx)(a("hgeg8").ToolTipContent,{description:o(cA(i)),keymap:"row"===i?a("hgeg8").addRowAfter:a("hgeg8").addColumnAfter}),position:"top",children:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_BUTTON_INNER,children:(0,d.jsx)("button",{type:"button",className:eu.CONTROLS_INSERT_BUTTON,onMouseDown:e,"aria-label":(0,N.expValEquals)("platform_editor_fix_button_name_violation_in_table","isEnabled",!0)?o(cA(i)):void 0,children:(0,d.jsx)("svg",{className:eu.CONTROLS_BUTTON_ICON,children:(0,d.jsx)("path",{d:"M10 4a1 1 0 0 1 1 1v4h4a1 1 0 0 1 0 2h-4v4a1 1 0 0 1-2 0v-4H5a1 1 0 1 1 0-2h4V5a1 1 0 0 1 1-1z",fill:"currentColor",fillRule:"evenodd"})})})}),(0,d.jsx)("div",{className:eu.CONTROLS_INSERT_LINE,style:"row"===i?{width:cx(t)}:{height:cy(t,n)}})]})}),l="column"===i?eu.CONTROLS_FLOATING_BUTTON_COLUMN:eu.CONTROLS_FLOATING_BUTTON_ROW;return(0,d.jsx)("div",{className:l,children:(0,d.jsx)("div",{className:`${eu.CONTROLS_INSERT_BUTTON_WRAP} ${eu.CONTROLS_INSERT_ROW}`,children:r})})});class ck extends t(c).Component{render(){let e,{tableNode:t,editorView:i,insertColumnButtonIndex:o,insertRowButtonIndex:n,tableRef:r,mountPoint:l,boundariesElement:s,isHeaderColumnEnabled:c,isHeaderRowEnabled:p,isDragAndDropEnabled:h,dispatchAnalyticsEvent:m,isChromelessEditor:f}=this.props;if(h&&(0===o||0===n))return null;let g=void 0!==o?"column":void 0!==n?"row":null;if(!t||!r||!g||"column"===g&&c&&0===o||"row"===g&&p&&0===n)return null;let{state:{tr:b}}=i;if(b.selection instanceof a("7XFGZ").CellSelection&&(b.selection.isColSelection()||b.selection.isRowSelection()))return null;let E=(0,a("id9O1").findTable)(b.selection);if(!E)return null;let T=this.getCellPosition(g,E?.node);if(!T)return null;let C=i.domAtPos.bind(i),_=T+E.start+1;try{e=(0,u.findDomRefAtPos)(_,C)}catch(e){console.warn(e),m&&m({action:a("d925B").ACTION.ERRORED,actionSubject:a("d925B").ACTION_SUBJECT.CONTENT_COMPONENT,eventType:a("d925B").EVENT_TYPE.OPERATIONAL,attributes:{component:a("d925B").CONTENT_COMPONENT.FLOATING_INSERT_BUTTON,selection:i.state.selection.toJSON(),position:_,docSize:i.state.doc.nodeSize,error:e?.toString()}})}if(!e||!(e instanceof HTMLElement))return null;let S="row"===g?(0,a("4vlwG").closestElement)(e,"tr"):(0,a("4vlwG").closestElement)(e,"td, th");if(!S)return null;let w=(0,a("4vlwG").closestElement)(S,`.${eu.TABLE_CONTAINER}`),v=(0,a("4vlwG").closestElement)(S,`.${eu.TABLE_NODE_WRAPPER}`),O="column"===g?o:n,y=e3(i.state.selection),R=(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")||"column"===g?a("aFUXX").akEditorTableCellOnStickyHeaderZIndex:void 0;return(0,d.jsx)(a("jwWgu").default,{target:S,mountTo:w||l,boundariesElement:w||s,scrollableElement:v,forcePlacement:!0,allowOutOfBounds:!0,...cO(g,O,y,!!h,w),zIndex:R,children:h?(0,d.jsx)(cI,{type:g,tableRef:r,onMouseDown:"column"===g?this.insertColumn:this.insertRow,hasStickyHeaders:this.props.hasStickyHeaders||!1,isChromelessEditor:f}):(0,d.jsx)(cL,{type:g,tableRef:r,onMouseDown:"column"===g?this.insertColumn:this.insertRow,hasStickyHeaders:this.props.hasStickyHeaders||!1})})}getCellPosition(e,t){let{insertColumnButtonIndex:i,insertRowButtonIndex:o}=this.props,n=a("LmqWp").TableMap.get(t);if("column"===e){if(void 0===i)return null;let e=0===i?0:i-1;return e>n.width-1?null:n.positionAt(0,e,t)}{if(void 0===o)return null;let e=0===o?0:o-1;return e>n.height-1?null:n.positionAt(e,0,t)}}insertRow(e){let{editorView:t,insertRowButtonIndex:i,editorAnalyticsAPI:o}=this.props;if(void 0!==i){e.preventDefault();let{state:n,dispatch:r}=t;aL(o)(a("d925B").INPUT_METHOD.BUTTON,{index:i,moveCursorToInsertedRow:!0})(n,r)}}insertColumn(e){let{editorView:t,insertColumnButtonIndex:i,editorAnalyticsAPI:o,getEditorFeatureFlags:n,isTableScalingEnabled:r,isCommentEditor:l}=this.props;if(void 0!==i){e.preventDefault();let{tableWithFixedColumnWidthsOption:s=!1}=n?n():{},d=r&&(s||l),{state:c,dispatch:p}=t;aM(this.props.api,o,r,s,d,l)(a("d925B").INPUT_METHOD.BUTTON,i)(c,p,t)}}constructor(e){super(e),this.insertColumn=this.insertColumn.bind(this),this.insertRow=this.insertRow.bind(this)}}ck.displayName="FloatingInsertButton";var cM=(0,a("gmMgo").default)(ck);let cD=t(c).memo(e=>{let{target:t,content:i,alignX:o,alignY:n,zIndex:r,forcePlacement:l,stick:s,offset:c}=e;return(0,d.jsx)(a("jwWgu").default,{target:t,alignX:o,alignY:n,zIndex:r,stick:s,forcePlacement:l,offset:c,children:i})}),cP=({featureFlags:e,isDragAndDropEnabledOption:t,api:i})=>{let{mode:o}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(i,["editorViewMode"],e=>({mode:e.editorViewModeState?.mode}));return(0,a("9K4OG").jsx)(a("9K4OG").Global,{styles:dQ({featureFlags:e,isDragAndDropEnabled:t&&"view"!==o})})},cB=({api:e,target:t,popupsMountPoint:i,popupsBoundariesElement:o,popupsScrollableElement:n})=>{let r=(0,c.useCallback)(()=>{e?.core.actions.execute(({tr:e})=>(e.setMeta(sq,{isSelectorOpen:!1}),e))},[e]),l=(0,c.useCallback)((t,i)=>{e?.core.actions.execute(({tr:o})=>(e?.table.commands.insertTableWithSize(t,i)({tr:o}),o.setMeta(sq,{isSelectorOpen:!1}),o))},[e]);return(0,a("9K4OG").jsx)(a("hMaMb").default,{defaultSize:{row:3,col:3},target:t,onUnmount:()=>{e?.core.actions.focus()},onSelection:l,popupsMountPoint:i,popupsScrollableElement:n,popupsBoundariesElement:o,isOpenedByKeyboard:!0,handleClickOutside:r,handleEscapeKeydown:r})};a("42omo");let cW=(0,a("ecnYn").xcss)({height:"var(--ds-space-400, 32px)",display:"flex",backgroundColor:"elevation.surface.overlay",borderRadius:"radius.small",boxShadow:"elevation.shadow.overlay",lineHeight:1,boxSizing:"border-box",alignItems:"center"}),cU=(0,a("ecnYn").xcss)({marginLeft:"space.100",marginRight:"space.100",paddingLeft:"space.075",paddingRight:"space.075",paddingTop:"space.050",paddingBottom:"space.050"}),cH=()=>{let{formatMessage:e}=(0,a("8C5kA").default)();return(0,d.jsx)(a("6f0Oj").default,{xcss:cW,children:(0,d.jsx)(a("dcJ7R").default,{xcss:cU,children:e(a("2CQVV").messages.fullWidthLabel)})})},cF=e=>({resizingTableLocalId:e.tableState?.resizingTableLocalId,resizingTableRef:e.tableState?.resizingTableRef,isTableResizing:e.tableState?.isTableResizing,isResizing:e.tableState?.isResizing,widthToWidest:e.tableState?.widthToWidest,tableNode:e.tableState?.tableNode,targetCellPosition:e.tableState?.targetCellPosition,isContextualMenuOpen:e.tableState?.isContextualMenuOpen,tableRef:e.tableState?.tableRef,pluginConfig:e.tableState?.pluginConfig,insertColumnButtonIndex:e.tableState?.insertColumnButtonIndex,insertRowButtonIndex:e.tableState?.insertRowButtonIndex,isHeaderColumnEnabled:e.tableState?.isHeaderColumnEnabled,isHeaderRowEnabled:e.tableState?.isHeaderRowEnabled,isDragAndDropEnabled:e.tableState?.isDragAndDropEnabled,tableWrapperTarget:e.tableState?.tableWrapperTarget,isCellMenuOpenByKeyboard:e.tableState?.isCellMenuOpenByKeyboard,stickyHeader:e.tableState?.stickyHeader,dragMenuDirection:e.tableState?.dragMenuDirection,dragMenuIndex:e.tableState?.dragMenuIndex,isDragMenuOpen:e.tableState?.isDragMenuOpen,isSizeSelectorOpen:e.tableState?.isSizeSelectorOpen,sizeSelectorTargetRef:e.tableState?.sizeSelectorTargetRef,hoveredRows:e.tableState?.hoveredRows,hoveredColumns:e.tableState?.hoveredColumns,hoveredCell:e.tableState?.hoveredCell}),cz=({api:e,editorView:t,dispatchAnalyticsEvent:i,options:o,popupsMountPoint:n,popupsBoundariesElement:r,popupsScrollableElement:l,isTableSelectorEnabled:s,defaultGetEditorContainerWidth:c,defaultGetEditorFeatureFlags:p})=>{let u=e?.analytics?.actions,h=e?.accessibilityUtils?.actions.ariaNotify,{resizingTableLocalId:m,resizingTableRef:f,isTableResizing:b,isResizing:E,widthToWidest:T,tableNode:C,targetCellPosition:_,isContextualMenuOpen:S,tableRef:w,pluginConfig:v,insertColumnButtonIndex:O,insertRowButtonIndex:y,isHeaderColumnEnabled:N,isHeaderRowEnabled:R,isDragAndDropEnabled:x,tableWrapperTarget:A,isCellMenuOpenByKeyboard:I,stickyHeader:L,dragMenuDirection:k,dragMenuIndex:M,isDragMenuOpen:D,isSizeSelectorOpen:P,sizeSelectorTargetRef:B}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e,["table"],cF),{allowControls:W}=v??{};return t?(0,d.jsxs)(d.Fragment,{children:[_&&(w||I)&&!E&&o&&o.allowContextualMenu&&(0,d.jsx)(d6,{isNumberColumnEnabled:C&&C.attrs.isNumberColumnEnabled,editorView:t,tableNode:C,mountPoint:n,targetCellPosition:_,scrollableElement:l,dispatchAnalyticsEvent:i,isContextualMenuOpen:S,stickyHeader:L,tableWrapper:A,isCellMenuOpenByKeyboard:I,isDragAndDropEnabled:x}),W&&(0,d.jsx)(cM,{tableNode:C,tableRef:w,insertColumnButtonIndex:O,insertRowButtonIndex:y,isHeaderColumnEnabled:N,isHeaderRowEnabled:R,isDragAndDropEnabled:x,isTableScalingEnabled:o?.isTableScalingEnabled,editorView:t,mountPoint:n,boundariesElement:r,scrollableElement:l,hasStickyHeaders:L&&L.sticky,dispatchAnalyticsEvent:i,editorAnalyticsAPI:u,getEditorContainerWidth:c,getEditorFeatureFlags:o?.getEditorFeatureFlags||p,isChromelessEditor:o?.isChromelessEditor,api:e,isCommentEditor:o?.isCommentEditor}),o?.allowContextualMenu&&(0,d.jsx)(cr,{editorView:t,mountPoint:n,boundariesElement:r,targetCellPosition:_,isOpen:!!S&&!E,pluginConfig:v,editorAnalyticsAPI:u,getEditorContainerWidth:c,getEditorFeatureFlags:o?.getEditorFeatureFlags||p,isCellMenuOpenByKeyboard:I,isCommentEditor:o?.isCommentEditor,api:e,isDragMenuOpen:x&&(0,dt.expValNoExposure)("platform_editor_lovability_user_intent","isEnabled",!1)?D:void 0}),x&&(0,d.jsx)(c_,{editorView:t,mountPoint:n,boundariesElement:r,tableRef:w,tableNode:C,targetCellPosition:_,direction:k,index:M,isOpen:!!D&&!E,getEditorContainerWidth:c,editorAnalyticsAPI:u,stickyHeaders:L,pluginConfig:v,isTableScalingEnabled:o?.isTableScalingEnabled,getEditorFeatureFlags:o?.getEditorFeatureFlags||p,ariaNotifyPlugin:h,api:e,isCommentEditor:o?.isCommentEditor}),W&&!x&&!E&&(0,d.jsx)(cd,{editorView:t,selection:t.state.selection,tableRef:w,mountPoint:n,boundariesElement:r,scrollableElement:l,stickyHeaders:L,isNumberColumnEnabled:C&&C.attrs.isNumberColumnEnabled,editorAnalyticsAPI:u,api:e}),(o?.isTableScalingEnabled||o?.tableOptions.allowTableResizing&&o.isCommentEditor)&&b&&T&&m&&f&&T[m]&&(0,d.jsx)(cD,{target:f,content:(0,g.editorExperiment)("single_column_layouts",!0)?(0,d.jsx)(a("7x0qS").ResizerBreakoutModeLabel,{layout:"full-width"}):(0,d.jsx)(cH,{}),alignX:"center",alignY:"bottom",stick:!0,forcePlacement:!0,zIndex:a("aFUXX").akEditorFloatingPanelZIndex,offset:[0,10]}),s&&P&&(0,d.jsx)(cB,{api:e,isOpenedByKeyboard:!1,popupsMountPoint:n,target:B??(0,a("kuh1P").getDomRefFromSelection)(t,a("d925B").ACTION_SUBJECT_ID.PICKER_TABLE_SIZE,e?.analytics?.actions),popupsBoundariesElement:r,popupsScrollableElement:l})]}):null},cV=({api:e,editorView:t,dispatchAnalyticsEvent:i,options:o,popupsMountPoint:n,popupsBoundariesElement:r,popupsScrollableElement:l,isTableSelectorEnabled:s,defaultGetEditorContainerWidth:c,defaultGetEditorFeatureFlags:p})=>(0,d.jsxs)(a("7fmpI").ErrorBoundary,{component:a("d925B").ACTION_SUBJECT.TABLES_PLUGIN,dispatchAnalyticsEvent:i,fallbackComponent:null,children:[(0,d.jsx)(cP,{featureFlags:e?.featureFlags?.sharedState.currentState(),isDragAndDropEnabledOption:o?.dragAndDropEnabled,api:e}),(0,d.jsx)(cz,{api:e,editorView:t,dispatchAnalyticsEvent:i,options:o,popupsMountPoint:n,popupsBoundariesElement:r,popupsScrollableElement:l,isTableSelectorEnabled:s,defaultGetEditorContainerWidth:c,defaultGetEditorFeatureFlags:p})]}),cG=()=>({});e.exports.default=({config:e,api:i})=>{let o={current:null},n=()=>i?.width?.sharedState.currentState()??{width:document?.body?.offsetWidth??500},r=i?.analytics?.actions,l=e?.getEditorFeatureFlags?.().tableWithFixedColumnWidthsOption||!1,s=e?.isTableScalingEnabled&&(l||e?.isCommentEditor),E=!e?.isChromelessEditor&&!e?.isCommentEditor&&e?.getEditorFeatureFlags?.().tableSelector&&(0,g.editorExperiment)("platform_editor_controls","variant1");return{name:"table",getSharedState:t=>{if(!t)return;let i=eh.getState(t),o=n1(t),n=em.getState(t),r=rA.getState(t),l=r?rI(r,i?.tablePos):void 0,s=nv.getState(t),d=sq.getState(t),c=rb.getState(t);return{isFullWidthModeEnabled:!!e?.fullWidthEnabled,wasFullWidthModeEnabled:!!e?.wasFullWidthEnabled,isMaxWidthModeEnabled:!!e?.maxWidthEnabled,wasMaxWidthModeEnabled:!!e?.wasMaxWidthEnabled,isHeaderRowEnabled:i.isHeaderRowEnabled,isHeaderColumnEnabled:i.isHeaderColumnEnabled,ordering:i.ordering,isResizing:!!(o?.dragging||n?.resizing),isTableResizing:n?.resizing,isInDanger:i.isInDanger,hoveredRows:i.hoveredRows,hoveredColumns:i.hoveredColumns,hoveredCell:i.hoveredCell,isTableHovered:i.isTableHovered,isWholeTableInDanger:i.isWholeTableInDanger,tableNode:i.tableNode,widthToWidest:i.widthToWidest,resizingTableLocalId:n?.tableLocalId,tableRef:i?.tableRef??void 0,resizingTableRef:n?.tableRef??void 0,tablePos:i.tablePos,targetCellPosition:i.targetCellPosition,isContextualMenuOpen:i.isContextualMenuOpen,pluginConfig:i.pluginConfig,insertColumnButtonIndex:i.insertColumnButtonIndex,insertRowButtonIndex:i.insertRowButtonIndex,isDragAndDropEnabled:i.isDragAndDropEnabled,tableWrapperTarget:i.tableWrapperTarget,isCellMenuOpenByKeyboard:i.isCellMenuOpenByKeyboard,stickyHeader:l,dragMenuDirection:s?.dragMenuDirection,dragMenuIndex:s?.dragMenuIndex,isDragMenuOpen:s?.isDragMenuOpen,isSizeSelectorOpen:d?.isSelectorOpen,sizeSelectorTargetRef:d?.targetRef,editorContentAreaHeight:(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_4")?c?.height:void 0}},actions:{insertTable:t=>(o,n)=>{if(e?.tableOptions?.allowNestedTables)return(0,a("gmyMu").editorCommandToPMCommand)(oj({isTableScalingEnabled:e?.isTableScalingEnabled,isTableAlignmentEnabled:e?.tableOptions.allowTableAlignment,isFullWidthModeEnabled:e?.fullWidthEnabled,isMaxWidthModeEnabled:e?.maxWidthEnabled,isCommentEditor:e?.isCommentEditor,isChromelessEditor:e?.isChromelessEditor,isTableResizingEnabled:e?.tableOptions.allowTableResizing},i,t))(o,n);{let a=oW({isTableScalingEnabled:e?.isTableScalingEnabled,isTableAlignmentEnabled:e?.tableOptions.allowTableAlignment,isFullWidthModeEnabled:e?.fullWidthEnabled,isMaxWidthModeEnabled:e?.maxWidthEnabled,isCommentEditor:e?.isCommentEditor,isChromelessEditor:e?.isChromelessEditor,isTableResizingEnabled:e?.tableOptions.allowTableResizing})(o.schema);return i?.contentInsertion?.actions?.insert({state:o,dispatch:n,node:a,options:{selectNodeInserted:!1,analyticsPayload:{...t,attributes:{...t.attributes,localId:a.attrs.localId}}}})??!1}}},commands:{insertTableWithSize:(t,o,n)=>oj({isTableScalingEnabled:e?.isTableScalingEnabled,isTableAlignmentEnabled:e?.tableOptions.allowTableAlignment,isFullWidthModeEnabled:e?.fullWidthEnabled,isMaxWidthModeEnabled:e?.maxWidthEnabled,isCommentEditor:e?.isCommentEditor,isChromelessEditor:e?.isChromelessEditor,isTableResizingEnabled:e?.tableOptions.allowTableResizing,createTableProps:{rowsCount:t,colsCount:o}},i,{action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.TABLE,attributes:{inputMethod:n??a("d925B").INPUT_METHOD.PICKER,totalRowCount:t,totalColumnCount:o},eventType:a("d925B").EVENT_TYPE.TRACK})},nodes(){let{allowColumnResizing:t}=oK(e?.tableOptions),i=!!e?.tableOptions?.allowNestedTables,o=e?.getEditorFeatureFlags?.().tableWithFixedColumnWidthsOption||!1,r=e?.isTableScalingEnabled&&(o||e?.isCommentEditor),l=e?.isTableScalingEnabled,s=e?.isCommentEditor,d=e?.isChromelessEditor;return i?[{name:"table",node:ea({allowColumnResizing:!!t,tableResizingEnabled:!!e?.tableOptions.allowTableResizing,getEditorContainerWidth:n,isNestingSupported:i,isTableScalingEnabled:l,shouldUseIncreasedScalingPercent:r,isCommentEditor:s,isChromelessEditor:d})},{name:"tableHeader",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableHeaderWithNestedTableWithLocalId:a("63Ztt").tableHeaderWithNestedTable},{name:"tableRow",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableRowWithNestedTableWithLocalId:a("63Ztt").tableRowWithNestedTable},{name:"tableCell",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableCellWithNestedTableWithLocalId:a("63Ztt").tableCellWithNestedTable}]:[{name:"table",node:ea({allowColumnResizing:!!t,tableResizingEnabled:!!e?.tableOptions.allowTableResizing,getEditorContainerWidth:n,isNestingSupported:i,isTableScalingEnabled:l,shouldUseIncreasedScalingPercent:r,isCommentEditor:s,isChromelessEditor:d})},{name:"tableHeader",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableHeaderWithLocalId:a("63Ztt").tableHeader},{name:"tableRow",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableRowWithLocalId:a("63Ztt").tableRow},{name:"tableCell",node:(0,a("dh538").fg)("platform_editor_adf_with_localid")?a("63Ztt").tableCellWithLocalId:a("63Ztt").tableCell}]},pmPlugins(){let d=[{name:"table",plugin:({dispatchAnalyticsEvent:t,dispatch:o,portalProviderAPI:a,nodeViewPortalProviderAPI:l,eventDispatcher:d,getIntl:c})=>{let{fullWidthEnabled:p,wasFullWidthEnabled:u,tableOptions:h,getEditorFeatureFlags:m,dragAndDropEnabled:f,isTableScalingEnabled:g,isCommentEditor:b,isChromelessEditor:E}=e||{};return sg(t,o,a,l,d,oK(h),n,m||cG,c,p,u,f,r,i,g,s,b,E)}},{name:"tablePMColResizing",plugin:({dispatch:o,nodeViewPortalProviderAPI:l})=>{let{fullWidthEnabled:s,tableOptions:d,getEditorFeatureFlags:c,isTableScalingEnabled:p}=e||{},{allowColumnResizing:u}=oK(d);return u?function(e,{lastColumnResizable:i=!0},o,n,r,l,s,d,c){return new(0,a("1S4f7").SafePlugin)({key:eY,state:n0(e,{lastColumnResizable:i,resizeHandlePos:null,dragging:null,lastClick:null}),props:{attributes(e){let i=n1(e);return{class:t(rw)({[eu.RESIZE_CURSOR]:null!==i.resizeHandlePos,[eu.IS_RESIZING]:!!i.dragging})}},handleDOMEvents:{mousedown(e,t){let{state:i}=e,a=n1(i).resizeHandlePos||on(e,t),{dragging:p}=n1(i),u=!1,{isKeyboardResize:h}=tg(i);if(h&&(u=h),null!==a&&(!p||u)&&sx(e,t,a,o,n,d||!1,r,l,s,c)){let{state:t,dispatch:i}=e;return n4(a)(t,i)}return!1}}}})}(o,{lastColumnResizable:!s},n,c||cG,i,l,r,p||!1,!!e?.isCommentEditor):void 0}},{name:"tableEditing",plugin:()=>eV()},{name:"tableKeymap",plugin:({getIntl:t,nodeViewPortalProviderAPI:o})=>{let{dragAndDropEnabled:d,isTableScalingEnabled:c=!1,fullWidthEnabled:p=!1,isCommentEditor:u=!1,isChromelessEditor:h=!1,tableOptions:m}=e||{};return function(e,t,i,o,n,r=!1,l=!1,s,d,c,p=!1,u,h,m,f){let g={},b=d?.accessibilityUtils?.actions.ariaNotify;return(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").nextCell.common,rT(o,b,c)(1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").previousCell.common,rT(o,b,c)(-1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").toggleTable.common,(0,a("gmyMu").editorCommandToPMCommand)(oj({isTableScalingEnabled:r,isTableAlignmentEnabled:l,isFullWidthModeEnabled:!!s,isCommentEditor:h,isChromelessEditor:m,isTableResizingEnabled:f},t,{action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.TABLE,attributes:{inputMethod:a("d925B").INPUT_METHOD.SHORTCUT},eventType:a("d925B").EVENT_TYPE.TRACK})),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").backspace.common,(0,a("astHL").chainCommands)(aH(o)(a("d925B").INPUT_METHOD.KEYBOARD),aN(o)(a("d925B").INPUT_METHOD.KEYBOARD)),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").backspace.common,tj,g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addRowBefore.common,aI(o)("TOP"),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addRowAfter.common,aI(o)("BOTTOM"),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addColumnBefore.common,oF(t,r,p,u),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addColumnAfter.common,oz(t,r,p,u),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addRowBeforeVO.common,aI(o)("TOP"),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addRowAfterVO.common,aI(o)("BOTTOM"),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addColumnBeforeVO.common,oF(t,r,p,u),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").addColumnAfterVO.common,oz(t,r,p,u),g),n&&((0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveRowDown.common,rp(o,b,c)("table-row",1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveRowUp.common,rp(o,b,c)("table-row",-1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveColumnLeft.common,rp(o,b,c)("table-column",-1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveColumnRight.common,rp(o,b,c)("table-column",1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").deleteColumn.common,aB(o,t,r,p,u),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").deleteRow.common,aB(o,t,r,p,u),g)),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").startColumnResizing.common,ac({ariaNotify:b,getIntl:c,nodeViewPortalProviderAPI:i}),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveRight.common,ap({direction:1,ariaNotify:b,getIntl:c,nodeViewPortalProviderAPI:i}),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveLeft.common,ap({direction:-1,ariaNotify:b,getIntl:c,nodeViewPortalProviderAPI:i}),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveDown.common,rC(1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveUp.common,rC(-1),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").decreaseMediaSize.common,ak(o,t)(-10,e,r,p,!!h,a("d925B").INPUT_METHOD.SHORTCUT,b,c),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").increaseMediaSize.common,ak(o,t)(10,e,r,p,!!h,a("d925B").INPUT_METHOD.SHORTCUT,b,c),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").escape.common,ah({ariaNotify:b,getIntl:c}),g),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").focusToContextMenuTrigger.common,t6(),g),(0,a("dus6D").keymap)(g)}(n,i,o,r,d,c,m?.allowTableAlignment,p,i,t,l,s,u,h,m?.allowTableResizing)}},{name:"tableSelectionKeymap",plugin:({getIntl:e})=>(function(e,t){let i={},o=e?.selection,n=e?.accessibilityUtils?.actions.ariaNotify;return(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveRight.common,sL(o)(),i),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").moveLeft.common,sI(o)(),i),(0,a("hgeg8").bindKeymapArrayWithCommand)(a("hgeg8").selectColumn,sD(o,n,t)(!0),i),(0,a("hgeg8").bindKeymapArrayWithCommand)(a("hgeg8").selectRow,sP(o,n,t)(!0),i),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").shiftArrowUp.common,sX(o)(),i),(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").selectTable.common,sZ(o)(),i),(0,a("dus6D").keymap)(i)})(i,e)},{name:"tableEditing",plugin:()=>{let{dragAndDropEnabled:t}=e||{};return function({allowTableNodeSelection:e=!1,dragAndDropEnabled:t=!1,reportFixedTable:i}={}){return new(0,a("ks2lK").Plugin)({key:m,state:{init:()=>null,apply(e,t){let i=e.getMeta(m);if(null!=i)return -1===i?null:i;if(null==t||!e.docChanged)return t;let{deleted:o,pos:n}=e.mapping.mapResult(t);return o?null:n}},props:{decorations:h,handleDOMEvents:{mousedown:(e,i)=>{!function(e,t,i){if(t.ctrlKey||t.metaKey||2===t.button)return;let o=v(e,t.target),n=(0,a("3gZJH").cellAround)(e.state.selection.$anchor);if(t.shiftKey&&e.state.selection instanceof a("7XFGZ").CellSelection){let o=t.target instanceof HTMLElement||t.target instanceof SVGElement?t.target:null,n=!!o&&!!o.closest("button.pm-table-drag-handle-button-container, button.pm-table-drag-handle-button-clickable-zone");if(i&&n)return;r(e.state.selection.$anchorCell,t),t.preventDefault()}else if(t.shiftKey&&o&&null!==n&&O(e,t).pos!==n.pos)r(n,t),t.preventDefault();else if(!o)return;function r(t,i){let o=O(e,i),n=null==m.getState(e.state);if(!o||!(0,a("bMyNT").inSameTable)(t,o))if(!n)return!1;else o=t;let r=new(0,a("7XFGZ").CellSelection)(t,o);if(n||!e.state.selection.eq(r)){let i=e.state.tr.setSelection(r);n&&i.setMeta(m,t.pos),e.dispatch(i)}}function l(){e.root.removeEventListener("mouseup",l),e.root.removeEventListener("dragstart",l),e.root.removeEventListener("mousemove",s),null!=m.getState(e.state)&&e.dispatch(e.state.tr.setMeta(m,-1))}function s(i){let n,a=m.getState(e.state),s=v(e,i.target),d=y(e,i),c=y(e,t);if(null!=a)n=e.state.doc.resolve(a);else if(s!==o&&d===c&&!(n=O(e,t)))return void l();n&&r(n,i)}e.root.addEventListener("mouseup",l),e.root.addEventListener("dragstart",l),e.root.addEventListener("mousemove",s)}(e,i,t)}},createSelectionBetween:e=>null!=m.getState(e.state)?e.state.selection:null,handleTripleClick:S,handleKeyDown:b,handlePaste:a("dmcsV").handlePaste},appendTransaction:(t,o,n)=>(function(e,t,i){let o,n,r=t,l=(r||e).selection,{doc:s}=r||e;l instanceof a("ks2lK").NodeSelection&&(n=l.node.type.spec.tableRole);let d=(0,g.editorExperiment)("platform_editor_element_drag_and_drop_multiselect",!0);if(l instanceof a("ks2lK").NodeSelection&&n){if("cell"===n||"header_cell"===n)o=a("7XFGZ").CellSelection.create(s,l.from);else if("row"===n){let e=s.resolve(l.from+1);o=a("7XFGZ").CellSelection.rowSelection(e,e)}else if(!i){let e=a("LmqWp").TableMap.get(l.node),t=l.from+1,i=t+e.map[e.width*e.height-1];o=a("7XFGZ").CellSelection.create(s,t+1,i)}}else l instanceof a("ks2lK").TextSelection&&function({$from:e,$to:t}){if(e.pos===t.pos||e.pos<e.pos-6)return!1;let i=e.pos,o=t.pos,{depth:n}=e;for(;n>=0&&!(e.after(n+1)<e.end(n));n--,i++);for(let e=t.depth;e>=0&&!(t.before(e+1)>t.start(e));e--,o--);return i===o&&/row|table/.test(e.node(n).type.spec.tableRole)}(l)?o=a("ks2lK").TextSelection.create(s,l.from):l instanceof a("ks2lK").TextSelection&&(d?function({$from:e,$to:t}){let i,o,n,a;for(let t=e.depth;t>0;t--){let o=e.node(t);if(("cell"===o.type.spec.tableRole||"header_cell"===o.type.spec.tableRole)&&(i=o),"table"===o.type.name){n=o;break}}for(let e=t.depth;e>0;e--){let i=t.node(e);if(("cell"===i.type.spec.tableRole||"header_cell"===i.type.spec.tableRole)&&(o=i),"table"===i.type.name){a=i;break}}return void 0!==i&&void 0!==o&&i!==o&&a===n&&0===t.parentOffset}(l):function({$from:e,$to:t}){let i,o;for(let t=e.depth;t>0;t--){let o=e.node(t);if("cell"===o.type.spec.tableRole||"header_cell"===o.type.spec.tableRole){i=o;break}}for(let e=t.depth;e>0;e--){let i=t.node(e);if("cell"===i.type.spec.tableRole||"header_cell"===i.type.spec.tableRole){o=i;break}}return i!==o&&0===t.parentOffset}(l))&&(o=a("ks2lK").TextSelection.create(s,l.$from.start(),l.$from.end()));return o&&(r||(r=e.tr)).setSelection(o),r})(n,function(e,t,i){let o,n=(t,n)=>{"table"===t.type.spec.tableRole&&(o=function(e,t,i,o,n){let r,l,s=o,d=a("LmqWp").TableMap.get(t);if(!d.problems)return s;s||(s=e.tr);let c=[];for(let e=0;e<d.height;e++)c.push(0);for(let o=0;o<d.problems.length;o++){let r=d.problems[o];if(n&&n({state:e,tr:s,reason:r.type||"unknown"}),r.type===a("LmqWp").TableProblemTypes.COLLISION){let e=t.nodeAt(r.pos);if(!e)throw Error(`fixTable: unable to find cell at pos ${r.pos}`);for(let t=0;t<e.attrs.rowspan;t++)c[r.row+t]+=r.n;s.setNodeMarkup(s.mapping.map(i+1+r.pos),void 0,(0,a("jl382").removeColSpan)(e.attrs,e.attrs.colspan-r.n,r.n))}else if(r.type===a("LmqWp").TableProblemTypes.MISSING)c[r.row]+=r.n;else if(r.type===a("LmqWp").TableProblemTypes.OVERLONG_ROWSPAN){let e=t.nodeAt(r.pos);if(!e)throw Error(`fixTable: unable to find cell at pos ${r.pos}`);s.setNodeMarkup(s.mapping.map(i+1+r.pos),void 0,{...e.attrs,rowspan:e.attrs.rowspan-r.n})}else if(r.type===a("LmqWp").TableProblemTypes.COLWIDTH_MISMATCH){let e=t.nodeAt(r.pos);if(!e)throw Error(`fixTable: unable to find cell at pos ${r.pos}`);s.setNodeMarkup(s.mapping.map(i+1+r.pos),void 0,{...e.attrs,colwidth:r.colwidth})}}for(let e=0;e<c.length;e++)c[e]&&(null==r&&(r=e),l=e);for(let o=0,n=i+1;o<d.height;o++){let i=t.child(o),d=n+i.nodeSize,p=c[o];if(p>0){let t="cell";i.firstChild&&(t=i.firstChild.type.spec.tableRole);let c=[];for(let i=0;i<p;i++)c.push((0,a("d1kIV").tableNodeTypes)(e.schema)[t].createAndFill());let u=(0===o||r===o-1)&&l===o?n+1:d-1;s.insert(s.mapping.map(u),c)}n=d}return s.setMeta(f,{fixTables:!0})}(e,t,n,o,i))};return t?t.doc!==e.doc&&function e(t,i,o,n){let a=o,r=t.childCount,l=i.childCount;e:for(let o=0,s=0;o<l;o++){let l=i.child(o);for(let e=s,i=Math.min(r,o+3);e<i;e++)if(t.child(e)===l){s=e+1,a+=l.nodeSize;continue e}n(l,a),s<r&&t.child(s).sameMarkup(l)?e(t.child(s),l,a+1,n):l.nodesBetween(0,l.content.size,n,a+1),a+=l.nodeSize}}(t.doc,e.doc,0,n):e.doc.descendants(n),o}(n,o,i),e)})}({reportFixedTable:({tr:e,reason:t})=>{r?.attachAnalyticsEvent({action:a("3824I").TABLE_ACTION.FIXED,actionSubject:a("d925B").ACTION_SUBJECT.TABLE,actionSubjectId:null,attributes:{reason:t},eventType:a("d925B").EVENT_TYPE.TRACK})(e)},dragAndDropEnabled:t})}},{name:"tableStickyHeaders",plugin:({dispatch:t})=>e&&e.tableOptions.stickyHeaders?sT(t,()=>[]):void 0},{name:"tableDragAndDrop",plugin:({dispatch:t})=>e?.dragAndDropEnabled?rg(t,r,e?.isTableScalingEnabled,l,e.isCommentEditor,i):void 0},{name:"tableViewModeSort",plugin:({nodeViewPortalProviderAPI:e})=>i?.editorViewMode?de(i,e):void 0},{name:"tableLocalId",plugin:({dispatch:e})=>(0,a("dh538").fg)("platform_editor_adf_with_localid")?void 0:sR(e)},{name:"tableWidth",plugin:({dispatchAnalyticsEvent:t,dispatch:i})=>e?.tableOptions.allowTableResizing?ef(i,t,e.fullWidthEnabled??!1,e.maxWidthEnabled??!1,e.isTableScalingEnabled??!1,e.tableOptions.allowTableResizing??!1,e.isCommentEditor??!1):void 0},{name:"tableWidthInCommentFix",plugin:({dispatch:t})=>e?.tableOptions.allowTableResizing&&e?.isCommentEditor?s0(t,e.tableOptions.allowTableAlignment??!1):void 0},{name:"tableOverflowAnalyticsPlugin",plugin:({dispatch:t,dispatchAnalyticsEvent:i})=>iT(t,i,e?.tableOptions.allowTableResizing??!1)},{name:"tableAnalyticsPlugin",plugin:({dispatch:e,dispatchAnalyticsEvent:t})=>ip(e,t)},{name:"tableGetEditorViewReferencePlugin",plugin:({dispatchAnalyticsEvent:e})=>new(0,a("1S4f7").SafePlugin)({view:t=>{let n,r,l;return o.current=t,(0,N.expValEquals)("platform_editor_editor_width_analytics","isEnabled",!0)&&(n=setTimeout(()=>{let t=()=>{let t=i?.width.sharedState.currentState()?.width;if(o.current){if(t){let i=iR(o.current,t);i&&e(i)}if((0,a("dh538").fg)("platform_editor_table_height_analytics_event")){let t=ix(o.current);t&&e(t)}}};window&&"function"==typeof window.requestIdleCallback?l=window.requestIdleCallback(t):window&&"function"==typeof window.requestAnimationFrame&&(r=window.requestAnimationFrame(t))},1e4)),{destroy:()=>{o.current=null,n&&clearTimeout(n),r&&window.cancelAnimationFrame(r),l&&window.cancelIdleCallback(l)}}}})},{name:"tableSizeSelectorPlugin",plugin:({dispatch:e})=>E?sY(e):void 0},{name:"editorContentAreaHeightPlugin",plugin:()=>(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_1")?rE():void 0}];return!(0,N.expValEquals)("platform_editor_native_anchor_with_dnd","isEnabled",!0)&&(0,N.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&(0,a("dh538").fg)("platform_editor_table_sticky_header_patch_2")&&d.push({name:"tableAnchorNames",plugin:()=>sO()}),((0,N.expValEquals)("platform_editor_hydratable_ui","isEnabled",!0)?(0,a("d7ZU3").getBrowserInfo)():a("d7ZU3").browser).safari&&d.push({name:"tableSafariDeleteCompositionTextIssueWorkaround",plugin:()=>sE()}),d},contentComponent:({editorView:t,popupsMountPoint:o,popupsBoundariesElement:a,popupsScrollableElement:r,dispatchAnalyticsEvent:l})=>(0,d.jsx)(cV,{api:i,editorView:t,dispatchAnalyticsEvent:l,options:e,popupsMountPoint:o,popupsBoundariesElement:a,popupsScrollableElement:r,defaultGetEditorContainerWidth:n,defaultGetEditorFeatureFlags:cG,isTableSelectorEnabled:E}),pluginsOptions:{quickInsert:({formatMessage:t})=>[{id:"table",title:t(a("4HWgE").toolbarInsertBlockMessages.table),description:t(a("4HWgE").toolbarInsertBlockMessages.tableDescription),keywords:["cell","table"],priority:600,keyshortcut:(0,a("hgeg8").tooltip)(a("hgeg8").toggleTable),icon:()=>(0,d.jsx)(p.IconTable,{}),action(t,o){if(E){let e=t("");return e.setMeta(sq,{isSelectorOpen:!0}),e}let n=i?.table?.sharedState.currentState(),l={isTableScalingEnabled:e?.isTableScalingEnabled,isTableAlignmentEnabled:e?.tableOptions.allowTableAlignment,isFullWidthModeEnabled:n?.isFullWidthModeEnabled,isMaxWidthModeEnabled:n?.isMaxWidthModeEnabled,isCommentEditor:e?.isCommentEditor,isChromelessEditor:e?.isChromelessEditor,isTableResizingEnabled:e?.tableOptions.allowTableResizing},s=oW(l)(o.schema),{tr:d}=o;if((0,u.hasParentNodeOfType)(o.schema.nodes.table)(o.selection)&&e?.tableOptions?.allowNestedTables)if((0,g.editorExperiment)("nested-tables-in-tables",!1,{exposure:!0})||(0,a("sxTNo").getParentOfTypeCount)(o.schema.nodes.table)(o.selection.$from)>1){let e=(0,a("sxTNo").getPositionAfterTopParentNodeOfType)(o.schema.nodes.table)(o.selection.$from);(d=(0,u.safeInsert)(s,e)(d)).scrollIntoView()}else d=t(s=oW({...l,isNestedTable:!0})(o.schema));else d=t(s);return r?.attachAnalyticsEvent({action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.TABLE,attributes:{inputMethod:a("d925B").INPUT_METHOD.QUICK_INSERT,localId:s.attrs.localId},eventType:a("d925B").EVENT_TYPE.TRACK})(d),d}}],floatingToolbar:a2(n,i,r,()=>o.current,e,l,s)(oK(e?.tableOptions))},usePluginHook({editorView:e}){let{mode:t}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(i,["editorViewMode"],e=>({mode:e.editorViewModeState?.mode}));(0,c.useEffect)(()=>{let{state:i,dispatch:o}=e,n=i.tr;n.setMeta("viewModeState",t),o&&o(n)},[e,t])}}}}),r("kEbNW",function(e,t){let i=e=>(t,i)=>o=>{let n=(0,a("id9O1").findTable)(o.selection),r="row"===e,l=o.selection,s=!!l.$anchorCell&&!!l.$headCell;if(n){let e=a("LmqWp").TableMap.get(n.node);if(t>=0&&t<(r?e.height:e.width)){let d=r?0:t,c=r?t:0,p=r?e.width:t+1,u=r?t+1:e.height,h=[];if(i){let i=(0,a("id9O1").findCellClosestToPos)(o.selection.$from);if(!i)return o;let m=e.findCell(i.pos-n.start);if(r){if(c=Math.min(c,m.top),u=Math.max(u,m.bottom),h=e.cellsInRect({left:d,top:c,right:p,bottom:c+1}),e.cellsInRect({left:d,top:t,right:p,bottom:t+1})[0]<l.$head.pos-n.start&&s){let e=n.start+h[0],t=l.$anchorCell.pos,i=o.doc.resolve(e),r=o.doc.resolve(t);return(0,a("8usfh").cloneTr)(o.setSelection(new(0,a("7XFGZ").CellSelection)(r,i)))}}else if(d=Math.min(d,m.left),p=Math.max(p,m.right),h=e.cellsInRect({left:d,top:c,right:d+1,bottom:u}),e.cellsInRect({left:t,top:c,right:t+1,bottom:u})[0]<l.$head.pos-n.start&&s){let e=n.start+h[0],t=l.$anchorCell.pos,i=o.doc.resolve(e),r=o.doc.resolve(t);return(0,a("8usfh").cloneTr)(o.setSelection(new(0,a("7XFGZ").CellSelection)(r,i)))}}h=e.cellsInRect({left:d,top:c,right:r?p:d+1,bottom:r?c+1:u});let m=u-c==1?h:e.cellsInRect({left:r?d:p-1,top:r?u-1:c,right:p,bottom:u}),f=n.start+h[0],g=n.start+m[m.length-1],b=o.doc.resolve(f),E=o.doc.resolve(g);return(0,a("8usfh").cloneTr)(o.setSelection(new(0,a("7XFGZ").CellSelection)(E,b)))}}return o},o=i("column"),n=i("row"),r=e=>t=>i=>{let o=(0,a("id9O1").findTable)(i.selection);if(!o)return i;let n=a("LmqWp").TableMap.get(o.node);if(!t||t.length<=0||"rows"===e&&Math.max(...t)>n.height||"columns"===e&&Math.max(...t)>n.width||0>Math.min(...t))return i;let r=n.cellsInRect({left:"rows"===e?0:Math.min(...t),top:"rows"===e?Math.min(...t):0,right:"rows"===e?n.width:Math.min(...t)+1,bottom:"rows"===e?Math.min(...t)+1:1}),l=n.cellsInRect({left:"rows"===e?n.width-1:Math.max(...t),top:"rows"===e?Math.max(...t):n.height-1,right:"rows"===e?n.width:Math.max(...t)+1,bottom:"rows"===e?Math.max(...t)+1:n.height}),s=o.start+r[0],d=o.start+l[l.length-1],c=i.doc.resolve(s),p=i.doc.resolve(d);return(0,a("8usfh").cloneTr)(i.setSelection(new(0,a("7XFGZ").CellSelection)(p,c)))},l=r("rows"),s=r("columns");e.exports.selectColumn=o,e.exports.selectRow=n,e.exports.selectRows=l,e.exports.selectColumns=s,e.exports.selectTable=e=>{let t=(0,a("id9O1").findTable)(e.selection);if(t){let{map:i}=a("LmqWp").TableMap.get(t.node);if(i&&i.length){let o=t.start+i[0],n=t.start+i[i.length-1],r=e.doc.resolve(o),l=e.doc.resolve(n);return(0,a("8usfh").cloneTr)(e.setSelection(new(0,a("7XFGZ").CellSelection)(l,r)))}}return e},e.exports.selectTableClosestToPos=(e,t)=>{let i=(0,a("id9O1").findTableClosestToPos)(t);if(i){let{map:t}=a("LmqWp").TableMap.get(i.node);if(t&&t.length){let o=i.start+t[0],n=i.start+t[t.length-1],r=e.doc.resolve(o),l=e.doc.resolve(n);return(0,a("8usfh").cloneTr)(e.setSelection(new(0,a("7XFGZ").CellSelection)(l,r)))}}return e}}),r("1rJN9",function(e,t){function i(e){return e&&e.rowspan?e.rowspan-1:0}function o(e,t){return void 0!==e.mergeWith?[e.mergeWith,1,1]:t?[e.from,e.to-e.from,0]:e.newCell?[e.from,0,e.newCell.nodeSize]:[e.from,0,4]}function n(e,t,i,o){let n={from:e.from,to:e.to};return e.hasMergedCells&&(t!==e.col||i)&&(n.mergeWith=e.from),o&&(void 0!==o.mergeWith&&(n.mergeWith=o.mergeWith),o.newCell&&(n.newCell=o.newCell)),n}let r=(e,t,i)=>t*e.width+i;function l(e,t,i){let o=r(e,t,i);return i>0&&e.map[o-1]===e.map[o]||i<e.width-1&&e.map[o+1]===e.map[o]}function*s(e,t){let{map:i,tableStart:o,table:n}=e,s=t>0?-1:0;(0,a("9b9Mr").columnIsHeader)(i,n,t+s)&&(s=0===t||t===i.width?null:0);for(let d=0;d<i.height;d++){let c=r(e.map,d,t),p=i.map[c],u=l(e.map,d,t)&&function(e,t,i){let o=r(e,t,i);return!(t>0)||e.map[o-e.width]!==e.map[o]}(e.map,d,t),h=null==s?(0,a("d1kIV").tableNodeTypes)(n.type.schema).cell:n.nodeAt(i.map[c+s]).type;u||(p=i.positionAt(d,t,n));let m=n.nodeAt(p),f={from:o+p,to:o+p,row:d,col:u?i.colCount(p):t,type:h,hasMergedCells:u};m&&(f.attrs=m.attrs,f.to=o+p+m.nodeSize);let g=yield f;g&&g>0&&(d+=g)}}function d(e,t){let[i,o]=[0,t.map.width-1],n=e.values(),a=n.next();for(let e=0;e<t.map.height&&!a.done;e++)for(let r=i;r<=o;r++){let l=e*t.map.width+r,s=t.map.map[l],d=a.value.from-t.tableStart;if(s===d){let e=o-(i=r)+l;for(let n=l;n<=e&&t.map.map[n]===s;n++)o=i+n-l;if(i===o)return i;a=n.next();break}if(r===t.map.width-1){let e=t.table.nodeAt(s);if(s+e.nodeSize===d)return t.map.width}}return null}function c(e,t){let i=e.nodeAt(t);if(!i||"table"!==i.type.name)throw Error(`No table at position "${t}".`);let o=a("LmqWp").TableMap.get(i),n=e.resolve(t);return{map:o,table:i,tableStart:n.start(n.depth+1),bottom:0,left:0,right:0,top:0}}function p(e,t,i,o){let n=o.rowNode.child(0);return e.insert(e.mapping.map(o.from),o.rowNode),!function(e,t,i){let{map:o,tableStart:n}=t;for(let t=0;t<o.width;t++){let a=i*o.width+t,r=o.map[a],l=e.mapping.map(r+n),s=e.doc.nodeAt(l).attrs;e.setNodeMarkup(l,void 0,{...s,rowspan:s.rowspan+1}),t+=s.colspan-1}}(e,t,i),n.attrs.rowspan-1}class u{start(e){return e?this.deleteHandler():this.addHandler()}addRowRanges(e,t){if(!this.rows)return e;let i=[];for(let e of this.rows){let{from:o,to:n}=e;t?i.push(o,n-o,0):i.push(o,0,n-o)}return function(e,t){let i=[],o=e.length,n=t.length,a=0,r=0;for(;a<o&&r<n;)e[a]<t[r]?(i.push(e[a],e[a+1],e[a+2]),a+=3):(i.push(t[r],t[r+1],t[r+2]),r+=3);return a<o&&i.push(...e.slice(a)),r<n&&i.push(...t.slice(a)),i}(e,i)}map(e){return[]}invert(e,t,i){if(!this.rows)return;let o=[];for(let e of this.rows)if(t){let t=i.map(e.from)-e.from;o.push({...e,from:e.from+t,to:e.from+t})}return o}toJSON(){if(!this.rows)return;let e=[];for(let t of this.rows)e.push({from:t.from,to:t.to,rowNode:t.rowNode.toJSON()});return e}static fromJSON(e,t){let i=[];for(let o of t)i.push({from:o.from,to:o.to,rowNode:e.nodeFromJSON(o.rowNode)});return i}constructor(e){this.rows=void 0,this.deleteHandler=()=>{let e=[];return{handle:(t,i,o,n,a)=>{if(!function(e,t,i){let o=e.table.child(t);return!!o&&1===o.childCount&&!l(e.map,t,i)}(i,o,n))return{handled:!1};let{row:r,skipRows:s}=function(e,t,i,o){let n=t.tableStart;for(let e=0;e<i;e++)n+=t.table.child(e).nodeSize;let a=t.table.child(i),r=n+a.nodeSize;return e.delete(e.mapping.map(n),e.mapping.map(r)),{skipRows:function(e,t,i,o){let n=0,{map:a,table:r,tableStart:l}=t;for(let t=0;t<a.width;t++){let s=i*a.width+t,d=a.map[s];if(i>0&&d===a.map[s-a.width]){let i=e.mapping.map(d+l),o=e.doc.nodeAt(i).attrs;e.setNodeMarkup(i,void 0,{...o,rowspan:o.rowspan-1}),t+=o.colspan-1}else t===o&&(n=r.nodeAt(d).attrs.rowspan-1)}return n}(e,t,i,o),row:{from:n,to:r,rowNode:a.copy(a.content)}}}(t,i,o,n);return e.push(r),{handled:!0,skipRows:s}},end:()=>{e.length>0?this.rows=e:this.rows=void 0}}},this.addHandler=()=>{let e=0,t=0;return{handle:(i,o,n,a,r)=>{let l,s;if(!this.rows||t>=this.rows.length)return{handled:!1};for(;(s=this.rows[t])&&s.from>e&&s.from<r.from;)l=p(i,o,n-1,s),t++;return(e=r.from,l&&0!==l)?{handled:!0,skipRows:l-1}:{handled:!1}},end:(e,i,o)=>{let n;if(this.rows&&!(t>=this.rows.length))for(;n=this.rows[t];)p(e,i,i.map.height-1,n),t++}}},this.rows=e}}class h{addTableSideEffect(e,t,i){this.table={from:e,to:t,node:i}}handleAddTable(e,t){return!t&&!!this.table&&(e.insert(this.table.from,this.table.node),!0)}handleRemoveTable(e,t,i,o,n){return!!n&&1===i.map.width&&0===o&&(this.addTableSideEffect(t,t+i.table.nodeSize,i.table.copy(i.table.content)),e.delete(t,t+i.table.nodeSize),!0)}getTableMap(e){if(!this.table)return;let{from:t,to:i}=this.table;return new(0,a("aXG5V").StepMap)(e?[t,i-t,0]:[t,0,i-t])}map(e){if(this.table)return{from:e.map(this.table.from),to:e.map(this.table.to),node:this.table.node}}invert(e){if(!this.table)return;let t=e.nodeAt(this.table.from);return{from:this.table.from,to:this.table.from+t.nodeSize,node:t.copy(t.content)}}toJSON(){if(this.table)return{from:this.table.from,to:this.table.to,node:this.table.node.toJSON()}}static fromJSON(e,t){return{from:t.from,to:t.to,node:e.nodeFromJSON(t.node)}}constructor(e){this.table=void 0,e&&(this.table=e)}}class m{getTableMap(e){return this.table.getTableMap(e)}map(e){let t={},i=this.table.map(e),o=this.rows.map(e);return i&&(t.table=i),o&&(t.rows=o),t}invert(e,t,i){let o={},n=this.table.invert(e);n&&(o.table=n);let a=this.rows.invert(e,t,i);return a&&(o.rows=a),o}toJSON(){let e=this.table.toJSON(),t=this.rows.toJSON();if(!e&&!t)return;let i={};return e&&(i.table=e),t&&(i.rows=t),i}static fromJSON(e,t){let i={};return t.table&&(i.table=h.fromJSON(e,t.table)),t.rows&&(i.rows=u.fromJSON(e,t.rows)),i}constructor(e){this.table=void 0,this.rows=void 0,this.table=new h(e&&e.table),this.rows=new u(e&&e.rows)}}let f="ak-add-column",g=(e,t,i)=>(0,a("2XqLN").default)(()=>{let o=c(e,t),n=d(i,o);if(null===n)throw Error("no column");return{rect:o,column:n}});class b extends a("cO9ey").Step{apply(e){let t,{tablePos:i}=this,o=new(0,a("aXG5V").Transform)(e);if(this.sideEffectsHandler.table.handleAddTable(o,this.isDelete))return a("aXG5V").StepResult.ok(o.doc);try{t=c(e,i)}catch(e){return a("aXG5V").StepResult.fail(e.message)}let n=d(this.columnInfo,t);return null===n?a("aXG5V").StepResult.fail(`No column for this cells "${function(e){let t=[];for(let i of e.values())t.push(i.from);return`[${t.join(",")}]`}(this.columnInfo)}" in table at position "${i}".`):(this.sideEffectsHandler.table.handleRemoveTable(o,this.tablePos,t,n,this.isDelete)||(this.columnInfo=this.applyCellSteps(o,t,n,this.isDelete)),a("aXG5V").StepResult.ok(o.doc))}map(e){let t=e.mapResult(this.tablePos);if(t.deleted)return null;let i=[];for(let t of this.columnInfo.values()){let o=e.mapResult(t.from),n=e.mapResult(t.to);if(o.deleted&&n.deleted)continue;let a={...t,from:o.pos,to:n.pos};void 0!==t.mergeWith&&(a.mergeWith=e.map(t.mergeWith)),i.push(a)}if(0===i.length)return null;let o=this.sideEffectsHandler.map(e);return new b(t.pos,{cells:i,sideEffects:o},this.isDelete)}invert(e){let t=this.getMap(),i=g(e,this.tablePos,this.columnInfo),n=Array.from(this.columnInfo.values(),n=>(function(e,t,i,n,a){let r=function(e,t,i){if(i)return e.map(t.from)-t.from;let[,n,a]=o(t,i);return e.map(t.from)-t.from-(a-n)}(a,i,n),l={...i,from:i.from+r,to:i.to+r};if(void 0!==i.mergeWith&&(l.mergeWith=i.mergeWith+r),n){let o=e.nodeAt(i.from);l.newCell=o.copy(o.content);let{column:n,rect:a}=t();if(n<a.map.width){let e=a.map.colCount(i.from-a.tableStart)+o.attrs.colspan-1===n;void 0!==i.mergeWith&&e&&(l.mergeWith=l.from,l.from=l.to)}}return l})(e,i,n,this.isDelete,t)),a=this.sideEffectsHandler.invert(e,this.isDelete,t);return new b(this.tablePos,{cells:n,sideEffects:a},!this.isDelete)}getMap(){let e=this.sideEffectsHandler.getTableMap(this.isDelete);if(e)return e;let t=[];for(let e of this.columnInfo.values())t.push(...o(e,this.isDelete));return t=this.sideEffectsHandler.rows.addRowRanges(t,this.isDelete),new(0,a("aXG5V").StepMap)(t)}merge(e){return null}toJSON(){let e={stepType:f,tablePos:this.tablePos,cells:Array.from(this.columnInfo.values(),e=>{let t={from:e.from,to:e.to};return void 0!==e.mergeWith&&(t.mergeWith=e.mergeWith),void 0!==e.newCell&&(t.newCell=e.newCell.toJSON()),t}),isDelete:this.isDelete},t=this.sideEffectsHandler.toJSON();return t&&(e.sideEffects=t),e}static fromJSON(e,t){let i,o=t.cells.map(t=>({...t,newCell:t.newCell?e.nodeFromJSON(t.newCell):void 0}));return t.sideEffects&&(i=m.fromJSON(e,t.sideEffects)),new b(t.tablePos,{cells:o,sideEffects:i},t.isDelete)}static create(e,t,i,o=!1){let a=c(e,t),r=[],l=s(a,i),d=l.next();for(;!d.done;){let e=d.value;r.push(n(e,i,o));let t=0;e.attrs&&e.attrs.rowspan&&(t=e.attrs.rowspan-1),d=l.next(t)}return new b(t,{cells:r},o)}applyCellSteps(e,t,o,r){let l=new Map,d=this.sideEffectsHandler.rows.start(this.isDelete),c=s(t,o),p=c.next();for(;!p.done;){let s=p.value,u=this.columnInfo.get(s.from),h=n(s,o,r,u),m=d.handle(e,t,s.row,o,s);if(m.handled){p=c.next(m.skipRows);continue}let{skipRows:f,cellStep:g}=function(e,t,o,n,r,l){if(void 0!==n.mergeWith){let o=e.doc.nodeAt(e.mapping.map(n.mergeWith)),s=l-t.map.colCount(n.mergeWith-t.tableStart),d=r?(0,a("jl382").removeColSpan)(o.attrs,s):(0,a("jl382").addColSpan)(o.attrs,s);if(d.colspan>0)return e.setNodeMarkup(e.mapping.map(n.mergeWith),void 0,d),{tr:e,skipRows:i(d),cellStep:n};n.from=n.mergeWith,n.to=n.from+o.nodeSize,n.mergeWith=void 0}let s=0;return r?(s=i(e.doc.nodeAt(e.mapping.map(n.from)).attrs),e.delete(e.mapping.map(n.from),e.mapping.map(n.to))):n.newCell?(e.insert(e.mapping.map(n.from),n.newCell),s=i(n.newCell.attrs)):e.insert(e.mapping.map(n.from),o.type.createAndFill()),{tr:e,skipRows:s,cellStep:n}}(e,t,s,h,r,o);l.set(h.from,g),p=c.next(f)}return d.end(e,t,o),l}constructor(e,t,i=!1){super(),this.tablePos=void 0,this.isDelete=void 0,this.columnInfo=void 0,this.sideEffectsHandler=void 0,this.tablePos=e,this.isDelete=i,this.sideEffectsHandler=new m(t.sideEffects),this.columnInfo=new Map(t.cells.map(e=>[e.from,e]))}}a("cO9ey").Step.jsonID(f,b),e.exports.AddColumnStep=b}),r("9MzzS",function(e,t){e.exports.addRow=function(e,{map:t,tableStart:i,table:o},n){let r=i;for(let e=0;e<n;e++)r+=o.child(e).nodeSize;let l=[],s=n>0?-1:0;(function(e,t,i){let o=(0,a("d1kIV").tableNodeTypes)(t.type.schema).header_cell;for(let n=0;n<e.width;n++){let a=t.nodeAt(e.map[n+i*e.width]);if(a&&a.type!==o)return!1}return!0})(t,o,n+s)&&(s=0===n||n===t.height?null:0);for(let r=0,d=t.width*n;r<t.width;r++,d++)if(n>0&&n<t.height&&t.map[d]===t.map[d-t.width]){let n=t.map[d],a=o.nodeAt(n);if(!a)throw Error(`addRow: node not found at pos ${n}`);let{attrs:l}=a;e.setNodeMarkup(i+n,void 0,{...l,rowspan:l.rowspan+1}),r+=l.colspan-1}else{let e,i={};if(null==s)e=(0,a("d1kIV").tableNodeTypes)(o.type.schema).cell;else{let n=t.map[d+s*t.width],a=o.nodeAt(n);if(!a)throw Error(`addRow: invalid node at mapped pos ${n}`);e=a.type,a.attrs.background&&(i={background:a.attrs.background})}l.push(e.createAndFill(i))}let d=(0,a("d1kIV").tableNodeTypes)(o.type.schema).row.create(null,l);return e.insert(r,d),e}}),r("5rHEx",function(e,t){var i,o=((i={}).ASC="asc",i.DESC="desc",i);e.exports.SortOrder=o}),r("eyggb",function(e,i){var o,n,r=a("cUcZ5");(o={}).LEFT="left",o.RIGHT="right";var l=((n={}).CURRENT_SELECTION="currentSelection",n.HTML_ELEMENT="htmlElement",n),s=a("8m4tT"),d=a("1oCLl");let c=new(0,a("ks2lK").PluginKey)("extensionPlugin"),p=(0,a("lkJUe").pluginFactory)(c,function(e,t){return"UPDATE_STATE"===t.type?{...e,...t.data}:e},{mapping(e,t){let{positions:i}=t;if(!i)return t;let o={...i};for(let t in o)o[t]=e.mapping.map(o[t]);return{...t,positions:o}}}),u=p.createPluginState,h=p.createCommand,m=p.getPluginState,f=(e,t=!1)=>{let{inlineExtension:i,extension:o,bodiedExtension:n,multiBodiedExtension:a}=e.schema.nodes,r=[o,n,i,a];return(0,s.findSelectedNodeOfType)(r)(e.selection)||t&&(0,s.findParentNodeOfType)(r)(e.selection)||void 0},g=(e,t)=>{let i,o=f(e,!0);if(!t||o&&o.node.attrs.localId===t)return o;let{inlineExtension:n,extension:a,bodiedExtension:r,multiBodiedExtension:l}=e.schema.nodes,s=[a,r,n,l];return e.doc.descendants((e,o)=>{s.includes(e.type)&&e.attrs.localId===t&&(i={node:e,pos:o})}),i},b=(e,t,i)=>{let o=(0,s.findDomRefAtPos)(i.pos,t);return(i.node.type!==e.nodes.bodiedExtension?o.querySelector(".extension-container"):(0,a("4vlwG").closestElement)(o,".extension-container")||o.querySelector(".extension-container"))||o},E=e=>e.marks?.find(e=>"dataConsumer"===e.type.name),T=(e,t)=>(0,a("2bi6l").findNodePosByLocalIds)(t,e,{includeDocNode:!0}).map(({node:e})=>e.type.name),C=(e,t)=>{let i=(0,a("2bi6l").findNodePosByLocalIds)(e,[t]);return i.length>=1?i[0]:void 0};function _(e){return h({type:"UPDATE_STATE",data:e})}let S=e=>h({type:"UPDATE_STATE",data:{showContextPanel:!1,processParametersBefore:void 0,processParametersAfter:void 0}},e),w=e=>(t,i)=>h({type:"UPDATE_STATE",data:{autoSaveResolve:t,autoSaveReject:i}},e),v=(e,t)=>h({type:"UPDATE_STATE",data:{layout:e}},(i,o)=>{let n=f(o,!0);if(n){let o=i.setNodeMarkup(n.pos,void 0,{...n.node.attrs,layout:e});return o.setMeta("scrollIntoView",!1),t&&t.attachAnalyticsEvent({action:a("d925B").ACTION.UPDATED,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.EXTENSION,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{extensionType:n.node.attrs.extensionType,extensionKey:n.node.attrs.extensionKey,localId:n.node.attrs.localId,layout:e,selection:i.selection.toJSON(),targetSelectionSource:l.CURRENT_SELECTION}})(i),o}return i}),O=(e,t)=>h({type:"UPDATE_STATE",data:{element:void 0}},(i,o)=>f(o)?N(o,i,e,t):R(o,i,e,t)),y=e=>h({type:"UPDATE_STATE",data:{element:void 0}},(t,i)=>e?(0,a("5GR8v").removeConnectedNodes)(i,e):t),N=(e,t,i,o)=>{if(e.selection instanceof a("ks2lK").NodeSelection){let n=e.selection.node;i&&i.attachAnalyticsEvent({action:a("d925B").ACTION.DELETED,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.EXTENSION,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{extensionType:n.attrs.extensionType,extensionKey:n.attrs.extensionKey,localId:n.attrs.localId,inputMethod:o}})(t)}return(0,s.removeSelectedNode)(t)},R=(e,t,i,o)=>{let n=e.schema.nodes.bodiedExtension,r=(0,s.findParentNodeOfType)(e.schema.nodes.multiBodiedExtension)(e.selection);r&&(n=e.schema.nodes.multiBodiedExtension,i&&i.attachAnalyticsEvent({action:a("d925B").ACTION.DELETED,actionSubject:a("d925B").ACTION_SUBJECT.MULTI_BODIED_EXTENSION,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{extensionType:r.node.attrs.extensionType,extensionKey:r.node.attrs.extensionKey,localId:r.node.attrs.localId,currentFramesCount:r.node.content.childCount,inputMethod:o}})(t));let l=(0,s.findParentNodeOfType)(e.schema.nodes.bodiedExtension)(e.selection);return l&&i&&i.attachAnalyticsEvent({action:a("d925B").ACTION.DELETED,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.EXTENSION_BODIED,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{extensionType:l.node.attrs.extensionType,extensionKey:l.node.attrs.extensionKey,localId:l.node.attrs.localId,inputMethod:o}})(t),(0,s.removeParentNodeOfType)(n)(t)};var x=a("9ir1r");let A=new(0,a("ks2lK").PluginKey)("macroPlugin"),I=e=>(t,i,o)=>async n=>{if(!t)return!1;let r=await t.openMacroBrowser(i);if(r&&i){let{state:t,dispatch:d}=n,c=L(r,t,{layout:i&&i.attrs.layout||"default"});if(!c)return!1;let{selection:p,schema:u}=t,{extension:h,inlineExtension:f,bodiedExtension:g,multiBodiedExtension:b}=u.nodes,E=e=>{(_=o?(0,s.replaceParentNodeOfType)(e,c)(_):(0,s.safeInsert)(c)(_)).setSelection(a("ks2lK").TextSelection.create(_.doc,t.selection.anchor))},T=m(t),C=l.CURRENT_SELECTION,{tr:_}=t,S=!!(0,s.findSelectedNodeOfType)([g])(p),w=!!(0,s.findSelectedNodeOfType)([b])(p);if(i.type!==g||S)if(i.type!==b||w){if((0,s.findSelectedNodeOfType)([h,g,f,b])(p))(_=(0,s.replaceSelectedNode)(c)(_)).setSelection(a("ks2lK").NodeSelection.create(_.doc,_.mapping.map(t.selection.anchor)));else if(T.element){let e=n.posAtDOM(T.element,-1);e>-1&&((_=_.replaceWith(e,e+i.nodeSize,c)).setSelection(a("ks2lK").Selection.near(_.doc.resolve(e))),C=l.HTML_ELEMENT)}}else E(t.schema.nodes.multiBodiedExtension);else E(t.schema.nodes.bodiedExtension);if(d&&_.docChanged){let{extensionType:t,extensionKey:n,layout:r,localId:l}=i.attrs;e?.attachAnalyticsEvent({action:a("d925B").ACTION.UPDATED,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:i.type.name,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:o?a("d925B").INPUT_METHOD.MACRO_BROWSER:a("d925B").INPUT_METHOD.TOOLBAR,extensionType:t,extensionKey:n,layout:r,localId:l,selection:_.selection.toJSON(),targetSelectionSource:C}})(_),d(_.scrollIntoView())}return!0}return!1},L=(e,t,i)=>{if(!e||!t)return null;let{schema:o}=t,{type:n,attrs:r}=(0,a("bSXAs").getValidNode)(e,o),l=null;return"extension"===n?l=o.nodes.extension.create({...r,...i}):"bodiedExtension"===n?l=o.nodes.bodiedExtension.create({...r,...i},o.nodeFromJSON(e).content):"inlineExtension"===n?l=o.nodes.inlineExtension.create(r):"multiBodiedExtension"===n&&(l=o.nodes.multiBodiedExtension.create({...r,...i},o.nodeFromJSON(e).content)),l&&(0,a("zT4ZO").normaliseNestedLayout)(t,l)},k=(e,t)=>{let i=A.getState(e),o=i&&i.macroProvider;if(!o||!o.autoConvert)return null;let n=o.autoConvert(t);return n?L(n,e):null},M=e=>async i=>{let o;try{o=await e,t(x)(o&&o.openMacroBrowser,`MacroProvider promise did not resolve to a valid instance of MacroProvider - ${o}`)}catch(e){o=null}return i.dispatch(i.state.tr.setMeta(A,{macroProvider:o})),!0},D=({view:e,macroProvider:t,editorAnalyticsAPI:i})=>()=>{if(!e)throw Error("Missing view. Can't update without EditorView");if(!t)throw Error("Missing macroProvider. Can't use the macro browser for updates");let o=f(e.state,!0);if(!o)throw Error("Missing nodeWithPos. Can't determine position of node");I(i)(t,o.node,!0)(e)},P=e=>({action:a("d925B").ACTION.INVOKED,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.EXTENSION_API,attributes:{functionName:e},eventType:a("d925B").EVENT_TYPE.TRACK}),B=e=>{let{editorView:{state:{schema:t}},editorAnalyticsAPI:i}=e,o=Object.keys(t.nodes),n=Object.keys(t.marks),r=(0,a("jqXx5").validator)(o,n,{allowPrivateAttributes:!0}),l=(t,{opName:i})=>{if("string"!=typeof t||""===t)throw Error(`${i}(): Invalid localId '${t}'.`);let{editorView:{state:o}}=e,n=C(o,t);if(!n)throw Error(`${i}(): Could not find node with ID '${t}'.`);return n};return{editInContextPanel:(t,i)=>{let{editorView:o}=e;h({type:"UPDATE_STATE",data:{showContextPanel:!0,processParametersBefore:t,processParametersAfter:i}},e.applyChange)(o.state,o.dispatch,o)},_editInLegacyMacroBrowser:()=>{let{editorView:t}=e,o=e.editInLegacyMacroBrowser;if(!o){let n=A.getState(t.state);o=D({view:e.editorView,macroProvider:n?.macroProvider||void 0,editorAnalyticsAPI:i})}o()},getNodeWithPosByLocalId:e=>l(e,{opName:"getNodeWithPosByLocalId"}),doc:{insertAfter:(t,o,n)=>{try{r(o)}catch(e){throw Error("insertAfter(): Invalid ADF given.")}let s=l(t,{opName:"insertAfter"}),{editorView:d}=e,{dispatch:c,state:p}=d,{tr:u,schema:h}=p,m=h.nodes[o.type];if(!m)throw Error(`insertAfter(): Invalid ADF type '${o.type}'.`);let f=a("5SAOw").Fragment.fromJSON(h,o.content),g=(o.marks||[]).map(e=>a("5SAOw").Mark.fromJSON(h,e)),b=m?.createChecked(o.attrs,f,g);if(!b)throw Error("insertAfter(): Could not create a node for given ADFEntity.");let C=s.pos+s.node.nodeSize;u.insert(C,b);try{u.doc.check()}catch(e){throw Error(`insertAfter(): The given ADFEntity cannot be inserted in the current position.
${e}`)}let _=P("insertAfter");i?.attachAnalyticsEvent(_)(u);let S=[b];b.descendants(e=>(S.push(e),!0)),S.forEach(e=>{let{extensionKey:t,extensionType:o}=e.attrs,n=E(e),r=n?.attrs.sources.map(e=>e)||[],l=!!n,s=l?T(r,p):void 0,d={action:a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,attributes:{nodeType:e.type.name,inputMethod:a("d925B").INPUT_METHOD.EXTENSION_API,hasReferentiality:l,nodeTypesReferenced:s,layout:e.attrs.layout,extensionType:o,extensionKey:t},eventType:a("d925B").EVENT_TYPE.TRACK};i?.attachAnalyticsEvent(d)(u)}),n&&(n.allowSelectionToNewNode?u.setSelection(new(0,a("ks2lK").NodeSelection)(u.doc.resolve(C))):n.allowSelectionNearNewNode&&u.setSelection(a("ks2lK").TextSelection.near(u.doc.resolve(C)))),c(u)},scrollTo:t=>{let o=l(t,{opName:"scrollTo"}),n=P("scrollTo"),{editorView:{dispatch:a,state:r}}=e,{tr:c}=r;i?.attachAnalyticsEvent(n)(c),c=(0,s.setTextSelection)(o.pos)(c);let p=!0;if("table"===o.node.type.name&&(0,d.expValEquals)("platform_editor_table_sticky_header_improvements","cohort","test_with_overflow")&&(0,d.expValEquals)("platform_editor_native_anchor_with_dnd","isEnabled",!0)){let t=e.editorView.nodeDOM(o.pos);t instanceof HTMLElement&&(t.scrollIntoView({block:"start",behavior:"smooth"}),p=!1)}p&&c.scrollIntoView(),a(c)},update:(t,o,n)=>{let{node:s,pos:d}=l(t,{opName:"update"}),{editorView:{dispatch:c,state:p}}=e,{tr:u,schema:h}=p,m=o({content:(0,a("7iE7T").nodeToJSON)(s).content,attrs:s.attrs,marks:s.marks.map(e=>({type:e.type.name,attrs:e.attrs}))}),f=m.hasOwnProperty("marks")?m.marks?.map(e=>{if("object"!=typeof e||Array.isArray(e))throw Error("update(): Invalid mark given.");let{parent:t}=p.doc.resolve(d),i=h.marks[e.type];if(!i)throw Error(`update(): Invalid ADF mark type '${e.type}'.`);if(!t.type.allowsMarkType(i))throw Error(`update(): Parent of type '${t.type.name}' does not allow marks of type '${e.type}'.`);return{mark:i,attrs:e.attrs}}).map(({mark:e,attrs:t})=>e.create(t)):s.marks,g=m.hasOwnProperty("content")?a("5SAOw").Fragment.fromJSON(h,m.content):s.content,b=m.hasOwnProperty("attrs")?m.attrs:s.attrs;"multiBodiedExtension"===s.type.name&&(b={...s.attrs,...m.attrs,parameters:{...s.attrs.parameters,...m.attrs?.parameters,macroParams:{...s.attrs.parameters?.macroParams,...m.attrs?.parameters?.macroParams}}});try{let e=s.type.createChecked(b,g,f),t=new(0,a("h9yJL").JSONTransformer)().encodeNode(e);r(t),u.replaceWith(d,d+s.nodeSize,e),g===s.content&&u.setSelection(a("ks2lK").Selection.fromJSON(u.doc,p.selection.toJSON()))}catch(e){throw Error(`update(): The given ADFEntity cannot be inserted in the current position.
${e}`)}let E=P("update");i?.attachAnalyticsEvent(E)(u),"boolean"==typeof n?.addToHistory&&u.setMeta("addToHistory",n.addToHistory),"boolean"==typeof n?.scrollIntoView&&u.setMeta("scrollIntoView",n.scrollIntoView),c(u)}}}},W=(e,t,i,o,n)=>{switch(e){case"extension":return t.nodes.extension.createChecked(i,o,n);case"inlineExtension":return t.nodes.inlineExtension.createChecked(i,o,n);case"bodiedExtension":return t.nodes.bodiedExtension.create(i,o,n);case"multiBodiedExtension":return t.nodes.multiBodiedExtension.create(i,o,n)}},U=e=>(t,i,o,n,r)=>(d,c,p)=>{if(!p)throw Error("EditorView is required to perform node update!");let{state:u,dispatch:h}=p,f=W(t,u.schema,i,o,n);if(!f)return!1;let{selection:g,schema:b}=u,{extension:E,inlineExtension:T,bodiedExtension:C,multiBodiedExtension:_}=b.nodes,S=!!(0,s.findSelectedNodeOfType)([C])(g),w=!!(0,s.findSelectedNodeOfType)([_])(g),v=m(u),O=e=>{(R=(0,s.replaceParentNodeOfType)(e,f)(R)).setSelection(a("ks2lK").TextSelection.create(R.doc,u.selection.anchor))},y=l.CURRENT_SELECTION,N=a("d925B").ACTION.UPDATED,{tr:R}=u;if(f.type!==C||S)if(f.type!==_||w){if((0,s.findSelectedNodeOfType)([E,C,T,_])(g))(R=(0,s.replaceSelectedNode)(f)(R)).setSelection(a("ks2lK").NodeSelection.create(R.doc,R.mapping.map(u.selection.anchor)));else if(v.element){let e=p.posAtDOM(v.element,-1);e>-1?((R=R.replaceWith(e,e+(o.size||0)+1,f)).setSelection(a("ks2lK").Selection.near(R.doc.resolve(e))),y=l.HTML_ELEMENT):N=a("d925B").ACTION.ERRORED}}else O(u.schema.nodes.multiBodiedExtension);else O(u.schema.nodes.bodiedExtension);if(h&&R.docChanged){let{extensionType:t,extensionKey:i,layout:o,localId:n}=f.attrs;e?.attachAnalyticsEvent({action:N,actionSubject:a("d925B").ACTION_SUBJECT.EXTENSION,actionSubjectId:f.type.name,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:a("d925B").INPUT_METHOD.CONFIG_PANEL,extensionType:t,extensionKey:i,layout:o,localId:n,selection:R.selection.toJSON(),targetSelectionSource:y}})(R),h(r?R.scrollIntoView():R)}return!0},H=e=>(t,i,o)=>async(n,a,r)=>{let{attrs:l,type:s,content:d,marks:c}=i.node;if(!n.schema.nodes[s.name])return!1;let{parameters:p}=l;try{let i=await t(p,o);if(i){let t={...l,parameters:{...p,...i}};return"multiBodiedExtension"===s.name&&(t.parameters.macroParams={...p.macroParams,...i?.macroParams}),U(e)(s.name,t,d,c,!0)(n,a,r)}}catch{}return!0},F=(e,t,i,o)=>(n,a,r)=>{if(!r)return!1;let{localId:l}=m(n),s=g(n,l);if(!s)return!1;let d=D({view:r,macroProvider:e||void 0,editorAnalyticsAPI:i});if(o)o.then(o=>{if(o&&r){let e=B({editorView:r,editInLegacyMacroBrowser:d,applyChange:t,editorAnalyticsAPI:i});H(i)(o,s,e)(n,a,r);return}if(!o&&e)return void d()});else{if(!e)return!1;d()}return!0},z=({editorViewRef:e,editorAnalyticsAPI:t,applyChangeToContextPanel:i})=>()=>{let{current:o}=e;if(!o)return!1;let{updateExtension:n}=m(o.state);return F(null,i,t,n)(o.state,o.dispatch,o)},V=({editorView:e,action:t,attrs:i,content:o,position:n,size:a=0,tr:r})=>{let l=e.state.schema.node("extension",i,o);return"insert"===t?r=e.state.tr.insert(n,l):(r.replaceWith(n,n+a,l),r)},G=({editorView:e,action:t,attrs:i,content:o,position:n,size:a=0,tr:r})=>{let l=e.state.schema.node("bodiedExtension",i,o);return"insert"===t?r=e.state.tr.insert(n,l):(r.replaceWith(n,n+a,l),r)},j=(e,t)=>new(0,a("1S4f7").SafePlugin)({state:{init:()=>({macroProvider:null}),apply(t,i){let o=t.getMeta(A);if(o){let t={...i,...o};return e(A,t),t}return i}},key:A,view:e=>{let i=(t,i)=>i&&M(i)(e);return e.dom.parentNode&&t.subscribe("macroProvider",i),{destroy(){t.unsubscribe("macroProvider",i)}}}});var K=a("gjBRE"),$=a("iu6m9");function X(e,...t){return(0,$.editorExperiment)("platform_editor_exp_lazy_node_views",!1)?(0,K.default)(...t):(0,a("ftpVl").withLazyLoading)({nodeName:e,getNodeViewOptions:()=>{},loader:()=>a("8y1DS").then(({ExtensionNodeView:e})=>e(...t))})}var Z=a("heH5c");let q=async(e,t)=>{let i=f(e.state,!0);if(!i)throw Error("There is no selection");let{extensionType:o,extensionKey:n}=i.node.attrs,a=await (0,Z.getExtensionModuleNode)(t,o,n),r=f(e.state,!0);if(r&&r.node.attrs.extensionType===o&&r.node.attrs.extensionKey===n&&r.pos===i.pos&&a)return a.update},Y=async(e,t)=>{try{let i=await q(e,t);return _({showEditButton:!!i,updateExtension:i&&Promise.resolve(i)||void 0})(e.state,e.dispatch),i}catch{}},Q=(e,t)=>{let i=!e&&!t||"function"==typeof e,o="object"==typeof e&&"function"==typeof e.update;return!!i||!!o},J=async(e,t,i)=>{if(t&&"object"==typeof t)return t.update;if(i){let t=await Y(e,i);if(t)return t}throw Error("No update method available")},ee=e=>async(t,i)=>{if("extensionProvider"===t&&i)try{let t=await i;_({extensionProvider:t})(e.state,e.dispatch),await Y(e,t)}catch{_({extensionProvider:void 0})(e.state,e.dispatch)}},et=({view:e,prevState:t,domAtPos:i,extensionHandlers:o,applyChange:n})=>{let{state:a,dispatch:r}=e,{element:l,localId:s,extensionProvider:d,showContextPanel:c,showEditButton:p}=m(a),u=f(a,!0);if(!u){c&&S(n)(a,r);return}let{node:h}=u,g=b(a.schema,i,u),E=!p&&d&&l===g&&!f(t,!0);if((h.attrs.localId?s!==h.attrs.localId:l!==g)||E){if(c)return void S(n)(a,r);let{extensionType:t}=h.attrs,i=o[t],l=Q(i,d),s=J(e,i,d).catch(()=>{});_({localId:h.attrs.localId,showContextPanel:!1,element:g,showEditButton:l,updateExtension:s})(a,r)}else l!==g&&_({element:g})(a,r);return!0},ei=(e,t,i,o,n,r,l=!1,d={},p,h)=>{let m=u(e,{showEditButton:!1,showContextPanel:!1}),f={appearance:d.appearance,getExtensionHeight:d.getExtensionHeight},g={showMacroInteractionDesignUpdates:p?.macroInteractionUpdates??!1},b=h?.isAllowedToUseRendererView;return new(0,a("1S4f7").SafePlugin)({state:m,view:e=>{let o=e.domAtPos.bind(e),n=ee(e);return t.subscribe("extensionProvider",n),{update:(e,t)=>{et({view:e,prevState:t,domAtPos:o,extensionHandlers:i,applyChange:r?.contextPanel?.actions.applyChange})},destroy:()=>{t.unsubscribe("extensionProvider",n)}}},key:c,props:{handleDOMEvents:{keydown:(e,t)=>{if(t instanceof KeyboardEvent&&t.shiftKey&&["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(t.key)){let{schema:i,selection:o,selection:{$head:n},doc:r,tr:l}=e.state,{bodiedExtension:d}=i.nodes;if(o instanceof a("ks2lK").TextSelection||o instanceof a("ks2lK").NodeSelection){let i=o instanceof a("ks2lK").TextSelection?(0,s.findParentNodeOfTypeClosestToPos)(n,d):(0,s.findSelectedNodeOfType)(d)(o);if(i){let s=i.pos+i.node.nodeSize;if("ArrowUp"===t.key||"ArrowLeft"===t.key&&(0,a("l6okE").isSelectionAtStartOfNode)(n,i?.node)){let n="ArrowLeft"===t.key?-1:0,d=i.pos+n,c=a("ks2lK").TextSelection.create(r,Math.max(s+1,o.anchor),d);return e.dispatch(l.setSelection(c)),!0}if("ArrowDown"===t.key||"ArrowRight"===t.key&&(0,a("l6okE").isSelectionAtEndOfNode)(n,i?.node)){let t=i.pos-1,n=a("ks2lK").TextSelection.create(r,Math.min(t,o.anchor),s+1);return e.dispatch(l.setSelection(n)),!0}}}}if(t instanceof KeyboardEvent&&!t.shiftKey&&"ArrowLeft"===t.key){let{schema:t,selection:i,selection:{$head:o},doc:n,tr:r}=e.state,{multiBodiedExtension:l,extensionFrame:d,paragraph:c}=t.nodes;if((i instanceof a("adhil").GapCursorSelection||i instanceof a("ks2lK").TextSelection&&o.parent.type===c)&&(0,s.findParentNodeOfTypeClosestToPos)(o,l)){let t=i instanceof a("adhil").GapCursorSelection?1:2;if(r.doc.nodeAt(o.pos-t)?.type===d){let i=a("ks2lK").TextSelection.create(n,r.doc.resolve(o.pos-t).start(o.depth-t));e.dispatch(r.setSelection(i))}}}return!1}},nodeViews:{extension:X("extension",o,n,t,i,f,r,g),bodiedExtension:X("bodiedExtension",o,n,t,i,f,r,g,b,h?.showUpdated1PBodiedExtensionUI,h?.rendererExtensionHandlers),inlineExtension:X("inlineExtension",o,n,t,i,f,r,g),multiBodiedExtension:X("multiBodiedExtension",o,n,t,i,f,r,g)},createSelectionBetween:function(e,t,i){let{schema:o,doc:n}=e.state,{multiBodiedExtension:r}=o.nodes,l=(0,s.findParentNodeOfTypeClosestToPos)(t,r),d=(0,s.findParentNodeOfTypeClosestToPos)(i,r);return void 0!==l&&void 0===d?a("ks2lK").TextSelection.create(n,l.pos<i.pos?l.pos:l.pos+l.node.nodeSize,i.pos):void 0===l&&void 0!==d?a("ks2lK").TextSelection.create(n,t.pos,d.pos<t.pos?d.pos:d.pos+d.node.nodeSize):null},handleClickOn:(0,a("3tffm").createSelectionClickHandler)(["extension","bodiedExtension","multiBodiedExtension"],e=>!e.closest(".extension-non-editable-area")&&(!e.closest(".extension-content")||!!e.closest(".extension-container")),{useLongPressSelection:l})}})},eo=e=>e.charAt(0).toUpperCase()+e.slice(1),en=()=>({...a("4sfnB").bodiedExtension,toDOM:e=>{let t={"data-node-type":"bodied-extension","data-extension-type":e.attrs.extensionType,"data-extension-key":e.attrs.extensionKey,"data-text":e.attrs.text,"data-parameters":JSON.stringify(e.attrs.parameters),"data-layout":e.attrs.layout,"data-local-id:":e.attrs.localId,style:(0,a("24P9d").convertToInlineCss)({position:"relative",marginTop:"var(--ds-space-300, 24px)"})},i=e.attrs&&e.attrs.extensionTitle||e.attrs&&e.attrs.macroMetadata&&e.attrs.macroMetadata.title||e.attrs.extensionKey;return["div",t,["span",{style:(0,a("24P9d").convertToInlineCss)({boxShadow:`0 0 0 1px var(--ds-border, ${a("6fnsQ").N30})`,fontSize:"14px",padding:"var(--ds-space-025, 2px) var(--ds-space-050, 4px)",color:"var(--ds-text-subtle, #505258)",borderTopLeftRadius:"var(--ds-radius-small, 4px)",borderTopRightRadius:"var(--ds-radius-small, 4px)",lineHeight:1,position:"absolute",top:"-19px"}),"data-bodied-extension-label":eo(i),class:"bodied-extension-to-dom-label"}],["div",{style:(0,a("24P9d").convertToInlineCss)({padding:"var(--ds-space-200, 16px)",marginLeft:"var(--ds-space-negative-150, -12px)",marginRight:"var(--ds-space-negative-150, -12px)",boxShadow:`0 0 0 1px var(--ds-border, ${a("6fnsQ").N30})`,borderRadius:"var(--ds-radius-small, 4px)"})},0]]}});var ea=a("l998X");a("42omo");let er=(e,t)=>{let{schema:{nodes:{extension:i,panel:o,blockquote:n,listItem:a}},selection:r}=e;return!!t&&t.node.type===i&&(0,s.hasParentNodeOfType)([o,n,a].filter(Boolean))(r)},el=(e,t)=>{let{schema:{nodes:{bodiedExtension:i,extension:o,layoutSection:n,table:a,expand:r,multiBodiedExtension:l}},selection:d}=e;if(!t)return!1;let c=t.node.type===l,p=t.node.type===i&&!(0,s.hasParentNodeOfType)([l].filter(Boolean))(d),u=t.node.type===o&&!(0,s.hasParentNodeOfType)([i,a,r,l].filter(Boolean))(d);return!!((c||p||u)&&!(0,s.hasParentNodeOfType)([n])(d))},es=(e,i,o,n,r)=>{let l=f(e,!0);if(l&&n&&el(e,l)&&!er(e,l)){let{layout:e}=l.node.attrs;return[{type:"button",icon:()=>(0,ea.jsx)(t(a("3uQ0E")),{label:i(a("61p3e").default.layoutFixedWidth),spacing:"spacious"}),iconFallback:t(a("3uQ0E")),onClick:v("default",r),selected:"default"===e,title:i(a("61p3e").default.layoutFixedWidth),tabIndex:null},{type:"button",icon:()=>(0,ea.jsx)(t(a("kDG8M")),{label:i(a("61p3e").default.layoutWide),spacing:"spacious"}),iconFallback:t(a("kDG8M")),onClick:v("wide",r),selected:"wide"===e,title:i(a("61p3e").default.layoutWide),tabIndex:null},{type:"button",icon:()=>(0,ea.jsx)(t(a("gzsfl")),{label:i(a("61p3e").default.layoutFullWidth),spacing:"spacious"}),iconFallback:t(a("gzsfl")),onClick:v("full-width",r),selected:"full-width"===e,title:i(a("61p3e").default.layoutFullWidth),tabIndex:null}]}return[]},ed=(e,i,o,n)=>{let r,l=f(e,!0);if(!l||!o||!el(e,l)||er(e,l))return[];let{layout:s}=l.node.attrs,d="";switch(s){case"wide":d=i(a("61p3e").default.layoutStateWide),r=t(a("kDG8M"));break;case"full-width":d=i(a("61p3e").default.layoutStateFullWidth),r=t(a("gzsfl"));break;default:d=i(a("61p3e").default.layoutStateFixedWidth),r=t(a("3uQ0E"))}return[{id:"extensions-width-options-toolbar-item",testId:"extensions-width-options-toolbar-dropdown",type:"dropdown",options:[{id:"editor.extensions.width.default",title:i(a("61p3e").default.layoutFixedWidth),onClick:v("default",n),selected:"default"===s,icon:(0,ea.jsx)(t(a("3uQ0E")),{color:"currentColor",spacing:"spacious",label:i(a("61p3e").default.layoutFixedWidth)})},{id:"editor.extensions.width.wide",title:i(a("61p3e").default.layoutWide),onClick:v("wide",n),selected:"wide"===s,icon:(0,ea.jsx)(t(a("kDG8M")),{color:"currentColor",spacing:"spacious",label:i(a("61p3e").default.layoutWide)})},{id:"editor.extensions.width.full-width",title:i(a("61p3e").default.layoutFullWidth),onClick:v("full-width",n),selected:"full-width"===s,icon:(0,ea.jsx)(t(a("gzsfl")),{color:"currentColor",spacing:"spacious",label:i(a("61p3e").default.layoutFullWidth)})}],title:d,iconBefore:()=>(0,ea.jsx)(r,{color:"currentColor",spacing:"spacious",label:d})}]},ec=(e,t,i,o,n,r)=>(0,a("iHzeA").areToolbarFlagsEnabled)(!!r?.toolbar)?ed(e,t,o,n):es(e,t,i,o,n),ep=(e,i,o,n,r=!1,l)=>{if(!i.showEditButton)return[];let s=(0,a("iHzeA").areToolbarFlagsEnabled)(!!l?.toolbar),c=[{id:"editor.extension.edit",type:"button",icon:t(a("1Zr9M")),iconFallback:t(a("1Zr9M")),testId:"extension-toolbar-edit-button",onClick:(e,t,i)=>{let a=A.getState(e),{updateExtension:r}=m(e);return F(a&&a.macroProvider,o,n,r)(e,t,i),!0},title:e(a("5pF33").messages.edit),tabIndex:null,focusEditoronEnter:!0,disabled:r,isRadioButton:!(0,d.expValEquals)("platform_editor_august_a11y","isEnabled",!0)&&void 0}];return s&&c.push({type:"separator",fullHeight:!0}),c},eu=(e,t,i,o)=>{let{state:{schema:n,selection:r}}=e,l=(0,s.findParentNodeOfType)(n.nodes.extensionFrame)(r)&&o?.node.type.name==="bodiedExtension",d=e.dom.closest(".fabric-editor-popup-scroll-parent")||document.body;if(!o)return t;let c=!!e.dom.closest(".extension-editable-area");if(!l&&!c)return t;c&&d.parentElement&&(d=d.parentElement.closest(".fabric-editor-popup-scroll-parent")||d);let p=e.nodeDOM(o.pos),u=p?.getBoundingClientRect(),h=d.getBoundingClientRect();return{top:u.bottom-h.top+d.scrollTop+a("5Ev1b").BODIED_EXT_MBE_MARGIN_TOP,left:t.left}},eh=({breakoutEnabled:e=!0,extensionApi:i})=>(o,n)=>{let r,{formatMessage:l}=n,s=m(o),d=i?.decorations?.actions.hoverDecoration,c=i?.contextPanel?.actions.applyChange,p=i?.analytics?.actions;if(!s||s.showContextPanel||!s.element)return;let u=[o.schema.nodes.extension,o.schema.nodes.inlineExtension,o.schema.nodes.bodiedExtension,o.schema.nodes.multiBodiedExtension],h=ep(l,s,c,p,(0,$.editorExperiment)("platform_editor_offline_editing_web",!0)&&(0,a("91bcx").isOfflineMode)(i?.connectivity?.sharedState?.currentState()?.mode),i),g=ec(o,l,s,e,p,i),b=f(o,!0);return(0,a("5GR8v").isReferencedSource)(o,b?.node)&&(r=()=>{let e=l(a("5pF33").messages.unnamedSource);return{title:l(a("5pF33").messages.deleteElementTitle),okButtonLabel:l(a("5pF33").messages.confirmDeleteLinkedModalOKButton),message:l(a("5pF33").messages.confirmDeleteLinkedModalMessage,{nodeName:(0,a("5GR8v").getNodeName)(o,b?.node)||e}),isReferentialityDialog:!0,getChildrenInfo:()=>(0,a("5GR8v").getChildrenInfo)(o,b?.node),checkboxLabel:l(a("5pF33").messages.confirmModalCheckboxLabel),onConfirm:(e=!1)=>em(e,b?.node)}}),{title:"Extension floating controls",getDomRef:()=>s.element.parentElement||void 0,nodeType:u,onPositionCalculated:(e,t)=>eu(e,t,o,b),items:[...h,...g,{type:"separator",hidden:0===h.length&&0===g.length},{type:"extensions-placeholder",separator:"end"},{type:"copy-button",items:[{state:o,formatMessage:n.formatMessage,nodeType:u}]},{type:"separator"},{id:"editor.extension.delete",type:"button",icon:t(a("gKvd9")),iconFallback:t(a("gKvd9")),appearance:"danger",onClick:O(p,a("d925B").INPUT_METHOD.FLOATING_TB),onMouseEnter:d?.(u,!0),onMouseLeave:d?.(u,!1),onFocus:d?.(u,!0),onBlur:d?.(u,!1),focusEditoronEnter:!0,title:l(a("61p3e").default.remove),tabIndex:null,confirmDialog:r}],scrollable:!0}},em=(e,t)=>(i,o)=>!!t&&(e?y(t)(i,o):O()(i,o),!0),ef=new(0,a("ks2lK").PluginKey)("extensionUniqueIdPlugin"),eg=()=>new(0,a("1S4f7").SafePlugin)({appendTransaction:(e,t,i)=>{let o=i.tr,n=o.selection.getBookmark(),r=!1,{extension:l,bodiedExtension:s,inlineExtension:d,multiBodiedExtension:c}=i.schema.nodes,p=new Set([l,s,d,c]),u=new Set;if(e.forEach(e=>{e.docChanged&&e.steps.some(e=>(0,a("kTbzR").stepAddsOneOf)(e,p)||e instanceof a("9YoeD").SetAttrsStep&&e.attrs?.localId===null)&&i.doc.descendants((e,t)=>{let i=e.attrs.localId;return!(e.type&&p.has(e.type))||(i&&!u.has(i)?u.add(i):(!i||u.has(i))&&(r=!0,o.setNodeMarkup(t,void 0,{...e.attrs,localId:a("fO7hX").uuid.generate()})),!![c,s].includes(e.type))})}),r)return o.setSelection(n.resolve(o.doc))},key:ef});a("42omo");var eb=a("4wH3g"),eE=a("1ux1Z"),eT=t(eb)({__loadable_id__:"qIe90",name:"platform.packages.editor.editor-plugin-extension.src.ui.ConfigPanel.ConfigPanelLoader",loader:()=>a("3prgd").then(e=>e.default),loading:eE.default}),eC=a("42omo");let e_=()=>{},eS={name:"zl1inp",styles:"display:flex;justify-content:center"},ew=(0,a("9K4OG").css)({position:"fixed",width:"256px",bottom:"var(--ds-space-250, 20px)",display:"flex",flexDirection:"row",alignItems:"center",padding:"var(--ds-space-075, 6px) var(--ds-space-150, 12px)",background:`var(--ds-surface-overlay, ${a("6fnsQ").N0})`,boxShadow:"var(--ds-shadow-overlay, 0px 8px 12px rgba(9, 30, 66, 0.15), 0px 0px 1px rgba(9, 30, 66, 0.31))",borderRadius:"var(--ds-radius-xxlarge, 16px)"}),ev=(0,a("ecnYn").xcss)({paddingLeft:"space.075"}),eO=({children:e,duration:i,visible:o=!0})=>{let[n,r]=(0,eC.useState)(!1),l=(0,eC.useRef)(!1),s=(0,eC.useCallback)(()=>{l.current||(r(!0),l.current=!0)},[]);return(0,eC.useEffect)(()=>{if(n){let e=setTimeout(()=>{r(!1)},i);return()=>clearTimeout(e)}},[n,i]),(0,a("9K4OG").jsx)(eC.Fragment,null,(0,a("9K4OG").jsx)("div",null,e({onSaveStarted:s,onSaveEnded:e_})),o&&n&&(0,a("9K4OG").jsx)("div",{css:eS},(0,a("9K4OG").jsx)("div",{css:ew,"data-testid":"save-indicator-content"},(0,a("9K4OG").jsx)(t(a("3sFtD")),{label:"Saving",color:`var(--ds-icon-success, ${a("6fnsQ").G300})`,LEGACY_size:"small",spacing:"none"}),(0,a("9K4OG").jsx)(a("6f0Oj").default,{xcss:ev},(0,a("9K4OG").jsx)(a("5dK2X").default,null,(0,a("9K4OG").jsx)(a("gtD4K").default,a("5pF33").messages.saveIndicator))))))},ey=(e,t)=>{if("object"==typeof e&&"object"==typeof t&&null!==e&&null!==t){let i=Object.keys(e),o=Object.keys(t);return i.length===o.length&&i.every(i=>e[i]===t[i])}return e===t},eN=(e,t)=>e instanceof a("ks2lK").NodeSelection?a("ks2lK").NodeSelection.create(t,e.from):e instanceof a("ks2lK").TextSelection?a("ks2lK").TextSelection.create(t,e.from,e.to):e instanceof a("adhil").GapCursorSelection?new(0,a("adhil").GapCursorSelection)(t.resolve(e.from),e.side):e instanceof a("7XFGZ").CellSelection?new(0,a("7XFGZ").CellSelection)(t.resolve(e.$anchorCell.pos),t.resolve(e.$headCell.pos)):void 0,eR=e=>(t,i)=>o=>{let n=f(o,!0),r=t?.contextPanel?.actions.applyChange;if(!n)return;let l=m(o),{autoSaveResolve:s,autoSaveReject:d,showContextPanel:c,extensionProvider:p,processParametersBefore:u,processParametersAfter:h}=l;if(l&&c&&p&&h){let{extensionType:o,extensionKey:l,parameters:c}=n.node.attrs,[h,m]=(0,a("3jQ9y").getExtensionKeyAndNodeKey)(l,o),f=u?u(c||{}):c;return(0,ea.jsx)(eO,{duration:5e3,visible:!0,children:({onSaveStarted:a,onSaveEnded:l})=>{let u=e?.();return u?(0,ea.jsx)(eT,{api:t,showHeader:!0,closeOnEsc:!0,extensionType:o,extensionKey:h,nodeKey:m,extensionParameters:c,parameters:f,extensionProvider:p,autoSaveTrigger:s,autoSaveReject:d,onChange:async e=>{await ex(u,e,c,n,a),l(),s&&s()},onCancel:async()=>{try{await new Promise((e,t)=>{w(r)(e,t)(u.state,u.dispatch)})}catch(e){console.error("Autosave failed with error",e)}S(r)(u.state,u.dispatch)},featureFlags:i}):null}})}};async function ex(e,t={},i={},o,n){let{processParametersAfter:a,processParametersBefore:r}=m(e.state);if(!a||ey(r?r(i):i,t))return;n&&n();let l=Date.now(),{positions:s}=m(e.state);await _({positions:{...s,[l]:o.pos}})(e.state,e.dispatch);let d=await a(t),{positions:c}=m(e.state);if(!c||!(l in c))return;let{node:p}=o,u=W(o.node.toJSON().type,e.state.schema,{...p.attrs,parameters:{...i,...d}},p.content,p.marks);if(!u)return;let h=c[l],f=e.state.tr.replaceWith(h,h+u.nodeSize,u),{selection:g}=e.state;if(!g.eq(f.selection)){let e=eN(g,f.doc);e&&f.setSelection(e)}let b={...m(e.state).positions};delete b[l],await _({positions:b})(e.state,e.dispatch),e.dispatch(f)}function eA(e){return function(t){let{extensionKey:i,extensionProvider:o,extensionType:n,...r}=t,[l]=(0,a("1eYoq").useStateFromPromise)(()=>o.getExtension(n,i),[o,n,i]);return l?(0,ea.jsx)(e,{extensionManifest:l,...r}):null}}a("42omo"),a("42omo");let eI=(0,a("ecnYn").xcss)({display:"flex",flexDirection:"row",flexWrap:"nowrap",justifyContent:"space-between",margin:"space.200",flexGrow:3}),eL=(0,a("ecnYn").xcss)({maxWidth:"100%",whiteSpace:"initial"}),ek=(0,a("ecnYn").xcss)({font:'var(--ds-font-body-small, normal 400 11px/16px ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Ubuntu, "Helvetica Neue", sans-serif)',color:"color.text.subtlest",marginTop:"space.050",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"});var eM=eA(function({extensionManifest:e}){let t=e.title,i=e.summary;return(0,ea.jsx)(a("6f0Oj").default,{xcss:eI,children:i?(0,ea.jsxs)(a("6f0Oj").default,{xcss:eL,children:[(0,ea.jsx)("div",{id:"context-panel-title","data-testid":"context-panel-title",children:t}),(0,ea.jsx)(a("6f0Oj").default,{xcss:ek,children:i})]}):(0,ea.jsx)(a("bUlM5").default,{direction:"column",alignItems:"center",testId:"context-panel-title",children:t})})});let eD="40px",eP=(0,a("ecnYn").xcss)({width:eD,height:eD,overflow:"hidden",border:"var(--ds-border-width, 1px) solid var(--ds-border, rgba(223, 225, 229, 0.5))",borderRadius:"var(--ds-radius-small, 3px)",boxSizing:"border-box",display:"flex",justifyContent:"center",alignItems:"center"});var eB=eA(function({extensionManifest:e}){let t=e.icons["48"],i=e.title,o=(0,eC.useMemo)(()=>(0,eC.lazy)(()=>t().then(e=>"default"in e?e:{default:e})),[t]);return(0,ea.jsx)(a("6f0Oj").default,{xcss:eP,children:(0,ea.jsx)(eC.Suspense,{fallback:null,children:(0,ea.jsx)(o,{label:i})})})});let eW=e=>({showContextPanel:e.extensionState?.showContextPanel,extensionProvider:e.extensionState?.extensionProvider,processParametersAfter:e.extensionState?.processParametersAfter});function eU(e,t){let i=t?.contextPanel?.actions?.closePanelById;i&&i(e)}async function eH({api:e,editorView:t}){let i=e?.contextPanel?.actions.applyChange;S(i)(t.state,t.dispatch);try{await new Promise((e,o)=>{w(i)(e,o)(t.state,t.dispatch)})}catch(e){console.error("Autosave failed with error",e)}}let eF=({api:e,editorView:t,extensionProvider:i,nodeWithPos:o})=>{let n=e?.featureFlags?.sharedState.currentState()||{},{autoSaveResolve:r,autoSaveReject:l,processParametersBefore:s}=m(t.state),{extensionType:d,extensionKey:c,parameters:p}=o.node.attrs,[u,h]=(0,a("3jQ9y").getExtensionKeyAndNodeKey)(c,d),f=s?s(p||{}):p;return()=>(0,ea.jsx)(a("gdv5Z").default,{padding:"space.200",children:(0,ea.jsx)(eO,{duration:5e3,visible:!0,children:({onSaveStarted:a,onSaveEnded:s})=>(0,ea.jsx)(eT,{api:e,showHeader:!0,closeOnEsc:!0,extensionType:d,extensionKey:u,nodeKey:h,extensionParameters:p,parameters:f,extensionProvider:i,autoSaveTrigger:r,autoSaveReject:l,onChange:async e=>{await ex(t,e,p,o,a),s(),r&&r()},onCancel:()=>eH({api:e,editorView:t}),featureFlags:n,usingObjectSidebarPanel:!0})})})};e.exports.extensionPlugin=({config:e={},api:i})=>{let o=`${a("7NMV8").CONFIG_PANEL_ID}-${t(r)()}`,n=i?.featureFlags?.sharedState.currentState()||{},l={current:null},s=i?.contextPanel?.actions?.showPanel;return{name:"extension",nodes:()=>[{name:"extension",node:a("2xxP6").extension},{name:"bodiedExtension",node:en()},{name:"inlineExtension",node:a("u6ZFj").inlineExtension},{name:"extensionFrame",node:a("aotp7").extensionFrame},{name:"multiBodiedExtension",node:a("aotp7").multiBodiedExtension}],getSharedState(e){if(!e)return;let t=c.getState(e);return{showContextPanel:t?.showContextPanel,extensionProvider:t?.extensionProvider,processParametersAfter:t?.processParametersAfter}},pmPlugins:()=>[{name:"extension",plugin:({dispatch:t,providerFactory:o,portalProviderAPI:a,eventDispatcher:r})=>ei(t,o,e.extensionHandlers||{},a,r,i,e.useLongPressSelection,{appearance:e.appearance,getExtensionHeight:e.getExtensionHeight},n,e?.__rendererExtensionOptions)},{name:"extensionKeymap",plugin:()=>(function(e){let t={};return(0,a("hgeg8").bindKeymapWithCommand)(a("hgeg8").escape.common,(t,i)=>!!m(t).showContextPanel&&S(e)(t,i),t),(0,a("dus6D").keymap)(t)})(i?.contextPanel?.actions.applyChange)},{name:"extensionUniqueId",plugin:()=>eg()},{name:"extensionEditorViewRef",plugin:()=>new(0,a("1S4f7").SafePlugin)({view:e=>(l.current=e,{})})},{name:"macro",plugin:({dispatch:e,providerFactory:t})=>j(e,t)}],actions:{api:()=>B({editorView:l.current,applyChange:i?.contextPanel?.actions.applyChange,editorAnalyticsAPI:i?.analytics?.actions}),insertMacroFromMacroBrowser:I(i?.analytics?.actions),insertOrReplaceExtension:({editorView:e,action:t,attrs:i,content:o,position:n,size:a,tr:r})=>V({editorView:e,action:t,attrs:i,content:o,position:n,size:a,tr:r}),insertOrReplaceBodiedExtension:({editorView:e,action:t,attrs:i,content:o,position:n,size:a,tr:r})=>G({editorView:e,action:t,attrs:i,content:o,position:n,size:a,tr:r}),editSelectedExtension:z({editorViewRef:l,editorAnalyticsAPI:i?.analytics?.actions,applyChangeToContextPanel:i?.contextPanel?.actions.applyChange}),runMacroAutoConvert:k,forceAutoSave:w},pluginsOptions:{floatingToolbar:eh({breakoutEnabled:e.breakoutEnabled,extensionApi:i}),contextPanel:s&&(0,a("dh538").fg)("platform_editor_ai_object_sidebar_injection")?void 0:eR(()=>l.current??void 0)(i,n)},usePluginHook:s&&(0,a("dh538").fg)("platform_editor_ai_object_sidebar_injection")?({editorView:e})=>{!function({editorView:e,configPanelId:t,api:i}){let o=e.state,{showContextPanel:n,extensionProvider:r,processParametersAfter:l}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(i,["extension"],eW);(0,eC.useEffect)(()=>{let s=f(o,!0);if(!s)return void eU(t,i);n&&r&&l?function({api:e,configPanelId:t,editorView:i,extensionProvider:o,nodeWithPos:n}){let r=e?.contextPanel?.actions?.showPanel;if(r){let l=n?.node.attrs,s=l?.extensionType,d=l?.extensionKey,[c,p]=(0,a("3jQ9y").getExtensionKeyAndNodeKey)(d,s);r({id:t,headerComponentElements:{HeaderIcon:()=>(0,ea.jsx)(eB,{extensionProvider:o,extensionKey:c,extensionType:s}),HeaderAfterIconElement:()=>(0,ea.jsx)(eM,{extensionProvider:o,extensionKey:c,extensionType:s})},BodyComponent:eF({api:e,editorView:i,extensionProvider:o,nodeWithPos:n}),closeOptions:{canClosePanel:async()=>{if(i.isDestroyed)return!0;let t=m(i.state);return!t?.showContextPanel||(await eH({api:e,editorView:i}),!1)}}},"push",a("7NMV8").CONFIG_PANEL_WIDTH)}}({api:i,configPanelId:t,editorView:e,extensionProvider:r,nodeWithPos:s}):eU(t,i)},[i,t,o,e,n,r,l]),(0,eC.useEffect)(()=>()=>{eU(t,i)},[i,t])}({api:i,configPanelId:o,editorView:e})}:void 0}}}),r("8y1DS",function(e,t){e.exports=a("4mJKd")(5)("eFHVS").then(()=>a("hx1ag"))}),r("7NMV8",function(e,t){e.exports.ALLOWED_LOGGED_MACRO_PARAMS={children:["all","first","depth","style","excerptType","sort","reverse"],"recently-updated":["width","types","max","theme","showProfilePic","hideHeading"],excerpt:["hidden"]},e.exports.ALLOWED_PARAM_TYPES=["enum","number","boolean"],e.exports.CONFIG_PANEL_WIDTH=320,e.exports.CONFIG_PANEL_ID="extensions-panel"}),r("1ux1Z",function(e,t){var i=a("iu6m9");let o={name:"kcqyy5",styles:"display:flex;justify-content:center;margin-top:var(--ds-space-800, 64px)"},n={name:"1siebwf",styles:"margin-top:var(--ds-space-400, 32px)"},r=(0,a("gmMgo").default)(e=>e.error?(0,a("9K4OG").jsx)("div",{css:n,"data-testid":"ConfigPanelLoadingError"},(0,a("9K4OG").jsx)(a("aoVih").default,{appearance:"error"},e.intl.formatMessage(a("5pF33").messages.panelLoadingError))):(0,a("9K4OG").jsx)("div",{css:o,"data-testid":"ConfigPanelLoading"},(0,a("9K4OG").jsx)(a("9hlns").default,{size:"small",interactionName:"config-panel-spinner"}))),l=()=>(0,a("9K4OG").jsx)("div",{css:o,"data-testid":"ConfigPanelLoading"},(0,a("9K4OG").jsx)(a("9hlns").default,{size:"small",interactionName:"config-panel-spinner"}));e.exports.default=e=>(0,i.editorExperiment)("platform_editor_offline_editing_web",!0)?r(e):l()}),r("3prgd",function(e,t){let i=a("4mJKd")(5);e.exports=Promise.all([i("2spqH"),i("gWSdF"),i("6wr18"),i("aeEUI"),i("hRUX7"),i("g4oYs"),i("7EorR"),i("hhss7"),i("ffEVr"),i("djfev")]).then(()=>a("7oBuJ"))}),r("1eYoq",function(e,t){var i=a("42omo");let o=e=>{console.error(e)},n=()=>("undefined"==typeof AbortController&&o("Missing AbortController"),new AbortController);e.exports.useStateFromPromise=function(e,t,o){let a=(0,i.useCallback)(e,t),[r,l]=(0,i.useState)(o);return!function(e,t){let o=(0,i.useMemo)(()=>n(),t),a=(0,i.useCallback)(()=>o.abort(),[o]),r=(0,i.useCallback)(e,t);(0,i.useEffect)(()=>{let e=r(o.signal);return()=>{"function"==typeof e&&e(),a()}},[o,a,r,...t])}(e=>{Promise.resolve(a()).then(t=>{e.aborted||l(t)})},[...t]),[r,l]}}),r("9AGwg",function(e,t){let i=(e,t)=>e.setMeta(a("6SJAP").pluginKey,t);e.exports.resolveCard=e=>t=>i(t,{type:"RESOLVE",url:e}),e.exports.queueCards=e=>t=>i(t,{type:"QUEUE",requests:e}),e.exports.registerCard=e=>t=>i(t,{type:"REGISTER",info:e}),e.exports.removeCard=e=>t=>i(t,{type:"REMOVE_CARD",info:e}),e.exports.registerRemoveOverlay=(e,t)=>o=>i(o,{type:"REGISTER_REMOVE_OVERLAY_ON_INSERTED_LINK",callback:e,info:t}),e.exports.registerSmartCardEvents=e=>t=>i(t,{type:"REGISTER_EVENTS",smartLinkEvents:e}),e.exports.setProvider=e=>t=>i(t,{type:"SET_PROVIDER",provider:e}),e.exports.setDatasourceTableRef=e=>t=>i(t,{type:"SET_DATASOURCE_TABLE_REF",datasourceTableRef:e}),e.exports.setCardLayout=e=>t=>i(t,{type:"SET_CARD_LAYOUT",layout:e}),e.exports.setCardLayoutAndDatasourceTableRef=({layout:e,datasourceTableRef:t})=>o=>i(o,{type:"SET_CARD_LAYOUT_AND_DATASOURCE_TABLE_REF",layout:e,datasourceTableRef:t}),e.exports.showLinkToolbar=e=>i(e,{type:"SHOW_LINK_TOOLBAR"}),e.exports.hideLinkToolbar=e=>i(e,{type:"HIDE_LINK_TOOLBAR"}),e.exports.showDatasourceModal=e=>t=>i(t,{type:"SHOW_DATASOURCE_MODAL",modalType:e}),e.exports.hideDatasourceModal=e=>i(e,{type:"HIDE_DATASOURCE_MODAL"}),e.exports.clearOverlayCandidate=e=>i(e,{type:"CLEAR_OVERLAY_CANDIDATE"}),e.exports.setDatasourceStash=(e,t)=>i(e,{type:"SET_DATASOURCE_STASH",datasourceStash:t}),e.exports.removeDatasourceStash=(e,t)=>i(e,{type:"REMOVE_DATASOURCE_STASH",url:t})}),r("hrFA1",function(e,t){let i=e=>"inlineCard"===e.name?"inline":"blockCard"===e.name?"block":"embedCard"===e.name?"embed":void 0,o=e=>{let{attrs:t}=e;return{url:t.url||t.data&&t.data.url,title:t.data&&t.data.title}},n=(e,t)=>({title:t&&t.title||e.title,url:t&&t.url||e.url}),r=(e,t,i,o)=>{let n=t.doc.resolve(e),a="embed"===o||"block"===o?n.node():n.node(-1);return a&&a.type.validContent(i)},l=(e,t,i)=>r(e,t,a("5SAOw").Fragment.from(t.schema.nodes.embedCard.createChecked({})),i),s=(e,t,i)=>r(e,t,a("5SAOw").Fragment.from(t.schema.nodes.blockCard.createChecked({})),i),d=e=>{if("object"!=typeof e||null===e||!("datasource"in e)||"object"!=typeof e.datasource||null===e.datasource)return!1;let t="id"in e.datasource&&"string"==typeof e.datasource.id,i="parameters"in e.datasource&&"object"==typeof e.datasource.parameters&&null!==e.datasource.parameters&&!Array.isArray(e.datasource.parameters),o="views"in e.datasource&&Array.isArray(e.datasource.views);return t&&i&&o};e.exports.appearanceForNodeType=i,e.exports.selectedCardAppearance=e=>{if(e.selection instanceof a("ks2lK").NodeSelection)return i(e.selection.node.type)},e.exports.titleUrlPairFromNode=o,e.exports.displayInfoForCard=(e,t)=>n(o(e),t),e.exports.findCardInfo=e=>{let t=a("6SJAP").pluginKey.getState(e);if(t)return t.cards.find(t=>t.pos===e.selection.from)},e.exports.isEmbedSupportedAtPosition=l,e.exports.isBlockSupportedAtPosition=s,e.exports.getResolvedAttributesFromStore=(e,t,i)=>{if(!i)return{};let o=i?.getState()[e];return(0,a("1xKpK").getResolvedAttributes)({url:e,displayCategory:"url"===t?"link":void 0},o?.details)},e.exports.isDatasourceConfigEditable=e=>[a("iB8ko").JIRA_LIST_OF_LINKS_DATASOURCE_ID,a("bEi27").ASSETS_LIST_OF_LINKS_DATASOURCE_ID,a("jPEjP").CONFLUENCE_SEARCH_DATASOURCE_ID].includes(e),e.exports.isDatasourceNode=e=>!!e&&"blockCard"===e.type.name&&d(e.attrs),e.exports.focusEditorView=e=>{e.hasFocus()||e.focus()},e.exports.getAwarenessProps=(e,t,i,o,n=!1)=>{let r="boolean"!=typeof t?t:void 0,d=r?.(),c=!!d&&!!i&&l(d,e,"inline"),p=!!d&&!!o&&s(d,e,"inline");return{isPulseEnabled:c,isOverlayEnabled:!n&&(c||p),isSelected:e.selection instanceof a("ks2lK").NodeSelection&&e.selection?.node?.type===e.schema.nodes.inlineCard&&e.selection?.from===r?.()}}}),r("9Rg2N",function(e,i){var o=a("l998X");a("42omo");var n=a("8m4tT"),r=a("iu6m9"),l=a("fezbA"),s=a("iDVNw"),d=a("iVRHt"),c=a("dzW6s"),p=a("lB6pw"),u=a("l1M3D");let h=e=>(0,a("doRn8").commandWithMetadata)((t,i)=>{if(!(t.selection instanceof a("ks2lK").NodeSelection))return!1;let o=t.selection.node.type.name,r={action:a("d925B").ACTION.DELETED,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,actionSubjectId:o,attributes:{inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB,displayMode:o},eventType:a("d925B").EVENT_TYPE.TRACK};if(i){let{tr:o}=t;(0,n.removeSelectedNode)(o),e?.attachAnalyticsEvent(r)(o),i(o)}return!0},{action:a("d925B").ACTION.DELETED}),m=(e,t)=>(i,o)=>{if(!(i.selection instanceof a("ks2lK").NodeSelection))return!1;let{type:n}=i.selection.node;if(o){let{tr:r}=i;e?.attachAnalyticsEvent((0,a("iGbqR").buildVisitedNonHyperLinkPayload)(n.name,t))(r),o(r)}return!0},f=e=>(t,i)=>{if(!(t.selection instanceof a("ks2lK").NodeSelection))return!1;if(i){let{tr:o,selection:{node:{type:n}}}=t;e?.attachAnalyticsEvent((0,a("iGbqR").buildOpenedSettingsPayload)(n.name))(o),i(o)}return!0},g=(e,t,i)=>{let o=(0,a("hrFA1").displayInfoForCard)(e,(0,a("hrFA1").findCardInfo)(t)),n=o.title||o.url;return n?(0,a("doRn8").commandWithMetadata)((0,a("btzjy").changeSelectedCardToText)(n,i),{action:a("d925B").ACTION.UNLINK}):()=>!1},b=(e,t,i,o,n,r)=>r?(0,a("6xEOh").buildLayoutDropdown)(e,t,e.schema.nodes.embedCard,i,o,!0,!0,n?.allowWrapping,n?.allowAlignment):(0,a("6xEOh").default)(e,t,e.schema.nodes.embedCard,i,o,!0,!0,n?.allowWrapping,n?.allowAlignment),E=e=>(0,a("doRn8").commandWithMetadata)(e,{inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB}),T=(e,t)=>e?[{type:"custom",fallback:[],render:i=>(0,o.jsx)(a("hh4Zj").ToolbarViewedEvent,{url:e,display:t,editorView:i},"edit.link.menu.viewed")}]:[],C=(e,i,n,s,d,f,g)=>C=>{let{url:v}=(0,a("hrFA1").titleUrlPairFromNode)(C),{actions:O}=g?.analytics??{},y={};if(v&&!(0,a("81OAa").isSafeUrl)(v))return[];{let{title:t}=(0,a("hrFA1").displayInfoForCard)(C,(0,a("hrFA1").findCardInfo)(e));y={url:v,title:t}}let N=!(0,a("iHzeA").areToolbarFlagsEnabled)(!!g?.toolbar),R=(0,a("hrFA1").appearanceForNodeType)(C.type),{hoverDecoration:x}=g?.decorations?.actions??{},A=(0,a("hrFA1").isDatasourceNode)(C),I=a("6SJAP").pluginKey.getState(e),L=g?.annotation?.sharedState.currentState(),k=C.marks.find(e=>"annotation"===e.type.name&&L?.annotations[e.attrs.id]===!1),M=L&&L.isVisible&&!L.bookmark&&!L.mouseData.isSelecting&&!k&&C.type===e.schema.nodes.inlineCard,D=A&&s.allowDatasource&&(0,a("16GCc").canRenderDatasource)(C?.attrs?.datasource?.id);if(I?.showLinkingToolbar)return[(0,a("8eb8d").buildEditLinkToolbar)({providerFactory:n,linkPicker:f,node:C,pluginInjectionApi:g,lpLinkPicker:d})];{if(D)return w(y,i,O,C,x,C.attrs.datasource.id,e,s,R,g);let{inlineCard:n}=e.schema.nodes,d=s.allowDatasource?[{type:"custom",fallback:[],render:e=>(0,o.jsx)(l.EditToolbarButton,{url:v,intl:i,editorAnalyticsApi:O,editorView:e,onLinkEditClick:(0,a("8eb8d").getEditLinkCallback)(O,!0),currentAppearance:R,areAnyNewToolbarFlagsEnabled:!N},"edit-toolbar-item")}]:[{id:"editor.link.edit",type:"button",selected:!1,metadata:y,title:i.formatMessage(a("ckqYV").linkToolbarMessages.editLink),showTitle:!0,testId:"link-toolbar-edit-link-button",onClick:(0,a("8eb8d").getEditLinkCallback)(O,!0)},{type:"separator"}],f=M?[{id:"editor.link.commentLink",type:"button",icon:t(a("1yB28")),testId:"inline-card-toolbar-comment-button",iconFallback:t(a("3gPdG")),title:i.formatMessage(a("ahUGI").annotationMessages.createComment),showTitle:!(0,r.editorExperiment)("platform_editor_controls","control")||void 0,onClick:(e,t)=>{if(!g?.annotation||!M)return!1;g?.analytics?.actions?.fireAnalyticsEvent({action:a("d925B").ACTION.CLICKED,actionSubject:a("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.CREATE_INLINE_COMMENT_FROM_HIGHLIGHT_ACTIONS_MENU,eventType:a("d925B").EVENT_TYPE.UI,attributes:{source:"highlightActionsMenu",pageMode:"edit",sourceNode:"inlineCard"}});let{setInlineCommentDraftState:i}=g.annotation.actions;return i(!0,a("d925B").INPUT_METHOD.FLOATING_TB)(e,t)},disabled:(0,a("91bcx").isOfflineMode)(g?.connectivity?.sharedState?.currentState()?.mode)},{type:"separator"}]:[],I=a("d925B").INPUT_METHOD.FLOATING_TB,L=s.allowDatasource?[{type:"custom",fallback:[],render:e=>(0,o.jsx)(l.EditToolbarButton,{url:v,intl:i,editorAnalyticsApi:O,editorView:e,onLinkEditClick:(0,a("8eb8d").getEditLinkCallback)(O,!0),currentAppearance:R,areAnyNewToolbarFlagsEnabled:!N},"edit-toolbar-item")}]:[{id:"editor.link.edit",type:"button",selected:!1,metadata:y,title:i.formatMessage(a("ckqYV").linkToolbarMessages.editLink),icon:t(a("1Zr9M")),testId:"link-toolbar-edit-link-button",onClick:(0,a("8eb8d").getEditLinkCallback)(O,!0)}],k=(0,r.editorExperiment)("platform_editor_preview_panel_linking_exp",!0,{exposure:!0})?[{type:"custom",fallback:[],render:()=>(0,o.jsx)(u.OpenPreviewPanelToolbarButton,{node:C,intl:i,editorAnalyticsApi:O,areAnyNewToolbarFlagsEnabled:!N})}]:[],P=N?[...d,...f,...k,{id:"editor.link.openLink",type:"button",icon:t(a("8tdj3")),iconFallback:t(a("8tdj3")),metadata:y,className:"hyperlink-open-link",title:i.formatMessage(a("fpEzC").linkMessages.openLink),onClick:m(O,I),href:v,target:"_blank"},{type:"separator"},..._(e,i,C,n,O,!N),{type:"copy-button",items:[{state:e,formatMessage:i.formatMessage,nodeType:C.type}]},{type:"separator"},S(i,O,s.userPreferencesLink),{type:"separator"},{id:"editor.link.delete",focusEditoronEnter:!0,type:"button",appearance:"danger",icon:t(a("gKvd9")),iconFallback:t(a("gKvd9")),onMouseEnter:x?.(C.type,!0),onMouseLeave:x?.(C.type,!1),onFocus:x?.(C.type,!0),onBlur:x?.(C.type,!1),title:i.formatMessage(a("61p3e").default.remove),onClick:E(h(O))}]:[...L,..._(e,i,C,n,O,!N),{type:"separator",fullHeight:!0},...k,{id:"editor.link.openLink",type:"button",icon:t(a("8tdj3")),iconFallback:t(a("8tdj3")),metadata:y,className:"hyperlink-open-link",title:i.formatMessage(a("fpEzC").linkMessages.openLink),onClick:m(O,I),href:v,target:"_blank"},...f.length>1?[{type:"separator",fullHeight:!0},f[0]]:f];if("embed"===R){let t=b(e,i,g?.width,g?.analytics?.actions,s,!N);t.length&&N&&t.push({type:"separator"}),P.unshift(...t)}let{allowBlockCards:B,allowEmbeds:W,allowDatasource:U,showUpgradeDiscoverability:H}=s;if(R){let t=U&&v;P.unshift(...T(v,R),N?{type:"custom",fallback:[],render:t=>(0,o.jsx)(c.LinkToolbarAppearance,{url:v,intl:i,currentAppearance:R,editorView:t,editorState:e,allowEmbeds:W,allowBlockCards:B,editorAnalyticsApi:O,showUpgradeDiscoverability:H,areAnyNewToolbarFlagsEnabled:!1},"link-appearance")}:(0,p.getLinkAppearanceDropdown)({url:v,intl:i,currentAppearance:R,editorState:e,allowEmbeds:W,allowBlockCards:B,editorAnalyticsApi:O,allowDatasource:s.allowDatasource,showUpgradeDiscoverability:H,settingsConfig:S(i,O,s.userPreferencesLink),isDatasourceView:A,areAnyNewToolbarFlagsEnabled:!N}),...t&&N?[{type:"custom",fallback:[],render:t=>(0,o.jsx)(a("kXd3n").DatasourceAppearanceButton,{intl:i,editorAnalyticsApi:O,url:v,editorView:t,editorState:e,inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB,areAnyNewToolbarFlagsEnabled:!N})}]:[],...N?[{type:"separator"}]:[])}if(!N){let e=(e,t)=>({onMouseEnter:x?.(e,!0,t),onMouseLeave:x?.(e,!1,t),onFocus:x?.(e,!0,t),onBlur:x?.(e,!1,t)}),n=[{type:"separator",fullHeight:!0},{type:"overflow-dropdown",testId:"card-overflow-dropdown-trigger",options:[{title:i.formatMessage(a("61p3e").default.copyToClipboard),onClick:()=>(g?.core?.actions.execute(g?.floatingToolbar?.commands.copyNode(C.type,a("d925B").INPUT_METHOD.FLOATING_TB)),!0),icon:(0,o.jsx)(t(a("2MuFw")),{label:i.formatMessage(a("61p3e").default.copyToClipboard)}),...e(C.type,a("aFUXX").akEditorSelectedNodeClassName)},{title:i.formatMessage(a("61p3e").default.delete),onClick:E(h(O)),icon:(0,o.jsx)(t(a("gKvd9")),{label:i.formatMessage(a("61p3e").default.delete)}),...e(C.type)}]}];P.push(...n)}return P}},_=(e,i,o,n,r,l)=>o.type===n?[{id:"editor.link.unlink",focusEditoronEnter:!0,type:"button",title:i.formatMessage(a("ckqYV").linkToolbarMessages.unlink),icon:t(a("dZMVn")),iconFallback:t(a("dZMVn")),onClick:E(g(o,e,r))},...l?[]:[{type:"separator"}]]:[],S=(e,i,o)=>({id:"editor.link.settings",type:"button",icon:t(a("fIcbd")),iconFallback:t(a("fIcbd")),title:e.formatMessage(a("ckqYV").linkToolbarMessages.settingsLink),onClick:f(i),href:o||(0,a("i9vfM").getLinkPreferencesURLFromENV)(),target:"_blank"}),w=(e,i,n,r,s,d,u,f,g,b)=>{let T=[],C=!(0,a("iHzeA").areToolbarFlagsEnabled)(!!b?.toolbar);if(e.url){let{allowBlockCards:t,allowEmbeds:r,showUpgradeDiscoverability:l}=f,{url:s}=e;C?T.push({type:"custom",fallback:[],render:e=>(0,o.jsx)(c.LinkToolbarAppearance,{url:s,intl:i,currentAppearance:g,editorView:e,editorState:u,allowEmbeds:r,allowBlockCards:t,editorAnalyticsApi:n,showUpgradeDiscoverability:l,isDatasourceView:!0,areAnyNewToolbarFlagsEnabled:!1},"link-appearance")},{type:"custom",fallback:[],render:e=>(0,o.jsx)(a("kXd3n").DatasourceAppearanceButton,{intl:i,editorAnalyticsApi:n,url:s,editorView:e,editorState:u,selected:!0,inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB,areAnyNewToolbarFlagsEnabled:!C})},{type:"separator"}):T.push((0,p.getLinkAppearanceDropdown)({url:s,intl:i,currentAppearance:g,editorState:u,allowEmbeds:r,allowBlockCards:t,editorAnalyticsApi:n,allowDatasource:f.allowDatasource,showUpgradeDiscoverability:l,settingsConfig:S(i,n,f.userPreferencesLink),isDatasourceView:!0,areAnyNewToolbarFlagsEnabled:!C}),{type:"separator"})}let _=a("d925B").INPUT_METHOD.FLOATING_TB;if(T.push({type:"custom",fallback:[],render:t=>(0,o.jsx)(l.EditToolbarButton,{datasourceId:d,node:r,url:e.url,intl:i,editorAnalyticsApi:n,editorView:t,onLinkEditClick:(0,a("8eb8d").getEditLinkCallback)(n,!1),currentAppearance:"datasource",areAnyNewToolbarFlagsEnabled:!C},"edit-toolbar-item")}),r?.attrs?.url&&(T.push({id:"editor.link.openLink",type:"button",icon:t(a("8tdj3")),iconFallback:t(a("8tdj3")),metadata:e,className:"hyperlink-open-link",title:i.formatMessage(a("fpEzC").linkMessages.openLink),onClick:m(n,_),href:r.attrs.url,target:"_blank"}),C&&T.push({type:"separator"})),C)T.push({type:"copy-button",supportsViewMode:!0,items:[{state:u,formatMessage:i.formatMessage,nodeType:r.type}]},{type:"separator"},S(i,n,f?.userPreferencesLink),{type:"separator"},{id:"editor.link.delete",focusEditoronEnter:!0,type:"button",appearance:"danger",icon:t(a("gKvd9")),iconFallback:t(a("gKvd9")),onMouseEnter:s?.(r.type,!0),onMouseLeave:s?.(r.type,!1),onFocus:s?.(r.type,!0),onBlur:s?.(r.type,!1),title:i.formatMessage(a("61p3e").default.remove),onClick:E(h(n))});else{if(!e.url){let e=S(i,n,f?.userPreferencesLink);T.push({type:"separator",fullHeight:!0},e,{type:"separator",fullHeight:!0})}else T.push({type:"separator",fullHeight:!0});let l=[{type:"overflow-dropdown",testId:"datasource-overflow-dropdown-trigger",options:[{title:i.formatMessage(a("61p3e").default.copyToClipboard),onClick:()=>(b?.core?.actions.execute(b?.floatingToolbar?.commands.copyNode(r.type,a("d925B").INPUT_METHOD.FLOATING_TB)),!0),onMouseEnter:s?.(r.type,!0,a("aFUXX").akEditorSelectedNodeClassName),onMouseLeave:s?.(r.type,!1,a("aFUXX").akEditorSelectedNodeClassName),onFocus:s?.(r.type,!0,a("aFUXX").akEditorSelectedNodeClassName),onBlur:s?.(r.type,!1,a("aFUXX").akEditorSelectedNodeClassName),icon:(0,o.jsx)(t(a("2MuFw")),{label:i.formatMessage(a("61p3e").default.copyToClipboard)})},{title:i.formatMessage(a("61p3e").default.delete),onClick:E(h(n)),onMouseEnter:s?.(r.type,!0),onMouseLeave:s?.(r.type,!1),onFocus:s?.(r.type,!0),onBlur:s?.(r.type,!1),icon:(0,o.jsx)(t(a("gKvd9")),{label:i.formatMessage(a("61p3e").default.delete)})}]}];T.push(...l)}return T};e.exports.visitCardLinkAnalytics=m,e.exports.floatingToolbar=(e,t,i,o,l)=>(s,d,c)=>{if(l)return;let{inlineCard:p,blockCard:u,embedCard:h}=s.schema.nodes,m=a("6SJAP").pluginKey.getState(s);if(!(s.selection instanceof a("ks2lK").NodeSelection))return;let f=s.selection.node;if(!f)return;let g="embed"===(0,a("hrFA1").appearanceForNodeType)(f.type),b=m?.showLinkingToolbar?a("0vvte").FLOATING_TOOLBAR_LINKPICKER_CLASSNAME:void 0,E=!!t;return{title:d.formatMessage(a("3RxtY").messages.card),className:b,nodeType:[p,u,h],preventPopupOverflow:E,...g?{offset:[0,24]}:{},getDomRef:e=>{let t=(0,n.findDomRefAtPos)(e.state.selection.from,e.domAtPos.bind(e));if(t){if(g){let e=t.querySelector(`.${a("gnMzP").richMediaClassName}`);if(!(0,r.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})||e)return e}return t}},items:C(s,d,c,e,t,i,o),scrollable:!m?.showLinkingToolbar,...(0,a("8eb8d").editLinkToolbarConfig)(!!m?.showLinkingToolbar,E)}},e.exports.shouldRenderToolbarPulse=(e,t,i,o)=>e&&"inline"===t&&"resolved"===i&&o,e.exports.getStartingToolbarItems=(e,i)=>(n,c,p,u,h)=>{let m=!(0,a("iHzeA").areToolbarFlagsEnabled)(!!i?.toolbar),f=e.allowDatasource?[{type:"custom",fallback:[],render:e=>e?(0,o.jsx)(l.EditToolbarButton,{intl:n,editorAnalyticsApi:i?.analytics?.actions,url:c,editorView:e,onLinkEditClick:p,currentAppearance:"url",areAnyNewToolbarFlagsEnabled:!m},"edit-toolbar-button"):null}]:[{id:"editor.link.edit",testId:"editor.link.edit",type:"button",onClick:p,title:n.formatMessage(a("ckqYV").linkToolbarMessages.editLink),showTitle:!(0,r.editorExperiment)("platform_editor_controls","variant1"),metadata:u,icon:(0,r.editorExperiment)("platform_editor_controls","variant1")?t(a("1Zr9M")):void 0},{type:"separator"}];return m?[{type:"custom",fallback:[],render:e=>(0,o.jsx)(a("hh4Zj").ToolbarViewedEvent,{url:c,display:"url",editorView:e},"edit.link.menu.viewed")},{type:"custom",fallback:[],render:t=>t?(0,o.jsx)(s.HyperlinkToolbarAppearance,{url:c,intl:n,editorView:t,editorState:t.state,cardOptions:e,editorAnalyticsApi:i?.analytics?.actions,editorPluginApi:i},"link-appearance"):null},...f]:[{type:"custom",fallback:[],render:e=>(0,o.jsx)(a("hh4Zj").ToolbarViewedEvent,{url:c,display:"url",editorView:e},"edit.link.menu.viewed")},(0,d.getCustomHyperlinkAppearanceDropdown)({url:c,intl:n,editorAnalyticsApi:i?.analytics?.actions,allowDatasource:e.allowDatasource,editorPluginApi:i,cardOptions:e,settingsConfig:S(n,i?.analytics?.actions,e.userPreferencesLink),isDatasourceView:!1}),...f]},e.exports.getEndingToolbarItems=(e,t)=>(i,o)=>(e.provider||e.userPreferencesLink)&&!(0,a("iHzeA").areToolbarFlagsEnabled)(!!t?.toolbar)?[{type:"separator"},S(i,t?.analytics?.actions,e.userPreferencesLink)]:[]}),r("btzjy",function(e,i){var o=a("a4TK8"),n=a("iu6m9");let r=(e,t,i,o,n=!0,r,l)=>{let{schema:s}=e,{link:d}=s.marks,c=[];return(0,a("2pjJ5").nodesBetweenChanged)(t,(e,t)=>{if(!e.isText)return!0;let s=e.marks.find(e=>e.type===d);if(s){if(!(0,a("1yFQS").shouldReplaceLink)(e,n))return!1;c.push({url:s.attrs.href,pos:t,appearance:"inline",previousAppearance:l,compareLinkText:n,source:i,analyticsAction:o,sourceEvent:r})}return!1}),(0,a("doRn8").addLinkMetadata)(e.selection,t,{action:o}),(0,a("9AGwg").queueCards)(c)(t)},l=(e,t,i,o=!0)=>{let{schema:r}=e,{link:l}=r.marks,s=[],d=(e,n)=>({url:e.attrs.href,pos:n,appearance:i,previousAppearance:"url",compareLinkText:o,source:t,analyticsAction:a("d925B").ACTION.CHANGED_TYPE,shouldReplaceLink:!0});if((0,n.editorExperiment)("platform_editor_controls","variant1")){let t=(0,a("i9vfM").getActiveLinkMark)(e);if(t){let e=t.node.marks.find(e=>e.type===l);e&&s.push(d(e,t.pos))}}else e.tr.doc.nodesBetween(e.selection.from,e.selection.to,(e,t)=>{let i=e.marks.find(e=>e.type===l);i&&s.push(d(i,t))});return(0,a("doRn8").addLinkMetadata)(e.selection,e.tr,{action:a("d925B").ACTION.CHANGED_TYPE}),(0,a("9AGwg").queueCards)(s)(e.tr)};function s(e,t,i){let o=e.selection instanceof a("ks2lK").NodeSelection&&e.selection.node;if(!o)return e.tr;let{link:n}=e.schema.marks,r=o.attrs.url||o.attrs.data.url;return e.tr.replaceSelectionWith(e.schema.text(t||r,[n.create({href:i||r})]),!1)}function d(e,t,i,o,n){let{link:a}=e.schema.marks,r=o.attrs.url||o.attrs.data.url;return e.tr.replaceWith(n,n+o.nodeSize,e.schema.text(t||r,[a.create({href:i||r})]))}let c=(e,t)=>{switch(e){case"inline":return t.inlineCard;case"block":return t.blockCard;case"embed":return t.embedCard}},p=(e,t)=>"embed"===e?{...t.attrs,layout:"center"}:(0,a("hrFA1").isDatasourceNode)(t)?{url:t.attrs.url}:t.attrs,u=(e,t)=>{(0,a("hrFA1").isDatasourceNode)(t)&&!(0,a("hrFA1").isDatasourceConfigEditable)(t.attrs.datasource.id)&&t.attrs.url&&(0,a("9AGwg").setDatasourceStash)(e,{url:t.attrs.url,views:t.attrs.datasource.views})};e.exports.replaceQueuedUrlWithCard=(e,t,i,o,n)=>(r,l)=>{let s=a("6SJAP").pluginKey.getState(r);if(!s)return!1;let d=s.requests.filter(t=>t.url===e),c=r.schema,p=(0,a("6tl2G").processRawValue)(c,t),u=r.tr;if(p){let t=d.map(e=>(function(e,t,i,o){let{inlineCard:n}=i.nodes,{url:r}=o;if(!(0,a("81OAa").isSafeUrl)(r))return;let l=e.mapping.map(o.pos),s=e.doc.resolve(l),d=e.selection.$head,c=e.doc.nodeAt(l);if(!c||!c.type.isText||!(o.shouldReplaceLink||(0,a("1yFQS").shouldReplaceLink)(c,o.compareLinkText,r)))return;let p=[t];t.type===n&&p.push(i.text(" ")),e.replaceWith(l,l+(c.text||r).length,p);let u=(0,a("bYZ53").getAnnotationMarksForPos)(d);return u&&u.length>0&&u.forEach(t=>{e.addMark(l,l+p[0].nodeSize+p[1].nodeSize,t)}),s.node(s.depth-1).type.name})(u,p,c,e)).filter(e=>!!e);if(t.length){let l=t.every(e=>e===t[0])?t[0]:"mixed",[,,c]=e.split("/");s.smartLinkEvents&&s.smartLinkEvents.insertSmartLink(c,"inline",n);let p=d[0].source,h=d[0].sourceEvent;o?.attachAnalyticsEvent({action:i||a("d925B").ACTION.INSERTED,actionSubject:a("d925B").ACTION_SUBJECT.DOCUMENT,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.SMART_LINK,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{inputMethod:p,nodeType:"inlineCard",nodeContext:l,fromCurrentDomain:(0,a("b0F8r").isFromCurrentDomain)(e)},nonPrivacySafeAttributes:{domainName:c}})(u),(0,a("doRn8").addLinkMetadata)(r.selection,u,{action:i,inputMethod:p,cardAction:"RESOLVE",sourceEvent:h})}}return l&&l((0,a("9AGwg").resolveCard)(e)((0,a("ke2AI").closeHistory)(u))),!0},e.exports.handleFallbackWithAnalytics=(e,t)=>(i,o)=>{if(!a("6SJAP").pluginKey.getState(i))return!1;let n=i.tr;return e.source!==a("d925B").INPUT_METHOD.FLOATING_TB&&t?.attachAnalyticsEvent((0,a("b0F8r").getLinkCreationAnalyticsEvent)(e.source,e.url))(n),(0,a("doRn8").addLinkMetadata)(i.selection,n,{action:e.analyticsAction,inputMethod:e.source,sourceEvent:e.sourceEvent}),o&&o((0,a("9AGwg").resolveCard)(e.url)(n)),!0},e.exports.queueCardsFromChangedTr=(e,t,i,o,n=!0,r,l="inline")=>{let{schema:s}=e,{link:d}=s.marks,c=[];return(0,a("2pjJ5").nodesBetweenChanged)(t,(e,t)=>{if(!e.isText)return!0;let s=e.marks.find(e=>e.type===d);if(s){if(!(0,a("1yFQS").shouldReplaceLink)(e,n))return!1;c.push({url:s.attrs.href,pos:t,appearance:l,compareLinkText:n,source:i,analyticsAction:o,sourceEvent:r})}return!1}),o&&(0,a("doRn8").addLinkMetadata)(e.selection,t,{action:o}),(0,a("9AGwg").queueCards)(c)(t)},e.exports.changeSelectedCardToLink=(e,t,i,o,n,r)=>(l,c)=>{let p,h=l.selection instanceof a("ks2lK").NodeSelection?l.selection.node:void 0;return u(p=o&&n?d(l,e,t,o,n):s(l,e,t),h),i&&h&&r?.attachAnalyticsEvent({action:a("d925B").ACTION.CHANGED_TYPE,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{newType:a("eKaDU").SMART_LINK_TYPE.URL,previousType:(0,a("hrFA1").appearanceForNodeType)(h.type)}})(p),c&&c(p.scrollIntoView()),!0},e.exports.changeSelectedCardToLinkFallback=(e,t,i,o,n,r)=>(l,c)=>{let p;return p=o&&n?d(l,e,t,o,n):s(l,e,t),i&&r?.attachAnalyticsEvent({action:a("d925B").ACTION.ERRORED,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,eventType:a("d925B").EVENT_TYPE.OPERATIONAL,attributes:{error:"Smart card falling back to link."}})(p),c&&c((0,a("dh538").fg)("platform_editor_ai_generic_prep_for_aifc")?p.setMeta("addToHistory",!1):p.scrollIntoView()),!0},e.exports.updateCard=(e,t)=>(i,o)=>{if(!(i.selection instanceof a("ks2lK").NodeSelection&&i.selection.node))return!1;let n=(0,a("hrFA1").selectedCardAppearance)(i),l=s(i,e,e);return r(i,l,a("d925B").INPUT_METHOD.MANUAL,a("d925B").ACTION.UPDATED,void 0,t,n),o&&o(l.scrollIntoView()),!0},e.exports.changeSelectedCardToText=(e,t)=>(i,o)=>{if(!(i.selection instanceof a("ks2lK").NodeSelection&&i.selection.node))return!1;let n=i.tr.replaceSelectionWith(i.schema.text(e),!1);return o&&((0,a("doRn8").addLinkMetadata)(i.selection,n,{action:a("d925B").ACTION.UNLINK}),n.scrollIntoView(),t?.attachAnalyticsEvent((0,a("iGbqR").unlinkPayload)(a("d925B").ACTION_SUBJECT_ID.CARD_INLINE))(n),o(n)),!0},e.exports.setSelectedCardAppearance=(e,t)=>(i,o)=>{let n=i.selection instanceof a("ks2lK").NodeSelection?i.selection.node:void 0;if(!n){let t=l(i,a("d925B").INPUT_METHOD.FLOATING_TB,e);return o&&((0,a("doRn8").addLinkMetadata)(i.selection,t,{action:a("d925B").ACTION.CHANGED_TYPE}),o(t.scrollIntoView())),!1}if((0,a("hrFA1").appearanceForNodeType)(n.type)===e&&!n.attrs.datasource)return!1;let r=p(e,n),{from:s,to:d}=i.selection,h=c(e,i.schema.nodes),m=i.tr.setNodeMarkup(s,h,r,n.marks);u(m,n),m.doc.nodeSize-2===d&&m.insertText(" ",d),m.setSelection(a("ks2lK").TextSelection.create(m.doc,d+1));let f=s-1>0?s-1:0,g=m.doc.nodeAt(f);return g?.type?.name==="paragraph"&&m.delete(f,s),t?.attachAnalyticsEvent({action:a("d925B").ACTION.CHANGED_TYPE,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,eventType:a("d925B").EVENT_TYPE.TRACK,attributes:{newType:e,previousType:(0,a("hrFA1").appearanceForNodeType)(n.type)}})(m),(0,a("doRn8").addLinkMetadata)(i.selection,m,{action:a("d925B").ACTION.CHANGED_TYPE}),o&&o(m.scrollIntoView()),!0},e.exports.updateCardViaDatasource=e=>{let{state:i,node:n,newAdf:r,view:l,sourceEvent:s,isDeletingConfig:d,inputMethod:c}=e,{tr:p,selection:{from:u,to:h},schema:{nodes:m}}=i;if("blockCard"===r.type)if(n.attrs?.datasource&&r.attrs?.datasource){let e=r.attrs,i=n.attrs,[a]=e.datasource.views??[],[l]=i.datasource.views??[],s=!t(o)(l?.properties?.columns,a?.properties?.columns),d=e.url!==i.url;(s||d)&&p.setNodeMarkup(u,m.blockCard,{...i,...r.attrs})}else if(n.type.isText){let e;if(i.doc.nodesBetween(u,h,(t,o)=>{let n=t.marks.find(e=>e.type===i.schema.marks.link);return!n||(e={url:n.attrs.href,text:t.text,pos:o},!1)}),e){let t=m.blockCard.createChecked(r.attrs);p.replaceWith(e.pos,e.pos+(e.text||e.url).length,[t])}}else p.setNodeMarkup(u,m.blockCard,r.attrs);else"inlineCard"===r.type&&p.setNodeMarkup(u,m.inlineCard,r.attrs);(0,a("doRn8").addLinkMetadata)(i.selection,p,{action:a("d925B").ACTION.UPDATED,sourceEvent:s,inputMethod:c}),d?"string"==typeof n.attrs.url&&(0,a("9AGwg").removeDatasourceStash)(p,n.attrs.url):(0,a("9AGwg").hideDatasourceModal)(p),l.dispatch(p.scrollIntoView())},e.exports.insertDatasource=(e,t,i,o)=>{let{tr:n,selection:{from:r},schema:{nodes:l}}=e,{attrs:s,type:d}=t,c=("inlineCard"===d?l.inlineCard:l.blockCard).createChecked(s);c&&n.insert(r,c),(0,a("9AGwg").hideDatasourceModal)(n),(0,a("doRn8").addLinkMetadata)(e.selection,n,{action:a("d925B").ACTION.INSERTED,sourceEvent:o}),i.dispatch(n.scrollIntoView())}}),r("22wcR",function(e,t){let i=(e,t)=>e.url===t.url&&e.pos===t.pos;e.exports.getPluginState=e=>a("6SJAP").pluginKey.getState(e),e.exports.getPluginStateWithUpdatedPos=(e,t)=>({...e,requests:e.requests.map(e=>({...e,pos:t.mapping.map(e.pos)})),cards:e.cards.map(e=>({...e,pos:t.mapping.map(e.pos)}))}),e.exports.getNewRequests=(e,t)=>e?t.requests.filter(t=>!e.requests.find(e=>i(e,t))):t.requests}),r("aLPDZ",function(e,t){var i=a("l998X");a("42omo"),e.exports.WithCardContext=({children:e})=>{let t=(0,a("eIleF").useSmartCardContext)();return(0,i.jsx)(i.Fragment,{children:e(t)})}}),r("6SJAP",function(e,t){let i=new(0,a("ks2lK").PluginKey)("cardPlugin");e.exports.pluginKey=i}),r("5v798",function(e,t){let i="discovered",o=new(0,a("kt8c2").default)("@atlaskit/editor-plugin-card");e.exports.LOCAL_STORAGE_DISCOVERY_KEY_SMART_LINK="smart-link-upgrade-pulse",e.exports.LOCAL_STORAGE_DISCOVERY_KEY_TOOLBAR="toolbar-upgrade-pulse",e.exports.ONE_DAY_IN_MILLISECONDS=864e5,e.exports.isLocalStorageKeyDiscovered=e=>{try{let t=o.getItem(e);return!!t&&t===i}catch{return!0}},e.exports.markLocalStorageKeyDiscovered=(e,t)=>{try{o.setItemWithExpiry(e,i,t)}catch{}}}),r("jqKkl",function(e,t){var i=a("l998X"),o=a("42omo");e.exports.DiscoveryPulse=({children:e,localStorageKey:t,localStorageKeyExpirationInMs:n,discoveryMode:r="iteration",shouldShowPulse:l,testId:s,isInline:d})=>{let c=(0,a("5v798").isLocalStorageKeyDiscovered)(t),p=l??!c,{createAnalyticsEvent:u}=(0,a("inPa6").useAnalyticsEvents)();(0,o.useEffect)(()=>{p&&u({action:"viewed",actionSubject:"pulse",eventType:"ui",attributes:{pulseIdentifier:t}}).fire("media")},[u,c,t,p]);let h=(0,o.useCallback)(()=>{c||(0,a("5v798").markLocalStorageKeyDiscovered)(t,n)},[c,t,n]);return(0,i.jsx)(a("7dJ3M").Pulse,{onAnimationIteration:"iteration"===r?h:void 0,onAnimationStart:"start"===r?h:void 0,showPulse:p,testId:s,isInline:d,children:e})}}),r("0vvte",function(e,t){e.exports.DATASOURCE_INNER_CONTAINER_CLASSNAME="datasourceView-content-inner-wrap",e.exports.FLOATING_TOOLBAR_LINKPICKER_CLASSNAME="card-floating-toolbar--link-picker"}),r("dQwlz",function(e,i){var o=a("l998X"),n=a("42omo");class r extends t(n).Component{static getDerivedStateFromError(e){return{isError:!0,error:e}}componentDidCatch(e){this.props.handleError&&this.props.handleError(),this.state.isError&&this.setState({isError:!0,error:e})}render(){let{url:e,unsupportedComponent:t,view:i,datasourceModalType:n,datasourceId:r}=this.props;if(!this.state.isError)return this.props.children;if(e&&(0,a("81OAa").isSafeUrl)(e))return(0,o.jsx)(a("fBAKC").LazyLoadedDatasourceRenderFailedAnalyticsWrapper,{datasourceId:r,error:this.state.error,children:(0,a("btzjy").setSelectedCardAppearance)("inline",void 0)(i.state,i.dispatch)});{let e=t?(0,o.jsx)(t,{}):null;return(0,o.jsx)(a("fBAKC").LazyLoadedDatasourceRenderFailedAnalyticsWrapper,{datasourceModalType:n,datasourceId:r,error:this.state.error,children:e})}}constructor(...e){super(...e),this.state={isError:!1,error:null}}}e.exports.DatasourceErrorBoundary=r}),r("aJdNi",function(e,t){var i=a("l998X");a("42omo"),e.exports.EditorAnalyticsContext=({editorView:e,children:t})=>{let o=e?(0,a("22wcR").getPluginState)(e.state)?.editorAppearance:void 0,n=(0,a("lWghV").getAnalyticsEditorAppearance)(o);return(0,i.jsx)(a("bYRk6").default,{data:{attributes:{location:n},location:n},children:t})}}),r("cOfDZ",function(e,i){var o=a("l998X"),n=a("42omo");let r=new Map,l=({pluginInjectionApi:e,url:t,onClickCallback:i,children:r})=>{let{mode:l}=(0,a("eiA8Z").useSharedPluginStateWithSelector)(e,["editorViewMode"],e=>({mode:e.editorViewModeState?.mode})),s=(0,n.useCallback)(e=>{if("function"==typeof i)try{i({event:e,url:t})}catch{}},[t,i]),d="view"===l&&!i;return(0,o.jsx)(o.Fragment,{children:r({onClick:d?void 0:s})})};e.exports.Card=function(e,i){return class extends t(n).Component{render(){let{pluginInjectionApi:t,onClickCallback:n}=this.props,{url:r}=(0,a("hrFA1").titleUrlPairFromNode)(this.props.node);if(r&&!(0,a("81OAa").isSafeUrl)(r))return(0,o.jsx)(i,{});if(this.state.isError)if(r)return(0,a("dh538").fg)("dst-a11y__replace-anchor-with-link__linking-platfo")?(0,o.jsx)(a("2Nwuj").default,{href:r,onClick:e=>{e.preventDefault()},children:r}):(0,o.jsx)("a",{href:r,onClick:e=>{e.preventDefault()},children:r});else return(0,o.jsx)(i,{});let s=(0,a("22wcR").getPluginState)(this.props.view.state)?.editorAppearance,d=(0,a("lWghV").getAnalyticsEditorAppearance)(s);return(0,o.jsx)(a("bYRk6").default,{data:{attributes:{location:d},location:d},children:(0,o.jsx)(l,{pluginInjectionApi:t,onClickCallback:n,url:r,children:({onClick:t})=>(0,o.jsx)(a("aLPDZ").WithCardContext,{children:i=>(0,o.jsx)(e,{cardContext:i,...this.props,onClick:t},r)})})})}componentDidCatch(e){if(e.kind&&"fatal"===e.kind){this.setState({isError:!0});let{view:e,node:t,getPos:i,pluginInjectionApi:o}=this.props,{url:n}=(0,a("hrFA1").titleUrlPairFromNode)(t);if(!i||"boolean"==typeof i)return;let l=i();return n&&l&&r.get(n)===l&&(0,a("dh538").fg)("platform_editor_ai_generic_prep_for_aifc_2")||((0,a("btzjy").changeSelectedCardToLinkFallback)(void 0,n,!0,t,i(),o?.analytics?.actions)(e.state,e.dispatch),n&&l&&(0,a("dh538").fg)("platform_editor_ai_generic_prep_for_aifc_2")&&r.set(n,l)),null}this.setState({isError:!0})}constructor(...e){super(...e),this.state={isError:!1}}}}}),r("9MZd8",function(e,t){var i,o=e.exports&&e.exports.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),n=e.exports&&e.exports.__assign||function(){return(n=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},r=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t},l=e.exports&&e.exports.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e.exports,"__esModule",{value:!0});var s=r(a("42omo")),d=a("9QE25"),c=l(a("hdx2V")),p={width:"auto",height:"auto"},u=c.default(function(e,t,i){return Math.max(Math.min(e,i),t)}),h=c.default(function(e,t){return Math.round(e/t)*t}),m=c.default(function(e,t){return RegExp(e,"i").test(t)}),f=c.default(function(e,t,i){void 0===i&&(i=0);var o=t.reduce(function(i,o,n){return Math.abs(o-e)<Math.abs(t[i]-e)?n:i},0),n=Math.abs(t[o]-e);return 0===i||n<i?t[o]:e}),g=c.default(function(e,t){return e.substr(e.length-t.length,t.length)===t}),b=c.default(function(e){return"auto"===(e=e.toString())||g(e,"px")||g(e,"%")||g(e,"vh")||g(e,"vw")||g(e,"vmax")||g(e,"vmin")?e:e+"px"}),E=c.default(function(e,t,i,o,n){if(t&&"string"==typeof t&&g(t,"%")){var a=Number(t.replace("%",""))/100;t=e.width*a}if(i&&"string"==typeof i&&g(i,"%")){var a=Number(i.replace("%",""))/100;i=e.height*a}if(o&&"string"==typeof o&&g(o,"%")){var a=Number(o.replace("%",""))/100;o=e.width*a}if(n&&"string"==typeof n&&g(n,"%")){var a=Number(n.replace("%",""))/100;n=e.height*a}return{maxWidth:void 0===t?void 0:Number(t),maxHeight:void 0===i?void 0:Number(i),minWidth:void 0===o?void 0:Number(o),minHeight:void 0===n?void 0:Number(n)}}),T=["style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],C="__resizable_base__",_=function(e){function t(t){var i=e.call(this,t)||this;return i.ratio=1,i.resizable=null,i.parentLeft=0,i.parentTop=0,i.resizableLeft=0,i.resizableTop=0,i.targetLeft=0,i.targetTop=0,i.state={isResizing:!1,resizeCursor:"auto",width:void 0===(i.propsSize&&i.propsSize.width)?"auto":i.propsSize&&i.propsSize.width,height:void 0===(i.propsSize&&i.propsSize.height)?"auto":i.propsSize&&i.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0}},i.onResizeStart=i.onResizeStart.bind(i),i.onMouseMove=i.onMouseMove.bind(i),i.onMouseUp=i.onMouseUp.bind(i),"undefined"!=typeof window&&(window.addEventListener("mouseup",i.onMouseUp),window.addEventListener("mousemove",i.onMouseMove),window.addEventListener("mouseleave",i.onMouseUp),window.addEventListener("touchmove",i.onMouseMove),window.addEventListener("touchend",i.onMouseUp)),i}return o(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||p},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=[].slice.call(e.children),i=0;i<t.length;i++){var o=t[i];if(o instanceof HTMLElement&&o.classList.contains(C))return o}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if("undefined"!=typeof window&&this.resizable){var i=this.resizable.offsetWidth,o=this.resizable.offsetHeight,n=this.resizable.style.position;"relative"!==n&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:i,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:o,this.resizable.style.position=n}return{width:e,height:t}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,i=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&g(e.propsSize[t].toString(),"%")){if(g(e.state[t].toString(),"%"))return e.state[t].toString();var i=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/i[t]*100+"%"}return b(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?b(t.width):i("width"),height:t&&void 0!==t.height&&!this.state.isResizing?b(t.height):i("height")}},enumerable:!0,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return{width:window.innerWidth,height:window.innerHeight};var e=!1,t=this.parentNode.style.flexWrap,i=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var o={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=i,o},t.prototype.componentDidMount=function(){this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height});var e=this.parentNode;if(e instanceof HTMLElement&&!this.base){var t=document.createElement("div");t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0",t.classList?t.classList.add(C):t.className+=C,e.appendChild(t)}},t.prototype.componentWillUnmount=function(){if("undefined"!=typeof window){window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseleave",this.onMouseUp),window.removeEventListener("touchmove",this.onMouseMove),window.removeEventListener("touchend",this.onMouseUp);var e=this.parentNode;this.base&&e&&e instanceof HTMLElement&&this.base instanceof Node&&e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var i=this.propsSize&&this.propsSize[t];return"auto"===this.state[t]&&this.state.original[t]===e&&(void 0===i||"auto"===i)?"auto":e},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var i=this.parentNode;if(i instanceof HTMLElement){var o=i.offsetWidth+(this.parentLeft-this.resizableLeft),n=i.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<n?t:n}}else if("window"===this.props.bounds){if("undefined"!=typeof window){var o=window.innerWidth-this.resizableLeft,n=window.innerHeight-this.resizableTop;e=e&&e<o?e:o,t=t&&t<n?t:n}}else if(this.props.bounds instanceof HTMLElement){var o=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),n=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<n?t:n}return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var i=this.props.scale||1,o=this.props.resizeRatio||1,n=this.state,a=n.direction,r=n.original,l=this.props,s=l.lockAspectRatio,d=l.lockAspectRatioExtraHeight,c=l.lockAspectRatioExtraWidth,p=r.width,u=r.height,h=d||0,f=c||0;return m("right",a)&&(p=r.width+(e-r.x)*o/i,s&&(u=(p-f)/this.ratio+h)),m("left",a)&&(p=r.width-(e-r.x)*o/i,s&&(u=(p-f)/this.ratio+h)),m("bottom",a)&&(u=r.height+(t-r.y)*o/i,s&&(p=(u-h)*this.ratio+f)),m("top",a)&&(u=r.height-(t-r.y)*o/i,s&&(p=(u-h)*this.ratio+f)),{newWidth:p,newHeight:u}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,i,o){var n=this.props,a=n.lockAspectRatio,r=n.lockAspectRatioExtraHeight,l=n.lockAspectRatioExtraWidth,s=void 0===o.width?10:o.width,d=void 0===i.width||i.width<0?e:i.width,c=void 0===o.height?10:o.height,p=void 0===i.height||i.height<0?t:i.height,h=r||0,m=l||0;if(a){var f=(c-h)*this.ratio+m,g=(p-h)*this.ratio+m,b=(s-m)/this.ratio+h,E=(d-m)/this.ratio+h,T=Math.max(c,b),C=Math.min(p,E);e=u(e,Math.max(s,f),Math.min(d,g)),t=u(t,T,C)}else e=u(e,s,d),t=u(t,c,p);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e instanceof HTMLElement){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds instanceof HTMLElement){var i=this.props.bounds.getBoundingClientRect();this.targetLeft=i.left,this.targetTop=i.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),n=o.left,a=o.top;this.resizableLeft=n,this.resizableTop=a}},t.prototype.onResizeStart=function(e,t){var i=0,o=0;if(e.nativeEvent instanceof MouseEvent){if(i=e.nativeEvent.clientX,o=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent instanceof TouchEvent&&(i=e.nativeEvent.touches[0].clientX,o=e.nativeEvent.touches[0].clientY);this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable)||(this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height,this.setBoundingClientRect(),this.setState({original:{x:i,y:o,width:this.size.width,height:this.size.height},isResizing:!0,resizeCursor:window.getComputedStyle(e.target).cursor||"auto",direction:t}))},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable){var t=this.props,i=t.maxWidth,o=t.maxHeight,n=t.minWidth,a=t.minHeight,r=e instanceof MouseEvent?e.clientX:e.touches[0].clientX,l=e instanceof MouseEvent?e.clientY:e.touches[0].clientY,s=this.state,d=s.direction,c=s.original,p=s.width,u=s.height,m=this.getParentSize(),b=E(m,i,o,n,a);i=b.maxWidth,o=b.maxHeight,n=b.minWidth,a=b.minHeight;var T=this.calculateNewSizeFromDirection(r,l),C=T.newHeight,_=T.newWidth,S=this.calculateNewMaxFromBoundary(i,o),w=this.calculateNewSizeFromAspectRatio(_,C,{width:S.maxWidth,height:S.maxHeight},{width:n,height:a});if(_=w.newWidth,C=w.newHeight,this.props.grid){var v=h(_,this.props.grid[0]),O=h(C,this.props.grid[1]),y=this.props.snapGap||0;_=0===y||Math.abs(v-_)<=y?v:_,C=0===y||Math.abs(O-C)<=y?O:C}this.props.snap&&this.props.snap.x&&(_=f(_,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(C=f(C,this.props.snap.y,this.props.snapGap));var N={width:_-c.width,height:C-c.height};if(p&&"string"==typeof p){if(g(p,"%")){var R=_/m.width*100;_=R+"%"}else if(g(p,"vw")){var x=_/window.innerWidth*100;_=x+"vw"}else if(g(p,"vh")){var A=_/window.innerHeight*100;_=A+"vh"}}if(u&&"string"==typeof u){if(g(u,"%")){var R=C/m.height*100;C=R+"%"}else if(g(u,"vw")){var x=C/window.innerWidth*100;C=x+"vw"}else if(g(u,"vh")){var A=C/window.innerHeight*100;C=A+"vh"}}this.setState({width:this.createSizeForCssProperty(_,"width"),height:this.createSizeForCssProperty(C,"height")}),this.props.onResize&&this.props.onResize(e,d,this.resizable,N)}},t.prototype.onMouseUp=function(e){var t=this.state,i=t.isResizing,o=t.direction,n=t.original;if(i&&this.resizable){var a={width:this.size.width-n.width,height:this.size.height-n.height};this.props.onResizeStop&&this.props.onResizeStop(e,o,this.resizable,a),this.props.size&&this.setState(this.props.size),this.setState({isResizing:!1,resizeCursor:"auto"})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,i=t.enable,o=t.handleStyles,n=t.handleClasses,a=t.handleWrapperStyle,r=t.handleWrapperClass,l=t.handleComponent;if(!i)return null;var c=Object.keys(i).map(function(t){return!1!==i[t]?s.createElement(d.Resizer,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:o&&o[t],className:n&&n[t]},l&&l[t]?l[t]:null):null});return s.createElement("span",{className:r,style:a},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce(function(t,i){return -1!==T.indexOf(i)||(t[i]=e.props[i]),t},{});return s.createElement("div",n({ref:function(t){t&&(e.resizable=t)},style:n({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style,this.sizeStyle,{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box"}),className:this.props.className},t),this.state.isResizing&&s.createElement("div",{style:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:""+(this.state.resizeCursor||"auto"),opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"}}),this.props.children,this.renderResizer())},t.defaultProps={onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(s.PureComponent);e.exports.Resizable=_}),r("8usfh",function(e,t){e.exports.cloneTr=e=>Object.assign(Object.create(e),e).setTime(Date.now())}),r("9b9Mr",function(e,t){function i(e,t,i){let o=(0,a("d1kIV").tableNodeTypes)(t.type.schema).header_cell;for(let n=0;n<e.height;n++){let a=t.nodeAt(e.map[i+n*e.width]);if(a&&a.type!==o)return!1}return!0}e.exports.columnIsHeader=i,e.exports.addColumn=function(e,{map:t,tableStart:o,table:n},r){let l=r>0?-1:0;i(t,n,r+l)&&(l=0===r||r===t.width?null:0);for(let i=0;i<t.height;i++){let s=i*t.width+r;if(r>0&&r<t.width&&t.map[s-1]===t.map[s]){let l=t.map[s],d=n.nodeAt(l);if(!d)throw Error(`addColumn: invalid cell for pos ${l}`);let c=d.attrs;(0,a("jl382").assertColspan)(c),e.setNodeMarkup(e.mapping.map(o+l),void 0,(0,a("jl382").addColSpan)(c,r-t.colCount(l))),i+=c.rowspan-1}else{let d,c={};if(null===l)d=(0,a("d1kIV").tableNodeTypes)(n.type.schema).cell;else{let e=t.map[s+l],i=n.nodeAt(e);if(!i)throw Error(`addColumn: invalid node at mapped pos ${e}`);d=i.type,i.attrs.background&&(c={background:i.attrs.background})}let p=t.positionAt(i,r,n);e.insert(e.mapping.map(o+p),d.createAndFill(c))}}return e}}),r("kXd3n",function(e,t){var i=a("42omo");let o={name:"1quw0ni",styles:"pointer-events:auto"},n=({cardContext:e,intl:t,url:n,editorView:r,editorState:l,selected:s,inputMethod:d,areAnyNewToolbarFlagsEnabled:c})=>{let{datasourceId:p,parameters:u}=(0,a("8dcLZ").useFetchDatasourceInfo)({isRegularCardNode:!0,url:n,cardContext:e}),h=(0,i.useCallback)(()=>{let e;if(!r||!p||!u)return;let t=a("6SJAP").pluginKey.getState(l),i=(0,a("4Z0ju").buildDatasourceAdf)({id:p,parameters:u,views:t?.datasourceStash[n]?.views??[{type:"table"}]},n),{selection:o}=l,s=l.doc.resolve(o.from).marks().some(e=>e.type===l.schema.marks.link);o instanceof a("ks2lK").NodeSelection?e=o.node:s&&(e=l.doc.nodeAt(o.from)??void 0),e&&(0,a("btzjy").updateCardViaDatasource)({state:l,node:e,newAdf:i,view:r,sourceEvent:void 0,isDeletingConfig:!0,inputMethod:d})},[u,p,d,l,r,n]);if(!u||!p||!(0,a("16GCc").canRenderDatasource)(p))return null;if(n){let t=e?.store?.getState()[n];if(t?.error?.kind==="fatal")return null}let m=t.formatMessage(a("3RxtY").messages.datasourceAppearanceTitle);return(0,a("9K4OG").jsx)(a("1s5hv").default,null,(0,a("9K4OG").jsx)(a("3P0Cg").default,{css:o,title:m,icon:(0,a("9K4OG").jsx)(a("kAODm").DatasourceIcon,{label:m}),selected:s,onClick:h,testId:"card-datasource-appearance-button",areAnyNewToolbarFlagsEnabled:c}))};e.exports.DatasourceAppearanceButton=({intl:e,editorAnalyticsApi:t,url:i,editorView:o,editorState:r,selected:l,inputMethod:s,areAnyNewToolbarFlagsEnabled:d})=>{let c=(0,a("eIleF").useSmartLinkContext)();return(0,a("9K4OG").jsx)(n,{url:i,intl:e,editorAnalyticsApi:t,editorView:o,editorState:r,cardContext:c,selected:l,inputMethod:s,areAnyNewToolbarFlagsEnabled:d})}}),r("8eb8d",function(e,i){var o=a("l998X"),n=a("42omo");function r({linkPickerOptions:e={},onSubmit:t,displayText:i,displayUrl:n,providerFactory:r,view:l,onCancel:s,invokeMethod:d,lpLinkPicker:c,onClose:p,onEscapeCallback:u,onClickAwayCallback:h}){return(0,o.jsx)(a("6YpFi").HyperlinkAddToolbar,{linkPickerOptions:e,onSubmit:t,displayText:i,displayUrl:n,providerFactory:r,view:l,onCancel:s,invokeMethod:d,lpLinkPicker:c,onClose:p,onEscapeCallback:u,onClickAwayCallback:h})}class l extends t(n).Component{componentDidUpdate(e){e.node!==this.props.node&&this.hideLinkToolbar()}componentWillUnmount(){this.hideLinkToolbar()}hideLinkToolbar(){let{view:e}=this.props;e.dispatch((0,a("9AGwg").hideLinkToolbar)(e.state.tr))}render(){let{linkPickerOptions:e,providerFactory:t,url:i,text:n,view:l,onSubmit:s,forceFocusSelector:d,lpLinkPicker:c}=this.props;return(0,o.jsx)(r,{view:l,linkPickerOptions:e,providerFactory:t,displayUrl:i,displayText:n,invokeMethod:a("d925B").INPUT_METHOD.FLOATING_TB,lpLinkPicker:c,onSubmit:(e,t,i,o,n)=>{this.hideLinkToolbar(),s&&s(e,i||t,o,n)},onEscapeCallback:(e,t)=>{let{tr:i}=e;return(0,a("9AGwg").hideLinkToolbar)(i),d?.(`[aria-label="${a("ckqYV").linkToolbarMessages.editLink.defaultMessage}"]`)(i),!!t&&(t(i),!0)},onClickAwayCallback:(e,t)=>{let{tr:i}=e;return!!t&&(t(i),!0)}})}}e.exports.getEditLinkCallback=(e,t)=>(i,o)=>{let n="hyperlink";if(i.selection instanceof a("ks2lK").NodeSelection&&(n=i.selection.node.type.name),o){let{tr:r}=i;return(0,a("9AGwg").showLinkToolbar)(r),e?.attachAnalyticsEvent((0,a("iGbqR").buildEditLinkPayload)(n))(r),r.setMeta("scrollIntoView",t),o(r),!0}return!1},e.exports.buildEditLinkToolbar=({providerFactory:e,node:t,pluginInjectionApi:i,linkPicker:n,lpLinkPicker:r})=>({type:"custom",disableArrowNavigation:!0,fallback:[],render:(s,d)=>{if(!s||!e)return null;let c=(0,a("hrFA1").displayInfoForCard)(t,(0,a("hrFA1").findCardInfo)(s.state));return(0,o.jsx)(l,{view:s,linkPickerOptions:n,providerFactory:e,url:c.url,text:c.title||"",node:t,lpLinkPicker:r,forceFocusSelector:i?.floatingToolbar?.actions?.forceFocusSelector,onSubmit:(e,t,o,n)=>{let r=e!==c.url;return t!==c.title?(0,a("doRn8").commandWithMetadata)((0,a("btzjy").changeSelectedCardToLink)(t,e,void 0,void 0,void 0,i?.analytics?.actions),{action:a("d925B").ACTION.UPDATED,inputMethod:o,sourceEvent:n})(s.state,s.dispatch):r?(0,a("btzjy").updateCard)(e,n)(s.state,s.dispatch):void 0}},d)}}),e.exports.editLinkToolbarConfig=(e,t)=>e?{height:t?a("9fPrY").LINKPICKER_HEIGHT_IN_PX:a("9fPrY").RECENT_SEARCH_HEIGHT_IN_PX,width:a("9fPrY").RECENT_SEARCH_WIDTH_IN_PX,forcePlacement:!0}:{}}),r("fezbA",function(e,i){var o=a("42omo"),n=a("2dkHo"),r=a("iu6m9"),l=a("ihjbA");let s=(0,a("9K4OG").css)({margin:"0px var(--ds-space-negative-050, -4px)"}),d=e=>{let{cardContext:i,currentAppearance:l,editorAnalyticsApi:d,editorView:c,intl:p,onLinkEditClick:u,url:h,areAnyNewToolbarFlagsEnabled:m}=e,{extensionKey:f,...g}=(0,a("8dcLZ").useFetchDatasourceInfo)({isRegularCardNode:!0,url:h,cardContext:i}),b=g.datasourceId??e.datasourceId,[E,T]=(0,o.useState)(!1),C=(0,o.useRef)(),_=()=>T(!1),S=(0,o.useCallback)(()=>{c&&(u(c.state,c.dispatch),(0,a("hrFA1").focusEditorView)(c))},[c,u]),w=(0,o.useMemo)(()=>{let e=null!=h;if(!b||!(0,a("hrFA1").isDatasourceConfigEditable)(b))return e?"edit-link":"none";if(!e)return"edit-datasource";{let e=i?.store?.getState()[h];return e?.error?.kind==="fatal"?"edit-link":"edit-dropdown"}},[i?.store,b,h]),v=(0,o.useCallback)(()=>{c&&b&&((0,a("bzmKd").editDatasource)(b,d,l,f)(c.state,c.dispatch),(0,a("hrFA1").focusEditorView)(c))},[l,b,d,c,f]);switch(w){case"edit-link":return(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-link",onClick:S,areAnyNewToolbarFlagsEnabled:m},(0,a("9K4OG").jsx)(a("gtD4K").default,a("ckqYV").linkToolbarMessages.editLink)),!(0,r.editorExperiment)("platform_editor_controls","variant1")&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));case"edit-datasource":return(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-datasource",tooltipContent:p.formatMessage(a("ckqYV").linkToolbarMessages.editDatasourceStandaloneTooltip),onClick:v,areAnyNewToolbarFlagsEnabled:m},(0,a("9K4OG").jsx)(a("gtD4K").default,a("ckqYV").linkToolbarMessages.editDatasourceStandalone)),!(0,r.editorExperiment)("platform_editor_controls","variant1")&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));case"edit-dropdown":{let e=(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-dropdown-trigger",iconAfter:(0,a("9K4OG").jsx)("span",{css:s},(0,a("9K4OG").jsx)(t(a("7kzZ3")),{label:p.formatMessage(a("3RxtY").messages.editDropdownTriggerTitle),size:"small"})),onClick:()=>T(e=>!e),selected:E,disabled:!1,ariaHasPopup:!0,areAnyNewToolbarFlagsEnabled:m},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownTriggerTitle)),!(0,r.editorExperiment)("platform_editor_controls","variant1")&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));return(0,a("9K4OG").jsx)(a("1s5hv").default,{ref:C},(0,a("9K4OG").jsx)(n.DropdownContainer,{mountTo:C.current,isOpen:E,handleClickOutside:_,handleEscapeKeydown:_,trigger:e,scrollableElement:C.current,arrowKeyNavigationProviderOptions:{type:a("5v8Ta").ArrowKeyNavigationType.MENU}},(0,a("9K4OG").jsx)(a("56M4r").default,{key:"edit.link",onClick:S,testId:"edit-dropdown-edit-link-item"},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownEditLinkTitle)),(0,a("9K4OG").jsx)(a("56M4r").default,{key:"edit.datasource",onClick:v,testId:"edit-dropdown-edit-datasource-item"},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownEditDatasourceTitle))))}default:return null}},c=e=>{let{cardContext:t,currentAppearance:i,datasourceId:n,editorAnalyticsApi:r,editorView:s,intl:d,onLinkEditClick:c,url:p,areAnyNewToolbarFlagsEnabled:u}=e,{extensionKey:h,datasourceId:m}=(0,a("8dcLZ").useFetchDatasourceInfo)({isRegularCardNode:!0,url:p,cardContext:t}),f=m??n,g=(0,o.useMemo)(()=>{if(!f||!(0,a("hrFA1").isDatasourceConfigEditable)(f))return"edit-link";let e=t?.store?.getState()[p];return e?.error?.kind==="fatal"?"edit-link":"edit-dropdown"},[t?.store,f,p]);return(0,a("9K4OG").jsx)(l.default,{datasourceId:f,currentAppearance:i,editorAnalyticsApi:r,editVariant:g,editorView:s,extensionKey:h,onLinkEditClick:c,intl:d,areAnyNewToolbarFlagsEnabled:u})},p=e=>{let{currentAppearance:t,editorAnalyticsApi:i,editorView:n,intl:r,onLinkEditClick:s,datasourceId:d,node:c,areAnyNewToolbarFlagsEnabled:p}=e,u=(0,o.useMemo)(()=>{try{let e=c.attrs,t=e.datasource.parameters,i=e.datasource.views[0]?.properties?.columns.map(e=>e.key);return{parameters:t,visibleColumnKeys:i}}catch(e){console.error(e)}},[c.attrs]),{extensionKey:h}=(0,a("i88u2").useFetchDatasourceDataInfo)({datasourceId:d,parameters:u?.parameters,visibleColumnKeys:u?.visibleColumnKeys}),m=(0,o.useMemo)(()=>d&&(0,a("hrFA1").isDatasourceConfigEditable)(d)?"edit-datasource":"none",[d]);return(0,a("9K4OG").jsx)(l.default,{datasourceId:d,currentAppearance:t,editorAnalyticsApi:i,editVariant:m,editorView:n,extensionKey:h,onLinkEditClick:s,intl:r,areAnyNewToolbarFlagsEnabled:p})};e.exports.EditToolbarButton=e=>{let{currentAppearance:t,datasourceId:i,editorAnalyticsApi:o,editorView:n,intl:r,onLinkEditClick:l,url:s,areAnyNewToolbarFlagsEnabled:u}=e,h=(0,a("eIleF").useSmartLinkContext)();return e.url?(0,a("9K4OG").jsx)(c,{datasourceId:i,url:e.url,intl:r,editorAnalyticsApi:o,editorView:n,cardContext:h,onLinkEditClick:l,currentAppearance:t,areAnyNewToolbarFlagsEnabled:u}):e.datasourceId&&e.node?(0,a("9K4OG").jsx)(p,{datasourceId:e.datasourceId,node:e.node,intl:r,editorAnalyticsApi:o,editorView:n,onLinkEditClick:l,currentAppearance:t,areAnyNewToolbarFlagsEnabled:u}):(0,a("9K4OG").jsx)(d,{datasourceId:i,url:s,intl:r,editorAnalyticsApi:o,editorView:n,cardContext:h,onLinkEditClick:l,currentAppearance:t,areAnyNewToolbarFlagsEnabled:u})}}),r("iDVNw",function(e,t){var i=a("l998X"),o=a("42omo"),n=a("dzW6s");e.exports.HyperlinkToolbarAppearance=function(e){let[t,r]=(0,o.useState)(new Map),l=(0,o.useRef)(void 0),{url:s,intl:d,editorView:c,editorState:p,cardOptions:u,editorAnalyticsApi:h}=e,m=async()=>e.cardOptions?.provider?e.cardOptions?.provider:l.current?l.current:new Promise(t=>{let i=e.editorPluginApi?.card?.sharedState?.currentState()?.provider;i&&t(i)}),f=async e=>{if(t.has(e))return;let i=!1;try{let t=await m();i=await t?.findPattern(e)??!1}catch(e){i=!1}let o=new Map(t);o.set(e,i),r(o)};if((0,o.useEffect)(()=>{f(s)},[s,e.cardOptions?.provider,e.editorPluginApi]),!t.get(s))return null;let g=(0,a("iHzeA").areToolbarFlagsEnabled)(!!e.editorPluginApi?.toolbar);return(0,i.jsxs)(a("1s5hv").default,{children:[(0,i.jsx)(n.LinkToolbarAppearance,{url:s,intl:d,editorView:c,editorState:p,allowEmbeds:u?.allowEmbeds,allowBlockCards:u?.allowBlockCards,editorAnalyticsApi:h,areAnyNewToolbarFlagsEnabled:g},"link-appearance"),u?.allowDatasource&&(0,i.jsx)(a("kXd3n").DatasourceAppearanceButton,{intl:d,url:s,editorState:p,editorView:c,editorAnalyticsApi:h,inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB,areAnyNewToolbarFlagsEnabled:g}),(0,i.jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:g})]})}}),r("iVRHt",function(e,i){var o=a("l998X"),n=a("42omo"),r=a("2dkHo"),l=a("lB6pw");let s=e=>{let[i,s]=(0,n.useState)(new Map),[d,c]=(0,n.useState)(!1),p=(0,n.useRef)(void 0),u=(0,n.useRef)(void 0),h=(0,a("iHzeA").areToolbarFlagsEnabled)(!!e.editorPluginApi?.toolbar),{url:m,intl:f,editorView:g,cardOptions:b,editorAnalyticsApi:E,allowDatasource:T,isDatasourceView:C,settingsConfig:_}=e,S=async()=>e.cardOptions?.provider?e.cardOptions?.provider:p.current?p.current:new Promise(t=>{let i=e.editorPluginApi?.card?.sharedState?.currentState()?.provider;i&&t(i)}),w=async e=>{if(i.has(e))return;let t=!1;try{let i=await S();t=await i?.findPattern(e)??!1}catch(e){t=!1}let o=new Map(i);o.set(e,t),s(o)};if((0,n.useEffect)(()=>{w(m)},[m,e.cardOptions?.provider,e.editorPluginApi]),!i.get(m)||!g)return null;let v=()=>c(!1),O=a("cPDAt").appearancePropsMap.url,y=f.formatMessage(O.title),N=(0,o.jsx)(a("3P0Cg").default,{selected:d,title:y,"aria-label":y,"aria-expanded":d,"aria-haspopup":!0,onClick:()=>c(e=>!e),icon:O.icon({label:""}),iconAfter:(0,o.jsx)(t(a("7kzZ3")),{label:"",spacing:"compact",size:"small"}),areAnyNewToolbarFlagsEnabled:h,children:y});return(0,o.jsxs)(a("1s5hv").default,{ref:u,gap:"space.075",children:[(0,o.jsx)(r.DropdownContainer,{mountTo:u.current,isOpen:d,handleClickOutside:v,handleEscapeKeydown:v,trigger:N,scrollableElement:u.current,arrowKeyNavigationProviderOptions:{type:a("5v8Ta").ArrowKeyNavigationType.MENU},fitHeight:400,fitWidth:200,children:(0,o.jsx)(l.LinkAppearanceMenu,{url:m,intl:f,currentAppearance:void 0,editorState:g.state,allowEmbeds:b?.allowEmbeds,allowBlockCards:b?.allowBlockCards,editorAnalyticsApi:E,isDatasourceView:C,allowDatasource:T,dispatchCommand:e=>{e&&e(g&&g.state,g&&g.dispatch,g),g&&!g.hasFocus()&&g.focus()},settingsConfig:_,areAnyNewToolbarFlagsEnabled:h})}),!(0,a("iHzeA").areToolbarFlagsEnabled)(!!e.editorPluginApi?.toolbar)&&(0,o.jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:(0,a("iHzeA").areToolbarFlagsEnabled)(!!e.editorPluginApi?.toolbar)})]})};e.exports.getCustomHyperlinkAppearanceDropdown=({url:e,intl:t,editorAnalyticsApi:i,editorPluginApi:n,settingsConfig:a,cardOptions:r,allowDatasource:l,isDatasourceView:d})=>({type:"custom",fallback:[],render:c=>{if(c)return(0,o.jsx)(s,{intl:t,url:e,editorAnalyticsApi:i,editorPluginApi:n,editorView:c,settingsConfig:a,cardOptions:r,allowDatasource:l,isDatasourceView:d})}})}),r("dzW6s",function(e,i){var o=a("l998X"),n=a("42omo"),r=a("9Rg2N");class l extends t(n).Component{render(){let{editorView:e}=this.props;return(0,o.jsx)(a("aLPDZ").WithCardContext,{children:t=>this.renderDropdown(e,t&&t.value)})}constructor(...e){super(...e),this.renderDropdown=(e,t)=>{let{url:i,intl:n,currentAppearance:l,editorState:d,allowEmbeds:c,allowBlockCards:p=!0,editorAnalyticsApi:u,showUpgradeDiscoverability:h=!0,isDatasourceView:m,areAnyNewToolbarFlagsEnabled:f}=this.props,g=c&&t&&i&&t.extractors.getPreview(i,"web"),b=()=>!1;if(i){let e=t?.store?.getState()[i];if(e?.error?.kind==="fatal")return null}let E=!!p&&(0,a("7iE7T").isSupportedInParent)(d,a("5SAOw").Fragment.from(d.schema.nodes.blockCard.createChecked({})),l),T=!!c&&(0,a("7iE7T").isSupportedInParent)(d,a("5SAOw").Fragment.from(d.schema.nodes.embedCard.createChecked({})),l),C=c&&g&&{appearance:"embed",title:n.formatMessage(a("3RxtY").messages.embed),onClick:(0,a("btzjy").setSelectedCardAppearance)("embed",u)??b,selected:"embed"===l,hidden:!1,testId:"embed-appearance",disabled:!T,tooltip:T?void 0:s(d,n)},_=p&&{appearance:"block",title:n.formatMessage(a("3RxtY").messages.block),onClick:(0,a("btzjy").setSelectedCardAppearance)("block",u)??b,selected:"block"===l&&!m,testId:"block-appearance",disabled:!E,tooltip:E?void 0:s(d,n)},S=[{title:n.formatMessage(a("3RxtY").messages.url),onClick:(0,a("doRn8").commandWithMetadata)((0,a("btzjy").changeSelectedCardToLink)(i,i,!0,void 0,void 0,u)??b,{action:a("d925B").ACTION.CHANGED_TYPE}),selected:!l&&!m,testId:"url-appearance"},{appearance:"inline",title:n.formatMessage(a("3RxtY").messages.inline),onClick:(0,a("btzjy").setSelectedCardAppearance)("inline",u)??b,selected:"inline"===l,testId:"inline-appearance"}],w=t=>{t&&t(d,e&&e.dispatch),e&&!e.hasFocus()&&e.focus()};_&&S.push(_),C&&S.push(C);let v=(0,o.jsx)(a("eyrsK").LinkToolbarButtonGroup,{options:S.map(e=>(0,a("cPDAt").getButtonGroupOption)(n,f,w,{...e,onClick:(0,a("doRn8").commandWithMetadata)(e.onClick,{inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB})}))},"link-toolbar-button-group"),O=i?t?.store?.getState()[i]?.status:"",y=!!C&&!C.disabled;if((0,r.shouldRenderToolbarPulse)(y,l??"",O??"",h)){let e=(0,a("hrFA1").getResolvedAttributesFromStore)(i||"",l||null,t?.store);return(0,o.jsx)(a("bYRk6").default,{data:{attributes:{...e}},children:(0,o.jsx)(a("jqKkl").DiscoveryPulse,{localStorageKey:a("5v798").LOCAL_STORAGE_DISCOVERY_KEY_TOOLBAR,testId:"toolbar-discovery-pulse",children:v})})}return v}}}let s=(e,t)=>{try{let i=e.selection.$from.node(1),o=t.formatMessage(a("61p3e").default[i.type.name]);return t.formatMessage(a("3RxtY").messages.displayOptionUnavailableInParentNode,{node:o})}catch(e){return t.formatMessage(a("3RxtY").messages.displayOptionUnavailableInParentNode,{node:t.formatMessage(a("61p3e").default.defaultBlockNode)})}};e.exports.LinkToolbarAppearance=l,e.exports.getUnavailableMessage=s}),r("lB6pw",function(e,t){var i=a("l998X");a("42omo");var o=a("iu6m9"),n=a("dzW6s");let r=({url:e,intl:t,currentAppearance:r,editorState:l,allowEmbeds:s,allowBlockCards:d=!0,allowDatasource:c,editorAnalyticsApi:p,isDatasourceView:u,dispatchCommand:h,settingsConfig:m})=>{let f,g=(0,a("eIleF").useSmartCardContext)(),b=s&&g&&e&&g.value?.extractors.getPreview(e,"web"),E=()=>!1;if(e){let t=g.value?.store?.getState()[e];if(t?.error?.kind==="fatal")return null}let T=!!d&&(0,a("7iE7T").isSupportedInParent)(l,a("5SAOw").Fragment.from(l.schema.nodes.blockCard.createChecked({})),r),C=!!s&&(0,a("7iE7T").isSupportedInParent)(l,a("5SAOw").Fragment.from(l.schema.nodes.embedCard.createChecked({})),r),_=s&&b&&{appearance:"embed",title:t.formatMessage(a("3RxtY").messages.embed),onClick:(0,a("btzjy").setSelectedCardAppearance)("embed",p)??E,selected:"embed"===r,hidden:!1,testId:"embed-appearance",disabled:!C,tooltip:C?void 0:(0,n.getUnavailableMessage)(l,t),description:(0,o.editorExperiment)("platform_editor_preview_panel_responsiveness",!0,{exposure:!0})?t.formatMessage(a("3RxtY").messages.embedToBlockCardWarning):void 0},S=d&&{appearance:"block",title:t.formatMessage(a("3RxtY").messages.block),onClick:(0,a("btzjy").setSelectedCardAppearance)("block",p)??E,selected:"block"===r&&!u,testId:"block-appearance",disabled:!T,tooltip:T?void 0:(0,n.getUnavailableMessage)(l,t)},w=[{title:t.formatMessage(a("3RxtY").messages.url),onClick:(0,a("doRn8").commandWithMetadata)((0,a("btzjy").changeSelectedCardToLink)(e,e,!0,void 0,void 0,p)??E,{action:a("d925B").ACTION.CHANGED_TYPE}),selected:!r&&!u,testId:"url-appearance"},{appearance:"inline",title:t.formatMessage(a("3RxtY").messages.inline),onClick:(0,a("btzjy").setSelectedCardAppearance)("inline",p)??E,selected:"inline"===r,testId:"inline-appearance"}];S&&w.push(S),_&&w.push(_);let v=w.map(e=>(0,a("72Ahd").getDropdownOption)(t,h,{...e,onClick:(0,a("doRn8").commandWithMetadata)(e.onClick,{inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB})}));return"icon"in m&&void 0!==m.icon&&(f=m.icon),(0,i.jsxs)(a("2SlZp").default,{children:[(0,i.jsxs)(a("7rvPL").default,{children:[v.map(e=>(0,i.jsx)(a("56M4r").default,{iconBefore:e.icon,onClick:()=>e.onClick(),isSelected:e.selected,description:e.description,shouldDescriptionWrap:!0,children:e.title},e.title)),(0,i.jsx)(a("h8aIC").DatasourceDropdownOption,{allowDatasource:c,intl:t,url:e??"",selected:!!u,inputMethod:a("d925B").INPUT_METHOD.FLOATING_TB,dispatchCommand:h})]}),(0,i.jsx)(a("7rvPL").default,{hasSeparator:!0,children:(0,i.jsx)(a("cGtPE").default,{iconBefore:f&&(0,i.jsx)(f,{label:"Settings"}),href:"href"in m?m.href:void 0,target:"target"in m?m.target:void 0,children:t.formatMessage(a("ckqYV").linkToolbarMessages.preferencesLink)})})]})};e.exports.LinkAppearanceMenu=r,e.exports.getLinkAppearanceDropdown=({url:e,intl:t,currentAppearance:o,editorState:n,allowEmbeds:l,allowBlockCards:s=!0,allowDatasource:d,editorAnalyticsApi:c,showUpgradeDiscoverability:p=!0,isDatasourceView:u,settingsConfig:h,areAnyNewToolbarFlagsEnabled:m})=>{let f=u?a("h8aIC").datasourceDisplayInformation:a("cPDAt").appearancePropsMap[o??"url"];return{id:"card-appearance",testId:"card-appearance-dropdown",type:"dropdown",options:{render:a=>(0,i.jsx)(r,{url:e,intl:t,currentAppearance:o,editorState:n,allowEmbeds:l,allowBlockCards:s,editorAnalyticsApi:c,showUpgradeDiscoverability:p,isDatasourceView:u,allowDatasource:d,dispatchCommand:a.dispatchCommand,settingsConfig:h,areAnyNewToolbarFlagsEnabled:m}),width:200,height:400},title:t.formatMessage(f.title),iconBefore:f.icon}}}),r("l1M3D",function(e,i){var o=a("l998X");a("42omo");var n=a("1oCLl");e.exports.OpenPreviewPanelToolbarButton=({node:e,intl:i,areAnyNewToolbarFlagsEnabled:r,editorAnalyticsApi:l,editorView:s})=>{let{store:d,isPreviewPanelAvailable:c,openPreviewPanel:p}=(0,a("eIleF").useSmartLinkContext)(),u=e.attrs.url,h=(0,a("5YZhQ").appearanceForLink)(e),m=d?.getState()[u];if(m){let e=(0,a("226XV").getObjectAri)(m.details),s=(0,a("226XV").getObjectName)(m.details),f=(0,a("226XV").getObjectIconUrl)(m.details),g=e&&c?.({ari:e}),b=i.formatMessage(a("fpEzC").linkMessages.openPreviewPanel),E=r?(0,o.jsx)(t(a("jypE9")),{label:"",spacing:"spacious"}):(0,o.jsxs)(a("u9agA").default,{as:"span",space:"space.050",alignBlock:"center",children:[(0,o.jsx)(a("gdv5Z").default,{as:"span","aria-hidden":!0,role:"presentation"}),(0,o.jsx)(t(a("jypE9")),{label:"",spacing:"spacious"}),(0,o.jsx)(a("gdv5Z").default,{as:"span","aria-hidden":!0,role:"presentation"})]});if(p&&g)return(0,o.jsx)(a("1s5hv").default,{gap:"space.050",children:(0,o.jsx)(a("3P0Cg").default,{testId:"open-preview-panel-floating-toolbar-button",onClick:()=>{p&&g&&p({url:u,ari:e,name:s||"",iconUrl:f,panelData:{embedUrl:(0,n.expValEquals)("platform_hover_card_preview_panel","cohort","test")?(0,a("79vw2").extractSmartLinkEmbed)(m?.details)?.src:void 0}}),l?.fireAnalyticsEvent({action:a("d925B").ACTION.CLICKED,actionSubject:a("d925B").ACTION_SUBJECT.SMART_LINK,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.TOOLBAR_PREVIEW,attributes:{previewType:"panel",...(0,a("hrFA1").getResolvedAttributesFromStore)(u,h,d)},eventType:a("d925B").EVENT_TYPE.UI})},icon:E,title:b,areAnyNewToolbarFlagsEnabled:r})})}return null}}),r("hh4Zj",function(e,t){var i=a("l998X"),o=a("42omo");let n=({url:e,display:t,cardContext:i})=>{let{createAnalyticsEvent:n}=(0,a("inPa6").useAnalyticsEvents)(),r=i?.store;return(0,o.useEffect)(()=>{n({action:"viewed",actionSubject:"inlineDialog",actionSubjectId:"editLinkToolbar",eventType:"ui",attributes:{...(0,a("hrFA1").getResolvedAttributesFromStore)(e,t,r),display:t}}).fire("media")},[n,t,e,r]),null};e.exports.ToolbarViewedEvent=({url:e,display:t,editorView:o})=>{let r=(0,a("eIleF").useSmartLinkContext)();return(0,i.jsx)(a("aJdNi").EditorAnalyticsContext,{editorView:o,children:e?(0,i.jsx)(n,{url:e,display:t,cardContext:r}):null})}}),r("1yFQS",function(e,t){e.exports.shouldReplaceLink=function(e,t=!0,i){let o=e.marks.find(e=>"link"===e.type.name);if(!o)return!1;let n=(0,a("81OAa").normalizeUrl)(a("jvA0K").md.normalizeLinkText(o.attrs.href)),r=(0,a("81OAa").normalizeUrl)(a("jvA0K").md.normalizeLinkText(e.text||""));return(!t||n===r)&&(!i||(0,a("81OAa").normalizeUrl)(a("jvA0K").md.normalizeLinkText(i))===n)&&!0}}),r("7dJ3M",function(e,i){var o=a("l998X"),n=a("42omo");e.exports.Pulse=({children:e,showPulse:i=!1,onAnimationIteration:r,onAnimationStart:l,testId:s="discovery-pulse",isInline:d=!1})=>{let c=(0,n.useRef)(!1);i&&(c.current=!0);let p=t(n).useCallback(e=>{e.stopPropagation()},[]);return(0,o.jsx)(d?"span":"div",{"data-testid":s,onAnimationIteration:r,onAnimationStart:l,className:(0,a("gMc0m").default)(["_1e0c1nu9",c.current&&"",c.current&&"_2rkofajl _16qs1l47 _j7hq8j16 _5sagw34l _1pgl1trn _tip811wp"]),children:(0,o.jsx)("span",{onAnimationIteration:p,onAnimationStart:p,children:e})})}}),r("9QE25",function(e,t){var i=e.exports&&e.exports.__assign||function(){return(i=Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},o=e.exports&&e.exports.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t.default=e,t};Object.defineProperty(e.exports,"__esModule",{value:!0});var n=o(a("42omo")),r={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}};e.exports.Resizer=function(e){return n.createElement("div",{className:e.className||"",style:i({position:"absolute",userSelect:"none"},r[e.direction],e.replaceStyles||{}),onMouseDown:function(t){e.onResizeStart(t,e.direction)},onTouchStart:function(t){e.onResizeStart(t,e.direction)}},e.children)}}),r("kAODm",function(e,i){var o=a("l998X");a("42omo");let n=(0,a("ecnYn").xcss)({padding:"space.050",justifyContent:"center",alignItems:"center",width:"space.300",height:"space.300"});e.exports.DatasourceIcon=e=>(0,o.jsx)(a("bUlM5").default,{xcss:n,children:(0,o.jsx)(t(a("2g1PW")),{label:e?.label})})}),r("8dcLZ",function(e,t){var i=a("42omo");e.exports.useFetchDatasourceInfo=({isRegularCardNode:e,url:t,cardContext:o,nodeParameters:n})=>{let[a,r]=(0,i.useState)(void 0),[l,s]=(0,i.useState)(n),[d,c]=(0,i.useState)(!e),[p,u]=(0,i.useState)(void 0);return(0,i.useEffect)(()=>{let i=async()=>{try{if(!t||!o)return void c(!0);let e=await o?.connections?.client?.fetchData(t),i=e&&e.datasources||[];u(e?.meta.key),r(i[0]?.id),s(i[0]?.parameters),c(!0)}catch(e){r(void 0),s(void 0),u(void 0),c(!0)}};e&&i()},[e,o,t]),{datasourceId:a,parameters:l,ready:d,extensionKey:p}}}),r("bzmKd",function(e,t){e.exports.editDatasource=(e,t,i,o)=>(n,r)=>{let l=(0,a("16GCc").getDatasourceType)(e);if(r&&l){let{tr:e}=n;return(0,a("9AGwg").showDatasourceModal)(l)(e),t?.attachAnalyticsEvent({action:a("d925B").ACTION.CLICKED,actionSubject:a("d925B").ACTION_SUBJECT.BUTTON,actionSubjectId:a("d925B").ACTION_SUBJECT_ID.EDIT_DATASOURCE,eventType:a("d925B").EVENT_TYPE.UI,attributes:{extensionKey:o,appearance:i}})(e),r(e),!0}return!1}}),r("i88u2",function(e,t){var i=a("42omo");e.exports.useFetchDatasourceDataInfo=({datasourceId:e,parameters:t,visibleColumnKeys:o})=>{let[n,r]=(0,i.useState)(void 0),{getDatasourceData:l}=(0,a("655oj").useDatasourceClientExtension)();return(0,i.useEffect)(()=>{(async()=>{try{if(!e||!t||!o)return;let i={parameters:t,pageSize:a("655oj").DEFAULT_GET_DATASOURCE_DATA_PAGE_SIZE,pageCursor:void 0,fields:o,includeSchema:!0},{meta:n}=await l(e,i,!1);r(n.extensionKey)}catch(e){console.error(e),r(void 0)}})()},[l,o,t,e]),{extensionKey:n}}}),r("ihjbA",function(e,i){var o=a("42omo"),n=a("2dkHo");let r=(0,a("9K4OG").css)({margin:"0px var(--ds-space-negative-050, -4px)"});e.exports.default=({datasourceId:e,currentAppearance:i,editorAnalyticsApi:l,editVariant:s,editorView:d,extensionKey:c,onLinkEditClick:p,intl:u,areAnyNewToolbarFlagsEnabled:h})=>{let[m,f]=(0,o.useState)(!1),g=(0,o.useRef)(),b=()=>f(!1),E=(0,o.useCallback)(()=>{d&&(p(d.state,d.dispatch),(0,a("hrFA1").focusEditorView)(d))},[d,p]),T=(0,o.useCallback)(()=>{d&&e&&((0,a("bzmKd").editDatasource)(e,l,i,c)(d.state,d.dispatch),(0,a("hrFA1").focusEditorView)(d))},[i,e,l,d,c]),C=h?(0,a("9K4OG").jsx)(t(a("1Zr9M")),{label:""}):void 0,_=h?u.formatMessage(a("ckqYV").linkToolbarMessages.editLink):void 0;switch(s){case"edit-link":return(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-link",onClick:E,icon:C,tooltipContent:_,areAnyNewToolbarFlagsEnabled:h},!h&&(0,a("9K4OG").jsx)(a("gtD4K").default,a("ckqYV").linkToolbarMessages.editLink)),!h&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));case"edit-datasource":return(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-datasource",tooltipContent:u.formatMessage(a("ckqYV").linkToolbarMessages.editDatasourceStandaloneTooltip),onClick:T,areAnyNewToolbarFlagsEnabled:h},(0,a("9K4OG").jsx)(a("gtD4K").default,a("ckqYV").linkToolbarMessages.editDatasourceStandalone)),!h&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));case"edit-dropdown":{let e=(0,a("9K4OG").jsx)(a("1s5hv").default,{gap:"space.050"},(0,a("9K4OG").jsx)(a("3P0Cg").default,{testId:"edit-dropdown-trigger",iconAfter:(0,a("9K4OG").jsx)("span",{css:r},(0,a("9K4OG").jsx)(t(a("7kzZ3")),{label:u.formatMessage(a("3RxtY").messages.editDropdownTriggerTitle),size:"small"})),onClick:()=>f(e=>!e),selected:m,disabled:!1,ariaHasPopup:!0,areAnyNewToolbarFlagsEnabled:h},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownTriggerTitle)),!h&&(0,a("9K4OG").jsx)(a("faH35").default,{areAnyNewToolbarFlagsEnabled:!1}));return(0,a("9K4OG").jsx)(a("1s5hv").default,{ref:g},(0,a("9K4OG").jsx)(n.DropdownContainer,{mountTo:g.current,isOpen:m,handleClickOutside:b,handleEscapeKeydown:b,trigger:e,scrollableElement:g.current,arrowKeyNavigationProviderOptions:{type:a("5v8Ta").ArrowKeyNavigationType.MENU}},(0,a("9K4OG").jsx)(a("56M4r").default,{key:"edit.link",onClick:E,testId:"edit-dropdown-edit-link-item"},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownEditLinkTitle)),(0,a("9K4OG").jsx)(a("56M4r").default,{key:"edit.datasource",onClick:T,testId:"edit-dropdown-edit-datasource-item"},(0,a("9K4OG").jsx)(a("gtD4K").default,a("3RxtY").messages.editDropdownEditDatasourceTitle))))}default:return null}}}),r("cPDAt",function(e,i){let o={url:{title:a("3RxtY").messages.urlTitle,icon:t(a("5Yp2m"))},inline:{title:a("3RxtY").messages.inlineTitle,icon:t(a("erzkB"))},block:{title:a("3RxtY").messages.blockTitle,icon:t(a("65WMN"))},embed:{title:a("3RxtY").messages.embedTitle,icon:t(a("99wB5"))}};e.exports.appearancePropsMap=o,e.exports.getButtonGroupOption=(e,t,i,{disabled:n,onClick:a,selected:r,appearance:l,testId:s,tooltip:d})=>{let{title:c,icon:p}=o[l??"url"];return{title:e.formatMessage(c),icon:p,onClick:()=>i(a),disabled:!!n,tooltipContent:d||null,testId:s,selected:r,areAnyNewToolbarFlagsEnabled:t}}}),r("eyrsK",function(e,t){a("42omo");let i={name:"1quw0ni",styles:"pointer-events:auto"},o={name:"je8g23",styles:"pointer-events:none"},n=({disabled:e,...t})=>(0,a("9K4OG").jsx)("div",t),r={name:"e0dnmk",styles:"cursor:pointer"},l={name:"1sfig4b",styles:"cursor:not-allowed"};e.exports.LinkToolbarButtonGroup=({options:e})=>(0,a("9K4OG").jsx)(a("hArLp").default,null,e.map(({onClick:e,selected:t,disabled:s,testId:d,tooltipContent:c,title:p,icon:u,areAnyNewToolbarFlagsEnabled:h})=>(0,a("9K4OG").jsx)(n,{css:s?l:r,key:d,disabled:s},(0,a("9K4OG").jsx)(a("3P0Cg").default,{css:s?o:i,title:p,icon:(0,a("9K4OG").jsx)(u,{label:p,spacing:"spacious"}),selected:t,onClick:e,testId:d,disabled:s,tooltipContent:c,areAnyNewToolbarFlagsEnabled:h}))))}),r("72Ahd",function(e,i){var o=a("42omo");e.exports.getDropdownOption=(e,i,{disabled:n,onClick:r,selected:l,appearance:s,testId:d,tooltip:c,description:p})=>{let{title:u,icon:h}=a("cPDAt").appearancePropsMap[s??"url"];return{title:e.formatMessage(u),icon:t(o).createElement(h,{label:e.formatMessage(u)}),onClick:()=>i(r),disabled:!!n,testId:d,selected:l,tooltip:c??"",description:p}}}),r("h8aIC",function(e,i){var o=a("l998X");a("42omo");let n={title:a("3RxtY").messages.datasourceAppearanceTitle,icon:t(a("2g1PW")),iconFallback:t(a("2g1PW"))};e.exports.datasourceDisplayInformation=n,e.exports.DatasourceDropdownOption=({allowDatasource:e,intl:i,url:n,selected:r,inputMethod:l,dispatchCommand:s})=>{let d=(0,a("eIleF").useSmartLinkContext)(),{datasourceId:c,parameters:p}=(0,a("8dcLZ").useFetchDatasourceInfo)({isRegularCardNode:!0,url:n,cardContext:d});if(!e||!c||!p)return null;let u=(e,t,i)=>{let o;if(!i||!c||!p)return!1;let r=a("6SJAP").pluginKey.getState(e),s=(0,a("4Z0ju").buildDatasourceAdf)({id:c,parameters:p,views:r?.datasourceStash[n]?.views??[{type:"table"}]},n),{selection:d}=e,u=e.doc.resolve(d.from).marks().some(t=>t.type===e.schema.marks.link);return d instanceof a("ks2lK").NodeSelection?o=d.node:u&&(o=e.doc.nodeAt(d.from)??void 0),!!o&&((0,a("btzjy").updateCardViaDatasource)({state:e,node:o,newAdf:s,view:i,sourceEvent:void 0,isDeletingConfig:!0,inputMethod:l}),!0)};if(n){let e=d?.store?.getState()[n];if(e?.error?.kind==="fatal")return null}return(0,o.jsx)(a("56M4r").default,{iconBefore:t(a("2g1PW"))({label:i.formatMessage(a("3RxtY").messages.datasourceAppearanceTitle)}),onClick:()=>s(u),isSelected:r,children:i.formatMessage(a("3RxtY").messages.datasourceAppearanceTitle)},i.formatMessage(a("3RxtY").messages.datasourceAppearanceTitle))}}),r("5YZhQ",function(e,t){function i(e){return"datasource"in e.attrs&&!!e.attrs.datasource}let o=e=>!i(e)&&(!!(0,a("hrFA1").appearanceForNodeType)(e.type)||l(e));function n(e){let t=(0,a("hrFA1").appearanceForNodeType)(e.type);return t||"url"}let r=e=>{if(e.marks)for(let t=0;t<e.marks.length;t++){let i=e.marks[t];if("link"===i.type.name)return i}},l=e=>!!r(e);function s(e){return e.attrs?.url??r(e)?.attrs?.href}let d=(e,t)=>{let i=e.resolve(t);for(let e=0;e<=3;e++){let t=i.node(i.depth-e);if(t&&"paragraph"!==t.type.name)return t.type.name}return"unknown"};e.exports.getNodeSubject=function(e){return i(e)?a("h92Fd").EVENT_SUBJECT.DATASOURCE:o(e)?a("h92Fd").EVENT_SUBJECT.LINK:null},e.exports.appearanceForLink=n,e.exports.getUrl=s,e.exports.getNodeContext=d,e.exports.findAtPositions=(e,t)=>{let i=[];for(let o=0;o<t.length;o++){let n=t[o],a=e.doc.nodeAt(n);if(!a)continue;let r=d(e.doc,n);i.push({pos:n,node:a,nodeContext:r})}return i},e.exports.findInNodeRange=(e,t,i,o)=>{let n=[];return e.nodesBetween(t,i,(a,r)=>{if(o(a)&&r>=t&&r+a.nodeSize<=i){let t=d(e,r);n.push({pos:r,node:a,nodeContext:t})}}),n},e.exports.areSameNodes=(e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let o=e[i],a=t[i];if(s(o.node)!==s(a.node)||n(o.node)!==n(a.node))return!1}return!0}}),r("h92Fd",function(e,t){var i,o,n=((i={}).CREATED="created",i.UPDATED="updated",i.DELETED="deleted",i),a=((o={}).LINK="link",o.DATASOURCE="datasource",o);e.exports.EVENT=n,e.exports.EVENT_SUBJECT=a}),i.rlb("7zIKF");
//# sourceMappingURL=FullPageEditorComponent.419cd05d.js.map
