function e(e){return e&&e.__esModule?e.default:e}var t=globalThis.parcelRequired477;(0,t.register)("h4oCC",function(r,a){var s=t("42omo");let c=()=>(0,t("9o40q").useExperimentalMutation)({url:"/wiki/rest/ia/1.0/link/batch",method:"POST",body:e=>JSON.stringify(e),headers:{"Content-Type":t("aBfpe").MediaType.JSON},parseResult:({quickLinks:e})=>({experimentalUpdateShortcutLinks:{quickLinks:e.map(({id:e,position:t,styleClass:r,title:a,url:s})=>({id:String(e),position:String(t),styleClass:r,title:a,url:s})),__typename:"ExperimentalQuickLinks"}})}),o=(0,t("cgtv4").defineMessages)({reorderShortcutSuccessFlagTitle:{id:"space-shortcuts.space-space-shortcuts.reorder-success-flag.title",defaultMessage:"The shortcut was reordered"},reorderShortcutErrorFlagTitle:{id:"space-shortcuts.space-space-shortcuts.reorder-error-flag.title",defaultMessage:"The shortcut could not be reordered"},reorderShortcutErrorFlagDescription:{id:"space-shortcuts.space-space-shortcuts.reorder-error-flag.description",defaultMessage:"There was an error moving the shortcut. Refresh and try again."},removeShortcutSuccessFlagTitle:{id:"space-shortcuts.space-space-shortcuts.remove-success-flag.title",defaultMessage:"The shortcut was removed"},removeShortcutErrorFlagTitle:{id:"space-shortcuts.space-space-shortcuts.remove-error-flag.title",defaultMessage:"The shortcut could not be removed"},removeShortcutErrorFlagDescription:{id:"space-shortcuts.space-space-shortcuts.remove-error-flag.description",defaultMessage:"There was an error removing the shortcut. Refresh and try again."},addShortcutSuccessFlagTitle:{id:"space-shortcuts.space-space-shortcuts.add-success-flag.title",defaultMessage:"New shortcut added"},addShortcutErrorFlagTitle:{id:"space-shortcuts.space-space-shortcuts.add-error-flag.title",defaultMessage:"The shortcut could not be added"},addShortcutErrorFlagDescription:{id:"space-shortcuts.space-space-shortcuts.add-error-flag.description",defaultMessage:"There was an error creating the shortcut. Refresh and try again."},editShortcutSuccessFlagTitle:{id:"space-shortcuts.space-space-shortcuts.edit-success-flag.title",defaultMessage:"The shortcut was edited"},editShortcutErrorFlagTitle:{id:"space-shortcuts.space-space-shortcuts.edit-error-flag.title",defaultMessage:"The shortcut could not be edited"},editShortcutErrorFlagDescription:{id:"space-shortcuts.space-space-shortcuts.edit-error-flag.description",defaultMessage:"There was an error updating the shortcut. Refresh and try again."},flagUndoAction:{id:"space-shortcuts.space-space-shortcuts.undo-action",defaultMessage:"Undo"}}),i=(r,a)=>{let[i]=(0,t("ep3mz").usePageSpaceKey)(),u=(0,t("7hXu9").useApolloClient)(),[l]=c();return(0,s.useCallback)((c,d,n,p,h,S=!0,g)=>{let f,y=c.map(e=>e.hasOwnProperty("id")&&e.id&&!g?{id:e.id}:{id:e.id,title:e.title,url:e.url,resourceType:e.resourceType,resourceId:e.resourceId}),v=c.map(e=>({id:e.id&&e.id.startsWith("cached-")?null:e.id,title:e.title,url:e.url,resourceType:e.resourceType,resourceId:e.resourceId}));try{f=u.readQuery({query:t("eohUr").SpaceShortcutsSpaceNavigationQuery,variables:{spaceKey:i,isLicensed:!0}})}catch{}return l({variables:{spaceKey:i||"",quickLinks:y},optimisticResponse:{experimentalUpdateShortcutLinks:{quickLinks:v,__typename:"ExperimentalQuickLinks"}},update:(e,r)=>{let{data:a}=r;if(void 0===a){f&&u.writeQuery({query:t("eohUr").SpaceShortcutsSpaceNavigationQuery,data:f,variables:{spaceKey:i,isLicensed:!0}});return}c=c.map(e=>null===e.id?{...e,id:`cached-${d.id}`}:e);let s=a?.experimentalUpdateShortcutLinks?.quickLinks?a?.experimentalUpdateShortcutLinks?.quickLinks.map(e=>({...e,__typename:"SpaceSidebarLink"})):c;u.writeQuery({query:t("eohUr").SpaceShortcutsSpaceNavigationQuery,data:{spaceSidebarLinks:{quick:s,__typename:"SpaceSidebarLinks"}},variables:{spaceKey:i,isLicensed:!0}})}}).then(()=>{if(S){d=a?.current?.peek()?.lastDeletedItem||d;let c="shortcutsFlag";if(r.showSuccessFlag({id:c,title:e(s).createElement(t("gtD4K").default,n),actions:a&&[{content:e(s).createElement(t("gtD4K").default,o.flagUndoAction),onClick:()=>{let e=a.current.pop();if(e){let{undo:t}=e;t&&t()}r.hideFlag(c)}}]}),a){let e=a.current.peek();e&&(e.flagId=c)}}}).catch(()=>{r.showErrorFlag({title:e(s).createElement(t("gtD4K").default,p),description:e(s).createElement(t("gtD4K").default,{...h,values:{linkTitle:d.title||d.url}})})})},[l,i,r,a,u])},u=(e,t,r)=>{t.reverse();let a=[...t.map(e=>({...e,position:e.position++})),{...e,id:null,position:0,styleClass:"external_link",__typename:"SpaceSidebarLink"}];a.reverse(),r(a,e,o.addShortcutSuccessFlagTitle,o.addShortcutErrorFlagTitle,o.addShortcutErrorFlagDescription)};r.exports.useAddShortcut=(e,r,a)=>{let c=i(r,a),{createAnalyticsEvent:l}=(0,t("inPa6").useAnalyticsEvents)(),{linkDeleted:d}=(0,t("7pxpu").useSmartLinkLifecycleAnalytics)();return{addShortcut:(0,s.useCallback)(t=>{u(t,e,c),l({type:"sendTrackEvent",data:{action:"add",actionSubject:"spaceShortcuts",source:"spaceShortcutNavigation"}}).fire()},[e,c,l]),undoAddShortcut:(0,s.useCallback)(t=>{let r=e.filter(e=>e.id!==t.id);r.reverse(),c(r,t,o.removeShortcutSuccessFlagTitle,o.removeShortcutErrorFlagTitle,o.removeShortcutErrorFlagDescription,!1);let a=l({type:"sendTrackEvent",data:{action:"undo",actionSubject:"add",actionSubjectId:"spaceShortcuts",source:"spaceShortcutNavigation"}});a.fire(),t.url&&d({url:t.url},a)},[e,c,l,d])}},r.exports.useAppendShortcut=r=>{let a=i(r),c=(0,t("7hXu9").useApolloClient)();return{appendShortcut:(i,l)=>{let d={url:`${window.location.origin}/wiki/spaces/${i}/pages/${l}`};c.query({query:t("eohUr").SpaceShortcutsSpaceNavigationQuery,variables:{spaceKey:i}}).then(({data:e})=>{u(d,e.spaceSidebarLinks.quick,a)}).catch(()=>{r.showErrorFlag({title:e(s).createElement(t("gtD4K").default,o.addShortcutErrorFlagTitle),description:e(s).createElement(t("gtD4K").default,o.addShortcutErrorFlagDescription)})})}}},r.exports.useEditShortcut=(e,r,a)=>{let c=i(r),{createAnalyticsEvent:u}=(0,t("inPa6").useAnalyticsEvents)();return(0,s.useCallback)(t=>{let r=Array.from(e).reverse(),s=r.findIndex(e=>e.id===t.id),i=r[s];r.splice(s,1,t),r.reverse(),c(r,t,o.editShortcutSuccessFlagTitle,o.editShortcutErrorFlagTitle,o.editShortcutErrorFlagDescription,!0,i),u({type:"sendTrackEvent",data:{action:"updated",actionSubject:"spaceShortcuts",source:"space-shortcut-quick-action",containerId:a,containerType:"space"}}).fire()},[e,c,u,a])},r.exports.useDeleteShortcut=(e,r,a)=>{let c=i(r,a),{createAnalyticsEvent:u}=(0,t("inPa6").useAnalyticsEvents)(),{linkCreated:l,linkDeleted:d}=(0,t("7pxpu").useSmartLinkLifecycleAnalytics)();return{deleteShortcut:(0,s.useCallback)(t=>{c(e.filter(e=>e.id!==t.id),t,o.removeShortcutSuccessFlagTitle,o.removeShortcutErrorFlagTitle,o.removeShortcutErrorFlagDescription);let r=u({type:"sendTrackEvent",data:{action:"deleted",actionSubject:"spaceShortcuts",source:"space-shortcut-quick-action"}});r.fire(),t.url&&d({url:t.url},r)},[e,c,u,d]),undoDeleteShortcut:(0,s.useCallback)(t=>{c(e.map(e=>e.id===t.id?{...e,id:null}:e),t,o.removeShortcutSuccessFlagTitle,o.removeShortcutErrorFlagTitle,o.removeShortcutErrorFlagDescription,!1);let r=u({type:"sendTrackEvent",data:{action:"undo",actionSubject:"delete",actionSubjectId:"spaceShortcuts",source:"space-shortcut-quick-action"}});r.fire(),t.url&&l({url:t.url},r)},[e,c,u,l])}},r.exports.useMoveShortcut=(e,t,r)=>{let a=i(t,r);return{moveShortcut:(0,s.useCallback)((t,r)=>{let s=Array.from(e).reverse(),[c]=s.splice(t.index,1);s.splice(r.index,0,c),s.reverse(),a(s,c,o.reorderShortcutSuccessFlagTitle,o.reorderShortcutErrorFlagTitle,o.reorderShortcutErrorFlagDescription)},[e,a]),undoMoveShortcut:(0,s.useCallback)(t=>{let r=Array.from(e).reverse(),[s]=r.slice(t.index,1);r.reverse(),a(r,s,o.reorderShortcutSuccessFlagTitle,o.reorderShortcutErrorFlagTitle,o.reorderShortcutErrorFlagDescription,!1)},[e,a])}}});
//# sourceMappingURL=QuickActionsContent.bd0ff7d6.js.map
