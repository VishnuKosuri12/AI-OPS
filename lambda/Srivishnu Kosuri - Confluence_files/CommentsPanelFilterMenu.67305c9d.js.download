var e=globalThis.parcelRequired477,n=e.register;n("kgNLQ",function(n,t){var o;(o={}).INLINE="inline",o.GENERAL="general";let a=(e,n)=>{for(let t of e){if(t?.id===n)return t;if(t?.replies){let e=t.replies.find(e=>e?.id===n);if(e)return e}}},i=(e,n)=>{for(let t of e){let e=t?.location;if(e?.inlineMarkerRef===n)return t}},r=e=>{let n=e?.location;if(n){if("inlineResolveProperties"in n)return n.inlineResolveProperties?.resolved??!1;else if("commentResolveProperties"in n)return n.commentResolveProperties?.resolved??!1}return!1},l=e=>{try{return Object.values(e.general).some(e=>e?.replies?.some(n=>n&&n.parentId!==e.id))}catch{return!1}};n.exports.findCommentInData=a,n.exports.selectUpdateFunction=(e,n,t)=>e?n:t,n.exports.findRootCommentForReply=(e,n)=>{for(let t of e)if(t?.id===n||t?.replies.find(e=>e?.id===n))return t},n.exports.findAndFilterComment=(e,n,t,o)=>{let r;if(0!==e.length){if((n?r=a(e,n):t&&(r=i(e,t)),r)&&(e=>{if(!e||!e.contentStatus)return!1;let n=e.contentStatus.toUpperCase();return o.includes(n)})(r))return r}},n.exports.resolveInlineCommentInCacheCallback=(n,t)=>{let o=t?.data?.resolveInlineComment,a=o?.status??!1,i=o?.resolveProperties??void 0;return(0,e("jbF1h").resolveCommentInCache)({comment:n,mutationStatus:a,resolveProperties:i})},n.exports.resolveCommentInCacheCallback=(n,t)=>{let o=t?.data?.confluence_resolveComments?.commentResolutionStates;if((o?.length??0)>1)throw Error("resolveCommentInCacheCallback() only supports one comment resolution state per mutation call");let a=o?.[0]??void 0,i=a?.status??!1,r=a?.resolveProperties??void 0,l=r?{resolved:!0,isDangling:!1,resolvedUser:void 0,resolvedFriendlyDate:void 0,resolvedTime:void 0,...r}:void 0;return(0,e("jbF1h").resolveCommentInCache)({comment:n,mutationStatus:i,resolveProperties:l})},n.exports.reopenCommentInCacheCallback=(n,t)=>{let o=t?.data?.confluence_reopenComment?.commentResolutionStates;if(o){let t=o.status??!1,a={resolved:!1,isDangling:!1,resolvedUser:void 0,resolvedFriendlyDate:void 0,resolvedTime:void 0,...o.resolveProperties??void 0};return(0,e("jbF1h").resolveCommentInCache)({comment:n,mutationStatus:t,resolveProperties:a})}return(0,e("jbF1h").resolveCommentInCache)({comment:n,mutationStatus:!1,resolveProperties:void 0})},n.exports.buildDefaultCommentsContentStatusFilters=n=>n===e("cD1qu").PageMode.VIEW?["CURRENT","ARCHIVED"]:["CURRENT","ARCHIVED","DRAFT"],n.exports.categorizeComments=(e,n)=>{let t=[],o=[],a=[],i=[],s=[],d={inline:{},general:{}},m={},c={};for(let l of e)if(l&&n.includes(l.contentStatus?.toUpperCase())){if(t.push(l),l?.id&&(m[l.id]=l),l?.location?.type==="INLINE"&&!l?.parentId){let e=l.location;e?.inlineMarkerRef&&(c[e.inlineMarkerRef]=l)}if(l?.replies)for(let e of l.replies)e?.id&&(m[e.id]=e);let e=!r(l),n=l.location?.type==="INLINE"?"inline":"general",p={...l,type:n,isOpen:e,isUnread:!1,wasRemovedByAnotherUser:!1,replies:l.replies?.filter(e=>null!=e).map(e=>({...e,isUnread:!1,wasRemovedByAnotherUser:!1}))};if(e?(o.push(l),l?.location?.type==="INLINE"?a.push(l):l?.location?.type==="FOOTER"&&i.push(l)):s.push(l),l.location?.type==="INLINE"){let e="inlineMarkerRef"in l.location&&l.location.inlineMarkerRef||l.id;d.inline[e]=p}else l.location?.type==="FOOTER"&&(d.general[l.id]=p)}let p=l(d),u=t.length;return{allFilteredComments:t,openComments:o,openInlineComments:a,openFooterComments:i,resolvedComments:s,commentsDataMap:d,flatCommentsMap:m,flatMarkerRefMap:c,hasNestedComments:p,commentCount:u,hasAnyComments:u>0}}}),n("jbF1h",function(n,t){var o=e("42omo");let a=e("6nYhN").default;n.exports.useUpdateCommentInCache=()=>{let n=(0,e("fFmJj").useReadFragmentInterop)({fragmentSpec:a}),t=(0,e("ij4CE").useWriteFragmentInterop)({fragmentSpec:a});return{updateCommentInCache:(0,o.useCallback)(({mutationResult:e,commentId:o,updateCallback:a,onError:i})=>{if(!o)return void i?.(Error("Cannot update comment in cache: comment ID is missing"));try{let r=`Comment:${o}`,l=n({id:r});if(!l)return void i?.(Error(`Cannot update comment in cache: comment with ID ${o} not found in cache`));let s=a({...l},e);t({fragmentId:r,data:s})}catch(e){i?.(Error(`An error occurred when updating cached comment data: ${e}`));return}},[n,t])}},n.exports.resolveCommentInCache=({comment:e,mutationStatus:n,resolveProperties:t})=>{if(!n||!t)return e;let{__typename:o,isDangling:a,...i}=t,r=e.location,l={...r,..."commentResolveProperties"in r?{commentResolveProperties:{...r.commentResolveProperties,...i}}:{},..."inlineResolveProperties"in r?{inlineResolveProperties:{...r.inlineResolveProperties,...i,isDangling:a}}:{}};return{...e,location:l}},n.exports.updateCommentBodyInCacheCallback=(e,n)=>{let t=n?.data?.updateComment?.body?.value,o={...e.body,...t||""===t?{value:t}:{}},a=n?.data?.updateComment?.version,i=a?.by?.displayName,r=e.version?.by?{...e.version?.by,...i?{displayName:i}:{}}:void 0,l={...e.version,...a?.number?{number:a.number}:{},...a?.when?{when:a.when}:{},...r?{by:{...r}}:{}};return{...e,body:o,version:{...l}}}}),n("6nYhN",function(e,n){var t,o,a,i,r,l,s,d,m,c,p,u,C,k,y,v,F,f,h,S,I,R;let g=(t={kind:"ScalarField",name:"id"},o={kind:"ScalarField",name:"__typename"},a={kind:"ScalarField",name:"displayName"},i={kind:"ScalarField",name:"permissionType"},r={concreteType:"Icon",kind:"LinkedField",name:"profilePicture",plural:!1,selections:[{kind:"ScalarField",name:"path"}]},l={kind:"ScalarField",name:"type"},s={kind:"InlineFragment",selections:[{kind:"ScalarField",name:"accountId"}],type:"KnownUser"},m={args:[{kind:"Literal",name:"representation",value:"ATLAS_DOC_FORMAT"}],concreteType:"DocumentBody",kind:"LinkedField",name:"body",plural:!1,selections:d=[{kind:"ScalarField",name:"value"}],storageKey:'body(representation:"ATLAS_DOC_FORMAT")'},c={kind:"ScalarField",name:"contentStatus"},p={concreteType:"ConfluenceDate",kind:"LinkedField",name:"createdAt",plural:!1,selections:d},u={kind:"ScalarField",name:"createdAtNonLocalized"},C={concreteType:"Map_LinkType_String",kind:"LinkedField",name:"links",plural:!1,selections:[{kind:"ScalarField",name:"editui"},{kind:"ScalarField",name:"webui"}]},f={kind:"LinkedField",name:"location",plural:!1,selections:[o,l,{kind:"InlineFragment",selections:[{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"commentResolveProperties",plural:!1,selections:[k={kind:"ScalarField",name:"resolved"},y={kind:"ScalarField",name:"resolvedFriendlyDate"},v={kind:"ScalarField",name:"resolvedTime"},F={kind:"ScalarField",name:"resolvedUser"}]}],type:"FooterComment"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"inlineMarkerRef"},{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"inlineResolveProperties",plural:!1,selections:[{kind:"ScalarField",name:"isDangling"},k,y,v,F]},{kind:"ScalarField",name:"inlineText"}],type:"InlineComment"}]},{argumentDefinitions:[],kind:"Fragment",name:"useUpdateCommentInCacheFragment",selections:[t,{kind:"LinkedField",name:"author",plural:!1,selections:[o,a,i,r,l,s]},m,{concreteType:"Content",kind:"LinkedField",name:"container",plural:!1,selections:[t]},c,p,u,C,f,h={kind:"ScalarField",name:"parentId"},S={concreteType:"CommentPermissions",kind:"LinkedField",name:"permissions",plural:!1,selections:[{kind:"ScalarField",name:"isEditable"},{kind:"ScalarField",name:"isRemovable"},{kind:"ScalarField",name:"isResolvable"}]},{concreteType:"Comment",kind:"LinkedField",name:"replies",plural:!0,selections:[t,{kind:"LinkedField",name:"author",plural:!1,selections:[o,a,i,s,r]},m,c,p,u,C,f,h,S,{concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[o,a]},I={kind:"ScalarField",name:"number"},R={kind:"ScalarField",name:"when"}]}]},{concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[o,l,a,s]},{kind:"ScalarField",name:"friendlyWhen"},I,R]}],type:"Comment"});g.hash="b050d36387ca001aa3988c3e0f6d32bb",e.exports.default=g}),n("NYiei",function(n,t){var o=e("42omo");let a=["DRAFT","CURRENT","ARCHIVED","DELETED"],i=e("1Pttz").default,r=e=>({pageId:e,contentStatus:a,first:1500}),l=({cachedRootComments:e,totalCount:n,newComment:t,repliesCount:o})=>({updatedRootComments:[...e,t],updatedTotalCount:n+o+1,error:void 0}),s=({cachedRootComments:n,totalCount:t,newComment:o,repliesCount:a,parentId:i})=>{let r,l=t,s=(0,e("kgNLQ").findRootCommentForReply)(n,i);if(s){let e=[...s.replies||[],o];s.replies=e,l+=1+a}else r=Error(`Cannot add reply comment in cache: can not find parent comment with ID ${i}`);return{updatedRootComments:n,updatedTotalCount:l,error:r}},d=({cachedRootComments:e,newComment:n,totalCount:t})=>{let o=n?.parentId,a=n?.replies?.length||0;return o?s({cachedRootComments:e,totalCount:t,newComment:n,repliesCount:a,parentId:o}):l({cachedRootComments:e,totalCount:t,newComment:n,repliesCount:a})},m=({cachedRootComments:e,totalCount:n,commentId:t,repliesCount:o})=>{let a=n;return{updatedRootComments:e.filter(e=>e?.id!==t),updatedTotalCount:a-=1+o,error:void 0}},c=({cachedRootComments:n,totalCount:t,commentId:o,repliesCount:a,parentId:i})=>{let r,l=t,s=(0,e("kgNLQ").findRootCommentForReply)(n,i);if(s){let e=(s.replies||[]).filter(e=>e?.id!==o);s.replies=e,l-=1+a}else r=Error(`Cannot delete reply comment in cache: can not find parent comment with ID ${i}`);return{updatedRootComments:n,updatedTotalCount:l,error:r}},p=({cachedRootComments:n,commentId:t,totalCount:o})=>{let a=(0,e("kgNLQ").findCommentInData)(n,t);if(!a)return{updatedRootComments:[],updatedTotalCount:0,error:Error(`Cannot delete comment in cache: comment with ID ${t} not found`)};let i=a.parentId,r=a.replies?.length||0;return i?c({cachedRootComments:n,totalCount:o,commentId:t,repliesCount:r,parentId:i}):m({cachedRootComments:n,totalCount:o,commentId:t,repliesCount:r})};n.exports.MAX_COMMENTS_TO_RETURN=1500,n.exports.allContentStatuses=a,n.exports.useAllCommentsData=({contentId:n,options:t={}})=>{let{fetchPolicy:a="cache-first",onCompleted:l,onError:s}=t,m=(0,o.useCallback)(n=>{(n?.message?.search(/reactions/i)!==-1||n?.message?.search(/cc-pages/i)!==-1)&&(0,e("7Sm4c").markErrorAsHandled)(n),s?.(n)},[s]),c=!n||!!t.skip||!(0,e("6mKj3").expVal)("cc_comments_new_comments_data_manager","isEnabled",!1),u=(0,e("jMyy4").useQueryInterop)(i,{variables:r(n??""),skip:c,context:{single:!0},fetchPolicy:a,onCompleted:e=>{l?.(e)},onError:m}),C=(0,o.useCallback)(async()=>{try{return await u.refetch()}catch(e){m(e)}},[u,m]),k=(0,o.useCallback)(({newComment:t,onError:o})=>{try{let a=(0,e("l1uFv").readQueryInterop)({query:i,variables:r(n)}),l=(a?.comments?.nodes?[...a?.comments?.nodes]:[]).filter(e=>!!e),s=a?.comments?.totalCount||0,{updatedRootComments:m,updatedTotalCount:c,error:p}=d({cachedRootComments:l,newComment:t,totalCount:s});if(p)return void o?.(p);(0,e("fEmGS").writeQueryInterop)({query:i,variables:r(n),data:{comments:{nodes:m,totalCount:c,__typename:"PaginatedCommentList"}}})}catch(e){o?.(Error(`An error occurred when adding new comment to cache with ID ${t?.id}: ${e}`))}},[n]),y=(0,o.useCallback)(({commentId:t,onError:o})=>{try{let a=(0,e("l1uFv").readQueryInterop)({query:i,variables:r(n)}),l=(a?.comments?.nodes?[...a?.comments?.nodes]:[]).filter(e=>!!e),s=a?.comments?.totalCount||0,{updatedRootComments:d,updatedTotalCount:m,error:c}=p({cachedRootComments:l,commentId:t,totalCount:s});if(c)return void o?.(c);(0,e("fEmGS").writeQueryInterop)({query:i,variables:r(n),data:{comments:{nodes:d,totalCount:m,__typename:"PaginatedCommentList"}}})}catch(e){o?.(Error(`An error occurred when deleting cached comment with ID ${t}: ${e}`))}},[n]);return{loading:u.loading,error:u.error,refetch:C,data:u.data,addCommentInCache:k,deleteCommentInCache:y}}}),n("1Pttz",function(e,n){var t,o,a,i,r,l,s,d,m,c,p,u,C,k,y,v,F,f,h,S,I,R,g,b,T,L,D,A;let P=(t={defaultValue:null,kind:"LocalArgument",name:"contentStatus"},o={defaultValue:null,kind:"LocalArgument",name:"first"},a={defaultValue:null,kind:"LocalArgument",name:"pageId"},i={kind:"Variable",name:"pageId",variableName:"pageId"},r={kind:"ScalarField",name:"id"},l={kind:"ScalarField",name:"__typename"},s={kind:"ScalarField",name:"displayName"},d={kind:"ScalarField",name:"permissionType"},m={concreteType:"Icon",kind:"LinkedField",name:"profilePicture",plural:!1,selections:[{kind:"ScalarField",name:"path"}]},c={kind:"ScalarField",name:"type"},p={kind:"InlineFragment",selections:[{kind:"ScalarField",name:"accountId"}],type:"KnownUser"},C={args:[{kind:"Literal",name:"representation",value:"ATLAS_DOC_FORMAT"}],concreteType:"DocumentBody",kind:"LinkedField",name:"body",plural:!1,selections:u=[{kind:"ScalarField",name:"value"}],storageKey:'body(representation:"ATLAS_DOC_FORMAT")'},k={kind:"ScalarField",name:"contentStatus"},y={concreteType:"ConfluenceDate",kind:"LinkedField",name:"createdAt",plural:!1,selections:u},v={kind:"ScalarField",name:"createdAtNonLocalized"},F={concreteType:"Map_LinkType_String",kind:"LinkedField",name:"links",plural:!1,selections:[{kind:"ScalarField",name:"editui"},{kind:"ScalarField",name:"webui"}]},R={kind:"LinkedField",name:"location",plural:!1,selections:[l,c,{kind:"InlineFragment",selections:[{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"commentResolveProperties",plural:!1,selections:[f={kind:"ScalarField",name:"resolved"},h={kind:"ScalarField",name:"resolvedFriendlyDate"},S={kind:"ScalarField",name:"resolvedTime"},I={kind:"ScalarField",name:"resolvedUser"}]}],type:"FooterComment"},{kind:"InlineFragment",selections:[{kind:"ScalarField",name:"inlineMarkerRef"},{concreteType:"InlineCommentResolveProperties",kind:"LinkedField",name:"inlineResolveProperties",plural:!1,selections:[{kind:"ScalarField",name:"isDangling"},f,h,S,I]},{kind:"ScalarField",name:"inlineText"}],type:"InlineComment"}]},g={kind:"ScalarField",name:"parentId"},b={concreteType:"CommentPermissions",kind:"LinkedField",name:"permissions",plural:!1,selections:[{kind:"ScalarField",name:"isEditable"},{kind:"ScalarField",name:"isRemovable"},{kind:"ScalarField",name:"isResolvable"}]},T={args:[{kind:"Literal",name:"childType",value:"comment"},{kind:"Literal",name:"contentType",value:"page"},i],concreteType:"ReactionsSummaryResponse",kind:"LinkedField",name:"reactionsSummary",plural:!1,selections:[{kind:"ScalarField",name:"ari"},{kind:"ScalarField",name:"containerAri"},{kind:"ScalarField",name:"reactionsCount"},{concreteType:"ReactionsSummaryForEmoji",kind:"LinkedField",name:"reactionsSummaryForEmoji",plural:!0,selections:[r,{kind:"ScalarField",name:"count"},{kind:"ScalarField",name:"emojiId"},{kind:"ScalarField",name:"reacted"}]}]},{fragment:{argumentDefinitions:[t,o,a],kind:"Fragment",name:"useAllCommentsDataQuery",selections:A=[{args:[{kind:"Variable",name:"contentStatus",variableName:"contentStatus"},{kind:"Literal",name:"depth",value:"ROOT"},{kind:"Variable",name:"first",variableName:"first"},i],concreteType:"PaginatedCommentList",kind:"LinkedField",name:"comments",plural:!1,selections:[{concreteType:"Comment",kind:"LinkedField",name:"nodes",plural:!0,selections:[r,{kind:"LinkedField",name:"author",plural:!1,selections:[l,s,d,m,c,p]},C,{concreteType:"Content",kind:"LinkedField",name:"container",plural:!1,selections:[r]},k,y,v,F,R,g,b,T,{concreteType:"Comment",kind:"LinkedField",name:"replies",plural:!0,selections:[r,{kind:"LinkedField",name:"author",plural:!1,selections:[l,s,d,p,m]},C,k,y,v,F,R,g,b,T,{concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[l,s]},L={kind:"ScalarField",name:"number"},D={kind:"ScalarField",name:"when"}]}]},{concreteType:"Version",kind:"LinkedField",name:"version",plural:!1,selections:[{kind:"LinkedField",name:"by",plural:!1,selections:[l,c,s,p]},{kind:"ScalarField",name:"friendlyWhen"},L,D]}]},{kind:"ScalarField",name:"totalCount"},l]}],type:"Query"},kind:"Request",operation:{argumentDefinitions:[a,t,o],kind:"Operation",name:"useAllCommentsDataQuery",selections:A},params:{cacheID:"9e9dce87233142bdde0be6a1e1389db3",id:"ca81297f1557d2f17e9e2311bb04d63937ce1bd7af490b89946ebdfc85fc61e9",metadata:{},name:"useAllCommentsDataQuery",operationKind:"query",text:'query useAllCommentsDataQuery($pageId:ID!,$contentStatus:[GraphQLContentStatus],$first:Long!){comments(pageId:$pageId,contentStatus:$contentStatus,depth:ROOT,first:$first){nodes{id,author{__typename,displayName,permissionType,...on KnownUser{accountId,permissionType},profilePicture{path},type},body(representation:ATLAS_DOC_FORMAT){value},container{id},contentStatus,createdAt{value},createdAtNonLocalized,links{editui,webui},location{__typename,type,...on FooterComment{commentResolveProperties{resolved,resolvedFriendlyDate,resolvedTime,resolvedUser}},...on InlineComment{inlineMarkerRef,inlineResolveProperties{isDangling,resolved,resolvedFriendlyDate,resolvedTime,resolvedUser},inlineText}},parentId,permissions{isEditable,isRemovable,isResolvable},reactionsSummary(pageId:$pageId,contentType:"page",childType:"comment"){ari,containerAri,reactionsCount,reactionsSummaryForEmoji{id,count,emojiId,reacted}},replies{id,author{__typename,displayName,permissionType,...on KnownUser{accountId},profilePicture{path}},body(representation:ATLAS_DOC_FORMAT){value},contentStatus,createdAt{value},createdAtNonLocalized,links{editui,webui},location{__typename,type,...on FooterComment{commentResolveProperties{resolved,resolvedFriendlyDate,resolvedTime,resolvedUser}},...on InlineComment{inlineMarkerRef,inlineResolveProperties{isDangling,resolved,resolvedFriendlyDate,resolvedTime,resolvedUser},inlineText}},parentId,permissions{isEditable,isRemovable,isResolvable},reactionsSummary(pageId:$pageId,contentType:"page",childType:"comment"){ari,containerAri,reactionsCount,reactionsSummaryForEmoji{id,count,emojiId,reacted}},version{by{__typename,displayName},number,when}},version{by{__typename,type,displayName,...on KnownUser{accountId}},friendlyWhen,number,when}},totalCount,__typename}}'}});P.hash="f3f3f95ad61519f75dd5ba8d0cde2302",e.exports.default=P}),n("4L9ve",function(n,t){let o=()=>({allComments:[],allFilteredComments:[],openInlineComments:[],openFooterComments:[],resolvedComments:[],openComments:[],commentsDataMap:{inline:{},general:{}},flatCommentsMap:{},flatMarkerRefMap:{},hasNestedComments:!1,isDataProcessed:!1,commentCount:0,hasAnyComments:!1,error:void 0,refetch:void 0}),a=(0,e("1P1Tu").createStore)({initialState:o(),actions:{setProcessedData:e=>({setState:n,getState:t})=>{let o=t();n({...e,error:void 0,refetch:o.refetch})},setError:e=>({setState:n,getState:t})=>{n({...t(),error:e,isDataProcessed:!0})},setRefetch:e=>({setState:n,getState:t})=>{n({...t(),refetch:e})},clearProcessedData:()=>({setState:e})=>{e(o())}},name:"ProcessedCommentsDataStore"});(0,e("9zUhf").createHook)(a);let i=(0,e("9zUhf").createActionsHook)(a),r=(0,e("9zUhf").createStateHook)(a),l=e("4HDYO").defaultRegistry.getStore(a);n.exports.useProcessedCommentsDataActions=i,n.exports.useProcessedCommentsDataState=r,n.exports.getProcessedCommentsDataState=()=>l.storeState.getState()});
//# sourceMappingURL=CommentsPanelFilterMenu.67305c9d.js.map
