function e(e){return e&&e.__esModule?e.default:e}function t(e,t,a,r){Object.defineProperty(e,t,{get:a,set:r,enumerable:!0,configurable:!0})}var a=globalThis.parcelRequired477,r=a.register;r("2kB0r",function(t,r){var o=a("42omo");let i=(0,a("cgtv4").defineMessages)({classifyContent:{id:"data-classification.ellipsis-classification-menu-item.classify-content",defaultMessage:"Classify content"}});t.exports.EllipsisClassificationMenuItem=({elemBefore:t})=>{let{setIsClassificationModalOpen:r}=(0,a("40pD8").useClassificationModalDispatchContext)();return e(o).createElement(a("dAYOx").default,{key:"classify-content",onClick:()=>{r(!0)},elemBefore:t},e(o).createElement(a("gtD4K").default,i.classifyContent))}}),r("b66o6",function(e,t){let r=(0,a("jmjWc").LoadableLazy)({__loadable_id__:"O8EvX",name:"RevertEditorDialog",loader:async()=>(await a("ixTux")).RevertEditorDialog});e.exports.RevertEditorDialog=r}),r("ixTux",function(e,t){let r=a("4mJKd")(5);e.exports=Promise.all([r("hhss7"),r("23MlT")]).then(()=>a("1yiQ2"))}),r("4mJKd",function(e,t){e.exports=e=>t=>import(a("8tirZ").shardUrl(a("02nRr").resolve(t),e))}),r("8tirZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.applyShardToDomain=n,e.exports.domainShardingKey=void 0,e.exports.getDomainShardIndex=r,e.exports.shardUrl=function(e,t){return globalThis[a]?s(e,t):e},e.exports.shardUrlUnchecked=s;let a="__ATLASPACK_ENABLE_DOMAIN_SHARDS";function r(e,t){let a=t+1,r=e.split("").reduce((e,t)=>{let r=(e<<a)-e+t.charCodeAt(0);return r&r},0);return(r%=a)<0&&(r+=a),r}let o=/-\d+$/;function i(e){if(!o.test(e))return e;let t=e.lastIndexOf("-");return e.slice(0,t)}function n(e,t){let a=e.indexOf("."),r=0===t?"":`-${t-1}`;if(-1===a)return`${i(e)}${r}`;let o=i(e.slice(0,a));return`${o}${r}${e.slice(a)}`}function s(e,t){let a=new URL(e),o=r(function(e){let t=e.lastIndexOf("/");if(-1===t||t===e.length-1)throw Error("Expected an absolute URL with a file name, unable to apply sharding.");return e.slice(t+1)}(a.pathname),t);return a.hostname=n(a.hostname,o),a.toString()}e.exports.domainShardingKey=a}),r("02nRr",function(e,a){t(e.exports,"register",()=>r,e=>r=e),t(e.exports,"resolve",()=>o,e=>o=e);var r,o,i=new Map;r=function(e,t){for(var a=0;a<t.length-1;a+=2)i.set(t[a],{baseUrl:e,path:t[a+1]})},o=function(e){var t=i.get(e);if(null==t)throw Error("Could not resolve bundle with id "+e);return new URL(t.path,t.baseUrl).toString()}}),r("BCkug",function(t,r){var o=a("42omo");let i=(0,a("jmjWc").LoadableLazy)({__loadable_id__:"_DPHW",name:"ConvertToLivePageDialog",loader:async()=>(await a("aNhYR")).ConvertToLivePageDialog}),n=(0,a("eSUdr").default)`mutation ConvertPageToLiveEdit($contentId:ID!){convertPageToLiveEditAction(input:{contentId:$contentId}){success errors{message}}}`,s=(0,a("cgtv4").defineMessages)({titleConflictFlagTitle:{id:"live-pages-features.converttolivepage.draft-conversion-title-conflict.title",defaultMessage:"Unable to convert draft to live page"},genericErrorFlagTitle:{id:"live-pages-features.converttolivepage.generic-error.title",defaultMessage:"An error occurred"}}),l=(0,a("cgtv4").defineMessages)({titleConflictFlagTitle:{id:"live-pages-features.converttolivepage.draft-conversion-title-conflict.title.livedocs",defaultMessage:"Unable to convert draft to live doc"}}),c=(0,a("jhwJP").mergeLiveDocI18n)(s,l),d=async(e,t)=>{let r=[];return r.push((0,a("fyUox").preloadPageTitleContentProperties)({contentId:e,spaceKey:t,fetchPolicy:"network-only"})),r.push((0,a("irrTO").preloadDraftContentAppearance)(e,!1)),Promise.all(r)},g=async({contentId:t,spaceId:r="",onSuccess:i,flags:s,retrieveEditorTitleAndContent:l})=>{try{let{data:g}=await (0,a("hp2SH").getApolloClient)().mutate({mutation:n,variables:{contentId:t},update:(e,{data:r})=>{r?.convertPageToLiveEditAction?.success&&(e.writeFragment({id:`Content:${t}`,fragment:(0,a("eSUdr").default)`fragment SubTypeUpdate on Content{subType}`,data:{__typename:"Content",subType:"live"}}),(0,a("9sGCn").clearMemoizedCachedPageData)())}}),u=g?.convertPageToLiveEditAction;if(u?.success){await d(t,r).catch(()=>{}),i();return}u.errors.forEach(async r=>{(0,a("6LFAK").processError)(r,t);let i="Title already exists"===r.message?c.titleConflictFlagTitle:c.genericErrorFlagTitle,n=(0,a("6LFAK").getI18nStringForError)(r.message),d={};if("Title already exists"===r.message){let{title:e}=await l();d.pageTitle=e||""}s.showErrorFlag({title:e(o).createElement(a("gtD4K").default,i),description:e(o).createElement(a("gtD4K").default,{...n,values:d}),isAutoDismiss:!1})})}catch(r){(0,a("6LFAK").processError)(r,t),s.showErrorFlag({title:e(o).createElement(a("gtD4K").default,c.genericErrorFlagTitle),description:e(o).createElement(a("gtD4K").default,a("6LFAK").i18n.unknownError),isAutoDismiss:!1})}};t.exports.useSwitchToLivePage=e=>{let{contentId:t,spaceId:r,isUnpublishedDraft:n,analyticsSource:s,adfOrigin:l,onSuccessfulConversion:c,retrieveEditorTitleAndContent:d,flags:u,saveDraft:v}=e,{createAnalyticsEvent:p}=(0,a("inPa6").useAnalyticsEvents)(),{showModal:f}=(0,a("8aF6s").useDialogs)(),m=(0,a("jv3O2").useShowConvertToLivePageFlag)({flags:u}),h=(0,o.useCallback)(()=>{p?.({type:"sendUIEvent",data:{action:"convertedToLivePage",actionSubject:"page",source:s,objectId:t,objectType:"page",containerId:r,containerType:"space",attributes:{isDraft:n}}}).fire(),c?.(),m({converterWasCurrentUser:!0})},[p,s,t,r,n,c,m]);return(0,o.useCallback)(async()=>{p?.({type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"switchToLiveEdit",source:s,objectId:t,objectType:"page",containerId:r,containerType:"space",attributes:{isDraft:n}}}).fire(),n?(await v?.(),g({contentId:t,spaceId:r,onSuccess:h,flags:u,retrieveEditorTitleAndContent:d})):f(i,{contentId:t,onConfirm:h,adfOrigin:l,retrieveEditorTitleAndContent:d})},[p,s,t,r,n,f,h,l,d,u,v])}}),r("aNhYR",function(e,t){let r=a("4mJKd")(5);e.exports=Promise.all([r("6wr18"),r("Wowvf"),r("hhss7"),r("ffEVr"),r("RU02s")]).then(()=>a("9Pjdf"))}),r("6LFAK",function(e,t){let r=(0,a("cgtv4").defineMessages)({unknownError:{id:"live-pages-features.converttolivepage.modal.error.unknown",defaultMessage:"An error occurred. Please try again."},serverException:{id:"live-pages-features.converttolivepage.modal.error.serverException",defaultMessage:"An unexpected error occurred. Please try again later."},pageNotFound:{id:"live-pages-features.converttolivepage.modal.error.pageNotFound",defaultMessage:"The page you’re trying to edit doesn‘t exist."},contentServiceException:{id:"live-pages-features.converttolivepage.modal.error.contentServiceException",defaultMessage:"The requested content is not available."},pageAlreadyLive:{id:"live-pages-features.converttolivepage.modal.error.pageAlreadyLive",defaultMessage:"This page has already been switched to a live page."},legacyPageConversionError:{id:"live-pages-features.converttolivepage.modal.error.legacyPageConversionError",defaultMessage:"This page can’t be switched to a live page due to its outdated format."},noEditPermissions:{id:"live-pages-features.converttolivepage.modal.error.noEditPermissions",defaultMessage:"You don’t have the necessary permissions to switch this to a live page."},draftTitleConflict:{id:"live-pages-features.converttolivepage.draft-conversion-title-conflict.description",defaultMessage:"There’s already content named “{pageTitle}” in this space. Give this page a unique title."},viewScreenTitleConflict:{id:"live-pages-features.converttolivepage.modal.error.view-screen-conversion-title-conflict",defaultMessage:"There’s already content with this page’s updated title in the space. Give this page a unique title."}}),o=(0,a("cgtv4").defineMessages)({pageAlreadyLive:{id:"live-pages-features.converttolivepage.modal.error.pageAlreadyLive.livedocs",defaultMessage:"This page has already been converted to a live doc."},legacyPageConversionError:{id:"live-pages-features.converttolivepage.modal.error.legacyPageConversionError.livedocs",defaultMessage:"This page can’t be converted to a live doc due to its outdated format."},noEditPermissions:{id:"live-pages-features.converttolivepage.modal.error.noEditPermissions.livedocs",defaultMessage:"You don’t have the necessary permissions to convert this to a live doc."},draftTitleConflict:{id:"live-pages-features.converttolivepage.draft-conversion-title-conflict.description.livedocs",defaultMessage:"There’s already content named “{pageTitle}” in this space. Give this page a unique title."}}),i=(0,a("jhwJP").mergeLiveDocI18n)(r,o),n={serverException:"Some server exception",pageNotFound:"Page not found with provided id",contentServiceException:"Content service exception",pageAlreadyLive:"Page subtype is already set to live",legacyPageConversionError:"Legacy page cannot be converted to live edit",noEditPermissions:"Page cannot be converted without edit permissions",draftTitleConflict:"Title already exists"},s=Object.entries(n).reduce((e,[t,a])=>({...e,[a]:t}),{}),l=[n.draftTitleConflict,n.pageAlreadyLive,n.noEditPermissions,n.pageNotFound],c=(e,t)=>{(0,a("fJlJm").setContentErrorAttributes)(e,{objectId:t}),(0,a("5ZqQS").getMonitoringClient)().submitError(e,{attribution:a("3IBnw").Attribution.PAGE_MODES})};e.exports.i18n=i,e.exports.getI18nStringForError=e=>i[s[e]]||i.unknownError,e.exports.processError=(e,t)=>{let r;e instanceof Error||e instanceof a("422HI").ApolloErrorInterop?r=e:(r=Error(e?.message||"Unknown error"),e?.__typename&&(r.name=e?.__typename));let o=l.includes(r.message);return(0,a("1uFM6").isUnauthorizedError)(r)||(0,a("6fil2").containsNetworkError)(r)||o?((0,a("7Sm4c").markErrorAsHandled)(r),{isHandled:!0}):(c(r,t),{isHandled:!1})}}),r("9BVDK",function(e,t){let r=(0,a("jmjWc").LoadableAfterPaint)({__loadable_id__:"N5Ue8",name:"ResolvedInlineCommentsCounterLoader",loader:async()=>(await a("1Fl3l")).ResolvedInlineCommentsCounter});e.exports.ResolvedInlineCommentsCounterLoader=r}),r("1Fl3l",function(e,t){e.exports=a("4mJKd")(5)("aS96v").then(()=>a("79cvA"))}),r("l3C2L",function(e,t){let r=(0,a("jmjWc").LoadableLazy)({__loadable_id__:"9P0ef",name:"ViewChangesDialogLoader",loader:async()=>(await a("4PsmB")).ViewChangesDialog});e.exports.ViewChangesDialogLoader=r}),r("4PsmB",function(e,t){e.exports=a("4mJKd")(5)("lJJQ8").then(()=>a("iDTLl"))});
//# sourceMappingURL=EllipsisDropdown.0a023985.js.map
