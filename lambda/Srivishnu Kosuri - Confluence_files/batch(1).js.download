WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'confluence.web.resources:dompurify', location = '/dompurify/dist/purify.js' */
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,u){if(u.get||u.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=u.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var c,u=[];!(c=a.next()).done;)u.push(c.value);return u};$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};
(function(a,c){"object"===typeof exports&&"undefined"!==typeof module?module.exports=c():"function"===typeof define&&define.amd?define(c):(a="undefined"!==typeof globalThis?globalThis:a||self,a.DOMPurify=c())})(this,function(){function a(c){return function(a){for(var g=arguments.length,h=Array(1<g?g-1:0),f=1;f<g;f++)h[f-1]=arguments[f];return C(c,a,h)}}function c(c,a){var g=2<arguments.length&&void 0!==arguments[2]?arguments[2]:W;X&&X(c,null);for(var h=a.length;h--;){var f=a[h];if("string"===typeof f){var d=
g(f);d!==f&&(fa(a)||(a[h]=d),f=d)}c[f]=!0}return c}function u(a){for(var c=Ha(null),g=$jscomp.makeIterator(Ia(a)),d=g.next();!d.done;d=g.next()){var f=$jscomp.makeIterator(d.value),d=f.next().value,f=f.next().value;if(y(a,d))if(Array.isArray(f)){for(var l=0;l<f.length;l++)y(f,l)||(f[l]=null);c[d]=f}else c[d]=f&&"object"===typeof f&&f.constructor===Object?u(f):f}return c}function Y(c,h){for(;null!==c;){var g=ga(c,h);if(g){if(g.get)return a(g.get);if("function"===typeof g.value)return a(g.value)}c=
ha(c)}return function(){return null}}function Ja(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window,h=function(b){return Ja(b)};h.version="3.1.3";h.removed=[];if(!a||!a.document||a.document.nodeType!==D.document)return h.isSupported=!1,h;var d=a.document,V=d,f=V.currentScript,z=a.DocumentFragment,m=a.HTMLTemplateElement,C=a.Node,L=a.Element,M=a.NodeFilter,X=void 0===a.NamedNodeMap?a.NamedNodeMap||a.MozNamedAttrMap:a.NamedNodeMap,fa=a.HTMLFormElement,
ga=a.DOMParser,Z=a.trustedTypes,a=L.prototype,ha=Y(a,"cloneNode"),Ba=Y(a,"nextSibling"),Ca=Y(a,"childNodes"),N=Y(a,"parentNode");"function"===typeof m&&(m=d.createElement("template"),m.content&&m.content.ownerDocument&&(d=m.content.ownerDocument));var r,O="",m=d,ia=m.implementation,Da=m.createNodeIterator,Ea=m.createDocumentFragment,Fa=m.getElementsByTagName,Ga=V.importNode,A={};h.isSupported="function"===typeof Ia&&"function"===typeof N&&ia&&void 0!==ia.createHTMLDocument;var m=Ka,ja=m.MUSTACHE_EXPR,
ka=m.ERB_EXPR,la=m.TMPLIT_EXPR,ub=m.DATA_ATTR,vb=m.ARIA_ATTR,wb=m.IS_SCRIPT_OR_DATA,La=m.ATTR_WHITESPACE,Ma=m.CUSTOM_ELEMENT,Na=Ka.IS_ALLOWED_URI,n=null,Qa=c({},[].concat($jscomp.arrayFromIterable(Oa),$jscomp.arrayFromIterable(ma),$jscomp.arrayFromIterable(na),$jscomp.arrayFromIterable(oa),$jscomp.arrayFromIterable(Pa))),p=null,Ta=c({},[].concat($jscomp.arrayFromIterable(Ra),$jscomp.arrayFromIterable(pa),$jscomp.arrayFromIterable(Sa),$jscomp.arrayFromIterable(aa))),k=Object.seal(Ha(null,{tagNameCheck:{writable:!0,
configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),P=null,qa=null,Ua=!0,ra=!0,Va=!1,Wa=!0,F=!1,sa=!0,E=!1,ta=!1,ua=!1,G=!1,ba=!1,ca=!1,Xa=!0,Ya=!1,va=!0,Q=!1,H={},I=null,Za=c({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),
$a=null,ab=c({},"audio video img source image track".split(" ")),wa=null,bb=c({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),J="http://www.w3.org/1999/xhtml",cb=!1,xa=null,xb=c({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],ya),R=null,yb=["application/xhtml+xml","text/html"],q=null,K=null,zb=d.createElement("form"),db=function(b){return b instanceof RegExp||b instanceof Function},za=function(){var b=
0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(!K||K!==b){b&&"object"===typeof b||(b={});b=u(b);R=-1===yb.indexOf(b.PARSER_MEDIA_TYPE)?"text/html":b.PARSER_MEDIA_TYPE;q="application/xhtml+xml"===R?ya:W;n=y(b,"ALLOWED_TAGS")?c({},b.ALLOWED_TAGS,q):Qa;p=y(b,"ALLOWED_ATTR")?c({},b.ALLOWED_ATTR,q):Ta;xa=y(b,"ALLOWED_NAMESPACES")?c({},b.ALLOWED_NAMESPACES,ya):xb;wa=y(b,"ADD_URI_SAFE_ATTR")?c(u(bb),b.ADD_URI_SAFE_ATTR,q):bb;$a=y(b,"ADD_DATA_URI_TAGS")?c(u(ab),b.ADD_DATA_URI_TAGS,q):ab;I=y(b,
"FORBID_CONTENTS")?c({},b.FORBID_CONTENTS,q):Za;P=y(b,"FORBID_TAGS")?c({},b.FORBID_TAGS,q):{};qa=y(b,"FORBID_ATTR")?c({},b.FORBID_ATTR,q):{};H=y(b,"USE_PROFILES")?b.USE_PROFILES:!1;Ua=!1!==b.ALLOW_ARIA_ATTR;ra=!1!==b.ALLOW_DATA_ATTR;Va=b.ALLOW_UNKNOWN_PROTOCOLS||!1;Wa=!1!==b.ALLOW_SELF_CLOSE_IN_ATTR;F=b.SAFE_FOR_TEMPLATES||!1;sa=!1!==b.SAFE_FOR_XML;E=b.WHOLE_DOCUMENT||!1;G=b.RETURN_DOM||!1;ba=b.RETURN_DOM_FRAGMENT||!1;ca=b.RETURN_TRUSTED_TYPE||!1;ua=b.FORCE_BODY||!1;Xa=!1!==b.SANITIZE_DOM;Ya=b.SANITIZE_NAMED_PROPS||
!1;va=!1!==b.KEEP_CONTENT;Q=b.IN_PLACE||!1;Na=b.ALLOWED_URI_REGEXP||eb;J=b.NAMESPACE||"http://www.w3.org/1999/xhtml";k=b.CUSTOM_ELEMENT_HANDLING||{};b.CUSTOM_ELEMENT_HANDLING&&db(b.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(k.tagNameCheck=b.CUSTOM_ELEMENT_HANDLING.tagNameCheck);b.CUSTOM_ELEMENT_HANDLING&&db(b.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(k.attributeNameCheck=b.CUSTOM_ELEMENT_HANDLING.attributeNameCheck);b.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof b.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&
(k.allowCustomizedBuiltInElements=b.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements);F&&(ra=!1);ba&&(G=!0);H&&(n=c({},Pa),p=[],!0===H.html&&(c(n,Oa),c(p,Ra)),!0===H.svg&&(c(n,ma),c(p,pa),c(p,aa)),!0===H.svgFilters&&(c(n,na),c(p,pa),c(p,aa)),!0===H.mathMl&&(c(n,oa),c(p,Sa),c(p,aa)));b.ADD_TAGS&&(n===Qa&&(n=u(n)),c(n,b.ADD_TAGS,q));b.ADD_ATTR&&(p===Ta&&(p=u(p)),c(p,b.ADD_ATTR,q));b.ADD_URI_SAFE_ATTR&&c(wa,b.ADD_URI_SAFE_ATTR,q);b.FORBID_CONTENTS&&(I===Za&&(I=u(I)),c(I,b.FORBID_CONTENTS,q));va&&
(n["#text"]=!0);E&&c(n,["html","head","body"]);n.table&&(c(n,["tbody"]),delete P.tbody);if(b.TRUSTED_TYPES_POLICY){if("function"!==typeof b.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!==typeof b.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');r=b.TRUSTED_TYPES_POLICY;O=r.createHTML("")}else void 0===r&&(r=Ab(Z,f)),null!==r&&"string"===
typeof O&&(O=r.createHTML(""));l&&l(b);K=b}},fb=c({},["mi","mo","mn","ms","mtext"]),gb=c({},["foreignobject","annotation-xml"]),Bb=c({},["title","style","font","a","script"]),hb=c({},[].concat($jscomp.arrayFromIterable(ma),$jscomp.arrayFromIterable(na),$jscomp.arrayFromIterable(Cb))),ib=c({},[].concat($jscomp.arrayFromIterable(oa),$jscomp.arrayFromIterable(Db))),Eb=function(b){var v=N(b);v&&v.tagName||(v={namespaceURI:J,tagName:"template"});var a=W(b.tagName),c=W(v.tagName);return xa[b.namespaceURI]?
"http://www.w3.org/2000/svg"===b.namespaceURI?"http://www.w3.org/1999/xhtml"===v.namespaceURI?"svg"===a:"http://www.w3.org/1998/Math/MathML"===v.namespaceURI?"svg"===a&&("annotation-xml"===c||fb[c]):!!hb[a]:"http://www.w3.org/1998/Math/MathML"===b.namespaceURI?"http://www.w3.org/1999/xhtml"===v.namespaceURI?"math"===a:"http://www.w3.org/2000/svg"===v.namespaceURI?"math"===a&&gb[c]:!!ib[a]:"http://www.w3.org/1999/xhtml"===b.namespaceURI?"http://www.w3.org/2000/svg"===v.namespaceURI&&!gb[c]||"http://www.w3.org/1998/Math/MathML"===
v.namespaceURI&&!fb[c]?!1:!ib[a]&&(Bb[a]||!hb[a]):"application/xhtml+xml"===R&&xa[b.namespaceURI]?!0:!1:!1},x=function(b){T(h.removed,{element:b});try{b.parentNode.removeChild(b)}catch(v){b.remove()}},da=function(b,a){try{T(h.removed,{attribute:a.getAttributeNode(b),from:a})}catch(jb){T(h.removed,{attribute:null,from:a})}a.removeAttribute(b);if("is"===b&&!p[b])if(G||ba)try{x(a)}catch(jb){}else try{a.setAttribute(b,"")}catch(jb){}},kb=function(b){var a=null,c=null;ua?b="\x3cremove\x3e\x3c/remove\x3e"+
b:c=(c=Aa(b,/^[\r\n\t ]+/))&&c[0];"application/xhtml+xml"===R&&"http://www.w3.org/1999/xhtml"===J&&(b='\x3chtml xmlns\x3d"http://www.w3.org/1999/xhtml"\x3e\x3chead\x3e\x3c/head\x3e\x3cbody\x3e'+b+"\x3c/body\x3e\x3c/html\x3e");var w=r?r.createHTML(b):b;if("http://www.w3.org/1999/xhtml"===J)try{a=(new ga).parseFromString(w,R)}catch(e){}if(!a||!a.documentElement){a=ia.createDocument(J,"template",null);try{a.documentElement.innerHTML=cb?O:w}catch(e){}}w=a.body||a.documentElement;b&&c&&w.insertBefore(d.createTextNode(c),
w.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===J?Fa.call(a,E?"html":"body")[0]:E?a.documentElement:w},lb=function(b){return Da.call(b.ownerDocument||b,b,M.SHOW_ELEMENT|M.SHOW_COMMENT|M.SHOW_TEXT|M.SHOW_PROCESSING_INSTRUCTION|M.SHOW_CDATA_SECTION,null)},mb=function(b){return b instanceof fa&&("undefined"!==typeof b.__depth&&"number"!==typeof b.__depth||"undefined"!==typeof b.__removalCount&&"number"!==typeof b.__removalCount||"string"!==typeof b.nodeName||"string"!==typeof b.textContent||
"function"!==typeof b.removeChild||!(b.attributes instanceof X)||"function"!==typeof b.removeAttribute||"function"!==typeof b.setAttribute||"string"!==typeof b.namespaceURI||"function"!==typeof b.insertBefore||"function"!==typeof b.hasChildNodes)},nb=function(b){return"function"===typeof C&&b instanceof C},B=function(b,a,c){A[b]&&ea(A[b],function(b){b.call(h,a,c,K)})},ob=function(b){var a=null;B("beforeSanitizeElements",b,null);if(mb(b))return x(b),!0;var c=q(b.nodeName);B("uponSanitizeElement",b,
{tagName:c,allowedTags:n});if(b.hasChildNodes()&&!nb(b.firstElementChild)&&t(/<[/\w]/g,b.innerHTML)&&t(/<[/\w]/g,b.textContent)||b.nodeType===D.progressingInstruction||sa&&b.nodeType===D.comment&&t(/<[/\w]/g,b.data))return x(b),!0;if(!n[c]||P[c]){if(!P[c]&&"annotation-xml"!==c&&Aa(c,Ma)&&(k.tagNameCheck instanceof RegExp&&t(k.tagNameCheck,c)||k.tagNameCheck instanceof Function&&k.tagNameCheck(c)))return!1;if(va&&!I[c]){var c=N(b)||b.parentNode,w=Ca(b)||b.childNodes;if(w&&c)for(var e=w.length-1;0<=
e;--e){var d=ha(w[e],!0);d.__removalCount=(b.__removalCount||0)+1;c.insertBefore(d,Ba(b))}}x(b);return!0}if(b instanceof L&&!Eb(b)||("noscript"===c||"noembed"===c||"noframes"===c)&&t(/<\/no(script|embed|frames)/i,b.innerHTML))return x(b),!0;F&&b.nodeType===D.text&&(a=b.textContent,ea([ja,ka,la],function(b){a=U(a,b," ")}),b.textContent!==a&&(T(h.removed,{element:b.cloneNode()}),b.textContent=a));B("afterSanitizeElements",b,null);return!1},pb=function(b,a,c){if(Xa&&("id"===a||"name"===a)&&(c in d||
c in zb||"__depth"===c||"__removalCount"===c))return!1;if(!ra||qa[a]||!t(ub,a))if(!Ua||!t(vb,a))if(!p[a]||qa[a]){if(!("annotation-xml"!==b&&Aa(b,Ma)&&(k.tagNameCheck instanceof RegExp&&t(k.tagNameCheck,b)||k.tagNameCheck instanceof Function&&k.tagNameCheck(b))&&(k.attributeNameCheck instanceof RegExp&&t(k.attributeNameCheck,a)||k.attributeNameCheck instanceof Function&&k.attributeNameCheck(a))||"is"===a&&k.allowCustomizedBuiltInElements&&(k.tagNameCheck instanceof RegExp&&t(k.tagNameCheck,c)||k.tagNameCheck instanceof
Function&&k.tagNameCheck(c))))return!1}else if(!(wa[a]||t(Na,U(c,La,""))||("src"===a||"xlink:href"===a||"href"===a)&&"script"!==b&&0===Fb(c,"data:")&&$a[b]||Va&&!t(wb,U(c,La,"")))&&c)return!1;return!0},rb=function(b){B("beforeSanitizeAttributes",b,null);var a=b.attributes;if(a){for(var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:p},w=a.length,e={};w--;){var d=a[w],g=d.name,f=d.namespaceURI,k=d.value,d=q(g);e.value="value"===g?k:Gb(k);c.attrName=d;c.attrValue=e.value;c.keepAttr=!0;c.forceKeepAttr=
void 0;B("uponSanitizeAttribute",b,c);e.value=c.attrValue;if(!c.forceKeepAttr&&(da(g,b),c.keepAttr))if(!Wa&&t(/\/>/i,e.value))da(g,b);else if(sa&&t(/((--!?|])>)|<\/(style|title)/i,e.value))da(g,b);else if(F&&ea([ja,ka,la],function(b){return function(a){b.value=U(b.value,a," ")}}(e)),k=q(b.nodeName),pb(k,d,e.value)){!Ya||"id"!==d&&"name"!==d||(da(g,b),e.value="user-content-"+e.value);if(r&&"object"===typeof Z&&"function"===typeof Z.getAttributeType&&!f)switch(Z.getAttributeType(k,d)){case "TrustedHTML":e.value=
r.createHTML(e.value);break;case "TrustedScriptURL":e.value=r.createScriptURL(e.value)}try{f?b.setAttributeNS(f,g,e.value):b.setAttribute(g,e.value),mb(b)?x(b):qb(h.removed)}catch(Ib){}e={value:e.value}}}B("afterSanitizeAttributes",b,null)}},Hb=function v(a){var c,e=lb(a);for(B("beforeSanitizeShadowDOM",a,null);c=e.nextNode();)if(B("uponSanitizeShadowNode",c,null),!ob(c)){var d=N(c);c.nodeType===D.element&&(c.__depth=d&&d.__depth?(c.__removalCount||0)+d.__depth+1:1);(255<=c.__depth||0>c.__depth||
sb(c.__depth))&&x(c);c.content instanceof z&&(c.content.__depth=c.__depth,v(c.content));rb(c)}B("afterSanitizeShadowDOM",a,null)};h.sanitize=function(a){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},d=null,e=null,e=e=null;(cb=!a)&&(a="\x3c!--\x3e");if("string"!==typeof a&&!nb(a))if("function"===typeof a.toString){if(a=a.toString(),"string"!==typeof a)throw S("dirty is not a string, aborting");}else throw S("toString is not a function");if(!h.isSupported)return a;ta||za(c);h.removed=
[];"string"===typeof a&&(Q=!1);if(Q){if(a.nodeName&&(c=q(a.nodeName),!n[c]||P[c]))throw S("root node is forbidden and cannot be sanitized in-place");}else if(a instanceof C)d=kb("\x3c!----\x3e"),e=d.ownerDocument.importNode(a,!0),e.nodeType===D.element&&"BODY"===e.nodeName?d=e:"HTML"===e.nodeName?d=e:d.appendChild(e);else{if(!G&&!F&&!E&&-1===a.indexOf("\x3c"))return r&&ca?r.createHTML(a):a;d=kb(a);if(!d)return G?null:ca?O:""}d&&ua&&x(d.firstChild);for(c=lb(Q?a:d);e=c.nextNode();)if(!ob(e)){var g=
N(e);e.nodeType===D.element&&(e.__depth=g&&g.__depth?(e.__removalCount||0)+g.__depth+1:1);(255<=e.__depth||0>e.__depth||sb(e.__depth))&&x(e);e.content instanceof z&&(e.content.__depth=e.__depth,Hb(e.content));rb(e)}if(Q)return a;if(G){if(ba)for(e=Ea.call(d.ownerDocument);d.firstChild;)e.appendChild(d.firstChild);else e=d;if(p.shadowroot||p.shadowrootmode)e=Ga.call(V,e,!0);return e}var f=E?d.outerHTML:d.innerHTML;E&&n["!doctype"]&&d.ownerDocument&&d.ownerDocument.doctype&&d.ownerDocument.doctype.name&&
t(tb,d.ownerDocument.doctype.name)&&(f="\x3c!DOCTYPE "+d.ownerDocument.doctype.name+"\x3e\n"+f);F&&ea([ja,ka,la],function(a){f=U(f,a," ")});return r&&ca?r.createHTML(f):f};h.setConfig=function(){za(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{});ta=!0};h.clearConfig=function(){K=null;ta=!1};h.isValidAttribute=function(a,c,d){K||za({});a=q(a);c=q(c);return pb(a,c,d)};h.addHook=function(a,c){"function"===typeof c&&(A[a]=A[a]||[],T(A[a],c))};h.removeHook=function(a){if(A[a])return qb(A[a])};
h.removeHooks=function(a){A[a]&&(A[a]=[])};h.removeAllHooks=function(){A={}};return h}var d=Object,Ia=d.entries,X=d.setPrototypeOf,fa=d.isFrozen,ha=d.getPrototypeOf,ga=d.getOwnPropertyDescriptor,z=Object,l=z.freeze,d=z.seal,Ha=z.create,z="undefined"!==typeof Reflect&&Reflect,C=z.apply,L=z.construct;l||(l=function(a){return a});d||(d=function(a){return a});C||(C=function(a,c,d){return a.apply(c,d)});L||(L=function(a,c){return new (Function.prototype.bind.apply(a,[null].concat($jscomp.arrayFromIterable(c))))});
var ea=a(Array.prototype.forEach),qb=a(Array.prototype.pop),T=a(Array.prototype.push),W=a(String.prototype.toLowerCase),ya=a(String.prototype.toString),Aa=a(String.prototype.match),U=a(String.prototype.replace),Fb=a(String.prototype.indexOf),Gb=a(String.prototype.trim),y=a(Object.prototype.hasOwnProperty),t=a(RegExp.prototype.test),S=function(a){return function(){for(var c=arguments.length,d=Array(c),g=0;g<c;g++)d[g]=arguments[g];return L(a,d)}}(TypeError),sb=a(Number.isNaN),Oa=l("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
ma=l("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),na=l("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feDropShadow feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
Cb=l("animate color-profile cursor discard font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),oa=l("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover mprescripts".split(" ")),Db=l("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
Pa=l(["#text"]),Ra=l("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width wrap xmlns slot".split(" ")),
pa=l("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Sa=l("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
aa=l(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ba=d(/<%[\w\W]*|[\w\W]*%>/gm),Ca=d(/\${[\w\W]*}/gm),Da=d(/^data-[\-\w.\u00B7-\uFFFF]/),Ea=d(/^aria-[\-\w]+$/),eb=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Fa=d(/^(?:\w+script|data):/i),Ga=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),tb=d(/^html$/i),d=d(/^[a-z][.\w]*(-[.\w]+)+$/i),Ka=Object.freeze({__proto__:null,MUSTACHE_EXPR:z,
ERB_EXPR:Ba,TMPLIT_EXPR:Ca,DATA_ATTR:Da,ARIA_ATTR:Ea,IS_ALLOWED_URI:eb,IS_SCRIPT_OR_DATA:Fa,ATTR_WHITESPACE:Ga,DOCTYPE_NAME:tb,CUSTOM_ELEMENT:d}),D={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},Ab=function(a,c){if("object"!==typeof a||"function"!==typeof a.createPolicy)return null;var d=null;c&&c.hasAttribute("data-tt-policy-suffix")&&(d=c.getAttribute("data-tt-policy-suffix"));
c="dompurify"+(d?"#"+d:"");try{return a.createPolicy(c,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch(V){return console.warn("TrustedTypes policy "+c+" could not be created."),null}};return Ja()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dictionary', location = 'includes/js/api/dictionary.js' */
define("confluence/api/dictionary",[],function(){return function(){var a={};return{get:function(b){return a[b]},put:function(b,c){return a[b]=c},reset:function(){a={}},elements:function(){return a}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:macro-js-overrides', location = 'includes/js/macro-js-overrides.js' */
define("confluence/macro-js-overrides",["confluence/api/dictionary","underscore"],function(e,d){var b=new e;return d.extend(b,{getFunction:function(a,c){if((a=b.get(a))&&"function"===typeof a[c])return a[c]},assignFunction:function(a,c){b.put(a,d.extend({},b.get(a),c))},DEPRECATED_MACROS:"chart contributors-summary gallery google-drive-docs google-drive-sheets google-drive-slides index viewppt viewdoc recently-updated-dashboard related-labels spaces span".split(" "),DEPRECATED_MACRO_GATES:{chart:"confluence_deprecate_chart_macro",
"contributors-summary":"confluence_deprecate_contributors_summary",gallery:"confluence_deprecate_gallery_macro","google-drive-docs":"confluence_deprecate_google_drive_macro","google-drive-sheets":"confluence_deprecate_google_drive_macro","google-drive-slides":"confluence_deprecate_google_drive_macro",index:"confluence_deprecate_page_index_macro",viewppt:"confluence_deprecate_powerpoint_macro",viewdoc:"confluence_deprecate_word_macro","recently-updated-dashboard":"confluence_deprecate_recently_updated_dashboard",
"related-labels":"confluence_deprecate_related_labels_macro",spaces:"confluence_deprecate_spaces_list_macro",span:"confluence_deprecate_span_macro"},isDeprecated:function(a){return this.DEPRECATED_MACROS.includes(a)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-message-queue', location = 'includes/js/legacy-message-queue.js' */
define("confluence/legacy-message-queue",["window"],function(b){b.legacyMessageQueue||(b.legacyMessageQueue=[]);return{push:function(a){var c;c="string"!==typeof a.type?!1:a.hasOwnProperty("type")&&a.hasOwnProperty("payload")?!0:!1;if(!c)throw Error("legacyMessageQueue: received Invalid Message: "+JSON.stringify(a));b.legacyMessageQueue.push(a)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:confluence-templates', location = 'includes/js/amd/shim/confluence-templates-amd.js' */
define("confluence/templates",[],function(){"undefined"===typeof Confluence&&(Confluence={});"undefined"===typeof Confluence.Templates&&(Confluence.Templates={});return Confluence.Templates});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dom-filter-field', location = 'includes/js/dom-filter-field.js' */
define("confluence/dom-filter-field",["ajs","confluence/templates","jquery"],function(f,m,e){return function(c){function k(){g=e(c.items)}function h(){return e.trim(b.filter(":not(.blank-search)").val())}function l(){c.searcher(g,h());c.postSearch(g.filter(":visible"))}var d={items:null,matcher:function(a,c){return-1<a.text().toLowerCase().indexOf(c)},searcher:function(a,b){""!==b?(b=b.toLowerCase(),a.each(function(){var a=e(this),d=c.matcher(a,b);a.toggleClass("hidden",!d)})):a.removeClass("hidden")},
postSearch:function(a){},placeholderText:"Search",submitCallback:function(a,b){f.debug("DomFilterField submitted with "+a.length+" item(s) for search text \x3e"+b+"\x3c")}};c=e.extend(d,c);var g;k();var d=e(m.DomFilterField.form()),b=d.find("input");b.keyup(function(a){l();return f.stopEvent(a)}).keyup(function(a){return f.stopEvent(a)}).focus(function(a){b.hasClass("blank-search")&&b.removeClass("blank-search").val("");a.target.select()}).blur(function(a){""===h()&&b.addClass("blank-search").val(c.placeholderText)}).blur();
c.formId&&d.attr("id",c.formId);c.inputId&&b.attr("id",c.inputId);d.submit(function(a){f.stopEvent(a);a=g.filter(":visible");a.length&&c.submitCallback(a,h());return!1});return{form:d,reset:function(){""!==h()&&(b.val("").blur(),c.searcher(g,""))},refreshItems:k,filter:l,focus:function(){b.focus()},focusAndSearch:function(a){a=e.trim(a);b.val(a).keyup();a&&b.removeClass("blank-search");b.focus()}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/dom-filter-field","Confluence.DomFilterField");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:dom-filter-field', location = 'includes/soy/dom-filter-field.soy' */
// This file was automatically generated from dom-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.DomFilterField.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DomFilterField == 'undefined') { Confluence.Templates.DomFilterField = {}; }


Confluence.Templates.DomFilterField.form = function(opt_data, opt_ignored) {
  return '<form class="aui dom-filter-field-form"><input type="text" class="text"/></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.DomFilterField.form.soyTemplateName = 'Confluence.Templates.DomFilterField.form';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:common', location = '/js/namespace.js' */
window.Confluence                              || (window.Confluence = {});
window.Confluence.UI                           || (window.Confluence.UI = {});
window.Confluence.UI.Components                || (window.Confluence.UI.Components = {});
window.Confluence.UI.Components.Pagination     || (window.Confluence.UI.Components.Pagination = {});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:common', location = '/js/internal/dark-features.js' */
/**
 * AMD shim of AJS.DarkFeatures so that other modules in this plugin can depend on it.
 *
 * This module should be removed when an official DarkFeatures module is defined in Confluence core.
 */
define('confluence-ui-components/dark-features',
[
    'ajs'
],
function(
    AJS
) {
    'use strict';

    return AJS.DarkFeatures;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define('confluence-ui-components/js/internal/space-resolver',
[
    'underscore',
    'jquery',
    'ajs'
],
/**
 * Converts space keys and "special" space keys into UI-friendly display names.
 */
function (
    _,
    $,
    AJS
) {

    'use strict';

    /**
     * Mapping of space category keys to name.
     */
    var SPACE_CATEGORIES = {
        "conf_all":         "All spaces",
        "conf_current":     "Current space",
        "conf_favorites":   "Favourite spaces",
        "conf_global":      "Site spaces",
        "conf_personal":    "Personal spaces"
    };

    function makeSpaceKeyParamString(spaceKeys) {
        var params = _.map(spaceKeys, function(spaceKey) {
            return 'spaceKey=' + encodeURI(spaceKey);
        });
        return params.join('&');
    }

    function makeDisplayItem(key, value) {
        var idOnly = typeof value === 'undefined';
        var text = _.escape(idOnly ? key : value);
        return {
            id: key,
            text: text,
            // This could later be used to render 'missing' spaces in red, have a tooltip, etc.
            idOnly: idOnly
        };
    }

    function getSpaceDisplayItems(spaceKeys, callback) {

        var displayItemMap = {};
        var keysToFetch = [];

        _.each(spaceKeys, function (spaceKey) {

            // Try a local category lookup first
            var categoryText = getSpaceCategoryDisplayName(spaceKey);
            if (categoryText) {
                displayItemMap[spaceKey] = makeDisplayItem(spaceKey, categoryText);
            }
            else {
                keysToFetch.push(spaceKey);
            }
        });

        var deferred;
        if (keysToFetch.length) {
            var url = AJS.contextPath() + '/rest/api/space?' + makeSpaceKeyParamString(keysToFetch);
            deferred = $.getJSON(url);
        }
        else {
            deferred = new $.Deferred();
            deferred.resolve({
                results: []
            });
        }

        function renderSpaces(response) {
            var spaces = response.results;
            _.each(spaces, function(space) {
                displayItemMap[space.key] = makeDisplayItem(space.key, space.name);
            });

            // Now that all known spaces and categories are accounted for, build an array of items with the same order
            // as the incoming space keys. Unmatched space keys get added with the display name just the key.
            var displayItems = _.map(spaceKeys, function(spaceKey) {
                return displayItemMap[spaceKey] || makeDisplayItem(spaceKey);
            });

            callback(displayItems);
        }

        deferred.done(renderSpaces);
    }

    function getSpaceCategoryDisplayName(categoryKey) {
        return SPACE_CATEGORIES[categoryKey];
    }

    var spaceTypeKeys = ['conf_favorites','conf_global','conf_personal'];

    return {
        getSpaceDisplayItems: getSpaceDisplayItems,
        getSpaceCategoryDisplayName: getSpaceCategoryDisplayName,

        getSpaceTypeKeys: function() {
            return spaceTypeKeys;
        }
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define('confluence-ui-components/js/space-picker',
[
    'underscore',
    'ajs',
    'jquery',
    'confluence-ui-components/js/internal/space-resolver'
],
/**
 * A generic, reusable space picker component. The component itself is just select2 (http://ivaynberg.github.io/select2/)
 * with a custom query/initSelection/placeholder properties. You can customize the component in the same way as you could
 * customize a standard select2.
 *
 * The default behaviour shows suggested (= recent) spaces when you open the picker, and starts to ajax search for spaces
 * that you have view permission for when you start to type.
 *
 * Caveats:
 * This thing is unfinished and doesn't work for every case yet. For example, you cannot only search for spaces that you have
 * edit permission for. By default, it will show all spaces that you have view permission for.
 *
 * Other issues:
 * - Search results don't paginate, for now it will display 25 hits for each term and that's it
 *
 * Discussion:
 * https://pug.jira.com/wiki/display/CONFDEV/Draft+for+Generic+Space+Picker
 *
 * Usage:
 *
 * Minimum case: $("#space-search").auiSelect2(require('confluence-ui-components/js/space-picker').build());
 *
 * If you want to customize the behaviour of the picker or the underlying select2 create an options object
 * that has the configuration of the space picker and additional options for select2.
 *
 * var options = _.extend(require('confluence-ui-components/js/space-picker').build(), {
 *   allowClear: true,
 *   placeholder: "my-placeholder"
 * });
 *
 * $("#space-search").auiSelect2(options);
 *
 *
 * If you want to use local data instead of the rest endpoint, use the data option:
 *
 * $("#space-search").auiSelect2(require('confluence-ui-components/js/space-picker').build({
 *  data: [
 *    { id: "FOO", text: "Foo Space" },
 *    { id: "MEW", text: "Cat Space" }
 *  ]
 * }));
 *
 */
function (
    _,
    AJS,
    $,
    spaceResolver
) {

    'use strict';

    var DEFAULTS = {
        data: null, /* object */
        suggestCategories: null /* array */
    };

    var createResultFormattingFn = function (resultFormatFn) {
        return function(match) {
            var item = {
                id: match.spaceKey,
                text: match.spaceName
            };
            if (typeof resultFormatFn === 'function') {
                // The item may need further processing, e.g. to re-add +/- prefixes.
                return resultFormatFn(item);
            }
            return item;
        };
    };

    var formatSearchResult;

    /**
     * Resolves the space name(s) for the initial value of the select.
     */
    var makeInitSelectionFn = function (opts) {
        return function (element, callback) {
            var spaceKeyStr = $(element).val();
            if (spaceKeyStr === "") {
                return;
            }

            var spaceKeys = spaceKeyStr.split(',');

            function doDisplay(displayItems) {


                // If select2 is configured as a multi-select then its callbacks will expect an array. If it is configured
                // as a single select then its callbacks will expect an Object. This is a helper function to make sure we
                // return the thing select2 is expecting.
                if (!opts.multiple) {
                    displayItems = displayItems[0];
                }

                callback(displayItems);
            }

            spaceResolver.getSpaceDisplayItems(spaceKeys, doDisplay);
        };
    };

    /**
     * Default suggested space function resolves the recent spaces and caches the result. Can also show space categories
     * on top if options are provided.
     *
     * @returns {Function}
     */
    var makeSuggestFn = function (opts) {
        // contains the cached spaces
        var suggestedSpaces;

        // prepare suggested categories
        if (opts.suggestCategories) {
            var suggestCategories = {
                text: "Select a suggestion or type to search",
                children: _.map(opts.suggestCategories, function (category) {
                    return {
                        id: category,
                        text: spaceResolver.getSpaceCategoryDisplayName(category)
                    };
                })
            };
        }

        return function (query) {
            if (suggestedSpaces) {
                query.callback(suggestedSpaces);
                return;
            }

            function loadSuggestedSpaces(spaces) {
                var data = { results: [] };

                // add categories if available
                if (suggestCategories) {
                    data.results.push(suggestCategories);
                }

                // format and append recent spaces
                if (spaces.length > 0) {
                    data.results.push({
                        text: "Suggested spaces",
                        children: _.map(spaces, function (space) {
                            return {
                                id: space.key,
                                text: _.escape(space.name)
                            };
                        })
                    });
                }

                suggestedSpaces = data;
                query.callback(suggestedSpaces);
            }

            $.getJSON(AJS.contextPath() + "/rest/recentlyviewed/1.0/recent/spaces")
                .done(loadSuggestedSpaces)
                .fail(function() {
                    AJS.log("Couldn't fetch recent spaces");
                    var data = { results: [] };

                    // add categories if available
                    if (suggestCategories) {
                        data.results.push(suggestCategories);
                    }

                    query.callback(data);
                });
        };
    };

    /**
     * Use select2.ajax to retrieve results via contentnamesearch.
     *
     * TODO error handling. Only possible once select2 is upgraded to 3.4.1
     *
     * @returns {*}
     */
    var makeSearchFn = function () {
        return window.Select2.query.ajax({
            url: AJS.contextPath() + "/rest/quicknav/1/search?type=spacedesc&type=personalspacedesc",
            data: function (term) {
                return {
                    query: term,
                    maxPerCategory: 25
                };
            },
            quietMillis: 250,
            results: function (data) {
                var matches = data.contentNameMatches;
                if (matches.length <= 1) {
                    // no search results
                    return { results: [] };
                } else {
                    // format results
                    var spaces = _.map(matches[0], formatSearchResult);

                    return {
                        results: [
                            {
                                text: "Search results",
                                children: spaces
                            }
                        ]
                    };
                }
            }
        });
    };


    /**
     * Builds the query function that is passed to select2.
     *
     * @param opts
     * @returns {Function}
     */
     function makeQueryFn(opts) {
        var search = makeSearchFn();
        var suggestSpaces = makeSuggestFn(opts);
        return function (query, stripPrefix, formatResult) {
            // Show suggestions until you typed at least 2 characters, then search.
            if (query.term.length < 2) {
                return suggestSpaces(query);
            } else {
                if (typeof stripPrefix === 'function') {
                    // Functions may be provided to allow prefix notation
                    // (i.e. -foo to exclude spaces called foo from search results)
                    query.term = stripPrefix(query.term);
                }
                formatSearchResult = createResultFormattingFn(formatResult);
                return search(query);
            }
        };
    }

    function getExistingValues() {
        var select = $('.select2-container-active').next('input'); // sucky way of finding the original input field
        var val = select.val().trim();
        return (val !== '') ? val.split(',') : [];
    }

    function hasSpaceTypeValue(values) {
        var spaceTypes = _.intersection(values, spaceResolver.getSpaceTypeKeys());
        return spaceTypes.length > 0;
    }

    function isSpaceTypeResult(result) {
        return (typeof result.id !== 'undefined') && _.contains(spaceResolver.getSpaceTypeKeys(), result.id);
    }

    function recursivelyAdjustResults(results, spaceTypesOnly, existingValues) {
        var adjusted = [];
        // Note that we don't use .filter() because we may be modified nested result arrays.
        results.forEach(function(result) {
            if (result.children) {
                var adjustedChildren = recursivelyAdjustResults(result.children, spaceTypesOnly, existingValues);
                if (adjustedChildren.length) {
                    adjusted.push($.extend({}, result, {
                        children: adjustedChildren
                    }));
                }
            } else {
                var resultIsSpaceType = isSpaceTypeResult(result);
                if ((spaceTypesOnly && resultIsSpaceType) ||
                    (!spaceTypesOnly && !resultIsSpaceType)) {

                    // Filter out existing values. Select2 normally does this to the returned results,
                    // but that could result in a "No results" message when the "Everything filtered"
                    // message should be shown.
                    if (!_.contains(existingValues, result.id)) {
                        adjusted.push(result);
                    }
                }
            }

        });
        return adjusted;
    }

    // This function exists for ease of unit testing.
    function filterMixedTypesForValues(results, existingValues) {
        if (!results.length || !existingValues.length) {
            return results;
        }

        var spaceTypesOnly = hasSpaceTypeValue(existingValues);
        var filtered = recursivelyAdjustResults(results, spaceTypesOnly, existingValues);

        if (!filtered.length) {
            // Give the user some inkling of why nothing now matches.
            filtered.push({
                text: "Can\'t filter by space types AND spaces",
                disabled: true
            });
        }

        return filtered;
    }

    /** Hack to modify the results outside of the query function - sortResults is all that select2 provides. */
    function sortResults(results) {
        var existingValues = getExistingValues();
        return filterMixedTypesForValues(results, existingValues);
    }

    function build(opts) {
        opts = _.extend({}, DEFAULTS, opts);

        var select2Options = {
            placeholder: "Select a space",

            formatResult: function (result, label, query) {
                // Add a tooltip to disclose full result text (as we truncate it to fit the drop down)
                label.attr("title", $("<div/>").html(result.text).text());
                return $.fn.select2.defaults.formatResult.apply(this, arguments);
            },

            escapeMarkup: function (markup) {
                // Do not escape by default, instead provide already escaped data to the component.
                return markup;
            },

            multiple: opts.multiple === true
        };

        if (opts.disableMixedSpaceTypes) {
            select2Options.sortResults = sortResults;
        }

        // for local data we don't do any REST calls
        // TODO working initSelection method for when the input has a value
        if (opts.data) {
            return _.extend(select2Options, { data: opts.data });
        } else {
            return _.extend(select2Options, {
                initSelection: makeInitSelectionFn(opts),
                query: makeQueryFn(opts)
            });
        }
    }

    return {
        build: build,

        /**
         * Removes results for space/space.type if the existing values already contain the opposite result type.
         */
        filterMixedTypesForValues: filterMixedTypesForValues
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
/**
 * Shim to continue providing newly-AMD-fied space picker as a global var.
 */
window.Confluence.UI.Components.SpacePicker = require('confluence-ui-components/js/space-picker');

// Warn developers that still use the shim (build is the only method on it).
AJS.deprecate.prop(window.Confluence.UI.Components.SpacePicker, 'build', {
    sinceVersion: '1.4.22',
    extraInfo: "Use require('confluence-ui-components/js/space-picker')"
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-vendor-jquery-jquery-ui-jquery-ui-datepicker', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.datepicker.js' */
("undefined"===typeof window?global:window).__a79c77fa647d1faac4fff81c2c2d8d79=function(){(function(d){function B(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass=
"ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};d.extend(this._defaults,this.regional[""]);this.dpDiv=C(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function C(a){return a.bind("mouseout",
function(a){a=d(a.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");a.length&&a.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(b){b=d(b.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");if(!d.datepicker._isDisabledDatepicker(D.inline?a.parent()[0]:D.input[0])&&b.length)b.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
b.addClass("ui-state-hover"),b.hasClass("ui-datepicker-prev")&&b.addClass("ui-datepicker-prev-hover"),b.hasClass("ui-datepicker-next")&&b.addClass("ui-datepicker-next-hover")})}function z(a,b){d.extend(a,b);for(var c in b)if(null==b[c]||void 0==b[c])a[c]=b[c];return a}d.extend(d.ui,{datepicker:{version:"1.8.24"}});var x=(new Date).getTime(),D;d.extend(B.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},
setDefaults:function(a){z(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null,e;for(e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase();f="div"==e||"span"==e;a.id||(this.uuid+=1,a.id="dp"+this.uuid);var j=this._newInst(d(a),f);j.settings=d.extend({},b||{},c||{});"input"==e?this._connectDatepicker(a,j):f&&this._inlineDatepicker(a,j)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,
"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:C(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]);b.trigger=d([]);c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),d.data(a,"datepicker",b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove();c&&(b.append=d('<span class="'+this._appendClass+'">'+c+"</span>"),a[e?"before":"after"](b.append));a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();c=this._get(b,"showOn");("focus"==
c||"both"==c)&&a.focus(this._showDatepicker);if("button"==c||"both"==c){var c=this._get(b,"buttonText"),f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(""==f?c:d("<img/>").attr({src:f,alt:c,title:c})));a[e?"before":"after"](b.trigger);b.trigger.click(function(){if(d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0])d.datepicker._hideDatepicker();
else{d.datepicker._datepickerShowing&&d.datepicker._lastInput!=a[0]&&d.datepicker._hideDatepicker();d.datepicker._showDatepicker(a[0])}return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":
"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),d.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),
b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst;a||(this.uuid+=1,this._dialogInput=d('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},d.data(this._dialogInput[0],"datepicker",a));z(a.settings,e||{});b=b&&b.constructor==Date?this._formatDate(a,b):b;this._dialogInput.val(b);
this._pos=f?f.length?f:[f.pageX,f.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=c;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);d.blockUI&&d.blockUI(this.dpDiv);
d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker");"input"==e?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==e||"span"==e)&&b.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if("input"==e)a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==e||"span"==e)b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled");this._disabledInputs=d.map(this._disabledInputs,
function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if("input"==e)a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==e||"span"==e)b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled",
"disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(2==arguments.length&&"string"==typeof b)return"defaults"==
b?d.extend({},d.datepicker._defaults):e?"all"==b?d.extend({},e.settings):this._get(e,b):null;var f=b||{};"string"==typeof b&&(f={},f[b]=c);if(e){this._curInst==e&&this._hideDatepicker();var h=this._getDateDatepicker(a,!0),j=this._getMinMaxDate(e,"min"),g=this._getMinMaxDate(e,"max");z(e.settings,f);null!==j&&(void 0!==f.dateFormat&&void 0===f.minDate)&&(e.settings.minDate=this._formatDate(e,j));null!==g&&(void 0!==f.dateFormat&&void 0===f.maxDate)&&(e.settings.maxDate=this._formatDate(e,g));this._attachments(d(a),
e);this._autoSize(e);this._setDate(e,h);this._updateAlternate(e);this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);c&&!c.inline&&this._setDateFromField(c,b);return c?this._getDate(c):null},_doKeyDown:function(a){var b=
d.datepicker._getInst(a.target),c=!0,e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker();c=!1;break;case 13:return c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv),c[0]&&d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]),(a=d.datepicker._get(b,"onSelect"))?(c=d.datepicker._formatDate(b),a.apply(b.input?b.input[0]:null,[c,b])):d.datepicker._hideDatepicker(),
!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&d.datepicker._clearDate(a.target);c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&d.datepicker._gotoToday(a.target);c=a.ctrlKey||a.metaKey;
break;case 37:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?1:-1,"D");c=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,-7,"D");c=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?-1:1,"D");c=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,
a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,7,"D");c=a.ctrlKey||a.metaKey;break;default:c=!1}else 36==a.keyCode&&a.ctrlKey?d.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){var b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat")),c=String.fromCharCode(void 0==
a.charCode?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||" ">c||!b||-1<b.indexOf(c)}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{if(d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a)))d.datepicker._setDateFromField(a),d.datepicker._updateAlternate(a),d.datepicker._updateDatepicker(a)}catch(b){d.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a;"input"!=a.nodeName.toLowerCase()&&
(a=d("input",a.parentNode)[0]);if(!(d.datepicker._isDisabledDatepicker(a)||d.datepicker._lastInput==a)){var b=d.datepicker._getInst(a);d.datepicker._curInst&&d.datepicker._curInst!=b&&(d.datepicker._curInst.dpDiv.stop(!0,!0),b&&d.datepicker._datepickerShowing&&d.datepicker._hideDatepicker(d.datepicker._curInst.input[0]));var c=d.datepicker._get(b,"beforeShow"),c=c?c.apply(a,[a,b]):{};if(!1!==c){z(b.settings,c);b.lastVal=null;d.datepicker._lastInput=a;d.datepicker._setDateFromField(b);d.datepicker._inDialog&&
(a.value="");d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(a),d.datepicker._pos[1]+=a.offsetHeight);var e=!1;d(a).parents().each(function(){e=e|d(this).css("position")=="fixed";return!e});e&&d.browser.opera&&(d.datepicker._pos[0]-=document.documentElement.scrollLeft,d.datepicker._pos[1]-=document.documentElement.scrollTop);c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(b);
c=d.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){var c=d.datepicker._get(b,"showAnim"),f=d.datepicker._get(b,"duration"),h=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var c=d.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1);d.datepicker._datepickerShowing=
!0;if(d.effects&&d.effects[c])b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,h);else b.dpDiv[c||"show"](c?f:null,h);(!c||!f)&&h();b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();d.datepicker._curInst=b}}}},_updateDatepicker:function(a){this.maxRows=4;var b=d.datepicker._getBorders(a.dpDiv);D=a;a.dpDiv.empty().append(this._generateHTML(a));this._attachHandlers(a);var c=a.dpDiv.find("iframe.ui-datepicker-cover");c.length&&c.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),
height:a.dpDiv.outerHeight()});a.dpDiv.find("."+this._dayOverClass+" a").mouseover();b=this._getNumberOfMonths(a);c=b[1];a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<c&&a.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em");a.dpDiv[(1!=b[0]||1!=b[1]?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==d.datepicker._curInst&&(d.datepicker._datepickerShowing&&
a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement)&&a.input.focus();if(a.yearshtml){var e=a.yearshtml;setTimeout(function(){e===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);e=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=
a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),h=a.input?a.input.outerWidth():0,j=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+(c?0:d(document).scrollLeft()),i=document.documentElement.clientHeight+(c?0:d(document).scrollTop());b.left-=this._get(a,"isRTL")?e-h:0;b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0;b.top-=c&&b.top==a.input.offset().top+j?d(document).scrollTop():0;b.left-=Math.min(b.left,b.left+e>g&&g>e?Math.abs(b.left+e-g):0);b.top-=Math.min(b.top,
b.top+f>i&&i>f?Math.abs(f+j):0);return b},_findPos:function(a){for(var b=this._getInst(a),b=this._get(b,"isRTL");a&&("hidden"==a.type||1!=a.nodeType||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=d(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(b&&!(a&&b!=d.data(a,"datepicker"))&&this._datepickerShowing){var a=this._get(b,"showAnim"),c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b)};if(d.effects&&d.effects[a])b.dpDiv.hide(a,
d.datepicker._get(b,"showOptions"),c,e);else b.dpDiv["slideDown"==a?"slideUp":"fadeIn"==a?"fadeOut":"hide"](a?c:null,e);a||e();this._datepickerShowing=!1;(a=this._get(b,"onClose"))&&a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},
_checkExternalClick:function(a){if(d.datepicker._curInst){var a=d(a.target),b=d.datepicker._getInst(a[0]);(a[0].id!=d.datepicker._mainDivId&&0==a.parents("#"+d.datepicker._mainDivId).length&&!a.hasClass(d.datepicker.markerClassName)&&!a.closest("."+d.datepicker._triggerClass).length&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)||a.hasClass(d.datepicker.markerClassName)&&d.datepicker._curInst!=b)&&d.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){var a=d(a),e=this._getInst(a[0]);
this._isDisabledDatepicker(a[0])||(this._adjustInstDate(e,b+("M"==c?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){var a=d(a),b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var c=new Date;b.selectedDay=c.getDate();b.drawMonth=b.selectedMonth=c.getMonth();b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b);this._adjustDate(a)},
_selectMonthYear:function(a,b,c){var a=d(a),e=this._getInst(a[0]);e["selected"+("M"==c?"Month":"Year")]=e["draw"+("M"==c?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(a)},_selectDay:function(a,b,c,e){var f=d(a);!d(e).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(f[0])&&(f=this._getInst(f[0]),f.selectedDay=f.currentDay=d("a",e).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,
f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(a){a=d(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){var c=d(a),c=this._getInst(c[0]),b=null!=b?b:this._formatDate(c);c.input&&c.input.val(b);this._updateAlternate(c);var e=this._get(c,"onSelect");e?e.apply(c.input?c.input[0]:null,[b,c]):c.input&&c.input.trigger("change");c.inline?this._updateDatepicker(c):(this._hideDatepicker(),this._lastInput=c.input[0],"object"!=typeof c.input[0]&&c.input.focus(),this._lastInput=
null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,c){if(null==
a||null==b)throw"Invalid arguments";b="object"==typeof b?b.toString():b+"";if(""==b)return null;for(var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff,e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,h=(c?c.dayNames:null)||this._defaults.dayNames,j=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,i=c=-1,p=-1,r=-1,k=!1,m=function(b){(b=y+1<a.length&&
a.charAt(y+1)==b)&&y++;return b},l=function(a){var c=m(a),a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&c?4:"o"==a?3:2)+"}"),a=b.substring(u).match(a);if(!a)throw"Missing number at position "+u;u+=a[0].length;return parseInt(a[0],10)},n=function(a,c,e){var a=d.map(m(a)?e:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;d.each(a,function(a,c){var d=c[1];if(b.substr(u,d.length).toLowerCase()==d.toLowerCase())return f=c[0],u+=d.length,!1});if(-1!=f)return f+
1;throw"Unknown name at position "+u;},s=function(){if(b.charAt(u)!=a.charAt(y))throw"Unexpected literal at position "+u;u++},u=0,y=0;y<a.length;y++)if(k)"'"==a.charAt(y)&&!m("'")?k=!1:s();else switch(a.charAt(y)){case "d":p=l("d");break;case "D":n("D",f,h);break;case "o":r=l("o");break;case "m":i=l("m");break;case "M":i=n("M",j,g);break;case "y":c=l("y");break;case "@":var v=new Date(l("@")),c=v.getFullYear(),i=v.getMonth()+1,p=v.getDate();break;case "!":v=new Date((l("!")-this._ticksTo1970)/1E4);
c=v.getFullYear();i=v.getMonth()+1;p=v.getDate();break;case "'":m("'")?s():k=!0;break;default:s()}if(u<b.length)throw"Extra/unparsed characters found in date: "+b.substring(u);-1==c?c=(new Date).getFullYear():100>c&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100));if(-1<r){i=1;p=r;do{e=this._getDaysInMonth(c,i-1);if(p<=e)break;i++;p-=e}while(1)}v=this._daylightSavingAdjust(new Date(c,i-1,p));if(v.getFullYear()!=c||v.getMonth()+1!=i||v.getDate()!=p)throw"Invalid date";return v},
ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,
c=(c?c.monthNames:null)||this._defaults.monthNames,j=function(b){(b=r+1<a.length&&a.charAt(r+1)==b)&&r++;return b},g=function(a,b,c){b=""+b;if(j(a))for(;b.length<c;)b="0"+b;return b},i="",p=!1;if(b)for(var r=0;r<a.length;r++)if(p)"'"==a.charAt(r)&&!j("'")?p=!1:i+=a.charAt(r);else switch(a.charAt(r)){case "d":i+=g("d",b.getDate(),2);break;case "D":var k;k=b.getDay();var m=d,l=f;k=j("D")?l[k]:m[k];i+=k;break;case "o":i+=g("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-
(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":i+=g("m",b.getMonth()+1,2);break;case "M":k=b.getMonth();m=h;l=c;k=j("M")?l[k]:m[k];i+=k;break;case "y":i+=j("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":i+=b.getTime();break;case "!":i+=1E4*b.getTime()+this._ticksTo1970;break;case "'":j("'")?i+="'":p=!0;break;default:i+=a.charAt(r)}return i},_possibleChars:function(a){for(var b="",c=!1,d=function(b){(b=f+1<a.length&&a.charAt(f+1)==b)&&f++;return b},
f=0;f<a.length;f++)if(c)"'"==a.charAt(f)&&!d("'")?c=!1:b+=a.charAt(f);else switch(a.charAt(f)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(f)}return b},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);var j=
this._getFormatConfig(a);try{f=this.parseDate(c,d,j)||h}catch(g){this.log(g),d=b?"":d}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=d?f.getDate():0;a.currentMonth=d?f.getMonth():0;a.currentYear=d?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){if(null==b||""===b)b=c;else{var e;if("string"==
typeof b)a:{try{e=d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),b,d.datepicker._getFormatConfig(a));break a}catch(f){}var h=(b.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,a=h.getFullYear();e=h.getMonth();for(var h=h.getDate(),j=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,g=j.exec(b);g;){switch(g[2]||"d"){case "d":case "D":h+=parseInt(g[1],10);break;case "w":case "W":h+=7*parseInt(g[1],10);break;case "m":case "M":e+=parseInt(g[1],10);h=Math.min(h,d.datepicker._getDaysInMonth(a,
e));break;case "y":case "Y":a+=parseInt(g[1],10),h=Math.min(h,d.datepicker._getDaysInMonth(a,e))}g=j.exec(b)}e=new Date(a,e,h)}else"number"==typeof b?isNaN(b)?b=c:(a=new Date,a.setDate(a.getDate()+b),b=a):b=new Date(b.getTime()),e=b;b=e}if(b=b&&"Invalid Date"==b.toString()?c:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,
b,c){var d=!b,f=a.selectedMonth,h=a.selectedYear,b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(f!=a.selectedMonth||h!=a.selectedYear)&&!c&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,
a.currentMonth,a.currentDay))},_attachHandlers:function(a){var b=this._get(a,"stepMonths"),c="#"+a.id.replace(/\\\\/g,"\\");a.dpDiv.find("[data-handler]").map(function(){d(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+x].datepicker._adjustDate(c,-b,"M")},next:function(){window["DP_jQuery_"+x].datepicker._adjustDate(c,+b,"M")},hide:function(){window["DP_jQuery_"+x].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+x].datepicker._gotoToday(c)},selectDay:function(){window["DP_jQuery_"+
x].datepicker._selectDay(c,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return!1},selectMonth:function(){window["DP_jQuery_"+x].datepicker._selectMonthYear(c,this,"M");return!1},selectYear:function(){window["DP_jQuery_"+x].datepicker._selectMonthYear(c,this,"Y");return!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b=new Date,b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate())),c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),
f=this._get(a,"hideIfNoPrevNext"),h=this._get(a,"navigationAsDateFormat"),j=this._getNumberOfMonths(a),g=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),p=1!=j[0]||1!=j[1],r=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),k=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),g=a.drawMonth-g,l=a.drawYear;0>g&&(g+=12,l--);if(m)for(var n=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-j[0]*j[1]+1,m.getDate())),
n=k&&n<k?k:n;this._daylightSavingAdjust(new Date(l,g,1))>n;)g--,0>g&&(g=11,l--);a.drawMonth=g;a.drawYear=l;var n=this._get(a,"prevText"),n=!h?n:this.formatDate(n,this._daylightSavingAdjust(new Date(l,g-i,1)),this._getFormatConfig(a)),n=this._canAdjustMonth(a,-1,l,g)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+
n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>",s=this._get(a,"nextText"),s=!h?s:this.formatDate(s,this._daylightSavingAdjust(new Date(l,g+i,1)),this._getFormatConfig(a)),f=this._canAdjustMonth(a,1,l,g)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+
(c?"w":"e")+'">'+s+"</span></a>",i=this._get(a,"currentText"),s=this._get(a,"gotoCurrent")&&a.currentDay?r:b,i=!h?i:this.formatDate(i,s,this._getFormatConfig(a)),h=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(a,"closeText")+"</button>":"",e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?h:"")+(this._isInRange(a,s)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
i+"</button>":"")+(c?"":h)+"</div>":"",h=parseInt(this._get(a,"firstDay"),10),h=isNaN(h)?0:h,i=this._get(a,"showWeek"),s=this._get(a,"dayNames");this._get(a,"dayNamesShort");var u=this._get(a,"dayNamesMin"),y=this._get(a,"monthNames"),v=this._get(a,"monthNamesShort"),x=this._get(a,"beforeShowDay"),z=this._get(a,"showOtherMonths"),D=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var B=this._getDefaultDate(a),E="",F=0;F<j[0];F++){var I="";this.maxRows=4;for(var G=0;G<j[1];G++){var C=
this._daylightSavingAdjust(new Date(l,g,a.selectedDay)),t=" ui-corner-all",q="";if(p){q+='<div class="ui-datepicker-group';if(1<j[1])switch(G){case 0:q+=" ui-datepicker-group-first";t=" ui-corner-"+(c?"right":"left");break;case j[1]-1:q+=" ui-datepicker-group-last";t=" ui-corner-"+(c?"left":"right");break;default:q+=" ui-datepicker-group-middle",t=""}q+='">'}for(var q=q+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+t+'">'+(/all|left/.test(t)&&0==F?c?f:n:"")+(/all|right/.test(t)&&
0==F?c?n:f:"")+this._generateMonthYearHeader(a,g,l,k,m,0<F||0<G,y,v)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),w=i?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"",t=0;7>t;t++)var o=(t+h)%7,w=w+("<th"+(5<=(t+h+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+s[o]+'">'+u[o]+"</span></th>");q+=w+"</tr></thead><tbody>";w=this._getDaysInMonth(l,g);l==a.selectedYear&&g==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,w));t=(this._getFirstDayOfMonth(l,
g)-h+7)%7;w=Math.ceil((t+w)/7);this.maxRows=w=p?this.maxRows>w?this.maxRows:w:w;for(var o=this._daylightSavingAdjust(new Date(l,g,1-t)),L=0;L<w;L++){for(var q=q+"<tr>",J=!i?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(o)+"</td>",t=0;7>t;t++){var H=x?x.apply(a.input?a.input[0]:null,[o]):[!0,""],A=o.getMonth()!=g,K=A&&!D||!H[0]||k&&o<k||m&&o>m,J=J+('<td class="'+(5<=(t+h+6)%7?" ui-datepicker-week-end":"")+(A?" ui-datepicker-other-month":"")+(o.getTime()==C.getTime()&&g==a.selectedMonth&&
a._keyEvent||B.getTime()==o.getTime()&&B.getTime()==C.getTime()?" "+this._dayOverClass:"")+(K?" "+this._unselectableClass+" ui-state-disabled":"")+(A&&!z?"":" "+H[1]+(o.getTime()==r.getTime()?" "+this._currentClass:"")+(o.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!A||z)&&H[2]?' title="'+H[2]+'"':"")+(K?"":' data-handler="selectDay" data-event="click" data-month="'+o.getMonth()+'" data-year="'+o.getFullYear()+'"')+">"+(A&&!z?"&#xa0;":K?'<span class="ui-state-default">'+o.getDate()+"</span>":
'<a class="ui-state-default'+(o.getTime()==b.getTime()?" ui-state-highlight":"")+(o.getTime()==r.getTime()?" ui-state-active":"")+(A?" ui-priority-secondary":"")+'" href="#">'+o.getDate()+"</a>")+"</td>");o.setDate(o.getDate()+1);o=this._daylightSavingAdjust(o)}q+=J+"</tr>"}g++;11<g&&(g=0,l++);q+="</tbody></table>"+(p?"</div>"+(0<j[0]&&G==j[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");I+=q}E+=I}E+=e+(d.browser.msie&&7>parseInt(d.browser.version,10)&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
"");a._keyEvent=!1;return E},_generateMonthYearHeader:function(a,b,c,d,f,h,j,g){var i=this._get(a,"changeMonth"),p=this._get(a,"changeYear"),r=this._get(a,"showMonthAfterYear"),k='<div class="ui-datepicker-title">',m="";if(h||!i)m+='<span class="ui-datepicker-month">'+j[b]+"</span>";else{for(var j=d&&d.getFullYear()==c,l=f&&f.getFullYear()==c,m=m+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',n=0;12>n;n++)if((!j||n>=d.getMonth())&&(!l||n<=f.getMonth()))m+='<option value="'+
n+'"'+(n==b?' selected="selected"':"")+">"+g[n]+"</option>";m+="</select>"}r||(k+=m+(h||!i||!p?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",h||!p)k+='<span class="ui-datepicker-year">'+c+"</span>";else{var g=this._get(a,"yearRange").split(":"),s=(new Date).getFullYear(),j=function(a){a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?s+parseInt(a,10):parseInt(a,10);return isNaN(a)?s:a},b=j(g[0]),g=Math.max(b,j(g[1]||"")),b=d?Math.max(b,d.getFullYear()):b,g=f?Math.min(g,f.getFullYear()):
g;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=g;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";k+=a.yearshtml;a.yearshtml=null}k+=this._get(a,"yearSuffix");r&&(k+=(h||!i||!p?"&#xa0;":"")+m);return k+"</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"==c?b:0),f=a.drawMonth+("M"==c?b:0),b=Math.min(a.selectedDay,this._getDaysInMonth(d,f))+("D"==c?b:0),d=this._restrictMinMax(a,
this._daylightSavingAdjust(new Date(d,f,b)));a.selectedDay=d.getDate();a.drawMonth=a.selectedMonth=d.getMonth();a.drawYear=a.selectedYear=d.getFullYear();("M"==c||"Y"==c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),c=c&&b<c?c:b;return d&&c>d?d:c},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,
"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var f=this._getNumberOfMonths(a),c=this._daylightSavingAdjust(new Date(c,d+(0>b?b:f[0]*f[1]),1));0>b&&c.setDate(this._getDaysInMonth(c.getFullYear(),
c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff"),b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,
"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});d.fn.datepicker=function(a){if(!this.length)return this;d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv),
d.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&("isDisabled"==a||"getDate"==a||"widget"==a)||"option"==a&&2==arguments.length&&"string"==typeof arguments[1]?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})};d.datepicker=new B;d.datepicker.initialized=!1;d.datepicker.uuid=
(new Date).getTime();d.datepicker.version="1.8.24";window["DP_jQuery_"+x]=d})(jQuery);return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-date-picker', location = 'src/js/aui/date-picker.js' */
("undefined"===typeof window?global:window).__3cd4f3a1483cddcaf9775ff2492d920e=function(){function h(a){return a&&a.__esModule?a:{"default":a}}function g(a,c){var d=void 0,h=void 0,b=void 0,i=void 0,e={},d={},i=x++,b=(0,f.default)(a);b.attr("data-aui-dp-uuid",i);d.getField=function(){return b};d.getOptions=function(){return e};h=function(){var a=void 0,c=void 0,k=void 0,h=void 0,t=void 0,j=void 0,v=void 0,q=void 0,r=void 0,l=void 0,n=void 0,o=void 0;d.hide=function(){l.hide()};d.show=function(){l.show()};
d.setDate=function(b){"undefined"!==typeof a&&a.datepicker("setDate",b)};d.getDate=function(){if("undefined"!==typeof a)return a.datepicker("getDate")};d.setMin=function(b){if("undefined"!==typeof a)return a.datepicker("option","minDate",b)};d.setMax=function(b){if("undefined"!==typeof a)return a.datepicker("option","maxDate",b)};v=function(g){o.off();if(e.hint){var m=(0,f.default)("<div/>").addClass("aui-datepicker-hint");m.append("<span/>").text(e.hint);o.append(m)}a=(0,f.default)("<div/>");a.attr("data-aui-dp-popup-uuid",
i);o.append(a);m={dateFormat:e.dateFormat,defaultDate:b.val(),maxDate:b.attr("max"),minDate:b.attr("min"),nextText:">",onSelect:function(a){b.val(a);b.trigger("change");d.hide();q=!0;b.focus();e.onSelect&&e.onSelect.call(this,a)},onChangeMonthYear:function(){setTimeout(l.refresh,0)},prevText:"<"};f.default.extend(m,g);-1<e.firstDay&&(m.firstDay=e.firstDay);"undefined"!==typeof b.attr("step")&&u.log("WARNING: The date picker polyfill currently does not support the step attribute!");a.datepicker(m);
(0,f.default)("body").on("keydown",k);b.on("focusout keydown",h);b.on("propertychange keyup input paste",j);c=new MutationObserver(function(a){a.forEach(function(a){a.attributeName==="min"?d.setMin(a.target.getAttribute("min")):a.attributeName==="max"&&d.setMax(a.target.getAttribute("max"))})});c.observe(b[0],{attributes:!0})};k=function(a){var c=(0,f.default)(a.target),k=c.closest(o).length||c.is(b),e=c.closest(".ui-datepicker-header").length;!k&&!e||a.keyCode===y.default.ESCAPE?d.hide():c[0]!==
b[0]&&a.preventDefault()};h=function(){r||((0,f.default)("body").on("focus blur click mousedown","*",k),r=!0)};t=function(){q?q=!1:d.show()};j=function(){(0,f.default)(this).val()&&a.datepicker("setDate",b.val())};d.destroyPolyfill=function(){d.hide();c&&(c.disconnect(),c=null);b.attr("placeholder",null);b.off("propertychange keyup input paste",j);b.off("focus click",t);b.off("focusout keydown",h);(0,f.default)("body").off("keydown",h);(0,f.default)("body").off("focus blur click mousedown keydown",
k);g.prototype.browserSupportsDateField&&(b[0].type="date");"undefined"!==typeof a&&a.datepicker("destroy");delete d.destroyPolyfill;delete d.show;delete d.hide};r=q=!1;e.languageCode in g.prototype.localisations||(e.languageCode="");var w=g.prototype.localisations,s="",p=240;"large"===w.size&&(p=325,s="aui-datepicker-dialog-large");p={hideCallback:function(){(0,f.default)("body").off("focus blur click mousedown","*",k);r=false;n&&n._datePickerPopup&&delete n._datePickerPopup},hideDelay:null,noBind:!0,
persistent:!0,closeOthers:!1,width:p};e.position&&(p.calculatePositions=function(a,b){var d=(0,f.default)(a[0]);return e.position.call(this,d,b)});l=(0,z.default)(b,void 0,function(b,d,c){if(typeof a==="undefined"){o=b;v(w)}if(n=(0,f.default)(d).closest(".aui-inline-dialog").get(0))n._datePickerPopup=l;c()},p);l.addClass("aui-datepicker-dialog");l.addClass(s);b.on("focus click",t);b.attr("placeholder",e.dateFormat);if(e.overrideBrowserDefault&&g.prototype.browserSupportsDateField&&(b[0].type="text",
s=b[0].getAttribute("value")))b[0].value=s};d.reset=function(){"function"===typeof d.destroyPolyfill&&d.destroyPolyfill();(!g.prototype.browserSupportsDateField||e.overrideBrowserDefault)&&h()};d.reconfigure=function(a){e=f.default.extend(void 0,g.prototype.defaultOptions,a);d.reset()};d.reconfigure(c);return d}var j={};"use strict";Object.defineProperty(j,"__esModule",{value:!0});var A="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&
"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f=h(__9be3f454a87dfa12e64a40a8f483ace3);__a79c77fa647d1faac4fff81c2c2d8d79;var u;var c=__076604ba6d64084987ea5ab9807be73e;if(c&&c.__esModule)u=c;else{var a={};if(null!=c)for(var i in c)Object.prototype.hasOwnProperty.call(c,i)&&(a[i]=c[i]);a.default=c;u=a}i=__1587e71f975c054c720890ed9f835be9;var c=h(__02a4a9c5c584764bed5640044440c14c),z=h(__258c6968a626336b1cc00f07b54d9813),y=h(__760902ce43d85195cbdeb9eba381a296),
a=h(__88c3a2e90969ea1dbb6af57489c397ae),x=0;g.prototype.browserSupportsDateField=(0,i.supportsDateField)();g.prototype.defaultOptions={overrideBrowserDefault:!1,firstDay:-1,languageCode:(0,f.default)("html").attr("lang")||"en-AU",dateFormat:f.default.datepicker.W3C};g.prototype.localisations={dayNames:[a.default.getText("ajs.datepicker.localisations.day-names.sunday"),a.default.getText("ajs.datepicker.localisations.day-names.monday"),a.default.getText("ajs.datepicker.localisations.day-names.tuesday"),
a.default.getText("ajs.datepicker.localisations.day-names.wednesday"),a.default.getText("ajs.datepicker.localisations.day-names.thursday"),a.default.getText("ajs.datepicker.localisations.day-names.friday"),a.default.getText("ajs.datepicker.localisations.day-names.saturday")],dayNamesMin:[a.default.getText("ajs.datepicker.localisations.day-names-min.sunday"),a.default.getText("ajs.datepicker.localisations.day-names-min.monday"),a.default.getText("ajs.datepicker.localisations.day-names-min.tuesday"),
a.default.getText("ajs.datepicker.localisations.day-names-min.wednesday"),a.default.getText("ajs.datepicker.localisations.day-names-min.thursday"),a.default.getText("ajs.datepicker.localisations.day-names-min.friday"),a.default.getText("ajs.datepicker.localisations.day-names-min.saturday")],firstDay:a.default.getText("ajs.datepicker.localisations.first-day"),isRTL:"true"===a.default.getText("ajs.datepicker.localisations.is-RTL")?!0:!1,monthNames:[a.default.getText("ajs.datepicker.localisations.month-names.january"),
a.default.getText("ajs.datepicker.localisations.month-names.february"),a.default.getText("ajs.datepicker.localisations.month-names.march"),a.default.getText("ajs.datepicker.localisations.month-names.april"),a.default.getText("ajs.datepicker.localisations.month-names.may"),a.default.getText("ajs.datepicker.localisations.month-names.june"),a.default.getText("ajs.datepicker.localisations.month-names.july"),a.default.getText("ajs.datepicker.localisations.month-names.august"),a.default.getText("ajs.datepicker.localisations.month-names.september"),
a.default.getText("ajs.datepicker.localisations.month-names.october"),a.default.getText("ajs.datepicker.localisations.month-names.november"),a.default.getText("ajs.datepicker.localisations.month-names.december")],showMonthAfterYear:"true"===a.default.getText("ajs.datepicker.localisations.show-month-after-year")?!0:!1,yearSuffix:a.default.getText("ajs.datepicker.localisations.year-suffix")};f.default.fn.datePicker=function(a){var c=this.data("aui-datepicker");c?"object"===("undefined"===typeof a?"undefined":
A(a))&&c.reconfigure(a):(c=new g(this,a),this.data("aui-datepicker",c));return c};(0,c.default)("DatePicker",g);j.default=g;return j=j["default"]}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-jquery-ui-datepicker', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.datepicker.js' */
("undefined"===typeof window?global:window).__a79c77fa647d1faac4fff81c2c2d8d79=function(){(function(d){function B(){this.debug=!1;this._curInst=null;this._keyEvent=!1;this._disabledInputs=[];this._inDialog=this._datepickerShowing=!1;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass=
"ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:"January February March April May June July August September October November December".split(" "),monthNamesShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),dayNames:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),dayNamesShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),
dayNamesMin:"Su Mo Tu We Th Fr Sa".split(" "),weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",
minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1};d.extend(this._defaults,this.regional[""]);this.dpDiv=C(d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function C(a){return a.bind("mouseout",
function(a){a=d(a.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");a.length&&a.removeClass("ui-state-hover ui-datepicker-prev-hover ui-datepicker-next-hover")}).bind("mouseover",function(b){b=d(b.target).closest("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a");if(!d.datepicker._isDisabledDatepicker(D.inline?a.parent()[0]:D.input[0])&&b.length)b.parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),
b.addClass("ui-state-hover"),b.hasClass("ui-datepicker-prev")&&b.addClass("ui-datepicker-prev-hover"),b.hasClass("ui-datepicker-next")&&b.addClass("ui-datepicker-next-hover")})}function z(a,b){d.extend(a,b);for(var c in b)if(null==b[c]||void 0==b[c])a[c]=b[c];return a}d.extend(d.ui,{datepicker:{version:"1.8.24"}});var x=(new Date).getTime(),D;d.extend(B.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},
setDefaults:function(a){z(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null,e;for(e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase();f="div"==e||"span"==e;a.id||(this.uuid+=1,a.id="dp"+this.uuid);var j=this._newInst(d(a),f);j.settings=d.extend({},b||{},c||{});"input"==e?this._connectDatepicker(a,j):f&&this._inlineDatepicker(a,j)},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_-])/g,
"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:C(d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]);b.trigger=d([]);c.hasClass(this.markerClassName)||(this._attachments(c,b),c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",
function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),this._autoSize(b),d.data(a,"datepicker",b),b.settings.disabled&&this._disableDatepicker(a))},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove();c&&(b.append=d('<span class="'+this._appendClass+'">'+c+"</span>"),a[e?"before":"after"](b.append));a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();c=this._get(b,"showOn");("focus"==
c||"both"==c)&&a.focus(this._showDatepicker);if("button"==c||"both"==c){var c=this._get(b,"buttonText"),f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(""==f?c:d("<img/>").attr({src:f,alt:c,title:c})));a[e?"before":"after"](b.trigger);b.trigger.click(function(){if(d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0])d.datepicker._hideDatepicker();
else{d.datepicker._datepickerShowing&&d.datepicker._lastInput!=a[0]&&d.datepicker._hideDatepicker();d.datepicker._showDatepicker(a[0])}return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var d=function(a){for(var b=0,c=0,d=0;d<a.length;d++)a[d].length>b&&(b=a[d].length,c=d);return c};b.setMonth(d(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(d(this._get(a,c.match(/DD/)?"dayNames":
"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);c.hasClass(this.markerClassName)||(c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(a,c,d){b.settings[c]=d}).bind("getData.datepicker",function(a,c){return this._get(b,c)}),d.data(a,"datepicker",b),this._setDate(b,this._getDefaultDate(b),!0),this._updateDatepicker(b),this._updateAlternate(b),b.settings.disabled&&this._disableDatepicker(a),
b.dpDiv.css("display","block"))},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst;a||(this.uuid+=1,this._dialogInput=d('<input type="text" id="dp'+this.uuid+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),d("body").append(this._dialogInput),a=this._dialogInst=this._newInst(this._dialogInput,!1),a.settings={},d.data(this._dialogInput[0],"datepicker",a));z(a.settings,e||{});b=b&&b.constructor==Date?this._formatDate(a,b):b;this._dialogInput.val(b);
this._pos=f?f.length?f:[f.pageX,f.pageY]:null;this._pos||(this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]);this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=c;this._inDialog=!0;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);d.blockUI&&d.blockUI(this.dpDiv);
d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker");"input"==e?(c.append.remove(),c.trigger.remove(),b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"==e||"span"==e)&&b.removeClass(this.markerClassName).empty()}},
_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if("input"==e)a.disabled=!1,c.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""});else if("div"==e||"span"==e)b=b.children("."+this._inlineClass),b.children().removeClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").removeAttr("disabled");this._disabledInputs=d.map(this._disabledInputs,
function(b){return b==a?null:b})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if("input"==e)a.disabled=!0,c.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"});else if("div"==e||"span"==e)b=b.children("."+this._inlineClass),b.children().addClass("ui-state-disabled"),b.find("select.ui-datepicker-month, select.ui-datepicker-year").attr("disabled",
"disabled");this._disabledInputs=d.map(this._disabledInputs,function(b){return b==a?null:b});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;b<this._disabledInputs.length;b++)if(this._disabledInputs[b]==a)return!0;return!1},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(2==arguments.length&&"string"==typeof b)return"defaults"==
b?d.extend({},d.datepicker._defaults):e?"all"==b?d.extend({},e.settings):this._get(e,b):null;var f=b||{};"string"==typeof b&&(f={},f[b]=c);if(e){this._curInst==e&&this._hideDatepicker();var h=this._getDateDatepicker(a,!0),j=this._getMinMaxDate(e,"min"),g=this._getMinMaxDate(e,"max");z(e.settings,f);null!==j&&(void 0!==f.dateFormat&&void 0===f.minDate)&&(e.settings.minDate=this._formatDate(e,j));null!==g&&(void 0!==f.dateFormat&&void 0===f.maxDate)&&(e.settings.maxDate=this._formatDate(e,g));this._attachments(d(a),
e);this._autoSize(e);this._setDate(e,h);this._updateAlternate(e);this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);c&&!c.inline&&this._setDateFromField(c,b);return c?this._getDate(c):null},_doKeyDown:function(a){var b=
d.datepicker._getInst(a.target),c=!0,e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=!0;if(d.datepicker._datepickerShowing)switch(a.keyCode){case 9:d.datepicker._hideDatepicker();c=!1;break;case 13:return c=d("td."+d.datepicker._dayOverClass+":not(."+d.datepicker._currentClass+")",b.dpDiv),c[0]&&d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]),(a=d.datepicker._get(b,"onSelect"))?(c=d.datepicker._formatDate(b),a.apply(b.input?b.input[0]:null,[c,b])):d.datepicker._hideDatepicker(),
!1;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:(a.ctrlKey||a.metaKey)&&d.datepicker._clearDate(a.target);c=a.ctrlKey||a.metaKey;break;case 36:(a.ctrlKey||a.metaKey)&&d.datepicker._gotoToday(a.target);c=a.ctrlKey||a.metaKey;
break;case 37:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?1:-1,"D");c=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 38:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,-7,"D");c=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey)d.datepicker._adjustDate(a.target,e?-1:1,"D");c=a.ctrlKey||a.metaKey;a.originalEvent.altKey&&d.datepicker._adjustDate(a.target,
a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 40:(a.ctrlKey||a.metaKey)&&d.datepicker._adjustDate(a.target,7,"D");c=a.ctrlKey||a.metaKey;break;default:c=!1}else 36==a.keyCode&&a.ctrlKey?d.datepicker._showDatepicker(this):c=!1;c&&(a.preventDefault(),a.stopPropagation())},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){var b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat")),c=String.fromCharCode(void 0==
a.charCode?a.keyCode:a.charCode);return a.ctrlKey||a.metaKey||" ">c||!b||-1<b.indexOf(c)}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal)try{if(d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a)))d.datepicker._setDateFromField(a),d.datepicker._updateAlternate(a),d.datepicker._updateDatepicker(a)}catch(b){d.datepicker.log(b)}return!0},_showDatepicker:function(a){a=a.target||a;"input"!=a.nodeName.toLowerCase()&&
(a=d("input",a.parentNode)[0]);if(!(d.datepicker._isDisabledDatepicker(a)||d.datepicker._lastInput==a)){var b=d.datepicker._getInst(a);d.datepicker._curInst&&d.datepicker._curInst!=b&&(d.datepicker._curInst.dpDiv.stop(!0,!0),b&&d.datepicker._datepickerShowing&&d.datepicker._hideDatepicker(d.datepicker._curInst.input[0]));var c=d.datepicker._get(b,"beforeShow"),c=c?c.apply(a,[a,b]):{};if(!1!==c){z(b.settings,c);b.lastVal=null;d.datepicker._lastInput=a;d.datepicker._setDateFromField(b);d.datepicker._inDialog&&
(a.value="");d.datepicker._pos||(d.datepicker._pos=d.datepicker._findPos(a),d.datepicker._pos[1]+=a.offsetHeight);var e=!1;d(a).parents().each(function(){e=e|d(this).css("position")=="fixed";return!e});e&&d.browser.opera&&(d.datepicker._pos[0]-=document.documentElement.scrollLeft,d.datepicker._pos[1]-=document.documentElement.scrollTop);c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;b.dpDiv.empty();b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(b);
c=d.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){var c=d.datepicker._get(b,"showAnim"),f=d.datepicker._get(b,"duration"),h=function(){var a=b.dpDiv.find("iframe.ui-datepicker-cover");if(a.length){var c=d.datepicker._getBorders(b.dpDiv);a.css({left:-c[0],top:-c[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})}};b.dpDiv.zIndex(d(a).zIndex()+1);d.datepicker._datepickerShowing=
!0;if(d.effects&&d.effects[c])b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,h);else b.dpDiv[c||"show"](c?f:null,h);(!c||!f)&&h();b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();d.datepicker._curInst=b}}}},_updateDatepicker:function(a){this.maxRows=4;var b=d.datepicker._getBorders(a.dpDiv);D=a;a.dpDiv.empty().append(this._generateHTML(a));this._attachHandlers(a);var c=a.dpDiv.find("iframe.ui-datepicker-cover");c.length&&c.css({left:-b[0],top:-b[1],width:a.dpDiv.outerWidth(),
height:a.dpDiv.outerHeight()});a.dpDiv.find("."+this._dayOverClass+" a").mouseover();b=this._getNumberOfMonths(a);c=b[1];a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");1<c&&a.dpDiv.addClass("ui-datepicker-multi-"+c).css("width",17*c+"em");a.dpDiv[(1!=b[0]||1!=b[1]?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==d.datepicker._curInst&&(d.datepicker._datepickerShowing&&
a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input[0]!=document.activeElement)&&a.input.focus();if(a.yearshtml){var e=a.yearshtml;setTimeout(function(){e===a.yearshtml&&a.yearshtml&&a.dpDiv.find("select.ui-datepicker-year:first").replaceWith(a.yearshtml);e=a.yearshtml=null},0)}},_getBorders:function(a){var b=function(a){return{thin:1,medium:2,thick:3}[a]||a};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=
a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),h=a.input?a.input.outerWidth():0,j=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+(c?0:d(document).scrollLeft()),i=document.documentElement.clientHeight+(c?0:d(document).scrollTop());b.left-=this._get(a,"isRTL")?e-h:0;b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0;b.top-=c&&b.top==a.input.offset().top+j?d(document).scrollTop():0;b.left-=Math.min(b.left,b.left+e>g&&g>e?Math.abs(b.left+e-g):0);b.top-=Math.min(b.top,
b.top+f>i&&i>f?Math.abs(f+j):0);return b},_findPos:function(a){for(var b=this._getInst(a),b=this._get(b,"isRTL");a&&("hidden"==a.type||1!=a.nodeType||d.expr.filters.hidden(a));)a=a[b?"previousSibling":"nextSibling"];a=d(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(b&&!(a&&b!=d.data(a,"datepicker"))&&this._datepickerShowing){var a=this._get(b,"showAnim"),c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b)};if(d.effects&&d.effects[a])b.dpDiv.hide(a,
d.datepicker._get(b,"showOptions"),c,e);else b.dpDiv["slideDown"==a?"slideUp":"fadeIn"==a?"fadeOut":"hide"](a?c:null,e);a||e();this._datepickerShowing=!1;(a=this._get(b,"onClose"))&&a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b]);this._lastInput=null;this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),d.blockUI&&(d.unblockUI(),d("body").append(this.dpDiv)));this._inDialog=!1}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},
_checkExternalClick:function(a){if(d.datepicker._curInst){var a=d(a.target),b=d.datepicker._getInst(a[0]);(a[0].id!=d.datepicker._mainDivId&&0==a.parents("#"+d.datepicker._mainDivId).length&&!a.hasClass(d.datepicker.markerClassName)&&!a.closest("."+d.datepicker._triggerClass).length&&d.datepicker._datepickerShowing&&(!d.datepicker._inDialog||!d.blockUI)||a.hasClass(d.datepicker.markerClassName)&&d.datepicker._curInst!=b)&&d.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){var a=d(a),e=this._getInst(a[0]);
this._isDisabledDatepicker(a[0])||(this._adjustInstDate(e,b+("M"==c?this._get(e,"showCurrentAtPos"):0),c),this._updateDatepicker(e))},_gotoToday:function(a){var a=d(a),b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay)b.selectedDay=b.currentDay,b.drawMonth=b.selectedMonth=b.currentMonth,b.drawYear=b.selectedYear=b.currentYear;else{var c=new Date;b.selectedDay=c.getDate();b.drawMonth=b.selectedMonth=c.getMonth();b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b);this._adjustDate(a)},
_selectMonthYear:function(a,b,c){var a=d(a),e=this._getInst(a[0]);e["selected"+("M"==c?"Month":"Year")]=e["draw"+("M"==c?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(a)},_selectDay:function(a,b,c,e){var f=d(a);!d(e).hasClass(this._unselectableClass)&&!this._isDisabledDatepicker(f[0])&&(f=this._getInst(f[0]),f.selectedDay=f.currentDay=d("a",e).html(),f.selectedMonth=f.currentMonth=b,f.selectedYear=f.currentYear=c,this._selectDate(a,this._formatDate(f,
f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(a){a=d(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){var c=d(a),c=this._getInst(c[0]),b=null!=b?b:this._formatDate(c);c.input&&c.input.val(b);this._updateAlternate(c);var e=this._get(c,"onSelect");e?e.apply(c.input?c.input[0]:null,[b,c]):c.input&&c.input.trigger("change");c.inline?this._updateDatepicker(c):(this._hideDatepicker(),this._lastInput=c.input[0],"object"!=typeof c.input[0]&&c.input.focus(),this._lastInput=
null)},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[0<a&&6>a,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/864E5)/7)+1},parseDate:function(a,b,c){if(null==
a||null==b)throw"Invalid arguments";b="object"==typeof b?b.toString():b+"";if(""==b)return null;for(var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff,e="string"!=typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,h=(c?c.dayNames:null)||this._defaults.dayNames,j=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,i=c=-1,p=-1,r=-1,k=!1,m=function(b){(b=y+1<a.length&&
a.charAt(y+1)==b)&&y++;return b},l=function(a){var c=m(a),a=RegExp("^\\d{1,"+("@"==a?14:"!"==a?20:"y"==a&&c?4:"o"==a?3:2)+"}"),a=b.substring(u).match(a);if(!a)throw"Missing number at position "+u;u+=a[0].length;return parseInt(a[0],10)},n=function(a,c,e){var a=d.map(m(a)?e:c,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)}),f=-1;d.each(a,function(a,c){var d=c[1];if(b.substr(u,d.length).toLowerCase()==d.toLowerCase())return f=c[0],u+=d.length,!1});if(-1!=f)return f+
1;throw"Unknown name at position "+u;},s=function(){if(b.charAt(u)!=a.charAt(y))throw"Unexpected literal at position "+u;u++},u=0,y=0;y<a.length;y++)if(k)"'"==a.charAt(y)&&!m("'")?k=!1:s();else switch(a.charAt(y)){case "d":p=l("d");break;case "D":n("D",f,h);break;case "o":r=l("o");break;case "m":i=l("m");break;case "M":i=n("M",j,g);break;case "y":c=l("y");break;case "@":var v=new Date(l("@")),c=v.getFullYear(),i=v.getMonth()+1,p=v.getDate();break;case "!":v=new Date((l("!")-this._ticksTo1970)/1E4);
c=v.getFullYear();i=v.getMonth()+1;p=v.getDate();break;case "'":m("'")?s():k=!0;break;default:s()}if(u<b.length)throw"Extra/unparsed characters found in date: "+b.substring(u);-1==c?c=(new Date).getFullYear():100>c&&(c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100));if(-1<r){i=1;p=r;do{e=this._getDaysInMonth(c,i-1);if(p<=e)break;i++;p-=e}while(1)}v=this._daylightSavingAdjust(new Date(c,i-1,p));if(v.getFullYear()!=c||v.getMonth()+1!=i||v.getDate()!=p)throw"Invalid date";return v},
ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864E9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,
c=(c?c.monthNames:null)||this._defaults.monthNames,j=function(b){(b=r+1<a.length&&a.charAt(r+1)==b)&&r++;return b},g=function(a,b,c){b=""+b;if(j(a))for(;b.length<c;)b="0"+b;return b},i="",p=!1;if(b)for(var r=0;r<a.length;r++)if(p)"'"==a.charAt(r)&&!j("'")?p=!1:i+=a.charAt(r);else switch(a.charAt(r)){case "d":i+=g("d",b.getDate(),2);break;case "D":var k;k=b.getDay();var m=d,l=f;k=j("D")?l[k]:m[k];i+=k;break;case "o":i+=g("o",Math.round(((new Date(b.getFullYear(),b.getMonth(),b.getDate())).getTime()-
(new Date(b.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":i+=g("m",b.getMonth()+1,2);break;case "M":k=b.getMonth();m=h;l=c;k=j("M")?l[k]:m[k];i+=k;break;case "y":i+=j("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case "@":i+=b.getTime();break;case "!":i+=1E4*b.getTime()+this._ticksTo1970;break;case "'":j("'")?i+="'":p=!0;break;default:i+=a.charAt(r)}return i},_possibleChars:function(a){for(var b="",c=!1,d=function(b){(b=f+1<a.length&&a.charAt(f+1)==b)&&f++;return b},
f=0;f<a.length;f++)if(c)"'"==a.charAt(f)&&!d("'")?c=!1:b+=a.charAt(f);else switch(a.charAt(f)){case "d":case "m":case "y":case "@":b+="0123456789";break;case "D":case "M":return null;case "'":d("'")?b+="'":c=!0;break;default:b+=a.charAt(f)}return b},_get:function(a,b){return void 0!==a.settings[b]?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);var j=
this._getFormatConfig(a);try{f=this.parseDate(c,d,j)||h}catch(g){this.log(g),d=b?"":d}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=d?f.getDate():0;a.currentMonth=d?f.getMonth():0;a.currentYear=d?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){if(null==b||""===b)b=c;else{var e;if("string"==
typeof b)a:{try{e=d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),b,d.datepicker._getFormatConfig(a));break a}catch(f){}var h=(b.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,a=h.getFullYear();e=h.getMonth();for(var h=h.getDate(),j=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,g=j.exec(b);g;){switch(g[2]||"d"){case "d":case "D":h+=parseInt(g[1],10);break;case "w":case "W":h+=7*parseInt(g[1],10);break;case "m":case "M":e+=parseInt(g[1],10);h=Math.min(h,d.datepicker._getDaysInMonth(a,
e));break;case "y":case "Y":a+=parseInt(g[1],10),h=Math.min(h,d.datepicker._getDaysInMonth(a,e))}g=j.exec(b)}e=new Date(a,e,h)}else"number"==typeof b?isNaN(b)?b=c:(a=new Date,a.setDate(a.getDate()+b),b=a):b=new Date(b.getTime()),e=b;b=e}if(b=b&&"Invalid Date"==b.toString()?c:b)b.setHours(0),b.setMinutes(0),b.setSeconds(0),b.setMilliseconds(0);return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a)return null;a.setHours(12<a.getHours()?a.getHours()+2:0);return a},_setDate:function(a,
b,c){var d=!b,f=a.selectedMonth,h=a.selectedYear,b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();(f!=a.selectedMonth||h!=a.selectedYear)&&!c&&this._notifyChange(a);this._adjustInstDate(a);a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){return!a.currentYear||a.input&&""==a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,
a.currentMonth,a.currentDay))},_attachHandlers:function(a){var b=this._get(a,"stepMonths"),c="#"+a.id.replace(/\\\\/g,"\\");a.dpDiv.find("[data-handler]").map(function(){d(this).bind(this.getAttribute("data-event"),{prev:function(){window["DP_jQuery_"+x].datepicker._adjustDate(c,-b,"M")},next:function(){window["DP_jQuery_"+x].datepicker._adjustDate(c,+b,"M")},hide:function(){window["DP_jQuery_"+x].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+x].datepicker._gotoToday(c)},selectDay:function(){window["DP_jQuery_"+
x].datepicker._selectDay(c,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return!1},selectMonth:function(){window["DP_jQuery_"+x].datepicker._selectMonthYear(c,this,"M");return!1},selectYear:function(){window["DP_jQuery_"+x].datepicker._selectMonthYear(c,this,"Y");return!1}}[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b=new Date,b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate())),c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),
f=this._get(a,"hideIfNoPrevNext"),h=this._get(a,"navigationAsDateFormat"),j=this._getNumberOfMonths(a),g=this._get(a,"showCurrentAtPos"),i=this._get(a,"stepMonths"),p=1!=j[0]||1!=j[1],r=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),k=this._getMinMaxDate(a,"min"),m=this._getMinMaxDate(a,"max"),g=a.drawMonth-g,l=a.drawYear;0>g&&(g+=12,l--);if(m)for(var n=this._daylightSavingAdjust(new Date(m.getFullYear(),m.getMonth()-j[0]*j[1]+1,m.getDate())),
n=k&&n<k?k:n;this._daylightSavingAdjust(new Date(l,g,1))>n;)g--,0>g&&(g=11,l--);a.drawMonth=g;a.drawYear=l;var n=this._get(a,"prevText"),n=!h?n:this.formatDate(n,this._daylightSavingAdjust(new Date(l,g-i,1)),this._getFormatConfig(a)),n=this._canAdjustMonth(a,-1,l,g)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+
n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>",s=this._get(a,"nextText"),s=!h?s:this.formatDate(s,this._daylightSavingAdjust(new Date(l,g+i,1)),this._getFormatConfig(a)),f=this._canAdjustMonth(a,1,l,g)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+s+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+s+'"><span class="ui-icon ui-icon-circle-triangle-'+
(c?"w":"e")+'">'+s+"</span></a>",i=this._get(a,"currentText"),s=this._get(a,"gotoCurrent")&&a.currentDay?r:b,i=!h?i:this.formatDate(i,s,this._getFormatConfig(a)),h=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(a,"closeText")+"</button>":"",e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?h:"")+(this._isInRange(a,s)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+
i+"</button>":"")+(c?"":h)+"</div>":"",h=parseInt(this._get(a,"firstDay"),10),h=isNaN(h)?0:h,i=this._get(a,"showWeek"),s=this._get(a,"dayNames");this._get(a,"dayNamesShort");var u=this._get(a,"dayNamesMin"),y=this._get(a,"monthNames"),v=this._get(a,"monthNamesShort"),x=this._get(a,"beforeShowDay"),z=this._get(a,"showOtherMonths"),D=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var B=this._getDefaultDate(a),E="",F=0;F<j[0];F++){var I="";this.maxRows=4;for(var G=0;G<j[1];G++){var C=
this._daylightSavingAdjust(new Date(l,g,a.selectedDay)),t=" ui-corner-all",q="";if(p){q+='<div class="ui-datepicker-group';if(1<j[1])switch(G){case 0:q+=" ui-datepicker-group-first";t=" ui-corner-"+(c?"right":"left");break;case j[1]-1:q+=" ui-datepicker-group-last";t=" ui-corner-"+(c?"left":"right");break;default:q+=" ui-datepicker-group-middle",t=""}q+='">'}for(var q=q+('<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+t+'">'+(/all|left/.test(t)&&0==F?c?f:n:"")+(/all|right/.test(t)&&
0==F?c?n:f:"")+this._generateMonthYearHeader(a,g,l,k,m,0<F||0<G,y,v)+'</div><table class="ui-datepicker-calendar"><thead><tr>'),w=i?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"",t=0;7>t;t++)var o=(t+h)%7,w=w+("<th"+(5<=(t+h+6)%7?' class="ui-datepicker-week-end"':"")+'><span title="'+s[o]+'">'+u[o]+"</span></th>");q+=w+"</tr></thead><tbody>";w=this._getDaysInMonth(l,g);l==a.selectedYear&&g==a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,w));t=(this._getFirstDayOfMonth(l,
g)-h+7)%7;w=Math.ceil((t+w)/7);this.maxRows=w=p?this.maxRows>w?this.maxRows:w:w;for(var o=this._daylightSavingAdjust(new Date(l,g,1-t)),L=0;L<w;L++){for(var q=q+"<tr>",J=!i?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(o)+"</td>",t=0;7>t;t++){var H=x?x.apply(a.input?a.input[0]:null,[o]):[!0,""],A=o.getMonth()!=g,K=A&&!D||!H[0]||k&&o<k||m&&o>m,J=J+('<td class="'+(5<=(t+h+6)%7?" ui-datepicker-week-end":"")+(A?" ui-datepicker-other-month":"")+(o.getTime()==C.getTime()&&g==a.selectedMonth&&
a._keyEvent||B.getTime()==o.getTime()&&B.getTime()==C.getTime()?" "+this._dayOverClass:"")+(K?" "+this._unselectableClass+" ui-state-disabled":"")+(A&&!z?"":" "+H[1]+(o.getTime()==r.getTime()?" "+this._currentClass:"")+(o.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!A||z)&&H[2]?' title="'+H[2]+'"':"")+(K?"":' data-handler="selectDay" data-event="click" data-month="'+o.getMonth()+'" data-year="'+o.getFullYear()+'"')+">"+(A&&!z?"&#xa0;":K?'<span class="ui-state-default">'+o.getDate()+"</span>":
'<a class="ui-state-default'+(o.getTime()==b.getTime()?" ui-state-highlight":"")+(o.getTime()==r.getTime()?" ui-state-active":"")+(A?" ui-priority-secondary":"")+'" href="#">'+o.getDate()+"</a>")+"</td>");o.setDate(o.getDate()+1);o=this._daylightSavingAdjust(o)}q+=J+"</tr>"}g++;11<g&&(g=0,l++);q+="</tbody></table>"+(p?"</div>"+(0<j[0]&&G==j[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");I+=q}E+=I}E+=e+(d.browser.msie&&7>parseInt(d.browser.version,10)&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':
"");a._keyEvent=!1;return E},_generateMonthYearHeader:function(a,b,c,d,f,h,j,g){var i=this._get(a,"changeMonth"),p=this._get(a,"changeYear"),r=this._get(a,"showMonthAfterYear"),k='<div class="ui-datepicker-title">',m="";if(h||!i)m+='<span class="ui-datepicker-month">'+j[b]+"</span>";else{for(var j=d&&d.getFullYear()==c,l=f&&f.getFullYear()==c,m=m+'<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">',n=0;12>n;n++)if((!j||n>=d.getMonth())&&(!l||n<=f.getMonth()))m+='<option value="'+
n+'"'+(n==b?' selected="selected"':"")+">"+g[n]+"</option>";m+="</select>"}r||(k+=m+(h||!i||!p?"&#xa0;":""));if(!a.yearshtml)if(a.yearshtml="",h||!p)k+='<span class="ui-datepicker-year">'+c+"</span>";else{var g=this._get(a,"yearRange").split(":"),s=(new Date).getFullYear(),j=function(a){a=a.match(/c[+-].*/)?c+parseInt(a.substring(1),10):a.match(/[+-].*/)?s+parseInt(a,10):parseInt(a,10);return isNaN(a)?s:a},b=j(g[0]),g=Math.max(b,j(g[1]||"")),b=d?Math.max(b,d.getFullYear()):b,g=f?Math.min(g,f.getFullYear()):
g;for(a.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';b<=g;b++)a.yearshtml+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>";a.yearshtml+="</select>";k+=a.yearshtml;a.yearshtml=null}k+=this._get(a,"yearSuffix");r&&(k+=(h||!i||!p?"&#xa0;":"")+m);return k+"</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"==c?b:0),f=a.drawMonth+("M"==c?b:0),b=Math.min(a.selectedDay,this._getDaysInMonth(d,f))+("D"==c?b:0),d=this._restrictMinMax(a,
this._daylightSavingAdjust(new Date(d,f,b)));a.selectedDay=d.getDate();a.drawMonth=a.selectedMonth=d.getMonth();a.drawYear=a.selectedYear=d.getFullYear();("M"==c||"Y"==c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),c=c&&b<c?c:b;return d&&c>d?d:c},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){a=this._get(a,
"numberOfMonths");return null==a?[1,1]:"number"==typeof a?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,d){var f=this._getNumberOfMonths(a),c=this._daylightSavingAdjust(new Date(c,d+(0>b?b:f[0]*f[1]),1));0>b&&c.setDate(this._getDaysInMonth(c.getFullYear(),
c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!d||b.getTime()<=d.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff"),b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,
"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);b=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});d.fn.datepicker=function(a){if(!this.length)return this;d.datepicker.initialized||(d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv),
d.datepicker.initialized=!0);var b=Array.prototype.slice.call(arguments,1);return"string"==typeof a&&("isDisabled"==a||"getDate"==a||"widget"==a)||"option"==a&&2==arguments.length&&"string"==typeof arguments[1]?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b)):this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})};d.datepicker=new B;d.datepicker.initialized=!1;d.datepicker.uuid=
(new Date).getTime();d.datepicker.version="1.8.24";window["DP_jQuery_"+x]=d})(jQuery);return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-vendor-jquery-plugins-jquery-select2', location = 'src/js-vendor/jquery/plugins/jquery.select2.js' */
("undefined"===typeof window?global:window).__24a4022719d391909eb24beb4cb94950=function(){var y=jQuery;"undefined"==typeof y.fn.each2&&y.extend(y.fn,{each2:function(a){for(var b=y([0]),c=-1,d=this.length;++c<d&&(b.context=b[0]=this[c])&&!1!==a.call(b[0],c,b););return this}});var e=jQuery,w=function(a){var b,c,d,g;if(!a||1>a.length)return a;b="";c=0;for(d=a.length;c<d;c++)g=a.charAt(c),b+=O[g]||g;return b},k=function(a,b){for(var c=0,d=b.length;c<d;c+=1)if(m(a,b[c]))return c;return-1},m=function(a,
b){return a===b?!0:void 0===a||void 0===b||null===a||null===b?!1:a.constructor===String?a+""===b+"":b.constructor===String?b+""===a+"":!1},B=function(a,b){var c,d,g;if(null===a||1>a.length)return[];c=a.split(b);d=0;for(g=c.length;d<g;d+=1)c[d]=e.trim(c[d]);return c},G=function(a){a.on("keydown",function(){void 0===e.data(a,"keyup-change-value")&&e.data(a,"keyup-change-value",a.val())});a.on("keyup",function(){var b=e.data(a,"keyup-change-value");void 0!==b&&a.val()!==b&&(e.removeData(a,"keyup-change-value"),
a.trigger("keyup-change"))})},H=function(a,b,c){var c=c||void 0,d;return function(){var g=arguments;window.clearTimeout(d);d=window.setTimeout(function(){b.apply(c,g)},a)}},j=function(a){a.preventDefault();a.stopPropagation()},z=function(a,b,c){var d,g=[],h;(d=a.attr("class"))&&e((""+d).split(" ")).each2(function(){0===this.indexOf("select2-")&&g.push(this)});(d=b.attr("class"))&&e((""+d).split(" ")).each2(function(){0!==this.indexOf("select2-")&&(h=c(this))&&g.push(h)});a.attr("class",g.join(" "))},
I=function(a,b,c,d){var g=w(a.toUpperCase()).indexOf(w(b.toUpperCase())),b=b.length;0>g?c.push(d(a)):(c.push(d(a.substring(0,g))),c.push("<span class='select2-match'>"),c.push(d(a.substring(g,g+b))),c.push("</span>"),c.push(d(a.substring(g+b,a.length))))},J=function(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})},K=function(a){var b,c=null,d=a.quietMillis||100,g=a.url,h=this;return function(l){window.clearTimeout(b);
b=window.setTimeout(function(){var b=a.data,d=g,t=a.transport||e.fn.select2.ajaxDefaults.transport,f=e.extend({},e.fn.select2.ajaxDefaults.params,{type:a.type||"GET",cache:a.cache||!1,jsonpCallback:a.jsonpCallback||void 0,dataType:a.dataType||"json"}),b=b?b.call(h,l.term,l.page,l.context):null,d="function"===typeof d?d.call(h,l.term,l.page,l.context):d;c&&c.abort();a.params&&(e.isFunction(a.params)?e.extend(f,a.params.call(h)):e.extend(f,a.params));e.extend(f,{url:d,dataType:a.dataType,data:b,success:function(b){b=
a.results(b,l.page);l.callback(b)}});c=t.call(h,f)},d)}},L=function(a){var b=a,c,d,g=function(a){return""+a.text};e.isArray(b)&&(d=b,b={results:d});!1===e.isFunction(b)&&(d=b,b=function(){return d});a=b();a.text&&(g=a.text,e.isFunction(g)||(c=a.text,g=function(a){return a[c]}));return function(a){var c=a.term,d={results:[]},n;if(c==="")a.callback(b());else{n=function(b,d){var i,f,b=b[0];if(b.children){i={};for(f in b)b.hasOwnProperty(f)&&(i[f]=b[f]);i.children=[];e(b.children).each2(function(a,b){n(b,
i.children)});(i.children.length||a.matcher(c,g(i),b))&&d.push(i)}else a.matcher(c,g(b),b)&&d.push(b)};e(b().results).each2(function(a,b){n(b,d.results)});a.callback(d)}}},M=function(a){var b=e.isFunction(a);return function(c){var d=c.term,g={results:[]};e(b?a():a).each(function(){var a=void 0!==this.text,b=a?this.text:this;if(""===d||c.matcher(d,b))g.results.push(a?this:{id:this,text:this})});c.callback(g)}},r=function(a,b){if(e.isFunction(a))return!0;if(!a)return!1;throw Error(b+" must be a function or a falsy value");
},o=function(a){return e.isFunction(a)?a():a},N=function(a){var b=0;e.each(a,function(a,d){d.children?b+=N(d.children):b++});return b},P=function(a,b,c,d){var g=a,h=!1,e,i,f,t;if(d.createSearchChoice&&d.tokenSeparators&&!(1>d.tokenSeparators.length)){for(;;){h=-1;i=0;for(f=d.tokenSeparators.length;i<f&&!(t=d.tokenSeparators[i],h=a.indexOf(t),0<=h);i++);if(0>h)break;e=a.substring(0,h);a=a.substring(h+t.length);if(0<e.length&&(e=d.createSearchChoice.call(this,e,b),void 0!==e&&null!==e&&void 0!==d.id(e)&&
null!==d.id(e))){h=!1;i=0;for(f=b.length;i<f;i++)if(m(d.id(e),d.id(b[i]))){h=!0;break}h||c(e)}}if(g!==a)return a}},C=function(a,b){var c=function(){};c.prototype=new a;c.prototype.constructor=c;c.prototype.parent=a.prototype;c.prototype=e.extend(c.prototype,b);return c};if(void 0===window.Select2){var f,s,D,E,A,v,x={x:0,y:0},F;f={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(a){a=
a.which?a.which:a;switch(a){case f.LEFT:case f.RIGHT:case f.UP:case f.DOWN:return!0}return!1},isControl:function(a){switch(a.which){case f.SHIFT:case f.CTRL:case f.ALT:return!0}return a.metaKey?!0:!1},isFunctionKey:function(a){a=a.which?a.which:a;return 112<=a&&123>=a}};var O={"\u24b6":"A","\uff21":"A","\u00c0":"A","\u00c1":"A","\u00c2":"A","\u1ea6":"A","\u1ea4":"A","\u1eaa":"A","\u1ea8":"A","\u00c3":"A","\u0100":"A","\u0102":"A","\u1eb0":"A","\u1eae":"A","\u1eb4":"A","\u1eb2":"A","\u0226":"A","\u01e0":"A",
"\u00c4":"A","\u01de":"A","\u1ea2":"A","\u00c5":"A","\u01fa":"A","\u01cd":"A","\u0200":"A","\u0202":"A","\u1ea0":"A","\u1eac":"A","\u1eb6":"A","\u1e00":"A","\u0104":"A","\u023a":"A","\u2c6f":"A","\ua732":"AA","\u00c6":"AE","\u01fc":"AE","\u01e2":"AE","\ua734":"AO","\ua736":"AU","\ua738":"AV","\ua73a":"AV","\ua73c":"AY","\u24b7":"B","\uff22":"B","\u1e02":"B","\u1e04":"B","\u1e06":"B","\u0243":"B","\u0182":"B","\u0181":"B","\u24b8":"C","\uff23":"C","\u0106":"C","\u0108":"C","\u010a":"C","\u010c":"C",
"\u00c7":"C","\u1e08":"C","\u0187":"C","\u023b":"C","\ua73e":"C","\u24b9":"D","\uff24":"D","\u1e0a":"D","\u010e":"D","\u1e0c":"D","\u1e10":"D","\u1e12":"D","\u1e0e":"D","\u0110":"D","\u018b":"D","\u018a":"D","\u0189":"D","\ua779":"D","\u01f1":"DZ","\u01c4":"DZ","\u01f2":"Dz","\u01c5":"Dz","\u24ba":"E","\uff25":"E","\u00c8":"E","\u00c9":"E","\u00ca":"E","\u1ec0":"E","\u1ebe":"E","\u1ec4":"E","\u1ec2":"E","\u1ebc":"E","\u0112":"E","\u1e14":"E","\u1e16":"E","\u0114":"E","\u0116":"E","\u00cb":"E","\u1eba":"E",
"\u011a":"E","\u0204":"E","\u0206":"E","\u1eb8":"E","\u1ec6":"E","\u0228":"E","\u1e1c":"E","\u0118":"E","\u1e18":"E","\u1e1a":"E","\u0190":"E","\u018e":"E","\u24bb":"F","\uff26":"F","\u1e1e":"F","\u0191":"F","\ua77b":"F","\u24bc":"G","\uff27":"G","\u01f4":"G","\u011c":"G","\u1e20":"G","\u011e":"G","\u0120":"G","\u01e6":"G","\u0122":"G","\u01e4":"G","\u0193":"G","\ua7a0":"G","\ua77d":"G","\ua77e":"G","\u24bd":"H","\uff28":"H","\u0124":"H","\u1e22":"H","\u1e26":"H","\u021e":"H","\u1e24":"H","\u1e28":"H",
"\u1e2a":"H","\u0126":"H","\u2c67":"H","\u2c75":"H","\ua78d":"H","\u24be":"I","\uff29":"I","\u00cc":"I","\u00cd":"I","\u00ce":"I","\u0128":"I","\u012a":"I","\u012c":"I","\u0130":"I","\u00cf":"I","\u1e2e":"I","\u1ec8":"I","\u01cf":"I","\u0208":"I","\u020a":"I","\u1eca":"I","\u012e":"I","\u1e2c":"I","\u0197":"I","\u24bf":"J","\uff2a":"J","\u0134":"J","\u0248":"J","\u24c0":"K","\uff2b":"K","\u1e30":"K","\u01e8":"K","\u1e32":"K","\u0136":"K","\u1e34":"K","\u0198":"K","\u2c69":"K","\ua740":"K","\ua742":"K",
"\ua744":"K","\ua7a2":"K","\u24c1":"L","\uff2c":"L","\u013f":"L","\u0139":"L","\u013d":"L","\u1e36":"L","\u1e38":"L","\u013b":"L","\u1e3c":"L","\u1e3a":"L","\u0141":"L","\u023d":"L","\u2c62":"L","\u2c60":"L","\ua748":"L","\ua746":"L","\ua780":"L","\u01c7":"LJ","\u01c8":"Lj","\u24c2":"M","\uff2d":"M","\u1e3e":"M","\u1e40":"M","\u1e42":"M","\u2c6e":"M","\u019c":"M","\u24c3":"N","\uff2e":"N","\u01f8":"N","\u0143":"N","\u00d1":"N","\u1e44":"N","\u0147":"N","\u1e46":"N","\u0145":"N","\u1e4a":"N","\u1e48":"N",
"\u0220":"N","\u019d":"N","\ua790":"N","\ua7a4":"N","\u01ca":"NJ","\u01cb":"Nj","\u24c4":"O","\uff2f":"O","\u00d2":"O","\u00d3":"O","\u00d4":"O","\u1ed2":"O","\u1ed0":"O","\u1ed6":"O","\u1ed4":"O","\u00d5":"O","\u1e4c":"O","\u022c":"O","\u1e4e":"O","\u014c":"O","\u1e50":"O","\u1e52":"O","\u014e":"O","\u022e":"O","\u0230":"O","\u00d6":"O","\u022a":"O","\u1ece":"O","\u0150":"O","\u01d1":"O","\u020c":"O","\u020e":"O","\u01a0":"O","\u1edc":"O","\u1eda":"O","\u1ee0":"O","\u1ede":"O","\u1ee2":"O","\u1ecc":"O",
"\u1ed8":"O","\u01ea":"O","\u01ec":"O","\u00d8":"O","\u01fe":"O","\u0186":"O","\u019f":"O","\ua74a":"O","\ua74c":"O","\u01a2":"OI","\ua74e":"OO","\u0222":"OU","\u24c5":"P","\uff30":"P","\u1e54":"P","\u1e56":"P","\u01a4":"P","\u2c63":"P","\ua750":"P","\ua752":"P","\ua754":"P","\u24c6":"Q","\uff31":"Q","\ua756":"Q","\ua758":"Q","\u024a":"Q","\u24c7":"R","\uff32":"R","\u0154":"R","\u1e58":"R","\u0158":"R","\u0210":"R","\u0212":"R","\u1e5a":"R","\u1e5c":"R","\u0156":"R","\u1e5e":"R","\u024c":"R","\u2c64":"R",
"\ua75a":"R","\ua7a6":"R","\ua782":"R","\u24c8":"S","\uff33":"S","\u1e9e":"S","\u015a":"S","\u1e64":"S","\u015c":"S","\u1e60":"S","\u0160":"S","\u1e66":"S","\u1e62":"S","\u1e68":"S","\u0218":"S","\u015e":"S","\u2c7e":"S","\ua7a8":"S","\ua784":"S","\u24c9":"T","\uff34":"T","\u1e6a":"T","\u0164":"T","\u1e6c":"T","\u021a":"T","\u0162":"T","\u1e70":"T","\u1e6e":"T","\u0166":"T","\u01ac":"T","\u01ae":"T","\u023e":"T","\ua786":"T","\ua728":"TZ","\u24ca":"U","\uff35":"U","\u00d9":"U","\u00da":"U","\u00db":"U",
"\u0168":"U","\u1e78":"U","\u016a":"U","\u1e7a":"U","\u016c":"U","\u00dc":"U","\u01db":"U","\u01d7":"U","\u01d5":"U","\u01d9":"U","\u1ee6":"U","\u016e":"U","\u0170":"U","\u01d3":"U","\u0214":"U","\u0216":"U","\u01af":"U","\u1eea":"U","\u1ee8":"U","\u1eee":"U","\u1eec":"U","\u1ef0":"U","\u1ee4":"U","\u1e72":"U","\u0172":"U","\u1e76":"U","\u1e74":"U","\u0244":"U","\u24cb":"V","\uff36":"V","\u1e7c":"V","\u1e7e":"V","\u01b2":"V","\ua75e":"V","\u0245":"V","\ua760":"VY","\u24cc":"W","\uff37":"W","\u1e80":"W",
"\u1e82":"W","\u0174":"W","\u1e86":"W","\u1e84":"W","\u1e88":"W","\u2c72":"W","\u24cd":"X","\uff38":"X","\u1e8a":"X","\u1e8c":"X","\u24ce":"Y","\uff39":"Y","\u1ef2":"Y","\u00dd":"Y","\u0176":"Y","\u1ef8":"Y","\u0232":"Y","\u1e8e":"Y","\u0178":"Y","\u1ef6":"Y","\u1ef4":"Y","\u01b3":"Y","\u024e":"Y","\u1efe":"Y","\u24cf":"Z","\uff3a":"Z","\u0179":"Z","\u1e90":"Z","\u017b":"Z","\u017d":"Z","\u1e92":"Z","\u1e94":"Z","\u01b5":"Z","\u0224":"Z","\u2c7f":"Z","\u2c6b":"Z","\ua762":"Z","\u24d0":"a","\uff41":"a",
"\u1e9a":"a","\u00e0":"a","\u00e1":"a","\u00e2":"a","\u1ea7":"a","\u1ea5":"a","\u1eab":"a","\u1ea9":"a","\u00e3":"a","\u0101":"a","\u0103":"a","\u1eb1":"a","\u1eaf":"a","\u1eb5":"a","\u1eb3":"a","\u0227":"a","\u01e1":"a","\u00e4":"a","\u01df":"a","\u1ea3":"a","\u00e5":"a","\u01fb":"a","\u01ce":"a","\u0201":"a","\u0203":"a","\u1ea1":"a","\u1ead":"a","\u1eb7":"a","\u1e01":"a","\u0105":"a","\u2c65":"a","\u0250":"a","\ua733":"aa","\u00e6":"ae","\u01fd":"ae","\u01e3":"ae","\ua735":"ao","\ua737":"au","\ua739":"av",
"\ua73b":"av","\ua73d":"ay","\u24d1":"b","\uff42":"b","\u1e03":"b","\u1e05":"b","\u1e07":"b","\u0180":"b","\u0183":"b","\u0253":"b","\u24d2":"c","\uff43":"c","\u0107":"c","\u0109":"c","\u010b":"c","\u010d":"c","\u00e7":"c","\u1e09":"c","\u0188":"c","\u023c":"c","\ua73f":"c","\u2184":"c","\u24d3":"d","\uff44":"d","\u1e0b":"d","\u010f":"d","\u1e0d":"d","\u1e11":"d","\u1e13":"d","\u1e0f":"d","\u0111":"d","\u018c":"d","\u0256":"d","\u0257":"d","\ua77a":"d","\u01f3":"dz","\u01c6":"dz","\u24d4":"e","\uff45":"e",
"\u00e8":"e","\u00e9":"e","\u00ea":"e","\u1ec1":"e","\u1ebf":"e","\u1ec5":"e","\u1ec3":"e","\u1ebd":"e","\u0113":"e","\u1e15":"e","\u1e17":"e","\u0115":"e","\u0117":"e","\u00eb":"e","\u1ebb":"e","\u011b":"e","\u0205":"e","\u0207":"e","\u1eb9":"e","\u1ec7":"e","\u0229":"e","\u1e1d":"e","\u0119":"e","\u1e19":"e","\u1e1b":"e","\u0247":"e","\u025b":"e","\u01dd":"e","\u24d5":"f","\uff46":"f","\u1e1f":"f","\u0192":"f","\ua77c":"f","\u24d6":"g","\uff47":"g","\u01f5":"g","\u011d":"g","\u1e21":"g","\u011f":"g",
"\u0121":"g","\u01e7":"g","\u0123":"g","\u01e5":"g","\u0260":"g","\ua7a1":"g","\u1d79":"g","\ua77f":"g","\u24d7":"h","\uff48":"h","\u0125":"h","\u1e23":"h","\u1e27":"h","\u021f":"h","\u1e25":"h","\u1e29":"h","\u1e2b":"h","\u1e96":"h","\u0127":"h","\u2c68":"h","\u2c76":"h","\u0265":"h","\u0195":"hv","\u24d8":"i","\uff49":"i","\u00ec":"i","\u00ed":"i","\u00ee":"i","\u0129":"i","\u012b":"i","\u012d":"i","\u00ef":"i","\u1e2f":"i","\u1ec9":"i","\u01d0":"i","\u0209":"i","\u020b":"i","\u1ecb":"i","\u012f":"i",
"\u1e2d":"i","\u0268":"i","\u0131":"i","\u24d9":"j","\uff4a":"j","\u0135":"j","\u01f0":"j","\u0249":"j","\u24da":"k","\uff4b":"k","\u1e31":"k","\u01e9":"k","\u1e33":"k","\u0137":"k","\u1e35":"k","\u0199":"k","\u2c6a":"k","\ua741":"k","\ua743":"k","\ua745":"k","\ua7a3":"k","\u24db":"l","\uff4c":"l","\u0140":"l","\u013a":"l","\u013e":"l","\u1e37":"l","\u1e39":"l","\u013c":"l","\u1e3d":"l","\u1e3b":"l","\u017f":"l","\u0142":"l","\u019a":"l","\u026b":"l","\u2c61":"l","\ua749":"l","\ua781":"l","\ua747":"l",
"\u01c9":"lj","\u24dc":"m","\uff4d":"m","\u1e3f":"m","\u1e41":"m","\u1e43":"m","\u0271":"m","\u026f":"m","\u24dd":"n","\uff4e":"n","\u01f9":"n","\u0144":"n","\u00f1":"n","\u1e45":"n","\u0148":"n","\u1e47":"n","\u0146":"n","\u1e4b":"n","\u1e49":"n","\u019e":"n","\u0272":"n","\u0149":"n","\ua791":"n","\ua7a5":"n","\u01cc":"nj","\u24de":"o","\uff4f":"o","\u00f2":"o","\u00f3":"o","\u00f4":"o","\u1ed3":"o","\u1ed1":"o","\u1ed7":"o","\u1ed5":"o","\u00f5":"o","\u1e4d":"o","\u022d":"o","\u1e4f":"o","\u014d":"o",
"\u1e51":"o","\u1e53":"o","\u014f":"o","\u022f":"o","\u0231":"o","\u00f6":"o","\u022b":"o","\u1ecf":"o","\u0151":"o","\u01d2":"o","\u020d":"o","\u020f":"o","\u01a1":"o","\u1edd":"o","\u1edb":"o","\u1ee1":"o","\u1edf":"o","\u1ee3":"o","\u1ecd":"o","\u1ed9":"o","\u01eb":"o","\u01ed":"o","\u00f8":"o","\u01ff":"o","\u0254":"o","\ua74b":"o","\ua74d":"o","\u0275":"o","\u01a3":"oi","\u0223":"ou","\ua74f":"oo","\u24df":"p","\uff50":"p","\u1e55":"p","\u1e57":"p","\u01a5":"p","\u1d7d":"p","\ua751":"p","\ua753":"p",
"\ua755":"p","\u24e0":"q","\uff51":"q","\u024b":"q","\ua757":"q","\ua759":"q","\u24e1":"r","\uff52":"r","\u0155":"r","\u1e59":"r","\u0159":"r","\u0211":"r","\u0213":"r","\u1e5b":"r","\u1e5d":"r","\u0157":"r","\u1e5f":"r","\u024d":"r","\u027d":"r","\ua75b":"r","\ua7a7":"r","\ua783":"r","\u24e2":"s","\uff53":"s","\u00df":"s","\u015b":"s","\u1e65":"s","\u015d":"s","\u1e61":"s","\u0161":"s","\u1e67":"s","\u1e63":"s","\u1e69":"s","\u0219":"s","\u015f":"s","\u023f":"s","\ua7a9":"s","\ua785":"s","\u1e9b":"s",
"\u24e3":"t","\uff54":"t","\u1e6b":"t","\u1e97":"t","\u0165":"t","\u1e6d":"t","\u021b":"t","\u0163":"t","\u1e71":"t","\u1e6f":"t","\u0167":"t","\u01ad":"t","\u0288":"t","\u2c66":"t","\ua787":"t","\ua729":"tz","\u24e4":"u","\uff55":"u","\u00f9":"u","\u00fa":"u","\u00fb":"u","\u0169":"u","\u1e79":"u","\u016b":"u","\u1e7b":"u","\u016d":"u","\u00fc":"u","\u01dc":"u","\u01d8":"u","\u01d6":"u","\u01da":"u","\u1ee7":"u","\u016f":"u","\u0171":"u","\u01d4":"u","\u0215":"u","\u0217":"u","\u01b0":"u","\u1eeb":"u",
"\u1ee9":"u","\u1eef":"u","\u1eed":"u","\u1ef1":"u","\u1ee5":"u","\u1e73":"u","\u0173":"u","\u1e77":"u","\u1e75":"u","\u0289":"u","\u24e5":"v","\uff56":"v","\u1e7d":"v","\u1e7f":"v","\u028b":"v","\ua75f":"v","\u028c":"v","\ua761":"vy","\u24e6":"w","\uff57":"w","\u1e81":"w","\u1e83":"w","\u0175":"w","\u1e87":"w","\u1e85":"w","\u1e98":"w","\u1e89":"w","\u2c73":"w","\u24e7":"x","\uff58":"x","\u1e8b":"x","\u1e8d":"x","\u24e8":"y","\uff59":"y","\u1ef3":"y","\u00fd":"y","\u0177":"y","\u1ef9":"y","\u0233":"y",
"\u1e8f":"y","\u00ff":"y","\u1ef7":"y","\u1e99":"y","\u1ef5":"y","\u01b4":"y","\u024f":"y","\u1eff":"y","\u24e9":"z","\uff5a":"z","\u017a":"z","\u1e91":"z","\u017c":"z","\u017e":"z","\u1e93":"z","\u1e95":"z","\u01b6":"z","\u0225":"z","\u0240":"z","\u2c6c":"z","\ua763":"z"};s=e(document);var Q=1;A=function(){return Q++};s.on("mousemove",function(a){x.x=a.pageX;x.y=a.pageY});s=C(Object,{bind:function(a){var b=this;return function(){a.apply(b,arguments)}},init:function(a){var b,c;this.opts=a=this.prepareOpts(a);
this.id=a.id;void 0!==a.element.data("select2")&&null!==a.element.data("select2")&&a.element.data("select2").destroy();this.container=this.createContainer();this.containerId="s2id_"+(a.element.attr("id")||"autogen"+A());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);var d=!1,g;this.body=function(){!1===d&&(g=a.element.closest("body"),d=!0);return g};z(this.container,this.opts.element,this.opts.adaptContainerCssClass);
this.container.attr("style",a.element.attr("style"));this.container.css(o(a.containerCss));this.container.addClass(o(a.containerCssClass));this.elementTabIndex=this.opts.element.attr("tabindex");this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",j);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");z(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(o(a.dropdownCssClass));
this.dropdown.data("select2",this);this.dropdown.on("click",j);this.results=b=this.container.find(".select2-results");this.search=c=this.container.find("input.select2-input");this.resultsPage=this.queryCount=0;this.context=null;this.initContainer();this.container.on("click",j);this.results.on("mousemove",function(a){(void 0===x||x.x!==a.pageX||x.y!==a.pageY)&&e(a.target).trigger("mousemove-filtered",a)});this.dropdown.on("mousemove-filtered touchstart touchmove touchend",".select2-results",this.bind(this.highlightUnderEvent));
var h=this.results,l=H(80,function(a){h.trigger("scroll-debounced",a)});h.on("scroll",function(a){0<=k(a.target,h.get())&&l(a)});this.dropdown.on("scroll-debounced",".select2-results",this.bind(this.loadMoreIfNeeded));e(this.container).on("change",".select2-input",function(a){a.stopPropagation()});e(this.dropdown).on("change",".select2-input",function(a){a.stopPropagation()});e.fn.mousewheel&&b.mousewheel(function(a,c,d,g){c=b.scrollTop();0<g&&0>=c-g?(b.scrollTop(0),j(a)):0>g&&b.get(0).scrollHeight-
b.scrollTop()+g<=b.height()&&(b.scrollTop(b.get(0).scrollHeight-b.height()),j(a))});G(c);c.on("keyup-change input paste",this.bind(this.updateResults));c.on("focus",function(){c.addClass("select2-focused")});c.on("blur",function(){c.removeClass("select2-focused")});this.dropdown.on("mouseup",".select2-results",this.bind(function(a){0<e(a.target).closest(".select2-result-selectable").length&&(this.highlightUnderEvent(a),this.selectHighlighted(a))}));this.dropdown.on("click mouseup mousedown",function(a){a.stopPropagation()});
e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource());null!==a.maximumInputLength&&this.search.attr("maxlength",a.maximumInputLength);var i=a.element.prop("disabled");void 0===i&&(i=!1);this.enable(!i);i=a.element.prop("readonly");void 0===i&&(i=!1);this.readonly(i);if(!(i=F)){i=e("<div class='select2-measure-scrollbar'></div>");i.appendTo("body");var f={width:i.width()-i[0].clientWidth,height:i.height()-i[0].clientHeight};i.remove();i=f}F=i;this.autofocus=a.element.prop("autofocus");
a.element.prop("autofocus",!1);this.autofocus&&this.focus();this.nextSearchTerm=void 0},destroy:function(){var a=this.opts.element,b=a.data("select2");this.close();this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null);void 0!==b&&(b.container.remove(),b.dropdown.remove(),a.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?a.attr({tabindex:this.elementTabIndex}):a.removeAttr("tabindex"),a.show())},
optionToData:function(a){if(a.is("option"))return{id:a.prop("value"),text:a.text(),element:a.get(),css:a.attr("class"),disabled:a.prop("disabled"),locked:m(a.attr("locked"),"locked")||m(a.data("locked"),!0)};if(a.is("optgroup"))return{text:a.attr("label"),children:[],element:a.get(),css:a.attr("class")}},prepareOpts:function(a){var b,c,d,g=this;b=a.element;"select"===b.get(0).tagName.toLowerCase()&&(this.select=c=a.element);c&&e.each("id multiple ajax query createSearchChoice initSelection data tags".split(" "),
function(){if(this in a)throw Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.");});a=e.extend({},{populateResults:function(b,c,d){var f,t=this.opts.id;f=function(b,c,h){var l,j,m,k,o,u,q,b=a.sortResults(b,c,d);l=0;for(j=b.length;l<j;l=l+1){m=b[l];o=m.disabled===true;k=!o&&t(m)!==void 0;u=m.children&&m.children.length>0;q=e("<li></li>");q.addClass("select2-results-dept-"+h);q.addClass("select2-result");q.addClass(k?"select2-result-selectable":"select2-result-unselectable");
o&&q.addClass("select2-disabled");u&&q.addClass("select2-result-with-children");q.addClass(g.opts.formatResultCssClass(m));k=e(document.createElement("div"));k.addClass("select2-result-label");o=a.formatResult(m,k,d,g.opts.escapeMarkup);o!==void 0&&k.html(o);q.append(k);if(u){u=e("<ul></ul>");u.addClass("select2-result-sub");f(m.children,u,h+1);q.append(u)}q.data("select2-data",m);c.append(q)}};f(c,b,0)}},e.fn.select2.defaults,a);"function"!==typeof a.id&&(d=a.id,a.id=function(a){return a[d]});if(e.isArray(a.element.data("select2Tags"))){if("tags"in
a)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+a.element.attr("id");a.tags=a.element.data("select2Tags")}if(c)a.query=this.bind(function(a){var c={results:[],more:false},d=a.term,e,f,p;p=function(b,c){var e;if(b.is("option"))a.matcher(d,b.text(),b)&&c.push(g.optionToData(b));else if(b.is("optgroup")){e=g.optionToData(b);b.children().each2(function(a,b){p(b,e.children)});e.children.length>0&&c.push(e)}};e=b.children();if(this.getPlaceholder()!==void 0&&
e.length>0)(f=this.getPlaceholderOption())&&(e=e.not(f));e.each2(function(a,b){p(b,c.results)});a.callback(c)}),a.id=function(a){return a.id},a.formatResultCssClass=function(a){return a.css};else if(!("query"in a))if("ajax"in a){if((c=a.element.data("ajax-url"))&&0<c.length)a.ajax.url=c;a.query=K.call(a.element,a.ajax)}else if("data"in a)a.query=L(a.data);else if("tags"in a&&(a.query=M(a.tags),void 0===a.createSearchChoice&&(a.createSearchChoice=function(a){return{id:e.trim(a),text:e.trim(a)}}),void 0===
a.initSelection))a.initSelection=function(b,c){var d=[];e(B(b.val(),a.separator)).each(function(){var b={id:this,text:this},c=a.tags;e.isFunction(c)&&(c=c());e(c).each(function(){if(m(this.id,b.id)){b=this;return false}});d.push(b)});c(d)};if("function"!==typeof a.query)throw"query function not defined for Select2 "+a.element.attr("id");return a},monitorSource:function(){var a=this.opts.element,b,c;a.on("change.select2",this.bind(function(){!0!==this.opts.element.data("select2-change-triggered")&&
this.initSelection()}));b=this.bind(function(){var b=a.prop("disabled");void 0===b&&(b=!1);this.enable(!b);b=a.prop("readonly");void 0===b&&(b=!1);this.readonly(b);z(this.container,this.opts.element,this.opts.adaptContainerCssClass);this.container.addClass(o(this.opts.containerCssClass));z(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass);this.dropdown.addClass(o(this.opts.dropdownCssClass))});a.on("propertychange.select2",b);void 0===this.mutationCallback&&(this.mutationCallback=function(a){a.forEach(b)});
c=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;void 0!==c&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new c(this.mutationCallback),this.propertyObserver.observe(a.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(a){a=e.Event("select2-selecting",{val:this.id(a),object:a});this.opts.element.trigger(a);return!a.isDefaultPrevented()},triggerChange:function(a){a=a||{};a=e.extend({},a,{type:"change",
val:this.val()});this.opts.element.data("select2-change-triggered",!0);this.opts.element.trigger(a);this.opts.element.data("select2-change-triggered",!1);this.opts.element.click();this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var a=this._enabled&&!this._readonly;if(a===this.enabledInterface)return!1;this.container.toggleClass("select2-container-disabled",!a);this.close();this.enabledInterface=a;return!0},
enable:function(a){void 0===a&&(a=!0);this._enabled!==a&&(this._enabled=a,this.opts.element.prop("disabled",!a),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(a){void 0===a&&(a=!1);if(this._readonly===a)return!1;this._readonly=a;this.opts.element.prop("readonly",a);this.enableInterface();return!0},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var a=this.dropdown,b=this.container.offset(),c=this.container.outerHeight(!1),
d=this.container.outerWidth(!1),g=a.outerHeight(!1),h=e(window),f=h.width(),i=h.height(),n=h.scrollLeft()+f,j=h.scrollTop()+i,c=b.top+c,p=b.left,j=c+g<=j,m=b.top-g>=this.body().scrollTop(),k=a.outerWidth(!1),r=p+k<=n,s;a.hasClass("select2-drop-above")?(g=!0,!m&&j&&(s=!0,g=!1)):(g=!1,!j&&m&&(g=s=!0));s&&(a.hide(),b=this.container.offset(),c=this.container.outerHeight(!1),d=this.container.outerWidth(!1),a.outerHeight(!1),n=h.scrollLeft()+f,h.scrollTop(),c=b.top+c,p=b.left,k=a.outerWidth(!1),r=p+k<=
n,a.show());this.opts.dropdownAutoWidth?(h=e(".select2-results",a)[0],a.addClass("select2-drop-auto-width"),a.css("width",""),k=a.outerWidth(!1)+(h.scrollHeight===h.clientHeight?0:F.width),k>d?d=k:k=d,r=p+k<=n):this.container.removeClass("select2-drop-auto-width");"static"!==this.body().css("position")&&(n=this.body().offset(),c-=n.top,p-=n.left);r||(p=b.left+d-k);d={left:p,width:d};g?(d.bottom=i-b.top,d.top="auto",this.container.addClass("select2-drop-above"),a.addClass("select2-drop-above")):(d.top=
c,d.bottom="auto",this.container.removeClass("select2-drop-above"),a.removeClass("select2-drop-above"));d=e.extend(d,o(this.opts.dropdownCss));a.css(d)},shouldOpen:function(){var a;if(this.opened()||!1===this._enabled||!0===this._readonly)return!1;a=e.Event("select2-opening");this.opts.element.trigger(a);return!a.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen())return!1;
this.opening();return!0},opening:function(){var a=this.containerId,b="scroll."+a,c="resize."+a,d="orientationchange."+a;this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.clearDropdownAlignmentPreference();this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body());a=e("#select2-drop-mask");0==a.length&&(a=e(document.createElement("div")),a.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),a.hide(),a.appendTo(this.body()),
a.on("mousedown touchstart click",function(a){var b=e("#select2-drop");0<b.length&&(b=b.data("select2"),b.opts.selectOnBlur&&b.selectHighlighted({noFocus:!0}),b.close({focus:!0}),a.preventDefault(),a.stopPropagation())}));this.dropdown.prev()[0]!==a[0]&&this.dropdown.before(a);e("#select2-drop").removeAttr("id");this.dropdown.attr("id","select2-drop");a.show();this.positionDropdown();this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");var g=this;this.container.parents().add(window).each(function(){e(this).on(c+
" "+b+" "+d,function(){g.positionDropdown()})})},close:function(){if(this.opened()){var a=this.containerId,b="scroll."+a,c="resize."+a,d="orientationchange."+a;this.container.parents().add(window).each(function(){e(this).off(b).off(c).off(d)});this.clearDropdownAlignmentPreference();e("#select2-drop-mask").hide();this.dropdown.removeAttr("id");this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.search.removeClass("select2-active");
this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(a){this.open();this.search.val(a);this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return o(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var a=this.results,b,c,d,g;c=this.highlight();0>c||(0==c?a.scrollTop(0):(b=this.findHighlightableChoices().find(".select2-result-label"),d=e(b[c]),g=d.offset().top+d.outerHeight(!0),c===b.length-1&&(b=a.find("li.select2-more-results"),
0<b.length&&(g=b.offset().top+b.outerHeight(!0))),b=a.offset().top+a.outerHeight(!0),g>b&&a.scrollTop(a.scrollTop()+(g-b)),g=d.offset().top-a.offset().top,0>g&&"none"!=d.css("display")&&a.scrollTop(a.scrollTop()+g)))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(a){for(var b=this.findHighlightableChoices(),c=this.highlight();-1<c&&c<b.length;){var c=c+a,d=e(b[c]);if(d.hasClass("select2-result-selectable")&&
!d.hasClass("select2-disabled")&&!d.hasClass("select2-selected")){this.highlight(c);break}}},highlight:function(a){var b=this.findHighlightableChoices();if(0===arguments.length)return k(b.filter(".select2-highlighted")[0],b.get());a>=b.length&&(a=b.length-1);0>a&&(a=0);this.removeHighlight();b=e(b[a]);b.addClass("select2-highlighted");this.ensureHighlightVisible();(b=b.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(b),choice:b})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},
countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(a){a=e(a.target).closest(".select2-result-selectable");if(0<a.length&&!a.is(".select2-highlighted")){var b=this.findHighlightableChoices();this.highlight(b.index(a))}else 0==a.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var a=this.results,b=a.find("li.select2-more-results"),c,d=this.resultsPage+1,e=this,h=this.search.val(),f=this.context;0!==b.length&&(c=b.offset().top-a.offset().top-
a.height(),c<=this.opts.loadMorePadding&&(b.addClass("select2-active"),this.opts.query({element:this.opts.element,term:h,page:d,context:f,matcher:this.opts.matcher,callback:this.bind(function(c){e.opened()&&(e.opts.populateResults.call(this,a,c.results,{term:h,page:d,context:f}),e.postprocessResults(c,!1,!1),!0===c.more?(b.detach().appendTo(a).text(e.opts.formatLoadMore(d+1)),window.setTimeout(function(){e.loadMoreIfNeeded()},10)):b.remove(),e.positionDropdown(),e.resultsPage=d,e.context=c.context,
this.opts.element.trigger({type:"select2-loaded",items:c}))})})))},tokenize:function(){},updateResults:function(a){function b(){d.removeClass("select2-active");i.positionDropdown()}function c(a){g.html(a);b()}var d=this.search,g=this.results,h=this.opts,f,i=this;f=d.val();var n=e.data(this.container,"select2-last-term"),j;if(!(!0!==a&&n&&m(f,n))&&(e.data(this.container,"select2-last-term",f),!(!0!==a&&(!1===this.showSearchInput||!this.opened())))){j=++this.queryCount;n=this.getMaximumSelectionSize();
if(1<=n&&(f=this.data(),e.isArray(f)&&f.length>=n&&r(h.formatSelectionTooBig,"formatSelectionTooBig"))){c("<li class='select2-selection-limit'>"+h.formatSelectionTooBig(n)+"</li>");return}d.val().length<h.minimumInputLength?(r(h.formatInputTooShort,"formatInputTooShort")?c("<li class='select2-no-results'>"+h.formatInputTooShort(d.val(),h.minimumInputLength)+"</li>"):c(""),a&&this.showSearch&&this.showSearch(!0)):h.maximumInputLength&&d.val().length>h.maximumInputLength?r(h.formatInputTooLong,"formatInputTooLong")?
c("<li class='select2-no-results'>"+h.formatInputTooLong(d.val(),h.maximumInputLength)+"</li>"):c(""):(h.formatSearching&&0===this.findHighlightableChoices().length&&c("<li class='select2-searching'>"+h.formatSearching()+"</li>"),d.addClass("select2-active"),this.removeHighlight(),f=this.tokenize(),void 0!=f&&null!=f&&d.val(f),this.resultsPage=1,h.query({element:h.element,term:d.val(),page:this.resultsPage,context:null,matcher:h.matcher,callback:this.bind(function(f){var l;j==this.queryCount&&(this.opened()?
(this.context=void 0===f.context?null:f.context,this.opts.createSearchChoice&&""!==d.val()&&(l=this.opts.createSearchChoice.call(i,d.val(),f.results),void 0!==l&&null!==l&&void 0!==i.id(l)&&null!==i.id(l)&&0===e(f.results).filter(function(){return m(i.id(this),i.id(l))}).length&&f.results.unshift(l)),0===f.results.length&&r(h.formatNoMatches,"formatNoMatches"))?c("<li class='select2-no-results'>"+h.formatNoMatches(d.val())+"</li>"):(g.empty(),i.opts.populateResults.call(this,g,f.results,{term:d.val(),
page:this.resultsPage,context:null}),!0===f.more&&r(h.formatLoadMore,"formatLoadMore")&&(g.append("<li class='select2-more-results'>"+i.opts.escapeMarkup(h.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){i.loadMoreIfNeeded()},10)),this.postprocessResults(f,a),b(),this.opts.element.trigger({type:"select2-loaded",items:f})):this.search.removeClass("select2-active"))})}))}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0});
this.close();this.container.removeClass("select2-container-active");this.search[0]===document.activeElement&&this.search.blur();this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){var a=this.search;a[0]!==document.activeElement&&window.setTimeout(function(){var b=a[0],c=a.val().length;a.focus();a.is(":visible")&&b===document.activeElement&&(b.setSelectionRange?b.setSelectionRange(c,c):b.createTextRange&&(b=b.createTextRange(),
b.collapse(!1),b.select()))},0)},selectHighlighted:function(a){var b=this.highlight(),c=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");c?(this.highlight(b),this.onSelect(c,a)):a&&a.noFocus&&this.close()},getPlaceholder:function(){var a;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||(void 0!==(a=this.getPlaceholderOption())?a.text():void 0)},getPlaceholderOption:function(){if(this.select){var a=
this.select.children("option").first();if(void 0!==this.opts.placeholderOption)return"first"===this.opts.placeholderOption&&a||"function"===typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===a.text()&&""===a.val())return a}},initContainerWidth:function(){var a=function(){var a,c,d,g;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||
"resolve"===this.opts.width){a=this.opts.element.attr("style");if(void 0!==a){a=a.split(";");d=0;for(g=a.length;d<g;d+=1)if(c=a[d].replace(/\s/g,""),c=c.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==c&&1<=c.length)return c[1]}return"resolve"===this.opts.width?(a=this.opts.element.css("width"),0<a.indexOf("%")?a:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);
null!==a&&this.container.css("width",a)}});D=C(s,{createContainer:function(){return e(document.createElement("div")).attr({"class":"select2-container"}).html("<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>   <span class='select2-arrow'><b></b></span></a><input class='select2-focusser select2-offscreen' type='text'/><div class='select2-drop select2-display-none'>   <div class='select2-search'>       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>   </div>   <ul class='select2-results'>   </ul></div>")},
enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var a,b;0<=this.opts.minimumResultsForSearch&&this.showSearch(!0);this.parent.opening.apply(this,arguments);!1!==this.showSearchInput&&this.search.val(this.focusser.val());this.search.focus();a=this.search.get(0);a.createTextRange?(a=a.createTextRange(),a.collapse(!1),a.select()):a.setSelectionRange&&(b=this.search.val().length,a.setSelectionRange(b,
b));""===this.search.val()&&void 0!=this.nextSearchTerm&&(this.search.val(this.nextSearchTerm),this.search.select());this.focusser.prop("disabled",!0).val("");this.updateResults(!0);this.opts.element.trigger(e.Event("select2-open"))},close:function(a){this.opened()&&(this.parent.close.apply(this,arguments),a=a||{focus:!0},this.focusser.removeAttr("disabled"),a.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},
cancel:function(){this.parent.cancel.apply(this,arguments);this.focusser.removeAttr("disabled");this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var a,b=this.container,c=this.dropdown;0>this.opts.minimumResultsForSearch?this.showSearch(!1):this.showSearch(!0);this.selection=a=b.find(".select2-choice");this.focusser=b.find(".select2-focusser");this.focusser.attr("id",
"s2id_autogen"+A());e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id"));this.focusser.attr("tabindex",this.elementTabIndex);this.search.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled())if(a.which===f.PAGE_UP||a.which===f.PAGE_DOWN)j(a);else switch(a.which){case f.UP:case f.DOWN:this.moveHighlight(a.which===f.UP?-1:1);j(a);break;case f.ENTER:this.selectHighlighted();j(a);break;case f.TAB:this.selectHighlighted({noFocus:!0});break;case f.ESC:this.cancel(a),
j(a)}}));this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)}));this.focusser.on("keydown",this.bind(function(a){if(this.isInterfaceEnabled()&&!(a.which===f.TAB||f.isControl(a)||f.isFunctionKey(a)||a.which===f.ESC))if(!1===this.opts.openOnEnter&&a.which===f.ENTER)j(a);else if(a.which==f.DOWN||a.which==f.UP||a.which==f.ENTER&&this.opts.openOnEnter)!a.altKey&&(!a.ctrlKey&&!a.shiftKey&&!a.metaKey)&&(this.open(),
j(a));else if(a.which==f.DELETE||a.which==f.BACKSPACE)this.opts.allowClear&&this.clear(),j(a)}));G(this.focusser);this.focusser.on("keyup-change input",this.bind(function(a){0<=this.opts.minimumResultsForSearch&&(a.stopPropagation(),this.opened()||this.open())}));a.on("mousedown","abbr",this.bind(function(a){this.isInterfaceEnabled()&&(this.clear(),a.preventDefault(),a.stopImmediatePropagation(),this.close(),this.selection.focus())}));a.on("mousedown",this.bind(function(a){this.container.hasClass("select2-container-active")||
this.opts.element.trigger(e.Event("select2-focus"));this.opened()?this.close():this.isInterfaceEnabled()&&this.open();j(a)}));c.on("mousedown",this.bind(function(){this.search.focus()}));a.on("focus",this.bind(function(a){j(a)}));this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus"));this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),
this.opts.element.trigger(e.Event("select2-blur")))}));this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus"));this.container.addClass("select2-container-active")}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.setPlaceholder()},clear:function(a){var b=this.selection.data("select2-data");if(b){var c=e.Event("select2-clearing");this.opts.element.trigger(c);c.isDefaultPrevented()||
(c=this.getPlaceholderOption(),this.opts.element.val(c?c.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==a&&(this.opts.element.trigger({type:"select2-removed",val:this.id(b),choice:b}),this.triggerChange({removed:b})))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var a=this;this.opts.initSelection.call(null,this.opts.element,function(b){void 0!==
b&&null!==b&&(a.updateSelection(b),a.close(),a.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var a;return!this.getPlaceholder()?!1:void 0!==(a=this.getPlaceholderOption())&&a.prop("selected")||""===this.opts.element.val()||void 0===this.opts.element.val()||null===this.opts.element.val()},prepareOpts:function(){var a=this.parent.prepareOpts.apply(this,arguments),b=this;"select"===a.element.get(0).tagName.toLowerCase()?a.initSelection=function(a,d){var e=a.find("option").filter(function(){return this.selected});
d(b.optionToData(e))}:"data"in a&&(a.initSelection=a.initSelection||function(b,d){var g=b.val(),f=null;a.query({matcher:function(b,c,d){(b=m(g,a.id(d)))&&(f=d);return b},callback:!e.isFunction(d)?e.noop:function(){d(f)}})});return a},getPlaceholder:function(){return this.select&&void 0===this.getPlaceholderOption()?void 0:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var a=this.getPlaceholder();this.isPlaceholderOptionSelected()&&void 0!==a&&!(this.select&&void 0===this.getPlaceholderOption())&&
(this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(a)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear"))},postprocessResults:function(a,b,c){var d=0,e=this;this.findHighlightableChoices().each2(function(a,b){if(m(e.id(b.data("select2-data")),e.opts.element.val()))return d=a,!1});!1!==c&&(!0===b&&0<=d?this.highlight(d):this.highlight(0));!0===b&&(b=this.opts.minimumResultsForSearch,0<=b&&this.showSearch(N(a.results)>=b))},showSearch:function(a){this.showSearchInput!==
a&&(this.showSearchInput=a,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!a),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!a),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",a))},onSelect:function(a,b){if(this.triggerSelect(a)){var c=this.opts.element.val(),d=this.data();this.opts.element.val(this.id(a));this.updateSelection(a);this.opts.element.trigger({type:"select2-selected",val:this.id(a),choice:a});this.nextSearchTerm=
this.opts.nextSearchTerm(a,this.search.val());this.close();(!b||!b.noFocus)&&this.focusser.focus();m(c,this.id(a))||this.triggerChange({added:a,removed:d})}},updateSelection:function(a){var b=this.selection.find(".select2-chosen"),c;this.selection.data("select2-data",a);b.empty();null!==a&&(c=this.opts.formatSelection(a,b,this.opts.escapeMarkup));void 0!==c&&b.append(c);a=this.opts.formatSelectionCssClass(a,b);void 0!==a&&b.addClass(a);this.selection.removeClass("select2-default");this.opts.allowClear&&
void 0!==this.getPlaceholder()&&this.container.addClass("select2-allowclear")},val:function(){var a,b=!1,c=null,d=this,e=this.data();if(0===arguments.length)return this.opts.element.val();a=arguments[0];1<arguments.length&&(b=arguments[1]);if(this.select)this.select.val(a).find("option").filter(function(){return this.selected}).each2(function(a,b){c=d.optionToData(b);return!1}),this.updateSelection(c),this.setPlaceholder(),b&&this.triggerChange({added:c,removed:e});else if(!a&&0!==a)this.clear(b);
else{if(void 0===this.opts.initSelection)throw Error("cannot call val() if initSelection() is not defined");this.opts.element.val(a);this.opts.initSelection(this.opts.element,function(a){d.opts.element.val(!a?"":d.id(a));d.updateSelection(a);d.setPlaceholder();b&&d.triggerChange({added:a,removed:e})})}},clearSearch:function(){this.search.val("");this.focusser.val("")},data:function(a){var b,c=!1;if(0===arguments.length)return b=this.selection.data("select2-data"),void 0==b&&(b=null),b;1<arguments.length&&
(c=arguments[1]);a?(b=this.data(),this.opts.element.val(!a?"":this.id(a)),this.updateSelection(a),c&&this.triggerChange({added:a,removed:b})):this.clear(c)}});E=C(s,{createContainer:function(){return e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html("<ul class='select2-choices'>  <li class='select2-search-field'>    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>  </li></ul><div class='select2-drop select2-drop-multi select2-display-none'>   <ul class='select2-results'>   </ul></div>")},
prepareOpts:function(){var a=this.parent.prepareOpts.apply(this,arguments),b=this;"select"===a.element.get(0).tagName.toLowerCase()?a.initSelection=function(a,d){var e=[];a.find("option").filter(function(){return this.selected}).each2(function(a,c){e.push(b.optionToData(c))});d(e)}:"data"in a&&(a.initSelection=a.initSelection||function(b,d){var g=B(b.val(),a.separator),f=[];a.query({matcher:function(b,c,d){(b=e.grep(g,function(b){return m(b,a.id(d))}).length)&&f.push(d);return b},callback:!e.isFunction(d)?
e.noop:function(){for(var b=[],c=0;c<g.length;c++)for(var e=g[c],j=0;j<f.length;j++){var k=f[j];if(m(e,a.id(k))){b.push(k);f.splice(j,1);break}}d(b)}})});return a},selectChoice:function(a){var b=this.container.find(".select2-search-choice-focus");if(!b.length||!(a&&a[0]==b[0]))b.length&&this.opts.element.trigger("choice-deselected",b),b.removeClass("select2-search-choice-focus"),a&&a.length&&(this.close(),a.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",a))},destroy:function(){e("label[for='"+
this.search.attr("id")+"']").attr("for",this.opts.element.attr("id"));this.parent.destroy.apply(this,arguments)},initContainer:function(){var a;this.searchContainer=this.container.find(".select2-search-field");this.selection=a=this.container.find(".select2-choices");var b=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){b.search[0].focus();b.selectChoice(e(this))});this.search.attr("id","s2id_autogen"+A());e("label[for='"+this.opts.element.attr("id")+"']").attr("for",
this.search.attr("id"));this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())}));this.search.attr("tabindex",this.elementTabIndex);this.keydowns=0;this.search.on("keydown",this.bind(function(b){var d,g;if(this.isInterfaceEnabled()){++this.keydowns;var h=a.find(".select2-search-choice-focus"),l=h.prev(".select2-search-choice:not(.select2-locked)"),i=h.next(".select2-search-choice:not(.select2-locked)");d=this.search;d=e(d)[0];var k=0;g=0;"selectionStart"in
d?(k=d.selectionStart,g=d.selectionEnd-k):"selection"in document&&(d.focus(),k=document.selection.createRange(),g=document.selection.createRange().text.length,k.moveStart("character",-d.value.length),k=k.text.length-g);d=k;if(h.length&&(b.which==f.LEFT||b.which==f.RIGHT||b.which==f.BACKSPACE||b.which==f.DELETE||b.which==f.ENTER))g=h,b.which==f.LEFT&&l.length?g=l:b.which==f.RIGHT?g=i.length?i:null:b.which===f.BACKSPACE?(this.unselect(h.first()),this.search.width(10),g=l.length?l:i):b.which==f.DELETE?
(this.unselect(h.first()),this.search.width(10),g=i.length?i:null):b.which==f.ENTER&&(g=null),this.selectChoice(g),j(b),(!g||!g.length)&&this.open();else if((b.which===f.BACKSPACE&&1==this.keydowns||b.which==f.LEFT)&&0==d&&!g)this.selectChoice(a.find(".select2-search-choice:not(.select2-locked)").last()),j(b);else{this.selectChoice(null);if(this.opened())switch(b.which){case f.UP:case f.DOWN:this.moveHighlight(b.which===f.UP?-1:1);j(b);return;case f.ENTER:this.selectHighlighted();j(b);return;case f.TAB:this.selectHighlighted({noFocus:!0});
this.close();return;case f.ESC:this.cancel(b);j(b);return}b.which===f.TAB||f.isControl(b)||f.isFunctionKey(b)||b.which===f.BACKSPACE||b.which===f.ESC||b.which===f.ENTER&&(!1===this.opts.openOnEnter||b.altKey||b.ctrlKey||b.shiftKey||b.metaKey)||(this.open(),(b.which===f.PAGE_UP||b.which===f.PAGE_DOWN)&&j(b),b.which===f.ENTER&&j(b))}}}));this.search.on("keyup",this.bind(function(){this.keydowns=0;this.resizeSearch()}));this.search.on("blur",this.bind(function(a){this.container.removeClass("select2-container-active");
this.search.removeClass("select2-focused");this.selectChoice(null);this.opened()||this.clearSearch();a.stopImmediatePropagation();this.opts.element.trigger(e.Event("select2-blur"))}));this.container.on("click",".select2-choices",this.bind(function(a){this.isInterfaceEnabled()&&!(0<e(a.target).closest(".select2-search-choice").length)&&(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),
this.focusSearch(),a.preventDefault())}));this.container.on("focus",".select2-choices",this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())}));this.initContainerWidth();this.opts.element.addClass("select2-offscreen");this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,
arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch());if(this.select||""!==this.opts.element.val()){var a=this;this.opts.initSelection.call(null,this.opts.element,function(b){if(b!==void 0&&b!==null){a.updateSelection(b);a.close();a.clearSearch()}})}},clearSearch:function(){var a=this.getPlaceholder(),b=this.getMaxSearchWidth();void 0!==a&&
0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(a).addClass("select2-default"),this.search.width(0<b?b:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder();this.resizeSearch();this.parent.opening.apply(this,arguments);this.focusSearch();this.updateResults(!0);this.search.focus();this.opts.element.trigger(e.Event("select2-open"))},
close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(a){var b=[],c=[],d=this;e(a).each(function(){0>k(d.id(this),b)&&(b.push(d.id(this)),c.push(this))});a=c;this.selection.find(".select2-search-choice").remove();e(a).each(function(){d.addSelectedChoice(this)});d.postprocessResults()},tokenize:function(){var a=this.search.val(),a=this.opts.tokenizer.call(this,
a,this.data(),this.bind(this.onSelect),this.opts);null!=a&&void 0!=a&&(this.search.val(a),0<a.length&&this.open())},onSelect:function(a,b){this.triggerSelect(a)&&(this.addSelectedChoice(a),this.opts.element.trigger({type:"selected",val:this.id(a),choice:a}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(a,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):0<this.countSelectableResults()?(this.search.width(10),this.resizeSearch(),0<this.getMaximumSelectionSize()&&
this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:a}),(!b||!b.noFocus)&&this.focusSearch())},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(a){var b=!a.locked,c=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),d=e("<li class='select2-search-choice select2-locked'><div></div></li>"),
c=b?c:d,d=this.id(a),f=this.getVal(),h;h=this.opts.formatSelection(a,c.find("div"),this.opts.escapeMarkup);void 0!=h&&c.find("div").replaceWith("<div>"+h+"</div>");h=this.opts.formatSelectionCssClass(a,c.find("div"));void 0!=h&&c.addClass(h);if(b)c.find(".select2-search-choice-close").on("mousedown",j).on("click dblclick",this.bind(function(a){this.isInterfaceEnabled()&&(e(a.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(a.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");
this.close();this.focusSearch()})).dequeue(),j(a))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))}));c.data("select2-data",a);c.insertBefore(this.searchContainer);f.push(d);this.setVal(f)},unselect:function(a){var b=this.getVal(),c,d,a=a.closest(".select2-search-choice");if(0===a.length)throw"Invalid argument: "+a+". Must be .select2-search-choice";if(c=a.data("select2-data")){for(;0<=
(d=k(this.id(c),b));)b.splice(d,1),this.setVal(b),this.select&&this.postprocessResults();b=e.Event("select2-removing");b.val=this.id(c);b.choice=c;this.opts.element.trigger(b);b.isDefaultPrevented()||(a.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(c),choice:c}),this.triggerChange({removed:c}))}},postprocessResults:function(a,b,c){var d=this.getVal(),b=this.results.find(".select2-result"),e=this.results.find(".select2-result-with-children"),f=this;b.each2(function(a,b){var c=
f.id(b.data("select2-data"));0<=k(c,d)&&(b.addClass("select2-selected"),b.find(".select2-result-selectable").addClass("select2-selected"))});e.each2(function(a,b){!b.is(".select2-result-selectable")&&0===b.find(".select2-result-selectable:not(.select2-selected)").length&&b.addClass("select2-selected")});-1==this.highlight()&&!1!==c&&f.highlight(0);!this.opts.createSearchChoice&&0<!b.filter(".select2-result:not(.select2-selected)").length&&(!a||a&&!a.more&&0===this.results.find(".select2-no-results").length)&&
r(f.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+f.opts.formatNoMatches(f.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-(this.search.outerWidth(!1)-this.search.width())},resizeSearch:function(){var a,b,c,d,f=this.search.outerWidth(!1)-this.search.width();a=this.search;v||(c=a[0].currentStyle||window.getComputedStyle(a[0],null),v=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",
display:"none",fontSize:c.fontSize,fontFamily:c.fontFamily,fontStyle:c.fontStyle,fontWeight:c.fontWeight,letterSpacing:c.letterSpacing,textTransform:c.textTransform,whiteSpace:"nowrap"}),v.attr("class","select2-sizer"),e("body").append(v));v.text(a.val());a=v.width()+10;b=this.search.offset().left;c=this.selection.width();d=this.selection.offset().left;b=c-(b-d)-f;b<a&&(b=c-f);40>b&&(b=c-f);0>=b&&(b=a);this.search.width(Math.floor(b))},getVal:function(){var a;if(this.select)return a=this.select.val(),
null===a?[]:a;a=this.opts.element.val();return B(a,this.opts.separator)},setVal:function(a){var b;this.select?this.select.val(a):(b=[],e(a).each(function(){0>k(this,b)&&b.push(this)}),this.opts.element.val(0===b.length?"":b.join(this.opts.separator)))},buildChangeDetails:function(a,b){for(var b=b.slice(0),a=a.slice(0),c=0;c<b.length;c++)for(var d=0;d<a.length;d++)m(this.opts.id(b[c]),this.opts.id(a[d]))&&(b.splice(c,1),0<c&&c--,a.splice(d,1),d--);return{added:b,removed:a}},val:function(a,b){var c,
d=this;if(0===arguments.length)return this.getVal();c=this.data();c.length||(c=[]);if(!a&&0!==a)this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),b&&this.triggerChange({added:this.data(),removed:c});else{this.setVal(a);if(this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),b&&this.triggerChange(this.buildChangeDetails(c,this.data()));else{if(void 0===this.opts.initSelection)throw Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,
function(a){var f=e.map(a,d.id);d.setVal(f);d.updateSelection(a);d.clearSearch();b&&d.triggerChange(d.buildChangeDetails(c,d.data()))})}this.clearSearch()}},onSortStart:function(){if(this.select)throw Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var a=[],b=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();
this.selection.find(".select2-search-choice").each(function(){a.push(b.opts.id(e(this).data("select2-data")))});this.setVal(a);this.triggerChange()},data:function(a,b){var c=this,d,f;if(0===arguments.length)return this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();f=this.data();a||(a=[]);d=e.map(a,function(a){return c.opts.id(a)});this.setVal(d);this.updateSelection(a);this.clearSearch();b&&this.triggerChange(this.buildChangeDetails(f,this.data()))}});
e.fn.select2=function(){var a=Array.prototype.slice.call(arguments,0),b,c,d,f,h,j="val destroy opened open close focus isFocused container dropdown onSortStart onSortEnd enable disable readonly positionDropdown data search".split(" "),i=["opened","isFocused","container","dropdown"],m=["val","data"],o={search:"externalSearch"};this.each(function(){if(0===a.length||"object"===typeof a[0])b=0===a.length?{}:e.extend({},a[0]),b.element=e(this),"select"===b.element.get(0).tagName.toLowerCase()?h=b.element.prop("multiple"):
(h=b.multiple||!1,"tags"in b&&(b.multiple=h=!0)),c=h?new E:new D,c.init(b);else if("string"===typeof a[0]){if(0>k(a[0],j))throw"Unknown method: "+a[0];f=void 0;c=e(this).data("select2");if(void 0!==c&&(d=a[0],"container"===d?f=c.container:"dropdown"===d?f=c.dropdown:(o[d]&&(d=o[d]),f=c[d].apply(c,a.slice(1))),0<=k(a[0],i)||k(a[0],m)&&1==a.length))return!1}else throw"Invalid arguments to select2 plugin: "+a;});return void 0===f?this:f};e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,
openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(a,b,c,d){b=[];I(a.text,c.term,b,d);return b.join("")},formatSelection:function(a,b,c){return a?c(a.text):void 0},sortResults:function(a){return a},formatResultCssClass:function(){},formatSelectionCssClass:function(){},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(a,b){var c=b-a.length;return"Please enter "+c+" more character"+(1==c?"":"s")},formatInputTooLong:function(a,
b){var c=a.length-b;return"Please delete "+c+" character"+(1==c?"":"s")},formatSelectionTooBig:function(a){return"You can only select "+a+" item"+(1==a?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(a){return a.id},matcher:function(a,b){return 0<=w(""+b).toUpperCase().indexOf(w(""+a).toUpperCase())},separator:",",tokenSeparators:[],
tokenizer:P,escapeMarkup:J,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(a){return a},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){}};e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}};window.Select2={query:{ajax:K,local:L,tags:M},util:{debounce:H,markMatch:I,escapeMarkup:J,stripDiacritics:w},"class":{"abstract":s,single:D,multi:E}}}return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-select2', location = 'src/js/aui/select2.js' */
("undefined"===typeof window?global:window).__b5e2561853d062a8dbc4ddad8ea475b2=function(){"use strict";var b=__9be3f454a87dfa12e64a40a8f483ace3,d=b&&b.__esModule?b:{"default":b};__24a4022719d391909eb24beb4cb94950;var e=d.default.fn.select2;d.default.fn.auiSelect2=function(b){var c;if(d.default.isPlainObject(b)){var a=d.default.extend({},b);c=a.hasAvatar?" aui-has-avatar":"";a.containerCssClass="aui-select2-container"+c+(a.containerCssClass?" "+a.containerCssClass:"");a.dropdownCssClass="aui-select2-drop aui-dropdown2 aui-style-default"+
c+(a.dropdownCssClass?" "+a.dropdownCssClass:"");c=Array.prototype.slice.call(arguments,1);c.unshift(a)}else c=arguments.length?arguments:[{containerCssClass:"aui-select2-container",dropdownCssClass:"aui-select2-drop aui-dropdown2 aui-style-default"}];return e.apply(this,c)};return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/space-page-picker.js' */
define('confluence-ui-components/js/space-page-picker',
[
    'underscore',
    'ajs',
    'jquery'
],
/**
 * This bases on space-picker.js so it has the same limitation as space-picker.js.
 *
 * Supported options:
 *      contentType: undefined or ['space','page'] or ['space'] or ['page'].
 *      showRecentlyViewedSpaces: undefined or true or false. If it is undefined, it will become false if contentType is page; and true if contentType contains space.
 *      showRecentlyViewedPages: undefined or true or false. If it is undefined, it will become false if contentType is space; and true if contentType contains page.
 *      spaceCatKeys: array or string that separate by comma of space category keys.
 *      spaceKeys: array or string that separate by comma of space keys that separate by comma.
 *      pageIds: array or string that separate by comma of page ids that separate by comma.
 *      manualInit: run initSelection function automatically or not; default is false (undefined)
 *
 * How to initialize selected values?: There are two official ways and they can be merged.
 *  1. Use html input form value: create 3 input hidden tags <component's id>SpaceCat, <component's id>Space, <component's id>Page and set their value by keys/values that separate by comma.
 *  2. Use javascript option: set values for spaceCatKeys, spaceKeys, pageIds.
 *
 * How to get keys/ids from the component?:
 *  Look at <component's name>SpaceCat for space category keys; <component's name>Space for spaceKeys; <component's name>Page for pageIds with values separated by comma.
 *
 *
 * Note:
 * .The element must have an id.
 *
 * .An normal example to use this to create an space and/or page picker
 *
 *    var $spaceAndPage = $('#space-and-page');
 *    $spaceAndPage.auiSelect2(SpacePagePicker.build({
 *      orgElement: $spaceAndPage
 *    }));
 *
 * .Look at task report macro blueprint for other examples.
 *
 * .select2-input selector is set for this component to by pass placeholder.js processing.
 */

function (
    _,
    AJS,
    $
) {

    'use strict';
    /**
     * Mapping of space category keys to name.
     */
    var SPACE_CATEGORIES = {
        "conf_all": "All spaces",
        "conf_favorites": "Favourite spaces",
        "conf_global": "Site spaces",
        "conf_personal": "Personal spaces",
        "conf_current": "Current space"
    };

    var CONTENT_FUNCTIONS = {
        "currentContent()": "Current content"
    };

    var DEFAULTS = {
        data: null, /* object */
        suggestCategories: null /* array */
    };

    // It is used to trigger initSelection if there is no value.
    var TRIGGER_VALUE = "SPACE-PAGE-TRIGGER-VALUE";

    var isLivePagesOpenBetaEnabled = AJS.DarkFeatures.isEnabled("confluence_live_pages_open_beta_trait_opted_in")

    var select2Options = {
        placeholder: isLivePagesOpenBetaEnabled ? "Select a space, page or live doc"
            : "Select a space or page",
        multiple: true,
        formatInputTooShort: function () {
            return "Start typing to search";
        },
        formatResult: function (result, label, query) {
            if (result.children) {
                label.addClass('space-page-picker-result-category');
                return $.fn.select2.defaults.formatResult.apply(this, arguments);
            }
            else {
                if (result.id) {
                    // Add a tooltip to disclose full result text (as we truncate it to fit the drop down)
                    label.attr("title", result.text);
                    label.addClass('space-page-picker-result-label-with-icon');
                    var textObj = $('<span/>').addClass(result.className + ' ' + 'item-text').html($.fn.select2.defaults.formatResult.apply(this, arguments));
                    var subTextObj = (result.subText) ? $('<span/>').addClass('space-name').html(result.subText) : $('');
                    var itemObj = $('<span/>').attr(getIdentifyAttributeName(result.id), result.id).append(textObj).append(subTextObj);
                    var wrappedObj = $('<span/>').append(itemObj);
                    return wrappedObj;
                }
                else {
                    label.addClass(result.className);
                    return $.fn.select2.defaults.formatResult.apply(this, arguments);
                }
            }
        },
        formatSelection: function (result, container) {
            container.addClass("space-page-picker-selected-item");
            container.attr("title", result.text);
            var textObj = $('<span/>').attr(getIdentifyAttributeName(result.id), result.id)
                .addClass(result.className + ' ' + 'item-text').html($.fn.select2.defaults.formatSelection.apply(this, arguments));
            container.append(textObj);
        },
        escapeMarkup: function (markup) {
            // Do not escape by default, instead provide already escaped data to the component.
            // The data is always escape so we must not escape again.
            // quicknav escapes result data.
            // recentlyviewed, prototy, ui rest api do not escape result data.
            return markup;
        },
        formatResultCssClass: function (object) {
            //separator
            return (object.children || object.id) ? '' : 'select2-result-space-page-separator';
        },
        containerCssClass: 'space-page-picker-container',
        dropdownCssClass: 'space-page-picker-drop'
    };

    /**
     * Must set a value for value attribute so select2 involves this method. Support single value only
     *
     *
     * @param $sel2El
     * @param callback
     */
    var initSelection = function ($sel2El, callback) {
        var manualInit = $sel2El.data("select2").opts.manualInit;
        if (manualInit === true) {
            return;
        }
        setValue($sel2El.val(), $sel2El, callback);
    };

    function buildResultsFromResultsMap(typeAndKeys, resultMap, multiple) {
        var results = _.map(typeAndKeys, function (typeAndKey) {
            return resultMap[typeAndKey];
        });
        return (multiple) ? results : ((results.length > 0) ? results[0] : null);
    }

    /**
     * Default suggested space/page function resolves the recent spaces/pages and caches the result. Can also show space categories
     * on top if options are provided.
     *
     * @returns {Function}
     */
    var makeSuggestFn = function (opts) {
        // contains the cached spaces/pages
        var suggestedResults;

        // prepare suggested categories
        if (opts.suggestCategories) {
            var suggestCategories = {
                text: "Suggested categories",
                children: _.map(opts.suggestCategories, function (category) {
                    return buildCategoryData(category);
                })
            };
        }
        if (opts.suggestedContentFunctions) {
            var suggestedContentFunctions = _.map(opts.suggestedContentFunctions, function (category) {
                return buildContentFunctionData(category);
            });
        }

        return function (query) {
            if (suggestedResults) {
                query.callback(suggestedResults);
                return;
            }

            var searchers = [];
            suggestedResults = {results: []};
            if (showRecentlyViewedSpaces(opts)) {
                var spaceSearch = $.getJSON(AJS.contextPath() + "/rest/recentlyviewed/1.0/recent/spaces")
                    .done(function (spaces) {
                        var data = (suggestCategories) ? [suggestCategories] : [];
                        (spaces.length > 0) && data.push({
                            text: "Suggested spaces",
                            children: _.map(spaces, function (space) {
                                return buildSpaceData(space.key, _.escape(space.name), null, true);
                            })
                        });
                        (data.length > 0) && (suggestedResults.results = suggestedResults.results.concat(data));
                    })
                    .fail(function () {
                        AJS.debug("Couldn't fetch recent spaces");
                        var data = (suggestCategories) ? [suggestCategories] : [];
                        (data.length > 0) && (suggestedResults.results = suggestedResults.results.concat(data));
                    });
                searchers.push(spaceSearch);
            }

            if (showRecentlyViewedPages(opts)) {
                var pageSearch = $.getJSON(AJS.contextPath() + "/rest/recentlyviewed/1.0/recent/pages", {noTrashedContent: true})
                    .done(function (pages) {
                        if (pages.length > 0 || suggestedContentFunctions) {
                            var children = [];
                            if (suggestedContentFunctions) {
                                children = children.concat(suggestedContentFunctions);
                            }
                            if (pages.length > 0) {
                                children = children.concat(_.map(pages, function (page) {
                                    return buildPageData(page.id, _.escape(page.title), _.escape(page.space), 'content-type-page', true);
                                }));
                            }
                            suggestedResults.results.push({
                                text: "Suggested content",
                                children: children
                            });
                        }
                    })
                    .fail(function () {
                        AJS.debug("Couldn't fetch recent pages");
                    });
                searchers.push(pageSearch);
            }

            $.when.apply($, _.map(searchers, function (searcher) {
                var monitor = $.Deferred();
                searcher.always(function () {
                    monitor.resolve();
                });
                return monitor;
            })).done(function () {
                if (suggestedResults.results.length === 0) {
                    suggestedResults.results = [
                        {text: '', children: []}
                    ];
                }
                query.callback(suggestedResults);
            });
        };
    };

    /**
     * Use select2.ajax to retrieve results via contentnamesearch.
     *
     * TODO error handling. Only possible once select2 is upgraded to 3.4.1
     *
     * @returns {*}
     */
    var makeSearchFn = function (type) {
        var queryString = "";
        if (!type || type.length === 2 && type.indexOf('space') >= 0 && type.indexOf('page') >= 0) {
            queryString = "type=spacedesc&type=personalspacedesc&type=page";
        }
        else if (type.length === 1 && type[0] === 'space') {
            queryString = "type=spacedesc&type=personalspacedesc";
        }
        else if (type.length === 1 && type[0] === 'page') {
            queryString = "type=page";
        }
        else {
            return;
        }

        return window.Select2.query.ajax({
            url: AJS.contextPath() + "/rest/quicknav/1/search?" + queryString,
            data: function (term, page) {
                return {
                    query: term,
                    maxPerCategory: 25
                };
            },
            quietMillis: 250,
            results: function (data, page) {
                // The latest match contains searching information, not result.
                var matches = data.contentNameMatches;
                if (matches.length <= 1) {
                    // no search results
                    return { results: [] };
                }
                else {
                    var finalResults = [];
                    var buildContent = function (match) {
                        return buildContentItem(match.spaceKey, match.spaceName, match.id, match.name, match.className);
                    };
                    for (var i = 0; i < matches.length - 1; i++) {
                        var results = [];
                        for (var j = 0; j < matches[i].length; j++) {
                            var contentItem = buildContent(matches[i][j]);
                            if (contentItem) {
                                results.push(contentItem);
                            }
                        }
                        if (results.length > 0) {
                            finalResults = finalResults.concat(results);
                            finalResults.push({id: '', text: '', subText: '', className: '', disabled: true});
                        }
                    }
                    return {
                        results: [
                            {
                                text: "Search results",
                                children: finalResults
                            }
                        ]
                    };
                }
            }
        });
    };

    /**
     * Builds the query function that is passed to select2.
     *
     * @param opts
     * @returns {Function}
     */
    var makeQueryFn = function (opts) {
        var search = makeSearchFn(opts.contentType);
        var suggestSpaces = makeSuggestFn(opts);

        // Show suggestions until you typed at least 2 characters, then search.
        return function (query) {
            if (query.term.length < 2) {
                suggestSpaces(query);
            }
            else {
                search(query);
            }
        };
    };

    function getIdentifyAttributeName(id) {
        return (id.indexOf("page:") === 0) ? "data-item-id" : "data-item-key";
    }

    function buildSpaceData(key, text, className, found) {
        className = (className) ? className : ((key.indexOf("~") === 0) ? 'content-type-personalspacedesc' : 'content-type-spacedesc');
        return buildContentData('space', key, text, '', className, found);
    }

    function buildCategoryData(key) {
        var desc = SPACE_CATEGORIES[key];
        return buildContentData("space-cat", key, desc, '', 'content-type-space-category', desc);
    }

    function buildContentFunctionData(key) {
        var desc = CONTENT_FUNCTIONS[key];
        return buildContentData("content-function", key, desc, '', 'content-type-page', desc);
    }

    function buildPageData(id, text, subText, className, found) {
        return buildContentData('page', id, text, subText, className, found);
    }

    function buildContentData(contentType, keyOrId, text, subtext, className, found) {
        var idStr = concatId(contentType, keyOrId);
        text = (!text) ? keyOrId : text;
        className = (found) ? className : (className + ' content-not-found');
        return {id: idStr, text: text, subText: subtext, className: className, disabled: (found ? false : true) };
    }

    function buildCompoundSpaceCatKey(spaceCatKey) {
        return 'space-cat:' + spaceCatKey;
    }

    function buildCompoundContentFunctionKey(key) {
        return 'content-function:' + key;
    }

    function buildCompoundSpaceKey(spaceKey) {
        return 'space:' + spaceKey;
    }

    function buildCompoundPageKey(pageId) {
        return 'page:' + pageId;
    }

    /**
     * var classNameMap = {'space-cat': 'content-type-category', 'space': 'content-type-spacedesc', 'page': 'content-type-page'};
     * var contentTypeMap = {'content-type-category': 'space-cat', 'content-type-spacedesc': 'space', 'content-type-page': 'page'};
     *
     * @param spaceKey
     * @param spaceName
     * @param id
     * @param name
     * @param className
     * @returns {string}
     */
    function buildContentItem(spaceKey, spaceName, id, name, className) {
        // Don't have category here because it is gotten from another place.
        var result;
        if (className === 'content-type-spacedesc' || className === 'content-type-personalspacedesc') {
            result = buildSpaceData(spaceKey, spaceName, className, true);
        }
        else if (className === 'content-type-page') {
            result = buildPageData(id, name, spaceName, className, true);
        }
        return result;
    }

    function concatId() {
        // Using any char except a comma because select2 uses comma as default separator to separate items' ids.
        var args = Array.prototype.slice.apply(arguments);
        return args.join(":");
    }

    /**
     * Recently-viewed space will be shown if showRecentlyViewedSpaces is true or contentType contains space and showRecentlyViewedSpace is not explicit false.
     *
     *
     * @param opts
     * @returns {boolean}
     */
    function showRecentlyViewedSpaces(opts) {
        return ((!opts.contentType || opts.contentType.length === 0 || opts.contentType.indexOf('space') >= 0) && opts.showRecentlyViewedSpaces !== false);
    }

    /**
     * Recently-viewed page will be shown if showRecentlyViewedPages is true or contentType contains page and showRecentlyViewedPages is not explicit false.
     *
     *
     * @param opts
     * @returns {boolean}
     */
    function showRecentlyViewedPages(opts) {
        return ((!opts.contentType || opts.contentType.length === 0 || opts.contentType.indexOf('page') >= 0) && opts.showRecentlyViewedPages !== false);
    }

    function buildHiddenForSpaceCat($el, options) {
        var idAndName = createIdAndName("SpaceCat", $el, options.inputSpaceCatId, (options.inputSpaceCatName) ? options.inputSpaceCatName : options.inputSpaceCatId);
        return buildHiddenWithName($el, idAndName.id, idAndName.name);
    }

    function buildHiddenForContentFunction($el, options) {
        // HACK - this and the rest of the hidden-field logic will be removed in CONFDEV-40396. dT
        // This id is only set because no plugin is actually passing in inputContentFunctionId and shouldn't have to.
        var id = options.inputContentFunctionId || 'legacy-macro-param-content-funcs';
        var idAndName = createIdAndName("ContentFunction", $el, id, options.inputContentFunctionName || id);
        return buildHiddenWithName($el, idAndName.id, idAndName.name);
    }

    function buildHiddenForSpace($el, options) {
        var idAndName = createIdAndName('Space', $el, options.inputSpaceId, (options.inputSpaceName) ? options.inputSpaceName : options.inputSpaceId);
        return buildHiddenWithName($el, idAndName.id, idAndName.name);
    }

    function buildHiddenForPage($el, options) {
        var idAndName = createIdAndName('Page', $el, options.inputPageId, (options.inputPageName) ? options.inputPageName : options.inputPageId);
        return buildHiddenWithName($el, idAndName.id, idAndName.name);
    }

    function createIdAndName(suffix, $el, id, name) {
        var orgId;
        if (!id) {
            orgId = $el.attr("id");
            if (!orgId) {
                return null;
            }
            id = orgId + suffix;
        }

        if (!name) {
            var orgName = $el.attr("name") || orgId;
            name = orgName + suffix;
        }

        return {
            id: id,
            name: name
        };
    }

    function buildHiddenWithName($el, id, name) {
        var $hidden = $('#' + id);
        if ($hidden.length === 0) {
            $hidden = $(Confluence.UI.Components.templates.hiddenField({id: id, name: name}));
            $el.after($hidden);
        }
        return $hidden;
    }

    function populateEntriesWithPrefix($el, value, prefix) {
        if (!$el) {
            return;
        }

        var items = _.filter(value, function (item) {
            return item.indexOf(prefix) === 0;
        });

        items = _.map(items, function (item) {
            return item.substring(prefix.length, item.length);
        });
        $el.val(items.join(","));
    }

    /**
     *
     * Merge specific values from javascript and html input fields to the component.
     *
     *
     * @param $el
     * @param prefix
     * @param jsKeyOrIdValue
     * @param htmlKeyOrIdValue
     */
    function mergeSeparateValuesToElement($el, prefix, jsKeyOrIdValue, htmlKeyOrIdValue) {
        jsKeyOrIdValue = (jsKeyOrIdValue) ? (_.isArray(jsKeyOrIdValue) ? jsKeyOrIdValue : jsKeyOrIdValue.split(',')) : [];
        htmlKeyOrIdValue = (htmlKeyOrIdValue) ? htmlKeyOrIdValue.split(",") : [];

        var keyOrIdValues = _.union(jsKeyOrIdValue, htmlKeyOrIdValue);
        var typeAndKeys = _.map(keyOrIdValues, function (keyOrId) {
            return prefix + keyOrId;
        });
        var objectValue = $el.val();
        var objectTypeAndKeys = objectValue ? objectValue.split(',') : [];

        var finalTypeAndKeys = _.union(objectTypeAndKeys, typeAndKeys);
        if (finalTypeAndKeys.length > 0) {
            $el.val(finalTypeAndKeys.join(','));
        }
    }

    function build(opts) {
        var options = _.extend({}, DEFAULTS, select2Options, opts);
        if (!opts.data) {
            options = _.extend({}, {
                initSelection: initSelection,
                query: makeQueryFn(options)
            }, options);
        }

        var $orgElement = $(options.orgElement);
        if (!$orgElement || $orgElement.length !== 1) {
            return options;
        }

        // Always call initSelection if it is not manualInit
        if (!$orgElement.val() && !options.manualInit) {
            $orgElement.val(TRIGGER_VALUE);
        }

        // To skip placeholder process in placeholder.js
        $orgElement.addClass("select2-input");

        return options;
    }

    /**
     *
     * $sel2El will be cleared and its value will be replaced by initValue as long as values from javascript, child hidden fields.
     * Which automatic init, initValue is $sel2El.val()
     *
     *
     * @param initValue
     * @param $sel2El
     * @param callback
     */
    function setValue(initValue, $sel2El, callback) {
        var options = $sel2El.data("select2").opts;
        var placeholder = options.placeholder || $sel2El.data("placeholder");

        // Add extra hidden fields
        // The code must be here because the request information may be not ready at the build time, ex: id, name...
        var inputSpaceCat = buildHiddenForSpaceCat($sel2El, options);
        var inputContentFunction = buildHiddenForContentFunction($sel2El, options);
        var inputSpace = buildHiddenForSpace($sel2El, options);
        var inputPage = buildHiddenForPage($sel2El, options);

        $sel2El.on("change", function (e) {
            populateEntriesWithPrefix(inputSpaceCat, e.val, "space-cat:");
            populateEntriesWithPrefix(inputContentFunction, e.val, "content-function:");
            populateEntriesWithPrefix(inputSpace, e.val, "space:");
            populateEntriesWithPrefix(inputPage, e.val, "page:");
        });

        // Clean element's value attribute to avoid duplication if using automatic init (<> manualInit).
        $sel2El.val("");

        var multiple = ($sel2El["0"].tagName === "SELECT") ? ($sel2El.context.multiple) : (options.multiple);
        var gettingSpaceCatKeys = [];
        var gettingSpaceKeys = [];
        var gettingContentFunctionKeys = [];
        var gettingPageIds = [];
        var resultMap = {};
        var typeAndKeys = (initValue) ? initValue.split(",") : [];

        // Fix IE 8 and 9 issue that uses value field for placeholder
        // Also to remove trigger value if there is no default value.
        typeAndKeys = _.filter(typeAndKeys, function (typeAndKey) {
            var typeAndKeyPair = typeAndKey.split(":");
            if (typeAndKeyPair.length === 2) {
                return true;
            }
            // Should never happen
            else if (typeAndKeyPair.length < 0 || typeAndKeyPair.length >= 3 || (typeAndKeyPair.length === 1 && (typeAndKeyPair[0] !== TRIGGER_VALUE && typeAndKeyPair[0] !== placeholder))) {
                AJS.debug("Error value: " + typeAndKeyPair);
            }
        });

        // after removing all unwanted values
        initValue = typeAndKeys.join(",");
        $sel2El.val(initValue);

        mergeSeparateValuesToElement($sel2El, 'space-cat:', options.spaceCatKeys, (inputSpaceCat) ? inputSpaceCat.val() : "");
        mergeSeparateValuesToElement($sel2El, 'content-function:', options.pageCatKeys, (inputContentFunction) ? inputContentFunction.val() : "");
        mergeSeparateValuesToElement($sel2El, 'space:', options.spaceKeys, (inputSpace) ? inputSpace.val() : "");
        mergeSeparateValuesToElement($sel2El, 'page:', options.pageIds, (inputPage) ? inputPage.val() : "");

        // after merge all values
        initValue = $sel2El.val();

        typeAndKeys = (initValue) ? initValue.split(",") : [];
        populateEntriesWithPrefix(inputSpaceCat, typeAndKeys, "space-cat:");
        populateEntriesWithPrefix(inputContentFunction, typeAndKeys, "content-function:");
        populateEntriesWithPrefix(inputSpace, typeAndKeys, "space:");
        populateEntriesWithPrefix(inputPage, typeAndKeys, "page:");

        if (typeAndKeys.length === 0) {
            return;
        }

        _.each(typeAndKeys, function (typeAndKey, index) {
            var typeAndKeyPair = typeAndKey.split(":");
            if (typeAndKeyPair.length === 2) {
                var type = typeAndKeyPair[0];
                var key = typeAndKeyPair[1];
                if (type === 'space-cat') {
                    gettingSpaceCatKeys.push(key);
                }
                else if (type === 'content-function') {
                    gettingContentFunctionKeys.push(key);
                }
                else if (type === 'space') {
                    gettingSpaceKeys.push(key);
                }
                else if (type === 'page') {
                    gettingPageIds.push(key);
                }
            }
        });

        _.each(gettingSpaceCatKeys, function (spaceCatKey) {
            resultMap[buildCompoundSpaceCatKey(spaceCatKey)] = buildCategoryData(spaceCatKey);
        });

        _.each(gettingContentFunctionKeys, function (pageCatKey) {
            resultMap[buildCompoundContentFunctionKey(pageCatKey)] = buildContentFunctionData(pageCatKey);
        });

        var searchers = [];
        if (gettingSpaceKeys.length > 0) {
            var searchSpace = $.getJSON(AJS.contextPath() + "/rest/prototype/1/space", {spaceKey: gettingSpaceKeys}).done(function (results) {
                var foundKeys = [];
                _.each(results.space, function (space) {
                    resultMap[buildCompoundSpaceKey(space.key)] = buildSpaceData(space.key, _.escape(space.name), null, true);
                    foundKeys.push(space.key);
                });

                var noFoundKeys = _.difference(gettingSpaceKeys, foundKeys);
                _.each(noFoundKeys, function (spaceKey) {
                    resultMap[buildCompoundSpaceKey(spaceKey)] = buildSpaceData(spaceKey, spaceKey, null, false);
                });
            }).fail(function () {
                AJS.debug("Couldn't resolve spaceKeys:", gettingSpaceKeys);
                _.each(gettingSpaceKeys, function (spaceKey) {
                    resultMap[buildCompoundSpaceKey(spaceKey)] = buildSpaceData(spaceKey, spaceKey, null, false);
                });
            });
            searchers.push(searchSpace);
        }

        // there is no rest api to get me a list of page, going to call the existing api for each page
        _.each(gettingPageIds, function (pageId) {
            var searchPage = $.getJSON(AJS.contextPath() + "/rest/api/content/" + pageId, {expand: "space"}).done(function (page) {
                resultMap[buildCompoundPageKey(page.id)] = buildPageData(page.id, _.escape(page.title), _.escape(page.space.name), 'content-type-page', true);
            }).fail(function () {
                AJS.debug("Couldn't resolve pageId:", pageId);
                resultMap[buildCompoundPageKey(pageId)] =
                    buildPageData(pageId, pageId, "", 'content-type-page', false);
            });
            searchers.push(searchPage);
        });

        // wait for all requests to finish, whether they passed/failed and then populate the field value
        $.when.apply($, _.map(searchers, function (searcher) {
            var monitor = new $.Deferred();
            searcher.always(function () {
                monitor.resolve();
            });
            return monitor.promise();
        })).done(function () {
            callback(buildResultsFromResultsMap(typeAndKeys, resultMap, multiple));
        });
    }

    return {
        build: build,

        setValue: function (initValue, $sel2El) {
            setValue(initValue, $sel2El, function (data) {
                $sel2El.auiSelect2("data", data);
            });
        }
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/js/internal/space-page-picker-legacy.js' */
/**
 * Shim to continue providing newly-AMD-fied space picker as a global var.
 */
window.Confluence.UI.Components.SpacePagePicker = require('confluence-ui-components/js/space-page-picker');

// Warn developers that still use the shim.
AJS.deprecate.prop(window.Confluence.UI.Components.SpacePagePicker, 'build', {
    sinceVersion: '1.4.34',
    extraInfo: "Use require('confluence-ui-components/js/space-page-picker')"
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-page-picker', location = '/soy/space-page-picker.soy' */
// This file was automatically generated from space-page-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.templates == 'undefined') { Confluence.UI.Components.templates = {}; }


Confluence.UI.Components.templates.hiddenField = function(opt_data, opt_ignored) {
  return '<input type="hidden" id="' + soy.$$escapeHtml(opt_data.id) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" />';
};
if (goog.DEBUG) {
  Confluence.UI.Components.templates.hiddenField.soyTemplateName = 'Confluence.UI.Components.templates.hiddenField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
define('confluence-ui-components/js/page-picker',
[
    'ajs',
    'confluence-ui-components/js/space-page-picker'
],
/**
 * Look at space-page-picker.js for any details.
 */
function (
    AJS,
    SpacePagePicker
) {
    'use strict';

    var isLivePagesOpenBetaEnabled = AJS.DarkFeatures.isEnabled("confluence_live_pages_open_beta_trait_opted_in")

    return {
        build: function (opts) {
            opts.placeholder = isLivePagesOpenBetaEnabled ? "Select a page or live doc"
                : "Select a page";
            opts.contentType = ['page'];
            opts.showRecentlyViewedSpaces = false;
            opts.spaceCatKeys = [];
            opts.spaceKeys = [];

            return SpacePagePicker.build(opts);
        }
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/internal/page-picker-legacy.js' */
/**
 * Shim to continue providing newly-AMD-fied space picker as a global var.
 */
window.Confluence.UI.Components.PagePicker = require('confluence-ui-components/js/page-picker');

// Warn developers that still use the shim.
AJS.deprecate.prop(window.Confluence.UI.Components.PagePicker, 'build', {
    sinceVersion: '1.4.34',
    extraInfo: "Use require('confluence-ui-components/js/page-picker')"
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker.js' */
define('confluence-ui-components/js/label-picker',
[
    'ajs',
    'confluence/legacy',
    'jquery',
    'underscore'
],
/**
 * A generic, reusable label picker component. The component itself is just select2 (http://ivaynberg.github.io/select2/)
 * with a custom placeholder/formatting/createSearchChoice properties. You can customize the component in the same way as you could
 * customize a standard select2.
 *
 * The default behaviour searches across all labels in the site. You can restrict it by passing in a data object to ajaxOpts.
 *
 * Usage:
 *
 * Minimum case: $("#label-search").auiSelect2(Confluence.UI.Components.LabelPicker.build());
 *
 * If you want to customize the behaviour of the picker or the underlying select2, pass in an opts object
 * that has the additional options for select2.
 *
 * $("#label-search").auiSelect2(Confluence.UI.Components.LabelPicker.build({
 *   placeholder: "my-placeholder"
 * }));
 *
 * If you want to pass extra options to the labels autocomplete endpoint query, use the queryOpts option
 *
 * $("#label-search").auiSelect2(Confluence.UI.Components.LabelPicker.build({
 *   queryOpts : {
 *     spaceKey : 'ABCD'
 *   }
 * }));
 *
 */
function (
    AJS,
    Confluence,
    $,
    _
) {
    'use strict';

    // Colon : is allowed
    var invalidCharactersRegex = /[;,\.\?&\[\(\)#\^\*@!<>\]]/g;

    function validateLabelName(labelName) {
        var uniqueInvalidCharacters = _.uniq(labelName.match(invalidCharactersRegex));
        return uniqueInvalidCharacters.join(' ');
    }

    function matchToLabel(contentNameMatch) {
        return {
            id : contentNameMatch.name,
            text : contentNameMatch.name
        };
    }

    // Sort selection order by label name
    function convertAndSortLabelMatches(matches) {
        if (!matches || !matches.length) {
            return null;
        }

        var labels = _.map(matches, matchToLabel);
        return _.sortBy(labels, function (label) {
            return label.text.toLowerCase();
        });
    }

    function processResponseData(data) {
        var matches = data.contentNameMatches;
        var suggestedLabels = convertAndSortLabelMatches(matches[0]);
        var otherLabels = convertAndSortLabelMatches(matches[1]);

        // NOTE: The autocompletelabel.action is currently only returning the "other" results array for performance
        // reasons, but when suggested labels are reinstated this component should support them.
        if (suggestedLabels && otherLabels) {
            return [
                {
                    text: "Suggested",
                    children: suggestedLabels
                },
                {
                    text: "Other",
                    children: otherLabels
                }
            ];
        }

        return suggestedLabels || otherLabels || [];
    }

    function buildAjaxDataFunction(ajaxQueryOpts) {
        return function(searchTerm) {
            return $.extend({
                query : searchTerm,
                // Don't search for suggested labels - causes performance issues.
                ignoreRelated: true,
                maxResults: 10
            }, ajaxQueryOpts);
        };
    }

    var select2Opts = {
        multiple : true,
        minimumInputLength : 1,
        maximumSelectionSize : 20,
        tokenSeparators: [' ', ','],
        formatInputTooShort : function(term, minLength) {
            return "Search and select by label name"
        },
        formatSelectionTooBig : function(maxSize) {
            return AJS.format("You can only input {0} labels", maxSize);
        },
        formatResult : function(result) {
            return Confluence.UI.Components.LabelPicker.templates.labelResult({
                label : {
                    labelName : result.text,
                    isNew : result.isNew
                }
            });
        },
        formatNoMatches : function(term) {
            var invalidCharacters = validateLabelName(term);
            if (invalidCharacters) {
                return Confluence.UI.Components.LabelPicker.templates.labelInvalid({
                    "inputValue" : term,
                    "invalidCharacters" : invalidCharacters
                });
            }

            return this.noMatches;
        },
        createSearchChoice : function(term) {
            if(!term) {
                return null;
            }

            // validate input value. If validated add into the select list
            var invalidCharacters = validateLabelName(term);
            if (invalidCharacters) {
                return null;
            }
            return {
                id : term,
                text : term,
                isNew : true
            };
        },
        ajax : {
            data : buildAjaxDataFunction(),
            dataType : "json",
            url : Confluence.getContextPath() + "/labels/autocompletelabel.action",
            results : function(data) {
                return {
                    results : processResponseData(data)
                };
            },
            quietMillis : 300
        },
        dropdownCssClass: 'labels-dropdown',
        containerCssClass: 'labels-autocomplete',

        // Required so that val() can be called on the select2 element. This simple implementation just uses the same
        // string for the id and text used for each value being set.
        initSelection: function (element, callback) {
            var labels = element.val().split(',');
            var data = _.map(labels, function (label) {
                return {id: label, text: label};
            });
            callback(data);
        }
    };

    /**
     * @param opts Options from the select2 API. They will override the defaults that are provided by the Label Picker. Include a queryOpts object to pass extra parameters to the ajax query.
     */
    function build(opts) {
        var extendedOpts = $.extend({}, select2Opts, opts);

        if (opts && opts.queryOpts) {
            extendedOpts.ajax.data = buildAjaxDataFunction(opts.queryOpts);
            delete extendedOpts.queryOpts;
        }

        if (!opts || !opts.noMatches) {
            /*
                 The text displayed when the search term is legit but no results are found.
                 We use a separate option to allow callers to override the displayed text, but the default is the
                 placeholder string.
             */
            extendedOpts.noMatches = extendedOpts.placeholder;
        }

        return extendedOpts;
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/js/label-picker-legacy.js' */
/**
 * Shim to continue providing newly-AMD-fied label picker as a global var.
 */
window.Confluence.UI.Components.LabelPicker = require('confluence-ui-components/js/label-picker');

// Warn developers that still use the shim (build is the only method on it).
AJS.deprecate.prop(window.Confluence.UI.Components.LabelPicker, 'build', {
    sinceVersion: '1.4.18',
    extraInfo: "Use require('confluence-ui-components/js/label-picker')"
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:label-picker', location = '/soy/label-picker.soy' */
// This file was automatically generated from label-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.LabelPicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.LabelPicker == 'undefined') { Confluence.UI.Components.LabelPicker = {}; }
if (typeof Confluence.UI.Components.LabelPicker.templates == 'undefined') { Confluence.UI.Components.LabelPicker.templates = {}; }


Confluence.UI.Components.LabelPicker.templates.labelResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - add a new label',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelResult.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelResult';
}


Confluence.UI.Components.LabelPicker.templates.labelInvalid = function(opt_data, opt_ignored) {
  var output = '';
  var inputValueHtml__soy9 = '<b>' + soy.$$escapeHtml(opt_data.inputValue) + '</b>';
  var invalidCharactersHtml__soy13 = '<b>' + soy.$$escapeHtml(opt_data.invalidCharacters) + '</b>';
  output += soy.$$filterNoAutoescape(AJS.format('{0} contains invalid characters {1}',inputValueHtml__soy9,invalidCharactersHtml__soy13));
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.LabelPicker.templates.labelInvalid.soyTemplateName = 'Confluence.UI.Components.LabelPicker.templates.labelInvalid';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define('confluence-ui-components/js/include-exclude-picker',
[
    'jquery',
    'underscore'
],
/**
 * A component which will generate select2 options which modify ajax behaviour to allow the user to search
 * for entries using the +/- notation in the field. E.g. label = -foo for label != foo
 */
function (
    $,
    _
) {

    var searchTermPrefix = '';

    function stripPrefix(searchTerm) {
        var firstChar = searchTerm.charAt(0);
        if (_.contains(['-'], firstChar)) {
            searchTermPrefix = firstChar;
            searchTerm = searchTerm.substring(1);
        } else {
            searchTermPrefix = '';
        }
        return searchTerm;
    }

    function reAddPrefix(result) {
        var newResult = $.extend({}, result);
        if (newResult.children) {
            newResult.children = _.map(newResult.children, reAddPrefix);
        } else {
            newResult.id = searchTermPrefix + newResult.id;
            newResult.text = searchTermPrefix + newResult.text;
        }
        return newResult;
    }

    function stripPrefixBeforeAjax(dataFn) {
        return function(searchTerm) {
            searchTerm = stripPrefix(searchTerm);
            return dataFn(searchTerm);
        };
    }

    function reAddPrefixAfterAjax(fn) {
        return function(data) {
            var result = fn ? fn(data) : data;

            if (searchTermPrefix) {
                result.results = _.map(result.results, reAddPrefix)
            }

            return result;
        }
    }

    function providePrefixAwareQueryFn(query) {
        return function(queryArgs) {
            return query(queryArgs, stripPrefix, reAddPrefix);
        }
    }

    function setStylingForNegatedSelections(result) {
        var firstChar = result.text.charAt(0);
        if (firstChar === "-") {
            return "select2-search-choice-subtle";
        }
        return;
    }

    /**
     * @param opts Options from the select2 API. They will override the defaults that are provided by this picker.
     */
    function build(opts) {
        // If we don't clone, we will end up modifying data and results functions in the incoming opts
        // which will result in these callbacks calling themselves for each new time the picker is built
        var newOpts = $.extend({
            formatSelectionCssClass: setStylingForNegatedSelections
        }, opts);
        if (newOpts.query) {
            newOpts.query = providePrefixAwareQueryFn(newOpts.query);
            return newOpts;
        } else {
            newOpts.ajax = $.extend({}, newOpts.ajax);
            newOpts.ajax.data = stripPrefixBeforeAjax(newOpts.ajax.data);
            newOpts.ajax.results = reAddPrefixAfterAjax(newOpts.ajax.results);
            return newOpts;
        }
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:avatar-with-name', location = '/soy/avatar-with-name.soy' */
// This file was automatically generated from avatar-with-name.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserGroupSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserGroupSelect2 == 'undefined') { Confluence.UI.Components.UserGroupSelect2 = {}; }


Confluence.UI.Components.UserGroupSelect2.avatarWithName = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-username': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserGroupSelect2.avatarWithName.soyTemplateName = 'Confluence.UI.Components.UserGroupSelect2.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:avatar-with-name-account-id', location = '/soy/avatar-with-name-account-id.soy' */
// This file was automatically generated from avatar-with-name-account-id.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.UserSelect2.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.UserSelect2 == 'undefined') { Confluence.UI.Components.UserSelect2 = {}; }


Confluence.UI.Components.UserSelect2.avatarWithNameAccountId = function(opt_data, opt_ignored) {
  return '' + aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-account-id': opt_data.userId}}) + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  Confluence.UI.Components.UserSelect2.avatarWithNameAccountId.soyTemplateName = 'Confluence.UI.Components.UserSelect2.avatarWithNameAccountId';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-group-select2', location = '/js/user-group-select2.js' */
define('confluence-ui-components/js/user-group-select2',
[
    'ajs',
    'confluence/legacy',
    'jquery',
    'confluence/api/constants'
],
function (
    AJS,
    Confluence,
    $,
    CONSTANTS
) {
    'use strict';

    /**
     * Locates inputs marked as multi-user autocompletes in the container and initialises them.
     *
     * @param scope to find unbound autocomplete inputs in
     */
    function bind(scope) {
        scope = scope || document.body;
        var showNoResultsIfAllResultsDisabled = function() {
            var $results = $('.select2-drop-active > .select2-results');
            if ($results.children('.select2-result-selectable').length === 0 &&
                $results.children('.select2-disabled').length) {

                $results.append('<li class="select2-no-results">' +
                    AJS.escapeHtml("No matches found") + '</li>');
            }
        };

        $("input.autocomplete-multiusergroup[data-autocomplete-bound != 'true']", scope).each(function() {
            var picker = $(this);
            picker.attr('data-autocomplete-bound', 'true');
            var includeGroups = picker.attr('data-include-groups');
            var defaultProfilePic = CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png";
            picker.auiSelect2({
                multiple: true,
                minimumInputLength: 2,
                formatInputTooShort: function () {
                    return includeGroups ? "Start typing to search for a user or group"
                        : "Start typing to search for a user";
                },
                ajax: {
                    transport: function(opts) {
                        // Workaround for Select2 bug: https://github.com/ivaynberg/select2/issues/381
                        // Select2 does not display "no results found" if the only results are already selected.
                        var success = opts.success;
                        delete opts.success;

                        return $.ajax.apply($.ajax, arguments).done(success).done(showNoResultsIfAllResultsDisabled);
                    },
                    data: function (searchTerm) {
                        return {
                            "max-results": 6,
                            query: searchTerm
                        };
                    },
                    dataType: 'json',
                    url: Confluence.getContextPath() + "/rest/prototype/1/search/user" + (includeGroups ? "-or-group" : "")  + ".json",
                    results: function (data) {
                        var results = [];
                        $.each(data.result, function () {
                            if (this.type === "user" && includeGroups && this.accountId) {
                                results.push({
                                    id: this.accountId,
                                    accountId: this.accountId,
                                    text: this.title,
                                    imgSrc: this.thumbnailLink && this.thumbnailLink.href ? this.thumbnailLink.href : defaultProfilePic,
                                    entity: this
                                });
                            } else if (this.type === "user") {
                                results.push({
                                    id: this.username,
                                    text: this.title,
                                    imgSrc: this.thumbnailLink && this.thumbnailLink.href ? this.thumbnailLink.href : defaultProfilePic,
                                    entity: this
                                });
                            } else {
                                results.push({
                                    id: this.name,
                                    text: this.name,
                                    imgSrc: CONSTANTS.CONTEXT_PATH + "/images/icons/avatar_group_48.png",
                                    entity: this
                                });
                            }
                        });
                        return {
                            results: results
                        };
                    },
                    quietMillis: 300
                },
                formatResult: function (result) {
                    if (result.accountId) {
                        return Confluence.UI.Components.UserSelect2.avatarWithNameAccountId({
                            size: 'xsmall',
                            displayName: result.text,
                            userId: result.accountId,
                            avatarImageUrl: result.imgSrc
                        });
                    }
                    return Confluence.UI.Components.UserGroupSelect2.avatarWithName({
                            size: 'xsmall',
                            displayName: result.text,
                            userId: result.id,
                            avatarImageUrl: result.imgSrc
                        });
                },
                // common.Widget.avatarWithName handles escaping so this doesn't have to
                escapeMarkup: function (markup) {
                    return markup;
                },
                formatSelection: function(result) {
                    if (result.accountId) {
                        return Confluence.UI.Components.UserSelect2.avatarWithNameAccountId({
                            size: 'xsmall',
                            displayName: result.text,
                            userId: result.accountId,
                            avatarImageUrl: result.imgSrc
                        });
                    }
                    return Confluence.UI.Components.UserGroupSelect2.avatarWithName({
                            size: 'xsmall',
                            displayName: result.text,
                            userId: result.id,
                            avatarImageUrl: result.imgSrc
                        });
                },
                dropdownCssClass: 'users-dropdown',
                containerCssClass: 'users-autocomplete',
                hasAvatar: true
            });

            // Logged in user will appear by default if this attribute is defined
            if (!picker.data("autofill-user"))
                return;

            var loggedInUser = AJS.Meta.get('remote-user'),
                loggedInUserFullName = AJS.Meta.get('current-user-fullname'),
                loggedInUserAvatarUrl = AJS.Meta.get('current-user-avatar-uri-reference');

            if (loggedInUser && loggedInUserFullName && loggedInUserAvatarUrl) {
                picker.auiSelect2('data',
                    [{id: loggedInUser, accountId: AJS.Meta.get('atlassian-account-id'), text: loggedInUserFullName, imgSrc: loggedInUserAvatarUrl}]
                );
            }
        });
    };

    return {
        bind: bind
    }
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:user-select2', location = '/js/user-select2.js' */
define('confluence-ui-components/js/user-select2',
[
    'ajs',
    'confluence/legacy',
    'jquery',
    'confluence/api/constants'
],
function (
    AJS,
    Confluence,
    $,
    CONSTANTS
) {
    'use strict';

    /**
     * Locates inputs marked as multi-user autocompletes in the container and initialises them.
     *
     * @param scope to find unbound autocomplete inputs in
     */
    function bind(scope) {
        scope = scope || document.body;
        var showNoResultsIfAllResultsDisabled = function() {
            var $results = $('.select2-drop-active > .select2-results');
            if ($results.children('.select2-result-selectable').length === 0 &&
                $results.children('.select2-disabled').length) {

                $results.append('<li class="select2-no-results">' +
                    AJS.escapeHtml("No matches found") + '</li>');
            }
        };

        $("input.autocomplete-multiuser[data-autocomplete-bound != 'true']", scope).each(function() {
            var picker = $(this);
            picker.attr('data-autocomplete-bound', 'true');
            var includeGroups = picker.attr('data-include-groups');
            var searchExternalOnly = picker.attr("data-search-external");
            var defaultProfilePic = CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png";
            picker.auiSelect2({
                multiple: true,
                minimumInputLength: 2,
                formatInputTooShort: function () {
                    return includeGroups ? "Start typing to search for a user or group"
                        : "Start typing to search for a user";
                },
                ajax: {
                    transport: function(opts) {
                        // Workaround for Select2 bug: https://github.com/ivaynberg/select2/issues/381
                        // Select2 does not display "no results found" if the only results are already selected.
                        var success = opts.success;
                        delete opts.success;

                        return $.ajax.apply($.ajax, arguments).done(success).done(showNoResultsIfAllResultsDisabled);
                    },
                    data: function (searchTerm) {
                        return {
                            limit: 6,
                            cql: "user.fullname~\"" + searchTerm + "\"",
                            sitePermissionTypeFilter: searchExternalOnly ? "externalCollaborator": "none"
                        };
                    },
                    dataType: 'json',
                    url: Confluence.getContextPath() + "/rest/api/search/user",
                    results: function (data) {
                        var results = [];
                        $.each(data.results, function () {
                            results.push({
                                id: this.user.accountId,
                                text: this.user.displayName,
                                imgSrc: this.user.profilePicture.path || defaultProfilePic,
                                entity: this
                            });
                        });
                        return {
                            results: results
                        };
                    },
                    quietMillis: 300
                },
                formatResult: function (result) {
                    return Confluence.UI.Components.UserSelect2.avatarWithNameAccountId({
                            size: 'small',
                            displayName: result.text,
                            userId: result.id,
                            avatarImageUrl: result.imgSrc
                        });
                },
                // common.Widget.avatarWithName handles escaping so this doesn't have to
                escapeMarkup: function (markup) {
                    return markup;
                },
                formatSelection: function(result) {
                    return Confluence.UI.Components.UserSelect2.avatarWithNameAccountId({
                            size: 'xsmall',
                            displayName: result.text,
                            userId: result.id,
                            avatarImageUrl: result.imgSrc
                        });
                },
                dropdownCssClass: 'users-dropdown',
                containerCssClass: 'users-autocomplete',
                hasAvatar: true
            });

            // Logged in user will appear by default if this attribute is defined
            if (!picker.data("autofill-user"))
                return;

            var accountId = AJS.Meta.get('atlassian-account-id'),
                loggedInUserFullName = AJS.Meta.get('current-user-fullname'),
                loggedInUserAvatarUrl = AJS.Meta.get('current-user-avatar-uri-reference');

            if (accountId && loggedInUserFullName && loggedInUserAvatarUrl) {
                picker.auiSelect2('data',
                    [{id: accountId, text: loggedInUserFullName, imgSrc: loggedInUserAvatarUrl}]
                );
            }
        });
    }

    return {
        bind: bind
    }
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQLFilters.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_ignored) {
  var output = '<div class="cql-filter cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + ' cql-type-' + soy.$$escapeHtml(opt_data.field.uiSupport.valueType) + '">';
  var id__soy8 = 'cql-field-' + soy.$$escapeHtml(opt_data.field.fieldName) + '-' + soy.$$escapeHtml(opt_data.counter);
  output += '<div class=\'cql-field-heading\'><label for="' + soy.$$escapeHtml(id__soy8) + '">' + soy.$$escapeHtml(opt_data.label) + ((! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml('Remove filter') + '"></span>' : '') + '</label></div><div class=\'cql-filter-field-input-container\'><input type="text" class="cql-field-input text" id="' + soy.$$escapeHtml(id__soy8) + '"></div></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQLFilters.Templates.baseFilterField.soyTemplateName = 'Confluence.UI.Components.CQLFilters.Templates.baseFilterField';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.FilterSelect.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_ignored) {
  return '<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Add filter(s)') + '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.FilterSelect.Templates.container.soyTemplateName = 'Confluence.UI.Components.CQL.FilterSelect.Templates.container';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/date-picker.soy' */
// This file was automatically generated from date-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.DatePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.DatePicker == 'undefined') { Confluence.UI.Components.DatePicker = {}; }
if (typeof Confluence.UI.Components.DatePicker.templates == 'undefined') { Confluence.UI.Components.DatePicker.templates = {}; }


Confluence.UI.Components.DatePicker.templates.input = function(opt_data, opt_ignored) {
  return '<div class="aui-navgroup-vertical"><ul class="aui-nav"><li class="aui-nav-selected"><a data-value="">' + soy.$$escapeHtml('Any date') + '</a></li><li><a data-value="now(\'-1d\')">' + soy.$$escapeHtml('Last 24 hours') + '</a></li><li><a data-value="now(\'-1w\')">' + soy.$$escapeHtml('Last week') + '</a></li><li><a data-value="now(\'-1M\')">' + soy.$$escapeHtml('Last month') + '</a></li><li><a data-value="now(\'-1y\')">' + soy.$$escapeHtml('Last year') + '</a></li><li><a data-value="custom">' + soy.$$escapeHtml('Custom') + '</a><span class="absolute-date-pickers"><input class="from-date-picker text" type="date" /><span>&ndash;</span><input class="to-date-picker text" type="date" /></span></li></ul></div>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.DatePicker.templates.input.soyTemplateName = 'Confluence.UI.Components.DatePicker.templates.input';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-type-picker.soy' */
// This file was automatically generated from cql-type-picker.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.TypePicker.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker == 'undefined') { Confluence.UI.Components.CQL.TypePicker = {}; }
if (typeof Confluence.UI.Components.CQL.TypePicker.templates == 'undefined') { Confluence.UI.Components.CQL.TypePicker.templates = {}; }


Confluence.UI.Components.CQL.TypePicker.templates.suggestions = function(opt_data, opt_ignored) {
  var output = '<div class="aui-navgroup-vertical"><ul class="aui-nav">';
  var typeList4 = opt_data.types;
  var typeListLen4 = typeList4.length;
  for (var typeIndex4 = 0; typeIndex4 < typeListLen4; typeIndex4++) {
    var typeData4 = typeList4[typeIndex4];
    output += '<li ' + ((typeIndex4 == 0) ? ' class="aui-nav-selected"' : '') + '><a data-value="' + soy.$$escapeHtml(typeData4.type) + '">' + soy.$$escapeHtml(typeData4.label) + '</a></li>';
  }
  output += '<li><a data-value="custom">' + soy.$$escapeHtml('Custom') + '</a></li></ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.TypePicker.templates.suggestions.soyTemplateName = 'Confluence.UI.Components.CQL.TypePicker.templates.suggestions';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-space-field.soy' */
// This file was automatically generated from cql-space-field.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.UI.Components.CQL.SpaceField.templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField == 'undefined') { Confluence.UI.Components.CQL.SpaceField = {}; }
if (typeof Confluence.UI.Components.CQL.SpaceField.templates == 'undefined') { Confluence.UI.Components.CQL.SpaceField.templates = {}; }


Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption = function(opt_data, opt_ignored) {
  return '<span><input type="checkbox" value="true" id="search-filter-include-archived" name="includeArchivedSpaces"><label for="search-filter-include-archived">Search archived spaces</label></span>';
};
if (goog.DEBUG) {
  Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption.soyTemplateName = 'Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define('confluence-ui-components/js/cql/internal/cql-special-spaces',
[
    'underscore'
],
/**
 * Helper method for handling special spaces (such as "Current Space" and "Favourite Spaces"), which takes into account
 * the current context. For example: "Current Space" is not applicable when on the search screen.
 * @module confluence-ui-components/js/cql/internal/cql-special-spaces
 */
function (
    _
) {

    'use strict';

    // This is a duplication of the key/values from BooleanQueryConverter.getSpaceType() in confluence-advanced-macros,
    // which should always stay in sync.
    var spaceIDToJSPropMapping = {
        //'conf_all',
        'conf_current' : 'currentSpace()',
        'conf_favorites' : 'favourite',
        'conf_global' : 'global',
        'conf_personal' : 'personal'
    };
    var JSPropToSpaceIDMapping = _.invert(spaceIDToJSPropMapping);

    function _getSpecialSpacesMapInContext(environment) {
        if (environment === 'search-screen') {
            return _.omit(spaceIDToJSPropMapping, 'conf_current');
        }
        return spaceIDToJSPropMapping;
    }

    function _getSpecialSpacesKeysInContext(environment) {
        return _.keys(_getSpecialSpacesMapInContext(environment));
    }

    function _getSpecialSpaceIDFromJSProp(property) {
        return JSPropToSpaceIDMapping[property];
    }

    return {
        getMap: _getSpecialSpacesMapInContext,
        getKeys: _getSpecialSpacesKeysInContext,
        getUIValue: _getSpecialSpaceIDFromJSProp
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define('confluence-ui-components/js/cql/internal/cql-ajax',
[
    'jquery',
    'underscore',
    'ajs'
],
/**
 * Handles server requests for CQL UI operations.
 */
function (
    $,
    _,
    AJS
) {

    'use strict';

    // CQL field definitions Deferred object. Cached to avoid unnecessary lookups, as it shouldn't change during a single
    // page view.
    var fieldsDeferred;

    /**
     * Retrieves CQL field definitions, made available via a jQuery Deferred that is resolved when the definitions are
     * available.
     */
    function getFields() {
        if (!fieldsDeferred) {
            // We wrap the AJAX call for the fields in a custom Deferred that lets us filter the results that are
            // passed to the listening code.
            fieldsDeferred = $.Deferred();

            var resolveFields = function(fieldMap) {
                var fieldArrays = _.values(fieldMap);
                if (!fieldArrays.length) {
                    // TODO - CRA-439 AJAX errors need love too.
                    throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.");
                }

                var fields = _.union.apply(_, fieldArrays);
                fields = _.sortBy(fields, 'fieldName');

                fieldsDeferred.resolve(fields);
            };
            var rejectFields = function() {
                fieldsDeferred.reject();
            };

            $.getJSON(AJS.contextPath() + "/rest/cql/fields?filter=withUiSupport")
                .done(resolveFields)
                .fail(rejectFields);
        }
        return fieldsDeferred.promise();
    }

    /**
     * Parses expressions out of CQL, returning a list of fields and values.
     */
    function parseClauses(cql) {
        return $.getJSON(AJS.contextPath() + "/rest/cql/expressions?cql=" + encodeURIComponent(cql));
    }

    /**
     * Returns a list of content types available for CQL searches.
     */
    function getContentTypes() {
        return $.getJSON(AJS.contextPath() + "/rest/cql/contenttypes?category=content");
    }

    /**
     * Returns a list of all types available for CQL searches, including non-content types such as Spaces and Users.
     */
    function getTypes() {
        return $.getJSON(AJS.contextPath() + "/rest/cql/contenttypes?category=all");
    }

    return {
        getFields: getFields,
        parseClauses: parseClauses,
        getTypes: getTypes,
        getContentTypes: getContentTypes
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-picker.js' */
define('confluence-ui-components/js/cql/internal/cql-date-picker',
[
    'ajs',
    'jquery'
],
/**
 * A picker for dates that supports picking from a set list of ranges or entering one manually.
 *
 * Manually-entered date ranges can be open at either end.
 */
function (
    AJS,
    $
) {
    'use strict';

    function build($input) {

        var $picker = $(Confluence.UI.Components.DatePicker.templates.input());
        var $options = $picker.find('.aui-nav li');
        var $absolutePickerWrapper = $picker.find('.absolute-date-pickers').hide(); // start hidden
        var $fromPickerInput = $picker.find('.from-date-picker');
        var $toPickerInput = $picker.find('.to-date-picker');
        var triggerDateChanged = function() {};
        this.onChange = function(callback) {
            triggerDateChanged = callback;
            $fromPickerInput.change(callback);
            $toPickerInput.change(callback);
        };

        $picker.on('click', '.aui-nav a', function () {
            var currentlySelectedLi = $options.filter('li.aui-nav-selected');
            var newLi = $(this).closest('li');
            if (currentlySelectedLi[0] != newLi[0]) {
                $options.not(newLi).removeClass('aui-nav-selected');
                newLi.addClass('aui-nav-selected');
                triggerDateChanged();
            }

            if ($(this).data('value') === 'custom') {
                $absolutePickerWrapper.slideDown('fast');
            } else {
                $absolutePickerWrapper.slideUp('fast');
            }
        });

        var auiDatePickerOptions = {
            overrideBrowserDefault: true
        };
        AJS.DatePicker($fromPickerInput, auiDatePickerOptions);
        AJS.DatePicker($toPickerInput, auiDatePickerOptions);

        // Need to override the defaults set by AUI.
        $fromPickerInput.attr('placeholder', "From");
        $toPickerInput.attr('placeholder', "To");

        $input.replaceWith($picker);

        return  {
            getSelectedOption: function () {
                var $selected = $options.filter('.aui-nav-selected').find('a');
                return $selected.data('value');
            },

            selectOption: function (value) {
                var $selectedRelative = $options.find('a[data-value="' + value + '"]');
                $selectedRelative.click();
            },

            getFromDate: function () {
                return $fromPickerInput.val();
            },

            getToDate: function () {
                return $toPickerInput.val();
            },

            setFromDate: function (dateStr) {
                $fromPickerInput.val(dateStr);
                $options.find("a[data-value='custom']").click();
            },

            setToDate: function (dateStr) {
                $toPickerInput.val(dateStr);
                $options.find("a[data-value='custom']").click();
            }
        };
    }

    return {
        build: build
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-type-picker.js' */
define('confluence-ui-components/js/cql/internal/cql-type-picker',
[
    'jquery',
    'underscore',
    'ajs',
    'confluence-ui-components/js/cql/internal/cql-ajax',
    'confluence-ui-components/js/include-exclude-picker',
    'confluence/legacy',
    'confluence-ui-components/js/cql/internal/cql-set-value-helper'
],
/**
 * A picker for extensible content types, e.g. page, blogpost, comment, attachment, question, file...
 */
function (
    $,
    _,
    AJS,
    cqlAjax,
    includeExcludePicker,
    Confluence,
    setValueHelper
) {
    'use strict';

    // CQL content types Deferred object. Cached to avoid unnecessary lookups, as it shouldn't change during a single
    // page view.
    var typesDeferred;

    // Stores the transformed result from the typesDeferred. Empty until the deferred returns.
    var data = [];

    function cacheData(results) {
        data = _.map(results, function(result) {
            return {
                id: result.type,
                text: result.label
            };
        });
    }

    // Private method used in testing, resets 'static' state.
    function _clearCache() {
        typesDeferred = null;
        data = [];
    }

    function _getPicklistKey(values, suggestions) {
        if (values.length === 0) {
            return '';
        }

        if (values.length == 1 && _.contains(_.pluck(suggestions, 'type'), values[0])) {
            return values[0];
        }
        return 'custom';
    }

    function build(suggestions, contentTypesOnly) {

        var $input, $options, $customTypesContainer, allOptions = [];

        if (!typesDeferred) {
            // Lazy-load and cache the types from the server.
            typesDeferred = contentTypesOnly ? cqlAjax.getContentTypes() : cqlAjax.getTypes();
            typesDeferred.done(cacheData);
        }

        typesDeferred.done(function () {
            if (suggestions.length) {
                // Add any suggestions not already in the option list.
                var allDataIds = _.pluck(data, 'id');
                allOptions = [].concat(data);
                suggestions.forEach(function(suggestion) {
                    // Any 'new' types such as Spaces and Users need adding to the dropdown.
                    if (suggestion.type !== '' && !_.contains(allDataIds, suggestion.type)) {
                        allOptions.push({
                            id: suggestion.type,
                            text: suggestion.label
                        });
                    }
                });
            }
            else {
                allOptions = data;
            }
        });

        var select2Options = {
            query: function(query, stripPrefix, formatResult) {
                // Defer query execution until types from server are returned. If we don't do this, when a newly-created
                // type field is triggered it will show "No results" instead of the expected Type suggestions.
                typesDeferred.done(function () {
                    // Need to use the strip function to get
                    // the search term prefix which will be applied
                    // to all search results with the formatResult
                    stripPrefix(query.term);
                    // The 'local' function is what is responsible for
                    // the standard filtering behaviour when using the 'data' options of Select2
                    var filterFn = window.Select2.query.local({
                        results: _.map(allOptions, formatResult)
                    });
                    filterFn(query);
                });
            },
            initSelection: function (element, callback) {
                var initValues = element.val().split(',');
                var prefix = '';
                // We need to check if the result has a prefix and strip it out
                // This is ugly but it's the only solution for now for some reason, sez CI.
                var initValuesWithoutPrefix = _.map(initValues, function(type) {
                    var firstChar = type.charAt(0);
                    if (firstChar === '-') {
                        prefix = '-';
                        return type.substring(1);
                    }
                    return type;
                });
                typesDeferred.done(function() {
                    var initData = _.filter(allOptions, function(result) {
                        return _.contains(initValuesWithoutPrefix, result.id);
                    });
                    // Add prefix back
                    callback(_.map(initData, function(result) {
                        return {
                            id: prefix + result.id,
                            text: prefix + result.text
                        };
                    }));
                });
            },
            multiple: true,
            placeholder: "All content types"
        };

        function setupInput(input) {
            $input = input;

            // Trace when field changes to assist webdriver tests
            if (AJS.trace) {
                $input.on('change', function() {
                     AJS.trace("type.field.changed");
                });
            }

            // If pick list suggestions have been provided. Render them before the input field
            if (suggestions.length) {
                var $suggestions = $(Confluence.UI.Components.CQL.TypePicker.templates.suggestions({
                    types: suggestions
                }));
                $options = $suggestions.find('.aui-nav li');
                $input.before($suggestions);

                $suggestions.on('click', '.aui-nav a', function () {
                    // Set styling for selected pick list item
                    var myLi = $(this).closest('li');
                    var $previousOption = $options.filter('.aui-nav-selected');
                    // We have selected the same pick list option, do nothing
                    if (myLi[0] === $previousOption[0]) {
                        return;
                    }
                    $previousOption.removeClass('aui-nav-selected');
                    //$options.not(myLi).removeClass('aui-nav-selected');
                    myLi.addClass('aui-nav-selected');

                    // Show input field if 'custom' pick list item selected
                    // Otherwise hide it
                    var selection = $(this).attr('data-value');
                    if (selection == 'custom') {
                        $customTypesContainer.slideDown('fast');
                    } else {
                        $customTypesContainer.hide();
                    }

                    var triggerChangeEvent = true;
                    $input.select2("val", [selection], triggerChangeEvent);
                });
            }

            $input.auiSelect2(includeExcludePicker.build(select2Options));

            if (suggestions.length) {
                $customTypesContainer = $input.closest('.cql-filter').find('.select2-container');
                $customTypesContainer.hide();
            }
        }

        return {
            setupInput: setupInput,

            // Allows callers to define their own code for setting values; it will only run after typesDeferred
            // has been resolved and we have a list of types.
            //
            // It returns another deferred which is resolved when new values have been set to the input field
            // and a change event has been fired
            setValues: function (values) {
                if ($options) {
                    // Show selected value in picklist
                    var pickerKey = _getPicklistKey(values, suggestions);
                    var $option = $options.find('[data-value="' + pickerKey + '"]').parent();
                    $options.not($option).removeClass('aui-nav-selected');
                    $option.addClass('aui-nav-selected');
                    if (pickerKey === 'custom') {
                        $customTypesContainer.show();
                    }
                }
                var setValuesDeferred = $.Deferred();
                typesDeferred.done(function() {
                    setValueHelper.setValues($input, values).done(function () {
                        setValuesDeferred.resolve();
                    });
                });
                return setValuesDeferred;
            }
        };
    }

    return {
        build: build,
        _clearCache: _clearCache,
        _getPicklistKey: _getPicklistKey
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define('confluence-ui-components/js/cql/internal/cql-field-model', [],
/**
 * Works with back-end QueryField objects.
 */
function () {

    'use strict';
    
    function getLabel(field) {
        return field.uiSupport.label.translation;
    }

    function setLabel(field, label) {
        field.uiSupport.label.translation = label;
    }

    return {
        getLabel: getLabel,
        setLabel: setLabel
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define('confluence-ui-components/js/cql/internal/cql-space-expression-adjuster',
[
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-special-spaces'
],
/**
 * Adjusts values in space CQL expressions for use in a CQL.FilterField.
 */
function (
    _,
    specialSpaces
) {
    'use strict';

    /**
     * Combines functionValues with values in a space expression.
     *
     * @param spaceExpression CQL QueryExpression to adjust
     * @returns object the updated QueryExpression
     */
    function convertFunctionValues(spaceExpression) {
        var functionValues = spaceExpression.functionValues;
        if (!functionValues || !functionValues.length) {
            return spaceExpression;  // nothing to do.
        }

        var convertedValues = [];
        _.each(functionValues, function (functionValue) {
            if (functionValue.functionName === 'currentSpace') {
                convertedValues.push(specialSpaces.getUIValue('currentSpace()'));
            }
            else {
                throw new Error(functionValue.functionName + ' is not a known function');
            }
        });

        // Put function values before normal ones in the UI.
        spaceExpression.values = convertedValues.concat(spaceExpression.values);
        return spaceExpression;
    }

    return {
        convertFunctionValues: convertFunctionValues
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-autocomplete-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field',
[
    'jquery',
    'ajs',
    'confluence/legacy',
    'confluence-ui-components/js/cql/internal/cql-expression-builder',
    'confluence-ui-components/js/cql/internal/cql-set-value-helper'
],
/**
 * Provides setup and behaviour for Autocomplete CQL filter fields that specify a data-uri.
 */
function (
    $,
    AJS,
    Confluence,
    expressionBuilder,
    setValueHelper
) {
    'use strict';

    function processResponseData(data) {

        var suggested = data.suggestedResults;
        var found = data.searchResults;

        if (!suggested.length) {
            return found;  // if found is empty too, so be it.
        }
        if (!found.length) {
            return suggested;
        }

        return [{
            text: "Suggestions",
            children: suggested
        }, {
            text: "Search results",
            children: found
        }];
    }

    function ajaxData(query) {
        return {
            query: query,
            searchContext: JSON.stringify({
                spaceKey: AJS.Meta.get('space-key'),
                contentId: AJS.Meta.get('content-id')
            })
        };
    }

    var select2Opts = {
        placeholder: "Start typing to search",

        multiple : true,
        tokenSeparators: [' ', ','],

        // Always allow the option of adding a new choice.
        createSearchChoice : function(term) {
            if (!term) {
                return null;
            }

            return {
                id : term,
                text : "New result: " + term,
                isNew : true
            };
        },
        // TODO CRA-641 : this setting will only work when the AUI upgrade is complete. dT
        createSearchChoicePosition: 'bottom',

        ajax : {
            data: ajaxData,
            results : function(data) {
                return {
                    results : processResponseData(data)
                };
            },
            quietMillis : 300
        },

        // Required so that val() can be called on the select2 element. This simple implementation just uses the same
        // string for the id and text used for each value being set.
        initSelection: function (element, callback) {
            var labels = element.val().split(',');
            var data = labels.map(function (label) {
                return {id: label, text: label};
            });
            callback(data);
        }
    };

    function isAbsoluteUri(uri) {
        return uri.indexOf('http://') === 0 ||
               uri.indexOf('https://') === 0;
    }

    function getUrl(dataUri) {
        if (isAbsoluteUri(dataUri)) {
            return dataUri;
        } else {
            return Confluence.getContextPath() + dataUri;
        }
    }

    function build(field) {

        var $input;

        return {

            setupInput: function (input) {
                $input = input;

                var ajax = $.extend({}, select2Opts.ajax, {
                    url: getUrl(field.uiSupport.dataUri)
                });
                var opts = $.extend({}, select2Opts, {
                    ajax: ajax
                });  // TODO - any neater ways of doing this "deep" override? dT

                input.auiSelect2(opts);
            },

            asCqlFunc: function() {
                var val = this.input.val().trim();
                if (!val) {
                    return undefined;
                }
                return expressionBuilder.buildEqualityExpressionFromValuesString(this.fieldName, val);
            },

            setValues: function(expression) {
                return setValueHelper.setValues($input, expression.values);
            }
        };
    }

    return {
        build: build,

        // Exposed for unit-testing
        _getUrl: getUrl,
        _ajaxData: ajaxData
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-content-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field',
[
    'jquery',
    'confluence-ui-components/js/page-picker',
    'confluence-ui-components/js/cql/internal/cql-expression-builder',
    'confluence-ui-components/js/cql/internal/cql-set-value-helper'
],
/**
 * Provides setup and behaviour for Label CQL filter fields
 */
function (
    $,
    pagePicker,
    expressionBuilder,
    setValueHelper
) {
    'use strict';

    // Need to add "page:1234567" format again...
    // TODO CRA-442 - /cql/fields REST resource needs to provide entity-type, so that the UI here knows
    // whether to display a page/blog/content picker.
    function addType(id) {
        return 'page:' + id;  // TODO CRA-418 allow type information in id
    }

    function addFunctionValue(functionValue) {
        return 'content-function:' + functionValue.functionName + '()'; // NO PARAMS FOR YOU.
    }

    function addValuePrefixes(expression) {
        return expression.values.map(addType).concat(expression.functionValues.map(addFunctionValue));
    }

    function build() {

        var $input;

        return {
            setupInput: function (input) {
                $input = input;

                var options = {
                    // TODO - CRA-530 '=' vs 'in' ops should come from the field's "supportedOps" property.
                    multiple: this.fieldName !== 'parent',
                    suggestedContentFunctions: ['currentContent()']
                };
                input.auiSelect2(pagePicker.build(options));
            },

            asCqlFunc: function() {
                var val = this.input.val().trim();
                if (!val) {
                    return undefined;
                }
                // PagePicker returns values like "page:1234567,blogpost:9876543,content-function:currentContent()" so
                // extract the ids.
                var ids = val.replace(/[a-z\-]+:/g, '');
                return expressionBuilder.buildEqualityExpressionFromValuesString(this.fieldName, ids);
            },

            // Visible for unit testing
            _addValuePrefixes: addValuePrefixes,

            setValues: function(expression) {
                var withTypes = addValuePrefixes(expression);

                return setValueHelper.setValues($input, withTypes);
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-suggestions.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions',
[
    'ajs'
],
/**
 * Provides suggested options for CQL 'Type' filter fields.
 */
function (
    AJS
) {
    'use strict';

    var isLivePagesOpenBetaEnabled = AJS.DarkFeatures.isEnabled("confluence_live_pages_open_beta_trait_opted_in")

    /**
     * Returns a list of hard-coded Type suggestions for the Search screen CQL component.
     *
     * This method should in future be able to load suggestions from some data in the DOM, such as via AJS.Data.
     * Reasoning for not using AJAX for this list is that the Search page needs to be able to display the suggestion
     * list as the page renders, not later.
     */

    var hardcodedList = [
        {
            type: '',
            label: "All content"
        },
        {
            type: 'page',
            label: isLivePagesOpenBetaEnabled ? "Pages and live docs"
                : "Pages"
        },
        {
            type: 'blogpost',
            label: "Blog Posts"
        },
        {
            type: 'attachment',
            label: "Attachments"
        },
        {
            type: 'space',
            label: "Spaces"
        }
    ];

    function getList() {
        return hardcodedList;
    }

    return {
        getList: getList
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-type-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field',
[
    'confluence-ui-components/js/cql/internal/cql-type-picker',
    'confluence-ui-components/dark-features',
    'confluence-ui-components/js/cql/internal/filterfields/cql-type-suggestions'
],
/**
 * Provides setup and behaviour for CQL 'Type' filter fields.
 *
 * When presented in different contexts (e.g. in Search screen vs in Macro Browser form for 'Content by Label' macro)
 * this filter may provide suggestions and have limited types available.
 */
function (
    TypePicker,
    DarkFeatures,
    Suggestions
) {
    'use strict';

    function build(field) {

        var picker;

        return {
            setupInput: function (input, context) {

                var suggestedTypes = [];
                var contentTypesOnly = true;

                if ((context.environment === 'search-screen' && context.searchType == 'all')
                        || DarkFeatures.isEnabled('cql.force.full.search.mode')) {
                    // These suggested types will be displayed as the Search screen is rendered, so they need to NOT
                    // come from an AJAX call. Also, the current contenttypes REST call needs to have its results filtered
                    // to include the values from the picklist (i.e. when typing 'Peo' in the search screen picker, the
                    // 'People' option should appear.
                    suggestedTypes = Suggestions.getList();
                    contentTypesOnly = false;
                }

                picker = TypePicker.build(suggestedTypes, contentTypesOnly);
                picker.setupInput(input);
            },

            setValues: function(expression) {
                return picker.setValues(expression.values);
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-date-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field',
[
    'ajs',
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-date-picker'
],
/**
 * A picker for CQL date valueTypes that supports picking from a set list of ranges or entering one manually.
 *
 * Manually-entered date ranges can be open at either end.
 */
function (
    AJS,
    _,
    DatePicker
) {
    'use strict';

    function build(field) {

        var fieldName = field.fieldName;
        var datePicker;

        function getCustomExpression() {
            var fromDate = datePicker.getFromDate();
            var toDate = datePicker.getToDate();

            var fromExpr, toExpr;
            if (fromDate) {
                fromExpr = fieldName + ' >= "' + fromDate + '"';
            }
            if (toDate) {
                toExpr = fieldName + ' <= "' + toDate + '"';
            }

            if (fromExpr && toExpr) {
                return fromExpr + ' and ' + toExpr;
            }
            return fromExpr || toExpr || '';
        }

        return {
            /**
             * The incoming input is just used as an anchor for adding the Soy render and then deleted.
             */
            setupInput: function (input) {
                // Build this picker in the context of this filter field so we can add our own onChange method
                datePicker = DatePicker.build.call(this, input);
            },

            /**
             * There are four supported cases, like:
             *
             * 1. created >= now('-1w')
             * 2. created >= 2015-05-10
             * 3. created <= 2015-06-10
             * 4. created >= 2015-05-10 and created <= 2015-06-10
             *
             * The first is represented by a single nested expression with a 'now' functionValue, which is
             * populated into one of the hard-coded "relative" options such as "Last week" or "Last month".
             *
             * The second and third are also represented by single nested expressions, but with absolute
             * date values, and are loaded into the absolute date picker component at either end.
             *
             * The fourth case is represented by two nested expressions and loaded into the absolute date
             * picker in a similar way to the second and third cases.
             */
            setValues: function(expression) {
                if (!datePicker) {
                    AJS.warn("DatePicker not set yet, can't set values");
                    return;
                }

                // Date fields get wrapped expressions to support phrases like
                // created >= 2014-06-09 and created <= 2014-06-10
                var expressions = expression.expressions;
                if (expressions.length < 1 || expressions.length > 2) {
                    // This is unlikely to ever, ever happen.
                    AJS.warn("Can't set date value with expressions.length: " + expressions.length);
                    return;
                }
                if (expressions.length === 1 && expressions[0].functionValues.length === 1 &&
                        expressions[0].functionValues[0].functionName === 'now') {
                    // A relative date.
                    if (expressions[0].operator !== '>=') {
                        AJS.warn("Unsupported date picker relative date operator: " + expressions[0].operator);
                        return;
                    }
                    var relDate = expressions[0].functionValues[0].parameters[0];
                    datePicker.selectOption("now('" + relDate + "')");

                }
                else {
                     // Load the absolute date pickers.
                    _.each(expressions, function (expression) {
                        if (expression.values.length === 1) { // i.e. an absolute date
                            var dateStr = expression.values[0];
                            if (expression.operator === '>=') {
                                datePicker.setFromDate(dateStr);
                            }
                            else if (expression.operator === '<=') {
                                datePicker.setToDate(dateStr);
                            }
                        }
                    });
                }
            },

            /**
             * Similar to setValues, in the opposite direction - values in the relative options turn into
             * a 'now' function invocation, while absolute date picker values are inserted into the
             * expression RHS 'as-is'.
             */
            asCqlFunc: function() {
                if (!datePicker) {
                    AJS.warn("DatePicker not set yet, can't get CQL");
                    return;
                }

                var value = datePicker.getSelectedOption();
                if (!value) {
                    // "Any date" option selected
                    return '';
                }
                if (value === 'custom') {
                    return getCustomExpression();
                }
                return fieldName + ' >= ' + value;
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-label-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field',
[
    'jquery',
    'ajs',
    'confluence-ui-components/js/label-picker',
    'confluence-ui-components/js/include-exclude-picker',
    'confluence-ui-components/js/cql/internal/cql-set-value-helper'
],
/**
 * Provides setup and behaviour for Label CQL filter fields
 */
function (
    $,
    AJS,
    labelPicker,
    includeExcludePicker,
    setValueHelper
) {

    'use strict';

    function build() {

        var $input;

        return {
            setupInput: function (input) {
                $input = input;

                input.auiSelect2(includeExcludePicker.build(labelPicker.build({
                    noMatches: "No matching labels found"
                })));
            },

            setValues: function (clause) {
                return setValueHelper.setValues($input, clause.values);
            }
        };
    }

    return {
        build: build
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-space-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field',
[
    'jquery',
    'confluence-ui-components/js/space-picker',
    'confluence-ui-components/js/include-exclude-picker',
    'confluence-ui-components/js/cql/internal/cql-special-spaces',
    'confluence-ui-components/js/cql/internal/cql-space-expression-adjuster',
    'confluence-ui-components/js/cql/internal/cql-space-expression-builder',
    'confluence-ui-components/js/cql/internal/cql-set-value-helper',
    'confluence/legacy'
],
/**
 * Provides setup and behaviour for Space CQL filter fields
 */
function (
    $,
    spacePicker,
    includeExcludePicker,
    specialSpaces,
    spaceExpressionAdjuster,
    spaceExpressionBuilder,
    setValueHelper,
    Confluence
) {
    'use strict';

    function build() {

        var $input;

        return {
            setupInput: function (input, context) {
                $input = input;

                input.auiSelect2(includeExcludePicker.build(spacePicker.build({
                    multiple: true,
                    suggestCategories: specialSpaces.getKeys(context.environment),

                    // CRA-547 Stops space.type and space values from being mixed.
                    disableMixedSpaceTypes: true
                })));

                if (context.environment === 'search-screen') {
                    var $archivedSpacesOption = $(Confluence.UI.Components.CQL.SpaceField.templates.archivedSpacesOption());
                    $input.after($archivedSpacesOption);
                    this.onChange = function(callback) {
                        var $archivedSpacesOptionInput = $archivedSpacesOption.find('#search-filter-include-archived');
                        $archivedSpacesOptionInput.change(callback);
                        $input.change(callback);
                    };
                }
            },

            asCqlFunc: function() {
                // The Space picker might return "conf_X" category values - these need converting to the correct
                // CQL expression
                return spaceExpressionBuilder.buildExpressionFromValuesString(this.input.val());
            },

            setValues: function(expression) {
                // Convert functionValues (e.g. currentSpace()) into UI-friendly values
                spaceExpressionAdjuster.convertFunctionValues(expression);

                return setValueHelper.setValues($input, expression.values);
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-user-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field',
[
    'underscore',
    'jquery',
    'ajs',
    'confluence/api/constants',
    'confluence-ui-components/js/user-group-select2'
],
/**
 * Provides setup and behaviour for User CQL filter fields
 */
function (
    _,
    $,
    AJS,
    CONSTANTS,
    autocompleteMultiUser
) {

    'use strict';

    function build() {

        var $input;

        return {
            setupInput: function (input) {
                $input = input;

                input.addClass('select2-input autocomplete-multiusergroup');

                autocompleteMultiUser.bind(input.parent());
            },

            /**
             Setting user values is a little bit interesting. The values stored in CQL are only usernames and don't
             include things required for rendering, i.e. Full Name and Avatar.

             This filter field delegates to the autocompleteMultiUser component. The component uses our legacy
             prototype REST API user search for its User data, so we call the API manually here to retrieve the
             User render data.

             The legacy API only allows searching on one string at a time (natch), so we must make a separate AJAX
             request for each user to display. Crappy, right? Bring on RA's common Atlassian User REST API, right?

             @param expression CQL query expression
             */
            setValues: function(expression) {
                var values = expression.values;
                if (!values || !values[0]) {
                    return;
                }
                function generateFormerUser(username) {
                    return {
                        id: username, // Didn't find a user with this username.
                        text: "Former user",
                        imgSrc: CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png"
                    };
                }
                var requests = [];
                var users = [];
                var defaultProfilePic = CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png";
                for (var i = 0; i < values.length; i++) {
                    var request = function(username) {
                        return $.getJSON(CONSTANTS.CONTEXT_PATH + "/rest/api/user?username=" + username)
                            .done(function(user) {
                                if (user && user.accountId) {
                                    users.push({
                                        id: user.username,
                                        text: user.displayName,
                                        imgSrc: user.profilePicture.path || defaultProfilePic
                                    });
                                } else {
                                    users.push(generateFormerUser(username));
                                }
                            }).fail(function() {
                                users.push(generateFormerUser(username));
                            });
                    };
                    requests.push(request(values[i]));
                }

                // wait for all requests to finish, whether they passed/failed and then populate the field value
                return $.when.apply($, _.map(requests, function (aRequest) {
                    var monitor = $.Deferred();
                    aRequest.always(function () {
                        monitor.resolve();
                    });
                    return monitor.promise();
                })).done(function () {
                    if (users.length) {
                        $input.auiSelect2("data", users);
                    }
                });
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-account-id-filter-field.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-account-id-filter-field',
[
    'underscore',
    'jquery',
    'ajs',
    'confluence/api/constants',
    'confluence-ui-components/js/user-select2'
],
/**
 * Provides setup and behaviour for user's accountId valueType CQL filter fields
 */
function (
    _,
    $,
    AJS,
    CONSTANTS,
    autocompleteMultiUser
) {

    'use strict';

    function build() {

        var $input;

        return {
            setupInput: function (input) {
                $input = input;

                input.addClass('select2-input autocomplete-multiuser');

                autocompleteMultiUser.bind(input.parent());
            },

            /**
             Setting user values is a little bit interesting. The values stored in CQL are only accountIds and don't
             include things required for rendering, i.e. Full Name and Avatar.

             This filter field delegates to the autocompleteMultiUser component. The component uses our legacy
             prototype REST API user search for its User data, so we call the API manually here to retrieve the
             User render data.

             The legacy API only allows searching on one string at a time (natch), so we must make a separate AJAX
             request for each user to display. Crappy, right? Bring on RA's common Atlassian User REST API, right?

             @param expression CQL query expression
             */
            setValues: function(expression) {
                var values = expression.values;
                if (!values || !values[0]) {
                    return;
                }
                var defaultProfilePic = CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png";
                function generateFormerUser(accountId) {
                    return {
                        id: accountId, // Didn't find a user with this accountId.
                        text: "Former user",  // Will be substitute with nick name, once backend fully support nickname from PRS
                        imgSrc: defaultProfilePic
                    };
                }
                var requests = [];
                var users = [];

                for (var i = 0; i < values.length; i++) {
                    var request = function(accountId) {
                        return $.getJSON(CONSTANTS.CONTEXT_PATH + "/rest/api/user?accountId=" + accountId)
                            .done(function(user) {
                                if (user && user.accountId) {
                                    users.push({
                                        id: user.accountId,
                                        text: user.displayName,
                                        imgSrc: user.profilePicture.path || defaultProfilePic
                                    });
                                } else {
                                    users.push(generateFormerUser(accountId));
                                }
                            }).fail(function() {
                                users.push(generateFormerUser(accountId));
                            });
                    };

                    requests.push(request(values[i]));
                }

                // wait for all requests to finish, whether they passed/failed and then populate the field value
                return $.when.apply($, _.map(requests, function (aRequest) {
                    var monitor = $.Deferred();
                    aRequest.always(function () {
                        monitor.resolve();
                    });
                    return monitor.promise();
                })).done(function () {
                    if (users.length) {
                        $input.auiSelect2("data", users);
                    }
                });
            }
        };
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/filterfields/cql-filter-field-configs.js' */
define('confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs',
[
    'confluence-ui-components/js/cql/internal/filterfields/cql-autocomplete-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-content-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-type-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-date-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-label-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-space-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-user-filter-field',
    'confluence-ui-components/js/cql/internal/filterfields/cql-account-id-filter-field'
],
/**
 * Manages configurations used in CQL Filter fields.
 */
function (
    autocompleteFilterFieldConfig,
    contentFilterFieldConfig,
    contentTypeFilterFieldConfig,
    dateFilterFieldConfig,
    labelFilterFieldConfig,
    spaceFilterFieldConfig,
    userFilterFieldConfig,
    accountIdFilterFieldConfig
) {
    'use strict';

    var configsByValueType = {
        contentId: contentFilterFieldConfig,
        contentType: contentTypeFilterFieldConfig,
        date: dateFilterFieldConfig,
        label: labelFilterFieldConfig,
        space: spaceFilterFieldConfig,
        user: userFilterFieldConfig,
        accountId: accountIdFilterFieldConfig
    };

    return {
        getConfig: function (field) {
            var uiSupport = field.uiSupport;

            if (uiSupport.dataUri) {
                return autocompleteFilterFieldConfig.build(field);
            }

            if (configsByValueType[uiSupport.valueType]) {
                return configsByValueType[uiSupport.valueType].build(field);
            }

            return {};
        }
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-format.js' */
define('confluence-ui-components/js/cql/internal/cql-filter-format',
    [
        'jquery',
        'underscore',
        'ajs',
        'confluence-ui-components/dark-features',
        'confluence-ui-components/js/cql/internal/cql-field-model'
    ],
    /**
     * Formats CQL filter fields UI into organized groups for macro modernization.
     */
    function (
        $,
        _,
        AJS,
        DarkFeatures,
        fieldModel
    ) {
        'use strict';

        /**
         * Defines the UI grouping and order of CQL filter fields.
         * Array of groups in the format: {
         *     "label": <string> Group label to appear in input dropdown
         *     "children": <Array[string]> list of filter fields id that belong in the group
         * }
         */
        var fieldFormat = [
            {
                label: "Content",
                children: ["label", "title", "type", "text"]
            },
            {
                label: "Time",
                children: ["created", "lastmodified"]
            },
            {
                label: "User",
                children: ["creator", "creator.accountid", "owner", "owner.accountid", "contributor", "contributor.accountid", "mention", "mention.accountid"]
            },
            {
                label: "Location",
                children: ["space", "parent", "ancestor"]
            },
            {
                label: "Other",
                children: []
            }
        ];

        /**
         *
         * @param fields The array of CQL fields that should be displayed - we expect this to
         *               already exclude selected fields
         * @returns {results} The formatted array of CQL fields where the top level are field
         *                    groups containing a {children} array of the individual fields
         */
        function formatFields(fields) {
            var fieldsObj = fields.reduce(function (obj, field){
                obj[field.fieldName] = field;
                return obj;
            }, {});

            var results = fieldFormat.reduce(function (result, group) {
                var resultGroup = {
                    uiSupport: {
                        label: {
                            translation: group.label
                        }
                    }
                };

                // Populate the input group's child fields
                resultGroup.children = [];
                group.children.forEach(function (childField) {
                    var field = fieldsObj[childField];
                    if (field) {
                        resultGroup.children.push(field);

                        // Remove fields while iterating to get remaining "Other" fields
                        delete fieldsObj[childField];
                    }
                });

                // Populate remaining fields under "Other" section
                if (group.label === "Other" && Object.values(fieldsObj).length > 0) {
                    resultGroup.children = Object.values(fieldsObj);
                }

                // Only include this group in the dropdown if it has fields
                // (e.g. would be empty if user has selected all filter options in this group)
                if (resultGroup.children.length > 0) {
                    result.push(resultGroup);
                }

                return result;
            }, []);

            return results;
        }

        return {
            formatFields: formatFields
        };

    }
)
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define('confluence-ui-components/js/cql/internal/cql-filter-field',
[
    'jquery',
    'underscore',
    'ajs',
    'confluence-ui-components/js/cql/internal/cql-field-model',
    'confluence-ui-components/js/cql/internal/cql-expression-builder',
    'confluence-ui-components/js/cql/internal/filterfields/cql-filter-field-configs'
],
/**
 * A CQL Filter field is a component that represents a CQL filter in the UI.
 *
 * A CQL filter is a clause such as "space in (key1, key2)" or "title ~ sometitle" in a CQL expression, and can be
 * represented in the UI via three main UI components:
 *
 *   1. Label
 *   2. Description
 *   3. Input control
 *
 * The input control used will depend on the type of field - a space filter might have a SpacePicker control, while a
 * title filter might have a simple text field.
 *
 * Every CQL filter field provides an "asCql" method that takes the current value of the field and returns a CQL clause.
 *
 * @tainted window.Confluence.UI.Components.CQLFilters.Templates
 */
function (
    $,
    _,
    AJS,
    fieldModel,
    expressionBuilder,
    filterFieldConfigs
) {
    'use strict';

    // Temporary until these components are registered with define().
    var fieldTemplates = window.Confluence.UI.Components.CQLFilters.Templates;

    /*
        To ensure that all fields have unique ids for <label for="id">, add a counter suffix to each id.
        This id could be anything - e.g. a UUID - and shouldn't be targeted by any JS or WebDriver code.
     */
    var fieldCounter = 0;

    function makeField(field) {

        var label = fieldModel.getLabel(field);

        var fieldDiv = $(fieldTemplates.baseFilterField({
            label: label,
            field: field,
            counter: fieldCounter++
        }));

        var input = fieldDiv.find('input');
        fieldDiv.data('fieldName', field.fieldName);

        return $.extend({
            input: input,
            element: fieldDiv,
            onChange: function(callback) {
                input.change(callback);
            }
        }, field);
    }

    /**
     * Creates a new filter-field control. The field parameter has:
     * <ul>
     *     <li>fieldName (required): The name of the field (e.g. creator), not i18ned. </li>
     *     <li>valueType (required): The type of the field (e.g. user, space, label, text). </li>
     *     <li>fixed (optional): Determines if the field can be removed - if fixed, no; if not, yes. </li>
     * </ul>
     * @param field the definition of the CQL field to create a component for
     * @param cqlComponent the cql-component instance containing this field
     * @returns {*}
     */
    function build(field, cqlComponent) {

        var uiSupport = field.uiSupport;
        var valueType = uiSupport.valueType;
        var fieldName = field.fieldName;
        if (!valueType) {
            throw new Error("Can't create filter without valueType.");
        }
        if (!fieldName) {
            throw new Error("Can't create filter without fieldName.");
        }

        var config = filterFieldConfigs.getConfig(field);

        var filterField = makeField(field);

        filterField.asCql = _.bind(config.asCqlFunc || function () {
            return expressionBuilder.buildExpression(filterField, this.input.val());
        }, filterField);

        var input = filterField.element.find('input');

        if (typeof config.setupInput === 'function') {
            filterField.setupInput = config.setupInput;
            filterField.setupInput(input, cqlComponent.context);
        }

        filterField.setValues = config.setValues || function (clause) {
            input.val(clause.values.join(','));
        };

        filterField.element.find('.aui-iconfont-remove').click(function () {
            filterField.element.remove();

            // Let the owning component know that this field can be deregistered.
            cqlComponent.removeField(filterField);
        });

        return filterField;
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define('confluence-ui-components/js/cql/internal/cql-filter-select',
[
    'jquery',
    'underscore',
    'ajs',
    'confluence-ui-components/dark-features',
    'confluence-ui-components/js/cql/internal/cql-ajax',
    'confluence-ui-components/js/cql/internal/cql-field-model',
    'confluence-ui-components/js/cql/internal/cql-filter-format'
],
/**
 * A control for selecting CQL filter fields to add to the CQL component UI.
 *
 * @tainted window.Confluence.UI.Components.CQL.FilterSelect.Templates
 */
function (
    $,
    _,
    AJS,
    DarkFeatures,
    cqlAjax,
    fieldModel,
    format
) {

    'use strict';

    var filterSelectTemplates = window.Confluence.UI.Components.CQL.FilterSelect.Templates;

    /**
     * Builds a filter-select instance.
     *
     * Expected options include:
     *   onSelection - called when a filter is selected
     *   cqlContainer - the jQuery-wrapped DOM element that the filter should append itself to
     *   context - object with the environment the CQL component is running in, may be macro-browser, search-screen
     */
    function build(options) {

        var cqlContainer = options.cqlContainer;
        var cqlFieldContainer = cqlContainer.find('.cql-fields');

        var onSelection = options.onSelection;
        if (!onSelection) {
            throw Error("An onSelection callback must be provided to the FilterSelect.");
        }

        // TODO CRA-421 reinstate or remove.
        //var dupeFieldsAllowed = options.dupeFieldsAllowed || false;

        var $container = $(filterSelectTemplates.container());
        var $trigger = $container.children('button');
        var $inputWrapper = $container.find('.input-wrapper');
        var $input = $container.find('input');

        function showInput(e) {
            e.preventDefault();
            $inputWrapper.removeClass('hidden');    // display the select2 component.
            $trigger.hide();

            // Trigger the select2
            $container.find('.select2-choice').mousedown();
        }
        $trigger.click(showInput);

        function showTrigger() {
            $inputWrapper.addClass('hidden');
            $trigger.show();
        }

        $input.bind('select2-close', function() {
            AJS.debug('CQL Field selector closed');
            showTrigger();

            // If the trigger was shown by cancelling the selector rather than making a selection (in which case the
            // focus would have gone to the newly-added field), then focus the trigger. This makes keyboard navigation
            // consistent when tabbing to the trigger, hitting enter to get the select, then hitting escape to close it.
            // This select2-close binding is invoked before the input-change binding, so delay this check to give the
            // change binding time to run and focus a chosen field.
            setTimeout(function() {
                AJS.log('Checking CQL Field selector focus');
                if (!$(document.activeElement).closest('.cql-filter').length) {
                    AJS.debug('Setting CQL Field selector focus');
                    $trigger.focus();
                }
            }, 1);

        } );

        cqlContainer.append($container);

        function onInputChange(e) {
            // This control reverts to its placeholder when a selection is made (ugh, really?) and it's up to
            // the callee to do what it likes with the field object selected.

            if (!e.added) {
                // We don't expect remove events
                return;
            }

            // Clear the selection and show the placeholder.
            $input.auiSelect2("val", "");

            //// Remove added fields from the list of fields that may be added - we need a reversal for this when
            //// fields are removed in the UI.
            //if (!dupeFieldsAllowed) {
            //    fields = _.reject(fields, function (field) {
            //        return field.fieldName == e.added.fieldName;
            //    });
            //}

            // Let the callee go nuts with the value.
            onSelection(e.added);
            AJS.debug('CQL Field selection made');
            showTrigger();
        }

        function setupInput(fieldsTmp) {
            var fields = fieldsTmp;
            if (options.context.environment !== 'search-screen' && !DarkFeatures.isEnabled('cql.search.screen')) {
                fields = _.reject(fields, function (field) {
                    // CRA-692. Hide Date fields from the macro browser until compact date picker is developed.
                    return field.type === 'date';
                });
            }

            // Remove ignored fields
            fields = _.reject(fields, function(field) {
                return _.contains(options.ignoredFields, field.fieldName);
            });

            function usedField(usedFields, fieldName) {
                return _.contains(usedFields, fieldName);
            }

            function calculateResults() {
                // The displayed fields form a registry of CQL fields "in play". Some fields can be duplicated
                // (i.e. contentRelation="many" and not "one") but the rest should be ignored when generating
                // the list to be presented in the Add Filter control.
                // However, doing the lookup this way could be too slow when typing... let's find out.
                //cqlFieldContainer = cqlFieldContainer || $input.closest('.cql-container');
                if (!cqlFieldContainer[0]) {
                    throw new Error('Why no cql-container?');
                }
                var usedFields = cqlFieldContainer.find('.cql-filter').map(function() {
                    return $(this).data('fieldName');
                });

                var filteredFields = fields.filter(function(field) {
                    // when accountId type field is in use, filter out corresponding user type field.
                    if (field.uiSupport.valueType === 'user' && usedField(usedFields, field.fieldName + '.accountid')) {
                        return false;
                    }
                    // when user type field is in use, filter out corresponding accountId type field.
                    if (field.uiSupport.valueType === 'accountId' && usedField(usedFields, field.fieldName.slice(0, field.fieldName.length - '.accountid'.length))) {
                        return false;
                    }

                    return true;
                });

                // Filter out unused user type fields.
                // If a user is editing an existing macro, and add a new accountId field to it, a macro could have user field 1 and accountId field 2.
                filteredFields = filteredFields.filter(function(field) {
                    var isUsedField = usedField(usedFields, field.fieldName);
                    if (isUsedField) {
                        return true;
                    }
                    return field.uiSupport.valueType !== 'user';
                });

                var results = _.reject(filteredFields, function(field) {
                    //space is rejected as a filter that can be repeated more than once because this component does not
                    //handle it properly, and the cql expression backend does not handle multiple space.type properly as well
                    //see CRA-440, and CONFDEV-36875 for clarification.

                    return usedField(usedFields, field.fieldName) && !_.contains(['label' /*'space'*/], field.fieldName);
                    // TODO CRA-440 use contentRelation returned from server. dT
                    //return field.contentRelation !== 'many' && _.contains(usedFields, field.fieldName);
                });

                results = format.formatFields(results);

                return {
                    results: results,
                    text: fieldModel.getLabel
                };
            }

            $input.auiSelect2({
                id: 'fieldName',
                data: calculateResults,
                formatResult: fieldModel.getLabel,
                formatSelection: fieldModel.getLabel,
                placeholder: "Select filter"
            })
            .change(onInputChange);
        }
        function dieInAFire() {
            // CRA-439 we could show a standard error message / retry, if such a thing existed.
            AJS.log("Couldn't fetch CQL fields - unable to initialise CQL field picker");
        }

        cqlAjax.getFields()
            .done(setupInput)
            .fail(dieInAFire);

        return $input;
    }

    return {
        build: build
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define('confluence-ui-components/js/cql/internal/cql-space-expression-builder',
[
    'jquery',
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-special-spaces',
    'confluence-ui-components/js/cql/internal/cql-expression-builder'
],
/**
 * Creates CQL expression strings from Space value strings.
 */
function (
    $,
    _,
    specialSpaces,
    expressionBuilder
) {
    'use strict';

    function buildExpressionFromValuesString(value) {
        var val = value.trim();
        if (!val) {
            return undefined;
        }

        var values = val.split(',');

        // Build arrays of "space" and "space.type" values. We could use _.intersection and .difference here but
        // we want to maintain order - so iterate manually.
        var specialKeys = specialSpaces.getKeys();
        var spaces = [];
        var spaceTypes = [];
        _.each(values, function(value) {
            if (value === 'conf_current') {
                spaces.push('currentSpace()');
            }
            else if (_.contains(specialKeys, value)) {
                spaceTypes.push(value);
            }
            else {
                spaces.push(value);
            }
        });

        var expressions = [];
        if (spaceTypes.length) {
            var specialsMap = specialSpaces.getMap();
            spaceTypes = _.map(spaceTypes, function(key) {
                return specialsMap[key];
            });
            if (spaceTypes.indexOf('global') !== -1) {
                expressions.push(expressionBuilder.buildEqualityExpressionFromValuesString('space.type', '-personal'));
                spaceTypes = _.filter(spaceTypes, function(spaceType) { return spaceType !== 'global'; });
            }
            if (spaceTypes.length > 0) {
                expressions.push(expressionBuilder.buildEqualityExpressionFromValuesArray('space.type', spaceTypes));
            }
        }
        if (spaces.length) {
            expressions.push(expressionBuilder.buildEqualityExpressionFromValuesArray('space', spaces));
        }
        // e.g. "space.type = 'global'" or "space in ('foo','bar')"
        if (expressions.length === 1) {
            return expressions[0];
        }

        // e.g. "(space.type = 'global' or space in ('foo','bar'))"
        return '(' + expressions.join(' or ') + ')';
    }

    return {
        buildExpressionFromValuesString: buildExpressionFromValuesString
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define('confluence-ui-components/js/cql/internal/cql-expression-builder',
[
    'jquery',
    'underscore'
],
/**
 * Creates CQL expression strings from key-value pairs.
 */
function (
    $,
    _
) {
    'use strict';

    /**
     * Wraps a string with double-quotes.
     *
     * Used when generating CQL expressions to avoid spaces and other characters leaking out of expression values into
     * the CQL string.
     *
     * @param str input
     * @returns {string} input with surrounding quotes
     */
    function wrapWithQuotes(str) {
        if (_.contains(['currentContent()', 'currentSpace()'], str)) {
            return str;  // TODO should flag function values in the UI so that they can be skipped properly.
        }
        return '"' + escapeQuotes(str) + '"';
    }

    function escapeQuotes(str) {
        // The replacement needs to have a "\" backslash present, not just an escaped double-quote.
        return str.replace(/"/g, '\\"');
    }

    function buildTextExpression(key, valuesStr) {
        var val = valuesStr.trim();
        if (!val) {
            return undefined;
        }

        if(key==="title" || key==="text") {
            if (val.length > 1 && val.charAt(0) === '-') {
                return key + " !~ " + wrapWithQuotes(val.substr(1))
            }
        }

        return key + " ~ " + wrapWithQuotes(val);
    }

    function makeValueMap(values) {
        var map = {
            '+' : [],
            '-' : [],
            ''  : []
        };
        _.each(values, function(value) {
            var prefix = value.charAt(0);
            if (prefix === '+') {
                map['+'].push(value.substring(1));
            } else if (prefix === '-') {
                map['-'].push(value.substring(1));
            } else {
                map[''].push(value);
            }
        });
        return map;
    }

    function makePlusCql(fieldName, values) {
        var expressions = _.map(values, function (value) {
            return fieldName + ' = ' + wrapWithQuotes(value);
        });
        return expressions.join(' AND ');
    }

    function makeCqlWithOperator(fieldName, values, include) {
        if (values.length === 0) {
            return '';
        }
        var wrappedValues = _.map(values, wrapWithQuotes);

        var operator;
        if (wrappedValues.length === 1) {
            operator = include ? " = " : " != ";
            return fieldName + operator + wrappedValues[0];
        }

        var wrappedValuesStr = wrappedValues.join(',');
        operator = include ? ' in ' : ' not in ';
        return fieldName + operator + "(" + wrappedValuesStr + ")";
    }

    function makeMinusCql(fieldName, values) {
        return makeCqlWithOperator(fieldName, values, false);
    }

    function makeRegularCql(fieldName, values) {
        return makeCqlWithOperator(fieldName, values, true);
    }

    function buildEqualityExpressionFromValuesArray(fieldName, values) {
        var map = makeValueMap(values);
        var cqls  = [];
        var plusCql = makePlusCql(fieldName, map['+']);
        if (plusCql) {
            cqls.push(plusCql);
        }
        var regularCql = makeRegularCql(fieldName, map['']);
        if (regularCql) {
            cqls.push(regularCql);
        }
        var minusCql = makeMinusCql(fieldName, map['-']);
        if (minusCql) {
            cqls.push(minusCql);
        }

        return cqls.join(' AND ');
    }

    function buildEqualityExpressionFromValuesString(fieldName, value) {
        var val = value.trim();
        if (!val) {
            return undefined;
        }

        var values = val.split(',');
        values = _.map(values, function(value) {
            return value.trim();
        });
        return buildEqualityExpressionFromValuesArray(fieldName, values);
    }

    function buildExpression(field, valueStr) {
        if (field.type === 'equality') {
            return buildEqualityExpressionFromValuesString(field.fieldName, valueStr);
        }

        if (field.type === 'text') {
            return buildTextExpression(field.fieldName, valueStr);
        }

        throw new Error('buildExpression does not yet support type: ' + field.type);
    }

    return {
        buildExpression: buildExpression,
        buildEqualityExpressionFromValuesString: buildEqualityExpressionFromValuesString,
        buildEqualityExpressionFromValuesArray: buildEqualityExpressionFromValuesArray,
        makeValueMap: makeValueMap,
        makePlusCql: makePlusCql,
        makeMinusCql: makeMinusCql,
        makeRegularCql: makeRegularCql
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define('confluence-ui-components/js/cql/internal/cql-space-type-expression-converter',
[
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-special-spaces'
],
/**
 * Converts space.type CQL expressions into space expressions for use in a CQL.FilterField.
 */
function (
    _,
    specialSpaces
) {
    'use strict';

    /**
     * Convert a single space.type expression into a space one.
     *
     * @param spaceTypeExpression CQL expression to convert
     * @param spaceField CQL space field definition
     * @returns object a space CQL expression
     */
    function convert(spaceTypeExpression, spaceField) {
        var resultField = _.clone(spaceField);
        var resultValues = _.map(spaceTypeExpression.values, specialSpaces.getUIValue);

        var isGlobal = spaceTypeExpression.negate && resultValues.length == 1 && resultValues[0] === 'conf_personal';
        return {
            field: resultField,
            values: isGlobal ? [ 'conf_global' ] : resultValues,
            negate: isGlobal ? false : spaceTypeExpression.negate
        };
    }

    return {
        convert: convert
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define('confluence-ui-components/js/cql/internal/cql-space-expression-aggregator',
[
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-space-type-expression-converter'
],
/**
 * SpaceExpressionAggregator takes CQL expressions that may include space.type and space expressions, and aggregates
 * those expressions into a single space expression for use in a CQL.FilterField.
 */
function (
    _,
    spaceTypeExpressionConverter
) {
    'use strict';

    /**
     * Clauses with field "space.type" need turning into "space" expressions; this means combining with any existing
     * "space" expressions.
     *
     * @param expressions array of CQL expressions to aggregate
     * @param spaceField CQL space field definition, required when creating space expressions
     * @returns array of aggregated CQL expressions
     */
    function aggregate(expressions, spaceField) {

        var spaceTypeExpressions = _.filter(expressions, function (expression) {
            return expression.field.fieldName === 'space.type';
        });

        if (spaceTypeExpressions.length === 0) {
            // Nothing to aggregate, return.
            return expressions;
        }

        if (spaceTypeExpressions.length > 1) {
            throw Error("Only a single space.type expression is supported.");
        }

        var convertedExpression = spaceTypeExpressionConverter.convert(spaceTypeExpressions[0], spaceField);

        var spaceExpressions = _.filter(expressions, function (expression) {
            return expression.field.fieldName === 'space';
        });
        expressions = _.difference(expressions, spaceTypeExpressions);


        if (spaceExpressions.length) {
            // Combine the space type expression with the first space
            spaceExpressions[0] = combineSpaceExpressions(spaceExpressions[0], convertedExpression);
        } else {
            expressions.push(convertedExpression);
        }

        return expressions;
    }

    /**
     * Combines the values of a second expression into the values of a first one.
     *
     * It is assumed that the expressions need connecting with "OR"s and not with "AND"s.
     *
     * @returns a combined space CQL expression
     */
    function combineSpaceExpressions(expression1, expression2) {
        // TODO - could test for matching fieldNames...
        expression1.values = expression1.values.concat(expression2.values);
        return expression1;
    }

    return {
        aggregate: aggregate,
        combineSpaceExpressions: combineSpaceExpressions
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-set-value-helper.js' */
define('confluence-ui-components/js/cql/internal/cql-set-value-helper',
[
    'jquery'
],
/**
 * Sets values into a CQL filter input field and resolves the returned deferred object when the change event has been
 * fired on the input field, indicating it has resolved any ajax requests it needed to correctly populate the field
 */
function ($) {
    'use strict';

    function setValues($input, values) {
        var fieldDeferred = $.Deferred();
        $input.on('change', function() {
            fieldDeferred.resolve();
        });

        // sanitise `values` input as this can come from a url param and select2 val does not do any encoding.
        values = values.map(function(value) {
            return $('<div/>').text(value).html()
        });

        var triggerChangeEvent = true;
        $input.select2("val", values, triggerChangeEvent);
        return fieldDeferred;
    }

    return {
        setValues: setValues
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-date-expression-aggregator.js' */
define('confluence-ui-components/js/cql/internal/cql-date-expression-aggregator',
[
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-space-type-expression-converter'
],
/**
 * Takes multiple cql expressions for a single date field
 * (e.g. the parsed model for "created >= 2015-06-09 and created <= 2015-06-10")
 * and wraps them in a single expression that can be passed to the date filter field.
 */
function (
    _
) {
    'use strict';

    function nestExpression(expression) {
        return {
            field: expression.field,
            expressions: [expression]
        };
    }

    function aggregate(expressions) {

        var aggregated = [];
        var nestedExpressions = {};

        expressions.forEach(function (expression) {
            var fieldName = expression.field.fieldName;

            if (expression.field.type !== 'date') {
                // No-op : just copy the expression across.
                aggregated.push(expression);
            } else {
                if (!nestedExpressions[fieldName]) {
                    var nestedExpression = nestExpression(expression);
                    nestedExpressions[fieldName] = nestedExpression;

                    // Add to aggregated to maintain field order.
                    aggregated.push(nestedExpression);
                } else {
                    nestedExpressions[fieldName].expressions.push(expression);
                }
            }
        });

        return aggregated;
    }

    return {
        aggregate: aggregate
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define('confluence-ui-components/js/cql/internal/cql-negation-converter',
[
    'underscore'
],
/**
 * CqlNegationConverter takes CQL expressions that include negation queries (!= or notin)
 * and converts them to equality (= or in) queries with the -foo notation for the cql ui
 */
function (
    _
) {
    'use strict';

    function negateValues(expression) {
        expression.values = _.map(expression.values, function (value) {
            return "-" + value;
        });
    }

    /**
     * Converts expressions with exclusion operators to -foo exclusion notation
     *
     * @param expression CQL expression
     * @returns a CQL expression
     */
    function convert(expression) {
        var newExpression = $.extend({}, expression);
        if (newExpression.field.type === "equality") {
            if (newExpression.operator === "!=") {
                newExpression.operator = "=";
                negateValues(newExpression);
            } else if (newExpression.operator === "notin") {
                newExpression.operator = "in";
                negateValues(newExpression)
            }
        }
        return newExpression;
    }

    return {
        convert: convert
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define('confluence-ui-components/js/cql/internal/cql-negation-aggregator',
[
    'underscore',
    'confluence-ui-components/js/cql/internal/cql-negation-converter'
],
/**
 * Cql Negation Aggregator takes CQL expressions that include negation queries (!= or notin),
 * converts them to equality (= or in) queries with the -foo notation for the cql ui, and then
 * joins them with any existing equality queries.
 */
function (
    _,
    negationConverter
) {
    'use strict';

    /**
     * Aggregates expressions with exclusion operators.
     *
     * @param expressions an array of CQL expressions
     * @returns Array of CQL expressions
     */
    function aggregate(expressions) {
        // To maintain field order when creating final expression array.
        var orderedFieldNames = [];

        // Map of arrays of expressions, grouped by fieldName
        var expressionsMap = {};
        var negatedExpressionsMap = {};

        expressions.forEach(function(expression) {
            var fieldName = expression.field.fieldName;
            if (!_.contains(orderedFieldNames, fieldName)) {
                // First time this field has been encountered - add to array and init map values.
                orderedFieldNames.push(fieldName);
                expressionsMap[fieldName] = [];
                negatedExpressionsMap[fieldName] = [];
            }

            var converted = negationConverter.convert(expression);
            if (converted.operator !== expression.operator) {
                negatedExpressionsMap[fieldName].push(converted);
            } else {
                expressionsMap[fieldName].push(converted);
            }
        });

        // Mapping is complete; now collapse to an array.
        var result = [];
        orderedFieldNames.forEach(function(fieldName) {
            var combinedArray = combineArrays(expressionsMap[fieldName], negatedExpressionsMap[fieldName]);
            result = result.concat(combinedArray);
        });

        return result;
    }

    function combineArrays(plainExpressions, negatedExpressions) {
        if (!negatedExpressions.length) {
            return plainExpressions;
        }

        var firstExpression = plainExpressions[0];
        if (!firstExpression) {
            firstExpression = negatedExpressions[0];
            negatedExpressions = _.rest(negatedExpressions);
        }

        // Combine '-' values into the first expression.
        negatedExpressions.forEach(function (expression) {
            firstExpression.values = firstExpression.values.concat(expression.values);
        });

        if (firstExpression.operator === '=' && firstExpression.values.length > 1) {
            firstExpression.operator = 'in';
        }

        return [firstExpression].concat(_.rest(plainExpressions));
    }

    return {
        aggregate: aggregate
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ignored-field-expression-converter.js' */
define('confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter',
[],
/**
 * CqlIgnoredFieldExpressionConverter takes in CQL expressions and returns a subset of them removing fields we wish to
 * 'ignore'
 */
function () {
    'use strict';

    function filterExpressionByFieldName(expression, fieldNames, include) {
        if (fieldNames) {
            expression = expression.filter(function (expressionFragment) {
                if (fieldNames.indexOf(expressionFragment.field.fieldName) > -1) {
                    return include;
                }
                return !include;
            });
        }
        return expression;
    }

    /**
     * Gets fields from CQL expressions by field name
     *
     * @param expression CQL expression
     * @returns a CQL expression
     */
    function getFieldsByName(expression, fieldNames) {
       return filterExpressionByFieldName(expression, fieldNames, true);
    }

    /**
     * Removes fields from CQL expressions by field name
     *
     * @param expression CQL expression
     * @returns a CQL expression
     */
    function removeFieldsByName(expression, fieldNames) {
        return filterExpressionByFieldName(expression, fieldNames, false);
    }

    return {
        removeFieldsByName: removeFieldsByName,
        getFieldsByName: getFieldsByName
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define('confluence-ui-components/js/cql/cql-component',
[
    'jquery',
    'underscore',
    'ajs',
    'confluence-ui-components/js/cql/internal/cql-ajax',
    'confluence-ui-components/js/cql/internal/cql-filter-field',
    'confluence-ui-components/js/cql/internal/cql-filter-select',
    'confluence-ui-components/js/cql/internal/cql-field-model',
    'confluence-ui-components/js/cql/internal/cql-space-expression-aggregator',
    'confluence-ui-components/js/cql/internal/cql-date-expression-aggregator',
    'confluence-ui-components/js/cql/internal/cql-negation-aggregator',
    'confluence-ui-components/js/cql/internal/cql-ignored-field-expression-converter'
],
/**
 * A CQL-generating component that combines CQL Filter fields and an Add Filter button to display and store CQL
 * clauses.
 *
 * @tainted window.Confluence.UI.Components.CQL.Templates
 */
function(
    $,
    _,
    AJS,
    cqlAjax,
    filterField,
    filterSelect,
    fieldModel,
    spaceExpressionAggregator,
    dateExpressionAggregator,
    negationAggregator,
    ignoredFieldExpressionConverter
) {

    'use strict';

    var templates = window.Confluence.UI.Components.CQL.Templates;

    /**
     * Walks CQL-flagged fields in the Macro details form and aggregates the clauses.
     */
    function generateCqlMacroParamValue(fieldRegistry) {
        var clauses = [];
        _.each(fieldRegistry, function (fieldArray) {
            fieldArray.forEach(function (field) {
                if (!field) {
                    return;  // can happen if fields have been removed
                }

                var cqlClause = field.asCql();
                if (cqlClause) {
                    clauses.push(cqlClause);
                }
            });
        });

        return clauses.join(" and ");
    }

    function findFieldByFieldName(fields, fieldName) {
        return _.find(fields, function (item) {
            return item.fieldName === fieldName;
        });
    }

    function build(options) {

        var context = options.context || {
            environment: 'macro-browser'  // will be passed in the future, and this default can go
        };

        var defaultFieldNames = options.defaultFieldNames;
        if (!defaultFieldNames) {
            // TODO CRA-609 options.defaultFieldNames will be going away soon, at which this line
            // becomes the default assignment. dT
            defaultFieldNames = options.defaultFields ? options.defaultFields.split(',') : [];
        }

        var $cqlContainer = $(templates.container());
        if (options.container) {
            // Appending the container to the DOM early allows bindings up the DOM tree to be triggered as this
            // component is built.
            $(options.container).append($cqlContainer);
        }

        var cqlFieldsContainer = $cqlContainer.find('.cql-fields');

        // WARNING - async land! We need the field definitions and CQL clauses
        // before we can display their UI components successfully.
        var clauseREST;
        var cql = options.value || options.defaultValue;
        if (cql) {
            // Need to parse the CQL into fields we can display.
            clauseREST = cqlAjax.parseClauses(cql);
        } else {
            clauseREST = new $.Deferred();
            clauseREST.resolve();
        }

        var fieldRegistry = {};
        var ignoredFields = {};

        var loading = new $.Deferred();
        // Triggered when any CQL field changes, calls the callback function without the current CQL string value.
        // Call component.getValue to get the value as desired.
        var changeCallback = options.onChange || function() {};

        function removeField(fieldComponent) {
            var fieldName = fieldComponent.fieldName;
            fieldRegistry[fieldName] = _.without(fieldRegistry[fieldName], fieldComponent);
            if (fieldRegistry[fieldName].length === 0) {
                delete fieldRegistry[fieldName];
                changeCallback();
            }
        }

        // t is "this", the instance object to be returned from this builder.
        var t = {
            element: $cqlContainer,
            loading: loading,
            context: options.context || {
                // The place where this UI component is located, currently
                // 'macro-browser' or 'search-screen'
                environment: 'macro-browser',
                // The type of search results that are expected, currently
                // includes 'content', 'all', 'user', 'space'
                searchType: 'content'
            },

            /**
             * Return the CQL filter expressions represented by this components Filter fields.
             * @returns String
             */
            getValue: function() {
                return generateCqlMacroParamValue(fieldRegistry);
            },

            getIgnoredFields: function() {
                return ignoredFields;
            },

            removeField: removeField,

            // TODO - temp var to allow Steve demo without updating macro-browser.js in core
            fieldArrays: fieldRegistry,
            fieldRegistry: fieldRegistry
        };

        function addComponent(field) {
            var fieldComponent = filterField.build(field, t);

            fieldComponent.onChange(changeCallback);

            // Register the component
            var fieldName = field.fieldName;
            fieldRegistry[fieldName] = fieldRegistry[fieldName] || [];
            fieldRegistry[fieldName].push(fieldComponent);

            // Gives calling code a chance to manipulate the element before it is added to the DOM.
            $cqlContainer.trigger('cql-field-adding', fieldComponent);

            // Add to the UI
            var $lastMatchingField = cqlFieldsContainer.find('.cql-field-' + fieldName + ':last');
            if ($lastMatchingField.length) {
                // Put this field after other fields with the same name.
                $lastMatchingField.after(fieldComponent.element);
            } else {
                // First field with this name - add to end.
                cqlFieldsContainer.append(fieldComponent.element);
            }

            return fieldComponent;
        }

        // Retrieve a component from the registry - may return undefined.
        function getComponent(field, index) {
            index = index || 0;
            var fieldName = field.fieldName;

            return fieldRegistry[fieldName] && fieldRegistry[fieldName][index];
        }

        var fields;

        function loadClauses(clauses) {
            var loadClausesDeferred = $.Deferred();
            if (!clauses) {
                loadClausesDeferred.resolve();
                return loadClausesDeferred;
            }

            // To handle cases where the same field appears multiple times, e.g. "label = foo and label = bar"
            var clauseIndex = {};
            function nextClauseIndex(fieldName) {
                var index = clauseIndex[fieldName];
                if (typeof index === 'number') {
                    clauseIndex[fieldName] = index + 1;
                } else {
                    clauseIndex[fieldName] = 0;
                }
                return clauseIndex[fieldName];
            }

            // Existing data needs filling in the fields, and new fields may need to be added to the UI.

            // CQL expressions may not map 1-to-1 with UI fields, so perform any necessary aggregation.
            var spaceField = _.findWhere(fields, { fieldName: 'space' });
            clauses = spaceExpressionAggregator.aggregate(clauses, spaceField);
            clauses = dateExpressionAggregator.aggregate(clauses);
            clauses = negationAggregator.aggregate(clauses);
            ignoredFields = ignoredFieldExpressionConverter.getFieldsByName(clauses, options.ignoredFields);
            clauses = ignoredFieldExpressionConverter.removeFieldsByName(clauses, options.ignoredFields);

            var fieldDeferreds = [];
            _.each(clauses, function (clause) {
                /* Clause object has: field, values, e.g.
                 {
                     field: {
                         fieldName: "label",
                         type: "equality",
                         valueType: "label",
                         supportedOps: [ ]
                     },
                     values: [
                        "foo"
                     ]
                 }
                 */
                var fieldName = clause.field.fieldName;

                // Find the "real" field in the field map because the field returned from the clause parser
                // doesn't include i18n information.
                var field = findFieldByFieldName(fields, fieldName);

                // Some fields like "Label" may appear multiple times. Add new components as necessary.
                var index = nextClauseIndex(fieldName);
                var fieldComponent = getComponent(field, index) || addComponent(field);

                // The clause may hold values in multiple properties (e.g. functionValues) so pass in the whole
                // thing.
                var fieldDeferred = fieldComponent.setValues(clause);
                // Field components return a deferred which is resolved when values are set
                if (fieldDeferred) {
                    fieldDeferreds.push(fieldDeferred);
                }
            });

            // Once all fields have resolved their deferred calls, resolve our own deferred object
            $.when.apply($, fieldDeferreds).then(function () {
                loadClausesDeferred.resolve();
            });
            return loadClausesDeferred;
        }

        function showError(failedCql) {
            var title, body;
            if (failedCql) {
                // Failed during CQL parse AJAX
                var escapedCql = _.escape(failedCql);  // nice try, XSS fiend!
                title = "We can\'t load your filters";
                body = AJS.format("Curses! We had trouble with \"{0}\". Try refreshing the page, but you may need to re-enter your macro parameters.", escapedCql);
            } else {
                // Failed during field lookup, super-rare.
                title = "We couldn\'t load the macro";
                body = "If you refresh your page, we\'ll give it another shot.";
            }
            AJS.messages.error(".cql-error-container", {
                title: title,
                body: body,
                closeable: true
            });
        }

        /*
            Activate a newly-created field.
         */
        function focusComponent(fieldComponent) {

            // Multi select fields are triggered by a click event on the inner <input> element
            // Single select fields are triggered via a mousedown event on the inner <a> element
            var $input;
            // Pick list, don't focus the input field
            if (fieldComponent.element.find('.aui-nav-selected').length !== 0) {
                return;
            }
            if (fieldComponent.element.find(".select2-container-multi").length !== 0) {
                // Select2 multi-select
                $input = fieldComponent.element.find('input.select2-input');
                // focus() is required because not all fields response to the click trigger.
                $input.focus().click();
            } else {
                // Select2 single-select
                $input = fieldComponent.element.find('a.select2-choice.select2-default');
                if (!$input.length) {
                    // Just a text or other input field?
                    $input = $(':input:visible', fieldComponent.element).first();
                }
                if (!$input.length) {
                    AJS.log("Unable to focus CQL field: " + fieldComponent.fieldName);
                }
                $input.focus().mousedown();
            }
        }

        /*
            Called when a selection is made from the filterSelect component. Adds the new field and focuses it.
         */
        function fieldSelectedForAddition(field) {
            // Fields added from the filter-select can always be removed again - they are not fixed.
            var unfixed = $.extend({}, field, { fixed: false });
            var fieldComponent = addComponent(unfixed);

            focusComponent(fieldComponent);
        }

        function loadFields(result) {

            // Get the fields into a scope that other functions can access.
            fields = result;

            defaultFieldNames.forEach(function(fieldName) {
                var field = findFieldByFieldName(fields, fieldName);
                if (!field) {
                    throw Error("Unknown fieldname: " + fieldName);
                }

                // Default fields cannot be removed from the UI. Deep clone the common field so that other instances
                // of this field aren't set as fixed.
                var fixedField = JSON.parse(JSON.stringify(field));
                fixedField.fixed = true;

                // Override label for default CQL label fields
                if (fixedField.fieldName === "label") {
                    fieldModel.setLabel(fixedField, "Add label(s)");
                }
                addComponent(fixedField);
            });

            filterSelect.build({
                onSelection: fieldSelectedForAddition,
                cqlContainer: $cqlContainer,
                context: context,
                ignoredFields: options.ignoredFields
            });

            // The clause AJAX may already be resolved but we delay the callback until the fields are known.
            clauseREST
                .done(function (clauses) {
                    loadClauses(clauses).done(function () {
                        loading.resolve();
                    })
                })
                .fail(function() {
                    // On the search screen don't hit the user with multiple error messages when the CQL in the
                    // URL cannot be parsed: they'll get a parse error message in the search result area.
                    if (context.environment === 'search-screen') {
                        AJS.log("Error parsing CQL param from search screen URL: " + options.value);
                    } else {
                        showError(options.value);
                    }
                    loading.resolve();
                });
        }

        cqlAjax.getFields()
            .done(loadFields)
            .fail(function() {
                showError();
            });

        return t;
    }

    return {
        build: build
    };

});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:avatar2', location = 'user-select2/avatar.soy' */
// This file was automatically generated from avatar.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithName = function(opt_data, opt_ignored) {
  return '' + ((opt_data.accountId) ? aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-account-id': opt_data.accountId}}) : (opt_data.userId) ? aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-account-id': opt_data.userId}}) : '') + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithName.soyTemplateName = 'CreateContent.avatar.avatarWithName';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:avatar-account-id', location = 'user-select2/avatar-account-id.soy' */
// This file was automatically generated from avatar-account-id.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace CreateContent.avatar.
 */

if (typeof CreateContent == 'undefined') { var CreateContent = {}; }
if (typeof CreateContent.avatar == 'undefined') { CreateContent.avatar = {}; }


CreateContent.avatar.avatarWithNameAccountId = function(opt_data, opt_ignored) {
  return '' + ((opt_data.accountId) ? aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-account-id': opt_data.accountId}}) : (opt_data.userId) ? aui.avatar.avatar({size: opt_data.size, avatarImageUrl: opt_data.avatarImageUrl, accessibilityText: opt_data.displayName, title: opt_data.displayName, extraAttributes: {'data-account-id': opt_data.userId}}) : '') + soy.$$escapeHtml(opt_data.displayName);
};
if (goog.DEBUG) {
  CreateContent.avatar.avatarWithNameAccountId.soyTemplateName = 'CreateContent.avatar.avatarWithNameAccountId';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:user-multiselect2', location = 'user-select2/user-multiselect.js' */
/* eslint confluence/matching-tests:0 */
define('confluence-create-content-plugin/plugin/user-select2/user-multiselect', [
    'jquery',
    'ajs',
    'document',
    'confluence/meta',
    'confluence/api/constants'
], function(
    $,
    AJS,
    document,
    Meta,
    CONSTANTS
) {
    "use strict";

    /**
     * Locates inputs marked as autocompletes in the container and initialises them.
     *
     * @param scope to find unbound autocomplete inputs in
     * @param isMultiple bool type, to determine it's multi-selection or single-selection input.
     */
    return function(scope, isMultiple) {
        scope = scope || document.body;
        var multiple = (typeof isMultiple !== 'undefined') ? isMultiple : true;
        var showNoResultsIfAllResultsDisabled = function() {
            var $results = $('.select2-drop-active > .select2-results');
            if ($results.children('.select2-result-selectable').length === 0 &&
                $results.children('.select2-disabled').length) {

                $results.append('<li class="select2-no-results">' +
                    AJS.escapeHtml("No matches found") + '</li>');
            }
        };

        var className = multiple ? ".autocomplete-multiuser" : ".autocomplete-singleuser";
        $("input" + className +"[data-autocomplete-bound != 'true']", scope).each(function() {
            var picker = $(this);

            picker.auiSelect2({
                multiple: multiple,
                minimumInputLength: 2,
                formatInputTooShort: function () {
                    return "Start typing to search for a user";
                },
                ajax: {
                    transport: function(opts) {
                        // Workaround for Select2 bug: https://github.com/ivaynberg/select2/issues/381
                        // Select2 does not display "no results found" if the only results are already selected.
                        var success = opts.success;
                        delete opts.success;
                        return $.ajax.apply($.ajax, arguments).done(success).done(showNoResultsIfAllResultsDisabled);
                    },
                    data: function (searchTerm) {
                        return {
                            limit: 6,
                            cql: "user.fullname~\"" + searchTerm + "\""
                        };
                    },
                    dataType: 'json',
                    url: Confluence.getContextPath() + "/rest/api/search",
                    results: function (data) {
                        // Should be a $.map or something fancy. dT
                        var results = [];
                        $.each(data.results, function () {
                            results.push({
                                accountId: this.user.accountId,
                                id: this.user.accountId,
                                text: this.user.displayName,
                                imgSrc: this.user.profilePicture.path || CONSTANTS.CONTEXT_PATH + "/images/icons/profilepics/default.png"
                            });
                        });
                        return {
                            results: results
                        };
                    },
                    quietMillis: 300
                },
                formatResult: function (result) {
                    var avatarObject = {
                        size: 'small',
                        displayName: result.text,
                        userId: result.id,
                        avatarImageUrl: result.imgSrc,
                        accountId: result.accountId
                    };

                    return CreateContent.avatar.avatarWithNameAccountId(avatarObject);
                },
                // common.Widget.avatarWithName handles escaping so this doesn't have to
                escapeMarkup: function (markup) {
                    return markup;
                },
                formatSelection: function(result) {
                    var avatarObject = {
                        size: 'xsmall',
                        displayName: result.text,
                        userId: result.id,
                        avatarImageUrl: result.imgSrc,
                        accountId: result.accountId
                    };

                    return CreateContent.avatar.avatarWithNameAccountId(avatarObject);
                },
                dropdownCssClass: 'users-dropdown',
                containerCssClass: 'users-autocomplete',
                hasAvatar: true
            });

            // Logged in user will appear by default if this attribute is defined
            if (!picker.data("autofill-user"))
                return;

            var loggedInUser = Meta.get('remote-user'),
                accountId = Meta.get('atlassian-account-id'),
                loggedInUserFullName = Meta.get('current-user-fullname'),
                loggedInUserAvatarUrl = Meta.get('current-user-avatar-url');

            if (accountId && loggedInUserFullName && loggedInUserAvatarUrl) {
                var userObj = {
                    accountId: accountId,
                    id: accountId,
                    text: loggedInUserFullName,
                    imgSrc: CONSTANTS.CONTEXT_PATH + loggedInUserAvatarUrl
                };
                picker.auiSelect2('data',
                    multiple ? [userObj] : userObj
                );
            }
        });
    };
});

require('confluence/module-exporter').exportModuleAsGlobal('confluence-create-content-plugin/plugin/user-select2/user-multiselect', 'Confluence.Binder.autocompleteMultiUser', function(UserMultiSelect) {
    Confluence.Binder.autocompleteMultiUser = UserMultiSelect;
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
define("confluence-macro-browser/macro-parameter-serializer",["jquery"],function(h){function g(c){return c.replace(/\\/g,"\\\\").replace(/=/g,"\\\x3d").replace(/[|]/g,"\\|")}return{serialize:function(c){var d=[],a;for(a in c)d.push(g(a)+"\x3d"+g(c[a]));return d.join("|")},deserialize:function(c){function d(b,c){var a=[],d=[],e;b=b||"";for(var f=0,g=b.length;f<g;f++)e=b[f],"\\"==e?a.push(e+(f+1!=b.length?b[++f]:"")):e==c?(d.push(a.join("")),a=[]):a.push(e);d.push(a.join(""));return d}var a={};h.each(d(c||
"","|"),function(b,c){b=d(c,"\x3d");2===b.length&&b[0]&&(a[b[0].replace(/\\(.)/g,"$1")]=b[1].replace(/\\(.)/g,"$1"))});return a}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-parameter-serializer","Confluence.MacroParameterSerializer");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
define("confluence-macro-browser/macro-browser-fields","ajs jquery underscore confluence/legacy confluence/templates confluence/autocomplete-content confluence/api/logger confluence/api/constants confluence/meta confluence/dark-features confluence-create-content-plugin/plugin/user-select2/user-multiselect".split(" "),function(q,e,y,z,n,r,t,u,v,A,w){function x(m,l,p){return function(h,b){if(h.multiple)return m.string(h,b);h=e(n.MacroBrowser.macroParameterSelect());var a=e("select",h);b=b||{};b.setValue=
b.setValue||function(b){var d=!1;a.find("option").each(function(){if(this.value==b)return d=!0,!1});d?delete a.tempValue:(a.append(e("\x3coption/\x3e").attr("value",b).text(b+" ("+"Not found"+")")),a.tempValue=b);try{a.val(b)}catch(f){t.logError(f)}a.change()};h=l(h,a,b);h.updateDependencies=p;h.getData=function(c,d){if(c.title&&c.spaceKey||c.pageId){var f=a.tempValue||a.val();b.fileTypes&&(c.fileTypes=b.fileTypes);e.getJSON(u.CONTEXT_PATH+"/json/attachmentsearch.action",
c,function(c){if(!c.error){e("option",a).remove();if((c=c.attachments)&&c.length){for(var g=0,k=c.length;g<k;g++)a.append(e("\x3coption/\x3e").attr("value",c[g].name).text(c[g].name));f=f||a.tempValue;b.setValue(f||c[0].name)}else a.append(e("\x3coption/\x3e").attr("value","").html("No appropriate attachments")),a.tempValue&&b.setValue(a.tempValue);a.attr("style","");d&&d()}})}else t.log("Not enough parameters to send attachmentsearch request")};return h}}return function(m){var l=
function(b,a,c){c=c||{};var d=c.setValue||function(b){a.val(b)},e=c.getValue||function(){return a.val()};a.change(c.onchange||m.paramChanged);return{paramDiv:b,input:a,setValue:d,getValue:e}},p=function(b,a,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++)m.fields[a[d]]&&m.fields[a[d]].dependencyUpdated(b,c)},h={updateDependencies:p,username:function(b,a){function c(a){return{id:a,text:"Former user",imgSrc:d}}a=a||{};var d=u.CONTEXT_PATH+"/images/icons/profilepics/default.png",f=b.multiple?"autocomplete-multiuser":
"autocomplete-singleuser",k=e(n.MacroBrowser.macroParameter()),g=e("input[type\x3d'text']",k);g.addClass(f).attr("data-none-message","Not found");b.required&&g.keyup(m.processRequiredParameters);b.multiple?(w(k,!0),a.setValue=function(a){g.val(a);a=a.split(",");for(var b=[],k=[],f=0,h=a.length;f<h;f++)b.push(function(a){return e.getJSON(u.CONTEXT_PATH+"/rest/api/user?accountId\x3d"+a).done(function(b){b&&b.accountId?k.push({id:b.accountId,text:b.displayName,
imgSrc:b.profilePicture.path||d}):k.push(c(a))}).fail(function(b){t.logError("Cannot parse user data for macro browser field with: "+b);k.push(c(a))})}(a[f]));e.when.apply(e,y.map(b,function(a){var b=e.Deferred();a.always(function(){b.resolve()});return b.promise()})).done(function(){k.length&&g.auiSelect2("data",k)})}):(w(k,!1),a.setValue=function(a){g.val(a);e.getJSON(u.CONTEXT_PATH+"/rest/api/user?accountId\x3d"+a).done(function(b){b&&b.accountId?g.auiSelect2("data",{id:b.accountId,text:b.displayName,
imgSrc:b.profilePicture.path||d}):g.auiSelect2("data",c(a))}).fail(function(b){t.logError("Cannot parse user data for macro browser field with: "+b);g.auiSelect2("data",c(a))})},g.bind("selected.autocomplete-content",function(d,c){if(a.onselect)a.onselect(c.selection);else p(b.name,a.dependencies,g.val()),"function"===typeof a.onchange&&a.onchange.apply(g)}));return l(k,g,a)},spacekey:function(b,a){if(b.multiple)return h.string(b,a);a=a||{};var c=e(n.MacroBrowser.macroParameter()),d=e("input[type\x3d'text']",
c);d.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&d.keyup(m.processRequiredParameters);d.bind("selected.autocomplete-content",function(c,k){if(a.onselect)a.onselect(k.selection);else a.setValue?a.setValue(k.content.key):(p(b.name,a.dependencies,d.val()),"function"===typeof a.onchange&&a.onchange.apply(d))});r.autocompleteSpace(c);return l(c,d)},attachment:x(h,l,p),full_attachment:x(h,l,p),"confluence-content":function(b,
a){if(b.multiple)return h.string(b,a);a=a||{};b.options=b.options||{};var c=e(n.MacroBrowser.macroParameter()),d=e("input[type\x3d'text']",c).attr("data-none-message","Not found").attr("data-template","");b.required&&d.keyup(m.processRequiredParameters);a.onchange=a.onchange||function(c){c=d.val();p(b.name,a.dependencies,c)};a.setValue=a.setValue||function(b){d.val(b);"function"===typeof a.onchange&&a.onchange.apply(d)};d.bind("selected.autocomplete-content",
function(c,e){c="";"true"==b.options.includeDatePath&&"blogpost"===e.content.type&&(c=e.content.createdDate.date.split("-"),c="/"+c[0]+"/"+c[1]+"/"+c[2].substring(0,2)+"/");var g=e.content.space&&e.content.space.key,f=g&&g!=v.get("space-key");-1!==e.content.title.indexOf(":")&&(f=!0);c=(f?g+":":"")+c+e.content.title;d.val(c);if(a.onselect)a.onselect(e.selection);else a.setValue(c,d)});b.options.spaceKey&&("@self"===b.options.spaceKey.toLowerCase()&&(b.options.spaceKey=v.get("space-key")),d.attr("data-spacekey",
b.options.spaceKey));null!=a.truncateTitle&&d.attr("data-truncate",a.truncateTitle);var f=b.options.type;if("string"===typeof f)if("page"===f)d.addClass("autocomplete-page"),r.autocompletePage(c);else if("blogpost"===f)d.addClass("autocomplete-blogpost"),r.autocompleteBlogpost(c);else{if("attachment"===f||"full_attachment"===f)d.addClass("autocomplete-attachment"),r.autocompleteAttachment(c)}else d.addClass("autocomplete-confluence-content"),r.autocompleteConfluenceContent(c);return l(c,d,a)},string:function(b,
a){var c=e(n.MacroBrowser.macroParameter()),d=e("input",c);b.required&&d.keyup(m.processRequiredParameters);return l(c,d,a)},"boolean":function(b,a){var c=e(n.MacroBrowser.macroParameterBoolean()),d=e("input",c);a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&d.prop("checked",!0)};return l(c,d,a)},"enum":function(b,a){if(b.multiple)return h.string(b,a);var c=e(n.MacroBrowser.macroParameterSelect()),d=e("select",c);b.required||b.defaultValue||
d.append(e("\x3coption/\x3e").attr("value",""));var f=function(a,b){b.value&&b.label?a.append(e("\x3coption/\x3e").attr("value",b.value).html(""+b.label)):a.append(e("\x3coption/\x3e").attr("value",b).html(""+b))};e(b.enumValues).each(function(){if(this.items){var a=e("\x3coptgroup /\x3e").attr("label",this.label);d.append(a);this.items.forEach(function(b){f(a,b)})}else f(d,this)});a&&a.auiSelect&&d.auiSelect2(a.auiSelect);return l(c,d,a)},_hidden:function(b,a){b=e(n.MacroBrowser.macroParameterHidden()).hide();
var c=e("input",b);return l(b,c,a)}};return{Field:l,ParameterFields:h}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-fields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
define("confluence-macro-browser/macro-browser-smartfields",["ajs","confluence/macro-js-overrides"],function(c,g){return function(h,f){var d=function(a){this.fileTypes=a};d.prototype.beforeParamsSet=function(a,b){a.page||a.date||a.space||("page"==c.params.contentType||"blogpost"==c.params.contentType?a.page=c.Editor.getCurrentTitle():"comment"==c.params.contentType&&(a.page=c.params.pageTitle));a.date&&(b=a.date.split("/"),a.page=["",b[2],b[0],b[1],a.page].join("/"));a.space&&(a.page=a.space+":"+
a.page);return a};d.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==c.params.contentType||"blogpost"==c.params.contentType)&&a.page==c.Editor.getCurrentTitle()||"comment"==c.params.contentType&&a.page==c.params.pageTitle)&&delete a.page}return a};d.prototype.fields={attachment:function(a){a=f.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=
function(a,e){c.debug("attachment:dependencyUpdated called: "+a+", "+e);a=d.prototype.fields._parsePageLink(e);this.getData(a)};return a},full_attachment:function(a){a=f.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,e){c.debug("attachment:dependencyUpdated called: "+a+", "+e);a=d.prototype.fields._parsePageLink(e);this.getData(a)};return a},"confluence-content":function(a){return f["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b={};
a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||c.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===c.Editor.getCurrentTitle()&&(b.title="");b.title||(b.pageId=c.Meta.get("content-id"));return b}};h.activateSmartFieldsAttachmentsOnPage=function(a,b){g.put(a,new d(b))}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-smartfields");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
define("confluence-macro-browser/macro-browser-utils",["jquery"],function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-utils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-cql.js' */
define("confluence-macro-browser/macro-browser-cql",["ajs","underscore","confluence/templates","confluence-ui-components/js/cql/cql-component","jquery"],function(k,h,m,n,d){function e(b){var a=b.param;return d.extend({},b,a.options,{defaultValue:a.defaultValue||a.options.defaultValue})}function p(b){b=e(b);return n.build(b)}function l(b){return d(m.MacroBrowser.CQL.sections({hasRenderParameters:0<b.renderParams.length}))}return{build:function(b){var a=l(b),f=b.container;f.append(a);f.bind("cql-field-adding",
function(b,c){c.element.addClass("macro-param-div");c.element.find(".cql-field-input").addClass("macro-param-input")});f.addClass("loading");a.filter(".cql-render-heading").find("button").click(function(){var b=d(this),c=b.closest(".cql-render-heading").next(),a=c.is(":visible");a?c.slideUp(300):(c.removeClass("hidden").show(),c=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:c},300));a=a?"More options":"Hide options";
b.text(a)});var g=p({param:b.cqlParam,value:b.cqlValue,container:a.filter(".cql-filter-fields")});f.data("cqlComponent",g);var e=d.Deferred();g.loading.done(function(){var a=b.cqlParam.options.requiredFields;if(a){var c=a.split(",");h.each(g.fieldRegistry||g.fieldArrays,function(a){var d=!1;h.each(a,function(a){!d&&h.contains(c,a.fieldName)&&(b.flagRequiredParam(a.element),d=!0,a.onChange(b.paramChanged))})})}f.removeClass("loading");e.resolve()});return{elements:a,loading:e}},_makeCqlComponentOptions:e,
_renderCqlSections:l}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser-cql.soy' */
// This file was automatically generated from macro-browser-cql.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.CQL.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }
if (typeof Confluence.Templates.MacroBrowser.CQL == 'undefined') { Confluence.Templates.MacroBrowser.CQL = {}; }


Confluence.Templates.MacroBrowser.CQL.sections = function(opt_data, opt_ignored) {
  return '<div class="cql-filter-fields"></div>' + ((opt_data.hasRenderParameters) ? '<div class="cql-render-heading cql-options-link">' + aui.buttons.button({type: 'link', text: 'More options', extraAttributes: {type: 'button'}}) + '</div><div class="cql-render-fields hidden"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.CQL.sections.soyTemplateName = 'Confluence.Templates.MacroBrowser.CQL.sections';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
define("confluence-macro-browser/macro-browser-editor","window ajs jquery confluence/templates confluence-macro-browser/macro-browser-cql confluence/macro-js-overrides underscore".split(" "),function(v,q,e,t,y,u,w){return function(c){function r(g){var a=e("#macro-insert-container").find(".macro-name").val(),b,h={},d=g.formDetails,f;f={};for(var n=0,p=g.formDetails.parameters.length;n<p;n++){var l=g.formDetails.parameters[n],k;if(l.type&&"cql"===l.type.name)k=e(".macro-input-fields form").data("cqlComponent").getValue();
else{k=e("#macro-param-"+l.name);var m=k.val();"checkbox"==k.attr("type")&&(m=""+k.prop("checked"));k=m}k&&(l.shared&&(h[l.name]=k),l.hidden||!l.defaultValue||l.defaultValue!=k)&&(f[l.name]=k)}f[""]&&(b=f[""]);e.extend(f,c.unknownParams);c.isInFabricEditor()&&d.body&&"PLAIN_TEXT"===d.body.bodyType&&(f.__bodyContent=c.getMacroBody());d=f;(f=u.getFunction(a,"beforeParamsRetrieved"))&&(d=f(d,g,h));f=d;return{name:a,bodyHtml:c.getMacroBody(),params:f,schemaVersion:g.formDetails.schemaVersion?g.formDetails.schemaVersion:
"",defaultParameterValue:b}}function z(g,a){var b=e(t.MacroBrowser.macroBody());a=a?a.body:c.settings.selectedText;e("textarea",b).val(a||"");g.label&&e("label",b).text(g.label);g.description&&b.append(t.MacroBrowser.macroParameterDesc({description:g.description}));g.hidden&&b.hide();return b}function A(g,a,b){var h,d=a.type.name;if(b){var f=b.fields&&b.fields[d];f&&"function"!==typeof f&&(f=f[a.name]);"function"===typeof f&&(h=f.call(b,a))}h||(d in c.ParameterFields&&"function"===typeof c.ParameterFields[d]||
(d="string"),h=c.ParameterFields[d](a));c.fields[a.name]=h;b=h.paramDiv;d=h.input;h="macro-param-"+a.name;b.attr("id","macro-param-div-"+a.name);d.addClass("macro-param-input").attr("id",h);a.hidden&&b.hide();d=g.pluginKey;a.displayName==c.Utils.makeDefaultKey(d,g.macroName,"param",a.name,"label")&&(a.displayName=a.name);a.description==c.Utils.makeDefaultKey(d,g.macroName,"param",a.name,"desc")&&(a.description="");e("label",b).attr("for",h).text(a.displayName);a.required&&x(b);a.description&&b.append(t.MacroBrowser.macroParameterDesc({description:a.description}));
return b}function x(c){var a=c.find("label"),b=e("\x3cspan /\x3e").addClass("require-asterisk").text("*");a.append(b);c.attr("aria-required",!0);c.addClass("required")}return{loadMacroInBrowser:function(g,a){if(g&&g.formDetails){var b;b=g.formDetails;var h=b.macroName,d=u.get(h),f=c.settings.selectedMacro,n=(a=v.tinymce)&&a.confluence&&a.confluence.macrobrowser&&a.confluence.macrobrowser.editedMacroDiv;if(d&&"function"===typeof d.opener)c.close(),d.opener({name:h});else{a=b.parameters;var p=w.find(a,
function(a){return"cql"===a.type.name});d&&"function"===typeof d.parameters&&(a=d.parameters(a));e("#save-warning-span").addClass("hidden");e("#macro-insert-container .macro-name").val(h);var l=e("#macro-insert-container .macro-input-fields form");l.empty();var k=g.extendedDescription||g.description;u.isDeprecated(h)&&(k=k+"\x3cdiv id\x3d'macro-deprecation-desc'\x3e "+"This macro has been deprecated. \u003ca href=\"https://support.atlassian.com/confluence-cloud/docs/learn-which-macros-are-being-removed/\"\u003eFind out more about this change\u003c/a\u003e"+"\x3c/div\x3e");!b.documentationLink||d&&d.hideHelpLink||c.UI.setHelpLink(c.dialog,
{href:b.documentationLink});k&&(k=e(t.MacroBrowser.macroDescription({descriptionHtml:k,showDescriptionHelp:d&&d.showDescriptionHelp,descriptionHelpLink:b.documentationLink})),l.append(k));e("#macro-insert-container").data("macro-detail",b);c.isInFabricEditor()&&b.body&&"PLAIN_TEXT"===b.body.bodyType?(e("#macro-insert-container #macro-preview-container").hide(),e("#macro-insert-container #macro-body-editor-container").show(),b=f&&f.params&&"string"===typeof f.params.__bodyContent?f.params.__bodyContent:
"",e("#macro-insert-container #macro-body-editor-container textarea").val(b)):(e("#macro-insert-container #macro-preview-container").show(),e("#macro-insert-container #macro-body-editor-container").hide(),b.body&&"NONE"!=b.body.bodyType&&n&&e(n).hasClass("editor-inline-macro")&&(n=g.pluginKey,b.body.label==c.Utils.makeDefaultKey(n,h,"body","label")&&(b.body.label=""),b.body.description==c.Utils.makeDefaultKey(n,h,"body","desc")&&(b.body.description=""),(b=z(b.body,c.selectedMacroDefinition))&&l.append(b)));
var m=f?e.extend({},f.params):{},r=l;p&&(a=w.without(a,p),p=y.build({cqlParam:p,renderParams:a,cqlValue:m.cql,container:l,flagRequiredParam:x,paramChanged:c.paramChanged}),delete m.cql,r=p.elements.filter(".cql-render-fields"),p.loading.done(function(){c.paramChanged();c.Preview.previewMacro(g,f)}));e(a).each(function(){r.append(A(g,this,d))});d&&"function"===typeof d.beforeParamsSet&&(m=d.beforeParamsSet(m,!f));e(a).each(function(a,b){a=function(){var a;a=""==b.name?c.selectedMacroDefinition?c.selectedMacroDefinition.defaultParameterValue:
b.defaultValue:m[b.name];null!=a?delete m[b.name]:e(b.aliases).each(function(){m[this]&&(a=m[this],delete m[this])});null==a&&(a=b.defaultValue);null!=a&&c.fields[b.name].setValue(a)};if("attachment"===b.type.name){var d=c.fields&&c.fields[b.name]&&c.fields[b.name].getData;d&&d({spaceKey:q.params.spaceKey,pageId:q.params.pageId},a)}else a()});c.unknownParams=m;e("a",l).click(function(){v.open(this.href,"_blank").focus();return!1});e("#macro-browser-dialog:visible").length||c.showBrowserDialog();a=
{};e.extend(!0,a,g);a.formDetails||(a.formDetails={});a.formDetails.body||(a.formDetails.body={});c.dialog.activeMetadata=a;c.settings.selectedMacro?a.formDetails.body.content=c.settings.selectedMacro.body:a.formDetails.body.bodyType&&"plain_text"===a.formDetails.body.bodyType.toLowerCase()?a.formDetails.body.content=c.settings.selectedText:a.formDetails.body.content=c.settings.selectedHtml}}else alert("Could not load unknown macro in the macro browser.")},getMacroParametersFromForm:function(c){return r(c).params},
getMacroDefinitionFromForm:r,processRequiredParameters:function(){if(e(".macro-input-fields form").is(".loading"))return q.log("Form still loading - cannot processRequiredParameters"),!1;var c=0===e("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=e(this).val();return null===a||""===a}).length,a=c?"":"disabled",b=a?"addClass":"removeClass";e("#macro-browser-dialog button.ok").prop("disabled",a);e("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",
a)[b]("disabled");return c}}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-editor");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
define("confluence-macro-browser/macro-browser-preview",["jquery","ajs","confluence/macro-js-overrides","confluence/get-content-id"],function(e,f,k,n){return function(d){function g(){return e("#macro-insert-container .macro-preview")}function p(){var b=f.params.staticResourceUrlPrefix+"/blank.html";g().html('\x3ciframe src\x3d"'+b+'" frameborder\x3d"0" name\x3d"macro-browser-preview-frame" id\x3d"macro-preview-iframe"\x3e\x3c/iframe\x3e')}function l(){g().html("")}function q(b,c){var a=g().find("iframe")[0],
d=k.getFunction(b.macroName,"updateMacroPreviewIframe");d&&d(b,a,c)||(a=a.contentDocument||a.contentWindow.document,f&&f.DarkFeatures&&f.DarkFeatures.isEnabled("confluence_sanitize_macro_preview_xss")&&"gadget"!==b.macroName?(b=(new DOMParser).parseFromString(c,"text/html"),b.body.innerHTML=DOMPurify.sanitize(b.body.innerHTML,{USE_PROFILES:{html:!0}}),a.write(b.documentElement.innerHTML)):a.write(c),a.close(),e(a).ready(function(){f.trigger("macro-browser.preview-ready")}),e("div.error span.error",
a).length&&f.logError("Error rendering macro definition : "))}function h(b){b?(d.UI.showPreviewSpinner(!0),m.disable()):(d.UI.showPreviewSpinner(!1),m.enable())}var m={disable:function(){e("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){e("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};return{previewMacro:function(b,c){l();if(!d.Editor.processRequiredParameters())return f.log("previewMacro: missing required params"),!1;"object"!==
typeof c&&(c=d.Editor.getMacroDefinitionFromForm(b));var a=c.params,e=k.getFunction(b.macroName,"updateMacroParametersForPreview");e&&(a=e(a));a[""]&&delete a[""];c={contentId:n(),macroName:b.macroName,params:a,body:d.getMacroBody(),defaultParameterValue:c.defaultParameterValue,successCallback:function(a){q(b,a);setTimeout(function(){h(!1)},1E3)},errorCallback:function(a){f.logError(a);h(!1)}};p();h(!0);d.Rest.fetchMacroPreviewData(c)},removePreviewContainer:l}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preview");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
define("confluence-macro-browser/macro-browser-model",["underscore"],function(h){return function(b){function e(a){a.title==b.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==b.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var c=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=c.join(",");var f=a.description&&
a.description.replace(/,/g," ")||"";c.push(f);a.keywords=c.join(",");return a}function g(a,c){if(c.aliases)for(var b=0,d=c.aliases.length;b<d;b++)c.aliases[b]=c.aliases[b].toLowerCase(),a[c.aliases[b]]=c.macroName.toLowerCase()}return{loadMacros:function(a){if(a){b.metadataList=[];b.aliasMap={};for(var c=0,f=a.length;c<f;c++){var d=a[c],d=e(d);g(b.aliasMap,d);b.metadataList.push(d)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else console.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
addMacro:function(a){if(a){var c=e(a);g(b.aliasMap,c);(a=h.find(b.metadataList,function(a){return a.macroName===c.macroName}))?(a=b.metadataList.indexOf(a),b.metadataList[a]=c):b.metadataList.push(c);b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else console.log("AJS.MacroBrowser.addModel - no macro data, aborting")},transformMetaDataDefault:e}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-model");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
define("confluence-macro-browser/macro-browser-rest",["jquery","ajs","wrm","confluence/api/constants"],function(c,d,g,e){function b(a){d.logError(a)}return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.t="12";a.data.spaceKey=d.Meta.get("space-key");return c.ajax({type:"GET",timeout:a.timeout||3E4,dataType:"json",url:(a.context||e.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros.action",data:a.data,headers:a.forceUpdateCache?{"Cache-Control":"no-cache"}:{},success:a.successCallback,error:a.errorCallback||
b}).promise()},fetchMacroMetadataDetails:function(a){var f={id:a.id,spaceKey:d.Meta.get("space-key")};a.alternateId&&(f.alternateId=a.alternateId);c.ajax({type:"GET",dataType:"json",url:(a.context||e.CONTEXT_PATH)+"/plugins/macrobrowser/browse-macros-details.action",data:f,success:a.successCallback,error:a.errorCallback||b})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||b)("invalid parameters");c.ajax({type:"POST",contentType:"application/json; charset\x3dutf-8",
url:(a.context||e.CONTEXT_PATH)+"/rest/tinymce/1/macro/preview",data:JSON.stringify({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||b})}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-rest");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
define("confluence-macro-browser/macro-browser-UI","jquery ajs confluence/templates confluence/api/constants confluence/dom-filter-field confluence/meta confluence/dialog".split(" "),function(d,e,k,r,t,u,v){return function(l){function p(a){return d(k.MacroBrowser.macroSummaryList({category:a}))}function n(a,c){var b=d(k.MacroBrowser.macroSummaryItem());if(a.icon){var g=(a.icon.relative?e.params.staticResourceUrlPrefix:"")+a.icon.location;!a.icon.relative&&d.browser.msie&&!window.location.href.indexOf("https")&&
g.indexOf("https")?b.prepend("\x3cspan class\x3d'macro-icon-holder icon-"+a.macroName+"'\x3e\x3c/span\x3e"):b.prepend("\x3cimg src\x3d'"+g+"' alt\x3d'icon' width\x3d'"+a.icon.width+"' height\x3d'"+a.icon.height+"' title\x3d'"+a.title+"'/\x3e")}else b.prepend("\x3cspan class\x3d'macro-icon-holder icon-"+a.macroName+"'\x3e\x3c/span\x3e");d(".macro-title",b).text(a.title);d(".macro-desc",b).prepend(a.description);"gadget"==a.macroName&&(g=a.gadgetUrl)&&(g.match("^https?://.*")||(g=r.CONTEXT_PATH+"/"+
g),d(".macro-title",b).after(k.MacroBrowser.gadgetLink({url:g})));b.click(function(b){c(b,a)});return b}function w(a,c){for(var b={all:p("all")},d=0,e=a.length;d<e;d++){var f=a[d];if(f.hidden)if(l.isHiddenMacroShown(f))f.categories.push("hidden-macros");else continue;b.all.append(n(f,c).attr("id",f.id));for(var h=0,x=f.categories.length;h<x;h++){var m=f.categories[h];b[m]=b[m]||p(m);b[m].append(n(f,c).attr("id",m+"-"+f.id))}}return b}function q(a,c){c=c?k.Dialog.helpLink(c):k.MacroBrowser.helpLink();
a.getPage(a.curpage).header.append(c)}return{createDialog:function(a){var c=w(a.macros,a.onClickMacroSummary),b=v.component({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});b.popup.element.on("keydown",".aui-button",function(a){a.stopPropagation()});b.getPage(0).element.attr("id","select-macro-page");b.addHeader(a.title);b.addPanel("All",c.all,"all","category-button-all").getPanel(0).setPadding(0);for(var g=
0,n=a.categories.length;g<n;g++){var f=a.categories[g];b.addPanel(f.displayName,c[f.name]||p(f.name),f.name,"category-button-"+f.name).getPanel(g+1).setPadding(0)}b.addCancel("Cancel",a.onCancel);b.searcher=t({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,c){var h=null;""!=c&&(b.getCurrentPanel()!=b.getPanel(0)&&b.gotoPanel(0),c=l.searchSummaries(c),h={},d.each(c,
function(){h[this.id]=this}));a.each(function(){!h||this.id in h?d(this).show():d(this).hide()})},submitCallback:function(a,b){""!=b&&1===a.length&&a.click()}});b.page[0].header.append(b.searcher.form);b.page[0].ontabchange=function(a,c){a!=b.getPanel(0,0)&&b.searcher.reset()};q(b);c=d(k.MacroBrowser.insertMacroPanel());c.find("form").submit(function(a){l.complete();return e.stopEvent(a)});d("#macro-browser-preview-link",c).click(function(a){d(this).prop("disabled")||l.previewMacro(b.activeMetadata);
return e.stopEvent(a)});b.addPage().addPanel("X",c,"macro-input-panel").addCancel("Cancel",function(){return a.onCancel()}).addButton("Insert",function(){l.complete()},"ok").getPanel(0).setPadding(0);l.isInFabricEditor()||b.addLink("Select macro",function(a){a.prevPage()},"dialog-back-link");b.getPage(1).element.attr("id","macro-details-page");d("#macro-browser-dialog .dialog-button-panel .ok").before("\x3cspan id\x3d'save-warning-span' class\x3d'hidden'/\x3e");
c=d(k.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:u.getBoolean("is-admin")}));b.addPage().addPanel("No macro metadata",c,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});b.gotoPage(2);b.addHeader("No macro metadata");b.gotoPanel(0,0);b.ready=!0;return b},
showBrowserSpinner:function(a){var c=d("#macro-browser-dialog");a?c.spin("large"):c.spinStop()},showPreviewSpinner:function(a){var c=d("#macro-browser-preview");a?c.spin("large"):c.spinStop()},updateButtonText:function(a){var c=d("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?c.text("Save"):c.text("Insert")},enableSaveButton:function(a){d("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},setHelpLink:q}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-UI");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
define("confluence-macro-browser/macro-browser","window jquery ajs confluence-macro-browser/macro-browser-utils confluence-macro-browser/macro-browser-editor confluence-macro-browser/macro-browser-fields confluence-macro-browser/macro-browser-model confluence-macro-browser/macro-browser-preview confluence-macro-browser/macro-browser-rest confluence-macro-browser/macro-browser-UI confluence-macro-browser/macro-browser-smartfields confluence-macro-browser/macro-parameter-serializer confluence/macro-js-overrides confluence/api/logger underscore confluence/legacy-message-queue".split(" "),
function(m,f,n,t,u,p,v,w,x,y,z,A,h,k,D,q){function B(a){try{var b=(new DOMParser).parseFromString(['\x3croot xmlns:ac\x3d"http://atlassian.com/ac" xmlns:ri\x3d"http://atlassian.com/ri" \x3e',a,"\x3c/root\x3e"].join(" "),"application/xml");if(b.querySelector("parsererror"))return[""];var d=b.childNodes[0].childNodes,e=[];d.length&&d.forEach(function(a){"ac:rich-text-body"===a.tagName&&(a=a.innerHTML.trim(),a=a.replaceAll('xmlns:ac\x3d"http://atlassian.com/ac"',""),a=a.replaceAll('xmlns:ri\x3d"http://atlassian.com/ri"',
""),e.push(a))});0===e.length&&e.push("");return e}catch(C){return k.logError(C),[""]}}function r(a){"string"===typeof a&&(a=[a]);return Array.isArray(a)?a.map(function(a){return["\x3cac:rich-text-body\x3e",a,"\x3c/ac:rich-text-body\x3e"].join("")}).join(""):""}var a={};p=p(a);a.ParameterFields=p.ParameterFields;a.Field=p.Field;z(a,a.ParameterFields);a.Utils=t;a.Editor=u(a);a.Preview=w(a);a.Model=v(a);a.Rest=x;a.UI=y(a);var g,l=function(b,c){var d={id:b.macroName,successCallback:function(d){d&&d.details&&
(b.description&&(d.details.description=b.description),d.details=a.Model.transformMetaDataDefault(d.details));a.Editor.loadMacroInBrowser(d.details,c);l.displayDetails();a.Preview.previewMacro(d.details)},errorCallback:function(a){m.alert("There has been an error loading the macro browser. Please try again or see your system administrator.");l.displayDetails()}};b.alternateId&&(d.alternateId=b.alternateId);l.setUI(c,b.title,b.macroName);a.Rest.fetchMacroMetadataDetails(d)};l.setUI=function(b,c,d){var e="edit"==b?a.editTitle:a.insertTitle;f("#macro-insert-container").hide();
a.UI.enableSaveButton(!1);a.UI.updateButtonText(b);a.dialog.gotoPage(1).addHeader(e.replace(/\{0\}/,c));(b=h.getFunction(d,"beforeDialogShow"))&&b(c);a.dialog.show();a.UI.showBrowserSpinner(!0)};l.displayDetails=function(){a.UI.showBrowserSpinner(!1);a.UI.enableSaveButton(!1);f("#macro-insert-container").show()};a.isOpen=!1;a.isInTinyMceEditor=function(){return m.tinymce&&!!m.tinymce.activeEditor};a.isInFabricEditor=function(){return!a.isInTinyMceEditor()};a.reset=function(){g&&g.resolve&&g.resolve();
g=null;a.initMacroBrowserAfterRequest=null;a.initData=null;a.hasInit=!1;a.metadataList=[];a.aliasMap={};a.fields={};h.reset();a.Macros=h.elements()};a.getMacroJsOverride=h.get;a.setMacroJsOverride=h.put;a.Macros=h.elements();a.hasInit=!1;a.metadataList=[];a.aliasMap={};a.fields={};a.processRequiredParameters=function(){return a.Editor.processRequiredParameters()};a.paramChanged=function(){a.Editor.processRequiredParameters()};a.loadMacroInBrowser=function(b,c){a.Editor.loadMacroInBrowser(b,c)};a.getMacroDefinitionFromForm=
function(b){a.Editor.getMacroDefinitionFromForm(b)};a.getMacroParametersFromForm=function(b){a.Editor.getMacroParametersFromForm(b)};a.previewMacro=function(b){a.Preview.previewMacro(b)};a.previewOnload=function(b){var c=a.dialog&&a.dialog.activeMetadata&&a.dialog.activeMetadata.macroName||null;c&&((c=h.getFunction(c,"postPreview"))&&c(f("#macro-preview-iframe")[0],a.dialog.activeMetadata),n.Editor.disableFrame(b),f(b).click(function(a){if("a"===a.target.tagName.toLowerCase())return(a=f(a.target).attr("href"))&&
0!=a.indexOf("#")&&-1==a.indexOf(m.location)&&m.open(a,"_blank").focus(),!1}))};a.getMacroMetadata=function(b){for(var c=0,d=a.metadataList.length;c<d;c++){var e=a.metadataList[c];if(e.macroName==b)return e}return null};a.getMetadataPromise=function(){return g};a.open=function(b){b||(b={},k.log("No settings to open the macro browser."));var c=b.selectedMacro;!c&&b.presetMacroMetadata&&(c={name:b.presetMacroMetadata.macroName,productContext:b.presetMacroMetadata.productContext||{}});if(c&&c.name){var d=
h.getFunction(c.name,"opener");if(d){a.isInFabricEditor()&&(c.params&&"string"===typeof c.params.__bodyContent&&(c.body=c.params.__bodyContent),b.selectedMacro&&"multiBodiedExtension"===b.selectedMacro.type&&(c.body=B(b.selectedMacro.body)),b.presetMacroMetadata&&b.presetMacroMetadata.formDetails&&b.presetMacroMetadata.formDetails.body&&"MULTI_BODY_RICH_TEXT"===b.presetMacroMetadata.formDetails.body.bodyType&&(c.body=[""]));b&&(a.settings=b);d(c);return}}a.hasInit?a.openMacroBrowser(b):(k.debug("init macro browser"),
a.UI.showBrowserSpinner(!0),null!==a.initData&&f.isEmptyObject(a.initData)?(k.error("Macro browser preload failed. Trying again..."),a.initMacroBrowserAfterRequest=b,a.preLoadMacro()):a.initData?(a.initBrowser(),a.openMacroBrowser(b)):(k.debug("Waiting for macro browser preloading..."),a.initMacroBrowserAfterRequest=b))};a.openMacroBrowser=function(b){a.settings=b;a.selectedMacroDefinition=b.selectedMacro;var c=a.selectedMacroDefinition&&a.selectedMacroDefinition.name||b.presetMacroName;b.presetMacroName&&
(b.presetMacroMetadata=a.getMacroMetadata(b.presetMacroName));var d=b.presetMacroMetadata,e=b.selectedMacro;if(!d&&e){var c=e.name.toLowerCase(),c=a.aliasMap[c]||c,g=h.getFunction(c,"updateSelectedMacro"),l=h.getFunction(c,"getMacroDetailsFromSelectedMacro");g&&g(e);l&&(d=l(a.metadataList,e));d||(d=a.getMacroMetadata(e.name))}e&&(e.title&&(d.title=e.title),e.description&&(d.description=e.description));e=f("#macro-browser-dialog").find("button.back");d?(k.debug("Open macro browser to edit macro: "+
d.macroName),e.hide(),a.replicateSelectMacro(d,b.mode||"edit")):(c?(e.show(),a.dialog.overrideLastTab(),a.dialog.gotoPage(2)):(e.show(),b.selectedCategory?(b=f("#select-macro-page .dialog-page-menu button").index(f("#category-button-"+b.selectedCategory)),0>b&&(b=0),a.dialog.overrideLastTab(),a.dialog.gotoPanel(0,b)):a.dialog.gotoPage(0)),a.showBrowserDialog());a.isOpen=!0};a.showBrowserDialog=function(){a.dialog.show();a.UI.showBrowserSpinner(!1)};a.complete=function(b){if(f("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){b=
a.dialog.activeMetadata;var c=h.getFunction(b.macroName,"manipulateMarkup");c&&c(b);var c=a.Editor.getMacroDefinitionFromForm(b),d=a.settings.selectedMacro;d?q.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macroBrowser",action:"edited",actionSubject:"macro",actionSubjectId:d.name}}):q.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macroBrowser",action:"inserted",actionSubject:"macro",actionSubjectId:c.name}});a.afterComplete(c,b)}};a.insertUpdatedMacro=
function(b,c){a.settings&&"function"===typeof a.settings.insertUpdatedMacro&&a.settings.insertUpdatedMacro(b,c)};a.afterComplete=function(b,c){a.isInFabricEditor()&&(a.settings&&a.settings.presetMacroMetadata&&a.settings.presetMacroMetadata.formDetails&&a.settings.presetMacroMetadata.formDetails.body&&"MULTI_BODY_RICH_TEXT"===a.settings.presetMacroMetadata.formDetails.body.bodyType&&(b.body=r(b.body)),a.settings&&a.settings.selectedMacro&&"multiBodiedExtension"===a.settings.selectedMacro.type&&(b.body=
r(b.body)));a.settings&&!1!==a.settings.autoClose&&a.close();if(a.settings&&"function"===typeof a.settings.onComplete)a.settings.onComplete(b,c)};a.cancel=function(){a.close();if(a.settings&&"function"===typeof a.settings.onCancel)a.settings.onCancel();return!1};a.close=function(){this.unknownParams={};this.fields={};a.Preview.removePreviewContainer();this.dialog&&this.dialog.hide();a.isOpen=!1};a.replicateSelectMacro=function(a,c){l(a,c)};a.initBrowser=function(){var b=a.initData;if(!b.categories||
!a.metadataList.length)return m.alert("There has been an error loading the macro browser. Please try again or see your system administrator."),a.UI.showBrowserSpinner(!1),!1;a.editTitle=b.editTitle;a.insertTitle=b.insertTitle;var c;b.categories=f.map(b.categories,function(a){return"hidden-macros"==a.name?(c=a,null):a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&n.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=a.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,
onClickMacroSummary:function(a,b){a.preventDefault();l(b,"insert")},onSubmit:a.complete,onCancel:a.cancel});return a.hasInit=!0};a.searchSummaries=function(b,c){c=f.extend({splitRegex:/[\s\-]+/},c);return n.filterBySearch(a.metadataList,b,c)};a.getMacroBody=function(){if(!a.isOpen)throw Error("confluence-macro-browser/macro-browser is not open");var b="",c=f("#macro-insert-container").data("macro-detail"),d=f("#macro-insert-container .macro-body-editor textarea"),e=f("#macro-insert-container .macro-body-div textarea");
a.isInFabricEditor()&&c&&c.body&&"PLAIN_TEXT"===c.body.bodyType&&d.length?b=d.val():e.length?b=e.val():a.selectedMacroDefinition?a.selectedMacroDefinition.body&&(b=a.selectedMacroDefinition.body):a.dialog.activeMetadata&&(b=a.dialog.activeMetadata.formDetails.body.content);return b};a.getMacroParams=function(a){return A.deserialize(a.getAttribute("data-macro-parameters"))};a.getMacroName=function(a){if(a&&a.hasAttribute("data-macro-name"))return a.getAttribute("data-macro-name")};a.isHiddenMacroShown=
function(a){return n.params.showHiddenUserMacros&&"_-user-macro-_"==a.pluginKey};a.hasRequiredParameters=function(a){return a.anyParameterRequired};a.setWhitelist=function(b){a.whitelist=b};a.updateCacheInBackground=function(){a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:!1},forceUpdateCache:!0,errorCallback:function(a){k.error("Error updating cached macro browser metadata:");k.error(a)}})};a.preLoadMacro=function(b){b=b||{};a.initData=null;return g&&"pending"===g.state()&&
!b.forceUpdateCache?g:g=a.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:!1},forceUpdateCache:b.forceUpdateCache,successCallback:function(b){a.initData=b;a.Model.loadMacros(b.macros);a.initMacroBrowserAfterRequest&&(a.initBrowser(),a.openMacroBrowser(a.initMacroBrowserAfterRequest))},errorCallback:function(b){k.error("Error requesting macro browser metadata:");k.error(b);a.initData={}}})};return a});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-macro-browser/macro-browser","AJS.MacroBrowser");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.MacroBrowser.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_ignored) {
  return '<ol id="category-' + soy.$$escapeHtml(opt_data.category) + '" class="macro-list"></ol>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryList.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryList';
}


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_ignored) {
  return '<li class="macro-list-item" tabindex="0" role="button"><h4 class="macro-title"></h4>' + Confluence.Templates.MacroBrowser.macroDescription({description: ''}) + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroSummaryItem.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroSummaryItem';
}


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div class="macro-desc">' + ((opt_data.descriptionHtml) ? soy.$$filterNoAutoescape(opt_data.descriptionHtml) : '') + ((opt_data.showDescriptionHelp) ? ' <a href="' + soy.$$escapeHtml(opt_data.descriptionHelpLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('Need help?') + '</a>' : '') + ((opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml('Documentation') + '</a>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroDescription.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroDescription';
}


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div id="macro-preview-container" class="macro-preview-container dialog-panel"><div class="macro-preview-header"><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">' + soy.$$escapeHtml('Refresh') + '</a><span>' + soy.$$escapeHtml('Preview') + '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div><div id="macro-body-editor-container" class="macro-body-editor-container dialog-panel"><div class="macro-body-editor-header"><span>' + soy.$$escapeHtml('Content') + '</span></div><div class="macro-body-editor-wrapper"><div class="macro-body-editor-label">' + soy.$$escapeHtml('Insert text') + '</div><div class="macro-body-editor"><textarea placeholder="' + soy.$$escapeHtml('Type here') + '"></textarea></div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.insertMacroPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.insertMacroPanel';
}


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_ignored) {
  return '<div id="macro-missing-metadata-container"><p>' + 'There is no metadata configured for this macro which means no configuration screen can be presented here.' + '</p>' + ((opt_data.showAdminMessage) ? '<p>' + AJS.format('If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.',"/wiki" + '/admin/usermacros.action') + '</p>' : '<p>' + 'You must contact an administrator to configure metadata for this macro.' + '</p>') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel.soyTemplateName = 'Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel';
}


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><input type="text" class="text"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameter.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameter';
}


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_ignored) {
  return '<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterBoolean.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterBoolean';
}


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><label></label><select class="select"></select></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterSelect.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterSelect';
}


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_ignored) {
  return '<div class="macro-param-div"><input type="hidden"/></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterHidden.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterHidden';
}


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_ignored) {
  return '<div class="macro-param-desc">' + soy.$$filterNoAutoescape(opt_data.description) + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroParameterDesc.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroParameterDesc';
}


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_ignored) {
  return '<div class="macro-body-div"><label>' + soy.$$escapeHtml('Body text') + '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.macroBody.soyTemplateName = 'Confluence.Templates.MacroBrowser.macroBody';
}


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_ignored) {
  return '' + Confluence.Templates.Dialog.helpLink({href: "https://confluence.atlassian.com/display/ConfCloud/Macros"});
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.helpLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.helpLink';
}


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_ignored) {
  return '<a class=\'macro-uri\' href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.url) + '" target=\'_blank\'>' + soy.$$escapeHtml('Gadget URL') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.MacroBrowser.gadgetLink.soyTemplateName = 'Confluence.Templates.MacroBrowser.gadgetLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-facade.js' */
define("confluence-macro-browser/macro-browser-facade",["confluence-macro-browser/macro-browser","window"],function(b,c){var a=c.tinymce;return{getTinyMceMacroBrowser:function(){return a&&a.confluence&&a.confluence.macrobrowser||null},isInTinyMceEditor:function(){return a&&!!a.activeEditor},insert:function(a){if(this.isInTinyMceEditor())return this.getTinyMceMacroBrowser().macroBrowserComplete(a);b.afterComplete&&b.afterComplete(a)},saveMacro:function(a){this.isInTinyMceEditor()||b.insertUpdatedMacro&&
b.insertUpdatedMacro(a)},cancel:function(){if(this.isInTinyMceEditor())return this.getTinyMceMacroBrowser().macroBrowserCancel();b.cancel&&b.cancel()},getTinyMceMacroBrowserIfHave:function(){return this.isInTinyMceEditor()?this.getTinyMceMacroBrowser():null}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
define("confluence-macro-browser/macro-browser-preload",["jquery","ajs","window"],function(a,b,c){return{macroBrowserPreload:function(){a(c).bind("render-content-loaded",function(c,d){a("#macro-preview-iframe").contents().find("body")[0]==d&&b.MacroBrowser.previewOnload(d)});b.MacroBrowser.preLoadMacro()}}});require("confluence/module-exporter").safeRequire("confluence-macro-browser/macro-browser-preload",function(a){require("ajs").toInit(a.macroBrowserPreload)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:querystring', location = 'includes/js/api/querystring.js' */
define("confluence/api/querystring",[],function(){return{stringify:function(a){var d="",b;for(b in a)for(var c=0;c<a[b].length;c++)d+="\x26"+b,a[b][c]&&(d+="\x3d"+a[b][c]);return d.substring(1)},parse:function(a){var d={};if(a){"?"===a.substr(0,1)&&(a=a.substr(1));a=a.split("\x26");for(var b=0;b<a.length;b++){var c=a[b].split("\x3d");d[c[0]]||(d[c[0]]=[]);d[c[0]].push(a[b].substring(c[0].length+1))}}return d}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:url', location = 'includes/js/api/url.js' */
define("confluence/api/url",["confluence/api/querystring","jquery"],function(d,e){var g=/([^\?|#]+)[\?]?([^#]*)[#]?(.*)/,f=["source","urlPath","queryParams","anchor"];return{parse:function(a){var b={};if(a=g.exec(a)){for(var c=0;c<f.length;c++)b[f[c]]=a[c];b.queryParams=d.parse(b.queryParams)}return b},format:function(a){return e.isEmptyObject(a)?"":(a.urlPath?a.urlPath:"")+(e.isEmptyObject(a.queryParams)?"":"?"+d.stringify(a.queryParams))+(a.anchor?"#"+a.anchor:"")}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:analytics-support', location = 'includes/js/analytics-support.js' */
define("confluence/analytics-support","jquery ajs confluence/meta window document confluence/api/url".split(" "),function(d,q,n,k,l,e){var b={},m;b.analyticsHandlerExists=function(){if("undefined"===typeof m){var a=d._data(k,"events");m=a&&a.analytics&&0<a.analytics.length}return m};b.setAnalyticsSource=function(a,f){b.analyticsHandlerExists()&&a.attr("href",function(a,c){a=encodeURIComponent(f);c=e.parse(c);d.isEmptyObject(c)||(c.queryParams.src=[a]);return e.format(c)})};b.srcRemovedUrl=function(a){a=
e.parse(a);delete a.queryParams.src;for(var f=Object.keys(a.queryParams),b=0;b<f.length;b++){var c=f[b],g=c.split(".");3===g.length&&"src"===g[0]&&delete a.queryParams[c];"jwt"===c&&delete a.queryParams[c]}return e.format(a)};b.srcParamValues=function(a){return(a=e.parse(a).queryParams)&&a.src?a.src:[]};b.srcAttrParamValues=function(a){a=e.parse(a).queryParams;for(var b=Object.create(null),p=Object.keys(a),c=0;c<p.length;c++){var g=p[c],h=g.split(".");if(3===h.length&&"src"===h[0]){var d=h[1],h=h[2];
b[d]=b[d]||{};b[d][h]=decodeURIComponent(a[g][0])}}return b};b.extractAnalyticsData=function(a){var f=[],d=b.srcParamValues(a);a=b.srcAttrParamValues(a);for(var c=0;c<d.length;c++){var g=d[c];f.push({src:g,attr:a[g]||{}})}return f};b.publish=function(a,b){q.trigger("analytics",{name:a,data:b||{}})};b.init=function(){var a=b.extractAnalyticsData(l.URL),f={userKey:n.get("remote-user-key"),pageID:n.get("page-id")};if(0<a.length){for(var e=0;e<a.length;e++){var c=a[e],g=d.extend({},f,c.attr);b.publish("confluence.viewpage.src."+
c.src,g)}k.history&&k.history.replaceState&&(a=b.srcRemovedUrl(l.URL),l.URL!==a&&k.history.replaceState(null,"",a))}else b.publish("confluence.viewpage.src.empty",f)};return b});require("confluence/module-exporter").exportModuleAsGlobal("confluence/analytics-support","AJS.Confluence.Analytics",function(d){require("ajs").toInit(d.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:amd-support', location = 'amd/confluence-shim.js' */
define("confluence/jim/confluence-shim",function(){return window.Confluence});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:amd-support', location = 'amd/amd-exporter.js' */
define("confluence/jim/amd/module-exporter",[],function(){var a={};a.namespace=function(e,f,d){var g=e.split(".");d=d||window;for(var c=0,h=g.length-1;c<h;c++){var b=d[g[c]];d=(b!=null)?b:d[g[c]]={}}if(d[g[c]]){if(window.console&&window.console.warn){window.console.warn('Value of "'+e+'" was overridden')}}d[g[c]]=f||d[g[c]]||{};return d[g[c]]};a.safeRequire=function(c,b){if(define&&define.amd===undefined){var d=require(c);if(b){b(d)}}};a.exportModuleAsGlobal=function(c,d,b){a.safeRequire(c,function(e){a.namespace(d,e);if(b){b(e)}})};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(b,a){AJS.log("add-handler.property-panel: panel name = "+a.name);if(a.name!="macro"){return}a.registerButtonHandler("view-in-jira",function(d,j){if(AJS.Editor.JiraConnector.servers){var s=AJS.Editor.JiraConnector.servers;var l=AJS.$(j);var g=l.attr("data-macro-default-parameter");var k=l.attr("data-macro-parameters")||"";var t=Confluence.MacroParameterSerializer.deserialize(k);var n=/=|!=|~|>|<|!~| is | in /i;var h=function(u){var i=u.indexOf("|");if(i>=0){return u.substring(0,i)}return u};var f=g||t.jqlQuery||t.key||h(k);var c=t.server;var q=t.serverId;var p=f.match(n);var m=null;for(var o=0;o<s.length;o++){if((q&&s[o].id==q)){m=s[o];break}if((c&&s[o].name==c)||(!c&&s[o].selected)){m=s[o];break}}if(m!=null){var e=(typeof m.displayUrl!=="undefined")?m.displayUrl:m.url;if(e.charAt(e.length-1)=="/"){e=e.substr(0,e.length-1)}var r=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId;if(!p){window.open(e+"/browse/"+encodeURIComponent(f),r)}else{window.open(e+"/secure/IssueNavigator.jspa?reset=true&jqlQuery="+encodeURIComponent(f),r)}}}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){if(!AJS.Confluence&&!AJS.Confluence.PropertyPanel&&!AJS.Confluence.PropertyPanel.Macro){AJS.logError("JIRA Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined");return}var a="showSummary";var f="jira";var e="jiraissues";var d="show-summary";AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,f);AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,e);function c(g,m,j){var l=AJS.$.grep(m,function(i){return i.parameterName==d})[0];if(!l){AJS.logError("JIRA Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var k in m){AJS.logError(m[k].text)}return}if(b(g)){var h=AJS.SummaryHelper.getParam(g,a);if(h=="false"){l.text="Show summary"}else{l.text="Hide summary"}}else{l.className+=" hidden"}}function b(g){var i=AJS.$(g);var j=i.attr("src");if(!j){return true}var h=AJS.SummaryHelper.getParam(g,"count");if(j.indexOf("confluence.extra.jira/jira-table")==-1&&h!="true"){return true}return false}});AJS.bind("add-handler.property-panel",function(b,a){if(a.name!="macro"){return}a.registerButtonHandler("show-summary",function(e,c){var d=AJS.SummaryHelper.getParam(c,"showSummary");AJS.SummaryHelper.updateMacro("jira",c,"showSummary",d=="false"?"true":"false")})});AJS.SummaryHelper=(function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,d){var c=AJS.$(a);var b=AJS.SummaryHelper.getCurrentParams(c);return b[d]},updateMacro:function(b,a,c,g){var e=AJS.$(a);AJS.Rte.getEditor().selection.select(e[0]);AJS.Rte.BookmarkManager.storeBookmark();var d=AJS.SummaryHelper.getCurrentParams(e);d[c]=g;var f={contentId:Confluence.Editor.getContentId(),macro:{name:b,params:d,defaultParameterValue:e.attr("data-macro-default-parameter")}};tinymce.confluence.MacroUtils.insertMacro(f)}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-dialog2', location = 'src/js/aui/dialog2.js' */
("undefined"===typeof window?global:window).__7bbab4c060018f0f9725286b27a710b7=function(){function f(a){return a&&a.__esModule?a:{"default":a}}function e(a){var c=this.$el=a?(0,g.default)(a):(0,g.default)(aui.dialog.dialog2({}));g.default.each(i,function(a,b){var d="data-"+a;c[0].hasAttribute(d)||c.attr(d,b)})}var h={};"use strict";Object.defineProperty(h,"__esModule",{value:!0});var g=f(__9be3f454a87dfa12e64a40a8f483ace3),j=f(__f9ed23d9bdbeaa8add4713d890e930be),k=f(__02a4a9c5c584764bed5640044440c14c),
b=f(__784ecffbbfc29dc92e960cda029d964a),l=f(__7bfd460cd15f9c57be670e113a26aa43),i={"aui-focus":"false","aui-blanketed":"true"};e.prototype.on=function(a,c){(0,b.default)(this.$el).on(a,c);return this};e.prototype.off=function(a,c){(0,b.default)(this.$el).off(a,c);return this};e.prototype.show=function(){(0,b.default)(this.$el).show();return this};e.prototype.hide=function(){(0,b.default)(this.$el).hide();return this};e.prototype.remove=function(){(0,b.default)(this.$el).remove();return this};e.prototype.isVisible=
function(){return(0,b.default)(this.$el).isVisible()};var d=(0,l.default)("dialog2",e);d.on=function(a,c){b.default.on(a,".aui-dialog2",c);return this};d.off=function(a,c){b.default.off(a,".aui-dialog2",c);return this};(0,g.default)(document).on("click",".aui-dialog2-header-close",function(a){a.preventDefault();d((0,g.default)(this).closest(".aui-dialog2")).hide()});d.on("show",function(a,c){var b;[".aui-dialog2-content",".aui-dialog2-footer",".aui-dialog2-header"].some(function(a){b=c.find(a+" :aui-tabbable");
return b.length});b&&b.first().focus()});d.on("hide",function(a,c){var d=(0,b.default)(c);c.data("aui-remove-on-hide")&&d.remove()});(0,j.default)("aui/dialog2",d);(0,k.default)("dialog2",d);h.default=d;return h=h["default"]}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'src/soy/dialog2.soy' */
// This file was automatically generated from dialog2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.dialog.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dialog == 'undefined') { aui.dialog = {}; }


aui.dialog.dialog2 = function(opt_data, opt_ignored) {
  return '' + aui.dialog.dialog2Chrome({id: opt_data.id, titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, modal: opt_data.modal, tagName: opt_data.tagName, removeOnHide: opt_data.removeOnHide, visible: opt_data.visible, size: opt_data.size, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: '' + aui.dialog.dialog2Content({id: null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, headerActionContent: opt_data.headerActionContent, headerSecondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal, content: opt_data.content, footerHintText: opt_data.footerHintText, footerHintContent: opt_data.footerHintContent, footerActionContent: opt_data.footerActionContent})});
};
if (goog.DEBUG) {
  aui.dialog.dialog2.soyTemplateName = 'aui.dialog.dialog2';
}


aui.dialog.dialog2Chrome = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section') + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ((opt_data.titleId) ? ' aria-labelledby="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '') + ' role="dialog" class=" aui-layer aui-dialog2 aui-dialog2-' + soy.$$escapeHtml(opt_data.size ? opt_data.size : 'medium') + aui.renderExtraClasses(opt_data) + '"' + ((opt_data.modal) ? 'data-aui-modal="true"' : '') + ((opt_data.removeOnHide) ? 'data-aui-remove-on-hide="true"' : '') + ((opt_data.visible != true) ? 'aria-hidden="true"' : '') + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section') + '>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Chrome.soyTemplateName = 'aui.dialog.dialog2Chrome';
}


aui.dialog.dialog2Content = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '' + aui.dialog.dialog2Header({titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, actionContent: opt_data.headerActionContent, secondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal}) + aui.dialog.dialog2Panel(opt_data) + aui.dialog.dialog2Footer({hintText: opt_data.footerHintText, hintContent: opt_data.footerHintContent, actionContent: opt_data.footerActionContent});
};
if (goog.DEBUG) {
  aui.dialog.dialog2Content.soyTemplateName = 'aui.dialog.dialog2Content';
}


aui.dialog.dialog2Header = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<header' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-header' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '><h2 ' + ((opt_data.titleId) ? ' id="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '') + ' class="aui-dialog2-header-main">' + ((opt_data.titleText) ? soy.$$escapeHtml(opt_data.titleText) : '') + ((opt_data.titleContent) ? soy.$$filterNoAutoescape(opt_data.titleContent) : '') + '</h2>' + ((opt_data.actionContent) ? '<div class="aui-dialog2-header-actions">' + soy.$$filterNoAutoescape(opt_data.actionContent) + '</div>' : '') + ((opt_data.secondaryContent) ? '<div class="aui-dialog2-header-secondary">' + soy.$$filterNoAutoescape(opt_data.secondaryContent) + '</div>' : '') + ((opt_data.modal != true) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('aui.words.close') + '</span></a>' : '') + '</header>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Header.soyTemplateName = 'aui.dialog.dialog2Header';
}


aui.dialog.dialog2Footer = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<footer' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-footer' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.actionContent) ? '<div class="aui-dialog2-footer-actions">' + soy.$$filterNoAutoescape(opt_data.actionContent) + '</div>' : '') + ((opt_data.hintText || opt_data.hintContent) ? '<div class="aui-dialog2-footer-hint">' + ((opt_data.hintText) ? soy.$$escapeHtml(opt_data.hintText) : '') + ((opt_data.hintContent) ? soy.$$filterNoAutoescape(opt_data.hintContent) : '') + '</div>' : '') + '</footer>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Footer.soyTemplateName = 'aui.dialog.dialog2Footer';
}


aui.dialog.dialog2Panel = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  return '<div' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="aui-dialog2-content' + aui.renderExtraClasses(opt_data) + '"' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</div>';
};
if (goog.DEBUG) {
  aui.dialog.dialog2Panel.soyTemplateName = 'aui.dialog.dialog2Panel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-progress-indicator', location = 'src/js/aui/progress-indicator.js' */
("undefined"===typeof window?global:window).__a60dec621369fd10e7781e6a624e8aaa=function(){function j(a){return a&&a.__esModule?a:{"default":a}}function s(a,b,d){(0,t.recomputeStyle)(a);a.css("width",100*d+"%");b.attr("data-value",d)}function u(a,b,d){var e=d.currentProgress,c=d.value,a=(0,k.default)(a),f=(0,k.default)(b);"number"===typeof c&&(1>=c&&0<=c)&&(f.trigger(x,[e,c]),(0,y.supportsCssTransition)()?(a.one(z,function(){f.trigger(v,[e,c])}),s(a,f,c)):(s(a,f,c),f.trigger(v,[e,c])))}function w(a){var a=
(0,k.default)(a).first(),b=a.children(".aui-progress-indicator-value");a.removeAttr("data-value");(0,t.recomputeStyle)(a);b.css("width","")}function q(a){return l.default.isNumber(a)&&l.default.isFinite(a)&&!l.default.isNaN(a)}function g(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,d=parseFloat(a);return q(d)?d:Number(b)}function m(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return Number(parseFloat(a).toFixed(b))}function n(a){var b=a.max,b=0<b?b:f.max,
a=Math.max(0,Math.min(a.val,b)),d=m(a/b,6),e=m(100*d,2);return{max:b,val:a,valAsFraction:d,valAsPercent:e}}function h(a){var b=n(a._data),d=b.val,e=b.valAsFraction,b=b.max,c=a.querySelector(".aui-progress-indicator"),f=c.getAttribute("data-value");a.indeterminate?(c.removeAttribute("aria-valuenow"),w(c)):(c.setAttribute("aria-valuenow",d),c.setAttribute("aria-valuemax",b),u(c.querySelector(".aui-progress-indicator-value"),c,{currentProgress:f,value:e}))}var o={};"use strict";Object.defineProperty(o,
"__esModule",{value:!0});var k=j(__9be3f454a87dfa12e64a40a8f483ace3),l=j(__91c7aed26ee9e2809174d3b0d7107d6b),p=j(__416bb6d8d60e7b99a31814d64a3a111d),t=__3f3b61724eea392dbdfa9e31da3f7f4f,y=__1587e71f975c054c720890ed9f835be9,e;e=__7a49532771c5910a7b233af9a02dfe09;if(!e||!e.__esModule){var r={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);r.default=e;e=r}i=j(__02a4a9c5c584764bed5640044440c14c);var v="aui-progress-indicator-after-update",x="aui-progress-indicator-before-update",
z="transitionend webkitTransitionEnd",f={indeterminate:!1,max:1,val:0};(0,p.default)("aui-progressbar",{template:function(a){a._data.max=g(a.getAttribute("max"),f.max);a._data.val=g(a.getAttribute("value"),f.val);a._data.indeterminate=a.hasAttribute("indeterminate");var b=n(a._data),d=b.valAsFraction;a.innerHTML='<div class="aui-progress-indicator"\n         '+(a._data.indeterminate?"":'data-value="'+d+'"')+'\n         role="progressbar"\n         aria-valuemin="0"\n         aria-valuenow="'+b.val+
'"\n         aria-valuemax="'+b.max+'"\n         tabindex="0"\n     >\n        <span class="aui-progress-indicator-value" style="width: '+b.valAsPercent+'%"></span>\n    </div>'},attached:function(a){h(a)},attributes:{indeterminate:{created:function(a){a.indeterminate=!0},removed:function(a){a.indeterminate=!1}},value:{value:f.val,fallback:function(a,b){if(a._updating)return!1;a._data.val=g(b.newValue,b.oldValue||f.val);h(a)}},max:{value:f.max,fallback:function(a,b){if(a._updating)return!1;a._data.max=
g(b.newValue,b.oldValue||f.max);h(a)}}},prototype:{get _data(){return this.__data||(this._data=l.default.defaults({},f))},set _data(a){return this.__data=a},get indeterminate(){return this._data.indeterminate},set indeterminate(a){this._data.indeterminate=!!a;h(this)},get value(){return n(this._data).val},set value(a){if(!q(a))return!1;a={newValue:m(a,6)};this._updating=!0;this.setAttribute("value",a.newValue);this._updating=!1;this._data.val=g(a.newValue,a.oldValue||f.val);h(this)},get max(){return n(this._data).max},
set max(a){if(!q(a))return!1;a={newValue:m(a,6)};this._updating=!0;this.setAttribute("max",a.newValue);this._updating=!1;this._data.max=g(a.newValue,a.oldValue||f.max);h(this)}}});p={update:e.fn(function(a,b){if("string"===typeof a){var d=document.getElementById(a);d&&(a=d)}var d=(0,k.default)(a).first(),e=d.children(".aui-progress-indicator-value"),c=d.attr("data-value"),f=!c,g=parseFloat(c)||0;if(c=c&&g===b)c=parseFloat(e.get(0).style.width)||0,c=g===100*c;if(!c)return f&&e.css("width",0),u(e,d,
{currentProgress:g,value:b}),d},"AJS.progressBars.update",{sinceVersion:"7.7.0",extraInfo:"Use the <aui-progressbar> web component instead"}),setIndeterminate:e.fn(w,"AJS.progressBars.setIndeterminate",{sinceVersion:"7.7.0",extraInfo:"Use the <aui-progressbar> web component instead"})};(0,i.default)("progressBars",p);o.default=p;return o=o["default"]}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-validator-page', location = '/validator/js/resource.js' */
define("confluence/jim/validator/js/resource",["jquery","underscore","ajs","confluence/api/logger",],function(e,d,b,c){var a=function(){};a.prototype.getValidationStatus=function(){var f=b.contextPath()+"/rest/jiraanywhere/1.0/jim-validator/get-scanning-status";return e.getJSON(f,{}).fail(this.onError)};a.prototype.start=function(){var f=b.contextPath()+"/rest/jiraanywhere/1.0/jim-validator/scan-broken-applink-in-background";return e.ajax({type:"POST",url:f,contentType:"application/json"}).fail(this.onError)};a.prototype.resetStatus=function(){var f=b.contextPath()+"/rest/jiraanywhere/1.0/jim-validator/reset-status";return e.ajax({type:"POST",url:f,contentType:"application/json"}).fail(this.onError)};a.prototype.onError=function(g){try{if(g.status===401){c.logError("Unauthenticated exception during JIM validation request");return}else{if(g.responseText){var f=JSON.parse(g.responseText);if(f.message&&!!f.message.trim()){c.logError("Unexpected exception during JIM validation request: ",f.message);return}}}c.logError("Unexpected exception during JIM validation request: ",g.statusText)}catch(h){c.logError("Unhandled exception during JIM validation request: ",h)}};a.prototype.fixApplink=function(h,f){b.trigger("analyticsEvent",{name:"jim.validator.start.fixing",data:{numberOfMapping:h.length}});var g=b.contextPath()+"/rest/jiraanywhere/1.0/jim-validator/fix-applink";return e.ajax({type:"POST",url:g,data:JSON.stringify({appLinkMappingList:h,contentIds:f}),contentType:"application/json"}).fail(this.onError)};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-validator-page', location = '/validator/js/progress-bar.js' */
define("confluence/jim/validator/js/progress-bar",["jquery","ajs"],function(b,a){var c=function(){this.$el=b(".progress-bar-section");this.$label=this.$el.find(".progress-bar-label")};c.prototype.show=function(){this.$el.show()};c.prototype.hide=function(){this.$el.hide()};c.prototype.update=function(d,e){this.$label.text(d);a.progressBars.update("#validator-progress-bar",e);this.show()};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-validator-page', location = '/validator/js/prompt-dialog.js' */
define("confluence/jim/validator/js/prompt-dialog",["jquery","underscore","ajs","confluence/jim/validator/js/resource"],function(d,c,b,e){var a=function(f){this.promptDialogId="jim-validator-config-dialog";this.data=f;this.brokenAppLinks=f.problems.brokenAppLinks;this.existingAppLinks=f.problems.existingAppLinks;this.resource=new e();this.deferred=d.Deferred();this.$dialog=d(Confluence.Templates.Jim.Validator.configDialog({dialogId:this.promptDialogId,brokenAppLinks:this.brokenAppLinks,existingApplinks:this.existingAppLinks}))};a.prototype.show=function(){this.$dialog.appendTo("body");this.$dialog.find(".select-applink-config").auiSelect2({minimumResultsForSearch:-1,placeholder:"Select an Application Link"});b.dialog2("#"+this.promptDialogId).show();this.addEvent();return this.deferred.promise()};a.prototype.addEvent=function(){this.$dialog.find("#validator-done").on("click",c.bind(this.onDoneClick,this));this.$dialog.find("#validator-cancel").on("click",c.bind(this.onCancelButtonClick,this))};a.prototype.onDoneClick=function(){if(!this.isFormValid()){return}var f=[];c.each(this.brokenAppLinks,function(g){var h=d("select#"+g.serverId).auiSelect2("data");f.push({oldAppLink:g,newAppLink:{serverId:h.id,server:h.text}})});this.resource.fixApplink(f,this.data.problems.contentIds).done(c.bind(function(){b.dialog2("#"+this.promptDialogId).remove();this.deferred.resolve()},this)).fail(c.bind(function(){this.deferred.fail(arguments)},this))};a.prototype.onCancelButtonClick=function(f){b.dialog2("#"+this.promptDialogId).remove();this.deferred.reject()};a.prototype.isFormValid=function(){var f=true;d(".select-applink-config").each(function(){var g=d(this).auiSelect2("val");d(this).toggleClass("invalid",!!!g);if(!g){f=false;return false}});return f};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-validator-page', location = '/validator/js/notify.js' */
define("confluence/jim/validator/js/notify",["jquery","ajs"],function(d,a){function c(e,f){return a.flag({type:e,body:f})}var b=function(){};b.prototype.showWarning=function(f,g){var h=Confluence.Templates.Jim.Validator.warningFlagContent();var e=c("warning",h);d(e).find(".show-prompt-dialog").on("click",function(i){a.trigger("analyticsEvent",{name:"jim.validator.space.import.show.prompt.dialog"});g&&g();e.close()});d(e).find(".icon-close").on("click",function(j){var i=a.contextPath()+"/rest/jiraanywhere/1.0/jim-validator/reset-status";return d.ajax({type:"POST",url:i,contentType:"application/json"}).fail(this.onError)});return e};b.prototype.showError=function(g,e){var h=Confluence.Templates.Jim.Validator.error({message:g});var f=c("error",h);d(f).find(".dismissed-applink").on("click",function(){a.trigger("analyticsEvent",{name:"jim.validator.space.import.error.dismissed"});e&&e();f.close()});return f};b.prototype.showNoAppLink=function(g,e){var h=Confluence.Templates.Jim.Validator.warningNoApplink();var f=c("warning",h);d(f).find(".add-new-applink").on("click",function(){a.trigger("analyticsEvent",{name:"jim.validator.space.import.add.new.applink"});g&&g();f.close()});d(f).find(".dismissed-applink").on("click",function(){a.trigger("analyticsEvent",{name:"jim.validator.space.import.no.applink.dismissed"});e&&e();f.close()});return f};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-validator-page', location = '/validator/js/validator.js' */
define("confluence/jim/validator/js/validator",["jquery","underscore","ajs","confluence/jim/validator/js/resource","confluence/jim/validator/js/notify","confluence/jim/validator/js/progress-bar","confluence/jim/validator/js/prompt-dialog"],function(g,e,c,h,d,b,a){var f=function(){this.STATUS={NOT_STARTED:"NOT_STARTED",SCANNING:"SCANNING",WAIT_FOR_CONFIG:"WAIT_FOR_CONFIG",FIXING:"FIXING",NO_APPLINK:"NO_APPLINK",DONE:"DONE",ERROR:"ERROR"};this.SCAN_INTERVAL=5000;this.FIX_INTERVAL=30000;this.resource=new h();this.notify=new d();this.getProgressBar=function(){if(!this.progressBar){this.progressBar=new b()}return this.progressBar};this.timeout=null;this.startRequested=false};f.prototype.init=function(){this.getProgressBar().hide();if(this.isForceStart()){this.start()}else{this.startCheckingStatus()}};f.prototype.start=function(){this.startRequested=true;this.getProgressBar().show();this.resource.start().done(e.bind(this.startCheckingStatus,this))};f.prototype.isForceStart=function(){var i=window.location.href;return i.indexOf("/admin/jim-validator/view.action?forcestart=true")>0};f.prototype.startCheckingStatus=function(){this.resource.getValidationStatus().done(e.bind(this.processStatusCallback,this))};f.prototype.processStatusCallback=function(j){if(this.timeout!==null){clearTimeout(this.timeout);this.timeout=null}switch(j.status){case this.STATUS.SCANNING:this.getProgressBar().show();setTimeout(e.bind(this.startCheckingStatus,this),this.SCAN_INTERVAL);break;case this.STATUS.FIXING:this.getProgressBar().show();setTimeout(e.bind(this.startCheckingStatus,this),this.FIX_INTERVAL);break;case this.STATUS.DONE:c.trigger("analyticsEvent",{name:"jim.validator.space.import.status.done"});this.getProgressBar().update("All done!",1);var k=!!g(".section.applink-validator-main").length;if(k){this.resetStatus()}break;case this.STATUS.ERROR:c.trigger("analyticsEvent",{name:"jim.validator.space.import.status.error",data:{msg:j.additionalMessage}});this.notify.showError(j.additionalMessage,e.bind(this.resetStatus,this));this.getProgressBar().hide();g("#jira-macro-repair-start-button").enable();g("#jira-macro-repair-skip-button").enable();break;case this.STATUS.NO_APPLINK:c.trigger("analyticsEvent",{name:"jim.validator.space.import.status.no.applink"});this.notify.showNoAppLink(e.bind(function(){this.resetStatus().done(this.onGoToAppLinkClick)},this),e.bind(function(){this.resetStatus();this.getProgressBar().hide()},this));break;case this.STATUS.WAIT_FOR_CONFIG:c.trigger("analyticsEvent",{name:"jim.validator.space.import.status.config"});this.notify.showWarning(j,e.bind(this.onWarningClick,this,j));break;case this.STATUS.NOT_STARTED:if(this.startRequested){var i=this;this.timeout=setTimeout(function(){i.start()},1000)}else{this.getProgressBar().hide()}break}};f.prototype.onWarningClick=function(j){var i=new a(j);i.show().done(e.bind(function(){this.getProgressBar().show();setTimeout(e.bind(this.startCheckingStatus,this),this.INTERVAL)},this))};f.prototype.onGoToAppLinkClick=function(){window.location=c.contextPath()+"/plugins/servlet/applinks/listApplicationLinks"};f.prototype.resetStatus=function(){this.startRequested=false;if(this.timeout!==null){clearTimeout(this.timeout);this.timeout=null}return this.resource.resetStatus()};return f});require("confluence/jim/amd/module-exporter").safeRequire("confluence/jim/validator/js/validator",function(c){var a=require("ajs");var b=require("jquery");a.toInit(function(){(new c).init();var e=b("#jira-macro-repair-start-button");var d=b("#jira-macro-repair-skip-button");e.on("click",function(){e.disable();d.disable();(new c).start()});d.on("click",function(){a.trigger("analyticsEvent",{name:"jim.validator.skip"});window.location.href=a.contextPath()+"/admin/space-import"})})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.soy' */
// This file was automatically generated from fields.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.fields.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.fields == 'undefined') { jiraIntegration.templates.fields = {}; }


jiraIntegration.templates.fields.stringField = function(opt_data, opt_ignored) {
  return '' + aui.form.textField({labelContent: '' + soy.$$escapeHtml(opt_data.labelText), id: opt_data.name, name: opt_data.name, value: opt_data.value, isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts});
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.stringField.soyTemplateName = 'jiraIntegration.templates.fields.stringField';
}


jiraIntegration.templates.fields.textareaField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><textarea rows="10" id="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '" class="textarea long-field">' + soy.$$escapeHtml(opt_data.value) + '</textarea>';
  if (opt_data.errorTexts) {
    var errorList37 = opt_data.errorTexts;
    var errorListLen37 = errorList37.length;
    for (var errorIndex37 = 0; errorIndex37 < errorListLen37; errorIndex37++) {
      var errorData37 = errorList37[errorIndex37];
      output += '<div class="error">' + soy.$$escapeHtml(errorData37) + '</div>';
    }
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.textareaField.soyTemplateName = 'jiraIntegration.templates.fields.textareaField';
}


jiraIntegration.templates.fields.arrayField = function(opt_data, opt_ignored) {
  return '' + aui.form.textField({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), value: opt_data.value, isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts});
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.arrayField.soyTemplateName = 'jiraIntegration.templates.fields.arrayField';
}


jiraIntegration.templates.fields.numberField = function(opt_data, opt_ignored) {
  return '' + aui.form.textField({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), value: opt_data.value, isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts});
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.numberField.soyTemplateName = 'jiraIntegration.templates.fields.numberField';
}


jiraIntegration.templates.fields.allowedValuesField = function(opt_data, opt_ignored) {
  return '' + ((opt_data.options.length) ? aui.form.selectField({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), options: opt_data.options, isRequired: opt_data.isRequired, isMultiple: opt_data.isMultiple, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts}) : aui.form.valueField({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), value: 'None', isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts}));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.allowedValuesField.soyTemplateName = 'jiraIntegration.templates.fields.allowedValuesField';
}


jiraIntegration.templates.fields.timeTrackingField = function(opt_data, opt_ignored) {
  return '' + aui.form.textField({id: opt_data.name, name: opt_data.name, labelContent: '' + soy.$$escapeHtml(opt_data.labelText), value: opt_data.value, isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts});
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.timeTrackingField.soyTemplateName = 'jiraIntegration.templates.fields.timeTrackingField';
}


jiraIntegration.templates.fields.unrenderableTypeField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field jira-field-unrenderable' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '"><label>' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label>' + aui.form.value({content: opt_data.reasonContent});
  if (opt_data.errorTexts) {
    var errorList117 = opt_data.errorTexts;
    var errorListLen117 = errorList117.length;
    for (var errorIndex117 = 0; errorIndex117 < errorListLen117; errorIndex117++) {
      var errorData117 = errorList117[errorIndex117];
      output += '<div class="error">' + soy.$$escapeHtml(errorData117) + '</div>';
    }
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.unrenderableTypeField.soyTemplateName = 'jiraIntegration.templates.fields.unrenderableTypeField';
}


jiraIntegration.templates.fields.dateField = function(opt_data, opt_ignored) {
  return '' + aui.form.textField({labelContent: '' + soy.$$escapeHtml(opt_data.labelText), id: opt_data.name, name: opt_data.name, value: opt_data.value, isRequired: opt_data.isRequired, extraClasses: 'jira-field' + (opt_data.extraClasses ? ' ' + opt_data.extraClasses : ''), extraAttributes: {'data-jira-type': opt_data.jiraType}, errorTexts: opt_data.errorTexts});
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.dateField.soyTemplateName = 'jiraIntegration.templates.fields.dateField';
}


jiraIntegration.templates.fields.select2WithIconField = function(opt_data, opt_ignored) {
  var output = '<div class="field-group jira-field' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" data-jira-type="' + soy.$$escapeHtml(opt_data.jiraType) + '"><label for="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.labelText) + ((opt_data.isRequired) ? '<span class="aui-icon icon-required"></span>' : '') + '</label><select id="' + soy.$$escapeHtml(opt_data.name) + '" name="' + soy.$$escapeHtml(opt_data.name) + '">';
  var optionList154 = opt_data.options;
  var optionListLen154 = optionList154.length;
  for (var optionIndex154 = 0; optionIndex154 < optionListLen154; optionIndex154++) {
    var optionData154 = optionList154[optionIndex154];
    output += '<option value="' + soy.$$escapeHtml(optionData154.value) + '" ' + ((optionData154.selected) ? 'selected' : '') + 'data-icon-url="' + soy.$$escapeHtml(optionData154.iconUrl) + '">' + soy.$$escapeHtml(optionData154.text) + '</option>';
  }
  output += '</select>';
  if (opt_data.errorTexts) {
    var errorList170 = opt_data.errorTexts;
    var errorListLen170 = errorList170.length;
    for (var errorIndex170 = 0; errorIndex170 < errorListLen170; errorIndex170++) {
      var errorData170 = errorList170[errorIndex170];
      output += '<div class="error">' + soy.$$escapeHtml(errorData170) + '</div>';
    }
  }
  output += '</div>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconField.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconField';
}


jiraIntegration.templates.fields.select2WithIconOption = function(opt_data, opt_ignored) {
  return ((opt_data.iconUrl) ? aui.avatar.avatar({avatarImageUrl: opt_data.iconUrl, size: 'xsmall', isProject: opt_data.isProject, extraClasses: 'select-option-image', tagName: 'span'}) : '') + '<span class="select-option" title="' + soy.$$escapeHtml(opt_data.optionValue) + '">' + soy.$$escapeHtml(opt_data.optionValue) + '</span>';
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.select2WithIconOption.soyTemplateName = 'jiraIntegration.templates.fields.select2WithIconOption';
}


jiraIntegration.templates.fields.labelFieldResult = function(opt_data, opt_ignored) {
  return '' + ((opt_data.label.isNew) ? soy.$$escapeHtml(AJS.format('\x22{0}\x22 - (New label)',opt_data.label.labelName)) : soy.$$escapeHtml(opt_data.label.labelName));
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.labelFieldResult.soyTemplateName = 'jiraIntegration.templates.fields.labelFieldResult';
}


jiraIntegration.templates.fields.userOptionSelect = function(opt_data, opt_ignored) {
  var output = '';
  var userOption__soy197 = soy.$$escapeHtml(opt_data.displayName) + ' - (' + soy.$$escapeHtml(opt_data.name) + ')';
  output += '<span title="' + soy.$$filterNoAutoescape(userOption__soy197) + '">' + soy.$$filterNoAutoescape(userOption__soy197) + '</span>';
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.fields.userOptionSelect.soyTemplateName = 'jiraIntegration.templates.fields.userOptionSelect';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/fields.js' */
var jiraIntegration=window.jiraIntegration||{};
jiraIntegration.fields=function(i,e){function l(a,b,c,d){b=a.name;a.value=(i.isPlainObject(d[b])?d[b].name:d[b])||c&&c.fields[b]||"";return a}function r(a){return a.val()}function s(a,b,c,d){b=a.name;a.value=d[b]&&d[b].join(",")||c&&c.fields[b]&&c.fields[b].join(",");return a}function t(a){return e.map(a.val().split(","),i.trim)}function u(a,b,c,d){var g=a.name,d=d[g],c=c&&c.fields[g],f;f=d?i.isArray(d)?e.pluck(d,"name"):[d.name]:c?i.isArray(c)?e.pluck(c,"name"):[c.name]:[];a.options=e.map(b.allowedValues,
function(a){return{value:a.id,text:a.name||a.value,selected:e.contains(f,a.name||a.id)}});a.isMultiple=e.contains(b.operations,"add");return a}function n(a,b){var c=b.val(),d=function(b){var c={};c[a]=b;return c};return b.attr("multiple")?i.isArray(c)?e.map(c,d):[d(c)]:d(c)}function v(a,b,c,d){a=i.extend({restType:b,issueKey:d&&d.key||"",term:c},a);return i.ajax({type:"POST",timeout:0,contentType:"application/json",dataType:"json",url:AJS.contextPath()+"/rest/jira-integration/latest/fields/autocomplete",
data:JSON.stringify(a)})}function w(a){var b;a.id&&(b=i(a.element).attr("data-icon-url"));return jiraIntegration.templates.fields.select2WithIconOption({optionValue:a.text,iconUrl:b})}function o(a){return a.schema?a.schema.system||a.schema.custom||a.schema.customId:a}function p(a){return j[o(a)]}function x(a){return a.closest(".jira-field").attr("data-jira-type")}var k={template:jiraIntegration.templates.fields.stringField,getContext:l,getValue:r},y={template:jiraIntegration.templates.fields.stringField,
getContext:function(a,b,c,d){b=a.name;a.value=d[b]&&d[b].name||c&&c.fields[b]&&c.fields[b].name||"";return a},getValue:function(a){return{name:a.val()}},behavior:function(a,b,c,d){var g=a.find("input"),f=a.attr("name");g.removeClass("text");g.auiSelect2(i.extend({minimumInputLength:1,id:f,name:f,query:function(a){v(b,c,a.term,d).done(function(b){a.callback({results:b})})}},{formatInputTooShort:function(){return "Find users..."},formatResult:function(a){return jiraIntegration.templates.fields.userOptionSelect({name:a.id,
displayName:a.text})}}));a.find("div.aui-select2-container").addClass("jira-select2-drop-box")}},C={template:jiraIntegration.templates.fields.arrayField,getContext:s,getValue:t,behavior:function(a,b,c,d){a=a.find("input");jiraIntegration.fields._labelPicker.build(a,function(a){return v(b,c,a,d)})}},q={template:jiraIntegration.templates.fields.textareaField,getContext:l,getValue:r},D={template:jiraIntegration.templates.fields.numberField,getContext:l,getValue:function(a){a=a.val();return/\d/.test(a)&&
/^-?\d*\.?\d*$/.test(a)?Number(a):a||null}},z={template:jiraIntegration.templates.fields.arrayField,getContext:s,getValue:t},h={template:jiraIntegration.templates.fields.allowedValuesField,getContext:u,getValue:e.bind(n,null,"id"),behavior:function(a){a.find("select[multiple]").auiSelect2()}},A={template:jiraIntegration.templates.fields.allowedValuesField,getContext:u,getValue:e.bind(n,null,"id")},E={template:jiraIntegration.templates.fields.timeTrackingField,getContext:function(a,b,c,d){b=a.name;
a.value=d[b]&&d[b].remainingEstimate||c&&c.fields[b]&&c.fields[b].remainingEstimate||"";return a},getValue:function(a){return{remainingEstimate:a.val()}}},B={template:jiraIntegration.templates.fields.dateField,getContext:l,getValue:function(a){a=a.val();return""===a?null:a},behavior:function(a){var b=a.find("input");if(navigator.userAgent.match(/Trident/)&&"5.3.5">AJS.version)a="placeholder"in document.createElement("input"),b.attr("placeholder","YYYY-MM-DD"),a||b.on("focus",function(){b.val()===
b.attr("placeholder")&&b.val("")}).on("blur",function(){""===b.val()&&b.val(b.attr("placeholder"))}).blur();else{b.datePicker({overrideBrowserDefault:!0});b.attr("placeholder","YYYY-MM-DD");var c=b.attr("data-aui-dp-uuid");b.on("click",function(){i("[data-aui-dp-popup-uuid="+c+"]").parents(".aui-inline-dialog").addClass("jira-create-issue-datepicker-dialog")})}}},F={template:jiraIntegration.templates.fields.select2WithIconField,getContext:function(a,b,c,d){var g=a.name,f=d[g]&&d[g].name||c&&c.fields&&
c.fields[g]&&c.fields[g].name||"";a.options=e.map(b.allowedValues,function(a){return{value:a.id,text:a.name,selected:f===a.name,iconUrl:a.iconUrl}});return a},getValue:e.bind(n,null,"id"),behavior:function(a){i.fn.auiSelect2?(a=a.find("select"),a.addClass("jira-select2-drop-box"),a.auiSelect2({hasAvatar:!0,minimumResultsForSearch:-1,formatSelection:w,formatResult:w})):AJS.log("AUI version 5.2 or greater is required as this plugin needs the .auiSelect2() jQuery plugin.")}},j={"com.pyxis.greenhopper.jira:gh-epic-label":k,
string:k,summary:k,"com.atlassian.jira.plugin.system.customfieldtypes:textfield":k,"com.atlassian.jira.plugin.system.customfieldtypes:url":k,environment:q,"com.atlassian.jira.plugin.system.customfieldtypes:textarea":q,description:q,"com.atlassian.jira.plugin.system.customfieldtypes:float":D,array:z,labels:C,"com.atlassian.jira.plugin.system.customfieldtypes:labels":z,resolution:h,fixVersions:h,priority:F,versions:h,components:h,security:h,"com.atlassian.jira.plugin.system.customfieldtypes:version":h,
"com.atlassian.jira.plugin.system.customfieldtypes:multiversion":h,"com.atlassian.jira.plugin.system.customfieldtypes:project":h,assignee:y,reporter:y,timetracking:E,duedate:B,"com.atlassian.jira.plugin.system.customfieldtypes:datepicker":B,"com.atlassian.jira.plugin.system.customfieldtypes:multiselect":A,"com.atlassian.jira.plugin.system.customfieldtypes:select":A},G={ignoreFieldsWithDefaultValue:!1};return{addFieldHandler:function(a,b){e.has(j,a)&&(console&&console.warn)&&console.warn("Redefining handler for type "+
a+".");j[a]=b},getFieldHandler:p,canRender:function(a){var b=o(a),b=j[b];return!b?!1:a.operations&&a.operations.length&&(!b.canRender||b.canRender(a))},renderField:function(a,b,c,d){var g=b.schema.system||b.schema.custom||b.schema.customId,f=j[g],e=b.schema.system||"customfield_"+b.schema.customId,d={labelText:b.name,name:e,isRequired:b.required,errorTexts:(d||{})[e],jiraType:g},g=!f||f.canRender&&!f.canRender(b),e=!b.operations||!b.operations.length;if(g||e){d.reasonContent=g?AJS.format("{0}Edit{1} this field in JIRA",
'<a href="'+(a?a.url:"#")+'">',"</a>"):e?AJS.format("{0}Edit{1} this field in JIRA",'<a href="'+(a?a.url:"#")+'">',"</a>"):null;if(!d.reasonContent)throw Error("Invalid unrenderable reason.");return jiraIntegration.templates.fields.unrenderableTypeField(d)}return f.template(f.getContext(d,b,a,c||{}))},getJSON:function(a){var b;return(b=(b=x(a))&&p(b))&&b.getValue&&b.getValue(a)},attachFieldBehaviors:function(a,b,c){a.find(".jira-field").each(function(a,e){var f=i(e),h=x(f),m=h&&p(h);(m=m&&m.behavior)&&
m(f,b,h,c)})},renderCreateRequiredFields:function(a,b,c,d,g){function f(b){d.ignoreFieldsWithDefaultValue&&(b=e.filter(b,function(a){return!a.hasDefaultValue}));var f=e.filter(b,function(a){return!jiraIntegration.fields.canRender(a)});f.length?g&&g(f):(a.html(e.map(b,function(a){return jiraIntegration.fields.renderField(null,a,null,null)}).join("")),jiraIntegration.fields.attachFieldBehaviors(a,{serverId:c.serverId,projectKey:c.projectKey},null))}d=e.extend({},G,d);if(d.requiredFields)f(d.requiredFields);
else{var b=c,h=d;i.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+b.serverId+"/projects/"+b.projectKey+"/issue-types/"+b.issueType+"/fields-meta"}).pipe(function(a){var b=[];e.each(a.fields,function(a){var c=o(a);a.required&&!e.contains(h.excludedFields,c)&&b.push(a)});return b}).done(f)}}}}(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:fields', location = '/fields/label-picker.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.fields=jiraIntegration.fields||{};jiraIntegration.fields._labelPicker=function(){return{build:function(b,c){b.auiSelect2({tags:!0,multiple:!0,tokenSeparators:[","," "],createSearchChoice:function(a){return!a?null:{id:a,text:a,isNew:!0}},query:function(a){c(a.term).done(function(b){a.callback({results:b})})},formatResult:function(a){return jiraIntegration.templates.fields.labelFieldResult({label:{labelName:a.text,isNew:a.isNew}})}})}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugin.jslibs:underscore-1.5.2', location = 'libs/underscore/1.5.2/underscore-1.5.2.js' */
'use strict';(function(p){define("atlassian/libs/underscore-1.5.2",function(){var t={};p.call(t);return"undefined"!==typeof exports?"undefined"!==typeof module&&module.exports?module.exports.noConflict():exports.noConflict():t._.noConflict()})})(function(){(function(){var p=this,t=p._,u={},m=Array.prototype,v=Object.prototype,y=m.push,k=m.slice,w=m.concat,q=v.toString,Q=v.hasOwnProperty,G=m.forEach,H=m.map,I=m.reduce,J=m.reduceRight,K=m.filter,L=m.every,M=m.some,x=m.indexOf,N=m.lastIndexOf;v=Array.isArray;
var R=Object.keys,z=Function.prototype.bind,b=function(a){if(a instanceof b)return a;if(!(this instanceof b))return new b(a);this._wrapped=a};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=b),exports._=b):p._=b;b.VERSION="1.5.2";var l=b.each=b.forEach=function(a,c,d){if(null!=a)if(G&&a.forEach===G)a.forEach(c,d);else if(a.length===+a.length)for(var e=0,g=a.length;e<g&&c.call(d,a[e],e,a)!==u;e++);else{var f=b.keys(a);e=0;for(g=f.length;e<g&&c.call(d,
a[f[e]],f[e],a)!==u;e++);}};b.map=b.collect=function(a,c,b){var d=[];if(null==a)return d;if(H&&a.map===H)return a.map(c,b);l(a,function(a,e,h){d.push(c.call(b,a,e,h))});return d};b.reduce=b.foldl=b.inject=function(a,c,d,e){var g=2<arguments.length;null==a&&(a=[]);if(I&&a.reduce===I)return e&&(c=b.bind(c,e)),g?a.reduce(c,d):a.reduce(c);l(a,function(a,b,n){g?d=c.call(e,d,a,b,n):(d=a,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return d};b.reduceRight=b.foldr=function(a,
c,d,e){var g=2<arguments.length;null==a&&(a=[]);if(J&&a.reduceRight===J)return e&&(c=b.bind(c,e)),g?a.reduceRight(c,d):a.reduceRight(c);var f=a.length;if(f!==+f){var h=b.keys(a);f=h.length}l(a,function(b,k,l){k=h?h[--f]:--f;g?d=c.call(e,d,a[k],k,l):(d=a[k],g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return d};b.find=b.detect=function(a,c,b){var d;O(a,function(a,e,h){if(c.call(b,a,e,h))return d=a,!0});return d};b.filter=b.select=function(a,c,b){var d=[];if(null==
a)return d;if(K&&a.filter===K)return a.filter(c,b);l(a,function(a,e,h){c.call(b,a,e,h)&&d.push(a)});return d};b.reject=function(a,c,d){return b.filter(a,function(a,b,f){return!c.call(d,a,b,f)},d)};b.every=b.all=function(a,c,d){c||(c=b.identity);var e=!0;if(null==a)return e;if(L&&a.every===L)return a.every(c,d);l(a,function(a,b,h){if(!(e=e&&c.call(d,a,b,h)))return u});return!!e};var O=b.some=b.any=function(a,c,d){c||(c=b.identity);var e=!1;if(null==a)return e;if(M&&a.some===M)return a.some(c,d);l(a,
function(a,b,h){if(e||(e=c.call(d,a,b,h)))return u});return!!e};b.contains=b.include=function(a,c){return null==a?!1:x&&a.indexOf===x?-1!=a.indexOf(c):O(a,function(a){return a===c})};b.invoke=function(a,c){var d=k.call(arguments,2),e=b.isFunction(c);return b.map(a,function(a){return(e?c:a[c]).apply(a,d)})};b.pluck=function(a,c){return b.map(a,function(a){return a[c]})};b.where=function(a,c,d){return b.isEmpty(c)?d?void 0:[]:b[d?"find":"filter"](a,function(a){for(var b in c)if(c[b]!==a[b])return!1;
return!0})};b.findWhere=function(a,c){return b.where(a,c,!0)};b.max=function(a,c,d){if(!c&&b.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!c&&b.isEmpty(a))return-Infinity;var e={computed:-Infinity,value:-Infinity};l(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b>e.computed&&(e={value:a,computed:b})});return e.value};b.min=function(a,c,d){if(!c&&b.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!c&&b.isEmpty(a))return Infinity;var e={computed:Infinity,
value:Infinity};l(a,function(a,b,h){b=c?c.call(d,a,b,h):a;b<e.computed&&(e={value:a,computed:b})});return e.value};b.shuffle=function(a){var c,d=0,e=[];l(a,function(a){c=b.random(d++);e[d-1]=e[c];e[c]=a});return e};b.sample=function(a,c,d){return 2>arguments.length||d?a[b.random(a.length-1)]:b.shuffle(a).slice(0,Math.max(0,c))};var A=function(a){return b.isFunction(a)?a:function(c){return c[a]}};b.sortBy=function(a,c,d){var e=A(c);return b.pluck(b.map(a,function(a,c,b){return{value:a,index:c,criteria:e.call(d,
a,c,b)}}).sort(function(a,c){var b=a.criteria,d=c.criteria;if(b!==d){if(b>d||void 0===b)return 1;if(b<d||void 0===d)return-1}return a.index-c.index}),"value")};var B=function(a){return function(c,d,e){var g={},f=null==d?b.identity:A(d);l(c,function(b,d){d=f.call(e,b,d,c);a(g,d,b)});return g}};b.groupBy=B(function(a,c,d){(b.has(a,c)?a[c]:a[c]=[]).push(d)});b.indexBy=B(function(a,c,b){a[c]=b});b.countBy=B(function(a,c){b.has(a,c)?a[c]++:a[c]=1});b.sortedIndex=function(a,c,d,e){d=null==d?b.identity:
A(d);c=d.call(e,c);for(var g=0,f=a.length;g<f;){var h=g+f>>>1;d.call(e,a[h])<c?g=h+1:f=h}return g};b.toArray=function(a){return a?b.isArray(a)?k.call(a):a.length===+a.length?b.map(a,b.identity):b.values(a):[]};b.size=function(a){return null==a?0:a.length===+a.length?a.length:b.keys(a).length};b.first=b.head=b.take=function(a,c,b){if(null!=a)return null==c||b?a[0]:k.call(a,0,c)};b.initial=function(a,c,b){return k.call(a,0,a.length-(null==c||b?1:c))};b.last=function(a,c,b){if(null!=a)return null==c||
b?a[a.length-1]:k.call(a,Math.max(a.length-c,0))};b.rest=b.tail=b.drop=function(a,c,b){return k.call(a,null==c||b?1:c)};b.compact=function(a){return b.filter(a,b.identity)};var P=function(a,c,d){if(c&&b.every(a,b.isArray))return w.apply(d,a);l(a,function(a){b.isArray(a)||b.isArguments(a)?c?y.apply(d,a):P(a,c,d):d.push(a)});return d};b.flatten=function(a,c){return P(a,c,[])};b.without=function(a){return b.difference(a,k.call(arguments,1))};b.uniq=b.unique=function(a,c,d,e){b.isFunction(c)&&(e=d,d=
c,c=!1);d=d?b.map(a,d,e):a;var g=[],f=[];l(d,function(d,e){(c?e&&f[f.length-1]===d:b.contains(f,d))||(f.push(d),g.push(a[e]))});return g};b.union=function(){return b.uniq(b.flatten(arguments,!0))};b.intersection=function(a){var c=k.call(arguments,1);return b.filter(b.uniq(a),function(a){return b.every(c,function(c){return 0<=b.indexOf(c,a)})})};b.difference=function(a){var c=w.apply(m,k.call(arguments,1));return b.filter(a,function(a){return!b.contains(c,a)})};b.zip=function(){for(var a=b.max(b.pluck(arguments,
"length").concat(0)),c=Array(a),d=0;d<a;d++)c[d]=b.pluck(arguments,""+d);return c};b.object=function(a,c){if(null==a)return{};for(var b={},e=0,g=a.length;e<g;e++)c?b[a[e]]=c[e]:b[a[e][0]]=a[e][1];return b};b.indexOf=function(a,c,d){if(null==a)return-1;var e=0,g=a.length;if(d)if("number"==typeof d)e=0>d?Math.max(0,g+d):d;else return e=b.sortedIndex(a,c),a[e]===c?e:-1;if(x&&a.indexOf===x)return a.indexOf(c,d);for(;e<g;e++)if(a[e]===c)return e;return-1};b.lastIndexOf=function(a,c,b){if(null==a)return-1;
var d=null!=b;if(N&&a.lastIndexOf===N)return d?a.lastIndexOf(c,b):a.lastIndexOf(c);for(b=d?b:a.length;b--;)if(a[b]===c)return b;return-1};b.range=function(a,b,d){1>=arguments.length&&(b=a||0,a=0);d=arguments[2]||1;for(var c=Math.max(Math.ceil((b-a)/d),0),g=0,f=Array(c);g<c;)f[g++]=a,a+=d;return f};var C=function(){};b.bind=function(a,c){var d;if(z&&a.bind===z)return z.apply(a,k.call(arguments,1));if(!b.isFunction(a))throw new TypeError;var e=k.call(arguments,2);return d=function(){if(!(this instanceof
d))return a.apply(c,e.concat(k.call(arguments)));C.prototype=a.prototype;var b=new C;C.prototype=null;var f=a.apply(b,e.concat(k.call(arguments)));return Object(f)===f?f:b}};b.partial=function(a){var b=k.call(arguments,1);return function(){return a.apply(this,b.concat(k.call(arguments)))}};b.bindAll=function(a){var c=k.call(arguments,1);if(0===c.length)throw Error("bindAll must be passed function names");l(c,function(c){a[c]=b.bind(a[c],a)});return a};b.memoize=function(a,c){var d={};c||(c=b.identity);
return function(){var e=c.apply(this,arguments);return b.has(d,e)?d[e]:d[e]=a.apply(this,arguments)}};b.delay=function(a,b){var c=k.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};b.defer=function(a){return b.delay.apply(b,[a,1].concat(k.call(arguments,1)))};b.throttle=function(a,b,d){var c,g,f,h=null,k=0;d||(d={});var l=function(){k=!1===d.leading?0:new Date;h=null;f=a.apply(c,g)};return function(){var e=new Date;k||!1!==d.leading||(k=e);var n=b-(e-k);c=this;g=arguments;
0>=n?(clearTimeout(h),h=null,k=e,f=a.apply(c,g)):h||!1===d.trailing||(h=setTimeout(l,n));return f}};b.debounce=function(a,b,d){var c,g,f,h,k;return function(){f=this;g=arguments;h=new Date;var e=function(){var l=new Date-h;l<b?c=setTimeout(e,b-l):(c=null,d||(k=a.apply(f,g)))},l=d&&!c;c||(c=setTimeout(e,b));l&&(k=a.apply(f,g));return k}};b.once=function(a){var b=!1,d;return function(){if(b)return d;b=!0;d=a.apply(this,arguments);a=null;return d}};b.wrap=function(a,b){return function(){var c=[a];y.apply(c,
arguments);return b.apply(this,c)}};b.compose=function(){var a=arguments;return function(){for(var b=arguments,d=a.length-1;0<=d;d--)b=[a[d].apply(this,b)];return b[0]}};b.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};b.keys=R||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var c=[],d;for(d in a)b.has(a,d)&&c.push(d);return c};b.values=function(a){for(var c=b.keys(a),d=c.length,e=Array(d),g=0;g<d;g++)e[g]=a[c[g]];return e};b.pairs=function(a){for(var c=
b.keys(a),d=c.length,e=Array(d),g=0;g<d;g++)e[g]=[c[g],a[c[g]]];return e};b.invert=function(a){for(var c={},d=b.keys(a),e=0,g=d.length;e<g;e++)c[a[d[e]]]=d[e];return c};b.functions=b.methods=function(a){var c=[],d;for(d in a)b.isFunction(a[d])&&c.push(d);return c.sort()};b.extend=function(a){l(k.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};b.pick=function(a){var b={},d=w.apply(m,k.call(arguments,1));l(d,function(c){c in a&&(b[c]=a[c])});return b};b.omit=function(a){var c=
{},d=w.apply(m,k.call(arguments,1)),e;for(e in a)b.contains(d,e)||(c[e]=a[e]);return c};b.defaults=function(a){l(k.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};b.clone=function(a){return b.isObject(a)?b.isArray(a)?a.slice():b.extend({},a):a};b.tap=function(a,b){b(a);return a};var D=function(a,c,d,e){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;a instanceof b&&(a=a._wrapped);c instanceof b&&(c=c._wrapped);var g=q.call(a);if(g!=q.call(c))return!1;
switch(g){case "[object String]":return a==String(c);case "[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case "[object Date]":case "[object Boolean]":return+a==+c;case "[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;for(var f=d.length;f--;)if(d[f]==a)return e[f]==c;f=a.constructor;var h=c.constructor;if(f!==h&&!(b.isFunction(f)&&f instanceof f&&b.isFunction(h)&&h instanceof
h))return!1;d.push(a);e.push(c);f=0;h=!0;if("[object Array]"==g){if(f=a.length,h=f==c.length)for(;f--&&(h=D(a[f],c[f],d,e)););}else{for(var k in a)if(b.has(a,k)&&(f++,!(h=b.has(c,k)&&D(a[k],c[k],d,e))))break;if(h){for(k in c)if(b.has(c,k)&&!f--)break;h=!f}}d.pop();e.pop();return h};b.isEqual=function(a,b){return D(a,b,[],[])};b.isEmpty=function(a){if(null==a)return!0;if(b.isArray(a)||b.isString(a))return 0===a.length;for(var c in a)if(b.has(a,c))return!1;return!0};b.isElement=function(a){return!(!a||
1!==a.nodeType)};b.isArray=v||function(a){return"[object Array]"==q.call(a)};b.isObject=function(a){return a===Object(a)};l("Arguments Function String Number Date RegExp".split(" "),function(a){b["is"+a]=function(b){return q.call(b)=="[object "+a+"]"}});b.isArguments(arguments)||(b.isArguments=function(a){return!(!a||!b.has(a,"callee"))});"function"!==typeof/./&&(b.isFunction=function(a){return"function"===typeof a});b.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};b.isNaN=function(a){return b.isNumber(a)&&
a!=+a};b.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==q.call(a)};b.isNull=function(a){return null===a};b.isUndefined=function(a){return void 0===a};b.has=function(a,b){return Q.call(a,b)};b.noConflict=function(){p._=t;return this};b.identity=function(a){return a};b.times=function(a,b,d){for(var c=Array(Math.max(0,a)),g=0;g<a;g++)c[g]=b.call(d,g);return c};b.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var r={escape:{"\x26":"\x26amp;","\x3c":"\x26lt;",
"\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26#x27;"}};r.unescape=b.invert(r.escape);var S={escape:new RegExp("["+b.keys(r.escape).join("")+"]","g"),unescape:new RegExp("("+b.keys(r.unescape).join("|")+")","g")};b.each(["escape","unescape"],function(a){b[a]=function(b){return null==b?"":(""+b).replace(S[a],function(b){return r[a][b]})}});b.result=function(a,c){if(null!=a)return c=a[c],b.isFunction(c)?c.call(a):c};b.mixin=function(a){l(b.functions(a),function(c){var d=b[c]=a[c];b.prototype[c]=function(){var a=
[this._wrapped];y.apply(a,arguments);return E.call(this,d.apply(b,a))}})};var T=0;b.uniqueId=function(a){var b=++T+"";return a?a+b:b};b.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var F=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g,W=/^\s*(\w|\$)+\s*$/;b.template=function(a,c,d){d=b.defaults({},d,b.templateSettings);var e=new RegExp([(d.escape||F).source,(d.interpolate||
F).source,(d.evaluate||F).source].join("|")+"|$","g"),g=0,f="__p+\x3d'";a.replace(e,function(b,c,d,e,h){f+=a.slice(g,h).replace(V,function(a){return"\\"+U[a]});c&&(f+="'+\n((__t\x3d("+c+"))\x3d\x3dnull?'':_.escape(__t))+\n'");d&&(f+="'+\n((__t\x3d("+d+"))\x3d\x3dnull?'':__t)+\n'");e&&(f+="';\n"+e+"\n__p+\x3d'");g=h+b.length;return b});f+="';\n";if(d=d.variable){if(!W.test(d))throw Error("variable is not a bare identifier: "+d);}else f="with(obj||{}){\n"+f+"}\n",d="obj";f="var __t,__p\x3d'',__j\x3dArray.prototype.join,print\x3dfunction(){__p+\x3d__j.call(arguments,'');};\n"+
f+"return __p;\n";try{var h=new Function(d,"_",f)}catch(n){throw n.source=f,n;}if(c)return h(c,b);c=function(a){return h.call(this,a,b)};c.source="function("+d+"){\n"+f+"}";return c};b.chain=function(a){return b(a).chain()};var E=function(a){return this._chain?b(a).chain():a};b.mixin(b);l("pop push reverse shift sort splice unshift".split(" "),function(a){var c=m[a];b.prototype[a]=function(){var b=this._wrapped;c.apply(b,arguments);"shift"!=a&&"splice"!=a||0!==b.length||delete b[0];return E.call(this,
b)}});l(["concat","join","slice"],function(a){var c=m[a];b.prototype[a]=function(){return E.call(this,c.apply(this._wrapped,arguments))}});b.extend(b.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}})}).call(this)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:lodash-amd', location = 'applinks/internal/lib/lodash-jslibs.js' */
define('applinks/lib/lodash', ['atlassian/libs/underscore-1.5.2'], function(lodash) {
        return lodash;
    });
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/lib-version.js' */
// NOTE: this is in "lib" because it's required by aui-amd.js. This module _cannot_ have any dependencies on non-lib
// modules (like "common")
define('applinks/lib/version', [
    'applinks/lib/lodash'
], function(
    _
) {

    function checkIntValue(value, desc) {
        if (_.isUndefined(value)) {
            return 0;
        } else if (typeof value !== 'number' || isNaN(value)) {
            throw new Error(desc + ': expected a number, was: <' + value + '>');
        } else {
            return Math.floor(value);
        }
    }

    function checkVersionObject(object, desc) {
        if (!object || !(object instanceof Version)) {
            throw new Error(desc + ': expected a Version object, was: <' + object + '>');
        }
        return object;
    }

    function compareInt(intOne, intTwo) {
        return intOne > intTwo ? 1 : intOne == intTwo ? 0 : -1;
    }

    /**
     * Constructs a version object that contains version information and can be compared with other version objects.
     *
     * @param major major version component
     * @param minor minor version component
     * @param bugfix bugfix version component
     * @constructor
     */
    function Version(major, minor, bugfix) {
        this.major = checkIntValue(major, 'major');
        this.minor = checkIntValue(minor, 'minor');
        this.bugfix = checkIntValue(bugfix, 'bugfix');
    }

    /**
     * Constructs a Version by parsing a version string.
     *
     * @param versionString version string to parse, expected to be in the form of <major>.<minor>.<bugfix>
     * @param versionDesc what version does the `versionString` represent
     */
    Version.parse = function(versionString, versionDesc) {
        versionDesc = versionDesc || 'versionString';
        if (!versionString) {
            throw new Error(versionDesc + ': expected a non-empty string');
        }
        var versionSplit = versionString.split('.');
        if (versionSplit.length !== 3) {
            throw new Error(versionDesc + ': expected <major>.<minor>.<bugfix> string, was: <' + versionString + '>');
        }
        return new Version(parseInt(versionSplit[0]), parseInt(versionSplit[1]), parseInt(versionSplit[2]));
    };

    /**
     * Comparator function to sort Version objects.
     *
     * @param versionOne first version object
     * @param versionTwo second version object
     * @returns {Number} comparison result
     * @see Version.compareTo(that)
     */
    Version.comparator = function(versionOne, versionTwo) {
        return checkVersionObject(versionOne, 'versionOne').compareTo(checkVersionObject(versionTwo, 'versionTwo'));
    };

    /**
     * Return -1, 0 or 1 as this Version object represents a version less than, equal to, or greater than `that`.
     *
     * @param that the other version to compare to
     * @returns {Number} comparison result
     */
    Version.prototype.compareTo = function(that) {
        checkVersionObject(that, 'that');
        var majorResult = compareInt(this.major, that.major);
        if (majorResult != 0) {
            return majorResult;
        }
        var minorResult = compareInt(this.minor, that.minor);
        if (minorResult != 0) {
            return minorResult;
        }
        return compareInt(this.bugfix, that.bugfix);
    };

    Version.prototype.greaterThan = function(that) {
        return this.compareTo(that) > 0;
    };

    Version.prototype.greaterThanOrEqual = function(that) {
        return this.compareTo(that) >= 0;
    };

    Version.prototype.lessThan = function(that) {
        return this.compareTo(that) < 0;
    };

    Version.prototype.lessThanOrEqual = function(that) {
        return this.compareTo(that) <= 0;
    };

    Version.prototype.equals = function(that) {
        return this.compareTo(that) == 0;
    };

    Version.prototype.toMinor = function() {
        return new Version(this.major, this.minor);
    };

    Version.prototype.toMajor = function() {
        return new Version(this.major);
    };

    Version.prototype.toString = function() {
        return this.major + '.' + this.minor + '.' + this.bugfix;
    };

    return Version;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/aui-version-details.js' */
define('applinks/lib/aui-version-details', [
    'applinks/lib/version'
], function(
    Version
) {
    // minimum 5.8.x and 5.9.x AUI versions - lower versions ship with bugs that break some of the Applinks functionality
    var MINIMUM_58_VERSION = new Version(5, 8, 15);
    var MINIMUM_59_VERSION = new Version(5, 9, 13);
    var VERSION_58 = new Version(5, 8);
    var VERSION_59 = new Version(5, 9);

    function checkVersion(version) {
        // must be >= the minimum required 5.8.x version
        if (version.lessThan(MINIMUM_58_VERSION)) {
            throw new Error('AUI version ' + version + ' is too low, you need to upgrade AUI to ' + MINIMUM_58_VERSION +
                ' or ' + MINIMUM_59_VERSION + ' for Applinks to work');
        }
        // if 5.9, must be >= the minimum required 5.9.x version
        if (version.greaterThanOrEqual(VERSION_59) && version.lessThan(MINIMUM_59_VERSION)) {
            throw new Error('AUI version ' + version + ' is too low, you need to upgrade AUI to ' + MINIMUM_59_VERSION +
                ' for Applinks to work');
        }
    }

    function addVersionDetails(AJS) {
        var ajsVersion = Version.parse(AJS.version, 'AUI version');
        checkVersion(ajsVersion);

        AJS.versionDetails = ajsVersion;
        AJS.versionDetails.is58 = ajsVersion.toMinor().equals(VERSION_58);
        AJS.versionDetails.is59 = ajsVersion.toMinor().equals(VERSION_59);

        return AJS;
    }

    return  {
        /**
         * Check AUI version for compatibility with Applinks and add `versionDetails` field.
         */
        addVersionDetails: addVersionDetails
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/console-amd.js' */
define('applinks/lib/console', function() {
    return window.console;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/jquery-amd.js' */
define('applinks/lib/jquery', function() {
   return window.jQuery;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/aui-amd.js' */
define('applinks/lib/aui', [
    'applinks/lib/window',
    'applinks/lib/aui-version-details'
], function(
    window,
    VersionDetails
) {
    var AJS = window.AJS;
    if (!AJS) {
        throw new Error('window.AJS not defined, cannot load AUI');
    }

    return VersionDetails.addVersionDetails(AJS);
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/wrm-amd.js' */
/**
 * Define Web resource manager as an AMD dependency. This should also be present in apps using Atlassian Plugins Web
 * Resources framework.
 */
define('applinks/lib/wrm', function() {
   return window.WRM;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/skate-amd.js' */
define('applinks/lib/skate', function() {
   // window.skate is not exposed as a global from AUI 5.9, this will return undefined with that version or later
   return window.skate;
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-lib', location = 'applinks/internal/lib/window-amd.js' */
/**
 * Define window as AMD module to facilitate unit testing of some modules
 */
define('applinks/lib/window', function() {
    return window;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/events.js' */
define('applinks/common/events', [
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/lib/window',
    'applinks/common/preconditions'
], function(
    $,
    _,
    window,
    Preconditions
) {
    var PREFIX = 'applinks.event.';

    function applinksEvent(eventId) {
        return PREFIX + Preconditions.nonEmptyString(eventId, 'eventId');
    }

    /**
     * Provides common Applinks event IDs and a simple event system facade API. This is a preferred way to subscribe to
     * and raise Applinks-specific events as it does not depend on a specific event bus or event target (such as
     * `document`), as well as facilitates unit testing.
     */
    return {
        PREREADY: applinksEvent('preready'),
        READY: applinksEvent('ready'),

        /**
         * Raised when applinks list is first loaded
         */
        APPLINKS_LOADED: applinksEvent('loaded'),
        /**
         * Raised when applinks list is updated
         */
        APPLINKS_UPDATED: applinksEvent('updated'),

        /**
         * This event is only raised when linking to Atlassian applications
         * Can be consumed by other plugins
         */
        NEW_APPLINK_CREATED: applinksEvent('created'),

        // legacy events
        Legacy: {
            MESSAGE_BOX_DISPLAYED: applinksEvent('message-box-displayed')
        },

        applinksEvent: applinksEvent,

        on: function(events, handler, context) {
            var handlerWithContext = context ? _.bind(handler, context) : handler;
            $(window.document).on(events, handlerWithContext);
        },

        off: function(events, handler) {
            $(window.document).off(events, handler);
        },

        trigger: function(event, data) {
            $(window.document).trigger(event, data);
        }
    }
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/i18n.js' */
define('applinks/common/i18n', [
    'applinks/lib/lodash',
    'applinks/lib/jquery',
    'applinks/lib/wrm',
    'applinks/common/modules',
    'applinks/common/preconditions',
    'applinks/common/products'
], function(
    _,
    $,
    WRM,
    ApplinksModules,
    Preconditions,
    ApplinksProducts
) {
    var getAllEntityTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'entity-types'));
        return Preconditions.hasValue(val, 'entity-types', 'Entity Types data not found');
    });

    var getAllAuthTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'authentication-types'));
        return Preconditions.hasValue(val, 'authentication-types', 'Authentication Types data not found');
    });

    return {
        
        /**
         * @param typeId ID of the application type to resolve
         * @returns {string} resolved i18n-ed type name, or the original `typeId` if there is no mapping
         */
        getApplicationTypeName: function(typeId) {
            return ApplinksProducts.getTypeName(typeId);
        },

        /**
         * @param typeId ID of the entity type to resolve
         * @returns {string} resolved i18n-ed singular entity type name, or the original `typeId` if there is no mapping
         */
        getEntityTypeName: function(typeId) {
            return getAllEntityTypes().singular[typeId] || typeId;
        },

        /**
         * @param typeId ID of the entity type to resolve
         * @returns {string} resolved i18n-ed plural entity type name, or the original `typeId` if there is no mapping
         */
        getPluralizedEntityTypeName: function(typeId) {
            return getAllEntityTypes().plural[typeId] || typeId;
        },

        /**
         * @param type ID of the authentication type to resolve (usually in a form of full class name)
         * @returns {string} resolved i18n-ed authentication type name, or the original `type` if there is no mapping
         */
        getAuthenticationTypeName: function(type) {
            return getAllAuthTypes()[type] || type;
        }
    };
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/modules.js' */
/**
 * Applinks plugin modules core constants and definitions.
 */
define('applinks/common/modules', function() {
    return {
        /**
         * Applinks plugin key
         */
        PLUGIN_KEY: 'com.atlassian.applinks.applinks-plugin',

        // key web resource keys
        COMMON_EXPORTED: 'applinks-common-exported',
        COMMON: 'applinks-common',

        /**
         * Fully qualifies a module name using the plugin key.
         *
         * @param {string} moduleName module name to qualify
         * @returns {string} fully qualified name
         */
        fqn: function(moduleName) {
            return this.PLUGIN_KEY + ':' + moduleName;
        },

        /**
         * Fully qualifies web-resource data using module name and data key.
         *
         * @param {string} moduleName module name
         * @param {string} dataKey key of the data element
         * @returns {string} fully qualified name
         */
        dataFqn: function(moduleName, dataKey) {
            return this.fqn(moduleName) + '.' + dataKey;
        }
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/preconditions.js' */
define('applinks/common/preconditions', [
    'applinks/lib/lodash'
], function(
    _
) {
    function nonEmptyString(value, varName, customMessage) {
        return _checkArgument(
            _.isString(value) && !_.isEmpty(value),
            customMessage,
            _withVarName(varName, ': expected a non-empty string, was: <' + value + '>'),
            value
        );
    }

    function isFunction(value, varName, customMessage) {
        return _checkArgument(
            _.isFunction(value),
            customMessage,
            _withVarName(varName, ': expected a function, was: ' + value),
            value
        );
    }

    function isArray(value, varName, customMessage) {
        return _checkArgument(
            _.isArray(value),
            customMessage,
            _withVarName(varName, ': expected an array, was: ' + value),
            value
        );
    }

    function hasValue(value, varName, customMessage) {
        return _checkArgument(
            value,
            customMessage,
            _withVarName(varName, ': expected a value'),
            value
        );
    }

    function _checkArgument(test, message, defaultMessage, actualValue) {
        var actualMessage = message ? message : defaultMessage;
        if (!test) {
            throw new Error(actualMessage)
        }
        return actualValue || test;
    }

    function _withVarName(varName, msg) {
        return (varName || '[unspecified]') + msg;
    }

    return {
        checkArgument: _.partial(_checkArgument, _, _, '', _),
        nonEmptyString: nonEmptyString,
        isArray: isArray,
        isFunction: isFunction,
        hasValue: hasValue
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-common-exported', location = 'applinks/internal/common/products.js' */
define('applinks/common/products', [
    'applinks/lib/lodash',
    'applinks/lib/wrm',
    'applinks/common/modules',
    'applinks/common/preconditions'
], function(
    _,
    WRM,
    ApplinksModules,
    Preconditions
) {
    var getAllTypes = _.memoize(function() {
        var val = WRM.data.claim(ApplinksModules.dataFqn(ApplinksModules.COMMON_EXPORTED, 'applinks-types'));
        return Preconditions.hasValue(val, 'types', 'Application Types data not found');
    });

    /**
     * @param typeId ID of the application type to resolve
     * @returns {string} resolved i18n-ed type name, or the original `typeId` if there is no mapping
     */
    function getTypeName(typeId) {
        return getAllTypes()[typeId] || typeId;
    }

    /**
     * Map of Atlassian product keys to application type IDs
     */
    return {
        BAMBOO: 'bamboo',
        BITBUCKET: 'stash', // special case, see java class com.atlassian.applinks.application.bitbucket.BitbucketApplicationTypeImpl.TYPE_ID
        CONFLUENCE: 'confluence',
        FECRU: 'fecru',
        JIRA: 'jira',
        REFAPP: 'refapp',
        STASH: 'stash',
        getTypeName: getTypeName
    };
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/non-amd/rest-service.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

(function(AppLinksI18n, ApplinksEvents) {
    /**
     * The triggering of AppLinks initialisation can be customised by setting a function on
     * AJS.AppLinksInitialisationBinder. The binder function should take a single argument which is a zero-arg function to
     * run and should execute this function when appropriate.
     */
    AppLinks = AJS.$.extend(window.AppLinks || {}, {
        Event: {
            NAMESPACE: 'applinks'
        },
        I18n: AppLinksI18n
    });
    AppLinks.Event = AJS.$.extend(window.AppLinks.Event, ApplinksEvents);

    // Is there an overridden initialisation binder?
    if (AJS.AppLinksInitialisationBinder) {
        AppLinks.initialisationBinder = AJS.AppLinksInitialisationBinder;
    } else {
        // The default bind if no specific binder is specified
        AppLinks.initialisationBinder = function(f) {
            AJS.toInit(f);
        }
    }

    AppLinks.initialisationBinder(function() {
        //$ is passed in by AJS.toInit but initilizationBinder can be over loaded by products so that $ is unsafe.
        var $ = AJS.$;
        AppLinks = $.extend(window.AppLinks || {}, {
            failure: function(data) {
                if (data.status == 401) {
                    window.location.reload();
                } else {
                    var message = AppLinks.parseError(data);
                    var errorDivs = $('.page-error');

                    if (errorDivs.length > 0) {
                        errorDivs.html(message).fadeIn('slow');
                    } else {
                        alert('REST request failed: ' + message);
                    }
                }
            },
            jsonRequest: function(url, type, data, success, error) {
                if (data) {
                    data = JSON.stringify(data);
                }
                $(".page-error").fadeOut('fast');
                if (!error) error = AppLinks.failure;
                return jQuery.ajax({
                    url: url,
                    type: type,
                    data: data,
                    dataType: 'json',
                    contentType: "application/json; charset=utf-8",
                    cache: false,
                    success: success,
                    error: error,
                    jsonp: false
                });
            },
            xmlRequest: function(url, type, data, success, error) {
                if (data) {
                    data = JSON.stringify(data);
                }
                $(".page-error").fadeOut('fast');
                if (!error) error = AppLinks.failure;
                return jQuery.ajax({
                    url: url,
                    type: type,
                    data: data,
                    dataType: 'xml',
                    contentType: "application/xml; charset=utf-8",
                    cache: false,
                    success: success,
                    error: error
                });
            },
            parseError: function(errorData) {
                var error;
                try {
                    error = JSON.parse(errorData.responseText);
                } catch (e) {
                    if (errorData.statusText) {
                        return error = errorData.statusText;
                    } else {
                        return errorData;
                    }
                }
                if (error.message) {
                    if ($.isArray(error.message)) {
                        return error.message.join(' ');
                    }
                    return error.message;
                }
                else {
                    return errorData.statusText;
                }
            },
            put: function(url, data, success, error) {
                return AppLinks.jsonRequest(url, 'PUT', data, success, error);
            },
            post: function(url, data, success, error) {
                return AppLinks.jsonRequest(url, 'POST', data, success, error);
            },
            update: function(data, success, error) {
                AppLinks.put(AppLinks.self_link(data), data, success, error);
            },
            get: function(url, success, error) {
                return AppLinks.jsonRequest(url, 'GET', null, success, error);
            },
            getXml: function(url, success, error) {
                return AppLinks.xmlRequest(url, 'GET', null, success, error);
            },
            self_link: function(item) {
                for (var i = 0, _i = item.link.length; i < _i; i++) {
                    var link = item.link[i];
                    if (link.rel == "self") return link.href;
                }

                throw "No self-link found";
            },
            del: function(urlOrObject, success, error) {
                var url;
                if (typeof(urlOrObject) == 'string') url = urlOrObject;
                else url = AppLinks.self_link(urlOrObject);
                return AppLinks.jsonRequest(url, 'DELETE', null, success, error);
            },
            SPI: $.extend({}, {
                API_VERSION: "1.0",
                REST_RESOURCE_URL: AJS.contextPath() + "/rest/applinks/",
                BASE_URL: AJS.contextPath() + "/rest/applinks/1.0",
                OAUTH_REST_RESOURCE_URL: AJS.contextPath() + "/rest/applinks-oauth/",
                OAUTH_BASE_URL: AJS.contextPath() + "/rest/applinks-oauth/1.0",
                APPLICATION_TUNNELS_BASE_URL: AJS.contextPath().substring(0, AJS.contextPath().lastIndexOf('/')) +
                    "/gateway/api/admin/private/api/v1/workspace/confluence/site/",
                APPLICATION_TUNNELS_URL_SUFFIX: "/tunnels?limit=100&offset=1&sortOder=ASC&excludeToken=true",

                /**
                 * Update the API version and associated urls.
                 * @param version
                 */
                setApiVersion: function(version){
                    AppLinks.SPI.API_VERSION = version;
                    AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL + AppLinks.SPI.API_VERSION);
                },
                setBaseUrl: function(url){
                    AppLinks.SPI.BASE_URL = url;
                },
                setOAuthBaseUrl: function(url){
                    AppLinks.SPI.OAUTH_BASE_URL = url;
                },
                setApplicationTunnelsBaseUrl: function(url){
                    AppLinks.SPI.APPLICATION_TUNNELS_BASE_URL = url;
                },
                /**
                 * Build a base URL for rest calls using the specified baseUrl.
                 * @param baseUrl
                 * @returns {string}
                 */
                getRemoteRestBaseUrl: function(baseUrl) {
                    return baseUrl + "/rest/applinks/" + AppLinks.SPI.API_VERSION;
                },
                /**
                 * Build a base URL for plugin servlet calls using the specified baseUrl.
                 * @param baseUrl
                 * @returns {string}
                 */
                getRemotePluginServletBaseUrl: function(baseUrl) {
                    return baseUrl + "/plugins/servlet";
                },
                getAllLinks: function(success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink";
                    return AppLinks.get(url, success, failure);
                },
                getAllLinksWithAuthInfo: function(success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/listApplicationlinks";
                    return AppLinks.get(url, success, failure);
                },
                getApplicationLinkState: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/listApplicationlinkstates/id/" + id;
                    return AppLinks.get(url, success, failure);
                },
                getLinksOfType: function(typeId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/type/" + typeId;
                    return AppLinks.get(url, success, failure);
                },
                tryToFetchManifest: function(url, success, failure) {
                    var restUrl = AppLinks.SPI.BASE_URL + '/applicationlinkForm/manifest.json?url=' + encodeURIComponent(url);
                    return AppLinks.get(restUrl, success, failure);
                },
                getManifestFor: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/manifest/' + id + ".json";
                    return AppLinks.get(url, success, failure);
                },
                getLocalManifest: function(success, failure){
                    var url = AppLinks.SPI.BASE_URL + '/manifest.json';
                    return AppLinks.get(url, success, failure);
                },
                /**
                 * Attempt to get the Manifest of the remote application, via a direct REST call.
                 * Requires CORS enabled on the REST resource.
                 * @param url
                 * @param success
                 * @param failure
                 * @returns {*}
                 */
                getRemoteManifest: function(remoteBaseUrl, success, failure){
                    var remoteManifestUrl = AppLinks.SPI.getRemoteRestBaseUrl(remoteBaseUrl) + '/manifest.json';
                    return AppLinks.get(remoteManifestUrl, success, failure);
                },
                /**
                 * Attempt to get the OAuth Consumer Info of the remote application, via a direct call.
                 * Requires CORS enabled on the REST resource.
                 * @param url
                 * @param success
                 * @param failure
                 * @returns {*}
                 */
                getRemoteOAuthConsumerInfo: function(remoteBaseUrl, success, failure){
                    var remoteManifestUrl = AppLinks.SPI.getRemotePluginServletBaseUrl(remoteBaseUrl) + '/oauth/consumer-info';
                    return AppLinks.getXml(remoteManifestUrl, success, failure);
                },
                getApplinkStatus: function (applinkId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/status/' + applinkId;
                    return AppLinks.get(url, success, failure);
                },
                getApplicationTunnels: function (siteId, success, failure) {
                    var url = AppLinks.SPI.APPLICATION_TUNNELS_BASE_URL + siteId + AppLinks.SPI.APPLICATION_TUNNELS_URL_SUFFIX;
                    return AppLinks.get(url, success, failure);
                },
                createStaticUrlAppLink: function(applicationType, success, failure) {
                    var restUrl = AppLinks.SPI.BASE_URL + '/applicationlinkForm/createStaticUrlAppLink?typeId=' + applicationType;
                    return AppLinks.post(restUrl, null, success, failure);
                },
                getApplicationLinkInfo: function (appId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlinkInfo/id/" + appId;
                    return AppLinks.get(url, success, error);
                },
                deleteLink: function(applicationLink, reciprocate, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/" + applicationLink.id;
                    if (reciprocate) url += "?reciprocate=true";
                    return AppLinks.del(url, success, error);
                },
                makePrimary: function(applicationLink, success) {
                    var url = AppLinks.SPI.BASE_URL + "/applicationlink/primary/" + applicationLink.id;
                    return AppLinks.post(url, null, success);
                },
                getEntityTypesForApplicationType: function(applicationType, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/type/entity/" + applicationType;
                    return AppLinks.get(url, success, error);
                },
                getEntityLinksForApplication: function(applicationLinkId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entities/" + applicationLinkId + ".json";
                    AppLinks.get(url, success, error);
                },
                getEntityLinksForApplicationUsingAnonymousAccess: function(applicationLinkId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entities/anonymous/" + applicationLinkId + ".json";
                    return AppLinks.get(url, success, error);
                },
                createNonUalEntityLink: function(localType, localKey, applicationId, remoteTypeId, remoteKey, name, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localType + "/" + localKey + "?reciprocate=false";
                    var data = {
                        applicationId: applicationId,
                        typeId: remoteTypeId,
                        key: remoteKey,
                        name: name,
                        isPrimary: false
                    };
                    return AppLinks.put(url, data, success, error);
                },
                createEntityLink: function(localType, localKey, entity, reciprocate, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localType + "/" + localKey + "?reciprocate=";
                    url += (reciprocate ? "true" : "false");
                    return AppLinks.put(url, entity, success, failure);
                },
                getConfiguredEntityLinks: function(localType, localKey, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/primaryLinks/" + localType + "/" + localKey + ".json";
                    return AppLinks.get(url, success, error);
                },
                deleteEntityLink: function(localTypeId, localKey, entity, reciprocate, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/" + localTypeId + "/" + localKey + "?typeId=" + entity.typeId + "&key=" + encodeURIComponent(entity.key) + "&applicationId=" + entity.applicationId + "&reciprocate=" + reciprocate;
                    return AppLinks.del(url, success, error);
                },
                makePrimaryEntityLink: function(localTypeID, localKey, entity, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/entitylink/primary/" + localTypeID + "/" + localKey + "?typeId=" + entity.typeId + "&key=" + encodeURIComponent(entity.key) + "&applicationId=" + entity.applicationId;
                    return AppLinks.post(url, null, success, error);
                },
                canDeleteAppLink: function(applicationId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-application-delete/" + applicationId;
                    return AppLinks.get(url, success, error);
                },
                canDeleteEntityLink: function(localTypeId, localKey, entity, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-entity-delete/" + entity.applicationId + "/" + localTypeId + "/" + localKey + "/" + entity.typeId + "/" + encodeURIComponent(entity.key);
                    return AppLinks.get(url, success, error);
                },
                canCreateReciprocateEntityLink: function(applicationId, success, error) {
                    var url = AppLinks.SPI.BASE_URL + "/permission/reciprocate-entity-create/" + applicationId;
                    return AppLinks.get(url, success, error);
                },
                processPermissionCode: function(settings) {
                    var config = {
                        noPermission: function() {},
                        missing: function() {},
                        credentialsRequired: function(authUrl) {},
                        authenticationFailed: function(authUrl) {},
                        noAuthentication: function(authUrl) {},
                        noAuthenticationConfigured: function() {},
                        noConnection: function() {},
                        allowed: function() {},
                        unrecognisedCode: function(code) {},
                        updateView: function(message, icon, button) {}
                    };

                    if (!settings) settings = {};

                    settings = $.extend(config, settings);

                    return function(data) {
                        var url = data.url;
                        if (url && !url.startsWith("http://") && !url.startsWith("https://")) {
                            throw "url '" + url + "' is not an http/https url.";
                        }

                        var code = data.code;
                        if (code == "NO_PERMISSION") {
                            settings.noPermission();
                        } else if (code == "MISSING") {
                            settings.missing();
                        } else if (code == "CREDENTIALS_REQUIRED") {
                            settings.credentialsRequired(url);
                        } else if (code == "AUTHENTICATION_FAILED") {
                            settings.authenticationFailed(url);
                        } else if (code == "NO_AUTHENTICATION") {
                            settings.noAuthentication(url);
                        } else if (code == "NO_AUTHENTICATION_CONFIGURED") {
                            settings.noAuthenticationConfigured();
                        } else if (code == "NO_CONNECTION") {
                            settings.noConnection();
                        } else if (code == "ALLOWED") {
                            settings.allowed();
                        } else {
                            settings.unrecognisedCode(data.code);
                        }
                    };
                },
                addAuthenticationTrigger: function(target, authUrl, callbacks) {
                    if (!callbacks) {
                        callbacks = {};
                    }

                    if (typeof callbacks.onSuccess == "undefined") {
                        callbacks.onSuccess = function() {
                            location.reload();
                        }
                    }

                    if (typeof callbacks.onFailure == "undefined") {
                        callbacks.onFailure = function() {
                            return true;
                        }
                    }
                    //Unbind previous click listener, otherwise we might end up opening multiple windows.
                    $(target).unbind('click');
                    $(target).click(function() {
                        if (callbacks.before) {
                            callbacks.before();
                        }
                        AppLinks.authenticateRemoteCredentials(authUrl, callbacks.onSuccess, callbacks.onFailure);
                    });
                },
                showCreateEntityLinkSuggestion: function() {
                    return true;
                },
                getApplicationLink: function(id, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink/' + id;
                    return AppLinks.get(url, success, failure);
                },
                createApplicationLink: function(id, name, rpcUrl, displayUrl, typeId, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink';
                    var data = {
                        id: id,
                        name: name,
                        rpcUrl: rpcUrl,
                        displayUrl: displayUrl,
                        typeId: typeId
                    };

                    if (isOAuth2Enabled) {
                        url += '?isOAuth2=' + AppLinks.Creation.isOAuth2ThreeLoEnabled();
                    }
                    return AppLinks.put(url, data, success, failure);
                },
                createOAuth2ApplicationLink: function(id, name, rpcUrl, displayUrl, typeId, success, failure) {
                    var url = AppLinks.SPI.REST_RESOURCE_URL + 'latest/applinks';
                    var data = {
                        id: id,
                        name: name,
                        rpcUrl: rpcUrl,
                        displayUrl: displayUrl,
                        typeId: typeId
                    };

                    return AppLinks.post(url, data, success, failure);
                },
// TODO APLDEV-3 extract OAuth creation code into OAuth specific js files in the Oauth plugin.
                createConsumer: function(id, key, name, description, sharedSecret, publicKey, twoLOAllowed, executingTwoLOUser, twoLOImpersonationAllowed, outgoing, success, failure) {
                    var url = AppLinks.SPI.OAUTH_BASE_URL + '/applicationlink/' + id + '/authentication/consumer';
                    var data = {
                        key: key,
                        name: name,
                        description: description,
                        sharedSecret: sharedSecret,
                        publicKey: publicKey,
                        outgoing: outgoing,
                        twoLOAllowed: twoLOAllowed,
                        executingTwoLOUser: executingTwoLOUser,
                        twoLOImpersonationAllowed: twoLOImpersonationAllowed
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                createConsumerAutoConfigure: function(id, twoLOAllowed, executingTwoLOUser, twoLOImpersonationAllowed, success, failure) {
                    var url = AppLinks.SPI.OAUTH_BASE_URL + '/applicationlink/' + id + '/authentication/consumer?autoConfigure=true';
                    var data = {
                        twoLOAllowed: twoLOAllowed,
                        executingTwoLOUser: executingTwoLOUser,
                        twoLOImpersonationAllowed: twoLOImpersonationAllowed
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                updateRemoteOauthCredentials: function(id, clientId, clientSecret, redirectUrl, scopes, name, displayUrl, success, failure) {
                    const url = AppLinks.SPI.REST_RESOURCE_URL + 'latest/applinks/' + id + '/oAuth2ConfigInfo';
                    const data = {
                        remoteClientId: clientId,
                        remoteClientSecret: clientSecret,
                        remoteRedirectUrl: redirectUrl,
                        outboundScopes: scopes,
                        name: name,
                        displayUrl: displayUrl
                    };
                    return AppLinks.put(url, data, success, failure);
                },
                getOauth2ConfigInfo: function(id, success, failure) {
                    const url = AppLinks.SPI.REST_RESOURCE_URL + 'latest/applinks/' + id + '/oAuth2ConfigInfo';
                    return AppLinks.get(url, success, failure);
                },
                registerProvider: function(id, provider, config, success, failure) {
                    var url = AppLinks.SPI.BASE_URL + '/applicationlink/' + id + '/authentication/provider';
                    var data = {
                        config : config,
                        provider : provider
                    };
                    return AppLinks.put(url, data, success, failure);
                }
            }, (window.AppLinks && window.AppLinks.SPI) || {})
        });

        AppLinks.UI = {
            showInfoBox: function(message) {
                $('.aui-message.success').remove();
                AppLinks.UI.createMessage('success', message, 'page-info');
            },
            hideInfoBox: function() {
                $('.aui-message.success').remove();
            },
            showErrorBox: function(message) {
                AppLinks.UI.createMessage('error', message, 'page-error');
            },
            hideErrorBox: function() {
                $('.aui-message.error').remove();
            },
            showWarningBox: function(messages) {
                if ($.isArray(messages) && messages.length > 0) {
                    var ulEl = $("<ul></ul>");
                    $(messages).each(function(index) {
                        ulEl.append($("<li/>", {
                            text: messages[index]
                        }));
                    });
                    var messageEl = $('<div class="page-warning"></div>').append(ulEl);
                    AppLinks.UI.createMessage('warning', messageEl.html(), 'page-warning');
                } else {
                    AppLinks.UI.createMessage('warning', messages, 'page-warning');
                }
            },
            hideWarningBox: function() {
                $('.aui-message.warning').remove();
            },
            shortenString: function(message, maxLength) {
                if (message.length  > maxLength) {
                    message = message.substring(0, maxLength) + "...";
                }
                return message;
            },
            createMessage: function(type, message, cssClass) {
                if ($('#ual.applinks-admin-with-tunnels').length > 0) {
                    this.createMessageFlag(type, message, cssClass);
                } else {
                    var messageEl = $('<div class="' + cssClass + '">');
                    messageEl.html(message);
                    AJS.messages[type](".applinks-message-bar", {
                        title: "",
                        body: messageEl.wrap('<div></div>').parent().html(),
                        closeable: true
                    });
                    $(document).trigger(AppLinks.Event.Legacy.MESSAGE_BOX_DISPLAYED);
                }
            },
            createMessageFlag: function(type, message, cssClass) {
                var messageEl = $('<div class="' + cssClass + '">');
                messageEl.html(message);
                AJS.flag({
                    type,
                    body: messageEl.wrap('<div></div>').parent().html(),
                });
                $(document).trigger(AppLinks.Event.Legacy.MESSAGE_BOX_DISPLAYED);
            },
            displayValidationErrorMessages: function (errorClass, rootEl, messages) {
                if ($.isArray(messages)) {
                    $(messages).each(function(i,v) {
                        var d = $('<div class="error applinks-error">');
                        d.text(v);
                        $(rootEl).find("." + errorClass).append(d);
                    });
                } else if(typeof messages != 'undefined'){
                    var d = $('<div class="error applinks-error">');
                    d.text(messages.toString());
                    $(rootEl).find("." + errorClass).append(d);
                }
            },
            displayValidationError: function(errorClass, rootEl, errorFn) {
                return function(xhr) {
                    if (xhr.status == 401) {
                        window.location.reload();
                        return;
                    }

                    $('.applinks-error').remove();
                    $('.loading').remove();
                    var respJSON = xhr.responseText;
                    var respObj = $.parseJSON(respJSON);
                    var messages = respObj.message;
                    if (typeof respObj.fields == "undefined") {
                        AppLinks.UI.displayValidationErrorMessages(errorClass, rootEl, messages);
                    } else {
                        var fields = respObj.fields;
                        $(fields).each(function(index) {
                            var d = $('<div class="error applinks-error" id="' + fields[index] + '-error">');
                            d.text(messages[index]);
                            if ($(rootEl).find('.' + fields[index]).length > 0) {
                                d.insertAfter($(rootEl).find('.' + fields[index]));
                            } else {
                                d.insertAfter($(rootEl).find('.' + errorClass).append(d));
                            }
                        });
                    }
                    $(rootEl).find('.' + errorClass).addClass("fully-populated-errors");
                    if (errorFn) {
                        errorFn();
                    }
                }
            },
            addProtocolToURL : function(url) {
                var newUrl = $.trim(url);
                var tempURL = newUrl.toLowerCase();
                var hasProtocol = false;
                if (tempURL.length >= 7) {
                    if (tempURL.substring(0,7).indexOf('http') != -1) {
                        hasProtocol = true;
                    }
                }
                //default protocol is http
                if (!hasProtocol) {
                    newUrl = 'http://' + newUrl;
                }
                return newUrl;
            },
            /**
             * Similar to the standard Javascript join() method, but nicer in that
             * it uses a different delimiter for the last node (by default "and"),
             * so that:
             * {code}
             * "1, 2 and 3" == prettyJoin(['1', '2', '3'], function(value) {return value;});
             * {code}
             *
             * @param inputArray
             * @param resolveFn
             * @param finalDelimiter
             */
            prettyJoin : function(inputArray, resolveFn, finalDelimiter) {
                if (!finalDelimiter) {
                    finalDelimiter = "and";
                }
                var maxLength = inputArray.length;
                var message = "";
                $.each(inputArray, function(index, value) {
                    if (index == (maxLength - 1) && maxLength > 1) {
                        message += " " + finalDelimiter + "  " + resolveFn(value);
                    } else {
                        message += resolveFn(value);
                        if (index + 2 < maxLength) {
                            message += ", ";
                        }
                    }
                });
                return message;
            },
            showLoadingIcon: function(element) {
                $('<span class="loading">&nbsp;</span>').insertAfter(element);
            },
            hideLoadingIcon: function(element) {
                $(element).next('.loading').remove();
            },
            findUrl: function(text) {
                var url = undefined;
                var lcText = text.toLowerCase();
                var startOfUrl = lcText.indexOf('http:');
                if (startOfUrl == -1) {
                    startOfUrl = lcText.indexOf('https:');
                }
                if (startOfUrl > -1) {
                    var endOfUrl = lcText.indexOf(' ', startOfUrl);
                    if (endOfUrl == -1) {
                        endOfUrl = lcText.length;
                    }
                    url = text.substring(startOfUrl, endOfUrl); // use _case-sensitive_ version to retrieve the actual URL
                }
                return url;
            },
            findApplicationType : function(id) {
                id = id.toLowerCase();
                if (id.indexOf("jira") != -1) {
                    return "jira";
                } else if (id.indexOf("fisheye") != -1) {
                    return "fecru";
                } else if (id.indexOf("confluence") != -1) {
                    return "confluence";
                } else if (id.indexOf("refapp") != -1) {
                    return "refapp";
                } else {
                    return undefined;
                }
            },
            escapeSelector: function(selector) {
                // based on http://samuelsjoberg.com/archive/2009/09/escape-jquery-selectors
                return selector.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g, "\\$1");
            },
            sanitiseHTML: function(input) {
                var replacements = {
                    "<": "&lt;",
                    '"': "&quot;",
                    "&": "&amp;"
                };
                return input.replace(/[<"&]/g, function(match) {
                    return replacements[match];
                });
            },
            removeCssClass: function(element, prefix) {
                $(element).removeClass( function(index, className) {
                    var classes = className.split(' ');
                    var classToRemove = "";
                    $.each(classes, function(index, value) {
                        if (value.indexOf(prefix) != -1) {
                            classToRemove = value;
                        }
                    });
                    return classToRemove;
                } );
            }
        };

        /**
         * Add jQuery event system to AppLinks.UI namespace.
         */
        (function(){
            var eventBus = $({});
            $.each(['bind', 'unbind', 'trigger'], function(i, current){
                AppLinks.UI[current] = function(){
                    return eventBus[current].apply(eventBus, arguments);
                }
            });
        })();

        $(document).trigger(AppLinks.Event.PREREADY);
        $(document).trigger(AppLinks.Event.READY);
    });
})(require('applinks/common/i18n'), require('applinks/common/events'));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'applinks/internal/non-amd/autocomplete.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

AJS.$(document).bind(AppLinks.Event.READY, function() {
/**
 * TODO: THIS CODE IS COPIED FROM CONFLUENCE and should be part of AUI/AJS.
 * IF AUI comes with the InputDrivenDropDown when can remove this file.
 * https://studio.atlassian.com/browse/AJS-471
 *
 * A simple cache manager that supports a
 * FIFO cache invalidation strategy.
 *
 * @class cacheManager
 * @namespace AJS.Confluence
 * @constructor
 * @param cacheSize the size of the cache before keys are invalidated
 */
AppLinks.autoComplete = {
        cacheManager : function (cacheSize) {
    var cache = {},
        cacheStack = [],
        cacheSize = cacheSize || 30;

    return {
        /**
         * Return the value stored in the cache for the given key
         * @method get
         * @param key {String}
         */
        get: function(key) {
            return cache[key];
        },
        /**
         * Put the given key, value in the cache
         * @method put
         * @param key {String}
         * @param value {Object}
         */
        put: function(key, value) {
            cache[key] = value;
            cacheStack.push(key);
            if (cacheStack.length > cacheSize) {
                delete cache[cacheStack.shift()];
            }
        },
        /**
         * Clear the cache.
         */
        clear : function() {
            cache = {};
            cacheStack = [];
        }
    };
}};


(function($){
    /**
     * Check that all items in the drop down can be displayed - show ellipses at the end of any that
     * are too long. Also remove any unused properties that the dropDown may have stored for each
     * item in the list.
     *
     * @method truncateText
     * @private
     */
    var truncateText = function (dd) {
        AJS.log("InputDrivenDropDown: truncating text");
        var width = dd.$.closest(".aui-dropdown").width(),
            rightPadding = 20; // add some padding so the ellipsis doesn't run over the edge of the box

        $("a span:not(.icon)", dd.$).each(function () {
            var $a = $(this),
                elpss = AJS("var", "&#8230;"),
                elwidth = elpss.width(),
                isLong = false;

            $a.wrapInner($("<em>"));
            $("em", $a).each(function () {
                var $label = $(this);

                $label.show();
                if (this.offsetLeft + this.offsetWidth > width) {
                    var childNodes = this.childNodes,
                        success = false;

                    for (var j = childNodes.length - 1; j >= 0; j--) {
                        var childNode = childNodes[j],
                            truncatedChars = 1,
                            valueAttr = (childNode.nodeType == 3) ? "nodeValue" : "innerHTML",
                            nodeText = childNode[valueAttr];

                        do {
                            if (truncatedChars <= nodeText.length) {
                                childNode[valueAttr] = nodeText.substr(0, nodeText.length - truncatedChars++);
                            } else { // if we cannot fit even one character of the next word, then try truncating the node just previous to this
                                break;
                            }
                        } while (this.offsetLeft + this.offsetWidth + elwidth > width - rightPadding);

                        if (truncatedChars <= nodeText.length) {
                            // we've managed truncate part of the word and fit it in
                            success = true;
                            break;
                        }
                    }

                    if (success) {
                        isLong = true;
                    } else {
                        $label.hide();
                    }
                }
            });
            if (isLong) {
                $a.append(elpss);
                this.elpss = elpss;
            }
        });
    };

    var highlightTokens = function(dd, tokens) {
        if (!tokens.length || !tokens[0]) return;

        AJS.log("InputDrivenDropDown: highlighting tokens");

        // escape regex chars .*+?|()[]{}\ first
        for (var i = 0, ii = tokens.length; i < ii; i++) {
            var token = tokens[i];
            tokens[i] = token ? token.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g, "\\$") : "";
        }

        var regex = new RegExp("(" + tokens.join("|") + ")", "gi");

        $("li a:not(.dropdown-prevent-highlight) span", dd.$).each(function() {
            var span = $(this),
                html = span.html().replace(regex, "<strong>$1</strong>");
            span.html(html);
        });
    };

    /**
     * Builds and shows the dropdown.
     *
     * @param idd the InputDrivenDropdown
     * @param dropdownData in the form { matrix, query, queryTokens }
     * @private
     */
    var makeDropdown = function (idd, dropdownData) {
        var options = idd.options,
            old_dd = idd.dd;

        if (old_dd) {
            old_dd.hide();
            old_dd.$.remove();
        }

        options.ajsDropDownOptions = options.ajsDropDownOptions || {};
        if (options.ajsDropDownOptions && !options.ajsDropDownOptions.alignment) { // default to left alignment
            options.ajsDropDownOptions.alignment = "left";
        }
        //this needs to be moved into aui
        options.ajsDropDownOptions.selectionHandler = options.ajsDropDownOptions.selectionHandler || function(e, element) {
            if(e.type != "click") {
                e.preventDefault();
                $("a",element).click();
                document.location = $("a",element).attr("href");
            }
        };

        /* Fixing an AUI bug in here:  AJS.dropdown puts the raw 'matrix[i].name' as html, without escaping it !
           The solution is to override their displayHandler
         */
        /**
         * Escape obj.name and return it
         */
        options.ajsDropDownOptions.displayHandler = function (obj) {
            return AJS.escapeHtml(obj.name);
        }

        var dd = idd.dd = new AJS.dropDown(dropdownData.matrix, options.ajsDropDownOptions)[0];

        // could move into dropdown.js in AUI
        if (options.ajsDropDownOptions && options.ajsDropDownOptions.className) {
            dd.$.addClass(options.ajsDropDownOptions.className);
        }

        // place the created drop down using the configured dropdownPlacement function
        // if there is none then use a default behaviour
        if (options.dropdownPlacement) {
            options.dropdownPlacement(dd.$);
        } else {
            AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");
            $("body").append(dd.$);
        }

        highlightTokens(dd, dropdownData.queryTokens || [dropdownData.query]);
        truncateText(dd);

        if (options.dropdownPostprocess) {
            options.dropdownPostprocess(dd.$);
        }
        dd.show(idd._effect);

        if (typeof options.onShow == "function") {
            options.onShow.call(dd, dd.$);
        }

        return dd;
    };

    /**
     * Provides a controller-agnostic object that listens for controller changes and populates a dropdown
     * via a callback. Most aspects can be customized via the options object parameter.
     * <br>
     * Options are:
     * <li>
     *   getDataAndRunCallback - (required) callback method used to provide data for the dropdown. It must take
     *                          two parameters, user input value and the callback function to execute.
     * </li>
     * <li>
     *   onShow - function to call when the drop-down is displayed
     * </li>
     * <li>
     *   dropdownPlacement - a function that will be called with the drop down and which should place it in the
     *                          correct place on the page. The supplied arguments are 1) the input that issued the
     *                          search, 2) the dropDown to be placed.
     * </li>
     * <li>
     *   ajsDropDownOptions - any options the underlying dropDown component can handle expects
     * </li>
     * <li>
     *   onDeath - callback to run when dropdown dies
     * </li>
     * @class InputDrivenDropDown
     * @namespace AJS
     */
    function InputDrivenDropDown(id, options) {
        this._effect = "appear";
        this._timer = null;

        this.id = id;
        this.options = options;
        this.inactive = false;
        this.busy = false;
        this.cacheManager = AppLinks.autoComplete.cacheManager();
    }

    /**
     * Clears the cache.
     */
    InputDrivenDropDown.prototype.clearCache = function () {
        this.cacheManager.clear();
    };

    /**
     * This method should be called when the user input for this dropdown has changed.
     * It will check the cache before fetching data (via options.getDataAndRunCallback)
     * and displaying the dropdown.
     *
     * @param value {String} the new value of the user input
     * @param force {Boolean} force a change to occur regardless of user input
     */
    InputDrivenDropDown.prototype.change = function (value, force) {
        var t = this;
        if (value != t._value || force) {
            t._value = value;
            t.busy = false;

            clearTimeout(t._timer);

            if (force || (/\S{0,}/).test(value)) {
                var cachedVal = t.cacheManager.get(value);
                if (cachedVal) {
                    makeDropdown(t, cachedVal);
                } else {
                    t.busy = true;
                    t._timer = setTimeout(function () { // delay sending a request to give the user a chance to finish typing their search term(s)
                        t.options.getDataAndRunCallback.call(t, value, t.show);
                    }, 200);
                }
            } else {
                t.dd && t.dd.hide();
            }
        }
    };

    /**
     * Gets the number of visible options in the dropdown.
     */
    InputDrivenDropDown.prototype.dropDownLength = function () {
        return this.dd.links ? this.dd.links.length : 0;
    };
    
    /**
     * Gets the specified menu item from the dropdown list.
     * 
     * @param index {Integer} the 0-based index of the dropdown option list
     */
    InputDrivenDropDown.prototype.dropDownItem = function (index) {
        return this.dropDownLength() > index ? this.dd.links[index] : null;
    };
    
    /**
     * Hides the drop down
     */
    InputDrivenDropDown.prototype.hide = function () {
        this.dd && this.dd.hide();
    };

    /**
     * Hides and removes the drop down from the DOM.
     */
    InputDrivenDropDown.prototype.remove = function () {
        var dd = this.dd;
        if (dd) {
            this.hide();
            dd.$.remove();
        }
        this.inactive = true;
        this.options.onDeath && this.options.onDeath();
    };

    /**
     * Shows the drop down with the given matrix data and query.
     * <br>
     * Matrix property should be an array of arrays, where the sub-arrays represent the different
     * search categories.
     *
     * Expected properties of category sub-array objects are:
     *  - href
     *  - name
     *  - className
     *  - html (optional, replaces href and name)
     *  - icon (optional)
     *
     *
     * @param matrix {Array} matrix to populate the drop down from
     * @param query {String} the user input string that triggered this show
     * @param queryTokens {Array} an array of strings of the query tokens. Use for highlighting search terms.
     */
    InputDrivenDropDown.prototype.show = function (matrix, query, queryTokens) {
        if (this.inactive) {
            AJS.log("Quick search abandoned before server response received, ignoring. " + this);
            return;
        }

        var dropdownData = {
            matrix: matrix,
            query: query,
            queryTokens: queryTokens
        };
        this.cacheManager.put(query, dropdownData);

        makeDropdown(this, dropdownData);
        this.busy = false;
    };

    /**
     * Returns an InputDrivenDropDown. See InputDrivenDropDown for more documentation.
     * @param options {Object} options for the InputDrivenDropDown
     * @constructor
     */
    AppLinks.inputDrivenDropdown = function (options) {
        return new InputDrivenDropDown("inputdriven-dropdown", options);
    };

})(jQuery);
});

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
var jiraIntegration=window.jiraIntegration||{};
jiraIntegration.JiraCreateIssueForm=function(c,f){function d(a){this.configuration=f.extend({},d.defaults,a);this.configuration.renderSummaryAndDescription&&this.configuration.excludedField.push("summary","description");this._init()}d.defaults={formClass:"jira-interation-create-issue-form",ignoreFieldsWithDefaultValue:!0,excludedField:["project","issuetype","reporter"],renderSummaryAndDescription:!1,get$unsupportedFieldMessage:function(a,b){return c(jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:a,createIssueUrl:b}))},
get$unexpectedError:function(a){return c(aui.message.error({content:AJS.escapeHtml(a)}))},get$unauthorizeMessage:function(a){return c(jiraIntegration.templates.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:a}))},get$unsupportedServerMessage:function(a){return c(jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:a}))}};d.prototype._trigger=function(a,b){var e=this.configuration[a];e&&e.apply(this,Array.prototype.slice.call(arguments,
1))};d.prototype._bindEventListener=function(){var a=this;this.defaultFields.server.on("change",function(){a.resetForm();var b=this.value;(a.currentServerId=b)?(c('option[value=""]',a.defaultFields.server).remove(),a.formIsLoading(a.defaultFields.server),jiraIntegration.JiraCreateIssueForm.Data.isIssueCreationSupported(b).done(function(e){e?(a._loadProjectData(b),a.formLoadingCompleted(a.defaultFields.server)):(e=jiraIntegration.JiraCreateIssueForm.Data.getServerById(b).displayUrl,a._handleUnsupportedServer(e))}).fail(function(e){a._handleAjaxError(e)})):
(jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(a.defaultFields.project),a.defaultFields.project.trigger("change"));a._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){this.value?(c('option[value=""]',a.defaultFields.project).remove(),a._loadIssueType(a.defaultFields.server.val(),this.value).then(function(){a._handleFormAfterProjectChange(this.value)})):(jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(a.defaultFields.issueType),
a._handleFormAfterProjectChange(this.value))});this.defaultFields.issueType.on("change",function(){a.resetForm();this.value?a._loadRequireFields():(a.$containerRequireField&&a.$containerRequireField.html(""),c(".aui-message",this.formEl).remove());a._trigger("onTypeChanged",this.value)})};d.prototype._init=function(){this.container=c(this.configuration.container);if(this.container.length)this._renderForm(),this._bindEventListener(),this._loadServerData();else throw Error("container property should be defined.");
};d.prototype._renderForm=function(){this.formEl=c(jiraIntegration.templates.jiraCreateIssueForm.form({formClass:this.configuration.formClass}));this.configuration.renderSummaryAndDescription&&this._renderSummaryAndDescription();this.container.append(this.formEl);this.defaultFields=this._getDefaultFields();f.each(this.defaultFields,f.bind(function(a){this.createSelect2WithIcon(c(a))},this));this.$containerRequireField=c(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};
d.prototype._renderSummaryAndDescription=function(){var a=c(".create-issue-default-fields",this.formEl);a.append(aui.form.textField({id:"create-issue-summary-input",labelContent:"Summary",isRequired:!0,name:"summary"}));a.append(aui.form.textareaField({id:"create-issue-description-input",labelContent:"Description",name:"description"}))};d.prototype._getDefaultFields=function(){var a=c("."+this.configuration.formClass,
this.configuration.container);return{server:c(".server-select",a),project:c(".project-select",a),issueType:c(".issuetype-select",a)}};d.prototype._loadServerData=function(){var a=this;this.formIsLoading(this.defaultFields.server);c.when(jiraIntegration.JiraCreateIssueForm.Data.loadServers()).then(function(b){a.formLoadingCompleted(a.defaultFields.server);a._loadServerDataComplete(b)})};d.prototype._loadRequireFields=function(){var a=this,b={serverId:this.defaultFields.server.val(),projectKey:this.defaultFields.project.val(),
issueType:this.defaultFields.issueType.val()};this.formIsLoading(this.defaultFields.issueType);jiraIntegration.JiraCreateIssueForm.Data.getFieldMetadata(b).done(function(e){var c=a._getValidRequiredFields(e);a.configuration.renderSummaryAndDescription&&(e=e.fields.description,a._setDescriptionAsRequiredField(!(!e||!e.required)));a._renderRequireFields(c,b);a.formLoadingCompleted(a.defaultFields.issueType)}).fail(f.bind(a._handleAjaxError,this))};d.prototype._loadServerDataComplete=function(a){a.length?
(jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.server,a),this._hasMultiServer=1<a.length):this._handlerUnexpectedError("Don\'t have any JIRA server, please check the application link configuration.")};d.prototype._loadProjectData=function(a){var b=this;this.formIsLoading(this.defaultFields.project);jiraIntegration.JiraCreateIssueForm.Data.loadProjects(a).then(function(a){a.errors&&a.errors.length?(a=a.errors[0],a.authenticationUri?b._handleAuthorizeError(a):b._handlerUnexpectedError(a.message)):
a.length?(jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(b.defaultFields.project,a),jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(b.defaultFields.issueType)):b._handlerUnexpectedError("You do not have permission to create issues on this JIRA server.");b.formLoadingCompleted(b.defaultFields.project)},f.bind(b._handleAjaxError,this))};d.prototype._loadIssueType=function(a,b){var e=c.Deferred(),d=this.defaultFields.issueType;jiraIntegration.JiraCreateIssueForm.Data.getIssueTypes(a,
b).then(function(a){jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(d,a,!0);e.resolve()},f.bind(this._handleAjaxError,this));return e.promise()};d.prototype._handleFormAfterProjectChange=function(a){this.resetForm();this.defaultFields.issueType.trigger("change");this._trigger("onProjectChanged",a)};d.prototype._renderRequireFields=function(a,b){this.$containerRequireField.html("");var e=f.reject(a,jiraIntegration.fields.canRender);e.length?this._handleUnsupportedFields(e):(this.$containerRequireField.html(f.map(a,
function(a){return jiraIntegration.fields.renderField(null,a,null,null)}).join("")),jiraIntegration.fields.attachFieldBehaviors(this.$containerRequireField,{serverId:b.serverId,projectKey:b.projectKey},null),this._trigger("onRequiredFieldsRendered",a,e))};d.prototype._handlerUnexpectedError=function(a){a=this.configuration.get$unexpectedError(a);c(".aui-message",this.formEl).remove();this.formEl.prepend(a);this.formLoadingCompleted();this.formHasError()};d.prototype._handleUnsupportedFields=function(a){a=
f.map(a,function(a){return AJS.escapeHtml(a.name)});a=this.configuration.get$unsupportedFieldMessage(a,this._getCreateJiraIssueUrl());c(".aui-message",this.formEl).remove();this.formEl.prepend(a);this._trigger("onError");this.formLoadingCompleted()};d.prototype._handleUnsupportedServer=function(a){a=this.configuration.get$unsupportedServerMessage(a);c(".aui-message",this.formEl).remove();this.formEl.prepend(a);this.formLoadingCompleted();this.formHasError()};d.prototype._handleAjaxError=function(a){500<=
a.status&&600>a.status&&this._handlerUnexpectedError("Received the following HTTP error code from the server"+":"+a.status);this.formHasError()};d.prototype._handleAuthorizeError=function(a){var b=this;this.formHasError();var e=this.configuration.get$unauthorizeMessage(a.applicationName);this.formEl.append(e);c(".oauth-init",e).on("click",function(e){AppLinks.authenticateRemoteCredentials(a.authenticationUri,function(){b.resetForm();b._loadProjectData(b.currentServerId)},function(){b._handlerUnexpectedError(AJS.format("You have refused to permit access to {0}.",
a.applicationName))});e.preventDefault()})};d.prototype._getCreateJiraIssueUrl=function(){var a=this.defaultFields.project.find("option:selected").val(),b=this.defaultFields.issueType.find("option:selected").val(),e=jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId).displayUrl,e=e+"/secure/CreateIssueDetails!Init.jspa?pid="+a+"&issuetype="+b,a=this._getFieldValue("summary");a.length&&(e=e+"&summary="+encodeURIComponent(a));a=this._getFieldValue("description");a.length&&(e=
e+"&description="+encodeURIComponent(a));return e};d.prototype._getValidRequiredFields=function(a){var b=this;return f.filter(a.fields,function(a){var c=f.contains(b.configuration.excludedField,a.schema?a.schema.system||a.schema.custom||a.schema.customId:a);return a.required&&!c&&!a.hasDefaultValue})};d.prototype._getFieldValue=function(a){return(a=c("[name='"+a+"']",this.formEl))?c.trim(a.val()):""};d.prototype._setDescriptionAsRequiredField=function(a){var b=c('.field-group [name="description"]',
this.formEl).prev("label");b.find(".aui-icon.aui-icon-required").remove();a&&b.append(aui.icons.icon({icon:"required"}))};d.prototype.resetForm=function(){c(".aui-message",this.formEl).remove();c(".field-group",this.formEl).show();this.configuration.renderSummaryAndDescription&&this._setDescriptionAsRequiredField(!1);this.$containerRequireField.html("")};d.prototype.formHasError=function(){c(".field-group",this.formEl).hide();this.$containerRequireField.html("");jiraIntegration.JiraCreateIssueForm.FieldHelper.showField(this.defaultFields.server);
jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(c(".insert-issue-button"),!0);this._trigger("onError");this.formLoadingCompleted()};d.prototype.getCurrentServer=function(){return jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId)};d.prototype.formIsLoading=function(a){a&&jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(a,!0);a=c(":input",c(this.formEl));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(a,!0)};d.prototype.formLoadingCompleted=
function(a){a?jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(a,!1):c(".aui-icon.aui-icon-wait",this.formEl).remove();a=c(":input",c(this.formEl));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(a,!1)};d.prototype.createSelect2WithIcon=function(a){if(a.is(".server-select"))a.auiSelect2({minimumResultsForSearch:-1});else{var b=a.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,
formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,extraAttributes:this.defaultFields};a.auiSelect2(b)}a.auiSelect2("val","")};d.prototype.projectSelectFormat=function(a){var b=this.extraAttributes.server.find("option:selected").val(),b=jiraIntegration.JiraCreateIssueForm.Data.getProjectIconUrl(b,a.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:a.text,iconUrl:b,isProject:!0})};d.prototype.issueTypeSelectFormat=function(a){var b=this.extraAttributes.server.find("option:selected").val(),
c=this.extraAttributes.project.find("option:selected").val(),b=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypeIconUrl(b,c,a.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:a.text,iconUrl:b,isProject:!1})};return d}(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};
jiraIntegration.JiraCreateIssueForm.Data=function(e){function j(a){return b&&b[a]?b[a].projects:[]}function f(a,d,c){return a+(d?"-"+d:"")+(c?"-"+c:"")}var b={},g={},k=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId={0}&iconType={1}&{2}",h=[],i=function(a,d){return e.ajax({dataType:"json",timeout:0,url:a,success:d})};return{loadServers:function(){return i(AJS.contextPath()+"/rest/jira-integration/1.0/servers",function(a){a.length&&e.each(a,function(a,c){b[c.id]=c})})},loadProjects:function(a){var d=
b[a]?b[a].projects:void 0;return d?e.Deferred().resolve(d):i(AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a+"/projects?legacy=true",function(d){d.length&&(e.each(d,function(d,b){var c=_.filter(b.issuetypes,function(a){return!a.subtask});b.issueTypes=c;var e=[];_.each(c,function(a){e[a.id]=a.iconUrl});(c=b.avatarUrls["16x16"].split("/secure/projectavatar?")[1])&&-1===c.indexOf("pid=")&&(c+="&pid="+b.id);c={iconUrl:AJS.format(k,a,"project",c),issueTypes:e};h[f(a,b.id)]=c}),b[a]||(b[a]={}),
b[a].projects=d)})},getIssueTypes:function(a,d){var c=e.Deferred(),b=_.find(j(a),function(a){return a.id===d});b&&(!b.issueTypes||!b.issueTypes.length)?i(AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a+"/projects/"+d+"/issueTypes?legacy=true",function(a){if(a&&a.length)return a=_.filter(a,function(a){return!a.subtask}),b.issueTypes=a,e.Deferred().resolve()}).then(function(){c.resolve(b.issueTypes)}):c.resolve(b?b.issueTypes:[]);return c.promise()},getFieldMetadata:function(a){var b=f(a.serverId,
a.projectKey,a.issueType);return _.has(g,b)?e.Deferred().resolve(g[b]):e.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a.serverId+"/projects/"+a.projectKey+"/issue-types/"+a.issueType+"/fields-meta?legacy=true"}).pipe(function(a){g[b]=a;return g[b]})},getServerById:function(a){return b?b[a]:{}},getProjectIconUrl:function(a,b){var c=f(a,b);return h[c]?h[c].iconUrl:""},getIssueTypeIconUrl:function(a,b,c){a=f(a,b);return(a=h[a])&&a.issueTypes[c]?a.issueTypes[c]:
""},getProjects:j,isIssueCreationSupported:function(a){return!b||!b[a]?!1:void 0!==b[a].isSupported?e.Deferred().resolve(b[a].issueCreationSupported):e.ajax({type:"GET",timeout:0,url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+a+"/features"}).pipe(function(d){if(d!==void 0)b[a].issueCreationSupported=_.contains(d,"CREATE_ISSUE");return b[a].issueCreationSupported})}}}(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};
jiraIntegration.JiraCreateIssueForm.FieldHelper=function(g){function d(a){a=a.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:a,iconUrl:""})}return{fillSelectData:function(a,b,e){var f=e?[]:[d(a)];g.each(b,function(a,c){var b={value:c.id,text:c.name,iconUrl:c.iconUrl?c.iconUrl:c.avatarUrls?c.avatarUrls["16x16"]:""};e&&0===a&&(b.selected=!0);f.push(aui.form.optionOrOptgroup(b))});a.html(f.join(""));a.auiSelect2("val","")},resetSelectField:function(a){a.html(d(a));a.auiSelect2("val",
"")},hideField:function(a){a.parent().hide()},showField:function(a){a.parent().show()},setFieldDisabled:function(a,b){b?a.disable():a.enable()},setIsLoading:function(a,b){return b?a.after(aui.icons.icon({icon:"wait"})):a.next(".aui-icon.aui-icon-wait").remove()}}}(AJS.$,window._);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace jiraIntegration.templates.jiraCreateIssueForm.
 */

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'jira-create-form', extraClasses: opt_data.formClass, method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="field-group"><label for="create-issue-server-input">' + soy.$$escapeHtml('Server') + '<span class="aui-icon icon-required"> required</span></label><select id="create-issue-server-input" class="jira-select2-drop-box server-select" name="server" data-placeholder="' + soy.$$escapeHtml('Select a server') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a server') + '</option></select></div><div class="field-group"><label for="create-issue-project-input">' + soy.$$escapeHtml('Project') + '<span class="aui-icon icon-required"> required</span></label><select id="create-issue-project-input" class="jira-select2-drop-box project-select" name="project" data-placeholder="' + soy.$$escapeHtml('Select a project') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select a project') + '</option></select></div><div class="field-group"><label for="create-issue-type-input">' + soy.$$escapeHtml('Issue Type') + '<span class="aui-icon icon-required"> required</span></label><select id="create-issue-type-input" class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml('Select an issue type') + '"><option disabled selected value="">' + soy.$$escapeHtml('Select an issue type') + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.form.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.form';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_ignored) {
  var param29 = '';
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy32 = '<strong>' + soy.$$escapeHtml(opt_data.unsupportedFields) + '</strong>';
    param29 += soy.$$filterNoAutoescape(AJS.format('The required field {0} is not available in this form. You will need to',field__soy32));
  } else {
    var fieldList__soy39 = '' + jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields});
    param29 += soy.$$filterNoAutoescape(AJS.format('The required fields {0} are not available in this form. You will need to',fieldList__soy39));
  }
  param29 += ' <a href="' + soy.$$escapeHtml(opt_data.createIssueUrl) + '" target="_blank">' + soy.$$escapeHtml('create your issue directly in JIRA') + '</a>.';
  var output = '' + aui.message.warning({content: param29});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage';
}


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_ignored) {
  var output = '';
  var joinText__soy51 = '' + ((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml('and') + ' ' : ', ');
  var fieldList59 = opt_data.fields;
  var fieldListLen59 = fieldList59.length;
  for (var fieldIndex59 = 0; fieldIndex59 < fieldListLen59; fieldIndex59++) {
    var fieldData59 = fieldList59[fieldIndex59];
    output += ((! (fieldIndex59 == 0)) ? soy.$$escapeHtml(joinText__soy51) : '') + '<strong>' + soy.$$escapeHtml(fieldData59) + '</strong>';
  }
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.buildFieldList.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.buildFieldList';
}


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_ignored) {
  opt_data = opt_data || {};
  var output = '';
  var applicationNameEscaped__soy68 = '' + soy.$$escapeHtml(opt_data.applicationName);
  output += aui.message.info({content: '' + soy.$$filterNoAutoescape(AJS.format('{0}Log in and approve{1} to retrieve data from {2}','<a class="oauth-init" href="#">','</a>',applicationNameEscaped__soy68))});
  return output;
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.authorize.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.authorize';
}


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_ignored) {
  return '' + aui.message.warning({content: '' + soy.$$filterNoAutoescape(AJS.format('The version of selected JIRA server is not supported. You may want to upgrade to at least version 5.x or {0}create issue in JIRA{1}.','<a href="' + opt_data.serverUrl + '" target="_blank">','</a>'))});
};
if (goog.DEBUG) {
  jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage.soyTemplateName = 'jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-oauth-dance', location = 'applinks/internal/feature/oauth/oauth-callback.js' */
define('applinks/feature/oauth-callback', [
    'applinks/lib/window',
    'applinks/lib/lodash',
    'applinks/common/preconditions'
], function(
    window,
    _,
    Preconditions
) {
    function OAuthCallback(url) {
        Preconditions.nonEmptyString(url, 'url');
        this._url = url;
    }

    OAuthCallback.prototype.source = function(source) {
        Preconditions.hasValue(source, 'source');
        this._source = source;
        return this;
    };

    OAuthCallback.prototype.onSuccess = function(callback) {
        Preconditions.isFunction(callback, 'onSuccess');
        this._onSuccess = callback;
        return this;
    };

    OAuthCallback.prototype.onFailure = function(callback) {
        Preconditions.isFunction(callback, 'onFailure');
        this._onFailure = callback;
        return this;
    };

    // API for OAuth to invoke callbacks
    OAuthCallback.prototype.success = function() {
        this.oauthWindow.close();
        if (this._onSuccess) {
            this._onSuccess(this._source);
        }
        // free up the oauthCallback object
        delete window.oauthCallback;
    };

    OAuthCallback.prototype.failure = function() {
        this.oauthWindow.close();
        if (this._onFailure) {
            this._onFailure(this._source);
        }
        // free up the oauthCallback object
        delete window.oauthCallback;
    };

    // start the dance
    OAuthCallback.prototype.open = function() {
        // required for OAuth callbacks to fire
        window.oauthCallback = this;
        this.oauthWindow = window.open(this._url, 'com_atlassian_applinks_authentication');
    };

    return OAuthCallback;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:feature-oauth-dance', location = 'applinks/internal/feature/oauth/oauth-dance.js' */
define('applinks/feature/oauth-dance', [
    'applinks/lib/console',
    'applinks/lib/jquery',
    'applinks/lib/lodash',
    'applinks/lib/window',
    'applinks/common/events',
    'applinks/common/preconditions',
    'applinks/feature/oauth-callback'
], function(
    console,
    $,
    _,
    window,
    ApplinksEvents,
    Preconditions,
    OAuthCallback
) {
    /**
     * Creates a new OAuth Dance. This initializes elements found by `selector` within `scope` to initiate the OAuth
     * dance on click. The elements need to have a `data-authorisation-uri` attribute that points to the authorisation
     * page to open.
     *
     * @param scope {string} optional selector for scope, if not defined then global `document` will be used
     * @param selector {string} selector for the DOM elements to initialize OAuth dance for. If not defined then scope will be used
     * @constructor
     */
    function OAuthDance(scope, selector) {
        this._scope = scope || window.document;
        this._selector = selector;
    }

    OAuthDance.prototype.onSuccess = function(callback) {
        Preconditions.isFunction(callback, 'onSuccess');
        this._onSuccess = callback;
        return this;
    };

    OAuthDance.prototype.onFailure = function(callback) {
        Preconditions.isFunction(callback, 'onFailure');
        this._onFailure = callback;
        return this;
    };

    OAuthDance.prototype.defaultSuccess = function() {
        return this.onSuccess(function() {
            window.location.reload()
        });
    };

    OAuthDance.prototype.defaultFailure = function() {
        return this.onFailure(function() { return true });
    };

    /**
     * Wire up click events for the selected elements to initiate OAuth dance.
     */
    OAuthDance.prototype.initialize = function() {
        var that = this;
        if (this._selector) {
            $(this._scope).on('click', this._selector, function(e) {
                e.preventDefault();
                that._open($(this));
            });
        } else {
            $(this._scope).on('click', function(e) {
                e.preventDefault();
                that._open($(this));
            });
        }
    };

    /**
     * Start the OAuth dance for the given selector/scope.
     */
    OAuthDance.prototype.start = function() {
        var $scope = $(this._scope);
        var $element = this._selector ? $scope.find(this._selector) : $scope;
        this._open($element);
    };

    OAuthDance.prototype._open = function(element) {
        if (element.length !== 1) {
            console.warn('Could not trigger OAuth dance, the source is not a single HTML element: ' + element);
            return;
        }
        
        var authorisationUri = element.attr('data-authorisation-uri');

        if (authorisationUri) {
            this._onSuccess || this.defaultSuccess();
            this._onFailure || this.defaultFailure();
            new OAuthCallback(authorisationUri)
                .source(element)
                .onSuccess(this._onSuccess)
                .onFailure(this._onFailure)
                .open();
        } else {
            console.warn('Could not trigger OAuth dance, data-authorisation-uri missing for: ' + element);
        }
    };

    return OAuthDance;
});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-oauth-ui', location = 'js/oauth-dialog.js' */
// NOTE: this is used outside of Applinks. See atlassian-plugin.xml for more details about the associated restrictions

/**
 * @deprecated use applinks/feature/oauth-callback and applinks/feature/oauth-dance AMD module
 */
(function($, ApplinksEvents, OAuthCallback) {
    // rest-service.js will load the AppLinks name space
    AppLinks.authenticateRemoteCredentials = function (url, onSuccess, onFailure) {
        $('.applinks-error').remove();
        new OAuthCallback(url).onSuccess(onSuccess).onFailure(onFailure).open();
    };
})(require('applinks/lib/jquery'), require('applinks/common/events'), require('applinks/feature/oauth-callback'));

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:proxy-js', location = '/jira/proxy.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{makeRequest:function(a){var b=contextPath||AJS.contextPath();if(a.appId){a.data=AJS.$.extend(a.data||{},{appId:a.appId})}else{if(a.appType){a.data=AJS.$.extend(a.data||{},{appType:a.appType})}}a.data=AJS.$.extend(a.data||{},{path:a.url});a=AJS.$.extend(a,{url:b+"/plugins/servlet/applinks/proxy"});return AJS.$.ajax(a)},createProxyGetUrl:function(b){var c="";if(b.includeContext){c=contextPath||AJS.contextPath()}var a=c+"/plugins/servlet/applinks/proxy";if(b.appId){a+="?appId="+encodeURIComponent(b.appId)}else{if(b.appType){a+="?appType="+encodeURIComponent(b.appType)}else{AJS.log("You need to specify an appType or appId");return""}}if(b.path){a+="&path="+encodeURIComponent(b.path)}return a}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jqlHelper', location = '/jira/jqlhelper.js' */
AJS.JQLHelper=(function(){var a=/^\s*((key|issuekey)\s*=\s*)?"*([A-Z]+)([0-9]+)?([A-Z]+)?-([0-9]+)"*\s*$/i;var e=/\s*([A-Z][A-Z]+)-[0-9]+\s*/;var j=/(issue|searchrequest)-xml/i;var g=/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/i;var i=/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//;var c=/(jqlQuery|jql)\s*\=([^&]+)/i;var h=/(\?|&)(requestId|filter)\=([^&]+)/i;var b=/(searchrequest-xml\/)([0-9]+)\/SearchRequest/i;var k=/(requestId|filter)\=([^&]+)/i;var d=/=|!=|~|>|<|!~| is | in | was | changed /i;var f=function(p){var m="";var q=g.exec(p);if(q){m="key="+q[2]}else{var n=c.exec(p);if(n){m=n[2]}else{var o=e.exec(p);if(o){m="key="+o[0]}}}m=m.replace(/\+/g," ");return m};var l=function(n,p){var m;var o=decodeURIComponent(n);var q=function(r){if(r.jql){m=r.jql}};AJS.JQLHelper.getJqlQueryFromJiraFilter(o,p,q);return m};return{isSingleKeyJQLExp:function(m){return a.exec(m)},isMultipleSingleKeyJQLExp:function(p){var o=p.split(",");for(var n in o){var m=AJS.$.trim(o[n]);if(!AJS.JQLHelper.isSingleKeyJQLExp(m)){return false}}return true},isIssueUrlOrXmlUrl:function(m){if(g.test(m)||j.test(m)||c.test(m)||i.test(m)){return true}return false},isFilterUrl:function(m){return h.test(m)||b.test(m)},getFilterFromFilterUrl:function(m){if(h.test(m)){var n=h.exec(m);return n[2]+"="+n[3]}else{if(b.test(m)){return"filter="+b.exec(m)[2]}}},getJqlQueryFromJiraFilter:function(p,q,r,o){var m=(h.exec(p)||b.exec(p))[2];var n="/rest/jiraanywhere/1.0/jira/appLink/"+q+"/filter/"+m;AJS.$.ajax({async:false,dataType:"json",url:Confluence.getContextPath()+n,success:r,error:o})},findServerIndexFromUrl:function(m,p){if(typeof(p)!=="undefined"||p.length>0){var o=m.toLowerCase();for(var n=0;n<p.length;n++){if(o.indexOf(p[n].url.toLowerCase())==0){if(m.charAt(p[n].url.length)=="/"){return n}}}}return -1},getJqlQueryFromUrl:f,getJqlAndServerIndexFromUrl:function(n,o){var m={};m.serverIndex=this.findServerIndexFromUrl(n,o);m.jqlQuery=f(n);return m},checkQueryType:function(m){if(!AJS.Editor.JiraAnalytics){return undefined}if(!m||AJS.$.trim(m).length==0){return}if(m.indexOf("http")!=0){return AJS.Editor.JiraAnalytics.linkTypes.jqlDirect}else{if(m.indexOf("jira.issueviews:searchrequest-xml")!=-1||m.indexOf("jira.issueviews:issue-xml")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.xml}else{if(m.indexOf("jira.issueviews:searchrequest-rss")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.rss}else{if(m.indexOf("filter=")!=-1||m.indexOf("filter\\=")!=-1){return AJS.Editor.JiraAnalytics.linkTypes.filter}else{return AJS.Editor.JiraAnalytics.linkTypes.jql}}}}},convertToJQL:function(n,p){var o;if(AJS.$.trim(n)!==""){if(n.indexOf("http")===0&&this.isFilterUrl(n)){o=l(n,p)}else{if(n.indexOf("http")===0&&this.isIssueUrlOrXmlUrl(n)){var m=f(decodeURIComponent(n));if(m.length>0){o=m}}else{if(n.indexOf("http")!==0&&n.match(d)){o=n}else{if(n.match(e)){o="key="+n}else{o='summary ~ "'+n+'" OR description ~ "'+n+'"'}}}}}return o}}})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-spin', location = 'src/js/aui/spin.js' */
("undefined"===typeof window?global:window).__a70b4fb4c9c2b1f756504f809274d9f9=function(){"use strict";var f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},b=__9be3f454a87dfa12e64a40a8f483ace3,c=b&&b.__esModule?b:{"default":b};__68cc4c82652b08f36f43adf1463855f6;var g=(b=__3fc3683fc4aae94d9d5e29d2ae00dbae)&&b.__esModule?b:{"default":b},b=__7a49532771c5910a7b233af9a02dfe09;
c.default.fn.spin=(0,b.fn)(function(a,b){var d={size:"small"};if("object"===("undefined"===typeof b?"undefined":f(b)))d=c.default.extend(d,b);if("object"===("undefined"===typeof a?"undefined":f(a)))d=c.default.extend(d,a);"string"===typeof a&&(d.size=a);return"boolean"===typeof a&&!1===a?this.spinStop():this.each(function(){if(this&&this.nodeType){var a=(0,c.default)(this),b=a.data();if(b){var e=(0,c.default)("<aui-spinner filled></aui-spinner>");e.attr("size",d.size);e.css("color",d.color);a.spinStop();
a.append(e);g.default.init(this);b.spinner=e}}})},"jQuery.fn.spin",{sinceVersion:"7.9.4",removeInVersion:"9",alternativeName:"<aui-spinner>"});c.default.fn.spinStop=(0,b.fn)(function(){return this.each(function(){if(this&&this.nodeType){var a=(0,c.default)(this).data();a&&a.spinner&&(a.spinner.remove(),delete a.spinner)}})},"jQuery.fn.spinStop",{sinceVersion:"7.9.4",removeInVersion:"9",alternativeName:"<aui-spinner>"});return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:raphael', location = 'includes/js/third-party/raphael-spinner.js' */
var Raphael=Raphael||{};Raphael.spinner=function(d,a,e){var b=30*a/60;a={color:e||"#fff",width:13*a/60,radius:b,length:a-b,top:0,left:0,zIndex:0,speed:1.042};var c=$(d);c.spin(a);return function(){c.spinStop()}};Raphael.spinner=AJS.deprecate.fn(Raphael.spinner,"Raphael spinner",{alternativeName:"aui-spinner"});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:raphael', location = 'includes/js/amd/shim/raphael-amd.js' */
define("raphael",function(){return Raphael});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:applinks-bridge', location = '/jira/applinks-bridge-for-spa.js' */
define("confluence/jim/jira/applinks-bridge-for-spa",["ajs"],function(a){var d=["atlassian.net","jira-dev.com","atlassian-isolated.net","oasis-stg.com","atlassian-us-gov-mod.net","atlassian-stg-fedm.net","jira.com"];function c(e){if(!e||typeof e!=="string"){return false}for(var f=0;f<d.length;f++){if(e.indexOf("."+d[f])!==-1){return true}}return false}var b=function(e){var g=null;if(a.Editor&&a.Editor.JiraConnector&&a.Editor.JiraConnector.servers){var f=a.Editor.JiraConnector.servers.filter(function(h){return h.id===e});if(f[0]){g=f[0]}}return g};return{isCloudAppLink:function(f){var e=b(f).url;if(e){return c(e)}return false},isCloudAppLinkFromUrl:function(e){return c(e)},isCloudAppLinkFromServerId:function(f){var e=b(f);if(e){var h=e.displayUrl||e.url;var g=e.rpcUrl;return c(h)||c(g)}return false},getUrlForKey:function(e,g){var f=b(g);if(f){return f.url+"/browse/"+e}return null}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jira-analytics-helper', location = '/jira/analytics-helper.js' */
define("confluence/jim/jira/analytics-helper",["ajs","wrm","confluence/analytics-support"],function(c,b,a){return{sendAnalyticsEvent:function(d){if(!a.analyticsHandlerExists()){try{b.require("wr!com.atlassian.analytics.analytics-client:js-events").done(function(e){c.trigger("analytics",d)})}catch(f){c.trigger("analytics",d);c.warn("Unable to dynamically load legacy analytics client",f)}}else{c.trigger("analytics",d)}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/jiraanalytics.js' */
AJS.Editor=AJS.Editor||{};AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jim.paste"},search:{key:"confluence.jim.search"},trigger:{key:"confluence.jim.trigger"},customizeColumn:{key:"confluence.jim.column.customize"},customizeMaxIssues:{key:"confluence.jim.max.issues.customize"},recentlyViewedSearch:{key:"confluence.jim.recently.viewed.search"},customizeCheckedIssues:{key:"confluence.jim.checked.issues.customize"},},atlassianCloudDomain:"atlassian.net",atlassianCloudStagingDomain:"jira-dev.com",linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},isFabricEditor:function(){var a=/\/pages\/edit-v2\//;return a.test(window.location)},getAnalyticsEventData:function(){return{contentId:AJS.Meta.get("content-id")||AJS.Meta.get("page-id"),isFabric:this.isFabricEditor(),}},getDisplayType:function(a){if(!a||!a.container){return"unknown"}var b="single";if(a.container.find("#opt-table").is(":checked")){b="table"}else{if(a.container.find("#opt-total").is(":checked")){b="count"}}return b},setupAnalyticPanelActionObject:function(a,c,b){return{name:a.analyticPanelActionName,properties:this.setupPanelActionProperties(a,c,b),}},setupPanelActionProperties:function(a,e,b){var c={};if(a.analyticPanelActionName==="confluence.jim.issuecreated"){var d=a&&a.container&&a.container.find('select[name="issuetype"] :selected');if(d){c.issueType=d.text()}}else{if(a.analyticPanelActionName==="confluence.jim.searchadded"){c.display=this.getDisplayType(a)}}c.label=b;if(a&&a.selectedServer){c.appLinkId=a.selectedServer.id;if(a.selectedServer.url){c.isCloudLink=a.selectedServer.url.indexOf(this.atlassianCloudDomain)!==-1||a.selectedServer.url.indexOf(this.atlassianCloudStagingDomain)!==-1}}if(a&&a.macroParams){c.isCount=a.macroParams.count;c.maxIssues=a.macroParams.maximumIssues}return c},sendAnalyticsEvent:function(a,b){try{AJS.trigger("createGASv3Event",b);require("confluence/module-exporter").safeRequire("confluence/jim/jira/analytics-helper",function(d){d.sendAnalyticsEvent(a)})}catch(c){AJS.trigger("analytics",a);AJS.warn("Unable to dynamically require JIM analytics helper",c)}},triggerModalViewedEvent:function(a){this.sendAnalyticsEvent({},{type:"sendScreenEvent",data:{action:"viewed",actionSubject:"dialog",actionSubjectId:"jimModalViewedEvent",name:"jiraIssueMacroModal",attributes:{data:this.getAnalyticsEventData(),isEdit:a}}})},triggerPasteEvent:function(b){var a={name:AJS.Editor.JiraAnalytics.events.paste.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"pasted",actionSubject:"input",actionSubjectId:"pasteEvent",source:"jiraIssueMacroModal",attributes:a}})},triggerPanelActionEvent:function(a){a.data=AJS.$.extend(a.properties,this.getAnalyticsEventData());this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"clicked",actionSubject:"dialog",actionSubjectId:"panelActionevent",source:"jiraIssueMacroModal",attributes:a}})},triggerSearchEvent:function(b){var a={name:AJS.Editor.JiraAnalytics.events.search.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"searched",actionSubject:"input",actionSubjectId:"searchEvent",source:"jiraIssueMacroModal",attributes:a}})},triggerMarkupEvent:function(a){this.triggerSearchEvent(a)},triggerPanelTriggerEvent:function(b){var a={name:AJS.Editor.JiraAnalytics.events.trigger.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"clicked",actionSubject:"dialog",actionSubjectId:"panelTriggerEvent",source:"jiraIssueMacroModal",attributes:a}})},triggerCustomizeColumnEvent:function(b){var a={name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"clicked",actionSubject:"input",actionSubjectId:"customizeColumnEvent",source:"jiraIssueMacroModal",attributes:a}})},triggerCustomizeCheckedIssues:function(b){var a={name:AJS.Editor.JiraAnalytics.events.customizeCheckedIssues.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"clicked",actionSubject:"input",actionSubjectId:"customizeCheckedIssues",source:"jiraIssueMacroModal",attributes:a}})},triggerCustomizeMaximumIssues:function(b){var a={name:AJS.Editor.JiraAnalytics.events.customizeMaxIssues.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendUIEvent",data:{action:"clicked",actionSubject:"input",actionSubjectId:"customizeMaximumIssues",source:"jiraIssueMacroModal",attributes:a}})},triggerRecentlyViewedSearchEvent:function(b){var a={name:AJS.Editor.JiraAnalytics.events.recentlyViewedSearch.key,data:AJS.$.extend(this.getAnalyticsEventData(),b)};this.sendAnalyticsEvent(a,{type:"sendScreenEvent",data:{action:"viewed",actionSubject:"dialog",actionSubjectId:"recentlyViewedSearchEvent",source:"jiraIssueMacroModal",attributes:a}})}};(function(b){b.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(c,d){if(c&&c[0]&&c[0].pluginKey==="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPanelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})}});var a=window.tinymce;if(a){b.aop.before({target:a.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(c,d){if(c&&c[0]&&c[0].presetMacroMetadata&&c[0].presetMacroMetadata.pluginKey==="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPanelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})}});AJS.bind("init.rte",function(){b.aop.before({target:a.activeEditor,method:"execCommand"},function(m,l){if(m&&m[0]==="mceInsertContent"&&m[2]){var n=m[2];var f=AJS.$("<div></div>").html(n).children().first();var d=f.attr("data-macro-name");var j=["jira","jiraissues"];if(b.inArray(d,j)===-1){return}var k=AJS.Editor.JiraAnalytics;var o={source:"wiki_markup"};if(!f.attr("data-macro-parameters")){return}var h=f.attr("data-macro-parameters").split("|");for(var g=0;g<h.length;g++){var e=b.trim(h[g]);if(e.indexOf("jql")===0||e.indexOf("jqlQuery")===0){o.type=k.linkTypes.jqlDirect;break}else{if(e.indexOf("url")===0){var c=b.trim(e.substring(e.indexOf("=")+1,e.length));o.type=AJS.JQLHelper.checkQueryType(c);break}else{if(e.indexOf("http")===0){var c=e;o.type=AJS.JQLHelper.checkQueryType(c);break}}}}if(typeof o.type==="undefined"){o.type=k.linkTypes.jqlDirect}k.triggerMarkupEvent(o)}})})}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = 'util/dialog-helper.js' */
define("confluence/jim/util/dialog-helper",["ajs","confluence-macro-browser/macro-browser"],function(a,c){var b={addSelectOtherMacroLink:function(d){var e=window.location.pathname;if(e&&(e.includes("/edit-v2")||e.includes("/edit-embed"))){return}var f="Select Macro";d.addLink(f,function(){d.hide();var g={};g.selectedMacro=null;c.open(g)},"dialog-back-link")}};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/datatable.js' */
(function(a){AJS.DataTable=function(h,d,b){var g=null;if(h&&h.jquery){g=h}else{if(typeof h=="string"){g=a(h)}}if(g){g.addClass("data-table");if(d&&d.length){this.columns=d;if(g[0]&&typeof g[0].innerHTML==="string"&&g[0].innerHTML.substring(0,7)!=="<tbody>"){g.append("<tbody></tbody>")}var f=a("<tr></tr>").appendTo(g);f.addClass("data-table-header");for(var c=0;c<d.length;c++){var e=d[c];f.append('<th class="'+e.className+'">'+e.title+"</th>")}}}this.tbl=g;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(e){var f=a("<tr></tr>").appendTo(this.tbl);var c=this.columns;for(var b=0;b<this.columns.length;b++){var d=c[b];var g=a("<td></td>").appendTo(f);g.addClass(d.className);d.renderCell(g,e)}f.data("row-data",e);this._bindRowJs(f,this.rowIdx,"selected","hover");this.rowIdx+=1;f.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(b){var c=a("tbody tr",this.tbl)[b+1];a(c).focus()};AJS.DataTable.prototype._bindRowJs=function(f,g,c,b){var e=this;f.click(function(i){if(c){a(e.tbl).find("."+c).removeClass(c);a(this).addClass(c)}var h=f.data("row-data");e.tbl.trigger("row-select",[h])});var d=function(k){switch(k.keyCode){case 13:var j;var h=f.data("row-data");f.keyup(j=function(l){e.tbl.trigger("row-action",[h]);f.unbind("keyup",j);return AJS.stopEvent(l)});return AJS.stopEvent(k);break;case 38:if(g>0){f.prev().focus()}return AJS.stopEvent(k);case 40:var i=a("tbody tr",e.tbl).length;if(g<i-1){f.next().focus()}return AJS.stopEvent(k)}};if(a.browser.mozilla){f.keypress(d)}else{f.keydown(d)}f.focus(function(h){f.click()});if(b){f.hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)})}}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = 'editor-plugins/jim-dialog.js' */
define("confluence/jim/editor-plugins/jim-dialog",["ajs","window","jquery",],function(g,d,c){var b="ctrl+shift+j";var f="jiraconnector";var h=function(){var j=g.contextPath()+"/rest/jiraanywhere/1.0/servers";return c.get(j)};var i=function(){};var e={getOpenDialogRef:function(){return g.Editor.JiraConnector.open||i},getSourceDialogRef:function(){return g.Editor.JiraConnector.source||{}}};function a(){var j=d.tinymce;j.create("tinymce.plugins.JiraLink",{init:function(k){k.addCommand("mceJiralink",function(){var l=e.getSourceDialogRef();var m=e.getOpenDialogRef();m(l.editorHotKey,true)});k.onPostRender.add(function(l){c("#jiralink").click(function(n){var m=e.getSourceDialogRef();var o=e.getOpenDialogRef();o(m.editorDropdownLink,true);return g.stopEvent(n)});c("#insert-menu .macro-jiralink").show();l.addShortcut(b,"","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:j.majorVersion+"."+j.minorVersion}}});j.PluginManager.add(f,j.plugins.JiraLink);g.Rte.BootstrapManager.addTinyMcePluginInit(function(l){l.plugins+=","+f;var m=l.theme_advanced_buttons1;var k=m.indexOf("confimage");l.theme_advanced_buttons1=m.substring(0,k)+"jiralinkButton,"+m.substring(k)})}return{init:function(){h().then(function(m){g.Editor=g.Editor||{};g.Editor.JiraConnector=g.Editor.JiraConnector||{};g.Editor.JiraConnector.servers=m||[]});var l=/\/pages\/edit-v2\//;var k=l.test(d.location);if(!k){var j=/createblogpost\.action|draft-createpage\.action|createpage\.action|createpagetemplate\.action/;if(!j.test(d.location.pathname)){g.bind("rte-pre-resolveplugins",a)}else{a()}}}}});require("confluence/module-exporter").safeRequire("confluence/jim/editor-plugins/jim-dialog",function(a){a.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/dialogs.js' */
AJS.Editor=AJS.Editor||{};AJS.Editor.JiraConnector=(function(j){var f="";var c="Insert Jira Issue/Filter";var a="Insert";var h="Cancel";var l=function(){var p=navigator.platform.toLowerCase().indexOf("mac")!=-1;return p?"Cmd":"Ctrl"};var b={macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"};var o=AJS.format("Hint: type \"{0}+Shift+J\" in the editor to quickly access this dialog.",l());var n,m,d;var i=function(){var p=j("#createPageLabelsString");if(p.length>0){m=p.val().split(" ").join();AJS.Editor.JiraAnalytics.triggerPanelTriggerEvent({source:n,label:m});return}j.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(r){var q=[];j.each(r.labels,function(t,s){q.push(s.name)});m=q.join();AJS.Editor.JiraAnalytics.triggerPanelTriggerEvent({source:n,label:m})})};var g=function(p,q){if(AJS.Editor.JiraAnalytics){AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(q,n,m);if(p.customizedColumn){AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:p.customizedColumn})}}};var e=function(x,s){if(AJS.Editor.JiraAnalytics){AJS.Editor.JiraAnalytics.triggerModalViewedEvent(s||false)}if(!d){d=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});d.addHeader(c);var u=AJS.Editor.JiraConnector.Panels;for(var t=0;t<u.length;t++){d.addPanel(u[t].title());var q=d.getCurrentPanel();var v=u[t];v.init(q)}var p=require("confluence/jim/util/dialog-helper");p.addSelectOtherMacroLink(d);d.addHelpText(o);j("#jira-connector .dialog-tip").attr("title",o);d.addButton(a,function(){var A=d.getCurrentPanel().id;var z=u[A];var y=u[0];g(y,z);z.insertLink()},"insert-issue-button");AJS.$(".insert-issue-button").disable();d.addCancel(h,function(){AJS.Editor.JiraConnector.closePopup()});d.gotoPanel(0);if(AJS.Editor.JiraConnector.servers){for(var t=0;t<AJS.Editor.JiraConnector.servers.length;t++){var r=AJS.Editor.JiraConnector.servers[t];AppLinks.makeRequest({appId:r.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:t,success:function(y){if(y&&y.length){AJS.Editor.JiraConnector.servers[this.serverIndex].columns=y}},error:function(){AJS.warn("Jira Issues Macro: unable to retrieve fields from AppLink: "+r.id)}})}}j("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",label:"Jira Charts"}));j("#jira-connector .dialog-page-menu button").click(function(){var y=AJS.Editor.JiraConnector.Panels[d.getCurrentPanel().id];y.setInsertButtonState&&y.setInsertButtonState()});j("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();if(AJS.Editor.JiraChart){AJS.Editor.JiraChart.open()}})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(x){d.gotoPanel(1);var w=AJS.Editor.JiraConnector.Panels[1];w.setSummary(x)}else{d.gotoPanel(0)}d.overrideLastTab();d.show()};var k=function(){if(AJS.Editor.JiraConnector.clickConfigApplink){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:false}).done(function(p){AJS.Editor.JiraConnector.servers=p})}if(typeof(AJS.Editor.JiraConnector.servers)=="undefined"||AJS.Editor.JiraConnector.servers.length==0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}AJS.Editor.JiraConnector.clickConfigApplink=false;if(AJS.Editor.JiraConnector.refreshAppLink){AJS.Editor.JiraConnector.refreshAppLink.call();AJS.Editor.JiraConnector.refreshAppLink=false}return true};return{warningPopup:function(r){var p=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"});var q="Connect Confluence To Jira";p.addHeader(q);var s=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:r});p.addPanel("Panel 1",s);p.get("panel:0").setPadding(0);if(r){p.addButton("Set connection",function(t){AJS.Editor.JiraConnector.clickConfigApplink=true;t.hide();var u=require("confluence-macro-browser/macro-browser-facade");u.cancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action")},"create-dialog-create-button app_link");p.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")}else{p.addButton("Contact admin",function(t){t.hide();var u=require("confluence-macro-browser/macro-browser-facade");u.cancel();window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action")})}p.addLink("Cancel",function(t){t.hide();var u=require("confluence-macro-browser/macro-browser-facade");u.cancel()});p.show();p.gotoPanel(0)},closePopup:function(){d.hide()},open:function(s,t){if(!k()){return}AJS.Rte.BookmarkManager.storeBookmark();n=s;if(AJS.Editor.JiraAnalytics&&n){if(n===AJS.Editor.JiraConnector.source.instructionalText){i()}else{m=null;AJS.Editor.JiraAnalytics.triggerPanelTriggerEvent({source:n})}}var p=require("confluence-macro-browser/macro-browser-facade");var r=p.getTinyMceMacroBrowserIfHave();if(r){var q=r.getCurrentNode();if(r.isMacroTag(q)&&"jira"==j(q).attr("data-macro-name")){r.editMacro(q);return}}AJS.Editor.JiraConnector.openCleanDialog(t)},openCleanDialog:function(r){var q=r&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});e(q);var p=AJS.Editor.JiraConnector.Panels[0];p.setMacroParams(null)},edit:function(t){if(!k()){return}if(typeof(t.params)=="undefined"){AJS.Editor.JiraConnector.openCleanDialog(false);return}n=f;m=f;var v=function(y){if(y.hasOwnProperty("jqlQuery")){return y.jqlQuery}var x=/^([0-9]\d*)$/;var w=["count","columns","columnIds","title","renderMode","cache","width","height","server","serverId","anonymous","baseurl","showSummary"];for(var z in y){if(j.inArray(z,w)==-1&&y.hasOwnProperty(z)){if(x.test(z)){return y[z]}return z+=" = "+y[z]}}return""};var q=function(y){var z={};if(y.params.url){z.searchStr=y.params.url;return z}z.maximumIssues=y.params.maximumIssues;var w=y.defaultParameterValue||v(y.params);if(typeof(w)=="undefined"){z.searchStr=f}else{z.searchStr=w}if(typeof(y.params.server)!="undefined"){z.serverName=y.params.server}else{for(var x=0;x<AJS.Editor.JiraConnector.servers.length;x++){if(AJS.Editor.JiraConnector.servers[x].selected){z.serverName=AJS.Editor.JiraConnector.servers[x].name;break}}}z.columnIds=y.params.columnIds;return z};var s=function(y){var z=q(y);var x=y.params.count;if(typeof x==="undefined"){x="false"}z.count=x;var w=y.params.columns;if(typeof(w)!="undefined"){if(w.length){z.columns=w}}return z};var r=s(t);e(undefined,true);if(r.searchStr){d.gotoPanel(0);var p=AJS.Editor.JiraConnector.Panels[0];p.setMacroParams(r);var u={searchValue:r.searchStr,serverName:r.serverName,isJqlQuery:t.params.hasOwnProperty("jqlQuery"),isAutoSearch:true};p.doSearch(u)}},source:b}})(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=false;
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/panelhelper.js' */
AJS.Editor.JiraConnector.Panel=function(){};AJS.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(a){this.insertIssueLinkWithParams({key:a})},insertJqlLink:function(a){this.insertIssueLinkWithParams({jqlQuery:a})},insertIssueLinkWithParams:function(c){c.server=this.selectedServer.name;c.serverId=this.selectedServer.id;var b={name:"jira",params:c};var a=require("confluence-macro-browser/macro-browser-facade");a.insert(b);if(AJS.Editor.JiraAnalytics&&AJS.Editor.JiraConnector.analyticPanelActionObject){AJS.Editor.JiraAnalytics.triggerPanelActionEvent(AJS.Editor.JiraConnector.analyticPanelActionObject);AJS.Editor.JiraConnector.analyticPanelActionObject=null}AJS.Editor.JiraConnector.closePopup()},disableInsert:function(){AJS.$(".insert-issue-button").disable()},isInsertDisabled:function(){return AJS.$(".insert-issue-button").is(":disabled")},getOAuthRealm:function(d){var b=d.getResponseHeader("WWW-Authenticate")||"";var a=/OAuth realm\=\"([^\"]+)\"/;var c=a.exec(b);if(c){return c[1]}else{return null}},enableInsert:function(){AJS.$(".insert-issue-button").enable()},handleInsertWaiting:function(b){var a=AJS.$(".insert-issue-button");return b?a.before(aui.icons.icon({icon:"wait"})):a.prev(".aui-icon.aui-icon-wait").remove()},msg:function(a,c,b){if(aui&&aui.message){try{var h=AJS.$('<div class="aui-message-container"/>');var f=c;if(c.html){f=c.html()}var i={content:f};var d;switch(b){case"error":d=aui.message.error(i);break;case"success":d=aui.message.success(i);break;case"warning":d=aui.message.warning(i);break;default:d=aui.message.info(i)}h.append(d);c=h}catch(g){if(AJS&&AJS.logError){AJS.logError("jira-connector",g)}}}a.append(c)},errorMsg:function(a,c){this.removeError(a);var b=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="jira-error"></div>').prependTo(a):AJS.$('<div class="jira-error"></div>').appendTo(a);this.msg(b,c,"error")},warningMsg:function(a,b){this.removeError(a);var c=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="jira-error"></div>').prependTo(a):AJS.$('<div class="jira-error"></div>').appendTo(a);this.msg(c,b,"warning")},noServerMsg:function(a,b){var d=AJS.$('<div class="data-table jiraSearchResults" ></div>').appendTo(a);var c=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="message-panel"/>').prependTo(d):AJS.$('<div class="message-panel"/>').appendTo(d);this.msg(c,b,"info")},ajaxError:function(c,b){if(c.status==401){var a=this.getOAuthRealm(c);this.selectedServer.authUrl=a;b.call(this)}else{this.errorMsg(this.container,"Received the following HTTP error code from the server"+":"+c.status)}},removeError:function(a){AJS.$("div.jira-error",a).remove()},setActionOnEnter:function(a,c,b){a.unbind("keydown").keydown(function(d){if(d.which==13){var f=function(g){a.unbind("keyup",f);c(b);return AJS.stopEvent(g)};a.keyup(f);return AJS.stopEvent(d)}})},createOauthForm:function(e){var d=this.selectedServer;var c={onSuccess:function(){d.authUrl=null;e(d)},onFailure:function(){}};var a='<a class="oauth-init" href="#">'+"Login & Approve"+"</a> "+"to retrieve data from"+" "+AJS.escapeHtml(this.selectedServer.name);var b=AJS.$('<div class="jira-oauth-message-marker"/>');if(!(aui&&aui.message)){b.addClass("oauth-message")}this.msg(b,a,"info");AJS.$(".oauth-init",b).click(function(f){AppLinks.authenticateRemoteCredentials(d.authUrl,c.onSuccess,c.onFailure);f.preventDefault()});return b},applinkServerSelect:function(a,b){var c=this;var d=AJS.Editor.JiraConnector.servers;AJS.$(d).each(function(){var e="<option ";if(this.selected){c.selectedServer=this;e+='selected="selected"'}e+='value="'+this.id+'"></option>';e=AJS.$(e);e.text(this.name);AJS.$(a).append(e);e.data("jiraapplink",this)});AJS.$(a).change(function(h){var f=AJS.$("option:selected",a);var g=f.data("jiraapplink");b(g)})},showSpinner:function(d,a,c,b){AJS.$.data(d,"spinner",Raphael.spinner(d,a,"#666"));if(c){AJS.$(d).css("marginLeft",-a*1.2)}if(b){AJS.$(d).css("marginTop",-a*1.2)}},hideSpinner:function(a){AJS.$(a).css("marginTop","");AJS.$(a).css("marginLeft","");var b=AJS.$.data(a,"spinner");if(b){b();delete b;AJS.$.data(a,"spinner",null)}},setSelectedIssue:function(a){this.selectedIssue=a;this.enableInsert()},insertSelected:function(){if(this.selectedIssue){this.insertIssueLink(this.selectedIssue.key)}},createIssueTableFromUrl:function(c,f,b,a,d,i,j,g,e){AJS.$("div.data-table",c).remove();var k=AJS.$('<div class="data-table jiraSearchResults" ></div>').appendTo(c);var l=AJS.$('<div class="loading-data"></div>').appendTo(k);this.removeError(c);this.showSpinner(l[0],50,true,true);var h=this;this.currentXhr=AppLinks.makeRequest({appId:f.id,type:"GET",url:b,dataType:"json",success:function(q){l.remove();var r=q.issues;AJS.$(":disabled",c).enable();if(r.length){var u=AJS.$('<table class="my-result aui"></table>');AJS.$(".jiraSearchResults",c).append(u);var o=[];if(e){var t={className:"issue-checkbox-column",title:'<input type="checkbox" name="jira-issue-all" checked aria-label="'+"Select all options"+'"/>',renderCell:function(y,w){var x=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({issueKey:w.key});AJS.$(x).appendTo(y)}};o.push(t)}var s=[{className:"issue-key-column",title:"Key",renderCell:function(y,x){var w=Confluence.Templates.ConfluenceJiraPlugin.issueKey({issueIconUrl:x.iconUrl.replace(f.rpcUrl,f.url),issueKey:x.key});AJS.$(w).appendTo(y)}},{className:"issue-summary-column",title:"Summary",renderCell:function(x,w){x.text(w.summary)}}];o=o.concat(s);var m=new AJS.DataTable(u,o);r.forEach(function(w){var x={iconUrl:w.fields.issuetype.iconUrl,key:w.key,summary:w.fields.summary,url:f.url+"/browse/"+w.key};m.addRow(x)});u.bind("row-action",function(x,w){d.call(h,w)});u.bind("row-select",function(x,w){a.call(h,w)});m.selectRow(0);if(j){var n=AJS.$("issue",q).attr("total");j.call(h,n)}}else{if(i){i()}var v="No search results found.";var p=AJS.$('<div class="message-panel"/>');h.msg(p,v,"info");AJS.$(".jiraSearchResults",c).append(p)}},error:function(m){AJS.$(":disabled",c).enable();l.remove();g.call(h,m)}})},retrieveJson:function(c,a,d,b){AppLinks.makeRequest({appId:c,type:"GET",url:a,dataType:"json",success:d,error:b})},isCloudAppLink:function(b){if(!b){return false}var a=window.require("confluence/jim/jira/applinks-bridge-for-spa");return a.isCloudAppLinkFromUrl(b.url)||a.isCloudAppLinkFromUrl(b.rpcUrl)}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",defaultColumnIds:"issuekey,summary,issuetype,created,updated,duedate,assignee,reporter,priority,status,resolution",aliases:[{id:"issuekey",clauseName:"key"},{id:"issuetype",clauseName:"type"},{id:"duedate",clauseName:"due"}],DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1000,MINIMUM_MAX_ISSUES_VAL:1,title:function(){return "Search"},init:function(a){a.html('<div id="my-jira-search"></div>');var f=this;var b=AJS.$("#my-jira-search");this.container=b;var h=function(){b.children(":not(div.jira-search-form)").remove()};var e=function(){AJS.$("input.text",b).enable();AJS.$("button",b).enable()};var l=function(){AJS.$("button",b).disable();AJS.$("input.text",b).disable()};var i=function(n){h();f.disableInsert();if(n){f.selectedServer=n}if(f.selectedServer.authUrl){l();var m=f.createOauthForm(function(){h();e()});b.append(m)}else{e();AJS.$(".search-help").show()}};this.authCheck=i;var g=function(x){var m=x&&x.searchValue;var o=x&&x.serverName;if(m){AJS.$("input:text",b).val(m)}if(o&&o!=this.selectedServer.name){var y=AJS.Editor.JiraConnector.servers;var q=false;for(var r=0;r<y.length;r++){if(y[r].name==o){AJS.$('option[value="'+y[r].id+'"]',b).attr("selected","selected");AJS.$("select",b).change();q=true;break}}if(!q){c(AJS.Meta.get("is-admin"));return}}if(this.currentXhr&&this.currentXhr.readyState!=4){return}var p=m||AJS.$("input",b).val();if(AJS.Editor.JiraAnalytics){var w=AJS.JQLHelper.checkQueryType(p);if(w){AJS.Editor.JiraAnalytics.triggerSearchEvent({type:w,jqlQueryCharacterLength:p.length,numberOfServers:AJS.Editor.JiraConnector.servers.length,source:"dialog"})}}var s=function(C,G,D){var E=AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("confluence_enable_new_jira_search_api")&&f.isCloudAppLink(f.selectedServer);var B=b.find("#jiraIssueColumnSelector");var F=B.val()&&B.val();AJS.$("select",b).disable();l();f.lastSearch=C;const A=!E?"/rest/api/latest/search?jql="+encodeURIComponent(C)+"&fields=summary,issuetype,status&startAt=0&maxResults=20&validateQuery=none":"/rest/api/latest/search/jql?jql="+encodeURIComponent(C)+"&fields=summary,issuetype,status&maxResults=20";f.createIssueTableFromUrl(b,f.selectedServer,A,f.selectHandler,f.insertLinkFromForm,function(){f.addDisplayOptionPanel();f.loadMacroParams(F);f.bindEventToDisplayOptionPanel(true,x);f.enableInsert()},function(H){f.addDisplayOptionPanel();f.loadMacroParams(F);f.bindEventToDisplayOptionPanel(false,x);f.updateTotalIssuesDisplay(H);f.checkAutoSelectColumns();x&&x.isAutoSearch&&f.focusForm()},function(H){f.disableInsert();if(H.status==400){if(D){D()}else{AJS.$("div.data-table",b).remove();f.warningMsg(b,AJS.format("The Jira server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{AJS.$("div.data-table",b).remove();f.ajaxError(H,i)}x&&x.isAutoSearch&&f.focusForm()},true)};if(AJS.JQLHelper.isFilterUrl(p)){var n=decodeURIComponent(p);var v=AJS.JQLHelper.findServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(v!=-1){var t=AJS.Editor.JiraConnector.servers[v].id;AJS.$('option[value="'+t+'"]',b).attr("selected","selected");AJS.$("select",b).change();var z=AJS.JQLHelper.getFilterFromFilterUrl(n);if(z){AJS.$("input",b).val(z);s(z)}else{h();f.warningMsg(b,AJS.format("The Jira server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{h();f.disableInsert();c(AJS.Meta.get("is-admin"))}}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(p)){var n=decodeURIComponent(p);var u=AJS.JQLHelper.getJqlAndServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(d(u)){AJS.$("input",b).val(u.jqlQuery);s(u.jqlQuery,false,null)}}else{if(p.match(f.jql_operators)){s(p,false,null)}else{if(AJS.JQLHelper.isSingleKeyJQLExp(p)){s("key = "+p,true)}else{if(AJS.JQLHelper.isMultipleSingleKeyJQLExp(p)){s("key in ("+p+")",true)}else{s('summary ~ "'+p+'" OR description ~ "'+p+'"',false,null)}}}}}};this.doSearch=g;f.addSearchForm();var d=function(m){var n;if(m.serverIndex!=-1){AJS.$('option[value="'+AJS.Editor.JiraConnector.servers[m.serverIndex].id+'"]',b).attr("selected","selected");AJS.$("select",b).change();if(m.jqlQuery.length==0){h();f.errorMsg(b,"The Jira server didn\'t understand your search query. If you entered JQL, please ensure that it\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}")}else{n=m.jqlQuery}}else{h();f.disableInsert();c(AJS.Meta.get("is-admin"))}return n};f.processJiraParams=d;var c=function(m){var o=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:m,contextPath:Confluence.getContextPath()});f.noServerMsg(b,o);var n=AJS.$("#open_applinks");n.bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=true;AJS.Editor.JiraConnector.refreshAppLink=function(){f.refreshSearchForm()}})};f.bindPasteEvent();AJS.$(a).select(function(){f.validate()});var k=AJS.$(".jql-display-opts-open.disabled");var j={live:true,title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0};k.tooltip(j)},focusForm:function(){AJS.$('input[name="jiraSearch"]',this.container).focus()},addSearchForm:function(){var e=this;e.container.empty();var g=AJS.Editor.JiraConnector.servers;e.selectedServer=g[0];var a=false;if(g.length>1){a=true}var f=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:a});var d=AJS.$(f).appendTo(e.container);if(g.length>1){var c=AJS.$('<div class="search-server-select-container"></div>');AJS.$('<label for="search-server-select"></label>').text("Choose server").appendTo(c);var b=AJS.$('<select id="search-server-select" class="select" tabindex="0"></select>').appendTo(c);c.insertAfter("div.search-input",d);e.applinkServerSelect(b,e.authCheck)}e.authCheck(e.selectedServer);AJS.$("button",e.container).click(function(){e.doSearch()});e.setActionOnEnter(AJS.$("input.text",e.container),e.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var b=this;setTimeout(function(){var d=AJS.$(b).val();if(AJS.JQLHelper.isFilterUrl(d)){a.doSearch()}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(d)){var e=decodeURIComponent(d);var c=AJS.JQLHelper.getJqlAndServerIndexFromUrl(e,AJS.Editor.JiraConnector.servers);if(a.processJiraParams(c)){AJS.$(b).val(c.jqlQuery);a.doSearch()}}}},100)})},refreshSearchForm:function(){this.container.empty();this.addSearchForm();this.bindPasteEvent()},validate:function(e,d){var c=this.container;var f=AJS.$("input:checkbox[name=jira-issue]",c);var b=AJS.Editor.JiraConnector.Panel.Search.prototype;if(f.length||e){var a=AJS.$("input:checkbox[name=jira-issue]:checked",c).length;if(a>0||e){b.enableInsert()}else{b.disableInsert()}b.changeInsertOptionStatus(a,e,d)}else{if(AJS.$(".jira-oauth-message-marker",c).length){b.authCheck(this.selectedServer)}AJS.$("input",c).focus();b.disableInsert()}if(b.isInsertDisabled()){return}b.validateMaxIssues()},isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&(this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL)},validateMaxIssues:function(i){var b=AJS.$("#jira-maximum-issues");function d(){b.next("#jira-max-number-error").remove()}function f(){b.attr("disabled","disabled")}function h(){b.removeAttr("disabled")}function c(){d();b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues())}switch(AJS.$("input:radio[name=insert-advanced]:checked").val()){case"insert-single":case"insert-count":d();f();break;case"insert-table":var a=AJS.Editor.JiraConnector.Panel.Search.prototype;h();var g=b.val();if(AJS.$.trim(g)===""){if(i&&i.type==="keyup"){d();break}if(i&&i.type==="blur"){g=a.MAXIMUM_MAX_ISSUES_VAL;b.val(g);break}}if(a.isValidMaxIssues(g)){d();a.enableInsert()}else{c();a.disableInsert()}break}},customizedColumn:null,parseColumnsStringToArray:function(g){var f="";var b=[];var a=null;var c=function(i,h){i=AJS.$.trim(i);if(i!=""){h.push(i)}};for(var e=0;e<g.length;e++){var d=g.charAt(e);if(d!==","&&d!=='"'&&d!=="'"){f+=d}if(d==='"'||d==="'"){if(a==null){a=d}else{if(a===d){c(f,b);f="";a=null}}}else{if(d===","){if(a==null){c(f,b);f=""}else{f+=d}}}}c(f,b);return b},parseArrayToColumnString:function(b){var a="";for(var c=0;c<b.length;c++){var d=AJS.$.trim(b[c]);if(d!=""){if(d.indexOf(",")>=0){d='"'+d+'"'}if(c!=0){a+=","}a+=d}}},checkAndSetDefaultValueMaximumIssues:function(a){if(!a){AJS.log("Cannot set default value for Maximum Issues");return}var b=a.element||AJS.$("#jira-maximum-issues");var d=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;var c=AJS.$.trim(b.val());if(c===""){b.val(d)}},setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var g=((AJS.$("input:radio[name=insert-advanced]:checked").val()=="insert-count"));var e=this;var b=[];var f=[];var a=[];var d={};AJS.$("#my-jira-search .my-result.aui input:checkbox[name=jira-issue]").each(function(h){var j=AJS.$(this);if(j.is(":checked")){f[f.length]=j.val()}else{a[a.length]=j.val()}});if(g){d.count="true"}else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){d.columns=this.defaultColumns;d.columnIds=this.defaultColumnIds;return}b=AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.select2("data");if(b.length){d.columns=b.map(function(h){return e.selectedServer.columns.find(function(i){return i.id===h.id}).custom?h.text:h.id}).map(function(h){var i=e.aliases.find(function(j){return j.id===h});return i?i.clauseName:h}).join(",");d.columnIds=b.map(function(h){return h.id}).join(",")}else{d.columns=this.defaultColumns;d.columnIds=this.defaultColumnIds}}var c=AJS.$("input:radio[name=insert-advanced]:checked").val();if(c==="insert-single"){d.key=f.toString()}else{if(a.length===0){d.jqlQuery=this.lastSearch+" "}else{if(f.length===1){AJS.Editor.JiraAnalytics.triggerCustomizeCheckedIssues({numChecked:1,numUnchecked:a.length});d.jqlQuery="key = "+f.toString()}else{AJS.Editor.JiraAnalytics.triggerCustomizeCheckedIssues({numChecked:f.length,numUnchecked:a.length});d.jqlQuery="key in ("+f.toString()+")"}}}if(c==="insert-table"){d.maximumIssues=AJS.$("#jira-maximum-issues").val()}return d},insertLinkFromForm:function(){var c=this;var b=c.container;var d=AJS.$("input:checkbox[name=jira-issue]",b);if(d.length){var a=AJS.$("input:checkbox[name=jira-issue]:checked",b).length;if(a>0){c.insertLink()}}},insertLink:function(d){var b;if(d&&typeof d.insertIssueLinkWithParams==="function"){b=d}else{b=this}var c=b.getMacroParamsFromUserInput();b.insertIssueLinkWithParams(c);if(c&&AJS.Editor&&AJS.Editor.JiraAnalytics&&AJS.Editor.JiraAnalytics){if(c.columns&&c.columns!==this.defaultColumns){var a=c.columns.split(",").length;AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({numColumns:a})}if(c.maximumIssues&&c.maximumIssues!==String(this.DEFAULT_MAX_ISSUES_VAL)){AJS.Editor.JiraAnalytics.triggerCustomizeMaximumIssues({maxIssues:parseInt(c.maximumIssues)})}}return true},loadMacroParams:function(c){var a=this.macroParams;if(!a){this.checkAndSetDefaultValueMaximumIssues({defaultVal:20});this.prepareColumnSelect(c)}else{if(!a.maximumIssues){AJS.$("#jira-maximum-issues").attr("disabled","disabled")}if(a.count=="true"){AJS.$("#opt-total").prop("checked",true)}else{AJS.$("#opt-table").prop("checked",true);AJS.$("#jira-maximum-issues").removeAttr("disabled");var b=a.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL;this.checkAndSetDefaultValueMaximumIssues({defaultVal:b})}this.prepareColumnSelect(c)}},selectHandler:function(){var a=this.container;var b=a.find("tr.selected");if(b.length){b.unbind("keydown.space").bind("keydown.space",function(c){if(c.which==32||c.keyCode==32){var d=b.find("[type=checkbox]");d.trigger("click")}})}},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(b){return false})},updateTotalIssuesDisplay:function(b){var a=this.selectedServer.url+"/issues/?jql="+this.lastSearch;if(b>20){AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:a}))}var c=AJS.format("{0} issues",b);AJS.$(".total-issues-text").html(c);AJS.$(".total-issues-link").attr("href",a)},escapeMarkup:function(b){if(b&&typeof(b)==="string"){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;",};return String(b).replace(/[&<>"']/g,function(c){return a[c]})}},prepareColumnSelect:function(g){var e=this;var a=!(this.macroParams&&!this.macroParams.columnIds);var c=g||(this.macroParams&&this.macroParams.columnIds&&this.macroParams.columnIds.split(","))||(this.macroParams&&this.macroParams.columns&&this.macroParams.columns.toLowerCase().split(","))||this.defaultColumnIds.split(",");var d={};var f=this.selectedServer;var b=function(j){var i=AJS.$("#jiraIssueColumnSelector");var k="";var m="";j.filter(function(q){return q.navigable}).sort(function(r,q){var s=c.map(function(t){var u=e.aliases.find(function(v){return v.clauseName===t});return u?u.id:t});return s.indexOf((a||!r.custom)?r.id:r.name.toLowerCase())-s.indexOf((a||!q.custom)?q.id:q.name.toLowerCase())}).forEach(function(q){if(c.find(function(r){if(a){return r===q.id}else{if(!a&&!!d[r]){return false}}return q.clauseNames.includes(r)||r===q.name.toLowerCase()})){m+=AJS.template('<option selected="true" value="{fieldId}">{fieldName}</option>').fill({fieldId:q.id,fieldName:e.escapeMarkup(q.name)});if(!a){d[q.name]=true}}else{key=q.id.toLowerCase();k+=AJS.template('<option value="{fieldId}">{fieldName}</option>').fill({fieldId:q.id,fieldName:e.escapeMarkup(q.name)})}});i.hide();i.html(m+k);i.show();function n(s,q){var r=q.prevObject.children().last();r.attr({tabindex:0,role:"button","aria-label":"Remove column "+s.text});r.bind("keypress",function(u){if(u.which===32){var t=i.val();t.splice(t.indexOf(s.id),1);i.val(t).trigger("change")}});return e.escapeMarkup(s.text)}function o(r,q){q.attr("role","presentation");return r.text}i.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns",formatSelection:n,formatResult:o});var h;var p=AJS.$(".select2-container-jira-issue-columns .select2-search-field input");if(p){p.attr({role:"combobox","aria-autocomplete":"list","aria-controls":"select2-results-jira-issue-columns","aria-haspopup":"listbox","aria-expanded":false})}var l="";i.on("select2-highlight",function(q){if(p){p.attr("aria-activedescendant","jira-"+q.val)}if(h){h.attr("aria-activedescendant","jira-"+q.val);AJS.$("#jira-"+l).removeAttr("aria-selected")}AJS.$("li.select2-highlighted").attr({id:"jira-"+q.val,"aria-label":q.choice.text,"aria-selected":true});l=q.val}).on("select2-loaded",function(r){var q=AJS.$(".select2-drop-active");if(q){q.removeAttr("aria-hidden")}h=AJS.$(".select2-drop-active .select2-results");if(h){h.attr({role:"listbox",id:"select2-results-jira-issue-columns"});h.children().attr("role","option")}}).on("select2-open",function(q){if(p){p.attr("aria-expanded",true)}}).on("select2-close",function(q){if(p){p.attr("aria-expanded",false)}});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=i};if(f.columns&&f.columns.length>0){b(f.columns);return}this.retrieveJson(f.id,"/rest/api/2/field",function(h){if(h&&h.length){f.columns=h;b(f.columns)}})},expandDisplayOptPanel:function(){var b=AJS.$(".jql-display-opts-overlay");var c=b.height();var d=40;b.css("top","");var a=-(c-d);b.css("bottom",a+"px");b.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:420},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",false)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",true)},checkAutoSelectColumns:function(){if(AJS.$("#opt-table").prop("checked")){this.enableAutoSelectColumns()}else{this.disableAutoSelectColumns();this.enableInsert()}},bindEventToDisplayOptionPanel:function(f,h){var d=this;var b=AJS.$(".jql-display-opts-close, .jql-display-opts-open");var c=AJS.$(".jql-display-opts-overlay");var i=AJS.$(".jql-display-opts-inner .radio");var a=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]");var e=AJS.$("#my-jira-search input:checkbox[name=jira-issue]");var g=AJS.$("#jira-maximum-issues");g.on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);c.css("top","420px");b.click(function(j){j.preventDefault();if(AJS.$(this).hasClass("disabled")){return}var k=AJS.$(this).hasClass("jql-display-opts-open");if(k){d.expandDisplayOptPanel();jQuery(this).addClass("jql-display-opts-close");jQuery(this).removeClass("jql-display-opts-open")}else{d.minimizeDisplayOptPanel();jQuery(this).removeClass("jql-display-opts-close");jQuery(this).addClass("jql-display-opts-open")}});i.change(function(){d.checkAutoSelectColumns();d.validateMaxIssues()});a.bind("click",function(){var j=AJS.$(this);if(j.prop("checked")){e.prop("checked","checked")}else{e.removeAttr("checked")}d.validate()});e.change(function(){var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:not(:checked)").length;if(j>0){a.removeAttr("checked")}else{a.prop("checked","checked")}d.validate()});d.validate(f,h)},changeInsertOptionStatus:function(q,n,f){var r=this;var g=AJS.$("#opt-single");var d=AJS.$("#opt-total");var m=AJS.$("#opt-table");var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:checked");var i=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]").attr("checked")==="checked";var l=j.length===1;var p=j.length>1;var h=j.length===0;var b=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name=jiraSearch]").val());var c=function(){if(f&&f.isJqlQuery){m.click()}else{g.click()}};var k=function(){d.attr("disabled","disabled");m.removeAttr("disabled");g.removeAttr("disabled");c();setTimeout(function(){c()},100)};var e=function(){g.attr("disabled","disabled");d.removeAttr("disabled");if(AJS.$("input[name=insert-advanced]:checked").val()==="insert-single"){setTimeout(function(){m.removeAttr("disabled").click()},100)}};var o=function(){m.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");g.removeAttr("disabled","disabled");var s=AJS.$("input:radio[name=insert-advanced]:checked").val();if(s==="insert-single"){setTimeout(function(){m.click()},100)}};var a=function(){g.attr("disabled","disabled");d.attr("disabled","disabled");m.attr("disabled","disabled");AJS.$(".jql-display-opts-close").click();AJS.$(".jql-display-opts-open").addClass("disabled")};AJS.$(".jql-display-opts-open").removeClass("disabled");g.removeAttr("disabled");d.removeAttr("disabled");m.removeAttr("disabled");if(i&&l&&b){k()}else{if(i&&l&&!b){o()}else{if(p){e()}else{if(l&&!i){k()}else{if(n){e()}else{if(h){a()}}}}}}},isInsertTableType:function(){return AJS.$("input:radio[name=insert-advanced]:checked").val()==="insert-table"},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open");var b=AJS.$("#jira-maximum-issues");if(!a.length||(a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(b.val()))){this.disableInsert()}else{this.enableInsert()}},analyticPanelActionName:"confluence.jim.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:true,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(b){var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.length&&a.val(b)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",this.container);if(a.length){a.focus()}else{var b=AJS.$(".project-select",this.container);b.length&&b.focus()}},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();if(this.selectedServer.authUrl){this.showOauthChallenge()}else{this.serverSelect()}},ajaxAuthCheck:function(b){var a=this;this.endLoading();this.ajaxError(b,function(){a.authCheck(a.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",this.container).remove();var a=this;var b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(this.formHasError===false&&this.projectOk()){this.enableInsert();return true}else{this.disableInsert();return false}},startLoading:function(){this.removeError(this.container);AJS.$(".loading-blanket",this.container).removeClass("hidden");AJS.$("input,select,textarea",this.container).disable();this.disableInsert();this.handleInsertWaiting(true)},endLoading:function(){AJS.$(".loading-blanket",this.container).addClass("hidden");AJS.$("input,select,textarea",this.container).enable();if(AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE){AJS.$(".issuetype-select",this.container).disable()}this.setInsertButtonState();this.handleInsertWaiting(false)},bindEvent:function(){var b=this;var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.keyup(function(){b.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var c=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid="+c+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "Create New Issue"},init:function(b){var c=this;b.html('<div class="create-issue-container"></div>');this.container=AJS.$("div.create-issue-container");var a=this.container;var d=AJS.Editor.JiraConnector.servers;this.selectedServer=d[0];this.jipForm=new jiraIntegration.JiraCreateIssueForm({container:".create-issue-container",renderSummaryAndDescription:true,onError:function(){AJS.$(".field-group .error",this.container).remove();c.formHasError=true;c.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();c.setInsertButtonState();c.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,e){AJS.$(".field-group .error",this.container).remove();c.formHasError=!!e.length;c.setInsertButtonState()}});b.onselect=function(){c.onselect()};this.bindEvent()},convertFormToJSON:function(b){if(!jiraIntegration){AJS.logError("Jira integration plugin is missing!");return""}var c={};c.issues=[];var a={};a.fields={project:{id:AJS.$(".project-select option:selected",b).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",b).val()},summary:AJS.$('.field-group [name="summary"]',b).val(),description:AJS.$('.field-group [name="description"]',b).val()};b.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(d,e){var f=AJS.$(e);a.fields[f.attr("name")]=jiraIntegration.fields.getJSON(f)});c.issues.push(a);return JSON.stringify(c)},validateRequiredFieldInForm:function(b){var d=true;var a="placeholder" in document.createElement("input");var c=b.find(".field-group .icon-required, .field-group .aui-icon-required");c.each(function(h,l){var k=AJS.$(l).parent();var g=k.text();var i=k.nextAll("input,select,textarea");var j=AJS.$.trim(i.val());if(!j||(!a&&j==i.attr("placeholder"))){d=false;var f=k.parent();var e=AJS.format("{0} is required",g);f.append(aui.form.fieldError({message:e}))}});return d},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var b=this;var c=Confluence.getContextPath()+"/rest/jira-integration/1.0/issues";var a=AJS.$("div.create-issue-container form");var d=this.jipForm.getCurrentServer();b.clearFieldErrors();if(!b.validateRequiredFieldInForm(a)){return}this.startLoading();AJS.$.ajax({type:"POST",contentType:"application/json",url:c+"?applicationId="+this.selectedServer.id,data:this.convertFormToJSON(a),success:function(k){var h=k&&k.issues&&k.issues[0]&&k.issues[0].issue&&k.issues[0].issue.key;if(!h){if(!_.isEmpty(k.errors[0].elementErrors.errorMessages)){var i=k.errors[0].elementErrors.errorMessages;var m=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:i,serverUrl:d.displayUrl});b.errorMsg(AJS.$("div.create-issue-container"),m)}var f=k.errors[0].elementErrors.errors;_.each(f,function(o,n){var e=aui.form.fieldError({message:o});AJS.$(AJS.format(".field-group [name={0}]",n),a).after(e)})}else{try{var j=window.require("confluence/jim/jira/applinks-bridge-for-spa");var g=j.isCloudAppLinkFromUrl(d.displayUrl)||j.isCloudAppLinkFromUrl(d.rpcUrl);AJS.trigger("createGASv3Event",{type:"sendUIEvent",data:{action:"clicked",actionSubject:"button",actionSubjectId:"createNewJiraIssue",source:"jiraCreateIssueModal",attributes:{isCloudSite:g,serverId:d.id}}})}catch(l){}b.insertIssueLink(h,d.displayUrl+"/browse/"+h);b.resetIssue()}b.endLoading()},error:function(f,e){b.ajaxAuthCheck(f)}})},onselect:function(){var a=!!AJS.$(".aui-message > .oauth-init",this.container).length;if(this.selectedServer&&!this.selectedServer.authUrl&&a){this.jipForm.defaultFields.server.trigger("change")}else{this.setInsertButtonState()}},analyticPanelActionName:"confluence.jim.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "Recently Viewed"},init:function(a){var d=AJS.Editor.JiraConnector.servers;a.html('<div id="my-recent-issues" '+(d.length>1?'class="multi-server" ':"")+"></div>");var c=this;this.selectedServer=d[0];if(d.length>1){var b=AJS.$('<div class="jira-server-select"><form action="#" method="post" class="aui"><div class="field-group"><label>Server</label><select class="select" ></select></div></form></div>').appendTo("div#my-recent-issues");this.applinkServerSelect(AJS.$(".select",b),function(e){c.selectedServer=e;c.onselect()})}a.onselect=function(){c.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var c=this;var b=AJS.$("div#my-recent-issues");this.container=b;var d=function(){b.children().not(".jira-server-select").remove()};var e;var a=function(){if(c.selectedServer.authUrl){d();var f=c.createOauthForm(function(){e()});b.append(f)}else{e()}};e=function(){var i=AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("confluence_enable_new_jira_search_api")&&c.isCloudAppLink(c.selectedServer);if(c.currentXhr&&c.currentXhr.readyState!=4){return}var g=AJS.$(".select",b);g.disable();d();var h="key+in+issueHistory()+ORDER+BY+lastViewed+DESC";var f=!i?"/rest/api/latest/search?jql="+h+"&fields=summary,issuetype,status&startAt=0&maxResults=50&validateQuery=none":"/rest/api/latest/search/jql?jql="+h+"&fields=summary,issuetype,status&maxResults=50";c.createIssueTableFromUrl(b,c.selectedServer,f,c.setSelectedIssue,c.insertLink,c.disableInsert,function(){g.length&&g.focus();if(AJS.Editor&&AJS.Editor.JiraAnalytics&&AJS.Editor.JiraAnalytics){AJS.Editor.JiraAnalytics.triggerRecentlyViewedSearchEvent()}},function(j){AJS.$("div.data-table",b).remove();c.ajaxError(j,a)},false)};a()},analyticPanelActionName:"confluence.jim.recentlyviewadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent());
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-bar data-table\'><a href=\'#\' class=\'jql-display-opts-open\' data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_ignored) {
  return '<div class=\'jql-display-opts-overlay data-table\' data-js="display-option-wrapper"><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href=\'#\' class=\'jql-display-opts-open\' data-js="display-option-trigger" data-title="' + soy.$$escapeHtml('Display options panel is not available without a selection.') + '"><span></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a><fieldset class="group"><legend><span>' + soy.$$escapeHtml('Display as') + '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>' + soy.$$escapeHtml('Single issue') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display the macro as a single issue.') + '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>' + soy.$$escapeHtml('Total issue count') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Display total number of issues as a link. E.g.') + '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>' + soy.$$escapeHtml(AJS.format('{0} issues',12)) + '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>' + soy.$$escapeHtml('Table') + '</label><div class=\'description\'>' + soy.$$escapeHtml('Customise your columns below.') + '</div></div></fieldset><fieldset><div class="field-group"><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field"><label for="jira-maximum-issues">' + soy.$$escapeHtml('Maximum issues') + '</label><div class="description">' + soy.$$escapeHtml('Leave empty to get all issues.') + '</div></div></fieldset><fieldset><div class="field-group"><select id="jiraIssueColumnSelector" data-placeholder="' + soy.$$escapeHtml('Start typing to see possible columns') + '" multiple="true" class="select long-field"></select><label for="jiraIssueColumnSelector">' + soy.$$escapeHtml('Columns to display') + '</label></div></fieldset></div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml';
}


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_ignored) {
  return '<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'search-input\'><label for=\'jira-search-input\'>' + soy.$$escapeHtml('Search') + '</label><input type=\'text\' id=\'jira-search-input\' class=\'text search-text\' aria-describedby=\'jira-search-help\' name=\'jiraSearch\'></div>' : '<div class=\'search-input one-server\'><label for=\'jira-search-input\'>' + soy.$$escapeHtml('Search') + '</label><input type=\'text\' id=\'jira-search-input\' class=\'text\' aria-describedby=\'jira-search-help\' name=\'jiraSearch\'></div>') + '<button type=\'button\' title="' + soy.$$escapeHtml('Search') + '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\' id=\'jira-search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter, e.g. filter \x3d \x22My JIRA filter\x22') + '</div></form></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.searchForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.searchForm';
}


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_ignored) {
  return '<div class=\'warning-body\'><p>' + soy.$$escapeHtml('If you connect Confluence to Jira you can easily link issues...') + '</p>' + ((opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml('Your administrator can set this up.') + '</p>' : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningDialog.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningDialog';
}


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_ignored) {
  return '<input type=\'checkbox\' name=\'jira-issue\' value=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\' checked aria-labelledby=\'' + soy.$$escapeHtml(opt_data.issueKey) + '\'>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox';
}


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_ignored) {
  return '<span id="' + soy.$$escapeHtml(opt_data.issueKey) + '"><img class="icon" src="' + soy.$$escapeHtml(opt_data.issueIconUrl) + '"> ' + soy.$$escapeHtml(opt_data.issueKey) + '</span>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.issueKey.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.issueKey';
}


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_ignored) {
  return '' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>');
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer';
}


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_ignored) {
  return '<div class=\'view-all\'>' + soy.$$escapeHtml('Displaying first 20 results.') + '<a href=\'' + soy.$$escapeHtml(opt_data.jiraIssuesLink) + '\' target=\'_blank\'>' + soy.$$escapeHtml('View all.') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.viewAll.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.viewAll';
}


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_ignored) {
  return '<a href="' + soy.$$escapeHtml('https://confluence.atlassian.com/display/DOC/JIRA+Issues+Macro') + '" target=\'_blank\'>' + soy.$$escapeHtml('Learn More') + '</a>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.learnMore.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.learnMore';
}


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_ignored) {
  return '<div id="jira-chart-content-' + soy.$$escapeHtml(opt_data.chartType) + '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>' + ((opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input-container\'><label for=\'jira-chart-search-input-' + soy.$$escapeHtml(opt_data.chartType) + '\'>' + soy.$$escapeHtml('Search') + '</label><input type=\'text\' id="jira-chart-search-input-' + soy.$$escapeHtml(opt_data.chartType) + '" class=\'text search-text jira-chart-search-input\' aria-describedby=\'jira-chart-search-help-' + soy.$$escapeHtml(opt_data.chartType) + '\' name=\'jiraSearch\'></div><div class=\'jira-chart-servers-container\'><label for=\'jira-chart-servers-' + soy.$$escapeHtml(opt_data.chartType) + '\'>' + soy.$$escapeHtml('Choose server') + '</label><select id="jira-chart-servers-' + soy.$$escapeHtml(opt_data.chartType) + '" class="select jira-chart-servers" name="server" tabindex="0"></select></div>' : '<div class=\'jira-chart-search-input-container one-server\'><label for=\'jira-chart-search-input-' + soy.$$escapeHtml(opt_data.chartType) + '\'>' + soy.$$escapeHtml('Search') + '</label><input type=\'text\' id="jira-chart-search-input-' + soy.$$escapeHtml(opt_data.chartType) + '" class=\'text jira-chart-search-input\' aria-describedby=\'jira-chart-search-help-' + soy.$$escapeHtml(opt_data.chartType) + '\' name=\'jiraSearch\'></div>') + '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>' + soy.$$escapeHtml('Preview') + '</button></fieldset><div id=\'jira-chart-search-help-' + soy.$$escapeHtml(opt_data.chartType) + '\' class=\'search-help\'>' + soy.$$escapeHtml('Search using any issue key, search URL, Jira link, JQL, plain text or filter, e.g. filter \x3d \x22My JIRA filter\x22') + '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option" data-js="display-option-wrapper" ><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" data-js="display-option-trigger" href="#"><span class="display-option-icon"></span><strong>' + soy.$$escapeHtml('Display options') + '</strong></a>' + ((opt_data.chartType == 'pie') ? Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null) : (opt_data.chartType == 'createdvsresolved') ? Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null) : (opt_data.chartType == 'twodimensional') ? Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null) : '') + '</div></form></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart';
}


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="jira-chart-statType">' + soy.$$escapeHtml('Chart by') + '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.piechartForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.piechartForm';
}


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_ignored) {
  return '<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">' + soy.$$escapeHtml('Period') + '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">' + soy.$$escapeHtml('Hourly') + '</option><option value="daily">' + soy.$$escapeHtml('Daily') + '</option><option value="weekly">' + soy.$$escapeHtml('Weekly') + '</option><option value="monthly">' + soy.$$escapeHtml('Monthly') + '</option><option value="quarterly">' + soy.$$escapeHtml('Quarterly') + '</option><option value="yearly">' + soy.$$escapeHtml('Yearly') + '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">' + soy.$$escapeHtml('Days previously') + '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="' + soy.$$escapeHtml('Number of days to include (counting back from today).') + '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">' + soy.$$escapeHtml('Cumulative totals') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="' + soy.$$escapeHtml('Progressively add totals (1, 2, 3) or show individual values (1,1,1).') + '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">' + soy.$$escapeHtml('Show unresolved trend') + '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="' + soy.$$escapeHtml('Include a subplot showing unresolved issues.') + '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">' + soy.$$escapeHtml('Show versions') + '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">' + soy.$$escapeHtml('All versions') + '</option><option value="major">' + soy.$$escapeHtml('Only major versions') + '</option><option value="none">' + soy.$$escapeHtml('None') + '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="' + soy.$$escapeHtml('Mark version release dates in the chart.') + '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">' + soy.$$escapeHtml('Width') + '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="' + soy.$$escapeHtml('Enter pixels, percent or leave blank to auto-resize.') + '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">' + soy.$$escapeHtml('Show border') + '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">' + soy.$$escapeHtml('Show chart information') + '</label></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved';
}


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_ignored) {
  return '<fieldset><div id="jira-chart-support-all-version" class="hidden"></div><div class="field-group"><label for="twodimensional-xaxis">' + soy.$$escapeHtml('XAxis') + '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">' + soy.$$escapeHtml('YAxis') + '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">' + soy.$$escapeHtml('Status') + '</option><option value="priorities">' + soy.$$escapeHtml('Priority') + '</option><option value="assignees">' + soy.$$escapeHtml('Assignee') + '</option><option value="allFixfor">' + soy.$$escapeHtml('Fix For Versions (all)') + '</option><option value="components">' + soy.$$escapeHtml('Component') + '</option><option value="issuetype">' + soy.$$escapeHtml('Issue Type') + '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">' + soy.$$escapeHtml('Rows to display') + '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.twoDimensional.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.twoDimensional';
}


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message error closeable shadowed"><p class="title"><span class="aui-icon icon-error"></span><strong></strong></p><span class=\'message\'>' + soy.$$escapeHtml(opt_data.message) + '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage';
}


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + ((opt_data.isAdministrator == true) ? soy.$$escapeHtml('No server found match with your URL.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml('Click here to set this up') + '</a>' : soy.$$escapeHtml('No server found match with your URL. Your administrator can set this up.') + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml('Click here to contact your admin') + '</a>') + '<span class="aui-icon icon-warning"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.noServerWarning.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.noServerWarning';
}


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">' + soy.$$escapeHtml('More to come...') + '</a></button></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink';
}


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_ignored) {
  return '<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>' + soy.$$escapeHtml('OTHER JIRA CONTENT') + '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="' + soy.$$escapeHtml(opt_data.id) + '">' + soy.$$escapeHtml(opt_data.label) + '</button></li></ul></div></nav></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink';
}


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_ignored) {
  return '<div class="aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('The Jira server didn\x27t understand your search query. If you entered JQL, please ensure that it\x27s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it.') + '<span class="aui-icon icon-warning"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_ignored) {
  return '<div class="error width-error">' + ((opt_data.error == 'wrongFormat') ? soy.$$escapeHtml('The width must be in correct format') : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml('The width must be a number between 100 and 9000') : '') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn';
}


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_ignored) {
  return '<div id="jira-max-number-error" class="error">' + soy.$$escapeHtml('Must be a number between 1 and 1000.') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues';
}


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_ignored) {
  return '<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">' + soy.$$escapeHtml('Jira Charts are not available for your version of Jira. Upgrade to Jira 6.1.1 or later to use this macro.') + '<span class="aui-icon icon-warning"></span></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:dialogsJs-for-conf-frontend', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.ConfluenceJiraPlugin.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_ignored) {
  return '<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"></div></div><div class="field-group servers"><label>' + soy.$$escapeHtml('Server') + '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>' + soy.$$escapeHtml('Project') + '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>' + soy.$$escapeHtml('Issue Type') + '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>' + soy.$$escapeHtml('Summary') + '<span class="aui-icon icon-required"></span></label><input class="text issue-summary" type="text" name="summary"></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>' + soy.$$escapeHtml('Description') + '</label><textarea class="issue-description textarea" rows="5" name="description"></textarea></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_ignored) {
  var output = '';
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output += '<option value="' + soy.$$escapeHtml(optionData15.id) + '">' + soy.$$escapeHtml(optionData15.name) + '</option>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOptions.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOptions';
}


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_ignored) {
  return '<option value="' + soy.$$escapeHtml(opt_data.option.id) + '" data-jira-option-key="' + soy.$$escapeHtml(opt_data.option.key) + '">' + soy.$$escapeHtml(opt_data.option.name) + '</option>';
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderOption.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderOption';
}


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_ignored) {
  var output = '<div>' + soy.$$escapeHtml('There were errors creating an issue in') + '<a target="_blank" href=' + soy.$$escapeHtml(opt_data.serverUrl) + '>JIRA</a></div><ul>';
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output += '<li>' + soy.$$escapeHtml(errorData36) + '</li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel.soyTemplateName = 'Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = 'util/dialog-helper.js' */
define("confluence/jim/util/dialog-helper",["ajs","confluence-macro-browser/macro-browser"],function(a,c){var b={addSelectOtherMacroLink:function(d){var e=window.location.pathname;if(e&&(e.includes("/edit-v2")||e.includes("/edit-embed"))){return}var f="Select Macro";d.addLink(f,function(){d.hide();var g={};g.selectedMacro=null;c.open(g)},"dialog-back-link")}};return b});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=(function(j){var m=-1;var A=6109;var e=6155;var d="Insert";var q="Cancel";var x="Insert Jira Chart";var c;var g;var E=function(H){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(x);g=AJS.Editor.JiraChart.Panels;for(var G=0;G<g.length;G++){if(typeof(g[G].title)==="function"){c.addPanel(g[G].title())}else{if(g[G].title!==undefined){c.addPanel(g[G].title)}}var K=c.getCurrentPanel();g[G].init(K)}j("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"Jira Issue/Filter"}));c.addButton(d,function(){var L=g[c.getCurrentPanel().id];if(b(L.chartType)&&L.isImageChartExisted()){var M=L.getMacroParamsFromDialog();C(M);AJS.Editor.JiraChart.close()}else{y(j("#jira-chart-content-"+L.chartType))}},"insert-jira-chart-macro-button");var J=require("confluence/jim/util/dialog-helper");J.addSelectOtherMacroLink(c);c.addCancel(q,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var N=g[c.getCurrentPanel().id];var M=c.getCurrentPanel().body;var L=AJS.Editor.JiraChart.Helper.getSelectedServer(M);n(M,L);p(M);N.handleInsertButton();N.resetDisplayOption()});var I=c.getCurrentPanel().body;p(I);var F=F||function(M){var L={};_.each(M,function(N,O){L[N.chartType]=O});return L}(g);f(F,H);a();c.gotoPanel(r(F,H));c.overrideLastTab();c.show();i()};var r=function(F,G){if(G&&G.params){return F[G.params.chartType]}return 0};var s=function(){_.each(AJS.Editor.JiraChart.Panels,function(F){F.preBinding&&typeof F.preBinding==="function"&&F.preBinding()})};var i=function(){j("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();if(AJS.Editor.JiraConnector){AJS.Editor.JiraConnector.openCleanDialog(false)}})};var D=function(F){if(AJS.Editor.JiraConnector.servers.length>0){AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(F.find(".jira-chart-servers"),function(G){l(F);if(p(F)){n(F,G);B(F)}})}};var b=function(G){var F=c.getCurrentPanel().body;return F.find("#jira-chart-content-"+G).length>0};var k=function(F){F(g[c.getCurrentPanel().id])};var y=function(F){if(AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(F)===undefined){return}k(function(G){G.renderChart()})};var p=function(F){if(F.find("#jira-chart-support-all-version").length){return true}var G=AJS.Editor.JiraChart.Helper.getSelectedServer(F);if(w(G)){t(F);z(F);return false}return true};var C=function(H){var G={name:"jirachart",params:H};var F=require("confluence-macro-browser/macro-browser-facade");F.insert(G)};var f=function(F,H){for(var G=0;G<g.length;G++){g[G].resetDialogValue()}s();if(H&&H.params){var I=g[F[H.params.chartType]];I.bindingDataFromMacroToForm(H.params)}};var v=function(){if(AJS.Editor.JiraConnector.servers===undefined||AJS.Editor.JiraConnector.servers.length===0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}return true};var l=function(F){F.find(".jira-oauth-message-marker").remove();F.find(".jira-chart-img").empty();F.find(".jira-chart-search-input").empty()};var a=function(){j("#jira-chart").find(".insert-jira-chart-macro-button").disable()};var h=function(){var F=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");if(F.is(":disabled")){F.enable()}};var o=function(F){F.find("#jira-chart-search-button").disable()};var u=function(F){if(F.find("#jira-chart-search-button").is(":disabled")){F.find("#jira-chart-search-button").enable()}};var n=function(H,G){j(".jira-oauth-message-marker",H).remove();var I={selectedServer:G,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};if(G&&G.authUrl){var F=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(I,function(){j(".jira-oauth-message-marker",H).remove();AJS.Editor.JiraChart.search(H)});H.find("div.jira-chart-search").append(F)}};var t=function(F){F.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion())};var z=function(G){G.find(".jira-chart-search-input").attr("disabled","disabled");G.find("#jira-chart-search-button").attr("disabled","disabled");var F=G.find(".jirachart-display-opts-close, .jirachart-display-opts-open");if(F.hasClass("jirachart-display-opts-close")){F.click()}F.addClass("disabled");a()};var B=function(F){F.find(".jira-chart-search-input").removeAttr("disabled");F.find("#jira-chart-search-button").removeAttr("disabled");F.find(".jirachart-display-opts-open").removeClass("disabled")};var w=function(G){var F=G.buildNumber;return F==m||(F>=A&&F<e)};return{close:function(){c.hide()},edit:function(F){if(!v()){return}E(F);var H=c.getCurrentPanel().body;if(!p(H)){return}B(H);if(F.params!==undefined&&F.params.serverId!==undefined){y(H)}var G=AJS.Editor.JiraChart.Helper.getSelectedServer(H);n(H,G)},search:y,disableInsert:a,enableInsert:h,disableSearch:o,enableSearch:u,insertJiraChartMacroWithParams:C,open:E,clearChartContent:l,loadServers:D,validateServerSupportedChart:p}})(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=(function(g){var a=/^\d+$/;var m={};var f=function(o){o=(o&&typeof o==="string")?o.replace("px",""):"";if(o==="auto"){o=""}if(o.indexOf("%")>0){o=o.replace("%","")*4}return o};var n=function(o){return a.test(o)};var k=function(o){var p=AJS.Editor.JiraConnector.servers;if(p.length>1){return o.find(".jira-chart-servers option:selected").data("jiraapplink")}return p[0]};var h=function(p){var u=AJS.Editor.JiraConnector.servers;var r;var q=p.find(".jira-chart-search-input").val();if(q.indexOf("http")===0){var t=AJS.JQLHelper.findServerIndexFromUrl(q,u);if(t!==-1){r=u[t].id;p.find(".jira-chart-servers").val(r)}else{var s=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});p.find(".jira-chart-img").html(s);AJS.Editor.JiraChart.disableInsert();return}}var o=AJS.JQLHelper.convertToJQL(q,r);if(o){p.find(".jira-chart-search-input").val(o)}else{p.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid());AJS.Editor.JiraChart.disableInsert()}return o};var d=function(o,q){var s=k(o);if(q){var p=s.id;var t=m[p];if(!t){AppLinks.makeRequest({appId:s.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:false,success:function(u){if(u){m[s.id]=u;t=u}},error:function(u){if(u){m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+s.id)}}).fail(function(u){if(u){m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}})}var r="";_.each(t.stats,function(u){r+="<option value = '"+u.value+"'>"+AJS.escapeHtml(u.label)+" </option>"});q.html(r)}};var l=function(o){o.next().next(".width-error").remove();var p=f(o.val());var q;if(p){if(n(p)){if(p<100||p>9000){q="wrongNumber"}}else{q="wrongFormat"}}if(q){o.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:q}));AJS.Editor.JiraChart.disableInsert();return false}return true};var j=function(o){return{jql:o.find(".jira-chart-search-input"),width:o.find("#jira-chart-width"),border:o.find(".jira-chart-show-border"),showinfor:o.find(".jira-chart-show-infor"),displayOption:o.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:o.find(".jira-chart-servers")}};var c=function(p,o){p.jql.val(decodeURIComponent(o.jql));p.width.val(o.width);p.border.attr("checked",(o.border==="true"));p.showinfor.attr("checked",(o.showinfor==="true"));if(AJS.Editor.JiraConnector.servers.length>1){p.server.val(o.serverId)}};var b=function(q,o){var p=k(o);return{jql:encodeURIComponent(q.jql.val()),width:f(q.width.val()),border:q.border.prop("checked"),showinfor:q.showinfor.prop("checked"),serverId:p.id,server:p.name,isAuthenticated:!p.authUrl}};var i=function(p,o){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:p.jql,serverId:p.serverId,width:p.width,border:p.border,showinfor:p.showinfor,chartType:o}}}};var e=function(o){if(o){return AJS.$.trim(o.val())!==""&&o.val()!==o.attr("placeholder")}return false};return{getSelectedServer:k,bindingCommonChartElements:j,bindingCommonDataFromMacroToForm:c,getCommonMacroParamsFromDialog:b,getCommonChartParamsRequest:i,convertSearchTextToJQL:h,convertFormatWidth:f,isChartWidthValid:l,isNumber:n,isJqlNotEmpty:e,populateStatType:d}})(AJS.$);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};AJS.Editor.JiraChart.Panel.prototype={init:function(a){var b=this.chartType;var c=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:AJS.Editor.JiraConnector.servers.length>1,chartType:b});a.html(c);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var e=this;var d=function(){if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}else{AJS.Editor.JiraChart.disableInsert()}};var b=e.container.find(e.clickableElements);b.click(d);var f=e.container.find(e.onChangeElements);f.change(d);e.chartElements.jql.change(function(){if(this.value!==e.jqlWhenEnterKeyPress){e.container.find(".jira-chart-img").empty();AJS.Editor.JiraChart.disableInsert()}e.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){if(e.isFormValid()){e.jqlWhenEnterKeyPress=e.chartElements.jql.val();AJS.Editor.JiraChart.search(e.container)}},100)});var a=e.container.find("input[type='text']");var c=function(g){if(g.hasClass("jira-chart-search-input")){e.jqlWhenEnterKeyPress=g.val()}};a.unbind("keydown").keydown(function(g){if(g.which==13){var h=function(i){a.unbind("keyup",h);if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}c(a);return AJS.stopEvent(i)};a.keyup(h);return AJS.stopEvent(g)}});e.bindSelectOption();e.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){if(a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)){AJS.Editor.JiraChart.search(a.container)}else{AJS.Editor.JiraChart.disableInsert()}})},renderChart:function(){var e=this;var b=this.getChartParamsRequest();var a=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview";var d=this.container.find(".jira-chart-img");d.html('<div class="loading-data"></div>');var c=d.find(".loading-data").first();AJS.$.data(c,"spinner",Raphael.spinner(c[0],50,"#666"));if(e.request){e.request.abort()}e.request=AJS.$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(b)}).done(function(g){d.html("").hide();var j=AJS.$('<iframe frameborder="0" id="chart-preview-iframe"></iframe>');j.appendTo(d);var i=j[0].contentWindow,h=i.document;j.on("load",function(){i.AJS.$("#main").addClass("chart-preview-main");d.show();e.handleInsertButton()});g=g.replace("window.onload","var chartTest");var f=document.querySelector("script[nonce]")?'nonce="'+document.querySelector("script[nonce]").nonce+'"':null;if(f){g=g.replace(/nonce="[a-zA-Z0-9]*"/g,f)}h.open();h.write(g);h.close()}).error(function(f){if(f.statusText!="abort"){AJS.log("Jira Chart Macro - Fail to get data from macro preview");d.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"Unable to render Jira chart macro due to an execution error."}))}AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find(".jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var b=this;var a=this.chartElements.displayOption;a.addClass("jirachart-display-opts-open");a.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=b.container.find(".jira-chart-option");c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var c=this;var b=c.container.find(".jira-chart-option");var d=function(g){var f=40;var i=b.position().top+"px";var e="";var h={top:430};if(g){i="";e=f-b.find("#jiraChartMacroOption").height()+"px";h={bottom:0};b.css("overflow","auto")}else{b.css("overflow","hidden")}b.css("top",i);b.css("bottom",e);b.animate(h,500)};b.css("top","430px");var a=this.chartElements.displayOption;a.click(function(g){var f=AJS.$(this);g.preventDefault();if(f.hasClass("disabled")){return}var h=f.hasClass("jirachart-display-opts-open");if(h){d(true);f.addClass("jirachart-display-opts-close");f.removeClass("jirachart-display-opts-open")}else{d();f.removeClass("jirachart-display-opts-close");f.addClass("jirachart-display-opts-open")}})},isImageChartExisted:function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length>0},focusForm:function(){this.container.find(".jira-chart-search-input").focus()},handleInsertButton:function(){if(this.isFormValid()&&this.isResultValid()){AJS.Editor.JiraChart.enableInsert()}else{AJS.Editor.JiraChart.disableInsert()}}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var a="Pie Chart";var c="pie";var b=this;this.title=a;this.chartType=c;this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){var e=this;AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(e);e.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var f=this.getMacroParamsFromDialog();var e=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(f,this.chartType);e.macro.params.statType=f.statType;return e};this.getMacroParamsFromDialog=function(){var e=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);e.chartType=c;e.statType=this.chartElements.statType.val();return e};this.bindingDataFromMacroToForm=function(e){if(e){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,e);this.chartElements.statType.val(e.statType)}};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var d="createdvsresolved";var c=this;var a=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")};var b=function(){var h=c.chartElements.periodName.val();var g=e.trim(c.chartElements.daysprevious.val());var f=c.container.find(".days-previous-error");if(g===""){c.container.find(".days-previous-error").html("Days Previously is required field.");return false}if(!AJS.Editor.JiraChart.Helper.isNumber(g)||g<0){f.html("Days Previously must be a number and positive.");return false}switch(h){case"hourly":isValid=g<=10;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",10,h))}break;case"daily":isValid=g<=300;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",300,h))}break;case"weekly":isValid=g<=1750;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",1750,h))}break;case"monthly":isValid=g<=7500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",7500,h))}break;case"quarterly":isValid=g<=22500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",22500,h))}break;case"yearly":isValid=g<=36500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",36500,h))}break;default:isValid=false}if(isValid){f.empty()}return isValid};this.title="Created vs Resolved";this.chartType=d;this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var f=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);return b()&&f&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(f){AJS.Editor.JiraChart.Panel.prototype.init.call(this,f);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var g=this.getMacroParamsFromDialog();var f=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(g,this.chartType);f.macro.params.periodName=g.periodName;f.macro.params.daysprevious=g.daysprevious;f.macro.params.isCumulative=g.isCumulative;f.macro.params.showUnresolvedTrend=g.showUnresolvedTrend;f.macro.params.versionLabel=g.versionLabel;return f};this.getMacroParamsFromDialog=function(){var f=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);f.chartType=d;f.periodName=this.chartElements.periodName.val();f.daysprevious=e.trim(this.chartElements.daysprevious.val());f.isCumulative=this.chartElements.isCumulative.prop("checked");f.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");f.versionLabel=this.chartElements.versionLabel.val();return f};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.bindingDataFromMacroToForm=function(f){if(f){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,f);c.chartElements.isCumulative.attr("checked",(f.isCumulative!=="false"));c.chartElements.showUnresolvedTrend.attr("checked",(f.showUnresolvedTrend==="true"));c.chartElements.periodName.val(f.periodName===""?"daily":f.periodName);c.chartElements.versionLabel.val(f.versionLabel);c.chartElements.daysprevious.val(f.daysprevious===""?"30":f.daysprevious)}}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var c="twodimensional";var f=5;var b=this;var e=function(){var h=d(".twodimensional-number-of-result-error");var g=b.chartElements.numberToShow.val();if(AJS.Editor.JiraChart.Helper.isNumber(g)&&g>0){h.empty();return true}h.html("The number of rows should be a positive integer");return false};var a=function(){b.chartElements.numberToShow.val(f);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="Two Dimensional";this.chartType=c;this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var g=e();return g&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.init=function(g){AJS.Editor.JiraChart.Panel.prototype.init.call(this,g);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var h=this.getMacroParamsFromDialog();var g=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(h,this.chartType);g.macro.params.xstattype=h.xstattype;g.macro.params.ystattype=h.ystattype;g.macro.params.sortBy=h.sortBy;g.macro.params.sortDirection=h.sortDirection;g.macro.params.showTotals=h.showTotals;g.macro.params.numberToShow=h.numberToShow;return g};this.getMacroParamsFromDialog=function(){var g=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);g.chartType=c;g.xstattype=this.chartElements.xstattype.val();g.ystattype=d.trim(this.chartElements.ystattype.val());g.sortBy=d.trim(this.chartElements.sortBy.val());g.sortDirection=d.trim(this.chartElements.sortDirection.val());g.showTotals=this.chartElements.showTotals.prop("checked");g.numberToShow=this.chartElements.numberToShow.val();return g};this.bindingDataFromMacroToForm=function(g){if(g){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,g);b.chartElements.xstattype.val(g.xstattype);b.chartElements.ystattype.val(g.ystattype);b.chartElements.sortBy.val(g.sortBy);b.chartElements.sortDirection.val(g.sortDirection);b.chartElements.showTotals.attr("checked",g.showTotals==="true");b.chartElements.numberToShow.val(g.numberToShow)}};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.isImageChartExisted=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length>0};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.jira:jim-fabric-editor-support', location = 'editor-plugins/jira-paste-link.js' */
define("confluence/jim/editor-plugins/jira-paste-link",["ajs","confluence-macro-browser/macro-browser-facade"],function(b,c){var a={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,_getMatchedServerFromLink:function(e,k){var j=null;for(var g in k){if(k.hasOwnProperty(g)){var h=k[g];var d=h.url;var f=h.url[h.url.length-1];if(f!=="/"){d+="/"}if(e.indexOf(d)===0){j=h;break}}}return j},pasteHandler:function(h,i,l){var n=b.Editor.JiraConnector.servers;if(!n){l();return null}var m=b.Editor.JiraAnalytics;var g={};var o=a._getMatchedServerFromLink(h.source,n);var j=null;if(o){var e=a.jqlRegEx.exec(h.source)||a.jqlRegExAlternateFormat.exec(h.source);var d=b.JQLHelper.isFilterUrl(h.source);var k=a.issueKeyOnlyRegEx.exec(h.source)||a.issueKeyWithinRegex.exec(h.source);if(k){k=k[2];if(m){g.type=m.linkTypes.jql}}else{k=a.singleTicketXMLEx.exec(h.source);if(k){k=k[1];if(m){g.type=m.linkTypes.xml}}}if(e){g.is_single_issue=false;g.type=b.JQLHelper.checkQueryType(h.source);j={name:"jira",params:{jqlQuery:decodeURIComponent(e[1].replace(/\+/g,"%20")),server:o.name,serverId:o.id}}}else{if(d){var f=h.source;g.is_single_issue=false;g.type=b.JQLHelper.checkQueryType(f);j={name:"jira",params:{jqlQuery:b.JQLHelper.getFilterFromFilterUrl(f),server:o.name,serverId:o.id}}}else{if(k){g.is_single_issue=true;j={name:"jira",params:{key:k,server:o.name,serverId:o.id}}}}}}if(c.isInTinyMceEditor()){if(j){window.tinymce.plugins.Autoconvert.convertMacroToDom(j,l,l);if(m){m.triggerPasteEvent(g)}}else{l()}}else{return j}}};return a});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:legacy-editor-global-AVOID-IF-POSSIBLE', location = 'includes/js/amd/shim/confluence-editor-amd.js' */
define("confluence/legacy-editor-global-AVOID-IF-POSSIBLE",[],function(){"undefined"===typeof Confluence&&(Confluence={});"undefined"===typeof Confluence.Editor&&(Confluence.Editor={});return Confluence.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:event', location = 'includes/js/api/event.js' */
define("confluence/api/event",["ajs"],function(a){return{bind:function(){a.bind.apply(this,arguments)},unbind:function(){a.unbind.apply(this,arguments)},trigger:function(){a.trigger.apply(this,arguments)},stopEvent:function(){a.stopEvent.apply(this,arguments)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-for-fabric', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs jquery document window confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/analytics-support confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/get-content-id confluence/api/event confluence/dark-features".split(" "),function(d,b,i,o,e,x,k,S,c,y,h){function z(){return e.get("content-type")==="page"||e.get("content-type")==="blogpost"}function A(a){b("#editpageform").find("input[name='atl_token']").val(a);
e.set("atl-token",a);e.set("atlassian-token",a);b("#atlassian-token").attr("content",a)}function M(a){if(!z()&&a){A(a.atlToken);h.trigger("rte.heartbeat",a)}else if(!a||!a.atlToken){if(a.status==="unauthorised")if(options.movedBy){k.closeMessages(["heartbeat-error"]);k.handleMessage("heartbeat-error",{type:"error",title:"Permissions have changed",message:"You can\'t publish due to a page move or change in restrictions. You will be redirected in 10 seconds."})}else{k.closeMessages(["heartbeat-error"]);
k.handleMessage("heartbeat-error",{type:"error",title:"No access to this content",message:"This content has been moved, restricted, or deleted. You will be redirected in 10 seconds."})}h.trigger("rte.heartbeat-error","Invalid server response");d.logError("Unexpected server response for heartbeat:");d.log(a);setTimeout(function(){var a=e.get("base-url")+"/pages/viewpage.action?pageId="+e.get("content-id");o.location=a},1E4)}else{e.set("contributors-hash",a.contributorsHash);A(a.atlToken);
c.heartbeatType.normal();h.trigger("rte.heartbeat",a);b(i).trigger("resize.resizeplugin");h.trigger("editor-heartbeat",a)}}function N(a,b,f){(a.status>=500||a.status===0)&&c.heartbeatType.recovery();if(a.status===403||a.status===401)d.logError("Heartbeat error: Unauthorized");else{d.logError("Server error on heartbeat request:");d.log(f)}h.trigger("rte.heartbeat-error",a)}var m=[],l=[],n=[],B=false,p,C=function(a){c.UI.setButtonState(a,c.UI.saveButton);c.UI.setButtonState(a,c.UI.previewButton);c.UI.setButtonState(a,
c.UI.cancelButton)},r=function(a){var a=a||{},b=a.messageKey||"editor-error-message",c=a.message||"Something went wrong with the editor. Copy your unsaved changes and refresh to keep editing.";k.handleMessage(b,{title:a.title,type:"error",message:c},function(){a.disablePublish&&C(false)})},D=function(){h.trigger("analytics",{name:"confluence.editor.update",data:{contentId:e.get("content-id"),notifiedWatchers:b("#notifyWatchers").is(":checked"),addedVersionComment:b("#versionComment").val()!=null&&b("#versionComment").val().length>0,contentType:e.get("content-type"),
isTitleChanged:e.get("latest-published-page-title")!==b("#content-title").val(),spaceKey:e.get("space-key"),isNeverPublished:e.get("page-id")==="0"}})},P=function(a){var b=true;k.closeMessages(["offline-before-save-error"]);for(var c=0;c<l.length;c++){l[c](a)===false&&(b=false);if(a.isImmediatePropagationStopped())break}if(!b||a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();E(a).done(function(a){a=F(a);if(a==null){d.warn("Expected deferred object not returned by save handler");
D()}else a.done(D)}).fail(O)},O=function(a){var b=a||{};r({messageKey:b.messageKey||"offline-before-save-error",message:b.disablePublish?"Something went wrong with the editor. Copy your unsaved changes and refresh to keep editing.":"Unable to communicate with server. Saving is not possible at the moment.",disablePublish:b.disablePublish});a&&h.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause});c.UI.toggleSavebarBusy(false);c.Drafts.bindUnloadMessage()},E=function(a){var j=b.Deferred();j.resolve(a);return j.promise()},F=function(){b(c.getCurrentForm()).submit()};
h.bind("rte-ready",function(){c.UI.saveButton.bind("click",P)});h.bind("editor.error.message",function(a,b){r(b)});h.bind("dismiss.editor.error.message",function(a,b){k.closeMessages([b.messageKey]);b.enablePublish&&C(true)});var Q=function(){var a;for(a=0;a<m.length;a++)c.UI.cancelButton.click(m[a]);var j=b(c.getCurrentForm());for(a=0;a<n.length;a++)j.submit(n[a]);b.unbind("init.rte",this)},G=function(a,c,f,e){e.push(f);if(d.Rte&&d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())a.bind(c,
f);else if(!B){B=true;b.bind("init.rte",Q)}},t=function(a,b,c){var e=null;d.Rte&&(d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())&&(e=function(a,b,c){a.unbind(b,c)});for(var i=c.pop();i;){e&&e(a,b,i);i=c.pop()}},H=function(a){if(g!==a){g&&g.clear();a.start(c.heartbeat);g=a}},g,I=e.getNumber("heartbeat-interval")||6E4,u,J;u={start:function(a){d.debug("Changing heartbeat to the normal scheduler");J=setInterval(a,I)},clear:function(){clearInterval(J)}};var K,L=Math.max(I/5,5E3),v,w;
K={start:function(a){d.debug("Changing heartbeat to the recovery scheduler");w=0;var b=function(){a();var c=L*Math.pow(2,w);v=setTimeout(b,Math.min(c,3E5));w++};v=setTimeout(b,L)},clear:function(){clearTimeout(v)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_SOURCE:"source",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isSubmitting:false,isCancelling:false,overrideBeforeSave:function(a){E=a},overrideSave:function(a){F=
a},addCancelHandler:function(a){G(c.UI.cancelButton,"click",a,m)},addSaveHandler:function(a){l.push(a)},addSubmitHandler:function(a){G(b(c.getCurrentForm()),"submit",a,n)},removeAllCancelHandlers:function(){t(c.UI.cancelButton,"click",m)},removeAllSaveHandlers:function(){t(c.UI.saveButton,"click",l)},removeAllSubmitHandlers:function(){t(b(c.getCurrentForm()),"submit",n)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?false:this.editorHasContentChanged()},
editorHasContentChanged:function(){if(d.Rte.getEditor()==null){d.debug("Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return d.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(d.Rte.getEditor().getContent()).text();return!b.trim(a)},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){b(".editable-title #content-title").prop("disabled",true);return true},metadataSyncRequired:z,
heartbeat:function(a){var a=a||{},c={dataType:"json",contentId:e.get("content-id"),draftType:e.get("content-type"),collabService:"synchrony",editorVersion:"v1"};p=b.ajax({url:x.CONTEXT_PATH+"/api/v2/editor/heartbeat/start",type:"POST",data:JSON.stringify(c),dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},async:a.synchronousHeartbeat!==true}).done(M.bind(this)).fail(N.bind(this))},heartbeatType:{normal:function(){H(u)},recovery:function(){H(K)},reset:function(){g&&
g.clear();g=u;g.start(c.heartbeat)},cleanup:function(){if(g){g.clear();g=null}p&&p.abort&&p.abort()}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){b(this).attr("target","_top").unbind()});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,j){var f=require("tinymce");c.setMode(c.MODE_PREVIEW);f.activeEditor.setProgressState(false);c.disableFrame(a);var q=b("#main",a)[0];if(e.get("content-type")!==
"comment"&&b(q).find("#main-header").length===0){var h=b("#title-heading"),g=h.attr("class");b(q).prepend('<div id="preview-header"><div id="title-heading" class="'+g+'">'+h.html()+"</div></div>")}if(b(d.Rte.getEditor().getBody()).hasClass("resizable")){var s=b(j||"#previewArea iframe"),k=0,m=0,l,n=s.height();q&&function R(){var a=b(q).outerHeight(true);if(k!==a){a!==s.height()&&s.height(0).height(Math.max(a,n));k=a;m=0}else m++;m<500&&(l=setTimeout(R,500))}();b(i).one("mode-changed.resize-editor",
function(a,b){b!==c.MODE_PREVIEW&&l&&clearTimeout(l)})}else if(f.isIE||f.isOpera){f=b(o).height();h=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();g=b("#savebar-container").height();b("#preview iframe").height(f-h-g-4);b("#content.edit").height("auto")}},showRichText:function(a){var j=require("tinymce");d.setVisible("#wysiwyg",a);b(".toolbar-group-edit").toggleClass("assistive",a);b(".toolbar-group-preview").toggleClass("assistive",!a);b("#main").toggleClass("active-richtext",
a);j.isGecko&&a&&d.Rte.fixEditorFocus(c.bookmark)},showPreview:function(a){if(e.get("content-type")!=="comment"){var c=b("#content-title");if(c.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(c.val());b("#title-text").text(c.val())}}d.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main, .editor-container").toggleClass("active-preview",a);
e.get("content-type")!=="comment"&&b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},showSource:function(a){a?this.showSourceArea():this.hideSourceArea();b("#main")[a?"addClass":"removeClass"]("active-source")},setMode:function(a){d.debug("Set mode: "+a);if(a===c.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false);this.showSource(false)}else if(a===c.MODE_SOURCE){this.showSource(true);this.showRichText(false);this.showPreview(false)}else if(a===
c.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);this.showSource(false);c.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");a.height(0);a.height();a.height("auto");a.height("")},1);this.currentEditMode=a;b(i).trigger("mode-changed",[a])},getContentId:function(){return y()},addErrorMessage:function(a,c,f){var e=b("#"+a),f=f?"#all-messages":"#editor-messages";e.length?e.empty():e=b("<div></div>").attr("id",a).appendTo(f);d.messages.error(e,
{closeable:true,body:c})},changeMode:function(a,j){var f=require("tinymce");d.debug("Change mode: "+a);j=j||{};if(this.inRichTextMode()&&!d.Rte.BootstrapManager.isInitComplete()||this.currentEditMode===a)return false;var g=this.currentEditMode;h.trigger("rte-changeMode",a);if(a===c.MODE_PREVIEW){var m=d.Rte.getEditor();g===c.MODE_SOURCE&&c.transferSourceToEditor();if(f.isGecko&&g===c.MODE_RICHTEXT&&!c.bookmark)c.bookmark=f.activeEditor.selection.getBookmark();this.currentEditMode=a;f=function(a){typeof a!==
"object"&&(a={draftId:y()});a={contentId:a.draftId,contentType:e.get("content-type"),spaceKey:e.get("space-key"),XHTML:m.getContent(),outputType:c.PREVIEW_OUTPUT_TYPE};d.safe.ajax({type:"POST",url:x.CONTEXT_PATH+"/pages/rendercontent.action",data:a,success:c.replysetPreviewArea,timeout:2E4,error:function(){h.trigger("rte.preview.error",{status:0});k.closeMessages(["server-offline"]);r({messageKey:"server-offline",message:"Can\'t reach the server. Check you\'re connected to the internet and Confluence is up and running.",disablePublish:false});c.currentEditMode=
g;j.errorCallback&&j.errorCallback()}})};e.get("content-type")==="comment"?f():c.Drafts.save({forceSave:true,onSuccessHandler:f,onErrorHandler:f})}else this.setMode(a);a===c.MODE_RICHTEXT&&b(i).trigger("resize.resizeplugin");if(g===c.MODE_PREVIEW)if(f=i.getElementById("editor-preview-iframe")){var l=f.contentDocument||f.contentWindow.document;l.removeChild(l.documentElement);b(f).remove()}return false},replysetPreviewArea:function(a){var c=require("tinymce");b("#preview-error").remove();c.activeEditor.setProgressState(true);
var d=b("#previewArea"),c=b('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');d.html(c);(d=(d=i.querySelector("script[nonce]"))&&d.nonce)&&(a=a.replace(/nonce="[a-zA-Z0-9]{32}"/gi,'nonce="'+d+'"'));c=c[0].contentDocument||c[0].contentWindow.document;c.open();c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode===c.MODE_RICHTEXT},isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){var a=
require("tinymce");c.setMode(c.MODE_RICHTEXT);a.activeEditor.onClick.add(function(){var a=c.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return require("tinymce").activeEditor.formElement},transferSourceToEditor:function(){var a=c;if(a.sourceInitialValue){var b=a.getSourceAreaVal();if(b!==a.sourceInitialValue){var d=require("tinymce").activeEditor;d.setContent(b);d.setDirty(b)}}a.sourceInitialValue=false},hideSourceArea:function(){b("#editor-html-source-container").addClass("hidden");
this.setToolBarInactive(false);this.transferSourceToEditor();b("#rte-button-source-mode").removeClass("active");b("#rte-button-publish").unbind("click.source-save")},showSourceArea:function(){var a=require("tinymce");b("#editor-html-source-container").removeClass("hidden");this.setSourceAreaHeight();this.setToolBarInactive(true);this.sourceInitialValue=a.activeEditor.getContent();this.setSourceAreaVal(this.sourceInitialValue);b("#rte-button-source-mode").addClass("active");b("#rte-button-publish").bind("click.source-save",
c.transferSourceToEditor)},getSourceAreaVal:function(){return b("#editor-html-source").val()},setSourceAreaVal:function(a){b("#editor-html-source").val(a)},setSourceAreaHeight:function(){var a=d.Rte.getTinyMceEditorMinHeight();d.debug("HTML source height= "+a);var c=b("#editor-html-source")[0].scrollHeight;if(c>a){a=c;d.debug("ACTUAL HEIGHT "+c)}b("#editor-html-source-container").height(a+"px")},setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>
0||b("#editor-html-source-container:visible").length>0||b("#preview:visible").length>0}}});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(d){var b=require("jquery"),i=require("ajs"),o=require("confluence/api/event");i.Editor=i.Editor||{};Confluence.Editor=b.extend(Confluence.Editor||{},i.Editor,d);i.toInit(function(){o.bind("init.rte",Confluence.Editor.onInit)});i.Editor=Confluence.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function ($, _) {
    var RM = Confluence.Roadmap = Confluence.Roadmap || {};

    RM.Helper = {
        getPosXOnMonthTimeline: function (timeline, date) {
            var mStartDateTimeline = moment(timeline.startDate).startOf('month');
            var mDateToBeginRender = moment(date).startOf('month');

            var months = RM.DateUtilities.getNumberOfMonths(mStartDateTimeline, mDateToBeginRender);
            var posX = months * Roadmap.MONTH_WIDTH; // posX base on month period
            var pixelFromStartMonth = RM.DateUtilities.getMilisecondsFromStartMonth(date) * Roadmap.MONTH_WIDTH / RM.DateUtilities.getMilisecondsInMonth(date);
            return Math.round(posX + pixelFromStartMonth);
        },

        /**
         * Get CSS left position for a bar by start date of timeline and start date of the bar.
         *
         * @param {Object} timeline
         * @param {Date} timeline.startDate - start date of timeline
         * @param {Date} timeline.endDate - end date of timeline
         * @param {string} timeline.displayOption - WEEK or MONTH
         *
         * @param {Array} timeline.displayTimelineColumns
         * @param {Date} startDate - start date object of a bar
         * @returns {number} CSS left position, is negative number if timeline start day is after given bar start day.
         */
        getPosXOnWeekTimeline: function (timeline, startDate) {
            var mStartDateTimelineStartFromMonday = moment(timeline.startDate).startOf('isoWeek');
            var weeks = moment(startDate).diff(mStartDateTimelineStartFromMonday, 'weeks', true);
            var posX = weeks * Roadmap.WEEK_WIDTH;
            return Math.round(posX);
        },

        getWidthTimeline: function (timeline, bar) {
            var barWidth = bar.duration;
            if (timeline.displayOption === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH) {
                barWidth *= Roadmap.MONTH_WIDTH;
            } else {
                barWidth *= Roadmap.WEEK_WIDTH;
            }

            return barWidth < Roadmap.EXTRA_SPACE_AROUND
                ? 0
                : Math.round(barWidth - Roadmap.EXTRA_SPACE_AROUND);
        },

        getMonthStartDateByPosition: function (timeline, positionX) {
            var months = Math.floor(positionX / Roadmap.MONTH_WIDTH);
            var mTimelineStartDate = moment(timeline.startDate).startOf('month');
            var date = mTimelineStartDate.add(months, 'months').toDate(); //add month

            var daysWidth = Math.abs(positionX) % Roadmap.MONTH_WIDTH;
            if (daysWidth !== 0 && months < 0) {
                daysWidth = Roadmap.MONTH_WIDTH - daysWidth;
            }

            var numberOfMilisecondFromMonth = RM.DateUtilities.getMilisecondsInMonth(date) * daysWidth / Roadmap.MONTH_WIDTH;
            return new Date(date.getTime() + numberOfMilisecondFromMonth);
        },

        getWeekStartDateByPosition: function (timeline, positionX) {
            var mStartDateTimeline = moment(timeline.startDate).startOf('isoWeek');

            var numberOfWeeks = positionX / Roadmap.WEEK_WIDTH;
            var milliSeconds = numberOfWeeks * RM.DateUtilities.MILLISECONDS_A_WEEK;

            return new Date(mStartDateTimeline.valueOf() + milliSeconds);
        },

        guid: function () {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }
    };

    RM.ColorHelper = {
        resetColorCounts: function () {
            _.each(Roadmap.COLORS, function (color) {
                color.count = 0;
            });
        },

        findColor: function (color) {
            return _.find(Roadmap.COLORS, function (roadmapColor) {
                return roadmapColor.lane === color.lane;
            });
        },

        adjustColorCount: function (color, adjustAmount) {
            var roadmapColor = RM.ColorHelper.findColor(color);
            if (roadmapColor) {
                roadmapColor.count = roadmapColor.count + adjustAmount;
            }
        },

        getColor: function () {
            return _.min(Roadmap.COLORS, function (color) {
                return color.count;
            });
        }
    };
}(AJS.$, window._));

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function ($, _) {
    var RM = Confluence.Roadmap = Confluence.Roadmap || {};

    RM.DateUtilities = {
        //1000 * 60 * 60 * 24
        MILLISECONDS_A_DAY: 86400000,

        //1000 * 60 * 60 * 24 * 7
        MILLISECONDS_A_WEEK: 604800000,

        /**
         * Try to parse a string to a date. If can not parse, return null.
         * @param strDate
         * @return {Moment}
         */
        parseDate: function (strDate) {
            var date = moment(strDate, Roadmap.SHORT_DATE_FORMAT, true);
            if (date.isValid()) {
                return date;
            }

            date = moment(strDate, Roadmap.TWO_YY_SHORT_DATE_FORMAT, true);

            return date.isValid() ? date : null;
        },

        /**
         * Get date string from date
         *
         * @param {date} date value
         */
        getDateStringFromDate: function (date, dateFormat) {
            if (dateFormat) {
                return moment(date).format(dateFormat);
            }

            return moment(date).format(Roadmap.DATE_FORMAT);
        },

        /**
         * Get date from date string
         *
         * @param {dateString} date string with Roadmap date format
         * @return -1 if date string is not a date;
         */
        getDateFromDateString: function (dateString, dateFormat) {
            return moment(dateString, dateFormat || Roadmap.DATE_FORMAT).toDate();
        },

        /**
         * Get number of months within a period
         *
         * @param {startDate}
         * @param {endDate}
         * @return number of months within the period
         */
        getNumberOfMonths: function (startTime, endTime) {
            var mStartDate = moment(startTime),
                mEndDate = moment(endTime);

            return mEndDate.diff(mStartDate, 'months');
        },

        getMilisecondsInMonth: function (date) {
            return moment(date).daysInMonth() * RM.DateUtilities.MILLISECONDS_A_DAY;
        },

        getMilisecondsFromStartMonth: function (date) {
            return date.getTime() - moment(date).startOf('month').valueOf();
        },

        /**
         * calculate duration information of a moment date
         *
         * @param {Moment} mDate - moment date
         * @returns {Object} duration information object:
         *                      totalMillisOfMonth: total milliseconds of month get from date.
         *                      millisFromStartMonth: milliseconds from the month's beginning date to date.
         *                      millisRemainingOfMonth: milliseconds from date to the month's ending date.
         *                      durationOfMonth: month's duration from the month's beginning date to date.
         *                      remainingDurationOfMonth: month's duration from date to the month's ending date.
         */
        calculateDurationInformation: function (mDate) {
            var totalMillisOfMonth = RM.DateUtilities.getMilisecondsInMonth(mDate.toDate());
            var millisFromStartMonth = RM.DateUtilities.getMilisecondsFromStartMonth(mDate.toDate());
            var millisRemainingOfMonth = totalMillisOfMonth - millisFromStartMonth;

            return {
                totalMillisOfMonth: totalMillisOfMonth,
                millisFromStartMonth: millisFromStartMonth,
                millisRemainingOfMonth: millisRemainingOfMonth,
                durationOfMonth: millisFromStartMonth / totalMillisOfMonth,
                remainingDurationOfMonth: millisRemainingOfMonth / totalMillisOfMonth
            };
        },

        /**
         * Get week duration by a start date and month duration.
         *
         * @param {Date} startDate - start date native JS object.
         * @param {number} monthDuration - can be a floated number.
         * @returns {number} week duration, can be floated number with 2 decimal digits.
         */
        convertToWeekDuration: function (startDate, monthDuration) {
            var mStartDate = moment(startDate);
            var mEndDate = mStartDate.clone();

            var startDateDurationInformation = RM.DateUtilities.calculateDurationInformation(mStartDate);

            if (monthDuration <= startDateDurationInformation.remainingDurationOfMonth) {
                var millisDuration = monthDuration * startDateDurationInformation.totalMillisOfMonth;
                mEndDate = mEndDate.add(millisDuration, 'ms');
            } else {
                mEndDate = mEndDate.add(startDateDurationInformation.millisRemainingOfMonth, 'ms');
                monthDuration = monthDuration - startDateDurationInformation.remainingDurationOfMonth;
                var monthCount = Math.floor(monthDuration);
                if (monthCount > 0) {
                    mEndDate = mEndDate.add(monthCount, 'months');
                }

                var remainingDuration = monthDuration % 1;
                var totalMillisOfEndMonth = RM.DateUtilities.getMilisecondsInMonth(mEndDate.toDate());
                var remainingMillis = remainingDuration * totalMillisOfEndMonth;
                mEndDate.add(remainingMillis, 'ms');
            }

            return mEndDate.diff(mStartDate, 'weeks', true);
        },

        /**
         * Get month duration by a start date and week duration.
         *
         * @param {Date} startDate - start date native JS object
         * @param {number} weekDuration
         * @returns {number} month duration, can be floated number with 2 decimal digits.
         */
        convertToMonthDuration: function (startDate, weekDuration) {
            var mStartDate = moment(startDate);

            var millisDuration = weekDuration * RM.DateUtilities.MILLISECONDS_A_WEEK;
            var mEndDate = mStartDate.clone().add(millisDuration, 'ms');

            var monthCount = mEndDate.get('year') * 12 + mEndDate.get('month');
            monthCount = monthCount - (mStartDate.get('year') * 12 + mStartDate.get('month'));

            var startDateDurationInformation = RM.DateUtilities.calculateDurationInformation(mStartDate);

            if (monthCount === 0) {
                return millisDuration / startDateDurationInformation.totalMillisOfMonth;
            } else {
                var monthDuration = startDateDurationInformation.remainingDurationOfMonth;

                var endDateDurationInformation = RM.DateUtilities.calculateDurationInformation(mEndDate);
                monthDuration = monthDuration + endDateDurationInformation.durationOfMonth;

                monthDuration = monthDuration + (monthCount - 1);
                return monthDuration;
            }
        }
    };

    RM.FieldUtilities = {
        /**
         * Fix some issues for AUI date picker
         *
         * @param {$container} find date pickers in container
         */
        fixDatePickerFields: function ($container) {
            // fix some issues relate to AUI datepicker by apply datepicker-patch.css
            // fix datepicker doesn't fire change when AUI versions which < 5.4.5
            var $datepickers = $container.find('input[data-aui-dp-uuid]');
            $datepickers.each(function (index, element) {
                var $dp = $(element),
                    uuid = $dp.attr('data-aui-dp-uuid');
                $dp.on('click focus', function () {
                    var $dpPopup = $('[data-aui-dp-popup-uuid=' + uuid + ']');
                    if (AJS.version <= '5.4.5') {
                        var defaultOnSelectHandler = $dpPopup.datepicker('option', 'onSelect');
                        $dpPopup.datepicker('option', 'onSelect', function (dateText, inst) {
                            defaultOnSelectHandler(dateText, inst);
                            $dp.change();
                        });
                    }
                    $dpPopup.parents('.aui-inline-dialog').addClass('datepicker-roadmap-patch');
                });
            });
        }
    };
}(AJS.$, window._));

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function () {
    window.Roadmap = window.Roadmap || {};
    Roadmap.Bar = Backbone.Model.extend({
        defaults: function () {
            return {
                id: Confluence.Roadmap.Helper.guid(),
                title: "New Bar",
                description: '',
                startDate: new Date(),
                duration: 1,
                rowIndex: 0,
                pageLink: {}
            };
        }
    });

    Roadmap.Lane = Backbone.Model.extend({
        defaults: function () {
            return {
                title: "New Lane",
                color: Confluence.Roadmap.ColorHelper.getColor(),
                bars: []
            };
        },
        initialize: function () {
            var bars = new Roadmap.Bars(this.get('bars'));
            this.set('bars', bars);
        },
        getNumberOfRows: function () {
            var bars = this.get('bars');

            if (bars.length === 0) { // in case lane is empty
                return 0;
            }

            var totalRows = 0;
            bars.each(function (bar) {
                totalRows = Math.max(bar.get('rowIndex'), totalRows);
            });
            return totalRows + 1;
        }
    });

    Roadmap.Marker = Backbone.Model.extend({
        defaults: function () {
            return {
                title: "Marker"
            };
        }
    });

    Roadmap.Timeline = Backbone.Model.extend({
        defaults: function () {
            return {
                displayOption: Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
            };
        },

        validate: function (attrs) {
            var errors = [];

            var mStartDate = Confluence.Roadmap.DateUtilities.parseDate(attrs.startDateString);
            var mEndDate = Confluence.Roadmap.DateUtilities.parseDate(attrs.endDateString);

            if (!mStartDate || !mEndDate) {
                errors.push({name: 'date', message: "Enter dates in yy-mm-dd"});
            } else if (mStartDate.diff(mEndDate) >= 0) {
                // Start Date and End Date are valid, validate Start Date < End Date
                errors.push({name: 'endDate', message: "Start date needs to be before the end date"});
            } else if (mEndDate.diff(mStartDate, 'years', true) > Roadmap.TIMELINE_YEARS_LIMIT) {
                errors.push({
                    name: 'endDate',
                    message: AJS.format("You cannot plan more than {0} years ahead.", Roadmap.TIMELINE_YEARS_LIMIT)
                });
            }

            return errors.length > 0 ? errors : false;
        },

        calculateTimelineColumns: function () {
            var startDate = this.get('startDate');
            var endDate = this.get('endDate');
            var displayTimelineColumns = [];
            var mDate;

            if (this.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH) {
                mDate = moment(startDate).clone().startOf('month');
                var endDateMonth = moment(endDate).clone().endOf('month');

                do {
                    displayTimelineColumns.push({
                        month: Confluence.Roadmap.DateUtilities.getDateStringFromDate(mDate, Roadmap.MONTH_FORMAT),
                        year: mDate.get('year')
                    });
                    mDate.add(1, 'months');
                } while (mDate.diff(endDateMonth) < 0);

            } else {
                mDate = moment(startDate).clone().startOf('isoWeek');
                var endDateWeek = moment(endDate).clone().endOf('isoWeek');

                do {
                    displayTimelineColumns.push({
                        month: Confluence.Roadmap.DateUtilities.getDateStringFromDate(mDate, Roadmap.WEEK_FORMAT),
                        year: mDate.get('year')
                    });
                    mDate.add(1, 'weeks');
                } while (mDate.diff(endDateWeek) < 0);
            }

            // avoid using 'set' method to avoid triggering 'change` event on timeline module.
            this.attributes.displayTimelineColumns = displayTimelineColumns;
        }
    });

    Roadmap.Roadmap = Backbone.Model.extend({
        defaults: function () {
            return {
                title: "Roadmap Planner",
                lanes: [],
                markers: []
            };
        },
        initialize: function () {
            var lanes = new Roadmap.Lanes(this.get('lanes'));
            this.set('lanes', lanes);

            var markers = new Roadmap.Markers(this.get('markers'));
            this.set('markers', markers);

            var timeline = new Roadmap.Timeline(this.get('timeline'));
            this.set('timeline', timeline);
        },

        parse: function (roadmapData) {
            if (!roadmapData.timeline) {
                return Roadmap.getDefaultRoadmapData();
            }
            return this.fromMacroData(roadmapData);
        },

        /**
         * convert roadmap macro json from server to model
         *
         * @param {roadmap} date string with Roadmap date format
         * @return roadmap data for model
         */
        fromMacroData: function (roadmap) {
            var timeline = roadmap.timeline;
            timeline.startDate = Confluence.Roadmap.DateUtilities.getDateFromDateString(timeline.startDate);
            timeline.endDate = Confluence.Roadmap.DateUtilities.getDateFromDateString(timeline.endDate);

            var lanes = roadmap.lanes;
            _.each(lanes, function (lane) {
                var bars = lane.bars;
                _.each(bars, function (bar) {
                    bar.startDate = Confluence.Roadmap.DateUtilities.getDateFromDateString(bar.startDate);
                    if (!bar.id) {
                        bar.id = Confluence.Roadmap.Helper.guid();
                    }
                });
                lane.bars = bars;
            });
            roadmap.lanes = lanes;

            var markers = roadmap.markers;
            _.each(markers, function (marker) {
                marker.markerDate = Confluence.Roadmap.DateUtilities.getDateFromDateString(marker.markerDate);
            });
            roadmap.markers = markers;

            return roadmap;
        },

        /**
         * convert backbone model to macro data
         *
         * @return roadmap macro data
         */
        toMacroData: function () {
            var roadmap = this.toJSON();
            var timeline = roadmap.timeline.toJSON();
            timeline.startDate = Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.startDate);
            timeline.endDate = Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.endDate);
            delete timeline.displayTimelineColumns;
            roadmap.timeline = timeline;

            var lanes = roadmap.lanes.toJSON();
            _.each(lanes, function (lane) {
                var bars = lane.bars.toJSON();
                _.each(bars, function (bar) {
                    bar.startDate = Confluence.Roadmap.DateUtilities.getDateStringFromDate(bar.startDate);
                });
                lane.bars = bars;
            });
            roadmap.lanes = lanes;

            var markers = roadmap.markers.toJSON();
            _.each(markers, function (marker) {
                marker.markerDate = Confluence.Roadmap.DateUtilities.getDateStringFromDate(marker.markerDate);
            });
            roadmap.markers = markers;

            return roadmap;
        },

        updateDurationUnit: function (displayOption) {
            this.get('lanes').each(function (laneModel) {
                laneModel.get('bars').each(function (bar) {
                    var duration;
                    duration = displayOption === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                        ? Confluence.Roadmap.DateUtilities.convertToMonthDuration(bar.get('startDate'), bar.get('duration'))
                        : Confluence.Roadmap.DateUtilities.convertToWeekDuration(bar.get('startDate'), bar.get('duration'));

                    bar.attributes.duration = duration;
                });
            });
        }
    });
})();

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function () {
    window.Roadmap = window.Roadmap || {};
    Roadmap.Bars = Backbone.Collection.extend({
        model: Roadmap.Bar
    });

    Roadmap.Lanes = Backbone.Collection.extend({
        model: Roadmap.Lane
    });

    Roadmap.Markers = Backbone.Collection.extend({
        model: Roadmap.Marker
    });
})();

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">' + aui.buttons.buttons({content: '' + aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml('Add lane'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml('Add bar'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}) + aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml('Add marker'), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'})}) + '</div><div class="aui-toolbar2-secondary">' + Confluence.Templates.Roadmap.timelineOptionsForm(null) + '</div></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.toolbar.soyTemplateName = 'Confluence.Templates.Roadmap.toolbar';
}


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_ignored) {
  return '' + aui.form.form({id: 'timeline-options-form', action: '#', content: '<fieldset>' + aui.form.selectField({id: 'timeline-display-options-select', labelContent: '' + soy.$$escapeHtml('View by'), options: [{text: 'Months', value: 'MONTH'}, {text: 'Weeks', value: 'WEEK'}], extraClasses: 'view-by'}) + aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}) + ' - ' + aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}) + '<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error"></div></div></fieldset>'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineOptionsForm.soyTemplateName = 'Confluence.Templates.Roadmap.timelineOptionsForm';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};
    Roadmap.ToolbarView = Backbone.View.extend({
        className: 'roadmap-toolbar',
        events: {
            'click #toolbar-button-add-bar': 'onAddBarClick',
            'click #toolbar-button-add-lane': 'onAddLaneClick',
            'click #toolbar-button-add-marker': 'onAddMarkerClick',
            'change #timeline-display-options-select': 'onTimelineOptionChange'
        },
        initialize: function () {
            _.bindAll(this, 'render');
        },

        render: function () {
            // This demonstrate you how to use SOY template in View
            $(this.$el).html(Confluence.Templates.Roadmap.toolbar());
            this._initVariables();
            this._setupTimelineOptionsForm();
            return this;
        },

        /**
         * Add new Bar to the first Lane
         */
        onAddBarClick: function (e) {
            e.preventDefault();

            var firstLane = this.model.get('lanes').at(0); // by default, use first lane
            var bars = firstLane.get('bars');

            var timeline = this.model.get('timeline');
            var startDateTimelineActual = this.model.get('timeline').get('startDate');
            var mStartDateTimelineBeginWeekOrMonth = timeline.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                ? moment(startDateTimelineActual).startOf('month')
                : moment(startDateTimelineActual).startOf('isoWeek');

            bars.add(new Roadmap.Bar({
                rowIndex: firstLane.getNumberOfRows(),
                startDate: mStartDateTimelineBeginWeekOrMonth.toDate()
            }));
        },

        /**
         * Append new Lane
         */
        onAddLaneClick: function (e) {
            e.preventDefault();

            var lanes = this.model.get('lanes'); // Draft code, need more validate here
            lanes.add(new Roadmap.Lane());
            // focus off of the add lane button because if not, focus is trapped on
            // the modal buttons when trying to rename the lane immediately after adding
            e.target.blur();
        },

        onAddMarkerClick: function (e) {
            var markers = this.model.get('markers');
            var timeline = this.model.get('timeline');
            var mStartDateTimeline = moment(timeline.get('startDate'));
            var mStartDateToRender = timeline.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                ? mStartDateTimeline.date(15)
                : mStartDateTimeline.isoWeekday(4);

            markers.add(new Roadmap.Marker({
                markerDate: mStartDateToRender.toDate()
            }));
        },

        onTimelineOptionChange: function (e) {
            var timeline = this.model.get('timeline');
            timeline.set({displayOption: this.$timelineSelect.val()});
        },

        _initVariables: function () {
            this.$timelineForm = this.$el.find('#timeline-options-form');
            this.$startDateInput = this.$timelineForm.find('#timeline-startdate-input');
            this.$endDateInput = this.$timelineForm.find('#timeline-enddate-input');
            this.$timelineSelect = this.$timelineForm.find('#timeline-display-options-select');
            this.$timelineError = this.$timelineForm.find('#roadmap-timeline-error');
            this.newTimeline = new Roadmap.Timeline();
        },

        _clearTimelineErrors: function () {
            this.$timelineError.empty();
        },

        _showTimelineErrors: function () {
            var me = this;
            _.each(me.newTimeline.validationError, function (error) {
                me.$timelineError.append(error.message);
            });
        },

        _applyNewTimeline: function () {
            var timeline = this.model.get('timeline');
            var mStartDate = Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val());
            var mEndDate = Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());

            timeline.set({
                startDate: mStartDate.toDate(),
                endDate: mEndDate.toDate()
            });
            this._showTimeLineFormat();
        },

        _showTimeLineFormat: function () {
            var timeline = this.model.get('timeline');
            this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.get('startDate'), Roadmap.SHORT_DATE_FORMAT));
            this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.get('endDate'), Roadmap.SHORT_DATE_FORMAT));
        },

        _validate: function () {
            this._clearTimelineErrors();
            if (this.newTimeline.isValid()) {
                this._applyNewTimeline();
            } else {
                this._showTimelineErrors();
            }
        },

        _setupTimelineOptionsForm: function () {
            var timeline = this.model.get('timeline');

            var startDateString = Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.get('startDate'), Roadmap.SHORT_DATE_FORMAT),
                endDateString = Confluence.Roadmap.DateUtilities.getDateStringFromDate(timeline.get('endDate'), Roadmap.SHORT_DATE_FORMAT);

            this.$startDateInput.val(startDateString);
            this.$endDateInput.val(endDateString);
            this.newTimeline.set({startDateString: startDateString, endDateString: endDateString});
            this.$timelineSelect.val(timeline.get('displayOption'));

            //  Add AUI date picker for date fields
            var opsDatePicker = {
                overrideBrowserDefault: true,
                firstDay: 1 // Monday is first day of week.
            };
            this.$startDateInput.datePicker(opsDatePicker);
            this.$endDateInput.datePicker(opsDatePicker);

            Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);

            var me = this;
            this.$startDateInput.on('change', function () {
                me.newTimeline.set({startDateString: me.$startDateInput.val()});
                me._validate();
            });

            this.$endDateInput.on('change', function () {
                me.newTimeline.set({endDateString: me.$endDateInput.val()});
                me._validate();

            });
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_ignored) {
  var output = '';
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output += '<div class="roadmap-column-title">' + ((displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '') + soy.$$escapeHtml(displayTimelineData3.month) + '</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timeline.soyTemplateName = 'Confluence.Templates.Roadmap.timeline';
}


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_ignored) {
  var output = '';
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output += '<div class="roadmap-column-item">&nbsp;</div>';
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.timelineColumn.soyTemplateName = 'Confluence.Templates.Roadmap.timelineColumn';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function ($, _) {
    'use strict';

    window.Roadmap = window.Roadmap || {};
    var RM = {};
    RM.Helper = Confluence.Roadmap.Helper;

    Roadmap.TimelineView = Backbone.View.extend({
        className: 'roadmap-frame-title',

        initialize: function () {
            _.bindAll(this, 'render');
        },

        render: function () {
            this.model.calculateTimelineColumns();
            this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines: this.model.get('displayTimelineColumns')}));
            return this;
        },

        update: function () {
            this.render();
        },

        getBarPosition: function (bar) {
            if (this.model.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH) {
                return {
                    left: RM.Helper.getPosXOnMonthTimeline(this.model.attributes, bar.startDate),
                    width: RM.Helper.getWidthTimeline(this.model.attributes, bar)
                };
            }

            return {
                left: RM.Helper.getPosXOnWeekTimeline(this.model.attributes, bar.startDate),
                width: RM.Helper.getWidthTimeline(this.model.attributes, bar)
            };
        },

        getBarDuration: function (barWidth) {
            return (this.model.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)
                ? (barWidth / Roadmap.MONTH_WIDTH)
                : (barWidth / Roadmap.WEEK_WIDTH);
        },

        getBarStartDate: function (positionX) {
            return (this.model.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)
                ? RM.Helper.getMonthStartDateByPosition(this.model.attributes, positionX)
                : RM.Helper.getWeekStartDateByPosition(this.model.attributes, positionX);
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};
    Roadmap.TimelineColumnView = Backbone.View.extend({
        className: 'roadmap-frame-content',
        initialize: function () {
            _.bindAll(this, 'render');
        },

        render: function () {
            var numberOfMonths = this.model.get('displayTimelineColumns').length;

            this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns: numberOfMonths}));
            return this;
        },

        updateHeight: function (height) {
            this.$el.height(height);
        },

        update: function () {
            this.render();
        },

        getSizeAndPosition: function () {
            return {
                width: this.$el.width(),
                height: this.$el.height(),
                left: this.$el.position().left,
                top: this.$el.position().top
            };
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources', location = 'view/dialog-view.js' */
/**
 * Currently InlineDialog doesn't support left/right orientation ( will support from version AUI 5.5.1 https://ecosystem.atlassian.net/browse/AUI-2197 )
 * SideInlineDialog has been already implemented and support left/right orientation
 * https://bitbucket.org/atlassianlabs/confluence-roadmap-plugin/src/f7c94dfb23007aa7fd0458af5e6128cdeacc6338/src/main/resources/js/SideInlineDialog.js?at=master
 * Temporary copied getDimensions & calculatePositions, getArrowPath functions to here with names_getSideDimensions & _calculateSidePositions, _getSideArrowPath
 * TODO update Roadmap InlineDialog use left/right option https://jira.atlassian.com/browse/CONFDEV-25613
 */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};
    Roadmap.InlineDialogView = Backbone.View.extend({
        /**
         * Initialise the view.
         *
         * @class
         * @classdesc A Backbone wrapper around `AJS.InlineDialog`.
         *
         * Subclasses must implement `_getContent()`.
         * @constructs
         * @param {object} options
         */
        initialize: function (options) {
            _.bindAll(this, '_onDocumentClick', '_onKeyDown', '_shouldHide', '_onHide');
            this._trigger = options.trigger;
            this._dialogOptions = options.dialogOptions;
            this._reset();
            var me = this;
            // hide dialog when roadmap scroll
            $('.roadmap-editor-popup, .roadmap-macro-view').scroll(function () {
                me.hide();
            });
        },

        /**
         * Determine if the inline dialog should hide in response to a click.
         *
         * Can be overridden by subclasses.
         *
         * @param {object} e A click event.
         * @returns {boolean} Whether the inline dialog should hide.
         */
        _shouldHideWhenClick: function (e) {
            return !$.contains(this._inlineDialog[0], e.target);
        },

        /**
         * Create the view's inline dialog.
         *
         * @param {trigger} the element under which the dialog is to appear.
         * @param {dialogOptions} options for inline dialog.
         * @returns {AJS.InlineDialog} The view's inline dialog.
         */
        _createInlineDialog: function (trigger, dialogOptions) {
            var inlineDialog,
                me = this;

            function getContent(element, trigger, showDialog) {
                me._getContent(element);
                showDialog();
            }

            function onBeforeShow() {
                me._onBeforeShow();

                _.delay(function () {
                    AJS.InlineDialog.current = null;
                    me._onShow();
                    $(document).on({
                        click: me._onDocumentClick,
                        keydown: me._onKeyDown
                    });
                }, me._inlineDialog.getOptions().fadeTime);
            }

            var defaultDialogOptions = {
                hideCallback: this._onHide,
                initCallback: onBeforeShow,
                noBind: true,
                persistent: true,
                preHideCallback: this._shouldHide
            };

            if (dialogOptions && dialogOptions.isSideInlineDialog) {
                _.extend(defaultDialogOptions, {
                    calculatePositions: _.compose(this._calculateSidePositions, this._getSideDimensions),
                    offsetX: 8,
                    offsetY: 0
                });

                if (Raphael.version) {
                    _.extend(defaultDialogOptions, {
                        getArrowPath: this._getSideArrowPath
                    });
                }
            }

            inlineDialog = new AJS.InlineDialog(trigger, 'roadmap-dialog', getContent,
                _.extend({}, defaultDialogOptions, dialogOptions));
            return inlineDialog;
        },

        _onHide: function () {
            $(document).off({
                click: this._onDocumentClick,
                keydown: this._onKeyDown
            });
        },

        /**
         * Remove dialog when hide it
         */
        hide: function () {
            this._inlineDialog.remove();
        },

        /**
         * Hide the inline dialog in response to a click.
         *
         * Called when the user clicks anywhere on the document.
         *
         */
        _onDocumentClick: function (e) {
            this._shouldHideWhenClick(e) && this.hide();
        },

        /**
         * Called before the inline dialog is shown.
         *
         * To be implemented by subclasses.
         */
        _onBeforeShow: $.noop,

        /**
         * Hide the inline dialog in response to pressing escape.
         *
         * @param {object} e The key down event.
         */
        _onKeyDown: function (e) {
            var isEscape = e.which === $.ui.keyCode.ESCAPE,
                isInput = $(e.target).is(":input");

            if (isEscape && !isInput) {
                this.hide();
            }
        },

        /**
         * Called after the inline dialog is shown.
         *
         * To be implemented by subclasses.
         */
        _onShow: $.noop,

        /**
         * Recreate the view's inline dialog to force content re-loading.
         *
         * This is used to work around a bug in `AJS.InlineDialog` where it
         * won't show if loading its content fails. Recreate it to reset state.
         *
         * @protected
         */
        _reset: function () {
            this._inlineDialog = this._createInlineDialog(this._trigger, this._dialogOptions);
            this.setElement(this._inlineDialog);
        },

        /**
         * To be overridden by subclasses.
         *
         * @returns {boolean} Whether the inline dialog should hide.
         */
        _shouldHide: function () {
            return true;
        },

        /**
         * Show the inline dialog.
         */
        show: function () {
            this._inlineDialog.show();
        },

        /**
         * Disable all buttons/inputs in the dialog.
         */
        disable: function () {
            this.$el.find(":input").attr("disabled", "disabled");
        },

        /**
         * Enable all buttons/inputs in the dialog.
         */
        enable: function () {
            this.$el.find(":input").removeAttr("disabled");
        },

        /**
         * Called when the dialog's form is submitted.
         *
         * To be implemented by subclasses.
         */
        _onSubmit: function () {
            throw new Error("DialogView subclasses must implement _onSubmit().");
        },

        /*
         * @param {jQuery} popup
         * @param {object} targetPosition
         * @param {object} mousePosition
         * @param {object} opts
         * @return {object}
         * @private
         */
        _getSideDimensions: function (popup, targetPosition, mousePosition, opts) {
            // Support positioning inside a scroll container other than <body>
            var constrainedScroll = opts.container.toLowerCase() !== 'body';
            var $scrollContainer = AJS.$(opts.container);
            var $scrollWindow = constrainedScroll ?
                AJS.$(opts.container).parent() :
                AJS.$(window);
            var scrollContainerOffset = constrainedScroll ?
                $scrollContainer.offset() : {left: 0, top: 0};
            var scrollWindowOffset = constrainedScroll ?
                $scrollWindow.offset() : {left: 0, top: 0};

            var trigger = targetPosition.target;
            var triggerOffset = trigger.offset();

            // Support SVG elements as triggers
            var triggerClientRect = trigger[0].getBoundingClientRect && trigger[0].getBoundingClientRect();

            // calculate actual width display on timeline if provide timeline width
            var width = triggerClientRect ? triggerClientRect.width : trigger.outerWidth();
            if (opts.timelineWidth) {
                var triggerPosition = trigger.position();
                if (triggerPosition.left + width > opts.timelineWidth) {
                    width = opts.timelineWidth - triggerPosition.left - 1; // 1 for timeline border
                }
            }

            var v = {
                // determines how close to the edge the dialog needs to be before it is considered offscreen
                screenPadding: 10,
                // Min distance arrow needs to be from the edge of the dialog
                arrowMargin: 5,
                window: {
                    top: scrollWindowOffset.top,
                    left: scrollWindowOffset.left,
                    scrollTop: $scrollWindow.scrollTop(),
                    scrollLeft: $scrollWindow.scrollLeft(),
                    width: $scrollWindow.width(),
                    height: $scrollWindow.height()
                },
                scrollContainer: {
                    width: $scrollContainer.width(),
                    height: $scrollContainer.height()
                },
                // Position of the trigger is relative to the scroll container
                trigger: {
                    top: triggerOffset.top - scrollContainerOffset.top,
                    left: triggerOffset.left - scrollContainerOffset.left,
                    width: width,
                    height: triggerClientRect ? triggerClientRect.height : trigger.outerHeight()
                },
                dialog: {
                    width: popup.width(),
                    height: popup.height(),
                    offset: {
                        top: opts.offsetY,
                        left: opts.offsetX
                    }
                },
                arrow: {
                    height: popup.find('.arrow').outerHeight()
                }
            };

            return v;
        },

        /**
         * @param {object} dimensions
         * @returns {object}
         * @private
         */
        _calculateSidePositions: function (dimensions) {
            var screenPadding = dimensions.screenPadding;
            var win = dimensions.window;
            var trigger = dimensions.trigger;
            var dialog = dimensions.dialog;
            var arrow = dimensions.arrow;
            var scrollContainer = dimensions.scrollContainer;

            var triggerScrollOffset = {
                top: trigger.top - win.scrollTop,
                left: trigger.left - win.scrollLeft
            };

            // Halves - because the browser doesn't do sub-pixel positioning, we need to consistently floor
            // all decimal values or you can get 1px jumps in arrow positioning when the dialog's height changes.
            var halfTriggerHeight = Math.floor(trigger.height / 2);
            var halfPopupHeight = Math.floor(dialog.height / 2);
            var halfArrowHeight = Math.floor(arrow.height / 2);

            // Figure out where to position the dialog, preferring the right
            var spaceOnLeft = triggerScrollOffset.left - dialog.offset.left - screenPadding;

            // This implementation may not be suitable for horizontally scrolling containers
            var spaceOnRight = scrollContainer.width - triggerScrollOffset.left - trigger.width - dialog.offset.left -
                screenPadding;
            var enoughSpaceOnLeft = spaceOnLeft >= dialog.width;
            var enoughSpaceOnRight = spaceOnRight >= dialog.width;
            var dialogLocation = !enoughSpaceOnRight && enoughSpaceOnLeft ? 'left' : 'right';

            // Screen padding needs to be adjusted if the arrow would extend into it
            var arrowScreenTop = triggerScrollOffset.top + halfTriggerHeight - halfArrowHeight;
            var arrowScreenBottom = win.height - arrowScreenTop - arrow.height;
            screenPadding = Math.min(screenPadding, arrowScreenTop - dimensions.arrowMargin);
            screenPadding = Math.min(screenPadding, arrowScreenBottom - dimensions.arrowMargin);

            // Figure out if the dialog needs to be adjusted up or down to fit on the screen
            var spaceAbove = Math.max(triggerScrollOffset.top - screenPadding, 0);
            var spaceBelow = Math.max(win.height - triggerScrollOffset.top - trigger.height - screenPadding, 0);
            var overflowAbove = Math.max(halfPopupHeight - halfTriggerHeight - dialog.offset.top - spaceAbove, 0);
            var overflowBelow = Math.max(halfPopupHeight - halfTriggerHeight + dialog.offset.top - spaceBelow, 0);
            var adjustmentForOverflow = overflowAbove || -overflowBelow || 0;

            // Calculate coordinates for the dialog, after adjustments for fitting onto the screen
            var popupCss = {
                top: trigger.top + halfTriggerHeight - halfPopupHeight + dialog.offset.top + adjustmentForOverflow,
                left: dialogLocation === 'right' ?
                    trigger.left + trigger.width + dialog.offset.left :
                    trigger.left - dialog.width - dialog.offset.left
            };

            var arrowGravity = 'w';
            // Calculate coordinates for the dialog's arrow. It is relative to the dialog, not the page
            var arrowCss = {
                position: 'absolute',
                top: halfPopupHeight - halfArrowHeight - adjustmentForOverflow
            };

            if (dialogLocation === 'right') {
                arrowCss.right = 'auto';
                arrowCss.left = Raphael.version ? '-7px' : '0px';
            } else {
                arrowCss.right = '-7px';
                arrowCss.left = 'auto';
                arrowGravity = 'e';
            }
            return {
                dialogLocation: dialogLocation,
                popupCss: popupCss,
                arrowCss: arrowCss,
                gravity: arrowGravity
            };
        },

        /**
         * @param {object} positions
         * @returns {string} SVG path
         * @private
         */
        _getSideArrowPath: function (positions) {
            return positions.dialogLocation === 'right' ?
                "M8,0L0,8,8,16" :
                "M8,0L16,8,8,16";
        },

        refresh: function () {
            this._inlineDialog && this._inlineDialog.refresh();
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog-templates.soy' */
// This file was automatically generated from bar-dialog-templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.barDialog = function(opt_data, opt_ignored) {
  var output = '';
  var hasPageLink__soy3 = opt_data.bar.pageLink != null && opt_data.bar.pageLink.id != null;
  output += '<h3 id="bar-title" class="editable-field">' + soy.$$escapeHtml(opt_data.bar.title) + '</h3><div class="information"><div class="bar-page-link-wrapper">' + ((opt_data.linkPageEditable) ? '<div class="link-update-page ' + ((hasPageLink__soy3) ? 'hidden-field' : '') + '"><a href="#">' + soy.$$escapeHtml('Link page') + '</a></div>' : '') + '<div class="bar-page-link editable-field ' + ((! hasPageLink__soy3) ? 'hidden-field' : '') + '">' + ((hasPageLink__soy3) ? Confluence.Templates.Roadmap.buildPageLink({pageLink: opt_data.bar.pageLink, isEditMode: opt_data.renderOption.isEditMode}) : '') + '</div>' + ((opt_data.linkPageEditable) ? '<div class="link-new-page' + ((hasPageLink__soy3) ? ' hidden-field' : '') + '"><span class=\'page-link-separator\'>\u2022</span><a href="#">' + soy.$$escapeHtml('Create page') + '</a></div>' : '') + '</div><div class="clear"></div><div class="bar-description editable-field">' + soy.$$filterNoAutoescape(opt_data.bar.description) + '</div></div>' + ((opt_data.renderOption.isEditMode) ? '<div class="inner">' + aui.buttons.button({id: 'delete-button', text: 'Delete bar', type: 'link'}) + '</div>' : '');
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.barDialog.soyTemplateName = 'Confluence.Templates.Roadmap.barDialog';
}


Confluence.Templates.Roadmap.buildPageLink = function(opt_data, opt_ignored) {
  return '<a id="roadmap-page-link" href=' + soy.$$escapeHtml("/wiki") + '/pages/viewpage.action?pageId=' + soy.$$escapeHtml(opt_data.pageLink.id) + ' ' + ((opt_data.isEditMode) ? 'target=\'_blank\'' : '') + ' class=\'confluence-link content-type-' + soy.$$escapeHtml(opt_data.pageLink.type) + '\'><span class="link-page-title">' + soy.$$escapeHtml(opt_data.pageLink.title) + '</span></a>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.buildPageLink.soyTemplateName = 'Confluence.Templates.Roadmap.buildPageLink';
}


Confluence.Templates.Roadmap.inlineEditSaveButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-save', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Save'}, iconClass: 'aui-icon-small aui-iconfont-success'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditSaveButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditSaveButton';
}


Confluence.Templates.Roadmap.inlineEditCancelButton = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'inline-edit-cancel', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Cancel'}, iconClass: 'aui-icon-small aui-iconfont-close-dialog'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.inlineEditCancelButton.soyTemplateName = 'Confluence.Templates.Roadmap.inlineEditCancelButton';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/roadmap-editinplace.js' */
/**

 A jQuery edit in place plugin

 Version 2.3.0

 Authors:
 Dave Hauenstein
 Martin Hcker <spamfaenger [at] gmx [dot] de>

 Project home:
 http://code.google.com/p/jquery-in-place-editor/

 Patches with tests welcomed! For guidance see the tests  </spec/unit/>. To submit, attach them to the bug tracker.

 License:
 This source file is subject to the BSD license bundled with this package.
 Available online: {@link http://www.opensource.org/licenses/bsd-license.php}
 If you did not receive a copy of the license, and are unable to obtain it,
 learn to use a search engine.

 * Modified by Atlassian - MBA
 */

(function ($) {

    $.fn.editInPlace = function (options) {

        var settings = $.extend({}, $.fn.editInPlace.defaults, options);
        assertMandatorySettingsArePresent(settings);
        preloadImage(settings.saving_image);

        return this.each(function () {
            var dom = $(this);
            // This won't work with live queries as there is no specific element to attach this
            // one way to deal with this could be to store a reference to self and then compare that in click?
            if (dom.data('editInPlace'))
                return; // already an editor here
            dom.data('editInPlace', true);

            new InlineEditor(settings, dom).init();
        });
    };

/// Switch these through the dictionary argument to $(aSelector).editInPlace(overideOptions)
/// Required Options: Either url or callback, so the editor knows what to do with the edited values.
    $.fn.editInPlace.defaults = {
        url: "", // string: POST URL to send edited content
        bg_over: "#ffc", // string: background color of hover of unactivated editor
        bg_out: "transparent", // string: background color on restore from hover
        hover_class: "",  // string: class added to root element during hover. Will override bg_over and bg_out
        form_extra_classes: [],  // string array: classes added to form element - MBA
        show_buttons: false, // boolean: will show the buttons: cancel or save; will automatically cancel out the onBlur functionality
        save_button: '<button class="inplace_save">Save</button>', // string: image button tag to use as Save button
        cancel_button: '<button class="inplace_cancel">Cancel</button>', // string: image button tag to use as Cancel button
        params: "", // string: example: first_name=dave&last_name=hauenstein extra paramters sent via the post request to the server
        field_type: "text", // string: "text", "textarea", or "select";  The type of form field that will appear on instantiation
        field_extra_classes: [], // string array: classes added to field element - MBA
        default_text: "(Click here to add text)", // string: text to show up if the element that has this functionality is empty
        use_html: false, // boolean, set to true if the editor should use jQuery.fn.html() to extract the value to show from the dom node
        textarea_rows: 10, // integer: set rows attribute of textarea, if field_type is set to textarea. Use CSS if possible though
        textarea_cols: 25, // integer: set cols attribute of textarea, if field_type is set to textarea. Use CSS if possible though
        select_text: "Choose new value", // string: default text to show up in select box
        select_options: "", // string or array: Used if field_type is set to 'select'. Can be comma delimited list of options 'textandValue,text:value', Array of options ['textAndValue', 'text:value'] or array of arrays ['textAndValue', ['text', 'value']]. The last form is especially usefull if your labels or values contain colons)
        text_size: null, // integer: set cols attribute of text input, if field_type is set to text. Use CSS if possible though

        // Specifying callback_skip_dom_reset will disable all saving_* options
        saving_text: undefined, // string: text to be used when server is saving information. Example "Saving..."
        saving_image: "", // string: uses saving text specify an image location instead of text while server is saving
        saving_animation_color: 'transparent', // hex color string, will be the color the pulsing animation during the save pulses to. Note: Only works if jquery-ui is loaded

        value_required: false, // boolean: if set to true, the element will not be saved unless a value is entered
        disable_submit_when_empty: false, // boolean: if set to true, the submit function will be disabled until a value is entered - MBA
        element_id: "element_id", // string: name of parameter holding the id or the editable
        update_value: "update_value", // string: name of parameter holding the updated/edited value
        original_value: 'original_value', // string: name of parameter holding the updated/edited value
        original_html: "original_html", // string: name of parameter holding original_html value of the editable /* DEPRECATED in 2.2.0 */ use original_value instead.
        save_if_nothing_changed: false,  // boolean: submit to function or server even if the user did not change anything
        on_blur: "save", // string: "save" or null; what to do on blur; will be overridden if show_buttons is true
        cancel: "", // string: if not empty, a jquery selector for elements that will not cause the editor to open even though they are clicked. E.g. if you have extra buttons inside editable fields

        // All callbacks will have this set to the DOM node of the editor that triggered the callback

        callback: null, // function: function to be called when editing is complete; cancels ajax submission to the url param. Prototype: function(idOfEditor, enteredText, orinalHTMLContent, settingsParams, callbacks). The function needs to return the value that should be shown in the dom. Returning undefined means cancel and will restore the dom and trigger an error. callbacks is a dictionary with two functions didStartSaving and didEndSaving() that you can use to tell the inline editor that it should start and stop any saving animations it has configured. /* DEPRECATED in 2.1.0 */ Parameter idOfEditor, use $(this).attr('id') instead
        callback_skip_dom_reset: false, // boolean: set this to true if the callback should handle replacing the editor with the new value to show
        success: null, // function: this function gets called if server responds with a success. Prototype: function(newEditorContentString)
        error: null, // function: this function gets called if server responds with an error. Prototype: function(request)
        error_sink: function (idOfEditor, errorString) {
            alert(errorString);
        }, // function: gets id of the editor and the error. Make sure the editor has an id, or it will just be undefined. If set to null, no error will be reported. /* DEPRECATED in 2.1.0 */ Parameter idOfEditor, use $(this).attr('id') instead
        preinit: null, // function: this function gets called after a click on an editable element but before the editor opens. If you return false, the inline editor will not open. Prototype: function(currentDomNode). DEPRECATED in 2.2.0 use delegate shouldOpenEditInPlace call instead
        postclose: null, // function: this function gets called after the inline editor has closed and all values are updated. Prototype: function(currentDomNode). DEPRECATED in 2.2.0 use delegate didCloseEditInPlace call instead
        delegate: null, // object: if it has methods with the name of the callbacks documented below in delegateExample these will be called. This means that you just need to impelment the callbacks you are interested in.

        isAutoCompleteField: false // MBA: this property should be TRUE when your field is autocomplete (has dropdown) to avoid blur event fired after select from dropdown
    };

// Lifecycle events that the delegate can implement
// this will always be fixed to the delegate
    var delegateExample = {
        // called while opening the editor.
        // return false to prevent editor from opening
        shouldOpenEditInPlace: function (aDOMNode, aSettingsDict, triggeringEvent) {
        },
        // return content to show in inplace editor
        willOpenEditInPlace: function (aDOMNode, aSettingsDict) {
        },
        didOpenEditInPlace: function (aDOMNode, aSettingsDict) {
        },

        // called while closing the editor
        // return false to prevent the editor from closing
        shouldCloseEditInPlace: function (aDOMNode, aSettingsDict, triggeringEvent) {
        },
        // return value will be shown during saving
        willCloseEditInPlace: function (aDOMNode, aSettingsDict) {
        },
        didCloseEditInPlace: function (aDOMNode, aSettingsDict) {
        },

        missingCommaErrorPreventer: ''
    };


    function InlineEditor(settings, dom) {
        this.settings = settings;
        this.dom = dom;
        this.originalValue = null;
        this.didInsertDefaultText = false;
        this.shouldDelayReinit = false;
        this.pageLinkHTML = settings.pageLinkHTML;
        this.isEditMode = settings.isEditMode;

        this.addRemoveDialogOnClickListener(this.isEditMode);
    };

    $.extend(InlineEditor.prototype, {

        init: function () {
            this.setDefaultTextIfNeccessary();
            this.connectOpeningEvents();
        },

        reinit: function () {
            if (this.shouldDelayReinit)
                return;

            this.triggerCallback(this.settings.postclose, /* DEPRECATED in 2.1.0 */ this.dom);
            this.triggerDelegateCall('didCloseEditInPlace');

            this.markEditorAsInactive();
            this.connectOpeningEvents();
        },

        setDefaultTextIfNeccessary: function () {
            if ('' !== this.dom.html())
                return;

            this.dom.html(this.settings.default_text);
            this.didInsertDefaultText = true;
        },

        connectOpeningEvents: function () {
            var that = this;
            this.dom
                .bind('mouseenter.editInPlace', function () {
                    that.addHoverEffect();
                })
                .bind('mouseleave.editInPlace', function () {
                    that.removeHoverEffect();
                })
                .bind('click.editInPlace', function (anEvent) {
                    that.openEditor(anEvent);
                });
        },

        disconnectOpeningEvents: function () {
            // prevent re-opening the editor when it is already open
            this.dom.unbind('.editInPlace');
        },

        addHoverEffect: function () {
            if (this.settings.hover_class)
                this.dom.addClass(this.settings.hover_class);
            else
                this.dom.css("background-color", this.settings.bg_over);
        },

        removeHoverEffect: function () {
            if (this.settings.hover_class)
                this.dom.removeClass(this.settings.hover_class);
            else
                this.dom.css("background-color", this.settings.bg_out);
        },

        openEditor: function (anEvent) {
            if (!this.shouldOpenEditor(anEvent))
                return;

            this.disconnectOpeningEvents();
            this.removeHoverEffect();
            this.removeInsertedDefaultTextIfNeccessary();
            this.saveOriginalValue();
            this.markEditorAsActive();
            this.replaceContentWithEditor();
            this.setInitialValue();
            this.workAroundMissingBlurBug();
            this.connectClosingEventsToEditor();
            this.triggerDelegateCall('didOpenEditInPlace');
        },

        shouldOpenEditor: function (anEvent) {
            if (this.isClickedObjectCancelled(anEvent.target))
                return false;

            if (false === this.triggerCallback(this.settings.preinit, /* DEPRECATED in 2.1.0 */ this.dom))
                return false;

            if (false === this.triggerDelegateCall('shouldOpenEditInPlace', true, anEvent))
                return false;

            /* MBA: Should return false to get IE9 works well when click on an Link. */
            if (this.settings.isAutoCompleteField && $(anEvent.target).hasClass('link-page-title')) {
                return false;
            }

            return true;
        },

        removeInsertedDefaultTextIfNeccessary: function () {
            if (!this.didInsertDefaultText
                || this.dom.html() !== this.settings.default_text)
                return;

            this.dom.html('');
            this.didInsertDefaultText = false;
        },

        removeDialog: function () {
            $('#inline-dialog-roadmap-dialog').remove();
        },

        // Fixes bug where dialog doesn't close after navigating away to linked page in view mode
        addRemoveDialogOnClickListener: function (isEditMode) {
            if(!isEditMode) {
                $("#roadmap-page-link").on("click", this.removeDialog);
            }
        },

        isClickedObjectCancelled: function (eventTarget) {
            if (!this.settings.cancel)
                return false;

            var eventTargetAndParents = $(eventTarget).parents().andSelf();
            var elementsMatchingCancelSelector = eventTargetAndParents.filter(this.settings.cancel);
            return 0 !== elementsMatchingCancelSelector.length;
        },

        saveOriginalValue: function () {
            this.originalValue = trim(this.dom.text());
        },

        restoreOriginalValue: function () {
            this.setClosedEditorContent(this.originalValue);
        },

        setClosedEditorContent: function (aValue) {
            aValue = aValue || this.settings.default_text; // MBA - rebinding the default text if value is empty

            // Fixes VULN-1095363 since we're not putting user supplied info directly into the page with .html().
            // This also fixes a bug where it doesn't show you the linked page anymore after you try to edit and click out of the edit.
            if (this.settings.use_html) {
                this.dom.html(this.pageLinkHTML);
                this.addRemoveDialogOnClickListener(this.isEditMode);
            }
            else
                this.dom.text(aValue);
        },

        workAroundMissingBlurBug: function () {
            // Strangely, all browser will forget to send a blur event to an input element
            // when another one is created and selected programmatically. (at least under some circumstances).
            // This means that if another inline editor is opened, existing inline editors will _not_ close
            // if they are configured to submit when blurred.

            // Using parents() instead document as base to workaround the fact that in the unittests
            // the editor is not a child of window.document but of a document fragment
            var ourInput = this.dom.find(':input');
            this.dom.parents(':last').find('.editInPlace-active :input').not(ourInput).blur();
        },

        replaceContentWithEditor: function () {
            // start - MBA - provide extra classes for form
            /*
            var buttons_html  = (this.settings.show_buttons) ? this.settings.save_button + ' ' + this.settings.cancel_button : '';
            var editorElement = this.createEditorElement(); // needs to happen before anything is replaced
            insert the new in place form after the element they click, then empty out the original element
            this.dom.html('<form class="inplace_form" style="display: inline; margin: 0; padding: 0;"></form>')
                .find('form')
                    .append(editorElement)
                    .append(buttons_html);
            */
            var editorElement = this.createEditorElement(); // needs to happen before anything is replaced
            /* insert the new in place form after the element they click, then empty out the original element */
            var formClasses = "inplace_form";
            if (this.settings.form_extra_classes instanceof Array) {
                formClasses = formClasses + " " + this.settings.form_extra_classes.join(' ');
            }
            this.dom.html('<form class="' + formClasses + '" style="display: inline; margin: 0; padding: 0;"></form>');
            var form = this.dom.find('form');
            form.append(editorElement);
            if (this.settings.show_buttons) {
                var buttons = $('<div class="inline-edit-buttons"></div>');
                var saveButton = $(this.settings.save_button);
                saveButton.addClass("inplace_save");
                buttons.append(saveButton);
                var cancelButton = $(this.settings.cancel_button);
                cancelButton.addClass("inplace_cancel");
                buttons.append(cancelButton);
                form.append(buttons);
            }
            // end - MBA
        },

        createEditorElement: function () {
            if (-1 === $.inArray(this.settings.field_type, ['text', 'textarea', 'select']))
                throw "Unknown field_type <fnord>, supported are 'text', 'textarea' and 'select'";

            var editor = null;
            if ("select" === this.settings.field_type)
                editor = this.createSelectEditor();
            else if ("text" === this.settings.field_type)
                editor = $('<input type="text" ' + this.inputNameAndClass()
                    + ' size="' + this.settings.text_size + '" />');
            else if ("textarea" === this.settings.field_type)
                editor = $('<textarea ' + this.inputNameAndClass()
                    + ' rows="' + this.settings.textarea_rows + '" '
                    + ' cols="' + this.settings.textarea_cols + '" />');

            return editor;
        },

        setInitialValue: function () {
            var initialValue = this.triggerDelegateCall('willOpenEditInPlace', this.originalValue);
            var editor = this.dom.find(':input');
            editor.val(initialValue);

            // Workaround for select fields which don't contain the original value.
            // Somehow the browsers don't like to select the instructional choice (disabled) in that case
            if (editor.val() !== initialValue)
                editor.val(''); // selects instructional choice
        },

        inputNameAndClass: function () {
            // start MBA - provide extra classes for field
            //return ' name="inplace_value" class="inplace_field" ';
            var fieldClasses = "inplace_field";
            if (this.settings.field_extra_classes instanceof Array) {
                fieldClasses = fieldClasses + " " + this.settings.field_extra_classes.join(' ');
            }
            return ' name="inplace_value" class="' + fieldClasses + '"';
            // end MBA
        },

        createSelectEditor: function () {
            var editor = $('<select' + this.inputNameAndClass() + '>'
                + '<option disabled="true" value="">' + this.settings.select_text + '</option>'
                + '</select>');

            var optionsArray = this.settings.select_options;
            if (!$.isArray(optionsArray))
                optionsArray = optionsArray.split(',');

            for (var i = 0; i < optionsArray.length; i++) {
                var currentTextAndValue = optionsArray[i];
                if (!$.isArray(currentTextAndValue))
                    currentTextAndValue = currentTextAndValue.split(':');

                var value = trim(currentTextAndValue[1] || currentTextAndValue[0]);
                var text = trim(currentTextAndValue[0]);

                var option = $('<option>').val(value).text(text);
                editor.append(option);
            }

            return editor;
        },

        connectClosingEventsToEditor: function () {
            var that = this;

            function cancelEditorAction(anEvent) {
                /**
                 * MBA: check to prevent blur when field is dropdown
                 **/
                if (!that.settings.isAutoCompleteField) {
                    that.handleCancelEditor(anEvent);
                }

                return false; // stop event bubbling
            }

            function saveEditorAction(anEvent) {
                that.handleSaveEditor(anEvent);
                return false; // stop event bubbling
            }

            var form = this.dom.find("form");

            form.find(".inplace_field").focus().select();
            form.find(".inplace_cancel").click(cancelEditorAction);
            form.find(".inplace_save").click(saveEditorAction);

            if (!this.settings.show_buttons) {
                // TODO: Firefox has a bug where blur is not reliably called when focus is lost
                //       (for example by another editor appearing)
                if ("save" === this.settings.on_blur)
                    form.find(".inplace_field").blur(saveEditorAction);
                else
                    form.find(".inplace_field").blur(cancelEditorAction);

                // start MBA - fix submit
                // workaround for msie & firefox bug where it won't submit on enter if no button is shown
                // if ($.browser.mozilla || $.browser.msie)
                //	this.bindSubmitOnEnterInInput();
                // end MBA
            }

            form.keyup(function (anEvent) {
                // allow canceling with escape
                var escape = 27;
                if (escape === anEvent.which)
                    return cancelEditorAction();
            });

            // start - MBA fix submit
            // workaround for webkit nightlies where they won't submit at all on enter
            // REFACT: find a way to just target the nightlies
            //if ($.browser.safari)
            //	this.bindSubmitOnEnterInInput();

            this.bindInputKeyup();
            // end - MBA fix submit
            form.submit(saveEditorAction);
        },

        bindSubmitOnEnterInInput: function () {
            if ('textarea' === this.settings.field_type)
                return; // can't enter newlines otherwise

            var that = this;
            this.dom.find(':input').keyup(function (event) {
                var enter = 13;
                if (enter === event.which)
                    return that.dom.find('form').submit();
            });
        },
        // start - MBA provide disable submit button when empty
        bindInputKeyup: function () {
            if ('textarea' === this.settings.field_type)
                return; // can't enter newlines otherwise

            var that = this;
            var inputField = this.dom.find(':input');
            var saveButton = this.dom.find(".inplace_save");
            inputField.keyup(function (event) {
                var enter = 13;
                if (enter === event.which)
                    return that.dom.find('form').submit();
                else if (that.settings.disable_submit_when_empty) {
                    if ($.trim(inputField.val()).length) {
                        saveButton.removeAttr('disabled');
                    } else {
                        saveButton.attr('disabled', 'disabled');
                    }
                }
            });
        },
        // end - MBA

        handleCancelEditor: function (anEvent) {
            // REFACT: remove duplication between save and cancel
            if (false === this.triggerDelegateCall('shouldCloseEditInPlace', true, anEvent))
                return;

            var enteredText = this.dom.find(':input').val();
            enteredText = this.triggerDelegateCall('willCloseEditInPlace', enteredText);

            this.restoreOriginalValue();
            // start MBA - update
            //if (hasContent(enteredText)
            //	&& ! this.isDisabledDefaultSelectChoice())
            //	this.setClosedEditorContent(enteredText);
            // end MBA
            this.reinit();
        },

        handleSaveEditor: function (anEvent) {
            if (false === this.triggerDelegateCall('shouldCloseEditInPlace', true, anEvent))
                return;

            var enteredText = $.trim(this.dom.find(':input').val()); // MBA - trim & remove spaces
            enteredText = this.triggerDelegateCall('willCloseEditInPlace', enteredText);

            if (this.isDisabledDefaultSelectChoice()
                || this.isUnchangedInput(enteredText)) {
                this.handleCancelEditor(anEvent);
                return;
            }

            if (this.didForgetRequiredText(enteredText)) {
                // start - MBA provide disable submit when empty
                if (this.settings.disable_submit_when_empty) {
                    return;
                }
                // end - MBA
                this.handleCancelEditor(anEvent);
                this.reportError("Error: You must enter a value to save this field");
                return;
            }

            this.showSaving(enteredText);

            if (this.settings.callback)
                this.handleSubmitToCallback(enteredText);
            else
                this.handleSubmitToServer(enteredText);
        },

        didForgetRequiredText: function (enteredText) {
            return this.settings.value_required
                && ("" === enteredText
                    || undefined === enteredText
                    || null === enteredText);
        },

        isDisabledDefaultSelectChoice: function () {
            return this.dom.find('option').eq(0).is(':selected:disabled');
        },

        isUnchangedInput: function (enteredText) {
            return !this.settings.save_if_nothing_changed
                && this.originalValue === enteredText;
        },

        showSaving: function (enteredText) {
            if (this.settings.callback && this.settings.callback_skip_dom_reset)
                return;

            var savingMessage = enteredText;
            if (hasContent(this.settings.saving_text))
                savingMessage = this.settings.saving_text;
            if (hasContent(this.settings.saving_image))
                // REFACT: alt should be the configured saving message
                savingMessage = $('<img />').attr('src', this.settings.saving_image).attr('alt', savingMessage);
            this.dom.html(encodeURIComponent(savingMessage)); // MBA - fix XSS
        },

        handleSubmitToCallback: function (enteredText) {
            // REFACT: consider to encode enteredText and originalHTML before giving it to the callback
            this.enableOrDisableAnimationCallbacks(true, false);
            var newHTML = this.triggerCallback(this.settings.callback, /* DEPRECATED in 2.1.0 */ this.id(), enteredText, this.originalValue,
                this.settings.params, this.savingAnimationCallbacks());

            if (this.settings.callback_skip_dom_reset)
                ; // do nothing
            else if (undefined === newHTML) {
                // failure; put original back
                this.reportError("Error: Failed to save value: " + enteredText);
                this.restoreOriginalValue();
            } else {
                // REFACT: use setClosedEditorContent
                this.pageLinkHTML = newHTML;
                this.dom.html(newHTML);
                this.addRemoveDialogOnClickListener(this.isEditMode);
            }
            if (this.didCallNoCallbacks()) {
                this.enableOrDisableAnimationCallbacks(false, false);
                this.reinit();
            }
        },

        handleSubmitToServer: function (enteredText) {
            var data = this.settings.update_value + '=' + encodeURIComponent(enteredText)
                + '&' + this.settings.element_id + '=' + this.dom.attr("id")
                + ((this.settings.params) ? '&' + this.settings.params : '')
                + '&' + this.settings.original_html + '=' + encodeURIComponent(this.originalValue) /* DEPRECATED in 2.2.0 */
                + '&' + this.settings.original_value + '=' + encodeURIComponent(this.originalValue);

            this.enableOrDisableAnimationCallbacks(true, false);
            this.didStartSaving();
            var that = this;
            $.ajax({
                url: that.settings.url,
                type: "POST",
                data: data,
                dataType: "html",
                complete: function (request) {
                    that.didEndSaving();
                },
                success: function (html) {
                    var new_text = html || that.settings.default_text;

                    /* put the newly updated info into the original element */
                    // FIXME: should be affected by the preferences switch
                    that.dom.html(new_text);
                    // REFACT: remove dom parameter, already in this, not documented, should be easy to remove
                    // REFACT: callback should be able to override what gets put into the DOM
                    that.triggerCallback(that.settings.success, html);
                },
                error: function (request) {
                    that.dom.html(that.originalHTML); // REFACT: what about a restorePreEditingContent()
                    if (that.settings.error)
                        // REFACT: remove dom parameter, already in this, not documented, can remove without deprecation
                        // REFACT: callback should be able to override what gets entered into the DOM
                        that.triggerCallback(that.settings.error, request);
                    else
                        that.reportError("Failed to save value: " + request.responseText || 'Unspecified Error');
                }
            });
        },

        // Utilities .........................................................

        triggerCallback: function (aCallback /*, arguments */) {
            if (!aCallback)
                return; // callback wasn't specified after all

            var callbackArguments = Array.prototype.slice.call(arguments, 1);
            return aCallback.apply(this.dom[0], callbackArguments);
        },

        /// defaultReturnValue is only used if the delegate returns undefined
        triggerDelegateCall: function (aDelegateMethodName, defaultReturnValue, optionalEvent) {
            // REFACT: consider to trigger equivalent callbacks automatically via a mapping table?
            if (!this.settings.delegate
                || !$.isFunction(this.settings.delegate[aDelegateMethodName]))
                return defaultReturnValue;

            var delegateReturnValue = this.settings.delegate[aDelegateMethodName](this.dom, this.settings, optionalEvent);
            return (undefined === delegateReturnValue)
                ? defaultReturnValue
                : delegateReturnValue;
        },

        reportError: function (anErrorString) {
            this.triggerCallback(this.settings.error_sink, /* DEPRECATED in 2.1.0 */ this.id(), anErrorString);
        },

        // REFACT: this method should go, callbacks should get the dom node itself as an argument
        id: function () {
            return this.dom.attr('id');
        },

        markEditorAsActive: function () {
            this.dom.addClass('editInPlace-active');
        },

        markEditorAsInactive: function () {
            this.dom.removeClass('editInPlace-active');
        },

        // REFACT: consider rename, doesn't deal with animation directly
        savingAnimationCallbacks: function () {
            var that = this;
            return {
                didStartSaving: function () {
                    that.didStartSaving();
                },
                didEndSaving: function () {
                    that.didEndSaving();
                }
            };
        },

        enableOrDisableAnimationCallbacks: function (shouldEnableStart, shouldEnableEnd) {
            this.didStartSaving.enabled = shouldEnableStart;
            this.didEndSaving.enabled = shouldEnableEnd;
        },

        didCallNoCallbacks: function () {
            return this.didStartSaving.enabled && !this.didEndSaving.enabled;
        },

        assertCanCall: function (methodName) {
            if (!this[methodName].enabled)
                throw new Error('Cannot call ' + methodName + ' now. See documentation for details.');
        },

        didStartSaving: function () {
            this.assertCanCall('didStartSaving');
            this.shouldDelayReinit = true;
            this.enableOrDisableAnimationCallbacks(false, true);

            this.startSavingAnimation();
        },

        didEndSaving: function () {
            this.assertCanCall('didEndSaving');
            this.shouldDelayReinit = false;
            this.enableOrDisableAnimationCallbacks(false, false);
            this.reinit();

            this.stopSavingAnimation();
        },

        startSavingAnimation: function () {
            var that = this;
            this.dom
                .animate({backgroundColor: this.settings.saving_animation_color}, 400)
                .animate({backgroundColor: 'transparent'}, 400, 'swing', function () {
                    // In the tests animations are turned off - i.e they happen instantaneously.
                    // Hence we need to prevent this from becomming an unbounded recursion.
                    setTimeout(function () {
                        that.startSavingAnimation();
                    }, 10);
                });
        },

        stopSavingAnimation: function () {
            this.dom
                .stop(true)
                .css({backgroundColor: ''});
        },

        missingCommaErrorPreventer: ''
    });


// Private helpers .......................................................

    function assertMandatorySettingsArePresent(options) {
        // one of these needs to be non falsy
        if (options.url || options.callback)
            return;

        throw new Error("Need to set either url: or callback: option for the inline editor to work.");
    }

    /* preload the loading icon if it is configured */
    function preloadImage(anImageURL) {
        if ('' === anImageURL)
            return;

        var loading_image = new Image();
        loading_image.src = anImageURL;
    }

    function trim(aString) {
        return aString
            .replace(/^\s+/, '')
            .replace(/\s+$/, '');
    }

    function hasContent(something) {
        if (undefined === something || null === something)
            return false;

        if (0 === something.length)
            return false;

        return true;
    }

})(jQuery);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-dialog.js' */
(function ($, _) {
    var InlineDialogView = Roadmap.InlineDialogView;
    Roadmap.BarDialogView = InlineDialogView.extend({
        events: {
            'click #delete-button': '_onDeleteClick',
            'click .link-new-page': '_goToCreateLinkPage',
            'click .link-update-page': '_goToUpdateLinkPage'
        },

        initialize: function () {
            _.bindAll(this, '_onPageLinkOpen', '_onPageLinkSelectCompleted', '_onPageLinkCallback', '_onPageLinkBlur', '_goToCreateLinkPage');
            this.options.dialogOptions = {
                width: 260,
                timelineWidth: this.options.timelineWidth,
                isSideInlineDialog: true,
                renderOption: this.options.renderOption,
                linkPageEditable: this.options.linkPageEditable,
                createLinkPageCallback: this.options.createLinkPageCallback
            };

            InlineDialogView.prototype.initialize.call(this, this.options);
        },

        // Taken from here: https://stackoverflow.com/a/12034334
        _escapeString: function (string) {
            var entityMap = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#39;',
                '/': '&#x2F;',
                '`': '&#x60;',
                '=': '&#x3D;'
            };
            return String(string).replace(/[&<>"'`=\/]/g, function (s) {
                return entityMap[s];
            });
        },

        /**
         * Get Bar dialog content
         * @param {element} element The inline dialog element.
         * @param {function} showDialog A function that shows the inline dialog.
         */
        _getContent: function (element) {
            // Fixes https://asecurityteam.atlassian.net/browse/VULN-1105619
            // Sanitize the id in case we somehow get some malformed ID that the user can set via the /content API
            const sanitizedId = this.model.attributes.pageLink.id ? {id: this._escapeString(this.model.attributes.pageLink.id)} : {};

            // This takes care of any further usages of this.model.attributes.pageLink.id since original object gets
            // assigned with sanitized id value
            Object.assign(this.model.attributes.pageLink, sanitizedId);

            element.html(Confluence.Templates.Roadmap.barDialog({
                bar: _.extend({}, this.model.attributes, {
                    description: AJS.escapeHtml(this.model.attributes.description).replace(/\r?\n/g, '<br />')
                }),
                renderOption: this.options.dialogOptions.renderOption,
                linkPageEditable: this.options.dialogOptions.linkPageEditable
            }));
        },

        _onBeforeShow: function () {
            this.fields = this._getFields();

            this._setupInlineEdit();
            this._addEvents();
        },

        _getFields: function () {
            return {
                $title: this.$el.find('#bar-title'),
                $description: this.$el.find('.bar-description'),
                $pageLink: this.$el.find('.bar-page-link'),
                $pageLinkNew: this.$el.find('.link-new-page'),
                $pageLinkUpdate: this.$el.find('.link-update-page')
            };
        },

        _setupInlineEdit: function () {
            var me = this;
            var fields = this.fields;
            var editInplaceOption = this.options.dialogOptions.renderOption.editInplace;
            var defaultOption = {
                form_extra_classes: ['aui'],
                hover_class: 'editable-field-hover aui-icon-small aui-iconfont-edit',
                field_extra_classes: ['text'],
                show_buttons: true,
                save_button: Confluence.Templates.Roadmap.inlineEditSaveButton(),
                cancel_button: Confluence.Templates.Roadmap.inlineEditCancelButton(),
                error_sink: null,
                use_html: true,
                default_text: "Click to add description.",
                delegate: {
                    shouldOpenEditInPlace: function () {
                        me.$el.find(".inplace_cancel").trigger('click'); // this function will prevent showing two inline edit instances at the same time
                    },
                    didCloseEditInPlace: function () {
                        // edit-inplace still need to rebind original value.
                        // So use setTimeout here to make sure everything was redraw before refresh the inline dialog
                        setTimeout(function () {
                            me.refresh();
                        }, 0);
                    }
                }
            };

            // Setup Title
            editInplaceOption.title && fields.$title.editInPlace(
                $.extend(true, {}, defaultOption, {
                    callback: function (elementId, enteredText) {
                        me.options.updateTitle(enteredText);
                        return AJS.escapeHtml(enteredText);
                    },
                    value_required: true,
                    disable_submit_when_empty: true,
                    delegate: {
                        willOpenEditInPlace: function () {
                            me.refresh();
                            fields.$title.find('.text').attr('maxlength', Roadmap.BarDialog.MAX_LENGTH_TITLE); // set maxlength for model browser
                        }
                    }
                })
            );

            // format italic if description is empty when the dialog show up
            ($.trim(fields.$description.text()) === '') ? fields.$description.addClass('empty-field') : fields.$description.removeClass('empty-field');

            // Setup Description
            var descriptionOption = $.extend(true, {}, defaultOption, {
                field_type: 'textarea',
                field_extra_classes: ['textarea'],
                value_required: false,
                save_if_nothing_changed: true,
                callback: function (elementId, enteredText) {
                    enteredText = $.trim(enteredText);
                    me.options.updateDescription(enteredText);

                    // format italic if description is empty after editing
                    if (enteredText === '') {
                        enteredText = "Click to add description.";
                        $(this).addClass('empty-field');
                    } else {
                        $(this).removeClass('empty-field');
                        Confluence.Roadmap.Analytics.addDescription();
                    }

                    // return the value that will be shown out after editing
                    return AJS.escapeHtml(enteredText).replace(/\r?\n/g, '<br />');
                },
                delegate: {
                    willOpenEditInPlace: function () { // return the value that will be shown in inlineEdit
                        me.refresh();
                        fields.$description.find('.textarea').attr('maxlength', Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION); // set maxlength for model browser
                        return me.model.attributes.description.replace(/<br\s*[\/]?>/gi, '\n');
                    }
                }
            });
            editInplaceOption.description && fields.$description.editInPlace(descriptionOption);

            // Setup Page Link
            var pageLinkOption = $.extend(true, {}, defaultOption, {
                pageLinkHTML: Confluence.Templates.Roadmap.buildPageLink({
                    pageLink: this.model.attributes.pageLink,
                    isEditMode: this.options.renderOption.isEditMode
                }),
                isEditMode: this.options.renderOption.isEditMode,
                isAutoCompleteField: true,
                show_buttons: false,
                default_text: '',
                field_extra_classes: ['text', 'autocomplete-confluence-content'],
                delegate: {
                    willOpenEditInPlace: me._onPageLinkOpen,
                    didCloseEditInPlace: function () {
                        //hack! when input text is in empty text, there are some cases press enter button do not fire the callback,
                        //therefore the status do not be updated correctly
                        if (_.isEmpty(fields.$pageLink.data('linkData'))) {
                            fields.$pageLink.hide();
                            fields.$pageLinkNew.show();
                            fields.$pageLinkUpdate.show();
                        }
                    }
                },
                on_blur: null,
                callback: me._onPageLinkCallback
            });
            editInplaceOption.pageLink && this.options.dialogOptions.linkPageEditable &&
            this.fields.$pageLink.editInPlace(pageLinkOption);
        },

        _onPageLinkOpen: function (aDOMNode) {
            var me = this;
            aDOMNode.append('<div class="link-page-dropdown" />'); // dropdown list will be rendered here
            var $searchInput = aDOMNode.find('.autocomplete-confluence-content');
            $searchInput.attr({
                placeholder: "Search page",
                'data-dropdown-target': '#inline-dialog-roadmap-dialog .link-page-dropdown',
                'data-none-message': "No matches found"
            });

            Confluence.Binder.autocompleteConfluenceContent(aDOMNode);
            $searchInput.bind("selected.autocomplete-content", this._onPageLinkSelectCompleted);

            // This blur event will prevent autocomplete field and editinplace edit at the same time
            $searchInput.on('blur', function () {
                setTimeout(me._onPageLinkBlur, 150);
            });

            var pageLink = this.model.attributes.pageLink;
            this.fields.$pageLink.data('linkData', pageLink);
            if (!_.isEmpty(pageLink)) {
                return pageLink.title; // return current page's title
            }
            return true; // return as new search
        },

        _onPageLinkSelectCompleted: function (event, data) {
            event.stopPropagation();

            var $searchInput = this.fields.$pageLink.find('.autocomplete-confluence-content');
            var linkObj = data.content;
            $searchInput.val(linkObj.title);
            this.fields.$pageLink.data('linkData', data.content);

            _.defer(this._onPageLinkBlur);
        },

        _onPageLinkBlur: function () {
            var $searchInput = this.fields.$pageLink.find('.autocomplete-confluence-content');
            var e = $.Event('keyup');
            e.which = AJS.keyCode.ENTER;
            $searchInput.trigger(e);
        },

        _onPageLinkCallback: function (elementId, enteredText) {
            var linkData = (enteredText === '') ? {} : this.fields.$pageLink.data('linkData');
            return this._updatePageLink(linkData);
        },

        _updatePageLink: function (linkData) {
            if (linkData.id === this.model.attributes.pageLink.id) {
                return;
            }

            var fields = this.fields;
            //old linked page ID != new linked page ID
            if (_.isEmpty(linkData)) {
                this.options.updatePageLink({});
                fields.$pageLink.hide();
                fields.$pageLinkNew.show();
                fields.$pageLinkUpdate.show();
                return "No linked page";
            } else {
                var pageLinkObj = _.pick(linkData, 'id', 'title', 'type', 'spaceKey', 'wikiLink');
                //detect link data come from 'existing link' , it comes from different format
                if (!linkData.spaceKey) {
                    pageLinkObj['spaceKey'] = linkData.space.key;
                }
                this.options.updatePageLink(pageLinkObj);
                fields.$pageLink.show();
                fields.$pageLinkNew.hide();
                fields.$pageLinkUpdate.hide();

                const sanitizedId = linkData.id ? {id: this._escapeString(linkData.id)} : {};
                // We should be getting back clean data since it was just returned from the BE but sanitizing just in case
                Object.assign(linkData, sanitizedId);

                //CONFDEV-31528
                if (this.options.renderOption.isEditMode) {
                    Confluence.Roadmap.Analytics.addPageLinkEditMode({
                        linkedPageId: linkData.id,
                        pageId: AJS.Meta.get('page-id') > 0 ? AJS.Meta.get('page-id') : AJS.Meta.get('draft-id'),
                        isDraft: AJS.Meta.get('page-id') <= 0
                    });
                } else {
                    //blog list doesn't have pageId, we take its URL
                    Confluence.Roadmap.Analytics.addPageLinkViewMode({
                        linkedPageId: linkData.id,
                        pageId: AJS.Meta.get('page-id')
                    });
                }

                return Confluence.Templates.Roadmap.buildPageLink({
                    pageLink: linkData,
                    isEditMode: this.options.renderOption.isEditMode
                });
            }
        },

        _addEvents: function () {
            // This code bellow will handler limiting max length in for browser which doesn't support maxlength (IE<=9)
            if ($.browser.msie && parseInt($.browser.version, 10) <= 9) {
                var checkLength = function (e, maxLength) {
                    if (e.ctrlKey || e.altKey || e.metaKey || e.keyCode === AJS.keyCode.BACKSPACE || e.keyCode === AJS.keyCode.DELETE) {
                        return true;
                    }
                    var value = $.trim(this.value);

                    return value.length <= maxLength;
                };

                // Keypress
                this.fields.$description.on('keypress', '.textarea', function (e) {
                    return checkLength.call(this, e, Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);
                });
                // Paste
                this.fields.$description.on('paste', '.textarea', function (e) {
                    var me = this;
                    setTimeout(function () {
                        if (checkLength.call(me, e, Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION)) {
                            me.value = me.value.substr(0, Roadmap.BarDialog.MAX_LENGTH_DESCRIPTION);
                        }
                    }, 0);
                });
            }
        },

        _onDeleteClick: function () {
            this.options.deleteBar();
            this.remove();
        },

        _goToCreateLinkPage: function (event) {
            var dialogOptions = this.options.dialogOptions;
            if (dialogOptions.createLinkPageCallback) {
                var createLinkPageCallback = _.bind(dialogOptions.createLinkPageCallback, {me: this}, event);
                createLinkPageCallback();
            }
        },

        _goToUpdateLinkPage: function (event) {
            event.preventDefault();
            this.fields.$pageLink.show();
            this.fields.$pageLinkNew.hide();
            this.fields.$pageLinkUpdate.hide();
            this.fields.$pageLink.click();
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-bar-dialog-resources', location = 'view/roadmap-editor/bar-dialog/bar-link-new-page.js' */
Confluence.RoadmapLink = (function ($, _) {
    Roadmap.trackingBars = [];

    /**
     *  linkParam = {
     *   id: roadmapData.id,
     *   roadmapHash: roadmapData.hash,
     *   version: roadmapData.version,
     *   roadmapBarId: this.options.bar.id
            }
     */
    function goToCreateLinkPage(linkParam, callback) {
        // this param decide the parent page after creating a page.
        // Work: 'Blank-page', 'Decision', 'Meeting notes', 'Retrospective', 'Troubleshooting article', 'Product requirement', etc...
        // not work: 'How-to-article', 'File list', 'JIRA report' : the param alway be override with null value
        var pageParam = {};
        // there is some cases without pageId, (blogpost list),
        if (parseInt(linkParam.pageId) <= 0) {
            linkParam.parentPageId = AJS.Meta.get('parent-page-id');
        }

        var barParamContext = $.param(linkParam);
        window.open(AJS.contextPath() + '/plugins/roadmap/create-page.action?' + barParamContext, '_blank');

        putLinkToPending(linkParam.roadmapBarId).done(function (data) {
            Roadmap.trackingBars.push(linkParam.roadmapBarId);
        });

        $(window).off('focus');
        $(window).on('focus', function () {
            if (!Roadmap.trackingBars.length) {
                $(window).off('focus');
            }
            _.each(Roadmap.trackingBars, function (barId) {
                checkRedeem(barId)
                    .done(function (data) {
                        var linkStatus = data.status;
                        if (linkStatus == 'REDEEM') {
                            removeTracking(barId);
                            callback({
                                barId: barId,
                                pageLink: $.parseJSON(data.pageLink)
                            });
                        } else if (linkStatus == 'UNKNOWN') {
                            removeTracking(barId);
                        }
                        //do nothing with PENDING
                    });
            });
        });
    }

    function removeTracking(barId) {
        Roadmap.trackingBars.splice(Roadmap.trackingBars.indexOf(barId), 1);
    }

    function putLinkToPending(barId) {
        return $.ajax({
            contentType: 'application/json',
            type: "PUT",
            url: AJS.contextPath() + "/rest/roadmap/1.0/bar/" + barId + "/PENDING"
        });
    }

    function checkRedeem(barId) {
        return $.ajax({
            contentType: 'application/json',
            type: "GET",
            url: AJS.contextPath() + "/rest/roadmap/1.0/bar/" + barId + "/status"
        });
    }

    return {
        addCreateLinkPageListener: goToCreateLinkPage
    };
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-position', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.position.js' */
(function(c){c.ui=c.ui||{};var k=/left|center|right/,l=/top|center|bottom/,n=c.fn.position,o=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return n.apply(this,arguments);var b=c.extend({},b),a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),f=b.offset?b.offset.split(" "):[0,0],h,j,e;9===d.nodeType?(h=a.width(),j=a.height(),e={top:0,left:0}):d.setTimeout?(h=a.width(),j=a.height(),e={top:a.scrollTop(),left:a.scrollLeft()}):d.preventDefault?(b.at="left top",h=j=0,e={top:b.of.pageY,left:b.of.pageX}):
(h=a.outerWidth(),j=a.outerHeight(),e=a.offset());c.each(["my","at"],function(){var a=(b[this]||"").split(" ");a.length===1&&(a=k.test(a[0])?a.concat(["center"]):l.test(a[0])?["center"].concat(a):["center","center"]);a[0]=k.test(a[0])?a[0]:"center";a[1]=l.test(a[1])?a[1]:"center";b[this]=a});1===g.length&&(g[1]=g[0]);f[0]=parseInt(f[0],10)||0;1===f.length&&(f[1]=f[0]);f[1]=parseInt(f[1],10)||0;"right"===b.at[0]?e.left+=h:"center"===b.at[0]&&(e.left+=h/2);"bottom"===b.at[1]?e.top+=j:"center"===b.at[1]&&
(e.top+=j/2);e.left+=f[0];e.top+=f[1];return this.each(function(){var a=c(this),d=a.outerWidth(),m=a.outerHeight(),k=parseInt(c.curCSS(this,"marginLeft",true))||0,l=parseInt(c.curCSS(this,"marginTop",true))||0,n=d+k+(parseInt(c.curCSS(this,"marginRight",true))||0),o=m+l+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},e),p;if(b.my[0]==="right")i.left=i.left-d;else if(b.my[0]==="center")i.left=i.left-d/2;if(b.my[1]==="bottom")i.top=i.top-m;else if(b.my[1]==="center")i.top=i.top-m/2;
p={left:i.left-k,top:i.top-l};c.each(["left","top"],function(a,e){if(c.ui.position[g[a]])c.ui.position[g[a]][e](i,{targetWidth:h,targetHeight:j,elemWidth:d,elemHeight:m,collisionPosition:p,collisionWidth:n,collisionHeight:o,offset:f,my:b.my,at:b.at})});c.fn.bgiframe&&a.bgiframe();a.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window),d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=0<d?b.left-d:Math.max(b.left-a.collisionPosition.left,
b.left)},top:function(b,a){var d=c(window),d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=0<d?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if("center"!==a.at[0]){var d=c(window),d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft(),g="left"===a.my[0]?-a.elemWidth:"right"===a.my[0]?a.elemWidth:0,f="left"===a.at[0]?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=0>a.collisionPosition.left?g+f+h:0<d?g+f+h:0}},top:function(b,
a){if("center"!==a.at[1]){var d=c(window),d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop(),g="top"===a.my[1]?-a.elemHeight:"bottom"===a.my[1]?a.elemHeight:0,f="top"===a.at[1]?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=0>a.collisionPosition.top?g+f+h:0<d?g+f+h:0}}}};c.offset.setOffset||(c.offset.setOffset=function(b,a){/static/.test(c.curCSS(b,"position"))&&(b.style.position="relative");var d=c(b),g=d.offset(),f=parseInt(c.curCSS(b,"top",!0),10)||0,h=parseInt(c.curCSS(b,
"left",!0),10)||0,g={top:a.top-g.top+f,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)},c.fn.offset=function(b){var a=this[0];return!a||!a.ownerDocument?null:b?c.isFunction(b)?this.each(function(a){c(this).offset(b.call(this,a,c(this).offset()))}):this.each(function(){c.offset.setOffset(this,b)}):o.call(this)});c.curCSS||(c.curCSS=c.css)})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-interactions', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.droppable.js' */
(function(d){d.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var a=this.options,b=a.accept;this.isover=0;this.isout=1;this.accept=d.isFunction(b)?b:function(a){return a.is(b)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};d.ui.ddmanager.droppables[a.scope]=d.ui.ddmanager.droppables[a.scope]||[];d.ui.ddmanager.droppables[a.scope].push(this);
a.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var a=d.ui.ddmanager.droppables[this.options.scope],b=0;b<a.length;b++)a[b]==this&&a.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(a,b){"accept"==a&&(this.accept=d.isFunction(b)?b:function(a){return a.is(b)});d.Widget.prototype._setOption.apply(this,arguments)},_activate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&
this.element.addClass(this.options.activeClass);b&&this._trigger("activate",a,this.ui(b))},_deactivate:function(a){var b=d.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);b&&this._trigger("deactivate",a,this.ui(b))},_over:function(a){var b=d.ui.ddmanager.current;if(b&&(b.currentItem||b.element)[0]!=this.element[0])if(this.accept.call(this.element[0],b.currentItem||b.element))this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",
a,this.ui(b))},_out:function(a){var b=d.ui.ddmanager.current;if(b&&(b.currentItem||b.element)[0]!=this.element[0])if(this.accept.call(this.element[0],b.currentItem||b.element))this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",a,this.ui(b))},_drop:function(a,b){var c=b||d.ui.ddmanager.current;if(!c||(c.currentItem||c.element)[0]==this.element[0])return!1;var f=!1;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var a=d.data(this,
"droppable");if(a.options.greedy&&!a.options.disabled&&a.options.scope==c.options.scope&&a.accept.call(a.element[0],c.currentItem||c.element)&&d.ui.intersect(c,d.extend(a,{offset:a.element.offset()}),a.options.tolerance))return f=!0,!1});return f?!1:this.accept.call(this.element[0],c.currentItem||c.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",a,this.ui(c)),this.element):
!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}});d.extend(d.ui.droppable,{version:"1.8.24"});d.ui.intersect=function(a,b,c){if(!b.offset)return!1;var f=(a.positionAbs||a.position.absolute).left,g=f+a.helperProportions.width,e=(a.positionAbs||a.position.absolute).top,h=e+a.helperProportions.height,i=b.offset.left,k=i+b.proportions.width,j=b.offset.top,l=j+b.proportions.height;switch(c){case "fit":return i<=f&&g<=k&&j<=e&&h<=l;
case "intersect":return i<f+a.helperProportions.width/2&&g-a.helperProportions.width/2<k&&j<e+a.helperProportions.height/2&&h-a.helperProportions.height/2<l;case "pointer":return d.ui.isOver((a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,j,i,b.proportions.height,b.proportions.width);case "touch":return(e>=j&&e<=l||h>=j&&h<=l||e<j&&h>l)&&(f>=i&&f<=k||g>=i&&g<=k||f<i&&g>k);default:return!1}};
d.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(a,b){var c=d.ui.ddmanager.droppables[a.options.scope]||[],f=b?b.type:null,g=(a.currentItem||a.element).find(":data(droppable)").andSelf(),e=0;a:for(;e<c.length;e++)if(!(c[e].options.disabled||a&&!c[e].accept.call(c[e].element[0],a.currentItem||a.element))){for(var h=0;h<g.length;h++)if(g[h]==c[e].element[0]){c[e].proportions.height=0;continue a}c[e].visible="none"!=c[e].element.css("display");c[e].visible&&("mousedown"==
f&&c[e]._activate.call(c[e],b),c[e].offset=c[e].element.offset(),c[e].proportions={width:c[e].element[0].offsetWidth,height:c[e].element[0].offsetHeight})}},drop:function(a,b){var c=!1;d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(this.options&&(!this.options.disabled&&(this.visible&&d.ui.intersect(a,this,this.options.tolerance))&&(c=this._drop.call(this,b)||c),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],a.currentItem||a.element)))this.isout=1,this.isover=
0,this._deactivate.call(this,b)});return c},dragStart:function(a,b){a.element.parents(":not(body,html)").bind("scroll.droppable",function(){a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)})},drag:function(a,b){a.options.refreshPositions&&d.ui.ddmanager.prepareOffsets(a,b);d.each(d.ui.ddmanager.droppables[a.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var c=d.ui.intersect(a,this,this.options.tolerance);if(c=!c&&1==this.isover?"isout":c&&0==
this.isover?"isover":null){var f;if(this.options.greedy){var g=this.options.scope,e=this.element.parents(":data(droppable)").filter(function(){return d.data(this,"droppable").options.scope===g});e.length&&(f=d.data(e[0],"droppable"),f.greedyChild="isover"==c?1:0)}f&&"isover"==c&&(f.isover=0,f.isout=1,f._out.call(f,b));this[c]=1;this["isout"==c?"isover":"isout"]=0;this["isover"==c?"_over":"_out"].call(this,b);f&&"isout"==c&&(f.isout=0,f.isover=1,f._over.call(f,b))}}})},dragStop:function(a,b){a.element.parents(":not(body,html)").unbind("scroll.droppable");
a.options.refreshPositions||d.ui.ddmanager.prepareOffsets(a,b)}}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-interactions', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.resizable.js' */
(function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,a=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],
_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null});this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=
!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,
display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize());this.handles=a.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){"all"==this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw");var c=this.handles.split(",");this.handles=
{};for(var d=0;d<c.length;d++){var f=e.trim(c[d]),g=e('<div class="ui-resizable-handle ui-resizable-'+f+'"></div>');g.css({zIndex:a.zIndex});"se"==f&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[f]=".ui-resizable-"+f;this.element.append(g)}}this._renderAxis=function(a){var a=a||this.element,b;for(b in this.handles){this.handles[b].constructor==String&&(this.handles[b]=e(this.handles[b],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var c=
e(this.handles[b],this.element),d=0,d=/sw|ne|nw|se|n|s/.test(b)?c.outerHeight():c.outerWidth(),c=["padding",/ne|nw|n/.test(b)?"Top":/se|sw|s/.test(b)?"Bottom":/^e$/.test(b)?"Right":"Left"].join("");a.css(c,d);this._proportionallyResize()}e(this.handles[b])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!b.resizing){if(this.className)var a=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=
a&&a[1]?a[1]:"se"}});a.autoHide&&(this._handles.hide(),e(this.element).addClass("ui-resizable-autohide").hover(function(){if(!a.disabled){e(this).removeClass("ui-resizable-autohide");b._handles.show()}},function(){if(!a.disabled&&!b.resizing){e(this).addClass("ui-resizable-autohide");b._handles.hide()}}));this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(a){e(a).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var a=this.element;a.after(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var a=!1,c;for(c in this.handles)e(this.handles[c])[0]==b.target&&(a=!0);return!this.options.disabled&&a},_mouseStart:function(b){var a=this.options,c=this.element.position(),
d=this.element;this.resizing=!0;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};(d.is(".ui-draggable")||/absolute/.test(d.css("position")))&&d.css({position:"absolute",top:c.top,left:c.left});this._renderProxy();var c=j(this.helper.css("left")),f=j(this.helper.css("top"));a.containment&&(c+=e(a.containment).scrollLeft()||0,f+=e(a.containment).scrollTop()||0);this.offset=this.helper.offset();this.position={left:c,top:f};this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:
{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:c,top:f};this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio="number"==typeof a.aspectRatio?a.aspectRatio:this.originalSize.width/this.originalSize.height||1;a=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",
"auto"==a?this.axis+"-resize":a);d.addClass("ui-resizable-resizing");this._propagate("start",b);return!0},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return!1;c=d.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);this._updateVirtualBoundaries(b.shiftKey);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+
"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return!1},_mouseStop:function(b){this.resizing=!1;var a=this.options;if(this._helper){var c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),c=d&&e.ui.hasScroll(c[0],"left")?0:this.sizeDiff.height,d=d?0:this.sizeDiff.width,d={width:this.helper.width()-d,height:this.helper.height()-c},c=parseInt(this.element.css("left"),
10)+(this.position.left-this.originalPosition.left)||null,f=parseInt(this.element.css("top"),10)+(this.position.top-this.originalPosition.top)||null;a.animate||this.element.css(e.extend(d,{top:f,left:c}));this.helper.height(this.size.height);this.helper.width(this.size.width);this._helper&&!a.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",b);this._helper&&this.helper.remove();return!1},_updateVirtualBoundaries:function(b){var a=
this.options,c,d,e,a={minWidth:i(a.minWidth)?a.minWidth:0,maxWidth:i(a.maxWidth)?a.maxWidth:Infinity,minHeight:i(a.minHeight)?a.minHeight:0,maxHeight:i(a.maxHeight)?a.maxHeight:Infinity};if(this._aspectRatio||b)if(b=a.minHeight*this.aspectRatio,d=a.minWidth/this.aspectRatio,c=a.maxHeight*this.aspectRatio,e=a.maxWidth/this.aspectRatio,b>a.minWidth&&(a.minWidth=b),d>a.minHeight&&(a.minHeight=d),c<a.maxWidth&&(a.maxWidth=c),e<a.maxHeight)a.maxHeight=e;this._vBoundaries=a},_updateCache:function(b){this.offset=
this.helper.offset();i(b.left)&&(this.position.left=b.left);i(b.top)&&(this.position.top=b.top);i(b.height)&&(this.size.height=b.height);i(b.width)&&(this.size.width=b.width)},_updateRatio:function(b){var a=this.position,c=this.size,d=this.axis;i(b.height)?b.width=b.height*this.aspectRatio:i(b.width)&&(b.height=b.width/this.aspectRatio);"sw"==d&&(b.left=a.left+(c.width-b.width),b.top=null);"nw"==d&&(b.top=a.top+(c.height-b.height),b.left=a.left+(c.width-b.width));return b},_respectSize:function(b){var a=
this._vBoundaries,c=this.axis,d=i(b.width)&&a.maxWidth&&a.maxWidth<b.width,e=i(b.height)&&a.maxHeight&&a.maxHeight<b.height,g=i(b.width)&&a.minWidth&&a.minWidth>b.width,h=i(b.height)&&a.minHeight&&a.minHeight>b.height;g&&(b.width=a.minWidth);h&&(b.height=a.minHeight);d&&(b.width=a.maxWidth);e&&(b.height=a.maxHeight);var k=this.originalPosition.left+this.originalSize.width,l=this.position.top+this.size.height,m=/sw|nw|w/.test(c),c=/nw|ne|n/.test(c);g&&m&&(b.left=k-a.minWidth);d&&m&&(b.left=k-a.maxWidth);
h&&c&&(b.top=l-a.minHeight);e&&c&&(b.top=l-a.maxHeight);(a=!b.width&&!b.height)&&!b.left&&b.top?b.top=null:a&&(!b.top&&b.left)&&(b.left=null);return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,a=0;a<this._proportionallyResizeElements.length;a++){var c=this._proportionallyResizeElements[a];if(!this.borderDif){var d=[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],f=[c.css("paddingTop"),
c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=e.map(d,function(a,b){var c=parseInt(a,10)||0,d=parseInt(f[b],10)||0;return c+d})}if(!e.browser.msie||!e(b).is(":hidden")&&!e(b).parents(":hidden").length)c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');
var a=e.browser.msie&&7>e.browser.version,c=a?1:0,a=a?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-
a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+c}},se:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},sw:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,a,c]))},ne:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},nw:function(b,a,
c){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,a,c]))}},_propagate:function(b,a){e.ui.plugin.call(this,b,[a,this.ui()]);"resize"!=b&&this._trigger(b,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.24"});e.ui.plugin.add("resizable","alsoResize",
{start:function(){var b=e(this).data("resizable").options,a=function(a){e(a).each(function(){var a=e(this);a.data("resizable-alsoresize",{width:parseInt(a.width(),10),height:parseInt(a.height(),10),left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)})})};"object"==typeof b.alsoResize&&!b.alsoResize.parentNode?b.alsoResize.length?(b.alsoResize=b.alsoResize[0],a(b.alsoResize)):e.each(b.alsoResize,function(b){a(b)}):a(b.alsoResize)},resize:function(b,a){var c=e(this).data("resizable"),d=c.options,
f=c.originalSize,g=c.originalPosition,h={height:c.size.height-f.height||0,width:c.size.width-f.width||0,top:c.position.top-g.top||0,left:c.position.left-g.left||0},i=function(b,c){e(b).each(function(){var b=e(this),d=e(this).data("resizable-alsoresize"),f={},g=c&&c.length?c:b.parents(a.originalElement[0]).length?["width","height"]:["width","height","top","left"];e.each(g,function(a,b){var c=(d[b]||0)+(h[b]||0);c&&0<=c&&(f[b]=c||null)});b.css(f)})};"object"==typeof d.alsoResize&&!d.alsoResize.nodeType?
e.each(d.alsoResize,function(a,b){i(a,b)}):i(d.alsoResize)},stop:function(){e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(b){var a=e(this).data("resizable"),c=a.options,d=a._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&e.ui.hasScroll(d[0],"left")?0:a.sizeDiff.height,f={width:a.size.width-(f?0:a.sizeDiff.width),height:a.size.height-g},g=parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left)||
null,h=parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(f,h&&g?{top:h,left:g}:{}),{duration:c.animateDuration,easing:c.animateEasing,step:function(){var c={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};d&&d.length&&e(d[0]).css({width:c.width,height:c.height});a._updateCache(c);a._propagate("resize",b)}})}});e.ui.plugin.add("resizable",
"containment",{start:function(){var b=e(this).data("resizable"),a=b.element,c=b.options.containment;if(a=c instanceof e?c.get(0):/parent/.test(c)?a.parent().get(0):c)if(b.containerElement=e(a),/document/.test(c)||c==document)b.containerOffset={left:0,top:0},b.containerPosition={left:0,top:0},b.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight};else{var d=e(a),f=[];e(["Top","Right","Left","Bottom"]).each(function(a,
b){f[a]=j(d.css("padding"+b))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};var c=b.containerOffset,g=b.containerSize.height,h=b.containerSize.width,h=e.ui.hasScroll(a,"left")?a.scrollWidth:h,g=e.ui.hasScroll(a)?a.scrollHeight:g;b.parentData={element:a,left:c.left,top:c.top,width:h,height:g}}},resize:function(b){var a=e(this).data("resizable"),c=a.options,d=a.containerOffset,f=a.position,b=a._aspectRatio||b.shiftKey,
g={top:0,left:0},h=a.containerElement;h[0]!=document&&/static/.test(h.css("position"))&&(g=d);if(f.left<(a._helper?d.left:0))a.size.width+=a._helper?a.position.left-d.left:a.position.left-g.left,b&&(a.size.height=a.size.width/a.aspectRatio),a.position.left=c.helper?d.left:0;if(f.top<(a._helper?d.top:0))a.size.height+=a._helper?a.position.top-d.top:a.position.top,b&&(a.size.width=a.size.height*a.aspectRatio),a.position.top=a._helper?d.top:0;a.offset.left=a.parentData.left+a.position.left;a.offset.top=
a.parentData.top+a.position.top;c=Math.abs(a.offset.left-g.left+a.sizeDiff.width);d=Math.abs((a._helper?a.offset.top-g.top:a.offset.top-d.top)+a.sizeDiff.height);f=a.containerElement.get(0)==a.element.parent().get(0);g=/relative|absolute/.test(a.containerElement.css("position"));f&&g&&(c-=a.parentData.left);c+a.size.width>=a.parentData.width&&(a.size.width=a.parentData.width-c,b&&(a.size.height=a.size.width/a.aspectRatio));d+a.size.height>=a.parentData.height&&(a.size.height=a.parentData.height-d,
b&&(a.size.width=a.size.height*a.aspectRatio))},stop:function(){var b=e(this).data("resizable"),a=b.options,c=b.containerOffset,d=b.containerPosition,f=b.containerElement,g=e(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,g=g.outerHeight()-b.sizeDiff.height;b._helper&&(!a.animate&&/relative/.test(f.css("position")))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g});b._helper&&(!a.animate&&/static/.test(f.css("position")))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g})}});
e.ui.plugin.add("resizable","ghost",{start:function(){var b=e(this).data("resizable"),a=b.options,c=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof a.ghost?a.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=e(this).data("resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=
e(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var b=e(this).data("resizable"),a=b.options,c=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;a.grid="number"==typeof a.grid?[a.grid,a.grid]:a.grid;var h=Math.round((c.width-d.width)/(a.grid[0]||1))*(a.grid[0]||1),a=Math.round((c.height-d.height)/(a.grid[1]||1))*(a.grid[1]||1);/^(se|s|e)$/.test(g)?(b.size.width=d.width+h,b.size.height=d.height+a):
/^(ne)$/.test(g)?(b.size.width=d.width+h,b.size.height=d.height+a,b.position.top=f.top-a):(/^(sw)$/.test(g)?(b.size.width=d.width+h,b.size.height=d.height+a):(b.size.width=d.width+h,b.size.height=d.height+a,b.position.top=f.top-a),b.position.left=f.left-h)}});var j=function(b){return parseInt(b,10)||0},i=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-interactions', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.selectable.js' */
(function(e){e.widget("ui.selectable",e.ui.mouse,{options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var b=this;this.element.addClass("ui-selectable");this.dragged=!1;var f;this.refresh=function(){f=e(b.options.filter,b.element[0]);f.addClass("ui-selectee");f.each(function(){var b=e(this),c=b.offset();e.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,
selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})};this.refresh();this.selectees=f.addClass("ui-selectee");this._mouseInit();this.helper=e("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(b){var f=
this;this.opos=[b.pageX,b.pageY];if(!this.options.disabled){var d=this.options;this.selectees=e(d.filter,this.element[0]);this._trigger("start",b);e(d.appendTo).append(this.helper);this.helper.css({left:b.clientX,top:b.clientY,width:0,height:0});d.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var c=e.data(this,"selectable-item");c.startselected=!0;!b.metaKey&&!b.ctrlKey&&(c.$element.removeClass("ui-selected"),c.selected=!1,c.$element.addClass("ui-unselecting"),
c.unselecting=!0,f._trigger("unselecting",b,{unselecting:c.element}))});e(b.target).parents().andSelf().each(function(){var c=e.data(this,"selectable-item");if(c){var d=!b.metaKey&&!b.ctrlKey||!c.$element.hasClass("ui-selected");c.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting");c.unselecting=!d;c.selecting=d;(c.selected=d)?f._trigger("selecting",b,{selecting:c.element}):f._trigger("unselecting",b,{unselecting:c.element});return!1}})}},_mouseDrag:function(b){var f=
this;this.dragged=!0;if(!this.options.disabled){var d=this.options,c=this.opos[0],g=this.opos[1],i=b.pageX,j=b.pageY;if(c>i)var h=i,i=c,c=h;g>j&&(h=j,j=g,g=h);this.helper.css({left:c,top:g,width:i-c,height:j-g});this.selectees.each(function(){var a=e.data(this,"selectable-item");if(a&&a.element!=f.element[0]){var h=false;d.tolerance=="touch"?h=!(a.left>i||a.right<c||a.top>j||a.bottom<g):d.tolerance=="fit"&&(h=a.left>c&&a.right<i&&a.top>g&&a.bottom<j);if(h){if(a.selected){a.$element.removeClass("ui-selected");
a.selected=false}if(a.unselecting){a.$element.removeClass("ui-unselecting");a.unselecting=false}if(!a.selecting){a.$element.addClass("ui-selecting");a.selecting=true;f._trigger("selecting",b,{selecting:a.element})}}else{if(a.selecting)if((b.metaKey||b.ctrlKey)&&a.startselected){a.$element.removeClass("ui-selecting");a.selecting=false;a.$element.addClass("ui-selected");a.selected=true}else{a.$element.removeClass("ui-selecting");a.selecting=false;if(a.startselected){a.$element.addClass("ui-unselecting");
a.unselecting=true}f._trigger("unselecting",b,{unselecting:a.element})}if(a.selected&&!b.metaKey&&!b.ctrlKey&&!a.startselected){a.$element.removeClass("ui-selected");a.selected=false;a.$element.addClass("ui-unselecting");a.unselecting=true;f._trigger("unselecting",b,{unselecting:a.element})}}}});return!1}},_mouseStop:function(b){var f=this;this.dragged=!1;e(".ui-unselecting",this.element[0]).each(function(){var d=e.data(this,"selectable-item");d.$element.removeClass("ui-unselecting");d.unselecting=
!1;d.startselected=!1;f._trigger("unselected",b,{unselected:d.element})});e(".ui-selecting",this.element[0]).each(function(){var d=e.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected");d.selecting=!1;d.selected=!0;d.startselected=!0;f._trigger("selected",b,{selected:d.element})});this._trigger("stop",b);this.helper.remove();return!1}});e.extend(e.ui.selectable,{version:"1.8.24"})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.accordion.js' */
(function(d){d.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:!0,clearStyle:!1,collapsible:!1,event:"click",fillSpace:!1,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}},_create:function(){var a=this,b=a.options;a.running=0;a.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix");
a.headers=a.element.find(b.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){b.disabled||d(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){b.disabled||d(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){b.disabled||d(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){b.disabled||d(this).removeClass("ui-state-focus")});a.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
if(b.navigation){var c=a.element.find("a").filter(b.navigationFilter).eq(0);if(c.length){var f=c.closest(".ui-accordion-header");a.active=f.length?f:c.closest(".ui-accordion-content").prev()}}a.active=a._findActive(a.active||b.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");a.active.next().addClass("ui-accordion-content-active");a._createIcons();a.resize();a.element.attr("role","tablist");a.headers.attr("role","tab").bind("keydown.accordion",
function(b){return a._keydown(b)}).next().attr("role","tabpanel");a.headers.not(a.active||"").attr({"aria-expanded":"false","aria-selected":"false",tabIndex:-1}).next().hide();a.active.length?a.active.attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}):a.headers.eq(0).attr("tabIndex",0);d.browser.safari||a.headers.find("a").attr("tabIndex",-1);b.event&&a.headers.bind(b.event.split(" ").join(".accordion ")+".accordion",function(b){a._clickHandler.call(a,b,this);b.preventDefault()})},_createIcons:function(){var a=
this.options;a.icons&&(d("<span></span>").addClass("ui-icon "+a.icons.header).prependTo(this.headers),this.active.children(".ui-icon").toggleClass(a.icons.header).toggleClass(a.icons.headerSelected),this.element.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var a=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex");
this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var b=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");(a.autoHeight||a.fillHeight)&&b.css("height","");return d.Widget.prototype.destroy.call(this)},_setOption:function(a,b){d.Widget.prototype._setOption.apply(this,arguments);"active"==a&&this.activate(b);"icons"==a&&(this._destroyIcons(),
b&&this._createIcons());if("disabled"==a)this.headers.add(this.headers.next())[b?"addClass":"removeClass"]("ui-accordion-disabled ui-state-disabled")},_keydown:function(a){if(!this.options.disabled&&!a.altKey&&!a.ctrlKey){var b=d.ui.keyCode,c=this.headers.length,f=this.headers.index(a.target),g=!1;switch(a.keyCode){case b.RIGHT:case b.DOWN:g=this.headers[(f+1)%c];break;case b.LEFT:case b.UP:g=this.headers[(f-1+c)%c];break;case b.SPACE:case b.ENTER:this._clickHandler({target:a.target},a.target),a.preventDefault()}return g?
(d(a.target).attr("tabIndex",-1),d(g).attr("tabIndex",0),g.focus(),!1):!0}},resize:function(){var a=this.options,b;if(a.fillSpace){if(d.browser.msie){var c=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}b=this.element.parent().height();d.browser.msie&&this.element.parent().css("overflow",c);this.headers.each(function(){b-=d(this).outerHeight(!0)});this.headers.next().each(function(){d(this).height(Math.max(0,b-d(this).innerHeight()+d(this).height()))}).css("overflow",
"auto")}else a.autoHeight&&(b=0,this.headers.next().each(function(){b=Math.max(b,d(this).height("").height())}).height(b));return this},activate:function(a){this.options.active=a;a=this._findActive(a)[0];this._clickHandler({target:a},a);return this},_findActive:function(a){return a?"number"===typeof a?this.headers.filter(":eq("+a+")"):this.headers.not(this.headers.not(a)):!1===a?d([]):this.headers.filter(":eq(0)")},_clickHandler:function(a,b){var c=this.options;if(!c.disabled)if(a.target){var f=d(a.currentTarget||
b),g=f[0]===this.active[0];c.active=c.collapsible&&g?!1:this.headers.index(f);if(!(this.running||!c.collapsible&&g)){var i=this.active,e=f.next(),h=this.active.next(),k={options:c,newHeader:g&&c.collapsible?d([]):f,oldHeader:this.active,newContent:g&&c.collapsible?d([]):e,oldContent:h},j=this.headers.index(this.active[0])>this.headers.index(f[0]);this.active=g?d([]):f;this._toggle(e,h,k,g,j);i.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(c.icons.headerSelected).addClass(c.icons.header);
g||(f.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(c.icons.header).addClass(c.icons.headerSelected),f.next().addClass("ui-accordion-content-active"))}}else if(c.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(c.icons.headerSelected).addClass(c.icons.header);this.active.next().addClass("ui-accordion-content-active");var h=this.active.next(),
k={options:c,newHeader:d([]),oldHeader:c.active,newContent:d([]),oldContent:h},e=this.active=d([]);this._toggle(e,h,k)}},_toggle:function(a,b,c,f,g){var i=this,e=i.options;i.toShow=a;i.toHide=b;i.data=c;var h=function(){if(i)return i._completed.apply(i,arguments)};i._trigger("changestart",null,i.data);i.running=0===b.size()?a.size():b.size();if(e.animated){c={};c=e.collapsible&&f?{toShow:d([]),toHide:b,complete:h,down:g,autoHeight:e.autoHeight||e.fillSpace}:{toShow:a,toHide:b,complete:h,down:g,autoHeight:e.autoHeight||
e.fillSpace};e.proxied||(e.proxied=e.animated);e.proxiedDuration||(e.proxiedDuration=e.duration);e.animated=d.isFunction(e.proxied)?e.proxied(c):e.proxied;e.duration=d.isFunction(e.proxiedDuration)?e.proxiedDuration(c):e.proxiedDuration;var f=d.ui.accordion.animations,k=e.duration,j=e.animated;j&&(!f[j]&&!d.easing[j])&&(j="slide");f[j]||(f[j]=function(a){this.slide(a,{easing:j,duration:k||700})});f[j](c)}else e.collapsible&&f?a.toggle():(b.hide(),a.show()),h(!0);b.prev().attr({"aria-expanded":"false",
"aria-selected":"false",tabIndex:-1}).blur();a.prev().attr({"aria-expanded":"true","aria-selected":"true",tabIndex:0}).focus()},_completed:function(a){this.running=a?0:--this.running;this.running||(this.options.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""}),this.toHide.removeClass("ui-accordion-content-active"),this.toHide.length&&(this.toHide.parent()[0].className=this.toHide.parent()[0].className),this._trigger("change",null,this.data))}});d.extend(d.ui.accordion,{version:"1.8.24",
animations:{slide:function(a,b){a=d.extend({easing:"swing",duration:300},a,b);if(a.toHide.size())if(a.toShow.size()){var c=a.toShow.css("overflow"),f=0,g={},i={},e,h=a.toShow;e=h[0].style.width;h.width(h.parent().width()-parseFloat(h.css("paddingLeft"))-parseFloat(h.css("paddingRight"))-(parseFloat(h.css("borderLeftWidth"))||0)-(parseFloat(h.css("borderRightWidth"))||0));d.each(["height","paddingTop","paddingBottom"],function(b,c){i[c]="hide";var e=(""+d.css(a.toShow[0],c)).match(/^([\d+-.]+)(.*)$/);
g[c]={value:e[1],unit:e[2]||"px"}});a.toShow.css({height:0,overflow:"hidden"}).show();a.toHide.filter(":hidden").each(a.complete).end().filter(":visible").animate(i,{step:function(b,c){"height"==c.prop&&(f=0===c.end-c.start?0:(c.now-c.start)/(c.end-c.start));a.toShow[0].style[c.prop]=f*g[c.prop].value+g[c.prop].unit},duration:a.duration,easing:a.easing,complete:function(){a.autoHeight||a.toShow.css("height","");a.toShow.css({width:e,overflow:c});a.complete()}})}else a.toHide.animate({height:"hide",
paddingTop:"hide",paddingBottom:"hide"},a);else a.toShow.animate({height:"show",paddingTop:"show",paddingBottom:"show"},a)},bounceslide:function(a){this.slide(a,{easing:a.down?"easeOutBounce":"swing",duration:a.down?1E3:200})}}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.autocomplete.js' */
(function(d){var c=0;d.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var a=this,b=this.element[0].ownerDocument,c;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(b){if(!a.options.disabled&&
!a.element.propAttr("readOnly")){c=!1;var f=d.ui.keyCode;switch(b.keyCode){case f.PAGE_UP:a._move("previousPage",b);break;case f.PAGE_DOWN:a._move("nextPage",b);break;case f.UP:a._keyEvent("previous",b);break;case f.DOWN:a._keyEvent("next",b);break;case f.ENTER:case f.NUMPAD_ENTER:a.menu.active&&(c=!0,b.preventDefault());case f.TAB:if(!a.menu.active)break;a.menu.select(b);break;case f.ESCAPE:a.element.val(a.term);a.close(b);break;default:clearTimeout(a.searching),a.searching=setTimeout(function(){a.term!=
a.element.val()&&(a.selectedItem=null,a.search(null,b))},a.options.delay)}}}).bind("keypress.autocomplete",function(a){c&&(c=!1,a.preventDefault())}).bind("focus.autocomplete",function(){a.options.disabled||(a.selectedItem=null,a.previous=a.element.val())}).bind("blur.autocomplete",function(b){a.options.disabled||(clearTimeout(a.searching),a.closing=setTimeout(function(){a.close(b);a._change(b)},150))});this._initSource();this.menu=d("<ul></ul>").addClass("ui-autocomplete").appendTo(d(this.options.appendTo||
"body",b)[0]).mousedown(function(b){var c=a.menu.element[0];d(b.target).closest(".ui-menu-item").length||setTimeout(function(){d(document).one("mousedown",function(b){b.target!==a.element[0]&&(b.target!==c&&!d.ui.contains(c,b.target))&&a.close()})},1);setTimeout(function(){clearTimeout(a.closing)},13)}).menu({focus:function(b,d){var c=d.item.data("item.autocomplete");!1!==a._trigger("focus",b,{item:c})&&/^key/.test(b.originalEvent.type)&&a.element.val(c.value)},selected:function(c,d){var e=d.item.data("item.autocomplete"),
h=a.previous;a.element[0]!==b.activeElement&&(a.element.focus(),a.previous=h,setTimeout(function(){a.previous=h;a.selectedItem=e},1));!1!==a._trigger("select",c,{item:e})&&a.element.val(e.value);a.term=a.element.val();a.close(c);a.selectedItem=e},blur:function(){a.menu.element.is(":visible")&&a.element.val()!==a.term&&a.element.val(a.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");d.fn.bgiframe&&this.menu.element.bgiframe();a.beforeunloadHandler=function(){a.element.removeAttr("autocomplete")};
d(window).bind("beforeunload",a.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();d(window).unbind("beforeunload",this.beforeunloadHandler);d.Widget.prototype.destroy.call(this)},_setOption:function(a,b){d.Widget.prototype._setOption.apply(this,arguments);"source"===a&&this._initSource();"appendTo"===a&&this.menu.element.appendTo(d(b||
"body",this.element[0].ownerDocument)[0]);"disabled"===a&&(b&&this.xhr)&&this.xhr.abort()},_initSource:function(){var a=this,b,c;d.isArray(this.options.source)?(b=this.options.source,this.source=function(a,c){c(d.ui.autocomplete.filter(b,a.term))}):"string"===typeof this.options.source?(c=this.options.source,this.source=function(b,f){a.xhr&&a.xhr.abort();a.xhr=d.ajax({url:c,data:b,dataType:"json",success:function(a){f(a)},error:function(){f([])}})}):this.source=this.options.source},search:function(a,
b){a=null!=a?a:this.element.val();this.term=this.element.val();if(a.length<this.options.minLength)return this.close(b);clearTimeout(this.closing);if(!1!==this._trigger("search",b))return this._search(a)},_search:function(a){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:a},this._response())},_response:function(){var a=this,b=++c;return function(d){b===c&&a.__response(d);a.pending--;a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){!this.options.disabled&&
a&&a.length?(a=this._normalize(a),this._suggest(a),this._trigger("open")):this.close()},close:function(a){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",a))},_change:function(a){this.previous!==this.element.val()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(a){return a.length&&a[0].label&&a[0].value?a:d.map(a,function(a){return"string"===typeof a?{label:a,value:a}:d.extend({label:a.label||
a.value,value:a.value||a.label},a)})},_suggest:function(a){var b=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(b,a);this.menu.deactivate();this.menu.refresh();b.show();this._resizeMenu();b.position(d.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new d.Event("mouseover"))},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(a,b){var c=
this;d.each(b,function(b,d){c._renderItem(a,d)})},_renderItem:function(a,b){return d("<li></li>").data("item.autocomplete",b).append(d("<a></a>").text(b.label)).appendTo(a)},_move:function(a,b){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(a)||this.menu.last()&&/^next/.test(a))this.element.val(this.term),this.menu.deactivate();else this.menu[a](b);else this.search(null,b)},widget:function(){return this.menu.element},_keyEvent:function(a,b){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(a,
b),b.preventDefault()}});d.extend(d.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(a,b){var c=RegExp(d.ui.autocomplete.escapeRegex(b),"i");return d.grep(a,function(a){return c.test(a.label||a.value||a)})}})})(jQuery);
(function(d){d.widget("ui.menu",{_create:function(){var c=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(a){d(a.target).closest(".ui-menu-item a").length&&(a.preventDefault(),c.select(a))});this.refresh()},refresh:function(){var c=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(a){c.activate(a,d(this).parent())}).mouseleave(function(){c.deactivate()})},activate:function(c,a){this.deactivate();if(this.hasScroll()){var b=a.offset().top-this.element.offset().top,d=this.element.scrollTop(),g=this.element.height();0>b?this.element.scrollTop(d+b):b>=g&&this.element.scrollTop(d+b-g+a.height())}this.active=a.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",c,{item:a})},deactivate:function(){this.active&&
(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(c){this.move("next",".ui-menu-item:first",c)},previous:function(c){this.move("prev",".ui-menu-item:last",c)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(c,a,b){this.active?(c=this.active[c+"All"](".ui-menu-item").eq(0),c.length?this.activate(b,
c):this.activate(b,this.element.children(a))):this.activate(b,this.element.children(a))},nextPage:function(c){if(this.hasScroll())if(!this.active||this.last())this.activate(c,this.element.children(".ui-menu-item:first"));else{var a=this.active.offset().top,b=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var c=d(this).offset().top-a-b+d(this).height();return 10>c&&-10<c});e.length||(e=this.element.children(".ui-menu-item:last"));this.activate(c,e)}else this.activate(c,
this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(c){if(this.hasScroll())if(!this.active||this.first())this.activate(c,this.element.children(".ui-menu-item:last"));else{var a=this.active.offset().top,b=this.element.height(),e=this.element.children(".ui-menu-item").filter(function(){var c=d(this).offset().top-a+b-d(this).height();return 10>c&&-10<c});e.length||(e=this.element.children(".ui-menu-item:first"));this.activate(c,e)}else this.activate(c,
this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[d.fn.prop?"prop":"attr"]("scrollHeight")},select:function(c){this._trigger("selected",c,{item:this.active})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.button.js' */
(function(b){var g,h,i,e,k=function(){var a=b(this).find(":ui-button");setTimeout(function(){a.button("refresh")},1)},j=function(a){var c=a.name,d=a.form,f=b([]);c&&(f=d?b(d).find("[name='"+c+"']"):b("[name='"+c+"']",a.ownerDocument).filter(function(){return!this.form}));return f};b.widget("ui.button",{options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",k);"boolean"!==typeof this.options.disabled?
this.options.disabled=!!this.element.propAttr("disabled"):this.element.propAttr("disabled",this.options.disabled);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var a=this,c=this.options,d="checkbox"===this.type||"radio"===this.type,f="ui-state-hover"+(!d?" ui-state-active":"");null===c.label&&(c.label=this.buttonElement.html());this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!c.disabled){b(this).addClass("ui-state-hover");
this===g&&b(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){c.disabled||b(this).removeClass(f)}).bind("click.button",function(a){if(c.disabled){a.preventDefault();a.stopImmediatePropagation()}});this.element.bind("focus.button",function(){a.buttonElement.addClass("ui-state-focus")}).bind("blur.button",function(){a.buttonElement.removeClass("ui-state-focus")});d&&(this.element.bind("change.button",function(){e||a.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(!c.disabled){e=
false;h=a.pageX;i=a.pageY}}).bind("mouseup.button",function(a){if(!c.disabled&&(h!==a.pageX||i!==a.pageY))e=true}));"checkbox"===this.type?this.buttonElement.bind("click.button",function(){if(c.disabled||e)return false;b(this).toggleClass("ui-state-active");a.buttonElement.attr("aria-pressed",a.element[0].checked)}):"radio"===this.type?this.buttonElement.bind("click.button",function(){if(c.disabled||e)return false;b(this).addClass("ui-state-active");a.buttonElement.attr("aria-pressed","true");var d=
a.element[0];j(d).not(d).map(function(){return b(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(c.disabled)return false;b(this).addClass("ui-state-active");g=this;b(document).one("mouseup",function(){g=null})}).bind("mouseup.button",function(){if(c.disabled)return false;b(this).removeClass("ui-state-active")}).bind("keydown.button",function(a){if(c.disabled)return false;(a.keyCode==b.ui.keyCode.SPACE||
a.keyCode==b.ui.keyCode.ENTER)&&b(this).addClass("ui-state-active")}).bind("keyup.button",function(){b(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===b.ui.keyCode.SPACE&&b(this).click()}));this._setOption("disabled",c.disabled);this._resetButton()},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if("checkbox"===this.type||
"radio"===this.type){var a=this.element.parents().filter(":last"),b="label[for='"+this.element.attr("id")+"']";this.buttonElement=a.find(b);this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b)));this.element.addClass("ui-helper-hidden-accessible");(a=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",a)}else this.buttonElement=
this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||
this.buttonElement.removeAttr("title");b.Widget.prototype.destroy.call(this)},_setOption:function(a,c){b.Widget.prototype._setOption.apply(this,arguments);"disabled"===a?c?this.element.propAttr("disabled",!0):this.element.propAttr("disabled",!1):this._resetButton()},refresh:function(){var a=this.element.is(":disabled");a!==this.options.disabled&&this._setOption("disabled",a);"radio"===this.type?j(this.element[0]).each(function(){b(this).is(":checked")?b(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
"true"):b(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)this.options.label&&this.element.val(this.options.label);else{var a=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
c=b("<span></span>",this.element[0].ownerDocument).addClass("ui-button-text").html(this.options.label).appendTo(a.empty()).text(),d=this.options.icons,f=d.primary&&d.secondary,e=[];d.primary||d.secondary?(this.options.text&&e.push("ui-button-text-icon"+(f?"s":d.primary?"-primary":"-secondary")),d.primary&&a.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&a.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||
(e.push(f?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||a.attr("title",c))):e.push("ui-button-text-only");a.addClass(e.join(" "))}}});b.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,c){"disabled"===a&&this.buttons.button("option",a,c);b.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){var a="rtl"===
this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(a?"ui-corner-left":"ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");
b.Widget.prototype.destroy.call(this)}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.dialog.js' */
(function(c){var i={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},j={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};c.widget("ui.dialog",{options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",collision:"fit",using:function(a){var b=c(this).css(a).offset().top;0>b&&c(this).css("top",a.top-b)}},resizable:!0,
show:null,stack:!0,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");"string"!==typeof this.originalTitle&&(this.originalTitle="");this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,d=c.ui.dialog.getTitleId(a.element),e=(a.uiDialog=c("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(d){if(b.closeOnEscape&&
!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===c.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}}).attr({role:"dialog","aria-labelledby":d}).mousedown(function(c){a.moveToTop(false,c)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(e);var f=(a.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(e),g=c('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){g.addClass("ui-state-hover")},function(){g.removeClass("ui-state-hover")}).focus(function(){g.addClass("ui-state-focus")}).blur(function(){g.removeClass("ui-state-focus")}).click(function(c){a.close(c);return false}).appendTo(f);(a.uiDialogTitlebarCloseText=c("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(g);d=c("<span></span>").addClass("ui-dialog-title").attr("id",d).prependTo(f);this._title(d);c.isFunction(b.beforeclose)&&!c.isFunction(b.beforeClose)&&
(b.beforeClose=b.beforeclose);f.find("*").add(f).disableSelection();b.draggable&&c.fn.draggable&&a._makeDraggable();b.resizable&&c.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=!1;c.fn.bgiframe&&e.bgiframe()},_title:function(a){this.options.title||a.html("&#160;");a.text(this.options.title)},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){this.overlay&&this.overlay.destroy();this.uiDialog.hide();this.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");
this.uiDialog.remove();this.originalTitle&&this.element.attr("title",this.originalTitle);return this},widget:function(){return this.uiDialog},close:function(a){var b=this,d,e;if(!1!==b._trigger("beforeClose",a))return b.overlay&&b.overlay.destroy(),b.uiDialog.unbind("keypress.ui-dialog"),b._isOpen=!1,b.options.hide?b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)}):(b.uiDialog.hide(),b._trigger("close",a)),c.ui.dialog.overlay.resize(),b.options.modal&&(d=0,c(".ui-dialog").each(function(){if(this!==
b.uiDialog[0]){e=c(this).css("z-index");isNaN(e)||(d=Math.max(d,e))}}),c.ui.dialog.maxZ=d),b},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var d=this.options;if(d.modal&&!a||!d.stack&&!d.modal)return this._trigger("focus",b);d.zIndex>c.ui.dialog.maxZ&&(c.ui.dialog.maxZ=d.zIndex);this.overlay&&(c.ui.dialog.maxZ+=1,this.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=c.ui.dialog.maxZ));d={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()};c.ui.dialog.maxZ+=
1;this.uiDialog.css("z-index",c.ui.dialog.maxZ);this.element.attr(d);this._trigger("focus",b);return this},open:function(){if(!this._isOpen){var a=this.options,b=this.uiDialog;this.overlay=a.modal?new c.ui.dialog.overlay(this):null;this._size();this._position(a.position);b.show(a.show);this.moveToTop(!0);a.modal&&b.bind("keydown.ui-dialog",function(a){if(a.keyCode===c.ui.keyCode.TAB){var b=c(":tabbable",this),f=b.filter(":first"),b=b.filter(":last");if(a.target===b[0]&&!a.shiftKey)return f.focus(1),
!1;if(a.target===f[0]&&a.shiftKey)return b.focus(1),!1}});c(this.element.find(":tabbable").get().concat(b.find(".ui-dialog-buttonpane :tabbable").get().concat(b.get()))).eq(0).focus();this._isOpen=!0;this._trigger("open");return this}},_createButtons:function(a){var b=this,d=!1,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),f=c("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);b.uiDialog.find(".ui-dialog-buttonpane").remove();"object"===typeof a&&
null!==a&&c.each(a,function(){return!(d=!0)});d&&(c.each(a,function(a,d){var d=c.isFunction(d)?{click:d,text:a}:d,e=c('<button type="button"></button>').click(function(){d.click.apply(b.element[0],arguments)}).appendTo(f);c.each(d,function(a,b){if("click"!==a)if(a in e)e[a](b);else e.attr(a,b)});c.fn.button&&e.button()}),e.appendTo(b.uiDialog))},_makeDraggable:function(){function a(a){return{position:a.position,offset:a.offset}}var b=this,d=b.options,e=c(document),f;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",
handle:".ui-dialog-titlebar",containment:"document",start:function(e,h){f="auto"===d.height?"auto":c(this).height();c(this).height(c(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",e,a(h))},drag:function(c,d){b._trigger("drag",c,a(d))},stop:function(g,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()];c(this).removeClass("ui-dialog-dragging").height(f);b._trigger("dragStop",g,a(h));c.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(a){return{originalPosition:a.originalPosition,
originalSize:a.originalSize,position:a.position,size:a.size}}var a=void 0===a?this.options.resizable:a,d=this,e=d.options,f=d.uiDialog.css("position"),a="string"===typeof a?a:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:a,start:function(a,e){c(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",a,b(e))},resize:function(a,c){d._trigger("resize",
a,b(c))},stop:function(a,f){c(this).removeClass("ui-dialog-resizing");e.height=c(this).height();e.width=c(this).width();d._trigger("resizeStop",a,b(f));c.ui.dialog.overlay.resize()}}).css("position",f).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var b=[],d=[0,0],e;if(a){if("string"===typeof a||"object"===typeof a&&"0"in a)b=a.split?a.split(" "):
[a[0],a[1]],1===b.length&&(b[1]=b[0]),c.each(["left","top"],function(a,c){+b[a]===b[a]&&(d[a]=b[a],b[a]=c)}),a={my:b.join(" "),at:b.join(" "),offset:d.join(" ")};a=c.extend({},c.ui.dialog.prototype.options.position,a)}else a=c.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(c.extend({of:window},a));e||this.uiDialog.hide()},_setOptions:function(a){var b=this,d={},e=!1;c.each(a,function(a,c){b._setOption(a,c);a in
i&&(e=!0);a in j&&(d[a]=c)});e&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var d=this.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":this._createButtons(b);break;case "closeText":this.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":d.removeClass(this.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;case "disabled":b?d.addClass("ui-dialog-disabled"):
d.removeClass("ui-dialog-disabled");break;case "draggable":var e=d.is(":data(draggable)");e&&!b&&d.draggable("destroy");!e&&b&&this._makeDraggable();break;case "position":this._position(b);break;case "resizable":(e=d.is(":data(resizable)"))&&!b&&d.resizable("destroy");e&&"string"===typeof b&&d.resizable("option","handles",b);!e&&!1!==b&&this._makeResizable(b);break;case "title":this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}c.Widget.prototype._setOption.apply(this,arguments)},_size:function(){var a=
this.options,b,d,e=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});a.minWidth>a.width&&(a.width=a.minWidth);b=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-b);"auto"===a.height?c.support.minHeight?this.element.css({minHeight:d,height:"auto"}):(this.uiDialog.show(),a=this.element.css("height","auto").height(),e||this.uiDialog.hide(),this.element.height(Math.max(a,d))):this.element.height(Math.max(a.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});c.extend(c.ui.dialog,{version:"1.8.24",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");a||(a=this.uuid+=1);return"ui-dialog-title-"+a},overlay:function(a){this.$el=c.ui.dialog.overlay.create(a)}});c.extend(c.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:c.map("focus mousedown mouseup keydown keypress click".split(" "),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){0===this.instances.length&&
(setTimeout(function(){c.ui.dialog.overlay.instances.length&&c(document).bind(c.ui.dialog.overlay.events,function(a){if(c(a.target).zIndex()<c.ui.dialog.overlay.maxZ)return!1})},1),c(document).bind("keydown.dialog-overlay",function(b){a.options.closeOnEscape&&(!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===c.ui.keyCode.ESCAPE)&&(a.close(b),b.preventDefault())}),c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize));var b=(this.oldInstances.pop()||c("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});c.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(a){var b=c.inArray(a,this.instances);-1!=b&&this.oldInstances.push(this.instances.splice(b,1)[0]);0===this.instances.length&&c([document,window]).unbind(".dialog-overlay");a.remove();var d=0;c.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,b;return c.browser.msie&&7>c.browser.version?(a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),
b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),a<b?c(window).height()+"px":a+"px"):c(document).height()+"px"},width:function(){var a,b;return c.browser.msie?(a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),a<b?c(window).width()+"px":a+"px"):c(document).width()+"px"},resize:function(){var a=c([]);c.each(c.ui.dialog.overlay.instances,function(){a=a.add(this)});a.css({width:0,
height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.progressbar.js' */
(function(b){b.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});this.valueDiv=b("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this.oldValue=this._value();this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");
this.valueDiv.remove();b.Widget.prototype.destroy.apply(this,arguments)},value:function(a){if(void 0===a)return this._value();this._setOption("value",a);return this},_setOption:function(a,c){"value"===a&&(this.options.value=c,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete"));b.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var a=this.options.value;"number"!==typeof a&&(a=0);return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*
this._value()/this.options.max},_refreshValue:function(){var a=this.value(),b=this._percentage();this.oldValue!==a&&(this.oldValue=a,this._trigger("change"));this.valueDiv.toggle(a>this.min).toggleClass("ui-corner-right",a===this.options.max).width(b.toFixed(0)+"%");this.element.attr("aria-valuenow",a)}});b.extend(b.ui.progressbar,{version:"1.8.24"})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.slider.js' */
(function(d){d.widget("ui.slider",d.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var a=this,b=this.options,c=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f=b.values&&b.values.length||1,e=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(b.disabled?" ui-slider-disabled ui-disabled":""));this.range=d([]);if(b.range){if(!0===b.range&&(b.values||(b.values=[this._valueMin(),this._valueMin()]),b.values.length&&2!==b.values.length))b.values=[b.values[0],b.values[0]];this.range=d("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))}for(var g=c.length;g<f;g+=1)e.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=c.add(d(e.join("")).appendTo(a.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(a){a.preventDefault()}).hover(function(){b.disabled||d(this).addClass("ui-state-hover")},function(){d(this).removeClass("ui-state-hover")}).focus(function(){b.disabled?d(this).blur():(d(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),d(this).addClass("ui-state-focus"))}).blur(function(){d(this).removeClass("ui-state-focus")});this.handles.each(function(a){d(this).data("index.ui-slider-handle",
a)});this.handles.keydown(function(b){var c=d(this).data("index.ui-slider-handle"),e,f,g;if(!a.options.disabled){switch(b.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(b.preventDefault(),!a._keySliding&&(a._keySliding=!0,d(this).addClass("ui-state-active"),e=a._start(b,c),!1===e))return}g=a.options.step;e=a.options.values&&a.options.values.length?
f=a.values(c):f=a.value();switch(b.keyCode){case d.ui.keyCode.HOME:f=a._valueMin();break;case d.ui.keyCode.END:f=a._valueMax();break;case d.ui.keyCode.PAGE_UP:f=a._trimAlignValue(e+(a._valueMax()-a._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:f=a._trimAlignValue(e-(a._valueMax()-a._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(e===a._valueMax())return;f=a._trimAlignValue(e+g);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(e===a._valueMin())return;f=a._trimAlignValue(e-
g)}a._slide(b,c,f)}}).keyup(function(b){var c=d(this).data("index.ui-slider-handle");a._keySliding&&(a._keySliding=!1,a._stop(b,c),a._change(b,c),d(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},
_mouseCapture:function(a){var b=this.options,c,f,e,g,h;if(b.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:a.pageX,y:a.pageY});f=this._valueMax()-this._valueMin()+1;g=this;this.handles.each(function(b){var a=Math.abs(c-g.values(b));f>a&&(f=a,e=d(this),h=b)});!0===b.range&&this.values(1)===b.min&&(h+=1,e=d(this.handles[h]));if(!1===this._start(a,h))return!1;this._mouseSliding=
!0;g._handleIndex=h;e.addClass("ui-state-active").focus();b=e.offset();this._clickOffset=!d(a.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:a.pageX-b.left-e.width()/2,top:a.pageY-b.top-e.height()/2-(parseInt(e.css("borderTopWidth"),10)||0)-(parseInt(e.css("borderBottomWidth"),10)||0)+(parseInt(e.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(a,h,c);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(a){var b=this._normValueFromMouse({x:a.pageX,
y:a.pageY});this._slide(a,this._handleIndex,b);return!1},_mouseStop:function(a){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(a,this._handleIndex);this._change(a,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b;"horizontal"===this.orientation?(b=this.elementSize.width,a=a.x-this.elementOffset.left-
(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,a=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));b=a/b;1<b&&(b=1);0>b&&(b=0);"vertical"===this.orientation&&(b=1-b);a=this._valueMax()-this._valueMin();b=this._valueMin()+b*a;return this._trimAlignValue(b)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());return this._trigger("start",
a,c)},_slide:function(a,b,c){var d;if(this.options.values&&this.options.values.length){d=this.values(b?0:1);if(2===this.options.values.length&&!0===this.options.range&&(0===b&&c>d||1===b&&c<d))c=d;c!==this.values(b)&&(d=this.values(),d[b]=c,a=this._trigger("slide",a,{handle:this.handles[b],value:c,values:d}),this.values(b?0:1),!1!==a&&this.values(b,c,!0))}else c!==this.value()&&(a=this._trigger("slide",a,{handle:this.handles[b],value:c}),!1!==a&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],
value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values());this._trigger("change",a,c)}},value:function(a){if(arguments.length)this.options.value=this._trimAlignValue(a),this._refreshValue(),this._change(null,
0);else return this._value()},values:function(a,b){var c,f,e;if(1<arguments.length)this.options.values[a]=this._trimAlignValue(b),this._refreshValue(),this._change(null,a);else if(arguments.length)if(d.isArray(arguments[0])){c=this.options.values;f=arguments[0];for(e=0;e<c.length;e+=1)c[e]=this._trimAlignValue(f[e]),this._change(null,e);this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(a):this.value();else return this._values()},_setOption:function(a,b){var c,
f=0;d.isArray(this.options.values)&&(f=this.options.values.length);d.Widget.prototype._setOption.apply(this,arguments);switch(a){case "disabled":b?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(c=0;c<f;c+=1)this._change(null,c);this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);b=this.options.values.slice();for(c=0;c<b.length;c+=1)b[c]=
this._trimAlignValue(b[c]);return b},_trimAlignValue:function(a){if(a<=this._valueMin())return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=0<this.options.step?this.options.step:1,c=(a-this._valueMin())%b,a=a-c;2*Math.abs(c)>=b&&(a+=0<c?b:-b);return parseFloat(a.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var a=this.options.range,b=this.options,c=this,f=!this._animateOff?b.animate:!1,e,g=
{},h,k,i,j;if(this.options.values&&this.options.values.length)this.handles.each(function(a){e=100*((c.values(a)-c._valueMin())/(c._valueMax()-c._valueMin()));g["horizontal"===c.orientation?"left":"bottom"]=e+"%";d(this).stop(1,1)[f?"animate":"css"](g,b.animate);if(!0===c.options.range)if("horizontal"===c.orientation){if(0===a)c.range.stop(1,1)[f?"animate":"css"]({left:e+"%"},b.animate);if(1===a)c.range[f?"animate":"css"]({width:e-h+"%"},{queue:!1,duration:b.animate})}else{if(0===a)c.range.stop(1,
1)[f?"animate":"css"]({bottom:e+"%"},b.animate);if(1===a)c.range[f?"animate":"css"]({height:e-h+"%"},{queue:!1,duration:b.animate})}h=e});else{k=this.value();i=this._valueMin();j=this._valueMax();e=j!==i?100*((k-i)/(j-i)):0;g["horizontal"===c.orientation?"left":"bottom"]=e+"%";this.handle.stop(1,1)[f?"animate":"css"](g,b.animate);if("min"===a&&"horizontal"===this.orientation)this.range.stop(1,1)[f?"animate":"css"]({width:e+"%"},b.animate);if("max"===a&&"horizontal"===this.orientation)this.range[f?
"animate":"css"]({width:100-e+"%"},{queue:!1,duration:b.animate});if("min"===a&&"vertical"===this.orientation)this.range.stop(1,1)[f?"animate":"css"]({height:e+"%"},b.animate);if("max"===a&&"vertical"===this.orientation)this.range[f?"animate":"css"]({height:100-e+"%"},{queue:!1,duration:b.animate})}}});d.extend(d.ui.slider,{version:"1.8.24"})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-widgets', location = 'src/js-vendor/jquery/jquery-ui/jquery.ui.tabs.js' */
(function(d){var n=0,o=0;d.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:!1,cookie:null,collapsible:!1,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},_create:function(){this._tabify(!0)},_setOption:function(a,d){"selected"==a?this.options.collapsible&&d==this.options.selected||this.select(d):
(this.options[a]=d,this._tabify())},_tabId:function(a){return a.title&&a.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF-]/g,"")||this.options.idPrefix+ ++n},_sanitizeSelector:function(a){return a.replace(/:/g,"\\:")},_cookie:function(){var a=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++o);return d.cookie.apply(null,[a].concat(d.makeArray(arguments)))},_ui:function(a,d){return{tab:a,panel:d,index:this.anchors.index(a)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var a=
d(this);a.html(a.data("label.tabs")).removeData("label.tabs")})},_tabify:function(a){function e(b,a){b.css("display","");!d.support.opacity&&a.opacity&&b[0].style.removeAttribute("filter")}var b=this,c=this.options,g=/^#.+/;this.list=this.element.find("ol,ul").eq(0);this.lis=d(" > li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return d("a",this)[0]});this.panels=d([]);this.anchors.each(function(a,e){var h=d(e).attr("href"),f=h.split("#")[0],k;if(f&&(f===location.toString().split("#")[0]||
(k=d("base")[0])&&f===k.href))h=e.hash,e.href=h;g.test(h)?b.panels=b.panels.add(b.element.find(b._sanitizeSelector(h))):h&&"#"!==h?(d.data(e,"href.tabs",h),d.data(e,"load.tabs",h.replace(/#.*$/,"")),h=b._tabId(e),e.href="#"+h,f=b.element.find("#"+h),f.length||(f=d(c.panelTemplate).attr("id",h).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(b.panels[a-1]||b.list),f.data("destroy.tabs",!0)),b.panels=b.panels.add(f)):c.disabled.push(a)});a?(this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"),
this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"),this.lis.addClass("ui-state-default ui-corner-top"),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"),void 0===c.selected?(location.hash&&this.anchors.each(function(b,a){if(a.hash==location.hash)return c.selected=b,!1}),"number"!==typeof c.selected&&c.cookie&&(c.selected=parseInt(b._cookie(),10)),"number"!==typeof c.selected&&this.lis.filter(".ui-tabs-selected").length&&(c.selected=
this.lis.index(this.lis.filter(".ui-tabs-selected"))),c.selected=c.selected||(this.lis.length?0:-1)):null===c.selected&&(c.selected=-1),c.selected=0<=c.selected&&this.anchors[c.selected]||0>c.selected?c.selected:0,c.disabled=d.unique(c.disabled.concat(d.map(this.lis.filter(".ui-state-disabled"),function(a){return b.lis.index(a)}))).sort(),-1!=d.inArray(c.selected,c.disabled)&&c.disabled.splice(d.inArray(c.selected,c.disabled),1),this.panels.addClass("ui-tabs-hide"),this.lis.removeClass("ui-tabs-selected ui-state-active"),
0<=c.selected&&this.anchors.length&&(b.element.find(b._sanitizeSelector(b.anchors[c.selected].hash)).removeClass("ui-tabs-hide"),this.lis.eq(c.selected).addClass("ui-tabs-selected ui-state-active"),b.element.queue("tabs",function(){b._trigger("show",null,b._ui(b.anchors[c.selected],b.element.find(b._sanitizeSelector(b.anchors[c.selected].hash))[0]))}),this.load(c.selected)),d(window).bind("unload",function(){b.lis.add(b.anchors).unbind(".tabs");b.lis=b.anchors=b.panels=null})):c.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"));
this.element[c.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");c.cookie&&this._cookie(c.selected,c.cookie);for(var a=0,f;f=this.lis[a];a++)d(f)[-1!=d.inArray(a,c.disabled)&&!d(f).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled");!1===c.cache&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if("mouseover"!==c.event){var k=function(b,a){a.is(":not(.ui-state-disabled)")&&a.addClass("ui-state-"+b)};this.lis.bind("mouseover.tabs",
function(){k("hover",d(this))});this.lis.bind("mouseout.tabs",function(){d(this).removeClass("ui-state-hover")});this.anchors.bind("focus.tabs",function(){k("focus",d(this).closest("li"))});this.anchors.bind("blur.tabs",function(){d(this).closest("li").removeClass("ui-state-focus")})}var j,i;c.fx&&(d.isArray(c.fx)?(j=c.fx[0],i=c.fx[1]):j=i=c.fx);var l=i?function(a,c){d(a).closest("li").addClass("ui-tabs-selected ui-state-active");c.hide().removeClass("ui-tabs-hide").animate(i,i.duration||"normal",
function(){e(c,i);b._trigger("show",null,b._ui(a,c[0]))})}:function(a,c){d(a).closest("li").addClass("ui-tabs-selected ui-state-active");c.removeClass("ui-tabs-hide");b._trigger("show",null,b._ui(a,c[0]))},m=j?function(a,c){c.animate(j,j.duration||"normal",function(){b.lis.removeClass("ui-tabs-selected ui-state-active");c.addClass("ui-tabs-hide");e(c,j);b.element.dequeue("tabs")})}:function(a,c){b.lis.removeClass("ui-tabs-selected ui-state-active");c.addClass("ui-tabs-hide");b.element.dequeue("tabs")};
this.anchors.bind(c.event+".tabs",function(){var a=this,e=d(a).closest("li"),f=b.panels.filter(":not(.ui-tabs-hide)"),g=b.element.find(b._sanitizeSelector(a.hash));if(e.hasClass("ui-tabs-selected")&&!c.collapsible||e.hasClass("ui-state-disabled")||e.hasClass("ui-state-processing")||b.panels.filter(":animated").length||b._trigger("select",null,b._ui(this,g[0]))===false){this.blur();return false}c.selected=b.anchors.index(this);b.abort();if(c.collapsible){if(e.hasClass("ui-tabs-selected")){c.selected=
-1;c.cookie&&b._cookie(c.selected,c.cookie);b.element.queue("tabs",function(){m(a,f)}).dequeue("tabs");this.blur();return false}if(!f.length){c.cookie&&b._cookie(c.selected,c.cookie);b.element.queue("tabs",function(){l(a,g)});b.load(b.anchors.index(this));this.blur();return false}}c.cookie&&b._cookie(c.selected,c.cookie);if(g.length){f.length&&b.element.queue("tabs",function(){m(a,f)});b.element.queue("tabs",function(){l(a,g)});b.load(b.anchors.index(this))}else throw"jQuery UI Tabs: Mismatching fragment identifier.";
d.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return false})},_getIndex:function(a){"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']")));return a},destroy:function(){var a=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var a=
d.data(this,"href.tabs");a&&(this.href=a);var b=d(this).unbind(".tabs");d.each(["href","load","cache"],function(a,d){b.removeData(d+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){d.data(this,"destroy.tabs")?d(this).remove():d(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});a.cookie&&this._cookie(null,a.cookie);return this},add:function(a,
e,b){void 0===b&&(b=this.anchors.length);var c=this,g=this.options,e=d(g.tabTemplate.replace(/#\{href\}/g,a).replace(/#\{label\}/g,e)),a=!a.indexOf("#")?a.replace("#",""):this._tabId(d("a",e)[0]);e.addClass("ui-state-default ui-corner-top").data("destroy.tabs",!0);var f=c.element.find("#"+a);f.length||(f=d(g.panelTemplate).attr("id",a).data("destroy.tabs",!0));f.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");b>=this.lis.length?(e.appendTo(this.list),f.appendTo(this.list[0].parentNode)):
(e.insertBefore(this.lis[b]),f.insertBefore(this.panels[b]));g.disabled=d.map(g.disabled,function(a){return a>=b?++a:a});this._tabify();1==this.anchors.length&&(g.selected=0,e.addClass("ui-tabs-selected ui-state-active"),f.removeClass("ui-tabs-hide"),this.element.queue("tabs",function(){c._trigger("show",null,c._ui(c.anchors[0],c.panels[0]))}),this.load(0));this._trigger("add",null,this._ui(this.anchors[b],this.panels[b]));return this},remove:function(a){var a=this._getIndex(a),e=this.options,b=this.lis.eq(a).remove(),
c=this.panels.eq(a).remove();b.hasClass("ui-tabs-selected")&&1<this.anchors.length&&this.select(a+(a+1<this.anchors.length?1:-1));e.disabled=d.map(d.grep(e.disabled,function(b){return b!=a}),function(b){return b>=a?--b:b});this._tabify();this._trigger("remove",null,this._ui(b.find("a")[0],c[0]));return this},enable:function(a){var a=this._getIndex(a),e=this.options;if(-1!=d.inArray(a,e.disabled))return this.lis.eq(a).removeClass("ui-state-disabled"),e.disabled=d.grep(e.disabled,function(b){return b!=
a}),this._trigger("enable",null,this._ui(this.anchors[a],this.panels[a])),this},disable:function(a){var a=this._getIndex(a),d=this.options;a!=d.selected&&(this.lis.eq(a).addClass("ui-state-disabled"),d.disabled.push(a),d.disabled.sort(),this._trigger("disable",null,this._ui(this.anchors[a],this.panels[a])));return this},select:function(a){a=this._getIndex(a);if(-1==a)if(this.options.collapsible&&-1!=this.options.selected)a=this.options.selected;else return this;this.anchors.eq(a).trigger(this.options.event+
".tabs");return this},load:function(a){var a=this._getIndex(a),e=this,b=this.options,c=this.anchors.eq(a)[0],g=d.data(c,"load.tabs");this.abort();if(!g||0!==this.element.queue("tabs").length&&d.data(c,"cache.tabs"))this.element.dequeue("tabs");else{this.lis.eq(a).addClass("ui-state-processing");if(b.spinner){var f=d("span",c);f.data("label.tabs",f.html()).html(b.spinner)}this.xhr=d.ajax(d.extend({},b.ajaxOptions,{url:g,success:function(f,g){e.element.find(e._sanitizeSelector(c.hash)).html(f);e._cleanup();
b.cache&&d.data(c,"cache.tabs",!0);e._trigger("load",null,e._ui(e.anchors[a],e.panels[a]));try{b.ajaxOptions.success(f,g)}catch(i){}},error:function(d,f){e._cleanup();e._trigger("load",null,e._ui(e.anchors[a],e.panels[a]));try{b.ajaxOptions.error(d,f,a,c)}catch(g){}}}));e.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(!1,!0);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));this.xhr&&(this.xhr.abort(),delete this.xhr);this._cleanup();
return this},url:function(a,d){this.anchors.eq(a).removeData("cache.tabs").data("load.tabs",d);return this},length:function(){return this.anchors.length}});d.extend(d.ui.tabs,{version:"1.8.24"});d.extend(d.ui.tabs.prototype,{rotation:null,rotate:function(a,d){var b=this,c=this.options,g=b._rotate||(b._rotate=function(d){clearTimeout(b.rotation);b.rotation=setTimeout(function(){var a=c.selected;b.select(++a<b.anchors.length?a:0)},a);d&&d.stopPropagation()}),f=b._unrotate||(b._unrotate=!d?function(a){a.clientX&&
b.rotate(null)}:function(){g()});a?(this.element.bind("tabsshow",g),this.anchors.bind(c.event+".tabs",f),g()):(clearTimeout(b.rotation),this.element.unbind("tabsshow",g),this.anchors.unbind(c.event+".tabs",f),delete this._rotate,delete this._unrotate);return this}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.core.js' */
jQuery.effects||function(d){function l(a){var b;return a&&a.constructor==Array&&3==a.length?a:(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))?[parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10)]:(b=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a))?[2.55*parseFloat(b[1]),2.55*parseFloat(b[2]),2.55*parseFloat(b[3])]:(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?[parseInt(b[1],16),parseInt(b[2],
16),parseInt(b[3],16)]:(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))?[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]:/rgba\(0, 0, 0, 0\)/.exec(a)?m.transparent:m[d.trim(a).toLowerCase()]}function n(){var a=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,b={},c,d;if(a&&a.length&&a[0]&&a[a[0]])for(var f=a.length;f--;)c=a[f],"string"==typeof a[c]&&(d=c.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),b[d]=a[c]);else for(c in a)"string"===
typeof a[c]&&(b[c]=a[c]);return b}function o(a){var b,c;for(b in a)c=a[b],(null==c||d.isFunction(c)||b in q||/scrollbar/.test(b)||!/color/i.test(b)&&isNaN(parseFloat(c)))&&delete a[b];return a}function r(a,b){var c={_:0},d;for(d in b)a[d]!=b[d]&&(c[d]=b[d]);return c}function i(a,b,c,e){"object"==typeof a&&(e=b,c=null,b=a,a=b.effect);d.isFunction(b)&&(e=b,c=null,b={});if("number"==typeof b||d.fx.speeds[b])e=c,c=b,b={};d.isFunction(c)&&(e=c,c=null);b=b||{};c=c||b.duration;c=d.fx.off?0:"number"==typeof c?
c:c in d.fx.speeds?d.fx.speeds[c]:d.fx.speeds._default;e=e||b.complete;return[a,b,c,e]}function j(a){return!a||("number"===typeof a||d.fx.speeds[a])||"string"===typeof a&&!d.effects[a]?!0:!1}d.effects={};d.each("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor borderColor color outlineColor".split(" "),function(a,b){d.fx.step[b]=function(a){if(!a.colorInit){var e;e=a.elem;var f=b,g;do{g=(d.curCSS||d.css)(e,f);if(g!=""&&g!="transparent"||d.nodeName(e,"body"))break;
f="backgroundColor"}while(e=e.parentNode);e=l(g);a.start=e;a.end=l(a.end);a.colorInit=true}a.elem.style[b]="rgb("+Math.max(Math.min(parseInt(a.pos*(a.end[0]-a.start[0])+a.start[0],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[1]-a.start[1])+a.start[1],10),255),0)+","+Math.max(Math.min(parseInt(a.pos*(a.end[2]-a.start[2])+a.start[2],10),255),0)+")"}});var m={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,
0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,
255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},p=["add","remove","toggle"],q={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};d.effects.animateClass=function(a,b,c,e){d.isFunction(c)&&(e=c,c=null);return this.queue(function(){var f=
d(this),g=f.attr("style")||" ",h=o(n.call(this)),i,j=f.attr("class")||"";d.each(p,function(b,c){if(a[c])f[c+"Class"](a[c])});i=o(n.call(this));f.attr("class",j);f.animate(r(h,i),{queue:false,duration:b,easing:c,complete:function(){d.each(p,function(b,c){if(a[c])f[c+"Class"](a[c])});if(typeof f.attr("style")=="object"){f.attr("style").cssText="";f.attr("style").cssText=g}else f.attr("style",g);e&&e.apply(this,arguments);d.dequeue(this)}})})};d.fn.extend({_addClass:d.fn.addClass,addClass:function(a,
b,c,e){return b?d.effects.animateClass.apply(this,[{add:a},b,c,e]):this._addClass(a)},_removeClass:d.fn.removeClass,removeClass:function(a,b,c,e){return b?d.effects.animateClass.apply(this,[{remove:a},b,c,e]):this._removeClass(a)},_toggleClass:d.fn.toggleClass,toggleClass:function(a,b,c,e,f){return"boolean"==typeof b||void 0===b?c?d.effects.animateClass.apply(this,[b?{add:a}:{remove:a},c,e,f]):this._toggleClass(a,b):d.effects.animateClass.apply(this,[{toggle:a},b,c,e])},switchClass:function(a,b,c,
e,f){return d.effects.animateClass.apply(this,[{add:b,remove:a},c,e,f])}});d.extend(d.effects,{version:"1.8.24",save:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.data("ec.storage."+b[c],a[0].style[b[c]])},restore:function(a,b){for(var c=0;c<b.length;c++)null!==b[c]&&a.css(b[c],a.data("ec.storage."+b[c]))},setMode:function(a,b){"toggle"==b&&(b=a.is(":hidden")?"show":"hide");return b},getBaseline:function(a,b){var c,d;switch(a[0]){case "top":c=0;break;case "middle":c=0.5;break;case "bottom":c=
1;break;default:c=a[0]/b.height}switch(a[1]){case "left":d=0;break;case "center":d=0.5;break;case "right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(a){if(a.parent().is(".ui-effects-wrapper"))return a.parent();var b={width:a.outerWidth(!0),height:a.outerHeight(!0),"float":a.css("float")},c=d("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e=document.activeElement;try{e.id}catch(f){e=document.body}a.wrap(c);
(a[0]===e||d.contains(a[0],e))&&d(e).focus();c=a.parent();"static"==a.css("position")?(c.css({position:"relative"}),a.css({position:"relative"})):(d.extend(b,{position:a.css("position"),zIndex:a.css("z-index")}),d.each(["top","left","bottom","right"],function(c,d){b[d]=a.css(d);isNaN(parseInt(b[d],10))&&(b[d]="auto")}),a.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"}));return c.css(b).show()},removeWrapper:function(a){var b,c=document.activeElement;return a.parent().is(".ui-effects-wrapper")?
(b=a.parent().replaceWith(a),(a[0]===c||d.contains(a[0],c))&&d(c).focus(),b):a},setTransition:function(a,b,c,e){e=e||{};d.each(b,function(b,d){var h=a.cssUnit(d);0<h[0]&&(e[d]=h[0]*c+h[1])});return e}});d.fn.extend({effect:function(a,b,c,e){var f=i.apply(this,arguments),g={options:f[1],duration:f[2],callback:f[3]},f=g.options.mode,h=d.effects[a];return d.fx.off||!h?f?this[f](g.duration,g.callback):this.each(function(){g.callback&&g.callback.call(this)}):h.call(this,g)},_show:d.fn.show,show:function(a){if(j(a))return this._show.apply(this,
arguments);var b=i.apply(this,arguments);b[1].mode="show";return this.effect.apply(this,b)},_hide:d.fn.hide,hide:function(a){if(j(a))return this._hide.apply(this,arguments);var b=i.apply(this,arguments);b[1].mode="hide";return this.effect.apply(this,b)},__toggle:d.fn.toggle,toggle:function(a){if(j(a)||"boolean"===typeof a||d.isFunction(a))return this.__toggle.apply(this,arguments);var b=i.apply(this,arguments);b[1].mode="toggle";return this.effect.apply(this,b)},cssUnit:function(a){var b=this.css(a),
c=[];d.each(["em","px","%","pt"],function(a,d){0<b.indexOf(d)&&(c=[parseFloat(b),d])});return c}});var k={};d.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,b){k[b]=function(b){return Math.pow(b,a+2)}});d.extend(k,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;a<((b=Math.pow(2,
--c))-1)/11;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}});d.each(k,function(a,b){d.easing["easeIn"+a]=b;d.easing["easeOut"+a]=function(a){return 1-b(1-a)};d.easing["easeInOut"+a]=function(a){return 0.5>a?b(2*a)/2:b(-2*a+2)/-2+1}})}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.blind.js' */
(function(b){b.effects.blind=function(c){return this.queue(function(){var a=b(this),g=["position","top","bottom","left","right"],f=b.effects.setMode(a,c.options.mode||"hide"),d=c.options.direction||"vertical";b.effects.save(a,g);a.show();var e=b.effects.createWrapper(a).css({overflow:"hidden"}),h="vertical"==d?"height":"width",d="vertical"==d?e.height():e.width();"show"==f&&e.css(h,0);var i={};i[h]="show"==f?d:0;e.animate(i,c.duration,c.options.easing,function(){"hide"==f&&a.hide();b.effects.restore(a,
g);b.effects.removeWrapper(a);c.callback&&c.callback.apply(a[0],arguments);a.dequeue()})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.bounce.js' */
(function(e){e.effects.bounce=function(b){return this.queue(function(){var a=e(this),l=["position","top","bottom","left","right"],h=e.effects.setMode(a,b.options.mode||"effect"),d=b.options.direction||"up",c=b.options.distance||20,m=b.options.times||5,i=b.duration||250;/show|hide/.test(h)&&l.push("opacity");e.effects.save(a,l);a.show();e.effects.createWrapper(a);var f="up"==d||"down"==d?"top":"left",d="up"==d||"left"==d?"pos":"neg",c=b.options.distance||("top"==f?a.outerHeight(!0)/3:a.outerWidth(!0)/
3);"show"==h&&a.css("opacity",0).css(f,"pos"==d?-c:c);"hide"==h&&(c/=2*m);"hide"!=h&&m--;if("show"==h){var g={opacity:1};g[f]=("pos"==d?"+=":"-=")+c;a.animate(g,i/2,b.options.easing);c/=2;m--}for(g=0;g<m;g++){var j={},k={};j[f]=("pos"==d?"-=":"+=")+c;k[f]=("pos"==d?"+=":"-=")+c;a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing);c="hide"==h?2*c:c/2}"hide"==h?(g={opacity:0},g[f]=("pos"==d?"-=":"+=")+c,a.animate(g,i/2,b.options.easing,function(){a.hide();e.effects.restore(a,l);e.effects.removeWrapper(a);
b.callback&&b.callback.apply(this,arguments)})):(j={},k={},j[f]=("pos"==d?"-=":"+=")+c,k[f]=("pos"==d?"+=":"-=")+c,a.animate(j,i/2,b.options.easing).animate(k,i/2,b.options.easing,function(){e.effects.restore(a,l);e.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments)}));a.queue("fx",function(){a.dequeue()});a.dequeue()})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.clip.js' */
(function(b){b.effects.clip=function(e){return this.queue(function(){var a=b(this),h="position top bottom left right height width".split(" "),f=b.effects.setMode(a,e.options.mode||"hide"),c=e.options.direction||"vertical";b.effects.save(a,h);a.show();var d=b.effects.createWrapper(a).css({overflow:"hidden"}),d="IMG"==a[0].tagName?d:a,i="vertical"==c?"height":"width",j="vertical"==c?"top":"left",c="vertical"==c?d.height():d.width();"show"==f&&(d.css(i,0),d.css(j,c/2));var g={};g[i]="show"==f?c:0;g[j]=
"show"==f?0:c/2;d.animate(g,{queue:!1,duration:e.duration,easing:e.options.easing,complete:function(){f=="hide"&&a.hide();b.effects.restore(a,h);b.effects.removeWrapper(a);e.callback&&e.callback.apply(a[0],arguments);a.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.drop.js' */
(function(c){c.effects.drop=function(d){return this.queue(function(){var a=c(this),h="position top bottom left right opacity".split(" "),e=c.effects.setMode(a,d.options.mode||"hide"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a);var f="up"==b||"down"==b?"top":"left",b="up"==b||"left"==b?"pos":"neg",g=d.options.distance||("top"==f?a.outerHeight(!0)/2:a.outerWidth(!0)/2);"show"==e&&a.css("opacity",0).css(f,"pos"==b?-g:g);var i={opacity:"show"==e?1:0};i[f]=("show"==
e?"pos"==b?"+=":"-=":"pos"==b?"-=":"+=")+g;a.animate(i,{queue:!1,duration:d.duration,easing:d.options.easing,complete:function(){"hide"==e&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.explode.js' */
(function(j){j.effects.explode=function(a){return this.queue(function(){var c=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3,d=a.options.pieces?Math.round(Math.sqrt(a.options.pieces)):3;a.options.mode="toggle"==a.options.mode?j(this).is(":visible")?"hide":"show":a.options.mode;var b=j(this).show().css("visibility","hidden"),e=b.offset();e.top-=parseInt(b.css("marginTop"),10)||0;e.left-=parseInt(b.css("marginLeft"),10)||0;for(var h=b.outerWidth(!0),i=b.outerHeight(!0),f=0;f<c;f++)for(var g=
0;g<d;g++)b.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*(h/d),top:-f*(i/c)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:h/d,height:i/c,left:e.left+g*(h/d)+("show"==a.options.mode?(g-Math.floor(d/2))*(h/d):0),top:e.top+f*(i/c)+("show"==a.options.mode?(f-Math.floor(c/2))*(i/c):0),opacity:"show"==a.options.mode?0:1}).animate({left:e.left+g*(h/d)+("show"==a.options.mode?0:(g-Math.floor(d/2))*(h/d)),top:e.top+
f*(i/c)+("show"==a.options.mode?0:(f-Math.floor(c/2))*(i/c)),opacity:"show"==a.options.mode?1:0},a.duration||500);setTimeout(function(){"show"==a.options.mode?b.css({visibility:"visible"}):b.css({visibility:"visible"}).hide();a.callback&&a.callback.apply(b[0]);b.dequeue();j("div.ui-effects-explode").remove()},a.duration||500)})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.fade.js' */
(function(b){b.effects.fade=function(a){return this.queue(function(){var c=b(this),d=b.effects.setMode(c,a.options.mode||"hide");c.animate({opacity:d},{queue:!1,duration:a.duration,easing:a.options.easing,complete:function(){a.callback&&a.callback.apply(this,arguments);c.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.fold.js' */
(function(c){c.effects.fold=function(a){return this.queue(function(){var b=c(this),j=["position","top","bottom","left","right"],d=c.effects.setMode(b,a.options.mode||"hide"),g=a.options.size||15,h=!!a.options.horizFirst,k=a.duration?a.duration/2:c.fx.speeds._default/2;c.effects.save(b,j);b.show();var e=c.effects.createWrapper(b).css({overflow:"hidden"}),f="show"==d!=h,l=f?["width","height"]:["height","width"],f=f?[e.width(),e.height()]:[e.height(),e.width()],i=/([0-9]+)%/.exec(g);i&&(g=parseInt(i[1],
10)/100*f["hide"==d?0:1]);"show"==d&&e.css(h?{height:0,width:g}:{height:g,width:0});h={};i={};h[l[0]]="show"==d?f[0]:g;i[l[1]]="show"==d?f[1]:0;e.animate(h,k,a.options.easing).animate(i,k,a.options.easing,function(){"hide"==d&&b.hide();c.effects.restore(b,j);c.effects.removeWrapper(b);a.callback&&a.callback.apply(b[0],arguments);b.dequeue()})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.highlight.js' */
(function(b){b.effects.highlight=function(c){return this.queue(function(){var a=b(this),e=["backgroundImage","backgroundColor","opacity"],d=b.effects.setMode(a,c.options.mode||"show"),f={backgroundColor:a.css("backgroundColor")};"hide"==d&&(f.opacity=0);b.effects.save(a,e);a.show().css({backgroundImage:"none",backgroundColor:c.options.color||"#ffff99"}).animate(f,{queue:!1,duration:c.duration,easing:c.options.easing,complete:function(){d=="hide"&&a.hide();b.effects.restore(a,e);d=="show"&&!b.support.opacity&&
this.style.removeAttribute("filter");c.callback&&c.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.pulsate.js' */
(function(e){e.effects.pulsate=function(a){return this.queue(function(){var b=e(this),d=e.effects.setMode(b,a.options.mode||"show"),g=2*(a.options.times||5)-1,h=a.duration?a.duration/2:e.fx.speeds._default/2,f=b.is(":visible"),c=0;f||(b.css("opacity",0).show(),c=1);("hide"==d&&f||"show"==d&&!f)&&g--;for(d=0;d<g;d++)b.animate({opacity:c},h,a.options.easing),c=(c+1)%2;b.animate({opacity:c},h,a.options.easing,function(){c==0&&b.hide();a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()}).dequeue()})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.scale.js' */
(function(c){c.effects.puff=function(b){return this.queue(function(){var a=c(this),d=c.effects.setMode(a,b.options.mode||"hide"),e=parseInt(b.options.percent,10)||150,i=e/100,g={height:a.height(),width:a.width()};c.extend(b.options,{fade:!0,mode:d,percent:"hide"==d?e:100,from:"hide"==d?g:{height:g.height*i,width:g.width*i}});a.effect("scale",b.options,b.duration,b.callback);a.dequeue()})};c.effects.scale=function(b){return this.queue(function(){var a=c(this),d=c.extend(!0,{},b.options),e=c.effects.setMode(a,
b.options.mode||"effect"),i=parseInt(b.options.percent,10)||(0==parseInt(b.options.percent,10)?0:"hide"==e?0:100),g=b.options.direction||"both",f=b.options.origin;"effect"!=e&&(d.origin=f||["middle","center"],d.restore=!0);f={height:a.height(),width:a.width()};a.from=b.options.from||("show"==e?{height:0,width:0}:f);a.to={height:f.height*("horizontal"!=g?i/100:1),width:f.width*("vertical"!=g?i/100:1)};if(b.options.fade&&("show"==e&&(a.from.opacity=0,a.to.opacity=1),"hide"==e))a.from.opacity=1,a.to.opacity=
0;d.from=a.from;d.to=a.to;d.mode=e;a.effect("size",d,b.duration,b.callback);a.dequeue()})};c.effects.size=function(b){return this.queue(function(){var a=c(this),d="position top bottom left right width height overflow opacity".split(" "),e="position top bottom left right overflow opacity".split(" "),i=["width","height","overflow"],g=["fontSize"],f=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],j=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],r=c.effects.setMode(a,
b.options.mode||"effect"),q=b.options.restore||!1,n=b.options.scale||"both",k=b.options.origin,h={height:a.height(),width:a.width()};a.from=b.options.from||h;a.to=b.options.to||h;k&&(k=c.effects.getBaseline(k,h),a.from.top=(h.height-a.from.height)*k.y,a.from.left=(h.width-a.from.width)*k.x,a.to.top=(h.height-a.to.height)*k.y,a.to.left=(h.width-a.to.width)*k.x);var l=a.from.height/h.height,o=a.from.width/h.width,m=a.to.height/h.height,p=a.to.width/h.width;if("box"==n||"both"==n)if(l!=m&&(d=d.concat(f),
a.from=c.effects.setTransition(a,f,l,a.from),a.to=c.effects.setTransition(a,f,m,a.to)),o!=p)d=d.concat(j),a.from=c.effects.setTransition(a,j,o,a.from),a.to=c.effects.setTransition(a,j,p,a.to);if(("content"==n||"both"==n)&&l!=m)d=d.concat(g),a.from=c.effects.setTransition(a,g,l,a.from),a.to=c.effects.setTransition(a,g,m,a.to);c.effects.save(a,q?d:e);a.show();c.effects.createWrapper(a);a.css("overflow","hidden").css(a.from);if("content"==n||"both"==n)f=f.concat(["marginTop","marginBottom"]).concat(g),
j=j.concat(["marginLeft","marginRight"]),i=d.concat(f).concat(j),a.find("*[width]").each(function(){var a=c(this);q&&c.effects.save(a,i);var d=a.height(),e=a.width();a.from={height:d*l,width:e*o};a.to={height:d*m,width:e*p};if(l!=m){a.from=c.effects.setTransition(a,f,l,a.from);a.to=c.effects.setTransition(a,f,m,a.to)}if(o!=p){a.from=c.effects.setTransition(a,j,o,a.from);a.to=c.effects.setTransition(a,j,p,a.to)}a.css(a.from);a.animate(a.to,b.duration,b.options.easing,function(){q&&c.effects.restore(a,
i)})});a.animate(a.to,{queue:!1,duration:b.duration,easing:b.options.easing,complete:function(){a.to.opacity===0&&a.css("opacity",a.from.opacity);r=="hide"&&a.hide();c.effects.restore(a,q?d:e);c.effects.removeWrapper(a);b.callback&&b.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.shake.js' */
(function(d){d.effects.shake=function(a){return this.queue(function(){var b=d(this),j=["position","top","bottom","left","right"];d.effects.setMode(b,a.options.mode||"effect");var c=a.options.direction||"left",e=a.options.distance||20,l=a.options.times||3,f=a.duration||a.options.duration||140;d.effects.save(b,j);b.show();d.effects.createWrapper(b);var g="up"==c||"down"==c?"top":"left",h="up"==c||"left"==c?"pos":"neg",c={},i={},k={};c[g]=("pos"==h?"-=":"+=")+e;i[g]=("pos"==h?"+=":"-=")+2*e;k[g]=("pos"==
h?"-=":"+=")+2*e;b.animate(c,f,a.options.easing);for(e=1;e<l;e++)b.animate(i,f,a.options.easing).animate(k,f,a.options.easing);b.animate(i,f,a.options.easing).animate(c,f/2,a.options.easing,function(){d.effects.restore(b,j);d.effects.removeWrapper(b);a.callback&&a.callback.apply(this,arguments)});b.queue("fx",function(){b.dequeue()});b.dequeue()})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.slide.js' */
(function(c){c.effects.slide=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right"],f=c.effects.setMode(a,d.options.mode||"show"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a).css({overflow:"hidden"});var g="up"==b||"down"==b?"top":"left",b="up"==b||"left"==b?"pos":"neg",e=d.options.distance||("top"==g?a.outerHeight(!0):a.outerWidth(!0));"show"==f&&a.css(g,"pos"==b?isNaN(e)?"-"+e:-e:e);var i={};i[g]=("show"==f?"pos"==
b?"+=":"-=":"pos"==b?"-=":"+=")+e;a.animate(i,{queue:!1,duration:d.duration,easing:d.options.easing,complete:function(){"hide"==f&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-effects', location = 'src/js-vendor/jquery/jquery-ui/jquery.effects.transfer.js' */
(function(e){e.effects.transfer=function(a){return this.queue(function(){var b=e(this),c=e(a.options.to),d=c.offset(),c={top:d.top,left:d.left,height:c.innerHeight(),width:c.innerWidth()},d=b.offset(),f=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.options.className).css({top:d.top,left:d.left,height:b.innerHeight(),width:b.innerWidth(),position:"absolute"}).animate(c,a.duration,a.options.easing,function(){f.remove();a.callback&&a.callback.apply(b[0],arguments);b.dequeue()})})}})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:jquery-ui-other', location = 'src/js-vendor/jquery/jquery.ui.menu.js' */
(function(d){d.widget("ui.menu",{_create:function(){var a=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(b){d(b.target).closest(".ui-menu-item a").length&&(b.preventDefault(),a.select(b))});this.refresh()},refresh:function(){var a=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",
-1).mouseenter(function(b){a.activate(b,d(this).parent())}).mouseleave(function(){a.deactivate()})},activate:function(a,b){this.deactivate();if(this.hasScroll()){var c=b.offset().top-this.element.offset().top,e=this.element.attr("scrollTop"),d=this.element.height();0>c?this.element.attr("scrollTop",e+c):c>d&&this.element.attr("scrollTop",e+c-d+b.height())}this.active=b.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",a,{item:b})},deactivate:function(){this.active&&
(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(a){this.move("next",".ui-menu-item:first",a)},previous:function(a){this.move("prev",".ui-menu-item:last",a)},first:function(){return this.active&&!this.active.prev().length},last:function(){return this.active&&!this.active.next().length},move:function(a,b,c){this.active?(a=this.active[a+"All"](".ui-menu-item").eq(0),a.length?this.activate(c,a):this.activate(c,this.element.children(b))):
this.activate(c,this.element.children(b))},nextPage:function(a){if(this.hasScroll())if(!this.active||this.last())this.activate(a,this.element.children(":first"));else{var b=this.active.offset().top,c=this.element.height(),e=this.element.children("li").filter(function(){var a=d(this).offset().top-b-c+d(this).height();return 10>a&&-10<a});e.length||(e=this.element.children(":last"));this.activate(a,e)}else this.activate(a,this.element.children(!this.active||this.last()?":first":":last"))},previousPage:function(a){if(this.hasScroll())if(!this.active||
this.first())this.activate(a,this.element.children(":last"));else{var b=this.active.offset().top,c=this.element.height();result=this.element.children("li").filter(function(){var a=d(this).offset().top-b+c-d(this).height();return 10>a&&-10<a});result.length||(result=this.element.children(":first"));this.activate(a,result)}else this.activate(a,this.element.children(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(a){this._trigger("selected",
a,{item:this.active})}})})(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Roadmap.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<div class="roadmap-editor-popup"><div id=\'' + soy.$$escapeHtml(opt_data.roadmapPopupPanelId) + '\'></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapPopupPanel';
}


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_ignored) {
  return '<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.roadmapEditor.soyTemplateName = 'Confluence.Templates.Roadmap.roadmapEditor';
}


Confluence.Templates.Roadmap.lane = function(opt_data, opt_ignored) {
  return '<div class="roadmap-lane-title" style="background-color: ' + soy.$$escapeHtml(opt_data.color.lane) + '; color: ' + soy.$$escapeHtml(opt_data.color.text) + '" title="' + soy.$$escapeHtml(opt_data.title) + '"><div class="title-outer"><div class="title-inner">' + soy.$$escapeHtml(opt_data.title) + '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.lane.soyTemplateName = 'Confluence.Templates.Roadmap.lane';
}


Confluence.Templates.Roadmap.marker = function(opt_data, opt_ignored) {
  return '<div class="marker-drag-placeholder"></div><div class="marker-title-wrapper"><span class="marker-title" title="' + soy.$$escapeHtml(opt_data.title) + '">' + soy.$$escapeHtml(opt_data.title) + '</span></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.marker.soyTemplateName = 'Confluence.Templates.Roadmap.marker';
}


Confluence.Templates.Roadmap.bar = function(opt_data, opt_ignored) {
  return '<p class="roadmap-bar-title">' + soy.$$escapeHtml(opt_data.title) + '</p>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.bar.soyTemplateName = 'Confluence.Templates.Roadmap.bar';
}


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_ignored) {
  return '<hr class="new-row-line" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowLine.soyTemplateName = 'Confluence.Templates.Roadmap.newRowLine';
}


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_ignored) {
  return '<section role="dialog" id="' + soy.$$escapeHtml(opt_data.id) + '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Macro unavailable') + '</h1></header><div class="aui-dialog2-content">' + soy.$$filterNoAutoescape('\x3cp\x3eThe roadmap macro has been deprecated as of version 12. You can still view your existing roadmap macros but you will no longer be able to edit them or create new ones.\x3c/p\x3e\x3cp\x3ePlease use our new Roadmap Planner macro to plan your roadmap.\x3c/p\x3e') + '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Close') + '</button></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.deprecationDialog.soyTemplateName = 'Confluence.Templates.Roadmap.deprecationDialog';
}


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_ignored) {
  return '<hr class= "new-row-placeholder" />';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.newRowPlaceholder.soyTemplateName = 'Confluence.Templates.Roadmap.newRowPlaceholder';
}


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Add bar'}, iconClass: 'aui-icon-small aui-iconfont-add'}) + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename lane'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + Confluence.Templates.Roadmap.laneColorSelect(opt_data) + ((opt_data.canDelete) ? aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete lane'}, iconClass: 'aui-icon aui-icon-small aui-iconfont-delete'}) : '');
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneDialog';
}


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_ignored) {
  return '' + aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Rename marker'}, iconClass: 'aui-icon-small aui-iconfont-edit'}) + aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {title: 'Delete marker'}, iconClass: 'aui-icon aui-icon-small aui-iconfont-delete'});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerDialog';
}


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.markerRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.markerRenameDialog';
}


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_ignored) {
  return '' + aui.form.form({action: '', content: '' + aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}) + aui.buttons.button({extraClasses: 'rename-button', text: 'Save'})});
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneRenameDialog.soyTemplateName = 'Confluence.Templates.Roadmap.laneRenameDialog';
}


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_ignored) {
  var output = '<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="' + soy.$$escapeHtml('Lane color') + '"><span class="color-item" style="background-color: ' + soy.$$escapeHtml(opt_data.laneColor) + ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">';
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output += '<li class="color-display-item"><a href="#" ><span class="color-item ' + ((colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '') + '" style="background-color: ' + soy.$$escapeHtml(colorData120.lane) + ';"></span></a></li>';
  }
  output += '</ul></div>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.laneColorSelect.soyTemplateName = 'Confluence.Templates.Roadmap.laneColorSelect';
}


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_ignored) {
  return '<span class="link-page-title" ></span>';
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.linkPageTitle.soyTemplateName = 'Confluence.Templates.Roadmap.linkPageTitle';
}


Confluence.Templates.Roadmap.footerActionContent = function(opt_data, opt_ignored) {
  return '' + ((opt_data.roadmapShouldAutoSave) ? '<span class="autosave-text">' + soy.$$escapeHtml('This roadmap planner autosaves every 15 seconds.') + '</span>' : '') + aui.buttons.button({text: 'Insert', id: 'roadmapInsertBtn'}) + ((opt_data.roadmapShouldAutoSave) ? aui.buttons.button({text: 'Close', type: 'link', id: 'roadmapCloseBtn'}) : aui.buttons.button({text: 'Cancel', type: 'link', id: 'roadmapCancelBtn'}));
};
if (goog.DEBUG) {
  Confluence.Templates.Roadmap.footerActionContent.soyTemplateName = 'Confluence.Templates.Roadmap.footerActionContent';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
/**
 * Currently InlineDialog doesn't support left/right orientation ( will support from version AUI 5.5.1 https://ecosystem.atlassian.net/browse/AUI-2197 )
 * SideInlineDialog has been already implemented and support left/right orientation
 * https://bitbucket.org/atlassianlabs/confluence-roadmap-plugin/src/f7c94dfb23007aa7fd0458af5e6128cdeacc6338/src/main/resources/js/SideInlineDialog.js?at=master
 * Temporary copied getDimensions & calculatePositions, getArrowPath functions to here with names_getSideDimensions & _calculateSidePositions, _getSideArrowPath
 * TODO update Roadmap InlineDialog use left/right option https://jira.atlassian.com/browse/CONFDEV-25613
 */
(function ($, _) {
    Roadmap.BarView = Backbone.View.extend({
        className: 'roadmap-bar',

        events: {
            'click': '_showDialog',
            'dragstart': '_onDragstart',
            'dragstop': '_onDragStop',
            'dropover': '_onDropOver',
            'dropout': '_onDropOut'
        },

        attributes: function () {
            return {
                cid: this.cid
            };
        },

        initialize: function () {
            _.bindAll(this, 'render', '_updateBar', '_beforeResize', 'updateMaxWidth', '_deleteBar', '_updateTitle');

            this._addEvents();
        },

        _addEvents: function () {
            var me = this;

            this.$el.draggable({
                opacity: 0.3,
                cursor: "move",
                appendTo: '.roadmap-drag-area',
                snap: '.roadmap-bar-row, .new-bar-row',
                snapMode: 'inner',
                snapTolerance: 17,
                scroll: true,
                zIndex: 4020, // this will prevent the cursor change to resize when drag over two borders left/right
                helper: function () {
                    return me.$el.clone().addClass('roadmap-bar-clone').data('View', me);
                }
            });

            this.$el.droppable({
                accept: '.roadmap-bar',
                tolerance: 'touch',
                hoverClass: 'bar-hover-bar'
            });

            this.$el.data('View', this);

        },

        render: function () {
            this.updateColor(this.options.color);

            var barPosition = this.options.timelineView.getBarPosition(this.model.attributes);
            this.$el.css({
                left: barPosition.left + 'px',
                width: barPosition.width + 'px'
            });
            this.$el.attr('title', this.model.get('title'));

            this.$el.append(
                Confluence.Templates.Roadmap.bar({
                    title: this.model.get('title')
                })
            );

            this.$el.resizable({
                handles: 'e, w',
                minWidth: Roadmap.barMinWidth,
                start: this._beforeResize,
                stop: this._updateBar
            });
            return this;
        },

        updateMaxWidth: function (maxWidth) {
            this.$el.resizable('option', 'maxWidth', maxWidth);

            // min width is always smaller or equal max width
            var minWidth = this.$el.resizable('option', 'minWidth');
            if (maxWidth < minWidth) {
                this.$el.resizable('option', 'minWidth', maxWidth);
            }
        },

        _beforeResize: function (event, barUI) {
            this._barDialog && this._barDialog.remove(); // remove bar dialog before resize
            this.trigger('beforeResize', this, this._checkHandleDirection(event));
        },

        _checkHandleDirection: function (event) {
            var direction = $(event.toElement ? event.toElement : event.originalEvent.target);
            //we only support resize on left and right so don't need to check more
            if (direction.hasClass('ui-resizable-w')) {
                return 'left';
            } else if (direction.hasClass('ui-resizable-e')) {
                return 'right';
            }
            throw "Unsupport resize direction handling = " + direction;
        },

        _updateBar: function (event, barUI) {
            if (barUI.originalPosition.left != barUI.position.left) {
                this.model.set({
                    startDate: this.options.timelineView.getBarStartDate(barUI.position.left),
                    duration: this.options.timelineView.getBarDuration(barUI.element.outerWidth())
                });
            } else if (barUI.originalSize.width != barUI.size.width) {
                this.model.set('duration', this.options.timelineView.getBarDuration(barUI.element.outerWidth()));
            }
        },

        appendTo: function ($container) {
            this.$el.appendTo($container);
        },

        updateColor: function (color) {
            this.$el.css({
                'background-color': color.bar,
                'border-color': color.lane,
                color: color.text
            });
        },

        updatePositionLeft: function (left) {
            this.$el.css('left', left);
        },

        _onDragStop: function (e, ui) {
            this.options.lane.cleanLaneAfterDrop();
            this.$el.trigger('BarView.dragstop');
        },

        /**
         * Update delete function from lane, called when bar is dropped into another lane.
         */
        updateDeleteBar: function (deleteBar) {
            this.options.deleteBar = deleteBar;
        },

        /**
         * Open the 'Bar' dialog.
         * Called when the 'bar' is clicked.
         */
        _showDialog: function (event) {
            if (!$(event.target).is('.ui-resizable-handle')) { // do not show dialog when resize
                this._barDialog && this._barDialog.remove(); // remove existing object if there is any
                this._barDialog = this._createDialog();
                this._barDialog.show();
                Confluence.Roadmap.Analytics.openBarDialogInEdit();
            }
        },

        _createDialog: function () {
            return new Roadmap.BarDialogView({
                trigger: this.$el,
                model: this.model,
                timelineWidth: this.options.timelineView.$el.width(),
                renderOption: {
                    isEditMode: true,
                    editInplace: {
                        title: true,
                        pageLink: true,
                        description: true
                    }
                },
                linkPageEditable: true, // user of course has edit page permission in edit mode
                deleteBar: this._deleteBar,
                updateTitle: this._updateTitle,
                updateDescription: this._updateDescription,
                updatePageLink: this._updatePageLink,
                createLinkPageCallback: this._goToCreateLinkPage
            });
        },

        _deleteBar: function () {
            this.options.deleteBar(this);
        },

        _updateTitle: function (newTitle) {
            this.model.set('title', newTitle);
            this.$el.attr('title', newTitle);
            this.$el.find('.roadmap-bar-title').html(AJS.escapeHtml(newTitle));
        },

        _updateDescription: function (newDescription) {
            this.model.set('description', newDescription);
        },

        _updatePageLink: function (pageLink) {
            this.model.set('pageLink', pageLink);
        },

        _onDragstart: function (e, ui) {
            Roadmap.DragDrop.barDraggingOver = {};
            this.$el.trigger('BarView.dragstart', [ui]);
        },

        _onDropOver: function (e, ui) {
            Roadmap.DragDrop.barDraggingOver[this.cid] = this.cid;
            if (Roadmap.DragDrop.barDraggingOver && ui.helper.data('isAddingNewRow') !== true) {
                ui.helper.addClass('roadmap-bar-overlapped');
            }
        },

        _onDropOut: function (e, ui) {
            var me = this;
            delete Roadmap.DragDrop.barDraggingOver[me.cid];

            ui.helper.removeClass('roadmap-bar-overlapped');

            _.each(Roadmap.DragDrop.barDraggingOver, function (item) {
                var isNotAddingNewRow = ui.helper.data('isAddingNewRow') !== true;

                if (isNotAddingNewRow) {
                    if (typeof item === 'string') { // still over on a bar
                        ui.helper.addClass('roadmap-bar-overlapped');
                    } else if (item.className === 'roadmap-bar-row') { // still in a bar-row
                        item.$el.addClass('roadmap-bar-drag-hover');
                    }
                }
            });
        },

        _goToCreateLinkPage: function (event) {
            event.preventDefault();
            var me = this.me;
            var currentPageId = parseInt(AJS.Meta.get('page-id'));
            var pageId = currentPageId > 0 ? currentPageId : AJS.Meta.get('parent-page-id');
            var linkParam = {
                roadmapBarId: me.model.id,
                roadmapContentId: pageId,
                updateRoadmap: false
            }
            Confluence.RoadmapLink.addCreateLinkPageListener(linkParam, function (barDetail) {
                var $pageLink = me._updatePageLink(barDetail.pageLink);
                me.fields.$pageLink.html($pageLink);
            });
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function ($, _) {
    Roadmap.BarRowView = Backbone.View.extend({
        className: 'roadmap-bar-row',

        initialize: function () {
            _.bindAll(this, '_addEvents');
            this._addEvents();
            return this;
        },

        attributes: function () {
            return {
                cid: this.cid
            };
        },

        _addEvents: function () {
            var me = this;
            this.$el.droppable({
                greedy: true,
                tolerance: 'pointer',
                hoverClass: 'roadmap-bar-drag-hover',
                activeClass: 'roadmap-bar-drag-active',
                accept: '.roadmap-bar',
                over: function (e, ui) {
                    Roadmap.DragDrop.barDraggingOver[me.cid] = me;

                    if (ui.helper.data('isAddingNewRow') !== true) {
                        var $barRow = $(this);
                        $barRow.closest('.roadmap-content').find('.new-row-placeholder').remove();
                    } else {
                        me.$el.removeClass('roadmap-bar-drag-hover');
                    }
                },
                out: function () {
                    var $barRow = $(this);
                    delete Roadmap.DragDrop.barDraggingOver[me.cid];
                    $barRow.closest('.roadmap-content').find('.new-row-placeholder').remove();
                },
                drop: function (e, ui) {
                    var isBarOverlapped = _.reject(Roadmap.DragDrop.barDraggingOver, function (item) {
                        return (typeof item === 'object');
                    }).length > 0;

                    if (!ui.helper.hasClass('roadmap-bar-overlapped') && !isBarOverlapped) {
                        $(this).trigger('BarView.drop', [
                            {
                                $barViewHelper: ui.helper,
                                $barViewOriginal: ui.draggable,
                                $barRow: $(this)
                            },
                            ui
                        ]);
                    }
                }
            });
        },

        isEmptyRow: function () {
            return this.$el.is(':empty');
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function ($, _) {
    Roadmap.BarRowNewView = Backbone.View.extend({
        className: 'new-bar-row',

        overlayTop: 3, // number of pixel that will overlay on bar
        margin: 5, // margin between two bar-rows

        events: {
            drop: '_onDrop',
            dropover: '_onDropOver',
            dropout: '_onDropOut'
        },

        initialize: function () {
            _.bindAll(this, 'render', '_addEvent');

            return this;
        },

        render: function () {
            this.$el.append(Confluence.Templates.Roadmap.newRowLine());
            this._addEvent();
            this._setSizePosition();

            return this;
        },

        _addEvent: function () {
            this.$el.droppable({
                accept: '.roadmap-bar',
                tolerance: 'pointer',
                hoverClass: 'new-bar-row-hover'
            });
        },

        _setSizePosition: function () {
            var $barRow = this.options.$barRow;
            var barRowHeight = this.options.renderBottom === false ? (this.margin * -1) : $barRow.height();
            var isFirstRow = $barRow.index() === 0;
            var overlay = (isFirstRow) ? this.overlayTop + this.margin : this.overlayTop;

            this.$el.css({
                top: $barRow.position().top + barRowHeight - overlay,
                width: $barRow.width()
            });
        },

        _onDrop: function (e, ui) {
            this.$el.trigger('BarView.drop', [{
                barRowNewView: this
            }, ui]);
        },

        _onDropOver: function (e, ui) {
            this.$el.trigger('BarRowNew.dropover', [this, ui]);
        },

        _onDropOut: function (e, ui) {
            this.$el.trigger('BarRowNew.dropout', [this, ui]);
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function ($, _) {
    var InlineDialogView = Roadmap.InlineDialogView;
    Roadmap.LaneDialogView = InlineDialogView.extend({
        events: {
            'click #delete-button': '_onDeleteClick',
            'click #rename-button': '_onRenameClick',
            'click #add-bar-button': '_onAddBarClick'
        },

        initialize: function () {
            _.bindAll(this, '_onHide');
            this.options.dialogOptions = {
                width: this._getDialogWidth(),
                hideCallback: this._onHide
            };
            $('.roadmap-editor-popup, .roadmap-macro-view').scroll(function () {
                $('#lane-color-picker').hide();
            });

            InlineDialogView.prototype.initialize.call(this, this.options);
        },

        /**
         * Get Lane dialog content
         * @param {element} element The inline dialog element.
         * @param {function} showDialog A function that shows the inline dialog.
         */
        _getContent: function (element) {
            var laneColor = this.options.lane.model.get('color').lane;
            element.html(Confluence.Templates.Roadmap.laneDialog({
                canDelete: this.options.canDelete,
                colors: Roadmap.COLORS,
                laneColor: laneColor
            }));

            this.$el.find('.aui-button').tooltip({gravity: 's'});

            var me = this;
            var $colorItems = this.$el.find('#lane-color-picker .color-item');
            $colorItems.click(function (event) {
                event.preventDefault();
                var newColor = Roadmap.COLORS[$colorItems.index(this)];
                if (newColor.lane != laneColor) {
                    me.options.changeColor(newColor);
                }
                $('#lane-color-picker').hide();
                // remove lane dialog after color is selected to match
                // UX of other buttons in the dialog.
                me.remove();
            })
        },

        _getDialogWidth: function () {
            var iconButtonWidth = 29;
            var colorSelectWidth = 51;
            var buttonCount = 2; // currently only has 2 buttons: Add Bar & Rename lane
            if (this.options.canDelete) { // only display delete button when lane can delete
                buttonCount++;
            }
            return buttonCount * iconButtonWidth + colorSelectWidth;
        },

        _onDeleteClick: function () {
            this.options.deleteLane();
            this.remove();
        },

        _onRenameClick: function () {
            if (!this._laneRenameDialog) {
                this._laneRenameDialog = new Roadmap.LaneRenameDialogView({
                    trigger: this.options.trigger,
                    lane: this.options.lane
                });
            }
            this._laneRenameDialog.show();
            this.hide();
        },

        _onAddBarClick: function () {
            this.options.addBar();
            this.remove();
        },

        _onHide: function () {
            $('#lane-color-picker').hide();
            InlineDialogView.prototype._onHide.call(this);
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function ($, _) {
    var InlineDialogView = Roadmap.InlineDialogView;
    Roadmap.LaneRenameDialogView = InlineDialogView.extend({
        events: {
            'click .rename-button': '_onRenameButtonClick',
            'keyup .lane-title': '_onChangeLaneTitle'
        },

        initialize: function () {
            this.options.dialogOptions = {
                width: this._getDialogWidth()
            };

            InlineDialogView.prototype.initialize.call(this, this.options);
        },

        _getContent: function (element) {
            element.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle: this.options.trigger.text()}));

            this.controls = {
                $renameButton: this.$el.find('.rename-button'),
                $laneTitle: this.$el.find('.lane-title')
            };
        },

        _getDialogWidth: function () {
            return 315;
        },

        _onChangeLaneTitle: function (e) {
            var changedTitle = $.trim(this.controls.$laneTitle.val());
            if (!changedTitle) {
                this.controls.$renameButton.disable();
            } else {
                this.controls.$renameButton.enable();
                if (e.which == AJS.$.ui.keyCode.ENTER) {
                    this.controls.$renameButton.click(); //bug in IE only (submit with enter)
                }
            }
        },

        _onShow: function (e) {
            this.controls.$laneTitle.select();
        },

        _onRenameButtonClick: function (event) {
            event.preventDefault();
            this.hide();
            var changedTitle = this.controls.$laneTitle.val();
            this.options.lane.renameTitle(changedTitle);
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function ($, _) {
    var InlineDialogView = Roadmap.InlineDialogView;
    Roadmap.MarkerDialogView = InlineDialogView.extend({
        events: {
            'click #rename-button': '_onRenameButtonClick',
            'click #delete-button': '_onDeleteButtonClick'
        },

        initialize: function () {
            this.options.dialogOptions = {
                width: 60
            };
            InlineDialogView.prototype.initialize.call(this, this.options);
        },

        _getContent: function (element) {
            element.html(Confluence.Templates.Roadmap.markerDialog());
            this.$el.find('.aui-button.aui-button-compact').tooltip({gravity: 's'});
        },

        _onRenameButtonClick: function () {
            if (!this._markerRenameDialog) {
                this._markerRenameDialog = new Roadmap.MarkerRenameDialogView({
                    trigger: this.options.trigger,
                    marker: this.options.marker
                });
            }
            this._markerRenameDialog.show();
            this.hide();
        },

        _onDeleteButtonClick: function () {
            this.options.marker.removeMarker();
            this.hide();
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function ($, _) {
    var InlineDialogView = Roadmap.InlineDialogView;
    Roadmap.MarkerRenameDialogView = InlineDialogView.extend({
        events: {
            'click .rename-button': '_onSaveButtonClick',
            'keyup .marker-title': '_onChangeMarkerTitle'
        },

        initialize: function () {
            this.options.dialogOptions = {
                width: 315
            };
            InlineDialogView.prototype.initialize.call(this, this.options);
        },

        _getContent: function (element) {
            element.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle: this.options.marker.model.get('title')}));
            this.controls = {
                $renameButton: this.$el.find('.rename-button'),
                $title: this.$el.find('.marker-title')
            };
        },

        _onChangeMarkerTitle: function (e) {
            var changedTitle = $.trim(this.controls.$title.val());
            if (!changedTitle) {
                this.controls.$renameButton.disable();
            } else {
                this.controls.$renameButton.enable();
                if (e.which == AJS.$.ui.keyCode.ENTER) {
                    this.controls.$renameButton.click();
                }
            }
        },

        _onShow: function (e) {
            this.controls.$title.select();
        },

        _onSaveButtonClick: function (e) {
            e.preventDefault();
            this.hide();
            this.options.marker.renameTitle(this.controls.$title.val());
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};
    Roadmap.LaneView = Backbone.View.extend({
        tagName: 'div',
        className: 'roadmap-lane',
        events: {
            "click .roadmap-lane-title": '_showDialog',
            'BarView.drop': '_onBarDropped',
            'BarRowNew.dropover': '_onBarRowNewDropover',
            'BarRowNew.dropout': '_onBarRowNewDropout'
        },

        attributes: function () {
            return {
                cid: this.cid
            };
        },

        initialize: function () {
            _.bindAll(this, 'render', 'renameTitle', 'updateRowIndex', 'removeEmptyRow', 'cleanLaneAfterDrop',
                '_deleteLane', '_updateLaneHeight', '_renderComplete', '_deleteBar', '_addBar', '_changeColor', 'addDefaultBarRow');
            this._barViews = [];
            this._barRowViews = [];

            this.listenTo(this.model.get('bars'), 'add', function (barModel) {
                // New Bar Row
                var rowView = this._newBarRowView();

                // Add Bar to new Row
                var barView = this._newBarView(barModel);
                rowView.$el.append(barView.render().$el);
                this._$laneContent.append(rowView.$el);
                this._barViews.push(barView);
                this.$el.trigger('BarView.add', barView);
                _.defer(this._updateLaneHeight);
            });
        },

        render: function () {
            var me = this;
            this.$el.append(
                Confluence.Templates.Roadmap.lane({
                    title: this.model.get('title'),
                    color: this.model.get('color')
                })
            );
            Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get('color'), 1);

            var barModels = this.model.get('bars').models;
            barModels = _.sortBy(barModels, function (barModel) {
                return barModel.attributes.rowIndex;
            });

            _.each(barModels, function (barModel) {
                var barView = me._newBarView(barModel);
                me._barViews.push(barView);
            });

            this._renderBars();

            _.defer(this._renderComplete);
            return this;
        },

        _renderComplete: function () {
            this._updateLaneHeight();
        },

        renameTitle: function (newTitle) {
            this.model.set('title', newTitle);
            this.$el.find('.roadmap-lane-title').attr('title', newTitle);
            this.$el.find('.title-inner').html(AJS.escapeHtml(newTitle));
            this._updateLaneHeight();
        },

        _updateLaneHeight: function () {
            //lane-title must be calculated base on 'roadmap-lane-content'
            //To do that: hide title -> get 'roadmap-lane-content' height ->show
            var $titleElement = this.$el.find('.title-inner');
            $titleElement.hide();
            var laneHeight = this._$laneContent.outerHeight();
            $titleElement.width(laneHeight - 2 * Roadmap.LANE_PADDING);
            $titleElement.show();
        },

        _barBeforeResize: function (barViewObj, direction) {
            var barView = barViewObj.$el;
            var paddingBarValue = Math.ceil(barView.outerWidth() - barView.width()); //Control margin/padding value

            var barResizeMaxWidth;
            if (direction == 'left') {
                var barViewLeft = this._getNearestBarView(barViewObj, direction);
                var barViewLeftRightX = barViewLeft == null ? 0 :
                    barViewLeft.position().left + barViewLeft.width() + paddingBarValue;
                var distance = barView.position().left - barViewLeftRightX;
                barResizeMaxWidth = barView.width() + distance;
            } else { //right
                var barViewRight = this._getNearestBarView(barViewObj, direction);
                var barViewRightLeftX = barViewRight == null ?
                    this._getLaneContentWidth() - paddingBarValue :
                    barViewRight.position().left - paddingBarValue;
                barResizeMaxWidth = barViewRightLeftX - barView.position().left;
            }
            barViewObj.updateMaxWidth(barResizeMaxWidth - Roadmap.BAR_MARGIN);
        },

        _renderBars: function () {
            var me = this;
            this._$laneContent = this.$el.find('.roadmap-lane-content');
            var rowViews = {};

            _.each(this._barViews, function (barView) {
                // New Bar Row
                var rowViewKey = 'row-' + barView.model.get('rowIndex');
                var rowView = rowViews[rowViewKey];

                if (!rowView) {
                    rowView = me._newBarRowView(barView.model.get("rowIndex"));
                    rowViews[rowViewKey] = rowView;
                }

                rowView.$el.append(barView.render().$el);
                me._$laneContent.append(rowView.$el);
            });
        },

        _newBarRowView: function () {
            var rowView = new Roadmap.BarRowView();
            this._barRowViews.push(rowView);
            return rowView;
        },

        _newBarView: function (barModel) {
            var barView = new Roadmap.BarView({
                model: barModel,
                lane: this,
                color: this.model.get('color'),
                timelineView: this.options.timelineView,
                deleteBar: this._deleteBar
            });
            barView.on('beforeResize', _.bind(this._barBeforeResize, this)); //listen 'beforeResize' event on Bar
            return barView;
        },

        _getNearestBarView: function (barView, direction) {
            var barViewsInSameRow = _.filter(barView.options.lane._barViews, function (bv) {
                return bv.model.get('rowIndex') === barView.model.get('rowIndex');
            });
            var nearBar = null;
            if (direction == 'left') {
                _.each(barViewsInSameRow, function (bar) {
                    if (bar.$el.position().left < barView.$el.position().left
                        && (nearBar == null || bar.$el.position().left > nearBar.$el.position().left)) {
                        nearBar = bar;
                    }
                });
            } else {
                _.each(barViewsInSameRow, function (bar) {
                    if (bar.$el.position().left > barView.$el.position().left
                        && (nearBar == null || bar.$el.position().left < nearBar.$el.position().left)) {
                        nearBar = bar;
                    }
                });
            }

            return nearBar != null ? nearBar.$el : null;
        },

        _getLaneContentWidth: function () {
            return this.$el.find('.roadmap-lane-content').width();
        },

        /**
         * Open the 'Lane' dialog.
         *
         * Called when the 'Lane title' is clicked.
         *
         */
        _showDialog: function () {
            this._laneDialog && this._laneDialog.remove(); // remove existing object if there is any
            this._laneDialog = this._createLaneDialog();
            this._laneDialog.show();
        },

        _createLaneDialog: function () {
            return new Roadmap.LaneDialogView({
                trigger: this.$el.find('.title-outer'),
                canDelete: this.options.canDelete, // provide delete status for lane dialog
                deleteLane: this._deleteLane,
                addBar: this._addBar,
                changeColor: this._changeColor,
                lane: this
            });
        },

        _onBarDropped: function (e, dropInfo, ui) {
            var isAddingNewRow = !!dropInfo.barRowNewView;

            var draggedBarView = ui.draggable.data('View');
            var draggedBarModel = draggedBarView.model;

            var oldLane = draggedBarView.options.lane;
            var inSameLane = (oldLane.cid === this.cid);
            var barCollectionDropped = this.model.get('bars');
            var newLeftPosition = ui.position.left;
            var newStartDate = this.options.timelineView.getBarStartDate(newLeftPosition);

            // don't allow to drop on new row if lane has only one bar
            if (inSameLane && barCollectionDropped.models.length === 1 && isAddingNewRow) {
                return;
            }

            // Update model after drop
            draggedBarView.updatePositionLeft(newLeftPosition);
            draggedBarView.updateColor(this.model.get('color'));
            draggedBarModel.attributes.startDate = newStartDate;

            // Add New Row
            if (isAddingNewRow) {
                var $rowView = this._newBarRowView();
                dropInfo.barRowNewView.$el.replaceWith($rowView.$el);
                draggedBarView.appendTo($rowView.$el);
            }
            // Drag on an existing row
            else {
                draggedBarView.appendTo(dropInfo.$barRow);
            }

            // By default, ui.helper will be removed by jQuery, but we need to remove it manually to get removeEmptyRow() works properly
            ui.helper.remove();

            if (!inSameLane) {
                draggedBarView.options.lane.removeEmptyRow();

                barCollectionDropped._byId[draggedBarModel.id] = draggedBarModel;
                this._barViews.push(draggedBarView);
                // when bar was dragged into new lane need update delete function for new lane can control delete it's bar.
                draggedBarView.updateDeleteBar(this._deleteBar);

                oldLane.model.get('bars').remove(draggedBarModel);
                barCollectionDropped.models.push(draggedBarModel);
                oldLane._barViews.splice(_.indexOf(oldLane._barViews, draggedBarView), 1); //remove draggedBarView from old lane
                this.updateRowIndex(oldLane.$el);
                // Update the default options
                draggedBarView.options = _.extend(draggedBarView.options, {
                    color: this.model.get('color'),
                    lane: this
                });
                oldLane._updateLaneHeight();
            }

            this.removeEmptyRow();

            // Update rowIndex for current lane
            this.updateRowIndex(this.$el);
            this._updateLaneHeight();
        },

        updateRowIndex: function ($lane) {
            $lane.find('.roadmap-bar-row').each(function (rowIndex, rowEl) {
                $(rowEl).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function (barIndex, barEl) {
                    var barModel = $(barEl).data('View');
                    if (barModel) {
                        barModel.model.attributes.rowIndex = rowIndex;
                    }
                });
            });
        },

        /**
         * Find and remove empty rows
         *
         * @params {laneView} the lane view is use for find and remove empty rows
         ** @return boolean - true if has empty row is removed
         */
        removeEmptyRow: function () {
            var barRowDeleted = 0;
            _.each(this._barRowViews, function (barRow) {
                if (barRow.isEmptyRow()) {
                    barRow.remove();
                    barRowDeleted++;
                }
            });

            return !!barRowDeleted;
        },

        // this function will clear all stuff that generated by D&D and should be call when dragging a bar was stopped.
        cleanLaneAfterDrop: function () {
            this._$laneContent.find('.roadmap-bar-drag-active').removeClass('roadmap-bar-drag-active');
            this._$laneContent.find('.new-row-placeholder').remove();
        },

        _deleteLane: function () {
            Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get('color'), -1);
            this.$el.trigger('Lane.delete', this);
        },

        /**
         * Update delete status show/hide delete button for this lane when open lane dialog
         *
         * @param {canDelete} true show delete button
         */
        updateDeleteStatus: function (canDelete) {
            if (this._laneDialog) {
                this._laneDialog.remove(); // remove previous dialog
                delete this._laneDialog;
            }
            this.options.canDelete = canDelete;
        },

        _deleteBar: function (barView) {
            this.model.get('bars').remove(barView.model);
            this._barViews.splice(_.indexOf(this._barViews, barView), 1);
            barView.remove();
            if (this.removeEmptyRow()) {
                this.updateRowIndex(this.$el);
                this._updateLaneHeight();
                this.$el.trigger('BarRowView.remove');
            }
        },

        _addBar: function () {
            var bars = this.model.get('bars');

            var timeline = this.options.timelineView.model;
            var mStartDateTimeline = moment(timeline.get('startDate'));
            var mStartDateToRender = timeline.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                ? mStartDateTimeline.startOf('month')
                : mStartDateTimeline.startOf('isoWeek');

            bars.add(new Roadmap.Bar({
                rowIndex: this.model.getNumberOfRows(),
                startDate: mStartDateToRender.toDate()
            }));
        },

        _changeColor: function (newColor) {
            Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get('color'), -1);
            this.model.set('color', newColor);
            Confluence.Roadmap.ColorHelper.adjustColorCount(newColor, 1);
            this.$el.find('.roadmap-lane-title').css({
                'background-color': newColor.lane,
                color: newColor.text
            });
            _.each(this._barViews, function (barView) {
                barView.updateColor(newColor);
            });
        },

        addNewBarRow: function ($draggingBar) {
            var $barRows = this._$laneContent.find('.roadmap-bar-row');
            var barRowNewViewList = [];

            var add = function () {
                $barRows.each(function () {
                    var $barRow = $(this);
                    var isFirstRow = $barRow.index() === 0;

                    if (isFirstRow) {
                        var barRowNewViewBefore = new Roadmap.BarRowNewView({
                            $barRow: $barRow,
                            renderBottom: false
                        });
                        $barRow.before(barRowNewViewBefore.render().$el);
                        barRowNewViewList.push(barRowNewViewBefore);
                    }

                    var barRowNewViewAfter = new Roadmap.BarRowNewView({
                        $barRow: $barRow
                    });
                    $barRow.after(barRowNewViewAfter.render().$el);
                    barRowNewViewList.push(barRowNewViewAfter);
                });
            };

            if ($barRows.length == 0) { // Empty lane
                this.addDefaultBarRow();
            } else {
                var $bars = $barRows.find('.roadmap-bar');
                if ($bars.length > 0) { // this is empty lane with default bar-row
                    var selfDropped = ($bars.length > 0) && ($bars.length == 1) && ($bars.attr('cid') === $draggingBar.attr('cid'));  // Drop the bar into itself
                    if (!selfDropped) {
                        add();
                    }
                }
            }

            return barRowNewViewList;
        },

        /**
         * Add a empty row as default if lane is empty
         */
        addDefaultBarRow: function () {
            var rowView = this._newBarRowView();
            this._$laneContent.append(rowView.$el);
        },

        _onBarRowNewDropover: function (e, barRowNew, ui) {
            if (!_.isEmpty(Roadmap.DragDrop.barDraggingOver)) {
                // Make sure there is only one bar-row-new activated at a time
                _.each(Roadmap.DragDrop.barDraggingOver, function (item) {
                    item.$el && item.$el.removeClass('new-bar-row-hover roadmap-bar-drag-hover');
                });
            }

            Roadmap.DragDrop.barDraggingOver[barRowNew.cid] = barRowNew;
            ui.helper.removeClass('roadmap-bar-overlapped');
            ui.helper.data('isAddingNewRow', true);
        },

        _onBarRowNewDropout: function (e, barRowNew, ui) {
            ui.helper.data('isAddingNewRow', false);
            delete Roadmap.DragDrop.barDraggingOver[barRowNew.cid];

            _.each(Roadmap.DragDrop.barDraggingOver, function (item) {
                if (typeof item === 'string') { // still over on a bar
                    ui.helper.addClass('roadmap-bar-overlapped');
                } else if (item.className === 'roadmap-bar-row' && ui.helper.data('isAddingNewRow') !== true) { // still in a bar-row
                    item.$el.addClass('roadmap-bar-drag-hover');
                }
            });
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};

    Roadmap.MarkerView = Backbone.View.extend({
        className: 'vertical-line',

        events: {
            dragstop: '_onDragStop',
            dragstart: '_onDragStart'
        },

        initialize: function () {
            _.bindAll(this, 'render', 'updateHeight', 'renameTitle', '_renderComplete', '_onMarkerClick');
        },

        render: function () {
            var timeline = this.options.roadmap._timelineView.model;
            var markerPosition;
            if (timeline.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH) {
                markerPosition = Confluence.Roadmap.Helper.getPosXOnMonthTimeline(timeline.attributes, this.model.get('markerDate'));
            } else {
                markerPosition = Confluence.Roadmap.Helper.getPosXOnWeekTimeline(timeline.attributes, this.model.get('markerDate'));
            }

            if (markerPosition < 0 || markerPosition > this.options.roadmap._timelineView.$el.width()) {
                return false;
            }
            this.$el.css({
                left: (markerPosition + Roadmap.LANE_TITLE_WIDTH) + 'px'
            });
            this.$el.append(
                Confluence.Templates.Roadmap.marker({title: this.model.get('title')})
            );
            this.updateHeight(this.options.roadmap._getLaneHeight());
            _.defer(this._renderComplete);
            return this;
        },

        _renderComplete: function () {
            this._setupMarkerDragging();
            this.$el.click(this._onMarkerClick);
            this.$el.find('.marker-title').ellipsis({row: Roadmap.MARKER_TITLE_LINE});
        },

        _setupMarkerDragging: function () {
            this.$el.draggable({
                axis: 'x',
                zIndex: 4013,
                containment: '.roadmap-frame-content',
                cursor: 'move'
            });
        },

        _onDragStop: function (e, ui) {
            var posx = ui.position.left - Roadmap.LANE_TITLE_WIDTH;
            var timeline = this.options.roadmap._timelineView.model.attributes;
            var markerDate;
            if (timeline.displayOption === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH) {
                markerDate = Confluence.Roadmap.Helper.getMonthStartDateByPosition(timeline, posx);
            } else {
                markerDate = Confluence.Roadmap.Helper.getWeekStartDateByPosition(timeline, posx);
            }

            this.model.set('markerDate', markerDate);
        },

        _onDragStart: function (e, ui) {
            this.options.roadmap.hideDialog();
        },

        _onMarkerClick: function (e) {
            if (!$(e.target).hasClass('marker-title')) {
                return;
            }
            this._markerDialog && this._markerDialog.remove();
            this._markerDialog = this._createMarkerDialog();
            this._markerDialog.show();
        },

        _createMarkerDialog: function () {
            return new Roadmap.MarkerDialogView({
                trigger: this.$el.find(".marker-title"),
                marker: this
            });
        },

        updateHeight: function (timelineHeight) {
            this.$el.height(timelineHeight + Roadmap.MARKER_HEIGHT_PADDING);
        },

        renameTitle: function (newTitle) {
            this.model.set('title', newTitle);
            var $markerTitle = this.$el.find('.marker-title');
            $markerTitle.attr('title', newTitle);
            $markerTitle.html(AJS.escapeHtml(newTitle)).ellipsis({row: Roadmap.MARKER_TITLE_LINE});
        },

        removeMarker: function () {
            this.model.collection.remove(this.model);
            this.remove();
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};

    Roadmap.RoadmapEditorView = Backbone.View.extend({
        className: 'roadmap-editor-container',

        events: {
            'BarView.add': '_onAddBar',
            'BarView.dragstart': '_onBarDragstart',
            'BarView.dragstop': '_onBarDragstop',
            'BarView.drop': '_onBarDropped',
            'LaneView.drop': '_onBarDropped',
            'Lane.delete': '_onDeleteLane',
            'BarRowView.remove': '_onBarRowViewRemove',
            'sortstart .roadmap-content': '_onSortStart',
            'sortstop .roadmap-content': '_onSortStop',
            'remove': '_onRemove'
        },

        initialize: function () {
            _.bindAll(this, 'render');

            this.listenTo(this.model.get('lanes'), 'add', function (laneModel) {
                var laneView = new Roadmap.LaneView({
                    model: laneModel,
                    timelineView: this._timelineView,
                    canDelete: true
                });
                if (this._laneViews.length === 1) {
                    this._laneViews[0].updateDeleteStatus(true); // when has more than 2 lanes, lanes can be delete
                }
                this._laneViews.push(laneView);

                this.$roadmapContent.append(laneView.render().$el);
                this._updateTimelineColumnHeight();
                this._scrollToBottom();
            });

            this.listenTo(this.model.get('markers'), 'add', function (markerModel) {
                var markerView = new Roadmap.MarkerView({model: markerModel, roadmap: this});
                this.$roadmapMarker.append(markerView.render().$el);
                this._markerViews.push(markerView);
            });

            this.listenTo(this.model.get('timeline'), 'change', function () {
                if (this._isTimelineChanged()) {
                    this._calculateMinWidthOfABar();
                    this._timelineView.update();
                    this._timelineColumnView.update();
                    this.$roadmapContent.empty();
                    _.each(this._laneViews, function (laneView) {
                        laneView.remove();
                    });
                    this._laneViews = [];
                    this._renderLanes();

                    this.$roadmapMarker.empty();
                    this._markerViews = [];
                    this._renderMarkers();
                    this._updateDragArea();
                }
            });
        },

        render: function () {
            this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());

            this._calculateMinWidthOfABar();
            this._initVariables();
            this._renderToolbar();
            this._renderTimeline();
            this._renderLanes();
            this._renderMarkers();
            this._renderTimelineColumn();

            this._updateDragArea();

            return this;
        },

        _calculateMinWidthOfABar: function () {
            Roadmap.barMinWidth = this.model.get('timeline').get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                ? Roadmap.MONTH_BAR_MIN_WIDTH
                : Roadmap.WEEK_BAR_MIN_WIDTH;
        },

        _initVariables: function () {
            this.$roadmapContainer = this.$el.find('#roadmap-container');
            this.$roadmapTimeline = this.$roadmapContainer.find('.roadmap-frame');
            this.$roadmapContent = this.$roadmapContainer.find('.roadmap-content');
            this.$roadmapMarker = this.$roadmapContainer.find('.roadmap-marker');

            this._timelineView = new Roadmap.TimelineView({model: this.model.get('timeline')});
            this._timelineColumnView = new Roadmap.TimelineColumnView({model: this.model.get('timeline')});
            this._laneViews = [];
            this._markerViews = [];
        },

        _renderTimeline: function () {
            this.$roadmapTimeline.prepend(this._timelineView.render().$el);
        },

        _renderTimelineColumn: function () {
            this._updateTimelineColumnHeight();
            this.$roadmapTimeline.append(this._timelineColumnView.render().$el);
        },

        _renderMarkers: function () {
            var me = this;
            this.model.get('markers').each(function (markerModel) {
                var markerView = new Roadmap.MarkerView({model: markerModel, roadmap: me});
                me.$roadmapMarker.append(markerView.render().$el);
                me._markerViews.push(markerView);
            });
        },

        _renderLanes: function () {
            Confluence.Roadmap.ColorHelper.resetColorCounts();
            var me = this;
            this._updateLaneWidth();
            var canDelete = this.model.get('lanes').models.length > 1; // can not delete the last lane
            this.model.get('lanes').each(function (laneModel) {
                var laneView = new Roadmap.LaneView({
                    model: laneModel,
                    timelineView: me._timelineView,
                    canDelete: canDelete
                });
                me._laneViews.push(laneView);
                me.$roadmapContent.append(laneView.render().$el);
            });

            // Setup Lanes Re-ordering
            this._setupLaneReordering();
        },

        _onAddBar: function (event, barView) {
            this._updateTimelineColumnHeight();
            var $barEl = barView.$el;
            if (!this._isInViewScreen($barEl)) {
                this._scrollToBar($barEl);
            }
        },

        _renderToolbar: function () {
            var $dialogBody = $('#' + this.options.dialogId + ' .aui-dialog2-content');
            $dialogBody.find('.roadmap-toolbar').remove();
            var toolbarView = new Roadmap.ToolbarView({
                model: this.model,
                timelineView: this._timelineView
            });
            $dialogBody.prepend(toolbarView.render().$el);
        },

        _getTimelineWidth: function () {
            return this.$roadmapTimeline.find('.roadmap-frame-title').width();
        },

        _getLaneHeight: function () {
            return this.$roadmapContent.height();
        },

        _updateLaneWidth: function () {
            this.$roadmapContent.width(this._getTimelineWidth() + Roadmap.LANE_TITLE_WIDTH);
        },

        _scrollToBottom: function () {
            this.options.roadmapEditorPopup.scrollTop(this._getLaneHeight());
        },

        _isInViewScreen: function ($elem) {
            return $.inviewport($elem, {threshold: -200});
        },

        _scrollToBar: function ($bar) {
            this.options.roadmapEditorPopup.scrollTop($bar.parent().position().top);
            this.options.roadmapEditorPopup.scrollLeft(0);
        },

        _onBarDropped: function () {
            this._updateTimelineColumnHeight();
        },

        _onDeleteLane: function (event, laneView) {
            this.model.get('lanes').remove(laneView.model);
            this._laneViews.splice(_.indexOf(this._laneViews, laneView), 1);
            laneView.remove();
            this._updateTimelineColumnHeight();
            if (this._laneViews.length === 1) {
                // update delete status for can not delete the last lane
                this._laneViews[0].updateDeleteStatus(false);
            }
        },

        _onBarRowViewRemove: function () {
            this._updateTimelineColumnHeight();
        },

        _updateTimelineColumnHeight: function () {
            var laneHeight = this._getLaneHeight();
            this._timelineColumnView.updateHeight(laneHeight);
            _.each(this._markerViews, function (markerView) {
                markerView.updateHeight(laneHeight);
            });
        },

        hideDialog: function () {
            $('#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options').hide();
        },

        removeDialog: function () {
            $('#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options').remove();
        },

        _onBarDragstart: function (e, ui) {
            var me = this;
            this.hideDialog();
            this._updateDragArea();

            this._barRowNewViewList = [];
            _.each(this._laneViews, function (laneView) {
                me._barRowNewViewList.push(laneView.addNewBarRow(ui.helper));
            });
        },

        _updateDragArea: function () {
            // Create a drag-area that draggable element will be rendered to.
            var $dragZone = this.$roadmapContainer.find('.roadmap-drag-area');
            $dragZone.css(this._timelineColumnView.getSizeAndPosition());
        },

        _onBarDragstop: function () {
            // Remove Roadmap.BarRowNewView
            _.each(_.flatten(this._barRowNewViewList), function (barRowNew) {
                barRowNew.remove();

            });
            delete this._barRowNewViewList;

            _.each(this._laneViews, function (laneView) {
                laneView.removeEmptyRow();
            });
        },

        /* Lanes re-ordering */
        _setupLaneReordering: function () {
            this.$roadmapContent.sortable({
                axis: 'y',
                cursor: 'move',
                handle: '.roadmap-lane-title',
                opacity: 0.3,
                placeholder: 'roadmap-lane lane-sorting-placeholder',
                helper: function (e, el) {
                    return $(el).clone().addClass('lane-sorting-hepler');
                }
            });
        },

        _onSortStart: function (e, ui) {
            this.hideDialog();
            // Hide the vertical line, we will show it up again in _onSortStop function
            // Reason for this is decrease the effort to update height for them.
            this._timelineColumnView.$el.hide();

            // Format the placeholder
            ui.placeholder.css({
                height: Math.min(ui.helper.height(), 100),
                width: ui.helper.width()
            }).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));

            // Set a specific width for roadmap-lane-content, because of limitation of display is table-cell.
            ui.helper.find('.roadmap-lane-content').css({
                width: ui.helper.width() - (ui.helper.find('.roadmap-lane-title').outerWidth() + ui.helper.find('.roadmap-separate-content').outerWidth())
            });
        },

        _onSortStop: function (e, ui) {
            // Re-show the timeline column which was hidden in _onSortStart
            this._timelineColumnView.$el.show();

            // lookup for lane which is reordered
            var laneViewId = ui.item.attr('cid');
            var laneView = _.find(this._laneViews, function (lane) {
                return lane.cid === laneViewId;
            });
            var laneModel = laneView.model;
            var laneCollection = this.model.get('lanes');

            // Remove from current collection
            laneCollection.remove(laneModel);

            // Insert model to new position
            laneCollection.models.splice(ui.item.index(), 0, laneModel);
            laneCollection._byId[laneModel.cid] = laneModel;
        },

        _onRemove: function () {
            this.$roadmapTimeline.remove();
        },
        /* End lanes re-ordering */

        _isMonthYearChanged: function () {
            var isDifferentMonthYear = function (date1, date2) {
                if (date1.getMonth() !== date2.getMonth() || date1.getYear() !== date2.getYear()) {
                    return true;
                }

                return false;
            };

            var timeline = this.model.get('timeline');
            return isDifferentMonthYear(timeline._previousAttributes.startDate, timeline.attributes.startDate) ||
                isDifferentMonthYear(timeline._previousAttributes.endDate, timeline.attributes.endDate);
        },

        _isWeekChanged: function () {
            var isSameWeek = function (date1, date2) {
                var mDate1 = moment(date1);
                var mDate2 = moment(date2);

                return mDate1.get('year') === mDate2.get('year') && mDate1.isoWeek() === mDate2.isoWeek();
            };

            var timeline = this.model.get('timeline');
            var oldStartDate = timeline._previousAttributes.startDate;
            var currentStartDate = timeline.attributes.startDate;

            var oldEndDate = timeline._previousAttributes.endDate;
            var currentEndDate = timeline.attributes.endDate;

            return !(isSameWeek(oldStartDate, currentStartDate) && isSameWeek(oldEndDate, currentEndDate));
        },

        _isTimelineChanged: function () {
            var timeline = this.model.get('timeline');

            var isChanged = timeline.changed.displayOption;
            if (isChanged) {
                this.model.updateDurationUnit(timeline.get('displayOption'));
            } else {
                isChanged = timeline.get('displayOption') === Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
                    ? this._isMonthYearChanged()
                    : this._isWeekChanged();
            }

            return isChanged;
        },

        resize: function () {
            this._updateLaneWidth();
            this._updateTimelineColumnHeight();
            this.$roadmapContent.css({
                top: this.$roadmapTimeline.find('.roadmap-column-title:first').innerHeight()
            });
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-analytics-resources', location = 'analytics/roadmap-analytics.js' */
Confluence.Roadmap = Confluence.Roadmap || {};
Confluence.Roadmap.Analytics = (function ($, _) {
    var eventNames = {
        INSERT: 'confluence.roadmap.insert',
        CREATE: 'confluence.roadmap.create',
        EDIT: 'confluence.roadmap.edit',
        EDIT_ACTIONS: {
            OPEN_BAR_DIALOG: 'confluence.roadmap.editmode.open_bar_dialog',
            ADD_DESCRIPTION: 'confluence.roadmap.editmode.add_description',
            ADD_PAGE_LINK: 'confluence.roadmap.editmode.add_page_link'
        },
        VIEW_ACTIONS: {
            OPEN_BAR_DIALOG: 'confluence.roadmap.viewmode.open_bar_dialog',
            CLICK_PAGE_LINK: 'confluence.roadmap.viewmode.click_page_link',
            ADD_PAGE_LINK: 'confluence.roadmap.viewmode.add_page_link'
        }
    };

    function triggerEvent(name, data) {
        AJS.trigger('analytics', {name: name, data: data});
    }

    function getAnalyticData(roadmap) {
        var barCount = 0;
        _.each(roadmap.lanes, function (lane) {
            barCount = barCount + lane.bars.length;
        });
        return {
            lanes: roadmap.lanes.length,
            bars: barCount,
            markers: roadmap.markers.length,
            months: Confluence.Roadmap.DateUtilities.getNumberOfMonths(roadmap.timeline.startDate, roadmap.timeline.endDate) + 1
        }
    }

    function insertRoadmap() {
        triggerEvent(eventNames.INSERT);
    }

    function createRoadmap(roadmap) {
        var data = getAnalyticData(roadmap);
        triggerEvent(eventNames.CREATE, data);
    }

    function editRoadmap(roadmap) {
        var data = getAnalyticData(roadmap);
        triggerEvent(eventNames.EDIT, data);
    }

    function openBarDialogInEdit() {
        triggerEvent(eventNames.EDIT_ACTIONS.OPEN_BAR_DIALOG);
    }

    function openBarDialogInView() {
        triggerEvent(eventNames.VIEW_ACTIONS.OPEN_BAR_DIALOG);
    }

    function clickPageLink() {
        triggerEvent(eventNames.VIEW_ACTIONS.CLICK_PAGE_LINK);
    }

    function addDescription() {
        triggerEvent(eventNames.EDIT_ACTIONS.ADD_DESCRIPTION);
    }

    function addPageLinkEditMode(data) {
        triggerEvent(eventNames.EDIT_ACTIONS.ADD_PAGE_LINK, data);
    }

    function addPageLinkViewMode(data) {
        triggerEvent(eventNames.VIEW_ACTIONS.ADD_PAGE_LINK, data);
    }

    return {
        insertRoadmap: insertRoadmap,
        createRoadmap: createRoadmap,
        editRoadmap: editRoadmap,

        openBarDialogInEdit: openBarDialogInEdit,
        addDescription: addDescription,
        addPageLinkEditMode: addPageLinkEditMode,
        addPageLinkViewMode: addPageLinkViewMode,

        openBarDialogInView: openBarDialogInView,
        clickPageLink: clickPageLink
    }

})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-dialog-resources-for-editor', location = 'view/dialog-view.js' */
/**
 * Currently InlineDialog doesn't support left/right orientation ( will support from version AUI 5.5.1 https://ecosystem.atlassian.net/browse/AUI-2197 )
 * SideInlineDialog has been already implemented and support left/right orientation
 * https://bitbucket.org/atlassianlabs/confluence-roadmap-plugin/src/f7c94dfb23007aa7fd0458af5e6128cdeacc6338/src/main/resources/js/SideInlineDialog.js?at=master
 * Temporary copied getDimensions & calculatePositions, getArrowPath functions to here with names_getSideDimensions & _calculateSidePositions, _getSideArrowPath
 * TODO update Roadmap InlineDialog use left/right option https://jira.atlassian.com/browse/CONFDEV-25613
 */
(function ($, _) {
    window.Roadmap = window.Roadmap || {};
    Roadmap.InlineDialogView = Backbone.View.extend({
        /**
         * Initialise the view.
         *
         * @class
         * @classdesc A Backbone wrapper around `AJS.InlineDialog`.
         *
         * Subclasses must implement `_getContent()`.
         * @constructs
         * @param {object} options
         */
        initialize: function (options) {
            _.bindAll(this, '_onDocumentClick', '_onKeyDown', '_shouldHide', '_onHide');
            this._trigger = options.trigger;
            this._dialogOptions = options.dialogOptions;
            this._reset();
            var me = this;
            // hide dialog when roadmap scroll
            $('.roadmap-editor-popup, .roadmap-macro-view').scroll(function () {
                me.hide();
            });
        },

        /**
         * Determine if the inline dialog should hide in response to a click.
         *
         * Can be overridden by subclasses.
         *
         * @param {object} e A click event.
         * @returns {boolean} Whether the inline dialog should hide.
         */
        _shouldHideWhenClick: function (e) {
            return !$.contains(this._inlineDialog[0], e.target);
        },

        /**
         * Create the view's inline dialog.
         *
         * @param {trigger} the element under which the dialog is to appear.
         * @param {dialogOptions} options for inline dialog.
         * @returns {AJS.InlineDialog} The view's inline dialog.
         */
        _createInlineDialog: function (trigger, dialogOptions) {
            var inlineDialog,
                me = this;

            function getContent(element, trigger, showDialog) {
                me._getContent(element);
                showDialog();
            }

            function onBeforeShow() {
                me._onBeforeShow();

                _.delay(function () {
                    AJS.InlineDialog.current = null;
                    me._onShow();
                    $(document).on({
                        click: me._onDocumentClick,
                        keydown: me._onKeyDown
                    });
                }, me._inlineDialog.getOptions().fadeTime);
            }

            var defaultDialogOptions = {
                hideCallback: this._onHide,
                initCallback: onBeforeShow,
                noBind: true,
                persistent: true,
                preHideCallback: this._shouldHide
            };

            if (dialogOptions && dialogOptions.isSideInlineDialog) {
                _.extend(defaultDialogOptions, {
                    calculatePositions: _.compose(this._calculateSidePositions, this._getSideDimensions),
                    offsetX: 8,
                    offsetY: 0
                });

                if (Raphael.version) {
                    _.extend(defaultDialogOptions, {
                        getArrowPath: this._getSideArrowPath
                    });
                }
            }

            inlineDialog = new AJS.InlineDialog(trigger, 'roadmap-dialog', getContent,
                _.extend({}, defaultDialogOptions, dialogOptions));
            return inlineDialog;
        },

        _onHide: function () {
            $(document).off({
                click: this._onDocumentClick,
                keydown: this._onKeyDown
            });
        },

        /**
         * Remove dialog when hide it
         */
        hide: function () {
            this._inlineDialog.remove();
        },

        /**
         * Hide the inline dialog in response to a click.
         *
         * Called when the user clicks anywhere on the document.
         *
         */
        _onDocumentClick: function (e) {
            this._shouldHideWhenClick(e) && this.hide();
        },

        /**
         * Called before the inline dialog is shown.
         *
         * To be implemented by subclasses.
         */
        _onBeforeShow: $.noop,

        /**
         * Hide the inline dialog in response to pressing escape.
         *
         * @param {object} e The key down event.
         */
        _onKeyDown: function (e) {
            var isEscape = e.which === $.ui.keyCode.ESCAPE,
                isInput = $(e.target).is(":input");

            if (isEscape && !isInput) {
                this.hide();
            }
        },

        /**
         * Called after the inline dialog is shown.
         *
         * To be implemented by subclasses.
         */
        _onShow: $.noop,

        /**
         * Recreate the view's inline dialog to force content re-loading.
         *
         * This is used to work around a bug in `AJS.InlineDialog` where it
         * won't show if loading its content fails. Recreate it to reset state.
         *
         * @protected
         */
        _reset: function () {
            this._inlineDialog = this._createInlineDialog(this._trigger, this._dialogOptions);
            this.setElement(this._inlineDialog);
        },

        /**
         * To be overridden by subclasses.
         *
         * @returns {boolean} Whether the inline dialog should hide.
         */
        _shouldHide: function () {
            return true;
        },

        /**
         * Show the inline dialog.
         */
        show: function () {
            this._inlineDialog.show();
        },

        /**
         * Disable all buttons/inputs in the dialog.
         */
        disable: function () {
            this.$el.find(":input").attr("disabled", "disabled");
        },

        /**
         * Enable all buttons/inputs in the dialog.
         */
        enable: function () {
            this.$el.find(":input").removeAttr("disabled");
        },

        /**
         * Called when the dialog's form is submitted.
         *
         * To be implemented by subclasses.
         */
        _onSubmit: function () {
            throw new Error("DialogView subclasses must implement _onSubmit().");
        },

        /*
         * @param {jQuery} popup
         * @param {object} targetPosition
         * @param {object} mousePosition
         * @param {object} opts
         * @return {object}
         * @private
         */
        _getSideDimensions: function (popup, targetPosition, mousePosition, opts) {
            // Support positioning inside a scroll container other than <body>
            var constrainedScroll = opts.container.toLowerCase() !== 'body';
            var $scrollContainer = AJS.$(opts.container);
            var $scrollWindow = constrainedScroll ?
                AJS.$(opts.container).parent() :
                AJS.$(window);
            var scrollContainerOffset = constrainedScroll ?
                $scrollContainer.offset() : {left: 0, top: 0};
            var scrollWindowOffset = constrainedScroll ?
                $scrollWindow.offset() : {left: 0, top: 0};

            var trigger = targetPosition.target;
            var triggerOffset = trigger.offset();

            // Support SVG elements as triggers
            var triggerClientRect = trigger[0].getBoundingClientRect && trigger[0].getBoundingClientRect();

            // calculate actual width display on timeline if provide timeline width
            var width = triggerClientRect ? triggerClientRect.width : trigger.outerWidth();
            if (opts.timelineWidth) {
                var triggerPosition = trigger.position();
                if (triggerPosition.left + width > opts.timelineWidth) {
                    width = opts.timelineWidth - triggerPosition.left - 1; // 1 for timeline border
                }
            }

            var v = {
                // determines how close to the edge the dialog needs to be before it is considered offscreen
                screenPadding: 10,
                // Min distance arrow needs to be from the edge of the dialog
                arrowMargin: 5,
                window: {
                    top: scrollWindowOffset.top,
                    left: scrollWindowOffset.left,
                    scrollTop: $scrollWindow.scrollTop(),
                    scrollLeft: $scrollWindow.scrollLeft(),
                    width: $scrollWindow.width(),
                    height: $scrollWindow.height()
                },
                scrollContainer: {
                    width: $scrollContainer.width(),
                    height: $scrollContainer.height()
                },
                // Position of the trigger is relative to the scroll container
                trigger: {
                    top: triggerOffset.top - scrollContainerOffset.top,
                    left: triggerOffset.left - scrollContainerOffset.left,
                    width: width,
                    height: triggerClientRect ? triggerClientRect.height : trigger.outerHeight()
                },
                dialog: {
                    width: popup.width(),
                    height: popup.height(),
                    offset: {
                        top: opts.offsetY,
                        left: opts.offsetX
                    }
                },
                arrow: {
                    height: popup.find('.arrow').outerHeight()
                }
            };

            return v;
        },

        /**
         * @param {object} dimensions
         * @returns {object}
         * @private
         */
        _calculateSidePositions: function (dimensions) {
            var screenPadding = dimensions.screenPadding;
            var win = dimensions.window;
            var trigger = dimensions.trigger;
            var dialog = dimensions.dialog;
            var arrow = dimensions.arrow;
            var scrollContainer = dimensions.scrollContainer;

            var triggerScrollOffset = {
                top: trigger.top - win.scrollTop,
                left: trigger.left - win.scrollLeft
            };

            // Halves - because the browser doesn't do sub-pixel positioning, we need to consistently floor
            // all decimal values or you can get 1px jumps in arrow positioning when the dialog's height changes.
            var halfTriggerHeight = Math.floor(trigger.height / 2);
            var halfPopupHeight = Math.floor(dialog.height / 2);
            var halfArrowHeight = Math.floor(arrow.height / 2);

            // Figure out where to position the dialog, preferring the right
            var spaceOnLeft = triggerScrollOffset.left - dialog.offset.left - screenPadding;

            // This implementation may not be suitable for horizontally scrolling containers
            var spaceOnRight = scrollContainer.width - triggerScrollOffset.left - trigger.width - dialog.offset.left -
                screenPadding;
            var enoughSpaceOnLeft = spaceOnLeft >= dialog.width;
            var enoughSpaceOnRight = spaceOnRight >= dialog.width;
            var dialogLocation = !enoughSpaceOnRight && enoughSpaceOnLeft ? 'left' : 'right';

            // Screen padding needs to be adjusted if the arrow would extend into it
            var arrowScreenTop = triggerScrollOffset.top + halfTriggerHeight - halfArrowHeight;
            var arrowScreenBottom = win.height - arrowScreenTop - arrow.height;
            screenPadding = Math.min(screenPadding, arrowScreenTop - dimensions.arrowMargin);
            screenPadding = Math.min(screenPadding, arrowScreenBottom - dimensions.arrowMargin);

            // Figure out if the dialog needs to be adjusted up or down to fit on the screen
            var spaceAbove = Math.max(triggerScrollOffset.top - screenPadding, 0);
            var spaceBelow = Math.max(win.height - triggerScrollOffset.top - trigger.height - screenPadding, 0);
            var overflowAbove = Math.max(halfPopupHeight - halfTriggerHeight - dialog.offset.top - spaceAbove, 0);
            var overflowBelow = Math.max(halfPopupHeight - halfTriggerHeight + dialog.offset.top - spaceBelow, 0);
            var adjustmentForOverflow = overflowAbove || -overflowBelow || 0;

            // Calculate coordinates for the dialog, after adjustments for fitting onto the screen
            var popupCss = {
                top: trigger.top + halfTriggerHeight - halfPopupHeight + dialog.offset.top + adjustmentForOverflow,
                left: dialogLocation === 'right' ?
                    trigger.left + trigger.width + dialog.offset.left :
                    trigger.left - dialog.width - dialog.offset.left
            };

            var arrowGravity = 'w';
            // Calculate coordinates for the dialog's arrow. It is relative to the dialog, not the page
            var arrowCss = {
                position: 'absolute',
                top: halfPopupHeight - halfArrowHeight - adjustmentForOverflow
            };

            if (dialogLocation === 'right') {
                arrowCss.right = 'auto';
                arrowCss.left = Raphael.version ? '-7px' : '0px';
            } else {
                arrowCss.right = '-7px';
                arrowCss.left = 'auto';
                arrowGravity = 'e';
            }
            return {
                dialogLocation: dialogLocation,
                popupCss: popupCss,
                arrowCss: arrowCss,
                gravity: arrowGravity
            };
        },

        /**
         * @param {object} positions
         * @returns {string} SVG path
         * @private
         */
        _getSideArrowPath: function (positions) {
            return positions.dialogLocation === 'right' ?
                "M8,0L0,8,8,16" :
                "M8,0L16,8,8,16";
        },

        refresh: function () {
            this._inlineDialog && this._inlineDialog.refresh();
        }
    });
})(AJS.$, window._);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources-conf-frontend', location = 'lib/jquery.viewport.js' */
/*
 * Viewport - jQuery selectors for finding elements in viewport
 *
 * Copyright (c) 2008-2009 Mika Tuupola
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Project home:
 *  http://www.appelsiini.net/projects/viewport
 *
 */
(function ($) {

    $.belowthefold = function (element, settings) {
        var fold = $(window).height() + $(window).scrollTop();
        return fold <= $(element).offset().top - settings.threshold;
    };

    $.abovethetop = function (element, settings) {
        var top = $(window).scrollTop();
        return top >= $(element).offset().top + $(element).height() - settings.threshold;
    };

    $.rightofscreen = function (element, settings) {
        var fold = $(window).width() + $(window).scrollLeft();
        return (fold <= $(element).offset().left - settings.threshold) || $(element).offset().left < 0;
    };

    $.leftofscreen = function (element, settings) {
        var left = $(window).scrollLeft();
        return left >= $(element).offset().left + $(element).width() - settings.threshold;
    };

    $.inviewport = function (element, settings) {
        return !$.rightofscreen(element, settings) && !$.leftofscreen(element, settings) && !$.belowthefold(element, settings) && !$.abovethetop(element, settings);
    };

    $.extend($.expr[':'], {
        "below-the-fold": function (a, i, m) {
            return $.belowthefold(a, {threshold: 0});
        },
        "above-the-top": function (a, i, m) {
            return $.abovethetop(a, {threshold: 0});
        },
        "left-of-screen": function (a, i, m) {
            return $.leftofscreen(a, {threshold: 0});
        },
        "right-of-screen": function (a, i, m) {
            return $.rightofscreen(a, {threshold: 0});
        },
        "in-viewport": function (a, i, m) {
            return $.inviewport(a, {threshold: 0});
        }
    });


})(jQuery);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources-conf-frontend', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources-conf-frontend', location = 'editor/roadmap-editor.js' */
AJS.toInit(function ($) {
    // @@roadmap
    var roadmapPopupTemplate, $roadmapPopup, $roadmapEditorPopup, roadmapEditorView, isCreateNew, saveInterval;
    var PAGE_LINK_DELIMITER = "~~~~~";
    var tinymce = window.tinymce;

    AJS.MacroBrowser.setMacroJsOverride('roadmap', {
        opener: function (macro) {
            var updatePageLinksFromParams = function (roadmap, pagelinks, maplinks, callback) {
                    var mapLinkArray = maplinks ? maplinks.split(PAGE_LINK_DELIMITER) : [];
                    var pageLinkArray = pagelinks ? pagelinks.split(PAGE_LINK_DELIMITER) : [];

                    if (!_.isEmpty(mapLinkArray)) {
                        $.ajax({
                            type: 'POST',
                            contentType: "application/json",
                            url: AJS.contextPath() + '/rest/roadmap/1.0/extractPageLinks',
                            data: JSON.stringify({
                                'wikiLinks': _.object(mapLinkArray, pageLinkArray),
                                'roadmapSpace': AJS.Meta.get('space-key')
                            }),
                            success: function (result) {
                                _.each(roadmap.lanes, function (lane) {
                                    _.chain(lane.bars)
                                        .filter(function (bar) {
                                            return _.contains(mapLinkArray, bar.id);
                                        })
                                        .each(function (bar) {
                                            if (result[bar.id]) {
                                                bar.pageLink = result[bar.id];
                                            }
                                        });
                                })
                                callback && callback();
                            },
                            error: function (error) {
                                AJS.log(error);
                                callback && callback();
                            }
                        });
                    } else {
                        callback && callback();
                    }
                },
                
                preparePageLinkParams = function(roadmapData) {
                var pageLinks = [];
                var mapLinks = [];
                roadmapData.lanes.forEach(function (lane) {
                  lane.bars.forEach(function (bar) {
                    if (!_.isEmpty(bar.pageLink)) {
                      var wikiLink = bar.pageLink.wikiLink.replace(/[\][]/g, ""); //remove "[ ]"
                      pageLinks.push(_.escape(wikiLink));
                      mapLinks.push(bar.id);
                    }
                  });
                });
                return {
                  pageLinks: pageLinks.join(PAGE_LINK_DELIMITER),
                  mapLinks: mapLinks.join(PAGE_LINK_DELIMITER),
                };
              }

            // Prevent user from editing an old roadmap
            // When user try to add a new roadmap, macro.params value is undefined
            if (macro.params && macro.params.timeline !== 'true') {
                var dialogId = 'roadmap-deprecation-dialog';
                var $dialogEl = $(Confluence.Templates.Roadmap.deprecationDialog({
                    id: dialogId
                }));

                AJS.dialog2($dialogEl).on('hide', function () {
                    $('#' + dialogId).remove();
                }).on('show', function () {
                    $("#dialog-close-button", $dialogEl).click(function (e) {
                        e.preventDefault();
                        AJS.dialog2('#' + dialogId).hide();
                    });
                }).show();

                return false; // Return to exit this function.
            }

            // Setting up to show the Roadmap Editor Dialog
            var roadmapData;
            var isInTinyMceEditor = tinymce && !!tinymce.activeEditor;
            // We should autosave the roadmap planner macro when we're in fabric
            // editor and the feature flag is enabled.
            var roadmapShouldAutoSave = !isInTinyMceEditor;
            var constructRoadmapDialog = function () {

                var roadmapDialogId = 'confluence-roadmap-dialog';
                var roadmapPopupPanelId = 'roadmap-popup-panel';
                var roadmapDialog;

                var disableInsertButton = function () {
                    $roadmapPopup.find("#roadmapInsertBtn").attr('disabled', 'disabled');
                    $roadmapPopup.find("#roadmapCancelBtn").attr('disabled', 'disabled');
                    if(roadmapShouldAutoSave){
                      removeIntermittentSaving();
                    }
                };

                var enableInsertButton = function () {
                    $roadmapPopup.find("#roadmapInsertBtn").removeAttr('disabled');
                    $roadmapPopup.find("#roadmapCancelBtn").removeAttr('disabled');
                };

                window.addEventListener('offline', disableInsertButton);

                window.addEventListener('online', enableInsertButton);

                var removeConnectionListener = function () {
                    window.removeEventListener('online', enableInsertButton);
                    window.removeEventListener('offline', disableInsertButton);
                };

                function initializeIntermittentSaving() {
                    if(saveInterval){
                        clearInterval(saveInterval);
                    }
                    saveInterval = setInterval(function () {
                        saveRoadmap();
                    }, 15000);
                }
              
                function removeIntermittentSaving() {
                  clearInterval(saveInterval);
                }

            // https://stackoverflow.com/a/48161723
            function sha256(message) {
                // encode as UTF-8
                var msgBuffer = new TextEncoder().encode(message);

                // hash the message
                return crypto.subtle.digest('SHA-256', msgBuffer).then(function(hashBuffer) {
                    // convert ArrayBuffer to Array
                    var hashArray = Array.from(new Uint8Array(hashBuffer));

                    // convert bytes to hex string
                    return hashArray.map(function(b) {
                        return b.toString(16).padStart(2, '0');
                    }).join('');
                });
            }
              
            function saveRoadmap() {
                var roadmapData = roadmapEditorView.model.toMacroData();
                var source = encodeURIComponent(JSON.stringify(roadmapData));

                sha256(source).then(function(hash) {
                    var pageLinkRoadmap = preparePageLinkParams(roadmapData);
                    var macroData = {
                        timeline: "true",
                        source: source,
                        hash: hash,
                        title: encodeURIComponent(roadmapData.title),
                        pagelinks: pageLinkRoadmap.pageLinks,
                        maplinks: pageLinkRoadmap.mapLinks,
                    };

                    var macroBrowserFacade = require("confluence-macro-browser/macro-browser-facade");
                    macroBrowserFacade.saveMacro({ name: "roadmap", params: macroData });
                });
            }
                if (typeof roadmapPopupTemplate == "undefined") {
                    roadmapPopupTemplate = aui.dialog.dialog2({
                        id: roadmapDialogId,
                        size: "xlarge",
                        titleText: "Insert Roadmap Planner",
                        content: Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId: roadmapPopupPanelId}),
                        footerActionContent: Confluence.Templates.Roadmap.footerActionContent({roadmapShouldAutoSave: roadmapShouldAutoSave}),
                        /* this option prevents dialog2 from closing when a dropdown2 is going to show */
                        modal: true
                    });

                    $roadmapPopup = $(roadmapPopupTemplate).appendTo($("body"));
                    $roadmapPopup.find("#roadmapInsertBtn").on("click", function (e) {
                        roadmapEditorView.removeDialog();
                        var roadmapData = roadmapEditorView.model.toMacroData();
                        var source = encodeURIComponent(JSON.stringify(roadmapData));

                        sha256(source).then(function(hash) {
                            var pageLinkRoadmap = preparePageLinkParams(roadmapData);
                            var macroData = {
                                timeline: "true",
                                source: source,
                                hash: hash,
                                title: encodeURIComponent(roadmapData.title),
                                pagelinks: pageLinkRoadmap.pageLinks,
                                maplinks: pageLinkRoadmap.mapLinks,
                            };

                            var macroBrowserFacade = require("confluence-macro-browser/macro-browser-facade");
                            macroBrowserFacade.insert({ name: "roadmap", params: macroData });

                            roadmapEditorView.remove();
                            roadmapDialog.hide();
                            if (isCreateNew) {
                                Confluence.Roadmap.Analytics.createRoadmap(roadmapData);
                            } else {
                                Confluence.Roadmap.Analytics.editRoadmap(roadmapData);
                            }

                            if(roadmapShouldAutoSave){
                                removeIntermittentSaving();
                            }
                            removeConnectionListener();
                        });
                    });
                    if(roadmapShouldAutoSave){
                      $roadmapPopup.find("#roadmapCloseBtn").on("click", function (e) {
                        roadmapEditorView.removeDialog();
                        roadmapEditorView.remove();
                        roadmapDialog.hide();
                        removeConnectionListener();
                        removeIntermittentSaving();
                      });
                    } else {
                      $roadmapPopup.find("#roadmapCancelBtn").on("click", function (e) {
                        roadmapEditorView.removeDialog();
                        roadmapEditorView.remove();
                        roadmapDialog.hide();
                        removeConnectionListener();
                      });
                    }


                    $roadmapEditorPopup = $roadmapPopup.find('.roadmap-editor-popup');
                }

                roadmapDialog = AJS.dialog2("#" + roadmapDialogId).show();
                // Each time we call 'roadmapEditorView.remove()', it will remove roadmapPopupPanel.
                // To avoid this, we create a new container for roadmap-view.
                var $popupPanel = $('#' + roadmapPopupPanelId);
                var $roadmapViewEl = $popupPanel.find('.roadmap-view');

                if (!$roadmapViewEl.length) {
                    $roadmapViewEl = $('<div class="roadmap-view"/>');
                    $popupPanel.append($roadmapViewEl);
                }

                var roadmap = new Roadmap.Roadmap(roadmapData, {parse: true});
                roadmapEditorView = new Roadmap.RoadmapEditorView({
                    model: roadmap,
                    dialogId: roadmapDialogId,
                    el: $roadmapViewEl,
                    roadmapEditorPopup: $roadmapEditorPopup
                });
                roadmapEditorView.render();
                if(roadmapShouldAutoSave){
                    // start regularly inserting the roadmap planner macro
                    initializeIntermittentSaving() 
                }
                resizePopupPanel();
            };

            if (macro.params && macro.params.source) { // edit roadmap
                isCreateNew = false;
                roadmapData = JSON.parse(decodeURIComponent(macro.params.source));
                updatePageLinksFromParams(roadmapData, macro.params.pagelinks, macro.params.maplinks, constructRoadmapDialog);
            } else { // create roadmap from macro browser or macro suggestion
                isCreateNew = true;
                Confluence.Roadmap.Analytics.insertRoadmap(); // insert new roadmap into editor
                constructRoadmapDialog();
            }
        }
    });

    function resizePopupPanel() {
      setTimeout(function () {
        if ($roadmapPopup && $roadmapPopup.is(":visible")) {
          var $popupHeight = $roadmapPopup.height(),
            $titleHeight = $roadmapPopup
              .find(".aui-dialog2-header")
              .outerHeight(),
            $buttonsHeight = $roadmapPopup
              .find(".aui-dialog2-footer")
              .outerHeight(),
            $toolbarHeight = $roadmapPopup
              .find("#roadmap-editor-toolbar")
              .outerHeight(),
            $roadmapEditorPopup = $roadmapPopup.find(".roadmap-editor-popup");
  
          $roadmapEditorPopup.css(
            "height",
            $popupHeight - $titleHeight - $buttonsHeight - $toolbarHeight
          );
        }
      }, 0);
    }

    $(window).resize(function () {
        resizePopupPanel();
        roadmapEditorView && roadmapEditorView.resize();
    })
})(AJS.$);

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources-conf-frontend', location = 'editor/roadmap-editor-config.js' */
/*
 * z-index management
 * - Main popup 3004
 * - Timeline options: 4010
 * - Roadmap dialog: 4011
 * - Color picker: 4012
 * $Tips: element one should be smaller than 4010 to avoid overriding others
 */

(function () {
    window.Roadmap = window.Roadmap || {};

    /** There is three kind of color
     * lane: use this color for lane title, border of bar and background of progress
     * bar: background of bar
     * text: title of bar
     */
    Roadmap.COLORS = [
        /*
           !important: CCECO-1290
                When updating these colors, please also modify their rgb matching styles
                and light/dark mode CSS overrides in timeline-planner-view.vm and roadmap-editor.css
                Thank you!
        */
        {
            lane: '#f6c342',
            bar: '#f6c342',
            text: '#594300'
        },
        {
            lane: '#3b7fc4',
            bar: '#3b7fc4',
            text: '#ffffff'
        },
        {
            lane: '#d04437',
            bar: '#d04437',
            text: '#ffffff'
        },
        {
            lane: '#8eb021',
            bar: '#8eb021',
            text: '#ffffff'
        },
        {
            lane: '#ea632b',
            bar: '#ea632b',
            text: '#ffffff'
        },
        {
            lane: '#654982',
            bar: '#654982',
            text: '#ffffff'
        },
        {
            lane: '#f15c75',
            bar: '#f15c75',
            text: '#ffffff'
        },
        {
            lane: '#227D9B',
            bar: '#227D9B',
            text: '#ffffff'
        }
    ];

    Roadmap.TIMELINE_DISPLAY_OPTION = {
        MONTH: 'MONTH',
        WEEK: 'WEEK'
    };

    Roadmap.SHORT_DATE_FORMAT = 'YYYY-MM-DD'; //date format from aui date picker
    Roadmap.TWO_YY_SHORT_DATE_FORMAT = 'YY-MM-DD';
    Roadmap.DATE_FORMAT = 'YYYY-MM-DD HH:mm:ss';

    // format in title of timeline.
    Roadmap.WEEK_FORMAT = 'DD-MMM';
    Roadmap.MONTH_FORMAT = 'MMM';

    Roadmap.TIMELINE_YEARS_LIMIT = 5;

    Roadmap.LANE_TITLE_WIDTH = 45;
    Roadmap.MARKER_HEIGHT_PADDING = 10;
    Roadmap.MARKER_TITLE_LINE = 2;
    Roadmap.LANE_PADDING = 11;
    Roadmap.BAR_PADDING = 8;
    Roadmap.BAR_MARGIN = 1;
    Roadmap.BAR_BORDER = 1;

    Roadmap.MONTH_WIDTH = 101;
    Roadmap.WEEK_WIDTH = 101;

    Roadmap.EXTRA_SPACE_AROUND = Roadmap.BAR_PADDING * 2 + Roadmap.BAR_BORDER * 2;
    Roadmap.MONTH_BAR_MIN_WIDTH = Roadmap.MONTH_WIDTH / 4 - Roadmap.EXTRA_SPACE_AROUND;
    Roadmap.WEEK_BAR_MIN_WIDTH = Roadmap.WEEK_WIDTH - Roadmap.EXTRA_SPACE_AROUND;

    Roadmap.barMinWidth = Roadmap.MONTH_BAR_MIN_WIDTH;

    /* This object is used to create an empty lane when reorder lanes, the aim is create a lane's structure only */
    Roadmap.TRANSPARENT_LANE = {
        title: '',
        color: {lane: '#ffffff', bar: '#ffffff', text: '#ffffff'}
    };

    // This is a namespace for all DragDrop configuration.
    Roadmap.DragDrop = {};

    // Config for Bar's details dialog
    Roadmap.BarDialog = {
        MAX_LENGTH_TITLE: 100,
        MAX_LENGTH_DESCRIPTION: 150
    };

    Roadmap.getDefaultRoadmapData = function () {
        // As default the duration is one year from current date
        var startDate = moment(new Date()).hours(0).minutes(0).seconds(0).milliseconds(0).toDate();
        var endDate = moment(startDate).add(11, 'months').toDate();
        return {
            title: "Roadmap Planner",
            timeline: {
                startDate: new Date(startDate),
                endDate: endDate,
                displayOption: Roadmap.TIMELINE_DISPLAY_OPTION.MONTH
            },
            lanes: [
                {
                    title: "Lane 1",
                    color: Roadmap.COLORS[0],
                    bars: [
                        {
                            title: "Bar 1",
                            description: "This is the first bar.",
                            startDate: new Date(startDate.setDate(1)),
                            duration: 2,
                            rowIndex: 0
                        },
                        {
                            title: "Bar 2",
                            description: "This is the second bar.",
                            startDate: new Date(startDate),
                            duration: 1,
                            rowIndex: 1
                        }
                    ]
                },
                {
                    title: "Lane 2",
                    color: Roadmap.COLORS[1],
                    bars: [
                        {
                            title: "Bar 3",
                            description: "This is the third bar.",
                            startDate: startDate,
                            duration: 2.5,
                            rowIndex: 0
                        }
                    ]
                }
            ],
            markers: [
                {
                    title: "Marker 1",
                    markerDate: moment(startDate).date(15).toDate()
                }
            ]
        }
    };
})();


}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:navigator-context', location = 'includes/js/api/navigator-context.js' */
define("confluence/api/navigator-context",["confluence/meta","document","window"],function(b,c,h){function n(a){var b={};if(a){"?"===a.substr(0,1)&&(a=a.substr(1));a=a.split("\x26");for(var c=0;c<a.length;c++){var d=a[c].split("\x3d");b[d[0]]||(b[d[0]]=[]);b[d[0]].push(a[c].substring(d[0].length+1))}}return b}var e=function(a){a=b.get(a);return!!a&&"0"!==a},k=function(a){return(a=a.match(/[^/?#]*\/plugins\/servlet\/ac\/([^/?#]*)\/([^/?#]*)$/))?{addonKey:a[1],moduleKey:a[2]}:null},l=function(){return 0<
c.querySelectorAll("[data-fabric-mode]").length},m=function(){return!!c.querySelector(".page.view")||!!c.querySelector(".blogpost.view")},f=function(){return!!c.querySelector(".page.edit")||!!c.querySelector(".blogpost.edit")||l()},g=function(){return b.get("content-type")},p=function(a){var b=k(a.pathname),c=n(a.search);a=Object.keys(c).reduce(function(a,b){a[decodeURIComponent(b).replace(/^ac\./g,"")]=c[b].map(decodeURIComponent);return a},{});return{target:"addonmodule",context:{addonKey:decodeURIComponent(b.addonKey),
moduleKey:decodeURIComponent(b.moduleKey),context:a}}};return{getCurrent:function(){return f()&&!e("page-id")&&e("draft-id")||0<c.querySelectorAll("[data-fabric-mode\x3d'create']").length?{target:"contentcreate",context:{contentId:l()?b.get("page-id"):b.get("draft-id"),contentType:g(),spaceKey:b.get("space-key")}}:f()&&!m()&&e("page-id")||0<c.querySelectorAll("[data-fabric-mode\x3d'edit']").length?{target:"contentedit",context:{contentId:b.get("page-id"),contentType:g(),spaceKey:b.get("space-key")}}:
!f()&&m()&&e("page-id")?{target:"contentview",context:{contentId:b.get("page-id"),contentType:g(),spaceKey:b.get("space-key")}}:null!=k(h.location.pathname)?p(h.location):{target:"unknown",context:{}}}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:dialog-options-v5', location = 'v5/js/iframe/host/dialog-options.js' */
!function(){window._AP=window._AP||{};var a=WRM.data.claim("com.atlassian.plugins.atlassian-connect-plugin:dialog-options.data");for(var n in a)a.hasOwnProperty(n)&&(window._AP[n]=a[n])}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-utils-v5', location = 'v5/js/iframe/host/util.js' */
window._AP=window._AP||{};_AP.util={escapeSelector:function(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")},isGlobalDefined:function(e){return void 0!==window[e]},awaitGlobal:function(e,r,t){t=t||100;if(_AP.util.isGlobalDefined(e))r(window[e]);else var a=setInterval((function(){if(_AP.util.isGlobalDefined(e)){clearInterval(a);r(window[e])}}),t)},getBooleanFeatureFlag:function(e){if(AJS&&AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled&&AJS.DarkFeatures.isEnabled(e))return!0;var r=document.querySelector('meta[name="ajs-fe-feature-flags"]');if(!r)return!1;var t=r.getAttribute("content");if(!t)return!1;var a={};try{a=JSON.parse(t)}catch(e){return!1}return!(!a[e]||"boolean"!=typeof a[e].value)&&a[e].value}};
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-core-v5', location = 'v5/js/core/connect-host.js' */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).connectHost=t()}(this,(function(){"use strict";function e(){return e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},e.apply(null,arguments)}function t(e,n){return t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},t(e,n)}function n(e,n){e.prototype=Object.create(n.prototype),e.prototype.constructor=e,t(e,n)}function r(){}r.prototype=Object.create(null);function i(){i.init.call(this)}i.EventEmitter=i;i.usingDomains=!1;i.prototype.domain=void 0;i.prototype._events=void 0;i.prototype._maxListeners=void 0;i.defaultMaxListeners=10;i.init=function(){this.domain=null;i.usingDomains&&undefined.active;if(!this._events||this._events===Object.getPrototypeOf(this)._events){this._events=new r;this._eventsCount=0}this._maxListeners=this._maxListeners||void 0};i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');this._maxListeners=e;return this};function o(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}i.prototype.getMaxListeners=function(){return o(this)};function a(e,t,n){if(t)e.call(n);else for(var r=e.length,i=h(e,r),o=0;o<r;++o)i[o].call(n)}function s(e,t,n,r){if(t)e.call(n,r);else for(var i=e.length,o=h(e,i),a=0;a<i;++a)o[a].call(n,r)}function u(e,t,n,r,i){if(t)e.call(n,r,i);else for(var o=e.length,a=h(e,o),s=0;s<o;++s)a[s].call(n,r,i)}function l(e,t,n,r,i,o){if(t)e.call(n,r,i,o);else for(var a=e.length,s=h(e,a),u=0;u<a;++u)s[u].call(n,r,i,o)}function c(e,t,n,r){if(t)e.apply(n,r);else for(var i=e.length,o=h(e,i),a=0;a<i;++a)o[a].apply(n,r)}i.prototype.emit=function(e){var t,n,r,i,o,d,f,p="error"===e;if(d=this._events)p=p&&null==d.error;else if(!p)return!1;f=this.domain;if(p){t=arguments[1];if(!f){if(t instanceof Error)throw t;var h=new Error('Uncaught, unspecified "error" event. ('+t+")");h.context=t;throw h}t||(t=new Error('Uncaught, unspecified "error" event'));t.domainEmitter=this;t.domain=f;t.domainThrown=!1;f.emit("error",t);return!1}if(!(n=d[e]))return!1;var g="function"==typeof n;switch(r=arguments.length){case 1:a(n,g,this);break;case 2:s(n,g,this,arguments[1]);break;case 3:u(n,g,this,arguments[1],arguments[2]);break;case 4:l(n,g,this,arguments[1],arguments[2],arguments[3]);break;default:i=new Array(r-1);for(o=1;o<r;o++)i[o-1]=arguments[o];c(n,g,this,i)}return!0};function d(e,t,n,i){var a,s,u,l;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if(s=e._events){if(s.newListener){e.emit("newListener",t,n.listener?n.listener:n);s=e._events}u=s[t]}else{s=e._events=new r;e._eventsCount=0}if(u){"function"==typeof u?u=s[t]=i?[n,u]:[u,n]:i?u.unshift(n):u.push(n);if(!u.warned&&(a=o(e))&&a>0&&u.length>a){u.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+u.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning";c.emitter=e;c.type=t;c.count=u.length;l=c,"function"==typeof console.warn?console.warn(l):console.log(l)}}else{u=s[t]=n;++e._eventsCount}return e}i.prototype.addListener=function(e,t){return d(this,e,t,!1)};i.prototype.on=i.prototype.addListener;i.prototype.prependListener=function(e,t){return d(this,e,t,!0)};function f(e,t,n){var r=!1;function i(){e.removeListener(t,i);if(!r){r=!0;n.apply(e,arguments)}}i.listener=n;return i}i.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.on(e,f(this,e,t));return this};i.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');this.prependListener(e,f(this,e,t));return this};i.prototype.removeListener=function(e,t){var n,i,o,a,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener&&n.listener===t)if(0==--this._eventsCount)this._events=new r;else{delete i[e];i.removeListener&&this.emit("removeListener",e,n.listener||t)}else if("function"!=typeof n){o=-1;for(a=n.length;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){s=n[a].listener;o=a;break}if(o<0)return this;if(1===n.length){n[0]=void 0;if(0==--this._eventsCount){this._events=new r;return this}delete i[e]}else!function(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}(n,o);i.removeListener&&this.emit("removeListener",e,s||t)}return this};i.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener){if(0===arguments.length){this._events=new r;this._eventsCount=0}else n[e]&&(0==--this._eventsCount?this._events=new r:delete n[e]);return this}if(0===arguments.length){for(var i,o=Object.keys(n),a=0;a<o.length;++a)"removeListener"!==(i=o[a])&&this.removeAllListeners(i);this.removeAllListeners("removeListener");this._events=new r;this._eventsCount=0;return this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this};i.prototype.listeners=function(e){var t,n,r=this._events;n=r&&(t=r[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[];return n};i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)};i.prototype.listenerCount=p;function p(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function h(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}var g=function(e){n(t,e);function t(){var t;(t=e.call(this)||this).setMaxListeners(20);return t}var r=t.prototype;r.dispatch=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.emit.apply(this,["before:"+e].concat(n));this.emit.apply(this,arguments);this.emit.apply(this,["after:"+e].concat(n))};r.registerOnce=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.once(e,t)};r.register=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.on(e,t)};r.unregister=function(e,t){if("string"!=typeof e)throw"ACJS: event name must be string";this.removeListener(e,t)};return t}(i),v=new g,y=function(e,t){v.dispatch("iframe-bridge-timeout",{$el:e,extension:t})},_=function(e,t){v.dispatch("iframe-bridge-cancelled",{$el:e,extension:t})},m=window.AJS&&window.AJS.$||function(){console.error("[ACJS] jQuery was not loaded before Connect. If in product frontend, make sure to load via a wrapper, eg withConnectHost()")},b="ap-status-indicator",w='<div class="ap-loading"><div class="small-spinner"></div>Loading app...</div>',x='<div class="ap-load-timeout"><div class="small-spinner"></div>App is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?</div>',E="App failed to load.",k=new(function(){function e(){this._stateRegistry={}}var t=e.prototype;t._loadingContainer=function(e){return e.find(".ap-status-indicator")};t.render=function(){var e=document.createElement("div");e.classList.add(b);e.innerHTML=w;var t=m(e);this._startSpinner(t);return t};t._startSpinner=function(e){setTimeout((function(){var t=e.find(".small-spinner");t.length&&t.spin&&t.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})}),10)};t.hide=function(e,t){this._clearTimeout(t);this._loadingContainer(e)[0].style.display="none"};t.cancelled=function(e,t){var n=E;this._loadingContainer(e).empty().text(n)};t._setupTimeout=function(e,t){this._stateRegistry[t.id]=setTimeout((function(){y(e,t)}),12e3)};t._clearTimeout=function(e){if(this._stateRegistry[e]){clearTimeout(this._stateRegistry[e]);delete this._stateRegistry[e]}};t.timeout=function(e,t){var n=m(x),r=this._loadingContainer(e);r.empty().append(n);this._startSpinner(r);m("a.ap-btn-cancel",r).click((function(){_(e,t)}));this._clearTimeout(t);return r};return e}());v.register("iframe-create",(function(e){e.extension.options.noDom||k._setupTimeout(e.$el.parents(".ap-iframe-container"),e.extension)}));v.register("iframe-bridge-established",(function(e){e.extension.options.noDom||k.hide(e.$el.parents(".ap-iframe-container"),e.extension.id)}));v.register("iframe-bridge-timeout",(function(e){e.extension.options.noDom||k.timeout(e.$el,e.extension.id)}));v.register("iframe-bridge-cancelled",(function(e){e.extension.options.noDom||k.cancelled(e.$el,e.extension.id)}));v.register("iframe-destroyed",(function(e){k._clearTimeout(e.extension.extension_id)}));function O(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}var S="[Simple-XDM] ",A=Function.prototype.bind,C={locationOrigin:function(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},randomString:function(){return Math.floor(1e9*Math.random()).toString(16)},isString:function(e){return"string"==typeof e||e instanceof String},argumentsToArray:function(e){return Array.prototype.slice.call(e)},argumentNames:function(e){return e.toString().replace(/((\/\/.*$)|(\/\*[^]*?\*\/))/gm,"").replace(/[^(]+\(([^)]*)[^]+/,"$1").match(/([^\s,]+)/g)||[]},hasCallback:function(e){var t=e.length;return t>0&&"function"==typeof e[t-1]},error:function(e){if(window.console&&window.console.error){var t=[];if("string"==typeof e){t.push(S+e);t=t.concat(Array.prototype.slice.call(arguments,1))}else{t.push(S);t=t.concat(Array.prototype.slice.call(arguments))}window.console.error.apply(null,t)}},warn:function(e){window.console&&console.warn(S+e)},log:function(e){window.console&&window.console.log(S+e)},_bind:function(e,t){return A&&t.bind===A?t.bind(e):function(){return t.apply(e,arguments)}},throttle:function(e,t,n){var r=0;return function(){var i=Date.now();if(i-r>t){r=i;e.apply(n,arguments)}}},each:function(e,t){var n,r;if(e)if(null!=(n=e.length)&&"function"!=typeof e){r=0;for(;r<n&&!1!==t.call(e[r],r,e[r]);)r+=1}else for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(e[r],r,e[r]))break},extend:function(e){var t=arguments,n=[].slice.call(t,1,t.length);n.forEach((function(t){"object"==typeof t&&Object.getOwnPropertyNames(t).forEach((function(n){e[n]=t[n]}))}));return e},sanitizeStructuredClone:function(e){var t=[Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer],n=[Error,Node],r=C.warn,i=[];return function e(o){if("function"==typeof o){r("A function was detected and removed from the message.");return null}if(n.some((function(e){if(o instanceof e){r(e.name+" object was detected and removed from the message.");return!0}return!1})))return{};if(o&&"object"==typeof o&&t.every((function(e){return!(o instanceof e)}))){var a;if(Array.isArray(o))a=o.map((function(t){return e(t)}));else{if(i.indexOf(o)>-1){r("A circular reference was detected and removed from the message.");return null}i.push(o);a={};for(var s in o)if(o.hasOwnProperty(s)){var u=e(o[s]);null!==u&&(a[s]=u)}i.pop()}return a}return o}(e)},getOrigin:function(e,t){if("function"==typeof URL)try{return new URL(e,t).origin}catch(e){}var n=document.implementation.createHTMLDocument("");if(t){var r=n.createElement("base");r.href=t;n.head.appendChild(r)}var i=n.createElement("a");i.href=e;n.body.appendChild(i);var o=i.protocol+"//"+i.hostname;e.match(/\/\/[^/]+:[0-9]+\//)&&(o+=i.port?":"+i.port:"");return o}},I=["platform-visual-refresh-icons"];function L(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(L=function(){return!!e})()}function T(e,n,r){if(L())return Reflect.construct.apply(null,arguments);var i=[null];i.push.apply(i,n);var o=new(e.bind.apply(e,i));return r&&t(o,r.prototype),o}var P=function(e){n(r,e);var t=r.prototype;t._padUndefinedArguments=function(e,t){return e.length>=t?e:e.concat(new Array(t-e.length))};function r(t){var n;t=t||{};(n=e.call(this,t)||this)._registeredExtensions=t.extensions||{};n._registeredAPIModules={};n._registeredAPIModules._globals={};n._pendingCallbacks={};n._keycodeCallbacks={};n._clickHandlers=[];n._pendingEvents={};n._messageHandlers={init:n._handleInit,req:n._handleRequest,resp:n._handleResponse,broadcast:n._handleBroadcast,event_query:n._handleEventQuery,key_triggered:n._handleKeyTriggered,addon_clicked:n._handleAddonClick,get_host_offset:n._getHostOffset,unload:n._handleUnload};return n}t._verifyAPI=function(e,t){var n=e.data.targets;if(n){var r=this.getApiSpec(),i=!1;!function e(t,n){Object.getOwnPropertyNames(n).forEach((function(r){"object"==typeof n[r]&&t[r]?e(t[r],n[r]):"parent"===n[r]&&t[r]&&(i=!0)}))}(r,n);e.source&&e.source.postMessage?e.source.postMessage({type:"api_tamper",tampered:i},t.extension.url):console.warn("_verifyAPI postMessage skipped as event source missing.")}};t._handleInit=function(e,t){e.source&&e.source.postMessage?e.source.postMessage({type:"init_received"},t.extension.url):console.warn("_handleInit postMessage skipped as event source missing.");this._registeredExtensions[t.extension_id].source=e.source;if(t.initCallback){t.initCallback(e.data.eid);delete t.initCallback}e.data.targets&&this._verifyAPI(e,t)};t._getHostOffset=function(e,t){var n=e.source,r=null,i=t||window;i===i.top&&"function"==typeof i.getHostOffsetFunctionOverride&&(r=i.getHostOffsetFunctionOverride(n));if("number"!=typeof r){r=0;for(;!this._hasSameOrigin(n);){r++;n=n.parent}}e.source&&e.source.postMessage?e.source.postMessage({hostFrameOffset:r},e.origin):console.warn("_getHostOffset postMessage skipped as event source missing.")};t._hasSameOrigin=function(e){if(e===e.top)return!0;try{var t="test_var_"+Math.random().toString(16).substr(2);e[t]=!0;return e[t]}catch(e){}return!1};t._handleResponse=function(e){var t=e.data,n=this._pendingCallbacks[t.mid];if(n){delete this._pendingCallbacks[t.mid];n.apply(window,t.args)}};t.registerRequestNotifier=function(e){this._registeredRequestNotifier=e};t._handleRequest=function(e,t){function n(){var n=C.sanitizeStructuredClone(C.argumentsToArray(arguments));e.source&&e.source.postMessage?e.source.postMessage({mid:e.data.mid,type:"resp",forPlugin:!0,args:n},t.extension.url):console.warn("_handleRequest postMessage skipped as event source missing.")}var r=e.data,i=this._registeredAPIModules[r.mod],o=this.getRegisteredExtensions(t.extension)[0];if(i){var a=r.fn;if(r._cls){var s=i[r._cls],u=r.mod+"-"+r._cls+"-";n._id=r._id;if("constructor"===a){if(!s._construct){s.constructor.prototype._destroy=function(){delete this._context._proxies[u+this._id]};s._construct=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=T(s.constructor,t),i=t[t.length-1];r._id=i._id;r._context=i._context;r._context._proxies[u+r._id]=r;return r}}i=s;a="_construct"}else i=o._proxies[u+r._id]}var l=i[a];if(l){var c=r.args,d=l.length-1;"_construct"===a&&(d=i.constructor.length-1);n._context=o;(c=this._padUndefinedArguments(c,d)).push(n);var f=l.apply(i,c);l.returnsPromise&&("object"!=typeof f&&"function"!=typeof f||"function"!=typeof f.then?n("Defined module method did not return a promise."):f.then((function(e){n(void 0,e)})).catch((function(e){n(e=e instanceof Error?e.message:e)})));this._registeredRequestNotifier&&this._registeredRequestNotifier.call(null,{module:r.mod,fn:r.fn,type:r.type,args:c,addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})}}};t._handleBroadcast=function(e,t){var n=e.data;this.dispatch(n.etyp,(function(e){return e.extension.addon_key===t.extension.addon_key&&e.extension_id!==t.extension_id}),n.evnt,null,null)};t._handleKeyTriggered=function(e,t){var n=e.data,r=this._keycodeKey(n.keycode,n.modifiers,t.extension_id),i=this._keycodeCallbacks[r];i&&i.forEach((function(e){e.call(null,{addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id,keycode:n.keycode,modifiers:n.modifiers})}),this)};t.defineAPIModule=function(e,t){t=t||"_globals";this._registeredAPIModules[t]=C.extend({},this._registeredAPIModules[t]||{},e);return this._registeredAPIModules};t.isAPIModuleDefined=function(e){return void 0!==this._registeredAPIModules[e]};t._pendingEventKey=function(e,t){var n=e.addon_key||"global";e.key&&(n=n+"@@"+e.key);return n=n+"@@"+t};t.queueEvent=function(e,t,n,r){if(this._findRegistrations(t).some((function(e){return void 0!==e.registered_events}),this))this.dispatch(e,t,n,r);else{this._cleanupInvalidEvents();var i=(new Date).getTime();this._pendingEvents[this._pendingEventKey(t,i)]={type:e,targetSpec:t,event:n,callback:r,time:i,uid:C.randomString()}}};t._cleanupInvalidEvents=function(){var e=this,t=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(n){var r=e._pendingEvents[n];t-r.time<=3e4||delete e._pendingEvents[n]}))};t._handleEventQuery=function(e,t){var n=this,r={},i=(new Date).getTime();Object.keys(this._pendingEvents).forEach((function(o){var a=n._pendingEvents[o],s=i-a.time<=3e4,u=!a.targetSpec||0!==n._findRegistrations(a.targetSpec).length;u&&a.targetSpec.key&&(u=a.targetSpec.addon_key===t.extension.addon_key&&a.targetSpec.key===t.extension.key);if(s&&u){r[o]=a;a.targetSpec=a.targetSpec||{};n.dispatch(a.type,a.targetSpec,a.event,a.callback,e.source)}else s||delete n._pendingEvents[o]}));this._registeredExtensions[t.extension_id].registered_events=e.data.args;return r};t._handleUnload=function(e,t){if(t){t.extension_id&&this._registeredExtensions[t.extension_id]&&delete this._registeredExtensions[t.extension_id].source;t.unloadCallback&&t.unloadCallback(e.data.eid)}};t.dispatch=function(e,t,n,r,i){function o(t,n){if(t.source&&t.source.postMessage){var i;if(r){i=C.randomString();this._pendingCallbacks[i]=r}t.source.postMessage({type:"evt",mid:i,etyp:e,evnt:n},t.extension.url)}}this._findRegistrations(t||{}).forEach((function(e){i&&!e.source&&(e.source=i);e.source&&C._bind(this,o)(e,n)}),this)};t._findRegistrations=function(e){var t=this;if(0===this._registeredExtensions.length){C.error("no registered extensions",this._registeredExtensions);return[]}var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(this._registeredExtensions).map((function(e){return t._registeredExtensions[e]}));return e instanceof Function?r.filter(e):r.filter((function(t){return n.every((function(n){return t.extension[n]===e[n]}))}))};t.registerExtension=function(e,t){t._proxies={};t.extension_id=e;this._registeredExtensions[e]=t};t._keycodeKey=function(e,t,n){var r=e;if(t){"string"==typeof t&&(t=[t]);t.sort();t.forEach((function(e){r+="$$"+e}),this)}return r+"__"+n};t.registerKeyListener=function(e,t,n,r){"string"==typeof n&&(n=[n]);var i=this._registeredExtensions[e],o=this._keycodeKey(t,n,e);if(!this._keycodeCallbacks[o]){this._keycodeCallbacks[o]=[];i.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"add"},i.extension.url)}this._keycodeCallbacks[o].push(r)};t.unregisterKeyListener=function(e,t,n,r){var i=this._keycodeKey(t,n,e),o=this._keycodeCallbacks[i],a=this._registeredExtensions[e];if(o){if(r){var s=o.indexOf(r);this._keycodeCallbacks[i].splice(s,1)}else delete this._keycodeCallbacks[i];a.source&&a.source.postMessage&&a.source.postMessage({type:"key_listen",keycode:t,modifiers:n,action:"remove"},a.extension.url)}};t.registerClickHandler=function(e){if("function"!=typeof e)throw new Error("callback must be a function");this._clickHandlers.push(e)};t._handleAddonClick=function(e,t){for(var n=0;n<this._clickHandlers.length;n++)"function"==typeof this._clickHandlers[n]&&this._clickHandlers[n]({addon_key:t.extension.addon_key,key:t.extension.key,extension_id:t.extension_id})};t.unregisterClickHandler=function(){this._clickHandlers=[]};t.getApiSpec=function(e){var t=this;function n(e){return Object.getOwnPropertyNames(e).reduce((function(t,r){var i=e[r];switch(typeof i){case"function":t[r]={args:C.argumentNames(i),returnsPromise:i.returnsPromise||!1};break;case"object":i.hasOwnProperty("constructor")&&(t[r]=n(i))}return t}),{})}return Object.getOwnPropertyNames(this._registeredAPIModules).reduce((function(r,i){var o=t._registeredAPIModules[i];void 0!==o.addonKey&&o.addonKey!==e||(r[i]=n(o));return r}),{})};t._originEqual=function(e,t){function n(e){return"string"==typeof e&&e.length>0}var r=C.getOrigin(e);return!!(n(e)&&n(t)&&n(r))&&t===r};t._checkOrigin=function(e,t){var n=t&&["init"].includes(e.data.type),r=t&&e.source===t.source,i=t&&this._originEqual(t.extension.url,e.origin)&&(n||r);"get_host_offset"===e.data.type&&window===window.top&&(i=!0);"unload"!==e.data.type||!r&&void 0!==e.source||(i=!0);return i};t.getRegisteredExtensions=function(e){return e?this._findRegistrations(e):this._registeredExtensions};t.unregisterExtension=function(e){var t=this._findRegistrations(e);0!==t.length&&t.forEach((function(e){var t=this;Object.keys(this._pendingEvents).forEach((function(n){var r=t._pendingEvents[n].targetSpec||{};r.addon_key===e.extension.addon_key&&r.key===e.extension.key&&delete t._pendingEvents[n]}));delete this._registeredExtensions[e.extension_id]}),this)};t.setFeatureFlagGetter=function(e){this._getBooleanFeatureFlag=e};return r}(function(){function e(e){var t=e||{};this._registerListener(t.listenOn)}var t=e.prototype;t._registerListener=function(e){e&&e.addEventListener||(e=window);e.addEventListener("message",C._bind(this,this._receiveMessage),!1)};t._receiveMessage=function(e){var t,n=this._messageHandlers[e.data.type],r=e.data.eid;r&&this._registeredExtensions&&(t=this._registeredExtensions[r]);if(!n||!this._checkOrigin(e,t))return!1;n.call(this,e,t)};return e}()),D=function(){function e(){this._xdm=new P}var t=e.prototype;t.dispatch=function(e,t,n,r){this._xdm.queueEvent(e,t,n,r);return this.getExtensions(t)};t.broadcast=function(e,t,n){this._xdm.dispatch(e,t,n,null,null);return this.getExtensions(t)};t._createId=function(e){if(!e.addon_key||!e.key)throw Error("Extensions require addon_key and key");return e.addon_key+"__"+e.key+"__"+C.randomString()};t.create=function(e,t,n){var r=this.registerExtension(e,t,n),i=e.options||{};i.platformFeatureFlags=function(){var e={};window.connectHost&&window.connectHost.getBooleanFeatureFlag&&I.forEach((function(t){return e[t]=window.connectHost.getBooleanFeatureFlag(t)}));return e}();var o={extension_id:r,api:this._xdm.getApiSpec(e.addon_key),origin:C.locationOrigin(),options:i};return{id:r,name:JSON.stringify(o),src:e.url}};t.registerRequestNotifier=function(e){this._xdm.registerRequestNotifier(e)};t.registerExtension=function(e,t,n){var r=this._createId(e);this._xdm.registerExtension(r,{extension:e,initCallback:t,unloadCallback:n});return r};t.registerKeyListener=function(e,t,n,r){this._xdm.registerKeyListener(e,t,n,r)};t.unregisterKeyListener=function(e,t,n,r){this._xdm.unregisterKeyListener(e,t,n,r)};t.registerClickHandler=function(e){this._xdm.registerClickHandler(e)};t.unregisterClickHandler=function(){this._xdm.unregisterClickHandler()};t.defineModule=function(e,t,n){this._xdm.defineAPIModule(t,e,n)};t.isModuleDefined=function(e){return this._xdm.isAPIModuleDefined(e)};t.defineGlobals=function(e){this._xdm.defineAPIModule(e)};t.getExtensions=function(e){return this._xdm.getRegisteredExtensions(e)};t.unregisterExtension=function(e){return this._xdm.unregisterExtension(e)};t.returnsPromise=function(e){e.returnsPromise=!0};t.setFeatureFlagGetter=function(e){this._xdm.setFeatureFlagGetter(e)};t.registerExistingExtension=function(e,t){return this._xdm.registerExtension(e,t)};return e}(),M=new D,j=["contextJwt","url"],F=function(e){var t;return"dialogs"!==(null==e||null==(t=e.extension)||null==(t=t.options)?void 0:t.moduleType)},V=function(e,t,n){M.dispatch(e,t,n);v.dispatch("event-dispatch",{type:e,targetSpec:t,event:n})},N=function(e,t,n){v.dispatch("event-public-dispatch",{type:e,event:t,sender:n});var r=n.options||{};r.contextJwt;r.url;var i=O(r,j);M.dispatch(e,{},{sender:{addonKey:n.addon_key,key:n.key,options:C.sanitizeStructuredClone(i)},event:t})};function R(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}var G,U={escapeSelector:R,stringToDimension:function(e){var t=!1,n="px";if("string"==typeof e){t=e.indexOf("%")===e.length-1;e=parseInt(e,10);t&&(n="%")}if(!isNaN(e))return e+n},getIframeByExtensionId:function(e){return m("iframe#"+R(e))},first:function(e,t){return t?e.slice(0,t):e[0]},last:function(e){return e[e.length-1]},pick:function(e,t){return"object"!=typeof e?{}:Object.keys(e).filter((function(e){return t.indexOf(e)>=0})).reduce((function(t,n){var r;return Object.assign(t,((r={})[n]=e[n],r))}),{})},debounce:function(e,t){var n;return function(){var r=this,i=[].slice.call(arguments);function o(){n=null;e.apply(r,i)}n&&clearTimeout(n);n=setTimeout(o,t||50)}},isSupported:function(e,t,n,r){return e&&e[t]&&e[t].supports?e[t].supports(n):r},extend:Object.assign,guessProductFromModuleDefined:function(e){return e.isModuleDefined("jira")?"Jira":e.isModuleDefined("confluence")?"Confluence":""},guessIsJiraFromMetaTag:function(){return"JIRA"===m("meta[name='application-name']").attr("content")}},B={emit:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=U.last(n);n=U.first(n,-1);V(e,{addon_key:i._context.extension.addon_key},n)},emitPublic:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=U.last(n),o=i._context.extension;n=U.first(n,-1);N(e,n,o)},emitToDataProvider:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=U.last(t);r._context.extension;t=U.first(t,-1);V("dataProviderEvent",{addon_key:r._context.extension.addon_key},t)}},z=function(e,t){v.dispatch("dialog-extension-open",{extension:e,options:t})},K=function(){v.dispatch("dialog-close-active",{})},J=function(e,t){v.dispatch("dialog-button-add",{button:{text:e.text,identifier:e.identifier,data:{userButton:!0}},extension:t})},$={close:function(e){v.dispatch("dialog-close",{dialog:e.dialog,extension:e.extension,customData:e.customData})},closeActive:function(e){v.dispatch("dialog-close-active",e)},clickButton:function(e,t,n){v.dispatch("dialog-button-click",{identifier:e,$el:t,extension:n})},toggleButton:function(e){v.dispatch("dialog-button-toggle",e)},toggleButtonVisibility:function(e){v.dispatch("dialog-button-toggle-visibility",e)}},W=function(e){M.registerKeyListener(e.extension_id,e.key,e.modifiers,e.callback);v.dispatch("dom-event-register",e)},q=function(e){M.unregisterKeyListener(e.extension_id,e.key,e.modifiers,e.callback);v.dispatch("dom-event-unregister",e)},H=function(e){window.addEventListener("keydown",(function(t){t.keyCode===e.keyCode&&e.callback()}))},X=function(e){M.registerClickHandler((function(t){var n=document.getElementById(t.extension_id);n&&e(n,t)}))},Y=function(){M.unregisterClickHandler()},Q=new(function(){function e(){}e.prototype.randomIdentifier=function(){return Math.random().toString(16).substring(7)};return e}()),Z=[];if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window){var ee=new IntersectionObserver((function(e){e.forEach((function(e){var t=e.intersectionRatio,n=e.target;if(t>0){ee.unobserve(n);!function(e){Z=Z.filter((function(t){var n=t.element,r=t.callback;if(n===e){r();return!1}return!0}))}(n)}}))}),{threshold:.25});G=ee.observe.bind(ee)}var te=["saveMacro"],ne=function(){function t(){this._addons={};this._sampleLoadEvent=new Map;this._sampleWebVitalsEvent=new Map}var n=t.prototype;n._shouldSampleEvent=function(e){return 100*Math.random()<=e};n._shouldSampleLoadEvent=function(e){if(this._sampleLoadEvent.has(e.id))return this._sampleLoadEvent.get(e.id);var t=this._shouldSampleEvent(.1);this._sampleLoadEvent.set(e.id,t);return t};n._shouldSampleWebVitalsEvent=function(e){if(this._sampleWebVitalsEvent.has(e.id))return this._sampleWebVitalsEvent.get(e.id);var t=this._shouldSampleEvent(1);this._sampleWebVitalsEvent.set(e.id,t);return t};n._trackGasV3=function(e,t,n){t.attributes&&(t.attributes.apVersion=window._AP&&window._AP.version?window._AP.version:void 0);n&&this._forwardGasV3AnalyticsEvent(e,t);try{window.require("ac/analytics").emitGasV3(e,t)}catch(e){window.Confluence||window.__karma__||console.info("Connect GasV3 catch",e)}};n._trackAndForwardGasV3=function(e,t){this._trackGasV3(e,t,!0)};n._forwardGasV3AnalyticsEvent=function(e,t){v.dispatch("analytics-forward-event",e,t)};n._time=function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()};n.trackLoadingStarted=function(e){if(this._addons&&e&&e.id){e.startLoading=this._time();this._addons[e.id]=e}else console.error("ACJS: cannot track loading analytics",this._addons,e)};n.trackGasV3UseOfDeprecatedMethod=function(e,t){this._trackAndForwardGasV3("operational",{action:"deprecatedMethod",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,methodUsed:e},source:t.addon_key})};n.trackGasV3MultipleDialogOpening=function(e,t){this._trackAndForwardGasV3("operational",{action:"multipleDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,dialogType:e},source:t.addon_key})};n.trackIframePerformance=function(e,t){this._shouldSampleLoadEvent(t)&&this._trackGasV3("operational",{source:t.addon_key,action:"iframeRendered",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{key:t.key,pearApp:this._getPearApp(t),moduleType:this._getModuleType(t),iframeIsCacheable:this._isCacheable(t),moduleLocation:this._getModuleLocation(t),domainLookupTime:e.domainLookupTime,connectionTime:e.connectionTime,decodedBodySize:e.decodedBodySize,domContentLoadedTime:e.domContentLoadedTime,fetchTime:e.fetchTime}})};n.trackGasV3WebVitals=function(e,t){this._shouldSampleWebVitalsEvent(t)&&this._trackAndForwardGasV3("operational",{source:t.addon_key,action:"webVitals",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:Object.assign({},e,{key:t.key,pearApp:this._getPearApp(t),moduleType:this._getModuleType(t),iframeIsCacheable:this._isCacheable(t),moduleLocation:this._getModuleLocation(t)})})};n.dispatch=function(e,t){this._trackGasV3External(e,t)};n.trackExternal=function(e,t){this._trackGasV3External(e,t)};n._trackGasV3External=function(t,n){this._trackAndForwardGasV3("operational",{action:"externalEvent",actionSubject:"connectAddon",actionSubjectId:t,attributes:e({eventName:t},"object"==typeof n?n:{values:n}),source:"connectAddon"})};n._resetAnalyticsDueToUnreliable=function(e){if(!e)throw new Error("Cannot reset analytics due to no extension id");if(this._addons[e]){clearTimeout(this._addons[e]);delete this._addons[e]}else console.info("Cannot clear analytics, cache does not contain extension id")};n._isCacheable=function(e){var t=e.url;return void 0!==t&&-1===t.indexOf("xdm_e=")};n._getModuleType=function(e){return e.options?e.options.moduleType:void 0};n._getModuleLocation=function(e){return e.options?e.options.moduleLocation:void 0};n._getPearApp=function(e){return e.options&&"true"===e.options.pearApp};n.trackGasV3Visible=function(e){this._shouldSampleLoadEvent(e)&&this._trackGasV3("operational",{action:"iframeViewed",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})};n.trackGasV3InvokeMethod=function(e,t,n,r){if(this._shouldSampleEvent(.1)||te.includes(n)){for(var i,o=Array.isArray(r)?[].concat(r):[];o.length>0&&(void 0===o[o.length-1]||"function"==typeof(i=o[o.length-1])&&Boolean(i._context));)o.pop();var a=o.map((function(e){return Array.isArray(e)?"array":null===e?"null":typeof e}));this._trackAndForwardGasV3("operational",{action:"invokeMethod",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{argCount:o.length,argTypes:a,module:t,method:n,moduleType:this._getModuleType(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})}};n.trackGasV3ContentResolver=function(e,t){if(this._shouldSampleEvent(.1)){var n=t.extension,r=t.attrs,i=e?"contentResolverSucceeded":"contentResolverFailed";this._trackGasV3("operational",{action:i,actionSubject:"connectAddon",actionSubjectId:n.addon_key,attributes:Object.assign({},r,{moduleType:this._getModuleType(n),moduleKey:n.key,moduleLocation:this._getModuleLocation(n),pearApp:this._getPearApp(n)}),source:n.addon_key})}};n.trackGasV3LoadingEnded=function(e){if(this._shouldSampleLoadEvent(e)){var t,n,r=this._time()-this._addons[e.id].startLoading;this._trackGasV3("operational",{action:"iframeLoaded",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),iframeLoadMillis:r,iframeLoadBucket:(t=r,n=t>2e4?2e4:t,100*Math.ceil(n/100)),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e)},source:e.addon_key})}};n.trackGasV3LoadingTimeout=function(e){this._shouldSampleLoadEvent(e)&&this._trackGasV3("operational",{action:"iframeTimeout",actionSubject:"connectAddon",actionSubjectId:e.addon_key,attributes:{moduleType:this._getModuleType(e),iframeIsCacheable:this._isCacheable(e),moduleKey:e.key,moduleLocation:this._getModuleLocation(e),pearApp:this._getPearApp(e),connectedStatus:"boolean"==typeof window.navigator.onLine?window.navigator.onLine.toString():"not-supported"},source:e.addon_key})};n.trackGasV3InlineDialogOpened=function(e){var t=e.extension;this._trackAndForwardGasV3("operational",{action:"inlineDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,moduleLocation:this._getModuleLocation(t),eventType:e.eventType,onHoverEnabled:e.onHover},source:t.addon_key})};n.trackGasV3LegacyDialogOpened=function(e){var t=e.extension;this._trackAndForwardGasV3("operational",{action:"legacyDialogOpened",actionSubject:"connectAddon",actionSubjectId:t.addon_key,attributes:{moduleKey:t.key,moduleLocation:this._getModuleLocation(t),parentIds:e.parentIds},source:t.addon_key})};n.trackGasV3FeatureFlagDefaultFalse=function(e){var t;this._trackAndForwardGasV3("operational",((t={action:"returned",actionSubject:"defaultFalseFeatureFlag",actionSubjectId:e,source:"host",attributes:{featureFlag:e}}).source="Host",t))};n.trackGasV3IframeClicked=function(e){this._trackAndForwardGasV3("ui",{action:"iframeClicked",actionSubject:"connectAddon",source:"host",attributes:{appId:e.addonKey,moduleType:e.moduleType,moduleLocation:e.moduleLocation,baseUrl:e.baseUrl}})};return t}(),re=new ne;m.fn&&v.register("iframe-create",(function(e){re.trackLoadingStarted(e.extension)}));v.register("method-invoked",(function(e){re.trackGasV3InvokeMethod(e.extension,e.module,e.fn,e.args)}));v.register("iframe-bridge-start",(function(e){re.trackLoadingStarted(e.extension)}));v.register("iframe-bridge-established",(function(e){re.trackGasV3LoadingEnded(e.extension);!function(e,t){if("function"==typeof t&&e instanceof Element){Z.push({element:e,callback:t});G(e)}}(document.getElementById(e.extension.id),(function(){v.dispatch("iframe-visible",e.extension);re.trackGasV3Visible(e.extension)}))}));v.register("iframe-bridge-timeout",(function(e){re.trackGasV3LoadingTimeout(e.extension)}));v.register("analytics-deprecated-method-used",(function(e){re.trackGasV3UseOfDeprecatedMethod(e.methodUsed,e.extension)}));v.register("analytics-iframe-performance",(function(e){re.trackIframePerformance(e.metrics,e.extension)}));v.register("analytics-web-vitals",(function(e){re.trackGasV3WebVitals(e.metrics,e.extension)}));v.register("iframe-destroyed",(function(e){re._resetAnalyticsDueToUnreliable(e.extension.extension_id)}));v.register("analytics-external-event-track",(function(e){re.trackExternal(e.eventName,e.values)}));v.register("analytics-content-resolver-track",(function(e){var t=e.success,n=e.extra;re.trackGasV3ContentResolver(t,n)}));v.register("analytics-inline-dialog-opened",(function(e){re.trackGasV3InlineDialogOpened(e)}));v.register("analytics-legacy-dialog-opened",(function(e){re.trackGasV3LegacyDialogOpened(e)}));v.register("analytics-track-iframe-clicked",(function(e){re.trackGasV3IframeClicked(e)}));var ie=new(function(){function e(){}var t=e.prototype;t._maxDimension=function(e,t){var n=U.stringToDimension(e),r=parseInt(n,10),i=parseInt(t,10);return n.indexOf("%")>-1&&r>=100||r>i?"100%":n};t._closeOnEscape=function(e){return!1!==e.closeOnEscape};t._size=function(e){var t=e.size;"x-large"===e.size&&(t="xlarge");"maximum"!==e.size&&"100%"===e.width&&"100%"===e.height&&(t="fullscreen");return t};t._header=function(e){var t="";switch(typeof e){case"string":t=e;break;case"object":t=e.value}return t};t._hint=function(e){return"string"==typeof e?e:""};t._chrome=function(e){var t=!1;"boolean"==typeof e.chrome&&(t=e.chrome);"fullscreen"===e.size&&(t=!0);"maximum"===e.size&&(t=!1);return t};t._width=function(e){if(!e.size)return e.width?this._maxDimension(e.width,m(window).width()):"50%"};t._height=function(e){if(!e.size)return e.height?this._maxDimension(e.height,m(window).height()):"50%"};t._actions=function(e){var t=[];(e=e||{}).actions||(t=[{name:"submit",identifier:"submit",text:e.submitText||"Submit",type:"primary",disabled:!0},{name:"cancel",identifier:"cancel",text:e.cancelText||"Cancel",type:"link",immutable:!0}]);e.buttons&&(t=t.concat(this._buttons(e)));return t};t._id=function(e){"string"!=typeof e&&(e=Math.random().toString(36).substring(2,8));return e};t._buttons=function(e){var t=[];e.buttons&&Array.isArray(e.buttons)&&e.buttons.forEach((function(e){var n,r,i=!1;e.text&&"string"==typeof e.text&&(n=e.text);r=e.identifier&&"string"==typeof e.identifier?e.identifier:Q.randomIdentifier();e.disabled&&!0===e.disabled&&(i=!0);t.push({text:n,identifier:r,type:"secondary",custom:!0,disabled:i})}));return t};t._onHide=function(e){return"function"==typeof e.onHide?e.onHide:function(){}};t.sanitizeOptions=function(e){e=e||{};var t={chrome:this._chrome(e),header:this._header(e.header),hint:this._hint(e.hint),width:this._width(e),height:this._height(e),$content:e.$content,extension:e.extension,actions:this._actions(e),id:this._id(e.id),size:e.size,closeOnEscape:this._closeOnEscape(e),onHide:this._onHide(e)};t.size=this._size(t);return t};t.moduleOptionsFromGlobal=function(e,t){return!!(window._AP&&window._AP.dialogModules&&window._AP.dialogModules[e]&&window._AP.dialogModules[e][t])&&U.extend({},{chrome:!0,hostFrameOffset:1},window._AP.dialogModules[e][t].options)};t.trackMultipleDialogOpening=function(e,t){var n,r=this._size(t);if(m(".ap-aui-dialog2:visible").length){n=m("#macro-browser-dialog").length||AJS.Confluence&&AJS.Confluence.Editor&&AJS.Confluence.Editor.currentEditMode?"fullscreen"===r?"connect-macro-multiple-fullscreen":"connect-macro-multiple":"connect-multiple";re.trackGasV3MultipleDialogOpening(n,e)}};t.assertActiveDialogOrThrow=function(e,t){if(!e.isActiveDialog(t))throw new Error("Failed to find an active dialog for: "+t)};return e}()),oe={notifyIframeCreated:function(e,t){v.dispatch("iframe-create",{$el:e,extension:t})},notifyBridgeEstablished:function(e,t){v.dispatch("iframe-bridge-established",{$el:e,extension:t})},notifyIframeDestroyed:function(e){"string"==typeof e&&(e={id:e});M.getExtensions(e).forEach((function(e){v.dispatch("iframe-destroyed",{extension:e});M.unregisterExtension({id:e.extension_id})}),this)},notifyUnloaded:function(e,t){v.dispatch("iframe-unload",{$el:e,extension:t})}},ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function se(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ue={},le=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))},ce="%[a-f0-9]{2}",de=new RegExp("("+ce+")|([^%]+?)","gi"),fe=new RegExp("("+ce+")+","gi");function pe(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],pe(n),pe(r))}function he(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(de)||[],n=1;n<t.length;n++)t=(e=pe(t,n).join("")).match(de)||[];return e}}var ge=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{e=e.replace(/\+/g," ");return decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},n=fe.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=he(n[0]);r!==n[0]&&(t[n[0]]=r)}n=fe.exec(e)}t["%C2"]="";for(var i=Object.keys(t),o=0;o<i.length;o++){var a=i[o];e=e.replace(new RegExp(a,"g"),t[a])}return e}(e)}},ve=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]},ye=function(e,t){for(var n={},r=Object.keys(e),i=Array.isArray(t),o=0;o<r.length;o++){var a=r[o],s=e[a];(i?-1!==t.indexOf(a):t(a,s,e))&&(n[a]=s)}return n};!function(e){const t=le,n=ge,r=ve,i=ye,o=Symbol("encodeFragmentIdentifier");function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,n){return n.encode?n.strict?t(e):encodeURIComponent(e):e}function u(e,t){return t.decode?n(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function c(e){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t));return e}function d(e){const t=(e=c(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function f(e,t){t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase());return e}function p(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e);e=e.replace(/\[\d*\]$/,"");if(t){void 0===r[e]&&(r[e]={});r[e][t[1]]=n}else r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e);e=e.replace(/\[\]$/,"");t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"colon-list-separator":return(e,n,r)=>{t=/(:list)$/.exec(e);e=e.replace(/:list$/,"");t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.includes(e.arrayFormatSeparator),o="string"==typeof n&&!i&&u(n,e).includes(e.arrayFormatSeparator);n=o?u(n,e):n;const a=i||o?n.split(e.arrayFormatSeparator).map((t=>u(t,e))):null===n?n:u(n,e);r[t]=a};case"bracket-separator":return(t,n,r)=>{const i=/(\[\])$/.test(t);t=t.replace(/\[\]$/,"");if(!i){r[t]=n?u(n,e):n;return}const o=null===n?[]:n.split(e.arrayFormatSeparator).map((t=>u(t,e)));void 0!==r[t]?r[t]=[].concat(r[t],o):r[t]=o};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),i=Object.create(null);if("string"!=typeof e)return i;if(!(e=e.trim().replace(/^[?#&]/,"")))return i;for(const o of e.split("&")){if(""===o)continue;let[e,a]=r(t.decode?o.replace(/\+/g," "):o,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:u(a,t);n(u(e,t),a,i)}for(const e of Object.keys(i)){const n=i[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=f(n[e],t);else i[e]=f(n,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce(((e,t)=>{const n=i[t];Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=l(n):e[t]=n;return e}),Object.create(null))}e.extract=d;e.parse=p;e.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),"[",i,"]"].join("")]:[...n,[s(t,e),"[",s(i,e),"]=",s(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),"[]"].join("")]:[...n,[s(t,e),"[]=",s(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[s(t,e),":list="].join("")]:[...n,[s(t,e),":list=",s(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return n=>(r,i)=>{if(void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i)return r;i=null===i?"":i;return 0===r.length?[[s(n,e),t,s(i,e)].join("")]:[[r,s(i,e)].join(e.arrayFormatSeparator)]}}default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,s(t,e)]:[...n,[s(t,e),"=",s(r,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const o=Object.keys(i);!1!==t.sort&&o.sort(t.sort);return o.map((n=>{const i=e[n];return void 0===i?"":null===i?s(n,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?s(n,t)+"[]":i.reduce(r(n),[]).join("&"):s(n,t)+"="+s(i,t)})).filter((e=>e.length>0)).join("&")};e.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,i]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:p(d(e),t)},t&&t.parseFragmentIdentifier&&i?{fragmentIdentifier:u(i,t)}:{})};e.stringifyUrl=(t,n)=>{n=Object.assign({encode:!0,strict:!0,[o]:!0},n);const r=c(t.url).split("?")[0]||"",i=e.extract(t.url),a=e.parse(i,{sort:!1}),u=Object.assign(a,t.query);let l=e.stringify(u,n);l&&(l=`?${l}`);let d=function(e){let t="";const n=e.indexOf("#");-1!==n&&(t=e.slice(n));return t}(t.url);t.fragmentIdentifier&&(d=`#${n[o]?s(t.fragmentIdentifier,n):t.fragmentIdentifier}`);return`${r}${l}${d}`};e.pick=(t,n,r)=>{r=Object.assign({parseFragmentIdentifier:!0,[o]:!1},r);const{url:a,query:s,fragmentIdentifier:u}=e.parseUrl(t,r);return e.stringifyUrl({url:a,query:i(s,n),fragmentIdentifier:u},r)};e.exclude=(t,n,r)=>{const i=Array.isArray(n)?e=>!n.includes(e):(e,t)=>!n(e,t);return e.pick(t,i,r)}}(ue);for(var _e=function(e){for(var t,n=function(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");-1===n&&(n=t);return[n,n===t?0:4-n%4]}(e),r=n[0],i=n[1],o=new we(function(e,t,n){return 3*(t+n)/4-n}(0,r,i)),a=0,s=i>0?r-4:r,u=0;u<s;u+=4){t=be[e.charCodeAt(u)]<<18|be[e.charCodeAt(u+1)]<<12|be[e.charCodeAt(u+2)]<<6|be[e.charCodeAt(u+3)];o[a++]=t>>16&255;o[a++]=t>>8&255;o[a++]=255&t}if(2===i){t=be[e.charCodeAt(u)]<<2|be[e.charCodeAt(u+1)]>>4;o[a++]=255&t}if(1===i){t=be[e.charCodeAt(u)]<<10|be[e.charCodeAt(u+1)]<<4|be[e.charCodeAt(u+2)]>>2;o[a++]=t>>8&255;o[a++]=255&t}return o},me=[],be=[],we="undefined"!=typeof Uint8Array?Uint8Array:Array,xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ee=0,ke=xe.length;Ee<ke;++Ee){me[Ee]=xe[Ee];be[xe.charCodeAt(Ee)]=Ee}be["-".charCodeAt(0)]=62;be["_".charCodeAt(0)]=63;function Oe(e){var t=4-e.length%4;1===t?e+="=":2===t&&(e+="==");return(new TextDecoder).decode(_e(e))}var Se=60;function Ae(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(t<0||n<=t)throw'Invalid JWT: must contain 2 period (".") characters.';var r=e.substring(t+1,n);if(null===r||""===r)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var i=Oe.call(window,r);return JSON.parse(i)}v.register("jwt-skew-set",(function(e){Se=e.skew}));var Ce={parseJwtIssuer:function(e){return Ae(e).iss},parseJwtClaims:Ae,isJwtExpired:function(e,t){void 0===t&&(t=Se);var n=Ae(e),r=0,i=Math.floor(Date.now()/1e3);n&&n.exp&&(r=n.exp);return r-t<i}};function Ie(e){return ue.parse(ue.extract(e)).jwt}var Le={hasJwt:function(e){return Ie(e)&&0!==Ie(e).length},isJwtExpired:function(e){var t=Ie(e);return Ce.isJwtExpired(t)}},Te=function(e){v.dispatch("content-resolver-register-by-extension",e)},Pe=function(e){if(!e.resolver)throw Error("ACJS: No content resolver supplied");var t=e.resolver.call(null,U.extend({classifier:"json"},e.extension));t.fail((function(t,n){v.dispatch("jwt-url-refreshed-failed",{extension:e.extension,$container:e.$container,errorText:n.text,errorTraceId:n.traceId})}));t.done((function(t){var n={};if("object"==typeof t)n=t;else if("string"==typeof t)try{n=JSON.parse(t)}catch(e){console.error("ACJS: invalid response from content resolver")}e.extension.url=n.url;U.extend(e.extension.options,n.options);v.dispatch("jwt-url-refreshed",{extension:e.extension,$container:e.$container,url:e.extension.url})}));v.dispatch("jwt-url-refresh-request",{data:e})},De=function(e){"number"==typeof e?v.dispatch("jwt-skew-set",{skew:e}):console.error("ACJS: invalid JWT clock skew set")},Me=function(e){var t={};if(e&&"object"==typeof e){e.width&&(t.width=U.stringToDimension(e.width));e.height&&(t.height=U.stringToDimension(e.height));if("string"==typeof e.sandbox){var n=document.createElement("iframe");t.sandbox=e.sandbox.split(" ").filter((function(e){return U.isSupported(n,"sandbox",e,!0)})).join(" ")}}return t},je=new(function(){function e(){this.store={}}var t=e.prototype;t.set=function(e,t){if(t){var n={};n[e]=t}else n=e;U.extend(this.store,n)};t.get=function(e){return e?this.store[e]:U.extend({},this.store)};return e}());function Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Ne(e){var t=function(e,t){if("object"!=Ve(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=Ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ve(t)?t:t+""}function Re(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ne(r.key),r)}}function Ge(e,t,n){return t&&Re(e.prototype,t),n&&Re(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ue(e,t,n){return(t=Ne(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,l=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Be(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Be(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ke(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function Je(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ke(o,r,i,a,s,"next",e)}function s(e){Ke(o,r,i,a,s,"throw",e)}a(void 0)}))}}var $e={exports:{}},We={exports:{}};!function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports}(We);var qe={exports:{}},He={exports:{}};!function(e){function t(n,r,i,o){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}e.exports=t=function(e,n,r,i){if(n)a?a(e,n,{value:r,enumerable:!i,configurable:!i,writable:!i}):e[n]=r;else{var o=function(n,r){t(e,n,(function(e){return this._invoke(n,r,e)}))};o("next",0),o("throw",1),o("return",2)}},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r,i,o)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(He);!function(e){var t=He.exports;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var r,i,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.toStringTag||"@@toStringTag";function u(e,n,o,a){var s=n&&n.prototype instanceof c?n:c,u=Object.create(s.prototype);return t(u,"_invoke",function(e,t,n){var o,a,s,u=0,c=n||[],d=!1,f={p:0,n:0,v:r,a:p,f:p.bind(r,4),d:function(e,t){return o=e,a=0,s=r,f.n=t,l}};function p(e,t){for(a=e,s=t,i=0;!d&&u&&!n&&i<c.length;i++){var n,o=c[i],p=f.p,h=o[2];e>3?(n=h===t)&&(s=o[(a=o[4])?5:(a=3,3)],o[4]=o[5]=r):o[0]<=p&&((n=e<2&&p<o[1])?(a=0,f.v=t,f.n=o[1]):p<h&&(n=e<3||o[0]>t||t>h)&&(o[4]=e,o[5]=t,f.n=h,a=0))}if(n||e>1)return l;throw d=!0,t}return function(n,c,h){if(u>1)throw TypeError("Generator is already running");for(d&&1===c&&p(c,h),a=c,s=h;(i=a<2?r:s)||!d;){o||(a?a<3?(a>1&&(f.n=-1),p(a,s)):f.n=s:f.v=s);try{if(u=2,o){if(a||(n="next"),i=o[n]){if(!(i=i.call(o,s)))throw TypeError("iterator result is not an object");if(!i.done)return i;s=i.value,a<2&&(a=0)}else 1===a&&(i=o.return)&&i.call(o),a<2&&(s=TypeError("The iterator does not provide a '"+n+"' method"),a=1);o=r}else if((i=(d=f.n<0)?s:e.call(t,f))!==l)break}catch(e){o=r,a=1,s=e}finally{u=1}}return{value:i,done:d}}}(e,o,a),!0),u}var l={};function c(){}function d(){}function f(){}i=Object.getPrototypeOf;var p=[][a]?i(i([][a]())):(t(i={},a,(function(){return this})),i),h=f.prototype=c.prototype=Object.create(p);function g(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,s,"GeneratorFunction")),e.prototype=Object.create(h),e}return d.prototype=f,t(h,"constructor",f),t(f,"constructor",d),d.displayName="GeneratorFunction",t(f,s,"GeneratorFunction"),t(h),t(h,s,"Generator"),t(h,a,(function(){return this})),t(h,"toString",(function(){return"[object Generator]"})),(e.exports=n=function(){return{w:u,m:g}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports}(qe);var Xe={exports:{}},Ye={exports:{}},Qe={exports:{}};!function(e){var t=We.exports,n=He.exports;e.exports=function e(r,i){function o(e,n,a,s){try{var u=r[e](n),l=u.value;return l instanceof t?i.resolve(l.v).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):i.resolve(l).then((function(e){u.value=e,a(u)}),(function(e){return o("throw",e,a,s)}))}catch(e){s(e)}}var a;this.next||(n(e.prototype),n(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),n(this,"_invoke",(function(e,t,n){function r(){return new i((function(t,r){o(e,n,t,r)}))}return a=a?a.then(r,r):r()}),!0)},e.exports.__esModule=!0,e.exports.default=e.exports}(Qe);!function(e){var t=qe.exports,n=Qe.exports;e.exports=function(e,r,i,o,a){return new n(t().w(e,r,i,o),a||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports}(Ye);!function(e){var t=Ye.exports;e.exports=function(e,n,r,i,o){var a=t(e,n,r,i,o);return a.next().then((function(e){return e.done?e.value:a.next()}))},e.exports.__esModule=!0,e.exports.default=e.exports}(Xe);var Ze={exports:{}};!function(e){e.exports=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports}(Ze);var et={exports:{}},tt={exports:{}};!function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports}(tt);!function(e){var t=tt.exports.default;e.exports=function(e){if(null!=e){var n=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(t(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports}(et);!function(e){var t=We.exports,n=qe.exports,r=Xe.exports,i=Ye.exports,o=Qe.exports,a=Ze.exports,s=et.exports;function u(){var l=n(),c=l.m(u),d=(Object.getPrototypeOf?Object.getPrototypeOf(c):c.__proto__).constructor;function f(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))}var p={throw:1,return:2,break:3,continue:3};function h(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,p[e],t)},delegateYield:function(e,i,o){return t.resultName=i,n(r.d,s(e),o)},finish:function(e){return n(r.f,e)}},n=function(e,n,i){r.p=t.prev,r.n=t.next;try{return e(n,i)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(e.exports=u=function(){return{wrap:function(e,t,n,r){return l.w(h(e),t,n,r&&r.reverse())},isGeneratorFunction:f,mark:l.m,awrap:function(e,n){return new t(e,n)},AsyncIterator:o,async:function(e,t,n,o,a){return(f(t)?i:r)(h(e),t,n,o,a)},keys:a,values:s}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=u,e.exports.__esModule=!0,e.exports.default=e.exports}($e);var nt=$e.exports(),rt=nt;try{regeneratorRuntime=nt}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=nt:Function("r","regeneratorRuntime = r")(nt)}var it={},ot={};!function(e){var t,n,r=ae&&ae.__extends||(t=function(e,n){t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])};return t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0});e.StatsigSDKKeyMismatchError=e.StatsigInvalidArgumentError=e.StatsigUninitializedError=e.StatsigErrorMessage=void 0;!function(e){e.REQUIRE_ASYNC_INITIALIZE="Call initialize() first.";e.REQUIRE_SYNC_INITIALIZE="Call and wait for initialize() to finish first.";e.REQUIRE_INITIALIZE_FOR_LOG_EVENT="Must initialize() before logging events."}(n=e.StatsigErrorMessage||(e.StatsigErrorMessage={}));var i=function(e){r(t,e);function t(r){var i=e.call(this,null!=r?r:n.REQUIRE_SYNC_INITIALIZE)||this;Object.setPrototypeOf(i,t.prototype);return i}return t}(Error);e.StatsigUninitializedError=i;var o=function(e){r(t,e);function t(n){var r=e.call(this,n)||this;Object.setPrototypeOf(r,t.prototype);return r}return t}(Error);e.StatsigInvalidArgumentError=o;var a=function(e){r(t,e);function t(n){var r=e.call(this,n)||this;Object.setPrototypeOf(r,t.prototype);return r}return t}(Error);e.StatsigSDKKeyMismatchError=a}(ot);var at={},st={};Object.defineProperty(st,"__esModule",{value:!0});var ut=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=[]);void 0===o&&(o="");void 0===a&&(a=null);this._onDefaultValueFallback=null;this.value=JSON.parse(JSON.stringify(null!=t?t:{}));this._name=e;this._ruleID=null!=n?n:"";this._secondaryExposures=i;this._allocatedExperimentName=o;this._evaluationDetails=r;this._onDefaultValueFallback=a}e.prototype.get=function(e,t,n){var r,i,o=this.getValue(e,t);if(null==o)return t;var a=Array.isArray(t)?"array":typeof t,s=Array.isArray(o)?"array":typeof o;if(n){if(n(o))return o;null===(r=this._onDefaultValueFallback)||void 0===r||r.call(this,this,e,a,s);return t}if(null==t||a===s)return o;null===(i=this._onDefaultValueFallback)||void 0===i||i.call(this,this,e,a,s);return t};e.prototype.getValue=function(e,t){if(null==e)return this.value;null==t&&(t=null);return null==this.value[e]?t:this.value[e]};return e}();st.default=ut;var lt={};!function(e){var t=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0});e.ExceptionEndpoint=void 0;var r=ot;e.ExceptionEndpoint="https://statsigapi.net/v1/sdk_exception";var i=function(){function i(e,t){this._seen=new Set;this._sdkKey=e;this._options=t}i.prototype._setStatsigMetadata=function(e){this._statsigMetadata=e};i.prototype._swallow=function(e,t){this._capture(e,t,(function(){}))};i.prototype._capture=function(e,t,n,r){var i=this;try{var o=t();return o instanceof Promise?o.catch((function(t){return i._onCaught(e,t,n,r)})):o}catch(t){return this._onCaught(e,t,n,r)}};i.prototype._logError=function(r,i,o){var a=this;if(!this._options.disableAllLogging)try{t(a,void 0,void 0,(function(){var t,a,s,u,l,c,d,f,p;return n(this,(function(n){switch(n.label){case 0:return"function"!=typeof o?[3,2]:[4,o()];case 1:a=n.sent();return[3,3];case 2:a=null;n.label=3;case 3:t=a;s=null!=i?i:Error("[Statsig] Error was empty");u=s instanceof Error;l=u?s.name:"No Name";if(this._seen.has(l))return[2];this._seen.add(l);c=u?s.stack:this._getDescription(s);d=null!==(p=this._statsigMetadata)&&void 0!==p?p:{};f=JSON.stringify({tag:r,exception:l,info:c,statsigMetadata:d,extra:null!=t?t:{}});return[2,fetch(e.ExceptionEndpoint,{method:"POST",headers:{"STATSIG-API-KEY":this._sdkKey,"STATSIG-SDK-TYPE":String(d.sdkType),"STATSIG-SDK-VERSION":String(d.sdkVersion),"Content-Type":"application/json","Content-Length":"".concat(f.length)},body:f})]}}))})).then((function(){})).catch((function(){}))}catch(e){}};i.prototype._onCaught=function(e,t,n,i){if(t instanceof r.StatsigUninitializedError||t instanceof r.StatsigInvalidArgumentError)throw t;console.error("[Statsig] An unexpected exception occurred.",t);this._logError(e,t,i);return n()};i.prototype._getDescription=function(e){try{return JSON.stringify(e)}catch(e){return"[Statsig] Failed to get string for error."}};return i}();e.default=i}(lt);var ct={};Object.defineProperty(ct,"__esModule",{value:!0});var dt=function(){function e(e,t,n,r,i,o,a,s,u){void 0===i&&(i=null);void 0===o&&(o=[]);void 0===a&&(a=[]);void 0===s&&(s="");void 0===u&&(u=[]);this._logParameterFunction=i;this._name=e;this._value=JSON.parse(JSON.stringify(null!=t?t:{}));this._ruleID=null!=n?n:"";this._evaluationDetails=r;this._secondaryExposures=o;this._undelegatedSecondaryExposures=a;this._allocatedExperimentName=s;this._explicitParameters=u}e._create=function(t,n,r,i,o,a,s,u,l){void 0===o&&(o=null);void 0===a&&(a=[]);void 0===s&&(s=[]);void 0===u&&(u="");void 0===l&&(l=[]);return new e(t,n,r,i,o,a,s,u,l)};e.prototype.get=function(e,t,n){var r=this,i=this._value[e];if(null==i)return t;var o=function(){r._logLayerParameterExposure(e);return i};return n?n(i)?o():t:null==t||typeof i==typeof t&&Array.isArray(t)===Array.isArray(i)?o():t};e.prototype.getValue=function(e,t){null==t&&(t=null);var n=this._value[e];null!=n&&this._logLayerParameterExposure(e);return null!=n?n:t};e.prototype._logLayerParameterExposure=function(e){var t;null===(t=this._logParameterFunction)||void 0===t||t.call(this,this,e)};return e}();ct.default=dt;var ft={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});pt.LOCAL_STORAGE_KEYS=pt.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY=pt.STATSIG_STABLE_ID_KEY=pt.INTERNAL_STORE_KEY=void 0;pt.INTERNAL_STORE_KEY="STATSIG_STORE";pt.STATSIG_STABLE_ID_KEY="STATSIG_STABLE_ID";pt.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY="STATSIG_LOGS";pt.LOCAL_STORAGE_KEYS={INTERNAL_STORE_KEY:!0,STATSIG_STABLE_ID_KEY:!0,STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY:!0};var ht={};Object.defineProperty(ht,"__esModule",{value:!0});ht.getUserCacheKey=ht.getSortedObject=ht.djb2HashForObject=ht.getHashValue=ht.SimpleHash=void 0;function gt(e){for(var t=0,n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t&=t}return String(t>>>0)}ht.SimpleHash=gt;ht.getHashValue=function(e,t){return"none"===t?e:gt(e)};ht.djb2HashForObject=function(e){return gt(JSON.stringify(vt(e)))};function vt(e){if(null==e)return null;var t=Object.keys(e).sort(),n={};t.forEach((function(t){var r=e[t];r instanceof Object&&(r=vt(r));n[t]=r}));return n}ht.getSortedObject=vt;ht.getUserCacheKey=function(e){var t,n="userID:".concat(String(null!==(t=null==e?void 0:e.userID)&&void 0!==t?t:"")),r=null==e?void 0:e.customIDs;if(null!=r)for(var i=0,o=Object.entries(r);i<o.length;i++){var a=o[i],s=a[0],u=a[1];n+=";".concat(s,":").concat(u)}return gt(n)};var yt={};Object.defineProperty(yt,"__esModule",{value:!0});var _t=function(){function e(){}e.getItem=function(e){var t;try{if(this.isStorageAccessible())return window.localStorage.getItem(e)}catch(e){}return null!==(t=this.fallbackSessionCache[e])&&void 0!==t?t:null};e.setItem=function(e,t){try{if(this.isStorageAccessible()){window.localStorage.setItem(e,t);return}}catch(e){}this.fallbackSessionCache[e]=t};e.removeItem=function(e){try{if(this.isStorageAccessible()){window.localStorage.removeItem(e);return}}catch(e){}delete this.fallbackSessionCache[e]};e.isStorageAccessible=function(e){void 0===e&&(e=!1);null==this.canAccessStorageAccessible&&(this.canAccessStorageAccessible="undefined"!=typeof Storage&&"undefined"!=typeof window&&null!=window&&null!=window.localStorage);var t=this.canAccessStorageAccessible;return(e||!this.disabled)&&t};e.disabled=!1;e.fallbackSessionCache={};e.canAccessStorageAccessible=null;return e}();yt.default=_t;var mt={};Object.defineProperty(mt,"__esModule",{value:!0});mt.version=void 0;mt.version="1.6.0";var bt=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ft,"__esModule",{value:!0});var wt=pt,xt=ht,Et=bt(yt),kt=mt,Ot=function(){function e(e,t,n){var r;this._sdkType="js-lite";this._sdkKey=e;this._user=t;this._sdkVersion=kt.version;var i=n;i=null!==(r=null!=i?i:Et.default.getItem(wt.STATSIG_STABLE_ID_KEY))&&void 0!==r?r:this._getUUID();this._statsigMetadata={stableID:i,sdkType:this._sdkType,sdkVersion:this._sdkVersion}}e.prototype.saveStableID=function(){null!=this._statsigMetadata.stableID&&Et.default.setItem(wt.STATSIG_STABLE_ID_KEY,this._statsigMetadata.stableID)};e.prototype.getUserCacheKey=function(){return(0,xt.getUserCacheKey)(this._user)};e.prototype._getUUID=function(){for(var e="",t=0;t<32;t++){8!==t&&12!==t&&16!==t&&20!==t||(e+="-");var n=16*Math.random()|0;e+=12===t?"4":16===t?(3&n|8).toString(16):n.toString(16)}return e};return e}();ft.default=Ot;var St={},At={},Ct=ae&&ae.__assign||function(){Ct=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};return Ct.apply(this,arguments)};Object.defineProperty(At,"__esModule",{value:!0});At.default=function(e,t,n,r,i,o){void 0===r&&(r=null);void 0===i&&(i=null);var a=t;(null==a?void 0:a.privateAttributes)&&delete(a=Ct({},t)).privateAttributes;return{time:Date.now(),eventName:e,statsigMetadata:n,user:a,value:r,metadata:i,secondaryExposures:o}};var It={};!function(e){var t,n=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},r=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};Object.defineProperty(e,"__esModule",{value:!0});e.StatsigEndpoint=void 0;!function(e){e.Initialize="initialize";e.Rgstr="rgstr";e.LogEventBeacon="log_event_beacon"}(t=e.StatsigEndpoint||(e.StatsigEndpoint={}));var i=function(){function e(e,t,n){this.retryCodes={408:!0,500:!0,502:!0,503:!0,504:!0,522:!0,524:!0,599:!0};this.canUseKeepalive=!1;this._options=e;this._identity=t;this._errorBoundary=n;this.leakyBucket={};this._init()}e.prototype.fetchValues=function(e,n,r,i){var o={user:e,statsigMetadata:this._identity._statsigMetadata,sinceTime:null!=n?n:void 0,hash:"djb2",previousDerivedFields:i};return this._postWithTimeout(t.Initialize,o,r,3)};e.prototype.sendLogBeacon=function(e){if(this._options.localMode)return!0;var n=new URL(this._options.eventLoggingApi+t.LogEventBeacon);n.searchParams.append("k",this._identity._sdkKey);e.clientTime=Date.now()+"";var r=null;try{r=JSON.stringify(e)}catch(e){return!1}return navigator.sendBeacon(n.toString(),r)};e.prototype.postToEndpoint=function(e,i,o,a,s,u){void 0===o&&(o=0);void 0===a&&(a=1e3);void 0===s&&(s=0);void 0===u&&(u=!1);return n(this,void 0,void 0,(function(){var l,c,d,f,p,h,g=this;return r(this,(function(v){if(this._options.localMode)return[2,Promise.reject("no network requests in localMode")];if("function"!=typeof fetch)return[2,Promise.reject("fetch is not defined")];if("undefined"==typeof window&&!this._options.ignoreWindowUndefined)return[2,Promise.reject("window is not defined")];l=[t.Initialize].includes(e)?this._options.api:s>0?this._options.eventLoggingApiForRetries:this._options.eventLoggingApi;c=l+e;if(null!=(d=this.leakyBucket[c])&&d>=30)return[2,Promise.reject(new Error("Request failed because you are making the same request too frequently."))];this.leakyBucket[c]=null==d?1:d+1;f=JSON.stringify(i);p=this._identity._statsigMetadata;h={method:"POST",body:f,headers:{"Content-type":"application/json; charset=UTF-8","STATSIG-API-KEY":this._identity._sdkKey,"STATSIG-CLIENT-TIME":Date.now()+"","STATSIG-SDK-TYPE":p.sdkType,"STATSIG-SDK-VERSION":p.sdkVersion}};this.canUseKeepalive&&u&&(h.keepalive=!0);return[2,fetch(c,h).then((function(e){return n(g,void 0,void 0,(function(){var t,n,i;return r(this,(function(r){switch(r.label){case 0:if(!e.ok)return[3,4];t=e;if(204!==e.status)return[3,1];t.data={has_updates:!1,is_no_content:!0};return[3,3];case 1:return[4,e.text()];case 2:n=r.sent();t.data=JSON.parse(n);r.label=3;case 3:return[2,Promise.resolve(t)];case 4:this.retryCodes[e.status]||(o=0);return[4,e.text()];case 5:i=r.sent();return[2,Promise.reject(new Error("".concat(e.status,": ").concat(i)))]}}))}))})).catch((function(t){return o>0?new Promise((function(t,n){setTimeout((function(){g.leakyBucket[c]=Math.max(g.leakyBucket[c]-1,0);g.postToEndpoint(e,i,o-1,2*a,s+1,u).then(t).catch(n)}),a)})):Promise.reject(t)})).finally((function(){g.leakyBucket[c]=Math.max(g.leakyBucket[c]-1,0)}))]}))}))};e.prototype.supportsKeepalive=function(){return this.canUseKeepalive};e.prototype._init=function(){if(!this._options.disableNetworkKeepalive)try{this.canUseKeepalive="keepalive"in new Request("")}catch(e){}};e.prototype._postWithTimeout=function(e,t,i,o,a){var s=this;void 0===i&&(i=0);void 0===o&&(o=0);void 0===a&&(a=1e3);var u=!1,l=null,c=null,d=[];0!=i&&(l=new Promise((function(e,t){setTimeout((function(){u=!0;t(new Error("The initialization timeout of ".concat(i,"ms has been hit before the network request has completed.")))}),i)})));var f,p=this.postToEndpoint(e,t,o,a).then((function(i){if(!i.ok)return Promise.reject(new Error("Request to ".concat(e," failed with status ").concat(i.status)));if("object"!=typeof i.data){var l=new Error("Request to ".concat(e," received invalid response type. Expected 'object' but got '").concat(typeof i.data,"'"));s._errorBoundary._logError("postWithTimeoutInvalidRes",l,(function(){return n(s,void 0,void 0,(function(){return r(this,(function(n){return[2,this._getErrorData(e,t,o,a,i)]}))}))}));return Promise.reject(l)}var f=i.data;return s._errorBoundary._capture("postWithTimeout",(function(){return n(s,void 0,void 0,(function(){return r(this,(function(e){c=f;if(u){d.forEach((function(e){return e(f)}));d=[]}return[2,Promise.resolve(f)]}))}))}),(function(){return Promise.resolve({})}),(function(){return n(s,void 0,void 0,(function(){return r(this,(function(n){return[2,this._getErrorData(e,t,o,a,i)]}))}))}))})).catch((function(e){return Promise.reject(e)})),h=l?Promise.race([p,l]):p;h.eventually=(f=h,function(e){u&&c?e(c):d.push(e);return f});return h};e.prototype._getErrorData=function(e,t,i,o,a){var s;return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){try{n={};(null!==(s=a.headers)&&void 0!==s?s:[]).forEach((function(e,t){n[t]=e}));return[2,{responseInfo:{headers:n,status:a.status,statusText:a.statusText,type:a.type,url:a.url,redirected:a.redirected,bodySnippet:a.data?JSON.stringify(a.data).slice(0,500):null},requestInfo:{endpointName:e,bodySnippet:JSON.stringify(t).slice(0,500),retries:i,backoff:o}}]}catch(e){return[2,{statusText:"statsig::failed to extract extra data"}]}return[2]}))}))};return e}();e.default=i}(It);var Lt=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},Tt=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},Pt=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(St,"__esModule",{value:!0});var Dt=Pt(At),Mt=It,jt=pt,Ft=Pt(yt),Vt="statsig::log_event_failed",Nt=1024e3,Rt=function(){function e(e,t,n,r){var i=this;this._failedLogEventCount=0;this.logConfigDefaultValueFallback=function(e,t,n){var r=(0,Dt.default)("statsig::default_value_type_mismatch",e,i._identity._statsigMetadata,t,n);i.log(r);i._loggedErrors.add(t)};this._options=e;this._identity=t;this._network=n;this._errorBoundary=r;this._queue=[];this._flushInterval=null;this._loggedErrors=new Set;this._failedLogEvents=[];this._exposureDedupeKeys={};this._failedLogEventCount=0;this._init()}e.prototype.log=function(e){if(!this._options.disableAllLogging){try{if(!this._options.disableCurrentPageLogging&&"undefined"!=typeof window&&null!=window&&"object"==typeof window.location&&"string"==typeof window.location.href){var t=window.location.href.split(/[?#]/);(null==t?void 0:t.length)>0&&(e.statsigMetadata.currentPage=t[0])}}catch(e){}this._queue.push(e);this._queue.length>=this._options.loggingBufferMaxSize&&this.flush()}};e.prototype.resetDedupeKeys=function(){this._exposureDedupeKeys={}};e.prototype.logGateExposure=function(e,t,n,r,i,o,a,s){var u=t+String(n)+r+o.reason;if(this._shouldLogExposure(u)){var l={gate:t,gateValue:String(n),ruleID:r,reason:o.reason,time:o.time};a&&(l.isManualExposure="true");null!=s&&(l.bootstrapMetadata=s);var c=(0,Dt.default)("statsig::gate_exposure",e,this._identity._statsigMetadata,null,l,i);this.log(c)}};e.prototype.logConfigExposure=function(e,t,n,r,i,o,a){var s=t+n+i.reason;if(this._shouldLogExposure(s)){var u={config:t,ruleID:n,reason:i.reason,time:i.time};o&&(u.isManualExposure="true");null!=a&&(u.bootstrapMetadata=a);var l=(0,Dt.default)("statsig::config_exposure",e,this._identity._statsigMetadata,null,u,r);this.log(l)}};e.prototype.logLayerExposure=function(e,t,n,r,i,o,a,s,u,l){var c=[t,n,i,o,String(a),s.reason].join("|");if(this._shouldLogExposure(c)){var d={config:t,ruleID:n,allocatedExperiment:i,parameterName:o,isExplicitParameter:String(a),reason:s.reason,time:s.time};u&&(d.isManualExposure="true");null!=l&&(d.bootstrapMetadata=l);var f=(0,Dt.default)("statsig::layer_exposure",e,this._identity._statsigMetadata,null,d,r);this.log(f)}};e.prototype.shutdown=function(){if(this._flushInterval){clearInterval(this._flushInterval);this._flushInterval=null}this.flush(!0)};e.prototype.flush=function(e){var t=this;void 0===e&&(e=!1);if(0!==this._queue.length){var n=this._identity._statsigMetadata,r=this._queue;this._queue=[];if(e&&!this._network.supportsKeepalive()&&"undefined"!=typeof navigator&&null!=navigator&&navigator.sendBeacon){if(!this._network.sendLogBeacon({events:r,statsigMetadata:n})){this._queue=r.concat(this._queue);if(this._queue.length>0){this._addFailedRequest({events:this._queue,statsigMetadata:n,time:Date.now()});this._queue=[]}this._saveFailedRequests()}}else{var i=this;this._network.postToEndpoint(Mt.StatsigEndpoint.Rgstr,{events:r,statsigMetadata:n},3,1e3,0,e).then((function(e){if(!e.ok)throw e})).catch((function(e){"function"==typeof e.text?e.text().then((function(n){t._errorBoundary._logError(Vt,e,(function(){return Lt(t,void 0,void 0,(function(){return Tt(this,(function(e){return[2,{eventCount:r.length,error:n}]}))}))}))})):t._errorBoundary._logError(Vt,e,(function(){return Lt(t,void 0,void 0,(function(){return Tt(this,(function(t){return[2,{eventCount:r.length,error:e.message}]}))}))}));i._newFailedRequest(Vt,r)})).finally((function(){return Lt(t,void 0,void 0,(function(){return Tt(this,(function(t){switch(t.label){case 0:if(!e)return[3,2];if(this._queue.length>0){this._addFailedRequest({events:this._queue,statsigMetadata:n,time:Date.now()});this._queue=[]}return[4,i._saveFailedRequests()];case 1:t.sent();t.label=2;case 2:return[2]}}))}))}))}}};e.prototype.sendSavedRequests=function(){return Lt(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Tt(this,(function(l){t=!1;if(null==(e=Ft.default.getItem(jt.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY))){this._clearLocalStorageRequests();return[2]}e.length>Nt&&(t=!0);n=[];try{n=JSON.parse(e);r=function(e){null!=e&&e.events&&Array.isArray(e.events)&&i._network.postToEndpoint(Mt.StatsigEndpoint.Rgstr,e).then((function(e){if(!e.ok)throw Error(e.status+"")})).catch((function(n){t||u._addFailedRequest(e)}))};i=this;for(o=0,a=n;o<a.length;o++){s=a[o];r(s)}}catch(e){}finally{this._clearLocalStorageRequests()}return[2]}))}))};e.prototype._init=function(){var e=this;if("undefined"!=typeof window&&"function"==typeof window.addEventListener){window.addEventListener("blur",(function(){return e.flush(!0)}));window.addEventListener("beforeunload",(function(){return e.flush(!0)}));window.addEventListener("load",(function(){setTimeout((function(){return e.flush()}),100);setTimeout((function(){return e.flush()}),1e3)}))}"undefined"!=typeof document&&"function"==typeof document.addEventListener&&document.addEventListener("visibilitychange",(function(){e.flush("visible"!==document.visibilityState)}));if((this._options.ignoreWindowUndefined||"undefined"!=typeof window&&null!=window)&&!this._options.localMode){var t=this;this._flushInterval=setInterval((function(){t.flush()}),this._options.loggingIntervalMillis);setTimeout((function(){return e.flush()}),100);setTimeout((function(){return e.flush()}),1e3)}};e.prototype._shouldLogExposure=function(e){var t=this._exposureDedupeKeys[e],n=Date.now();if(null==t){this._exposureDedupeKeys[e]=n;return!0}if(t>=n-6e5)return!1;this._exposureDedupeKeys[e]=n;return!0};e.prototype._saveFailedRequests=function(){return Lt(this,void 0,void 0,(function(){var e;return Tt(this,(function(t){if(this._failedLogEvents.length>0){if((e=JSON.stringify(this._failedLogEvents)).length>Nt){this._clearLocalStorageRequests();return[2]}Ft.default.setItem(jt.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY,e)}return[2]}))}))};e.prototype._addFailedRequest=function(e){if(!(e.time<Date.now()-432e6||this._failedLogEvents.length>100)){var t=e.events.length;if(!(this._failedLogEventCount+t>1e3)){this._failedLogEvents.push(e);this._failedLogEventCount+=t}}};e.prototype._clearLocalStorageRequests=function(){Ft.default.removeItem(jt.STATSIG_LOCAL_STORAGE_LOGGING_REQUEST_KEY)};e.prototype._newFailedRequest=function(e,t){if(!this._loggedErrors.has(e)){this._loggedErrors.add(e);this._failedLogEvents.push({events:t,statsigMetadata:this._identity._statsigMetadata,time:Date.now()});this._saveFailedRequests().then((function(){}))}};return e}();St.default=Rt;var Gt={};!function(e){Object.defineProperty(e,"__esModule",{value:!0});e.INIT_TIMEOUT_DEFAULT_MS=void 0;e.INIT_TIMEOUT_DEFAULT_MS=3e3;var t=function(){function t(t){var n,r,i,o,a,s,u,l,c,d,f,p,h,g,v,y;null==t&&(t={});var _=null!==(n=t.api)&&void 0!==n?n:"https://featuregates.org/v1/";this.api=_.endsWith("/")?_:_+"/";this.disableCurrentPageLogging=null!==(r=t.disableCurrentPageLogging)&&void 0!==r&&r;this.environment=null!==(i=t.environment)&&void 0!==i?i:null;this.loggingIntervalMillis=this.normalizeNumberInput(t.loggingIntervalMillis,{default:1e4,min:1e3,max:6e4});this.loggingBufferMaxSize=this.normalizeNumberInput(t.loggingBufferMaxSize,{default:100,min:2,max:500});this.disableNetworkKeepalive=null!==(o=t.disableNetworkKeepalive)&&void 0!==o&&o;this.overrideStableID=null!==(a=t.overrideStableID)&&void 0!==a?a:null;this.localMode=null!==(s=t.localMode)&&void 0!==s&&s;this.initTimeoutMs=t.initTimeoutMs&&t.initTimeoutMs>=0?t.initTimeoutMs:e.INIT_TIMEOUT_DEFAULT_MS;this.disableErrorLogging=null!==(u=t.disableErrorLogging)&&void 0!==u&&u;this.disableAutoMetricsLogging=null!==(l=t.disableAutoMetricsLogging)&&void 0!==l&&l;this.initializeValues=null!==(c=t.initializeValues)&&void 0!==c?c:null;var m=null!==(f=null!==(d=t.eventLoggingApi)&&void 0!==d?d:t.api)&&void 0!==f?f:"https://events.statsigapi.net/v1/";this.eventLoggingApi=m.endsWith("/")?m:m+"/";var b=null!==(p=t.eventLoggingApiForRetries)&&void 0!==p?p:m;this.eventLoggingApiForRetries=b.endsWith("/")?b:b+"/";this.disableLocalStorage=null!==(h=t.disableLocalStorage)&&void 0!==h&&h;this.ignoreWindowUndefined=null!==(g=null==t?void 0:t.ignoreWindowUndefined)&&void 0!==g&&g;this.updateUserCompletionCallback=null!==(v=null==t?void 0:t.updateUserCompletionCallback)&&void 0!==v?v:null;this.disableAllLogging=null!==(y=null==t?void 0:t.disableAllLogging)&&void 0!==y&&y}t.prototype.normalizeNumberInput=function(e,t){return null==e?t.default:Math.max(Math.min(e,t.max),t.min)};return t}();e.default=t}(Gt);var Ut={},Bt={},zt=ae&&ae.__assign||function(){zt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};return zt.apply(this,arguments)};Object.defineProperty(Bt,"__esModule",{value:!0});var Kt=function(){function e(){}e.isValid=function(t,n){try{var r=n.evaluated_keys;if(!r){var i=n.user;if(i){(r={}).userID=i.userID;i.customIDs&&(r.customIDs=i.customIDs)}}if(!r||"object"!=typeof r)return!0;var o=this.copyObject(r),a=null==t?null:this.copyObject(t);return e.validate(o,a)&&e.validate(a,o)}catch(e){}return!0};e.validate=function(e,t){if(null==e)return null==t;if(null==t)return!1;for(var n=0,r=Object.entries(e);n<r.length;n++){var i=r[n],o=i[0],a=i[1];if("stableID"!==o){if(typeof a!=typeof t[o])return!1;if("string"!=typeof a)return"object"==typeof a&&this.validate(a,t[o]);if(a!==t[o])return!1}}return!0};e.copyObject=function(e){if(null==e)return null;var t={};(null==e?void 0:e.userID)&&(t.userID=null==e?void 0:e.userID);if(null==e?void 0:e.customIDs){var n=zt({},e.customIDs);delete n.stableID;0!==Object.keys(n).length&&(t.customIDs=n)}return t};return e}();Bt.default=Kt;!function(e){var t=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},r=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.EvaluationReason=void 0;var i,o=r(st),a=r(ct),s=r(Bt),u=pt,l=ht,c=r(yt);!function(e){e.Network="Network";e.Bootstrap="Bootstrap";e.InvalidBootstrap="InvalidBootstrap";e.Cache="Cache";e.Unrecognized="Unrecognized";e.Uninitialized="Uninitialized";e.Error="Error";e.NetworkNotModified="NetworkNotModified";e.LocalOverride="LocalOverride"}(i=e.EvaluationReason||(e.EvaluationReason={}));var d=function(){function e(e,t,n){this._identity=e;this._onDefaultValueFallback=t;this._userCacheKey=this._identity.getUserCacheKey();this._values={};this._userValues=this._getDefaultUserCacheValues();this._loaded=!1;this._reason=i.Uninitialized;n?this.bootstrap(n):this._loadFromLocalStorage()}e.prototype.updateUser=function(){this._userCacheKey=this._identity.getUserCacheKey();return this._setUserValueFromCache()};e.prototype.bootstrap=function(e){var t,n,r,o,a,u,l,c=this._identity.getUserCacheKey(),d=this._identity._user,f=s.default.isValid(d,e)?i.Bootstrap:i.InvalidBootstrap;this._loaded=!0;try{this._userValues.feature_gates=null!==(t=e.feature_gates)&&void 0!==t?t:{};this._userValues.dynamic_configs=null!==(n=e.dynamic_configs)&&void 0!==n?n:{};this._userValues.layer_configs=null!==(r=e.layer_configs)&&void 0!==r?r:{};this._userValues.evaluation_time=Date.now();this._userValues.time=null!==(o=e.time)&&void 0!==o?o:Date.now();this._userValues.exposures=null!==(a=e.exposures)&&void 0!==a?a:[];this._userValues.hash_used=null!==(u=e.hash_used)&&void 0!==u?u:"djb2";this._values[c]=this._userValues;this._reason=f;var p=null!==(l=e.sdkInfo)&&void 0!==l?l:e.sdk_info;this._userValues.bootstrapMetadata={};null!=p&&(this._userValues.bootstrapMetadata.generatorSDKInfo=p);null!=e.user&&(this._userValues.bootstrapMetadata.user=e.user);null!=e.time&&(this._userValues.bootstrapMetadata.lcut=e.time)}catch(e){return}};e.prototype.getBootstrapMetadata=function(){var e;return null!==(e=this._userValues.bootstrapMetadata)&&void 0!==e?e:null};e.prototype.isLoaded=function(){return this._loaded};e.prototype.getLastUpdateTime=function(e){var t=(0,l.djb2HashForObject)(e);return this._userValues.user_hash==t?this._userValues.time:null};e.prototype.getPreviousDerivedFields=function(e){var t=(0,l.djb2HashForObject)(e);if(this._userValues.user_hash==t)return this._userValues.derived_fields};e.prototype.setEvaluationReason=function(e){this._reason=e};e.prototype.save=function(e,r,o){void 0===o&&(o=!0);return t(this,void 0,void 0,(function(){var t,a,s,u;return n(this,(function(n){switch(n.label){case 0:t=(0,l.getUserCacheKey)(e);a=r;this._mergeInitializeResponseIntoUserMap(a,this._values,t,e,(function(e){return e}));if(o&&(s=this._values[t])&&t&&t==this._userCacheKey){this._userValues=s;this._reason=i.Network}u=this;return[4,this._writeValuesToStorage(this._values)];case 1:u._values=n.sent();return[2]}}))}))};e.prototype.checkGate=function(e){var t,n,r=(0,l.getHashValue)(e,this._userValues.hash_used),i={name:e,value:!1,rule_id:"",secondary_exposures:[]},o=null===(t=this._userValues)||void 0===t?void 0:t.feature_gates[r];o&&(i=o);i.secondary_exposures=this.mapExposures(null!==(n=i.secondary_exposures)&&void 0!==n?n:[]);return{evaluationDetails:this._getEvaluationDetails(null!=o),gate:i}};e.prototype.mapExposures=function(e){var t=this;return e.map((function(e){var n;return"string"==typeof e?(null!==(n=t._userValues.exposures)&&void 0!==n?n:{})[e]:e}))};e.prototype.getConfig=function(e){var t,n,r,i,a=(0,l.getHashValue)(e,this._userValues.hash_used);if(null!=(null===(t=this._userValues)||void 0===t?void 0:t.dynamic_configs[a])){var s=null===(n=this._userValues)||void 0===n?void 0:n.dynamic_configs[a];i=this._getEvaluationDetails(!0);r=this._createDynamicConfig(e,s,i)}else{i=this._getEvaluationDetails(!1);r=new o.default(e,{},"",i)}return r};e.prototype.getLayer=function(e,t){var n,r,i,o,s,u=this._getLatestValue(t,"layer_configs"),l=this._getEvaluationDetails(null!=u);return a.default._create(t,null!==(n=null==u?void 0:u.value)&&void 0!==n?n:{},null!==(r=null==u?void 0:u.rule_id)&&void 0!==r?r:"",l,e,this.mapExposures(null!==(i=null==u?void 0:u.secondary_exposures)&&void 0!==i?i:[]),this.mapExposures(null!==(o=null==u?void 0:u.undelegated_secondary_exposures)&&void 0!==o?o:[]),null!==(s=null==u?void 0:u.allocated_experiment_name)&&void 0!==s?s:"",null==u?void 0:u.explicit_parameters)};e.prototype.getGlobalEvaluationDetails=function(){var e,t;return{reason:null!==(e=this._reason)&&void 0!==e?e:i.Uninitialized,time:null!==(t=this._userValues.evaluation_time)&&void 0!==t?t:0}};e.prototype._loadFromLocalStorage=function(){this._parseCachedValues(c.default.getItem(u.INTERNAL_STORE_KEY));this._loaded=!0};e.prototype._parseCachedValues=function(e){try{this._values=e?JSON.parse(e):this._values;this._setUserValueFromCache()}catch(e){this._removeFromStorage(u.INTERNAL_STORE_KEY)}};e.prototype._setUserValueFromCache=function(){var e,t=this._values[this._userCacheKey];if(null==t){this._resetUserValues();this._reason=i.Uninitialized;return null}this._userValues=t;this._reason=i.Cache;return null!==(e=t.evaluation_time)&&void 0!==e?e:0};e.prototype._removeFromStorage=function(e){c.default.removeItem(e)};e.prototype._mergeInitializeResponseIntoUserMap=function(e,t,n,r,i){if(n){var o=this._convertAPIDataToCacheValues(e,n);if(e.has_updates&&e.time){var a=(0,l.djb2HashForObject)(r);o.user_hash=a}t[n]=i(o,n)}};e.prototype._getDefaultUserCacheValues=function(){return{feature_gates:{},layer_configs:{},dynamic_configs:{},time:0,evaluation_time:0,has_updates:!1}};e.prototype._writeValuesToStorage=function(e){return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){t=Object.entries(e).sort((function(e,t){var n,r,i=e[1],o=t[1];return null==i?1:null==o?-1:(null!==(n=null==o?void 0:o.evaluation_time)&&void 0!==n?n:null==o?void 0:o.time)-(null!==(r=null==i?void 0:i.evaluation_time)&&void 0!==r?r:null==i?void 0:i.time)})).slice(0,10);e=Object.fromEntries(t);c.default.setItem(u.INTERNAL_STORE_KEY,JSON.stringify(e));return[2,e]}))}))};e.prototype._getLatestValue=function(e,t){var n,r,i,o,a,s=(0,l.getHashValue)(e,this._userValues.hash_used);return null!==(i=null===(r=null===(n=this._userValues)||void 0===n?void 0:n[t])||void 0===r?void 0:r[s])&&void 0!==i?i:null===(a=null===(o=this._userValues)||void 0===o?void 0:o[t])||void 0===a?void 0:a[e]};e.prototype._createDynamicConfig=function(e,t,n){var r,i,a,s;return new o.default(e,null!==(r=null==t?void 0:t.value)&&void 0!==r?r:{},null!==(i=null==t?void 0:t.rule_id)&&void 0!==i?i:"",n,this.mapExposures(null!==(a=null==t?void 0:t.secondary_exposures)&&void 0!==a?a:[]),null!==(s=null==t?void 0:t.allocated_experiment_name)&&void 0!==s?s:"",this._makeOnConfigDefaultValueFallback(this._identity._user))};e.prototype._getEvaluationDetails=function(e,t){var n;return e?{reason:this._reason,time:null!==(n=this._userValues.evaluation_time)&&void 0!==n?n:Date.now()}:{reason:null!=t?t:this._reason==i.Uninitialized?i.Uninitialized:i.Unrecognized,time:Date.now()}};e.prototype._resetUserValues=function(){this._userValues=this._getDefaultUserCacheValues()};e.prototype._convertAPIDataToCacheValues=function(e,t){return{feature_gates:e.feature_gates,layer_configs:e.layer_configs,dynamic_configs:e.dynamic_configs,time:null==e.time||isNaN(e.time)?0:e.time,evaluation_time:Date.now(),derived_fields:e.derived_fields,hash_used:e.hash_used}};e.prototype._makeOnConfigDefaultValueFallback=function(e){var t=this;return function(n,r,i,o){t.isLoaded()&&t._onDefaultValueFallback(e,"Parameter ".concat(r," is a value of type ").concat(o,".\n          Returning requested defaultValue type ").concat(i),{name:n._name,ruleID:n._ruleID,parameter:r,defaultValueType:i,valueType:o})}};return e}();e.default=d}(Ut);var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.verifySDKKeyUsed=void 0;var $t=ot,Wt=ht;Jt.verifySDKKeyUsed=function(e,t,n){var r=null==e?void 0:e.hashed_sdk_key_used;if(null!=r&&r!==(0,Wt.SimpleHash)(null!=t?t:"")){n._logError("fetchAndSaveValues",new $t.StatsigSDKKeyMismatchError("The SDK key provided does not match the one used to generate values."));return!1}return!0};var qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.difference=qt.now=void 0;function Ht(){return"undefined"!=typeof performance&&performance?0|performance.now():Date.now()}qt.now=Ht;qt.difference=function(e){return Ht()-e};var Xt={};!function(e){var t=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.saveOverridesToLocalStorage=e.loadOverridesFromLocalStorage=e.makeEmptyOverrides=e.STORAGE_KEY=void 0;var n=t(yt);e.STORAGE_KEY="STATSIG_JS_LITE_LOCAL_OVERRIDES";function r(){return{gates:{},configs:{},layers:{}}}e.makeEmptyOverrides=r;e.loadOverridesFromLocalStorage=function(){var t=n.default.getItem(e.STORAGE_KEY);if(t)try{return JSON.parse(t)}catch(e){}return{gates:{},configs:{},layers:{}}};e.saveOverridesToLocalStorage=function(t){n.default.setItem(e.STORAGE_KEY,JSON.stringify(t))}}(Xt);var Yt=ae&&ae.__assign||function(){Yt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e};return Yt.apply(this,arguments)},Qt=ae&&ae.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}});Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n);e[r]=t[n]}),Zt=ae&&ae.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),en=ae&&ae.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&Qt(t,e,n);Zt(t,e);return t},tn=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},nn=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},rn=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(at,"__esModule",{value:!0});var on=rn(st),an=rn(lt),sn=ot,un=rn(ct),ln=rn(ft),cn=rn(St),dn=rn(It),fn=rn(Gt),pn=en(Ut),hn=Jt,gn=rn(yt),vn=qt,yn=rn(At),_n=Xt,mn=function(){function e(e,t,n){var r=this;this._initCalled=!1;this._pendingInitPromise=null;this._sdkKey=null;this._logLayerParameterExposureForLayer=function(e,t,n){void 0===n&&(n=!1);var i="",o=e._undelegatedSecondaryExposures,a=e._explicitParameters.includes(t);if(a){i=e._allocatedExperimentName;o=e._secondaryExposures}r._logger.logLayerExposure(r._identity._user,e._name,e._ruleID,o,i,t,a,e._evaluationDetails,n,r._store.getBootstrapMetadata())};if(!0!==(null==n?void 0:n.localMode)&&("string"!=typeof e||!e.startsWith("client-")))throw new sn.StatsigInvalidArgumentError("Invalid key provided.  You must use a Client SDK Key from the Statsig console to initialize the sdk");this._sdkKey=e;this._startTime=(0,vn.now)();this._options=new fn.default(n);this._errorBoundary=new an.default(e,this._options);this._ready=!1;gn.default.disabled=this._options.disableLocalStorage;this._overrides=(0,_n.loadOverridesFromLocalStorage)();this._identity=new ln.default(e,this._normalizeUser(null!=t?t:null),this._options.overrideStableID);this._network=new dn.default(this._options,this._identity,this._errorBoundary);this._logger=new cn.default(this._options,this._identity,this._network,this._errorBoundary);this._store=new pn.default(this._identity,this._logger.logConfigDefaultValueFallback,this._options.initializeValues);this._errorBoundary._setStatsigMetadata(this._identity._statsigMetadata);if(null!=this._options.initializeValues){this._ready=!0;this._initCalled=!0;setTimeout((function(){return r._delayedSetup()}),20)}}e.prototype.setInitializeValues=function(e){var t=this;this._errorBoundary._capture("setInitializeValues",(function(){t._store.bootstrap(e);if(!t._ready){t._ready=!0;t._initCalled=!0}t._logger.sendSavedRequests()}),(function(){t._ready=!0;t._initCalled=!0}))};e.prototype.initializeAsync=function(){return tn(this,void 0,void 0,(function(){var e=this;return nn(this,(function(t){return[2,this._errorBoundary._capture("initializeAsync",(function(){return tn(e,void 0,void 0,(function(){var e,t=this;return nn(this,(function(n){if(null!=this._pendingInitPromise)return[2,this._pendingInitPromise];if(this._ready)return[2,Promise.resolve()];this._initCalled=!0;if(this._options.localMode)return[2,Promise.resolve()];e=this._identity._user;this._pendingInitPromise=this._fetchAndSaveValues(e,this._options.initTimeoutMs).then((function(){})).catch((function(e){t._errorBoundary._logError("initializeAsync:fetchAndSaveValues",e);return{success:!1,message:e.message}})).then((function(){})).finally((function(){return tn(t,void 0,void 0,(function(){return nn(this,(function(e){this._pendingInitPromise=null;this._ready=!0;this._delayedSetup();return[2]}))}))}));return[2,this._pendingInitPromise]}))}))}),(function(){e._ready=!0;e._initCalled=!0;return Promise.resolve()}))]}))}))};e.prototype.getEvaluationDetails=function(){var e=this;return this._errorBoundary._capture("getEvaluationDetails",(function(){return e._store.getGlobalEvaluationDetails()}),(function(){return{time:Date.now(),reason:pn.EvaluationReason.Error}}))};e.prototype.checkGate=function(e){return this._checkGateImpl(e,"checkGate")};e.prototype.checkGateWithExposureLoggingDisabled=function(e){return this._checkGateImpl(e,"checkGateWithExposureLoggingDisabled")};e.prototype.logGateExposure=function(e){var t=this;this._errorBoundary._swallow("logGateExposure",(function(){t._logGateExposureImpl(e)}))};e.prototype.getConfig=function(e){return this._getConfigImpl(e,"getConfig")};e.prototype.getConfigWithExposureLoggingDisabled=function(e){return this._getConfigImpl(e,"getConfigWithExposureLoggingDisabled")};e.prototype.logConfigExposure=function(e){var t=this;this._errorBoundary._swallow("logConfigExposure",(function(){t._logConfigExposureImpl(e)}))};e.prototype.getExperiment=function(e){return this.getConfig(e)};e.prototype.getExperimentWithExposureLoggingDisabled=function(e){return this.getConfigWithExposureLoggingDisabled(e)};e.prototype.logExperimentExposure=function(e){this.logConfigExposure(e)};e.prototype.getLayer=function(e){return this._getLayerImpl(e,"getLayer")};e.prototype.getLayerWithExposureLoggingDisabled=function(e){return this._getLayerImpl(e,"getLayerWithExposureLoggingDisabled")};e.prototype.logLayerParameterExposure=function(e,t){var n=this;this._errorBoundary._swallow("logLayerParameterExposure",(function(){var r=n._getLayerFromStore(null,e);n._logLayerParameterExposureForLayer(r,t,!0)}))};e.prototype.logEvent=function(e,t,n){var r=this;void 0===t&&(t=null);void 0===n&&(n=null);this._errorBoundary._swallow("logEvent",(function(){if(!r._logger||!r._identity._sdkKey)throw new sn.StatsigUninitializedError(sn.StatsigErrorMessage.REQUIRE_INITIALIZE_FOR_LOG_EVENT);if("string"==typeof e&&0!==e.length){var i=(0,yn.default)(e,r._identity._user,r._identity._statsigMetadata,t,n);r._logger.log(i)}}))};e.prototype.updateUserWithValues=function(e,t){var n,r=this,i=Date.now();return this._errorBoundary._capture("updateUserWithValues",(function(){if(!r.initializeCalled())throw new sn.StatsigUninitializedError(sn.StatsigErrorMessage.REQUIRE_ASYNC_INITIALIZE);n=function(e,t){var n=r._options.updateUserCompletionCallback;null==n||n(Date.now()-i,e,t)};r._identity._user=r._normalizeUser(e);r._store.bootstrap(t);r._logger.resetDedupeKeys();n(!0,null);return!0}),(function(){null==n||n(!1,"Failed to update user. An unexpected error occured.");return!1}))};e.prototype.updateUser=function(e){return tn(this,void 0,void 0,(function(){var t,n,r=this;return nn(this,(function(i){t=Date.now();return[2,this._errorBoundary._capture("updateUser",(function(){return tn(r,void 0,void 0,(function(){var r,i=this;return nn(this,(function(o){switch(o.label){case 0:if(!this.initializeCalled())throw new sn.StatsigUninitializedError(sn.StatsigErrorMessage.REQUIRE_ASYNC_INITIALIZE);n=function(e,n){var r=i._options.updateUserCompletionCallback;null==r||r(Date.now()-t,e,n)};this._identity._user=this._normalizeUser(e);this._store.updateUser();this._logger.resetDedupeKeys();return null==this._pendingInitPromise?[3,2]:[4,this._pendingInitPromise];case 1:o.sent();o.label=2;case 2:if(this._options.localMode){n(!0,null);return[2,Promise.resolve(!0)]}r=this._identity._user;this._pendingInitPromise=this._fetchAndSaveValues(r).finally((function(){i._pendingInitPromise=null}));return[2,this._pendingInitPromise.then((function(){n(!0,null);return Promise.resolve(!0)})).catch((function(e){n(!1,"Failed to update user: ".concat(e));return Promise.resolve(!1)}))]}}))}))}),(function(){n(!1,"Failed to update user. An unexpected error occured.");return Promise.resolve(!1)}))]}))}))};e.prototype.shutdown=function(){var e=this;this._errorBoundary._swallow("shutdown",(function(){e._logger.shutdown()}))};e.prototype.getStableID=function(){var e=this;return this._errorBoundary._capture("getStableID",(function(){return e._identity._statsigMetadata.stableID}),(function(){return""}))};e.prototype.initializeCalled=function(){return this._initCalled};e.prototype.overrideGate=function(e,t){this._setOverride("gates",e,t)};e.prototype.overrideConfig=function(e,t){this._setOverride("configs",e,t)};e.prototype.overrideLayer=function(e,t){this._setOverride("layers",e,t)};e.prototype.setOverrides=function(e){var t=this;this._errorBoundary._swallow("setOverrides",(function(){t._overrides=null!=e?e:(0,_n.makeEmptyOverrides)();(0,_n.saveOverridesToLocalStorage)(t._overrides)}))};e.prototype.getOverrides=function(){var e=this;return this._errorBoundary._capture("getOverrides",(function(){return e._overrides}),(function(){return(0,_n.makeEmptyOverrides)()}))};e.prototype._delayedSetup=function(){var e=this;this._errorBoundary._swallow("delayedSetup",(function(){e._identity.saveStableID();e._logger.sendSavedRequests().then((function(){}))}))};e.prototype._normalizeUser=function(e){var t={};try{t=JSON.parse(JSON.stringify(e))}catch(e){throw new sn.StatsigInvalidArgumentError("User object must be convertable to JSON string.")}null!=this._options.environment&&(t=Yt(Yt({},t),{statsigEnvironment:this._options.environment}));return t};e.prototype._ensureStoreLoaded=function(){if(!this._store.isLoaded())throw new sn.StatsigUninitializedError};e.prototype._getEvaluationDetailsForError=function(){return{time:Date.now(),reason:pn.EvaluationReason.Error}};e.prototype._fetchAndSaveValues=function(e,t){void 0===t&&(t=this._options.initTimeoutMs);return tn(this,void 0,void 0,(function(){var n,r,i=this;return nn(this,(function(o){null;n=this._store.getLastUpdateTime(e);r=this._store.getPreviousDerivedFields(e);return[2,this._network.fetchValues(e,n,t,r).eventually((function(t){var n;(0,hn.verifySDKKeyUsed)(t,null!==(n=i._sdkKey)&&void 0!==n?n:"",i._errorBoundary)&&(null==t?void 0:t.has_updates)&&i._store.save(e,t,!1)})).then((function(t){return tn(i,void 0,void 0,(function(){var n=this;return nn(this,(function(r){return[2,this._errorBoundary._swallow("fetchAndSaveValues",(function(){return tn(n,void 0,void 0,(function(){var n;return nn(this,(function(r){switch(r.label){case 0:return(0,hn.verifySDKKeyUsed)(t,null!==(n=this._sdkKey)&&void 0!==n?n:"",this._errorBoundary)?(null==t?void 0:t.has_updates)?[4,this._store.save(e,t)]:[3,2]:[2];case 1:r.sent();return[3,3];case 2:(null==t?void 0:t.is_no_content)&&this._store.setEvaluationReason(pn.EvaluationReason.NetworkNotModified);r.label=3;case 3:return[2]}}))}))}))]}))}))}))]}))}))};e.prototype._checkGateImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if("boolean"==typeof n._overrides.gates[e])return n._overrides.gates[e];var r=n._getGateFromStore(e);"checkGate"===t&&n._logGateExposureImpl(e,r);return!0===r.gate.value}),(function(){return!1}))};e.prototype._getGateFromStore=function(e){this._ensureStoreLoaded();if("string"!=typeof e||0===e.length)throw new sn.StatsigInvalidArgumentError("Must pass a valid string as the gateName.");return this._store.checkGate(e)};e.prototype._logGateExposureImpl=function(e,t){var n,r=!t,i=null!=t?t:this._getGateFromStore(e),o=i.gate;this._logger.logGateExposure(this._identity._user,e,o.value,o.rule_id,this._store.mapExposures(null!==(n=o.secondary_exposures)&&void 0!==n?n:[]),i.evaluationDetails,r,this._store.getBootstrapMetadata())};e.prototype._getConfigImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if(n._overrides.configs[e])return new on.default(e,n._overrides.configs[e],"local_override",{reason:pn.EvaluationReason.LocalOverride,time:Date.now()});var r=n._getConfigFromStore(e);"getConfig"===t&&n._logConfigExposureImpl(e,r);return r}),(function(){return n._getEmptyConfig(e)}))};e.prototype._getConfigFromStore=function(e){this._ensureStoreLoaded();if("string"!=typeof e||0===e.length)throw new sn.StatsigInvalidArgumentError("Must pass a valid string as the configName.");return this._store.getConfig(e)};e.prototype._logConfigExposureImpl=function(e,t){var n=!t,r=null!=t?t:this._getConfigFromStore(e);this._logger.logConfigExposure(this._identity._user,e,r._ruleID,r._secondaryExposures,r._evaluationDetails,n,this._store.getBootstrapMetadata())};e.prototype._getLayerImpl=function(e,t){var n=this;return this._errorBoundary._capture(t,(function(){if(n._overrides.layers[e])return un.default._create(e,n._overrides.layers[e],"local_override",{reason:pn.EvaluationReason.LocalOverride,time:Date.now()});var r="getLayer"===t?n._logLayerParameterExposureForLayer:null;return n._getLayerFromStore(r,e)}),(function(){return un.default._create(e,{},"",n._getEvaluationDetailsForError())}))};e.prototype._getLayerFromStore=function(e,t){this._ensureStoreLoaded();if("string"!=typeof t||0===t.length)throw new sn.StatsigInvalidArgumentError("Must pass a valid string as the layerName.");return this._store.getLayer(e,t)};e.prototype._getEmptyConfig=function(e){return new on.default(e,{},"",this._getEvaluationDetailsForError())};e.prototype._setOverride=function(e,t,n){null==n?delete this._overrides[e][t]:this._overrides[e][t]=n;this.setOverrides(this._overrides)};return e}();at.default=mn;!function(e){var t=ae&&ae.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s);var t}u((r=r.apply(e,t||[])).next())}))},n=ae&&ae.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;(r=0,i)&&(s=[2&s[0],i.value]);switch(s[0]){case 0:case 1:i=s;break;case 4:a.label++;return{value:s[1],done:!1};case 5:a.label++;r=s[1];s=[0];continue;case 7:s=a.ops.pop();a.trys.pop();continue;default:if(!(i=a.trys,i=i.length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1];i=s;break}if(i&&a.label<i[2]){a.label=i[2];a.ops.push(s);break}i[2]&&a.ops.pop();a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e];r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},r=ae&&ae.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(e,"__esModule",{value:!0});e.EvaluationReason=e.Layer=e.DynamicConfig=void 0;var i=ot,o=r(at),a=Ut,s=st;Object.defineProperty(e,"DynamicConfig",{enumerable:!0,get:function(){return r(s).default}});var u=ct;Object.defineProperty(e,"Layer",{enumerable:!0,get:function(){return r(u).default}});var l=Ut;Object.defineProperty(e,"EvaluationReason",{enumerable:!0,get:function(){return l.EvaluationReason}});var c=function(){function e(){}e.initialize=function(r,i,a){var s;return t(this,void 0,void 0,(function(){var t;return n(this,(function(n){t=null!==(s=e.instance)&&void 0!==s?s:new o.default(r,i,a);e.instance||(e.instance=t);return[2,t.initializeAsync()]}))}))};e.setInitializeValues=function(t){e._getClientX().setInitializeValues(t)};e.checkGate=function(t){return e._getClientX().checkGate(t)};e.checkGateWithExposureLoggingDisabled=function(t){return e._getClientX().checkGateWithExposureLoggingDisabled(t)};e.manuallyLogGateExposure=function(t){e._getClientX().logGateExposure(t)};e.getConfig=function(t){return e._getClientX().getConfig(t)};e.getConfigWithExposureLoggingDisabled=function(t){return e._getClientX().getConfigWithExposureLoggingDisabled(t)};e.manuallyLogConfigExposure=function(t){e._getClientX().logConfigExposure(t)};e.getExperiment=function(t){return e._getClientX().getExperiment(t)};e.getExperimentWithExposureLoggingDisabled=function(t){return e._getClientX().getExperimentWithExposureLoggingDisabled(t)};e.manuallyLogExperimentExposure=function(t){e._getClientX().logExperimentExposure(t)};e.getLayer=function(t){return e._getClientX().getLayer(t)};e.getLayerWithExposureLoggingDisabled=function(t){return e._getClientX().getLayerWithExposureLoggingDisabled(t)};e.manuallyLogLayerParameterExposure=function(t,n){e._getClientX().logLayerParameterExposure(t,n)};e.logEvent=function(t,n,r){void 0===n&&(n=null);void 0===r&&(r=null);return e._getClientX().logEvent(t,n,r)};e.updateUser=function(t){return e._getClientX().updateUser(t)};e.updateUserWithValues=function(t,n){return e._getClientX().updateUserWithValues(t,n)};e.shutdown=function(){e._getClientX().shutdown();e.instance=null};e.overrideGate=function(t,n){e._getClientX().overrideGate(t,n)};e.overrideConfig=function(t,n){e._getClientX().overrideConfig(t,n)};e.overrideLayer=function(t,n){e._getClientX().overrideLayer(t,n)};e.setOverrides=function(t){e._getClientX().setOverrides(t)};e.getOverrides=function(){return e._getClientX().getOverrides()};e.getStableID=function(){return e._getClientX().getStableID()};e.getEvaluationDetails=function(){var t,n;return null!==(n=null===(t=e.instance)||void 0===t?void 0:t.getEvaluationDetails())&&void 0!==n?n:{reason:a.EvaluationReason.Uninitialized,time:0}};e.initializeCalled=function(){return null!=e.instance&&e.instance.initializeCalled()};e._getClientX=function(){if(!e.instance)throw new i.StatsigUninitializedError;return e.instance};e.instance=null;return e}();e.default=c}(it);var bn=se(it),wn={exports:{}};
/*!
   * EventEmitter2
   * https://github.com/hij1nx/EventEmitter2
   *
   * Copyright (c) 2013 hij1nx
   * Licensed under the MIT license.
   */
!function(e,t){!function(t){var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};function r(){this._events={};this._conf&&i.call(this,this._conf)}function i(e){if(e){this._conf=e;e.delimiter&&(this.delimiter=e.delimiter);this._maxListeners=e.maxListeners!==t?e.maxListeners:10;e.wildcard&&(this.wildcard=e.wildcard);e.newListener&&(this.newListener=e.newListener);e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak);this.wildcard&&(this.listenerTree={})}else this._maxListeners=10}function o(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";this.verboseMemoryLeak&&(n+=" Event name: "+t+".");if("undefined"!=typeof process&&process.emitWarning){var r=new Error(n);r.name="MaxListenersExceededWarning";r.emitter=this;r.count=e;process.emitWarning(r)}else{console.error(n);console.trace&&console.trace()}}function a(e){this._events={};this.newListener=!1;this.verboseMemoryLeak=!1;i.call(this,e)}a.EventEmitter2=a;function s(e,t,n,r){if(!n)return[];var i,o,a,u,l,c,d,f=[],p=t.length,h=t[r],g=t[r+1];if(r===p&&n._listeners){if("function"==typeof n._listeners){e&&e.push(n._listeners);return[n]}for(i=0,o=n._listeners.length;i<o;i++)e&&e.push(n._listeners[i]);return[n]}if("*"===h||"**"===h||n[h]){if("*"===h){for(a in n)"_listeners"!==a&&n.hasOwnProperty(a)&&(f=f.concat(s(e,t,n[a],r+1)));return f}if("**"===h){(d=r+1===p||r+2===p&&"*"===g)&&n._listeners&&(f=f.concat(s(e,t,n,p)));for(a in n)if("_listeners"!==a&&n.hasOwnProperty(a))if("*"===a||"**"===a){n[a]._listeners&&!d&&(f=f.concat(s(e,t,n[a],p)));f=f.concat(s(e,t,n[a],r))}else f=a===g?f.concat(s(e,t,n[a],r+2)):f.concat(s(e,t,n[a],r));return f}f=f.concat(s(e,t,n[h],r+1))}(u=n["*"])&&s(e,t,u,r+1);if(l=n["**"])if(r<p){l._listeners&&s(e,t,l,p);for(a in l)if("_listeners"!==a&&l.hasOwnProperty(a))if(a===g)s(e,t,l[a],r+2);else if(a===h)s(e,t,l[a],r+1);else{(c={})[a]=l[a];s(e,t,{"**":c},r+1)}}else l._listeners?s(e,t,l,p):l["*"]&&l["*"]._listeners&&s(e,t,l["*"],p);return f}function u(e,n){for(var r=0,i=(e="string"==typeof e?e.split(this.delimiter):e.slice()).length;r+1<i;r++)if("**"===e[r]&&"**"===e[r+1])return;for(var a=this.listenerTree,s=e.shift();s!==t;){a[s]||(a[s]={});a=a[s];if(0===e.length){if(a._listeners){"function"==typeof a._listeners&&(a._listeners=[a._listeners]);a._listeners.push(n);if(!a._listeners.warned&&this._maxListeners>0&&a._listeners.length>this._maxListeners){a._listeners.warned=!0;o.call(this,a._listeners.length,s)}}else a._listeners=n;return!0}s=e.shift()}return!0}a.prototype.delimiter=".";a.prototype.setMaxListeners=function(e){if(e!==t){this._maxListeners=e;this._conf||(this._conf={});this._conf.maxListeners=e}};a.prototype.event="";a.prototype.once=function(e,t){return this._once(e,t,!1)};a.prototype.prependOnceListener=function(e,t){return this._once(e,t,!0)};a.prototype._once=function(e,t,n){this._many(e,1,t,n);return this};a.prototype.many=function(e,t,n){return this._many(e,t,n,!1)};a.prototype.prependMany=function(e,t,n){return this._many(e,t,n,!0)};a.prototype._many=function(e,t,n,r){var i=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function o(){0==--t&&i.off(e,o);return n.apply(this,arguments)}o._origin=n;this._on(e,o,r);return i};a.prototype.emit=function(){this._events||r.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;var t,n,i,o,a,u=arguments.length;if(this._all&&this._all.length){a=this._all.slice();if(u>3){t=new Array(u);for(o=0;o<u;o++)t[o]=arguments[o]}for(i=0,n=a.length;i<n;i++){this.event=e;switch(u){case 1:a[i].call(this,e);break;case 2:a[i].call(this,e,arguments[1]);break;case 3:a[i].call(this,e,arguments[1],arguments[2]);break;default:a[i].apply(this,t)}}}if(this.wildcard){a=[];var l="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,l,this.listenerTree,0)}else{if("function"==typeof(a=this._events[e])){this.event=e;switch(u){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:t=new Array(u-1);for(o=1;o<u;o++)t[o-1]=arguments[o];a.apply(this,t)}return!0}a&&(a=a.slice())}if(a&&a.length){if(u>3){t=new Array(u-1);for(o=1;o<u;o++)t[o-1]=arguments[o]}for(i=0,n=a.length;i<n;i++){this.event=e;switch(u){case 1:a[i].call(this);break;case 2:a[i].call(this,arguments[1]);break;case 3:a[i].call(this,arguments[1],arguments[2]);break;default:a[i].apply(this,t)}}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all};a.prototype.emitAsync=function(){this._events||r.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,n,i,o,a,u=[],l=arguments.length;if(this._all){if(l>3){t=new Array(l);for(o=1;o<l;o++)t[o]=arguments[o]}for(i=0,n=this._all.length;i<n;i++){this.event=e;switch(l){case 1:u.push(this._all[i].call(this,e));break;case 2:u.push(this._all[i].call(this,e,arguments[1]));break;case 3:u.push(this._all[i].call(this,e,arguments[1],arguments[2]));break;default:u.push(this._all[i].apply(this,t))}}}if(this.wildcard){a=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,a,c,this.listenerTree,0)}else a=this._events[e];if("function"==typeof a){this.event=e;switch(l){case 1:u.push(a.call(this));break;case 2:u.push(a.call(this,arguments[1]));break;case 3:u.push(a.call(this,arguments[1],arguments[2]));break;default:t=new Array(l-1);for(o=1;o<l;o++)t[o-1]=arguments[o];u.push(a.apply(this,t))}}else if(a&&a.length){a=a.slice();if(l>3){t=new Array(l-1);for(o=1;o<l;o++)t[o-1]=arguments[o]}for(i=0,n=a.length;i<n;i++){this.event=e;switch(l){case 1:u.push(a[i].call(this));break;case 2:u.push(a[i].call(this,arguments[1]));break;case 3:u.push(a[i].call(this,arguments[1],arguments[2]));break;default:u.push(a[i].apply(this,t))}}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)};a.prototype.on=function(e,t){return this._on(e,t,!1)};a.prototype.prependListener=function(e,t){return this._on(e,t,!0)};a.prototype.onAny=function(e){return this._onAny(e,!1)};a.prototype.prependAny=function(e){return this._onAny(e,!0)};a.prototype.addListener=a.prototype.on;a.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");this._all||(this._all=[]);t?this._all.unshift(e):this._all.push(e);return this};a.prototype._on=function(e,t,n){if("function"==typeof e){this._onAny(e,t);return this}if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||r.call(this);this.emit("newListener",e,t);if(this.wildcard){u.call(this,e,t);return this}if(this._events[e]){"function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]);n?this._events[e].unshift(t):this._events[e].push(t);if(!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners){this._events[e].warned=!0;o.call(this,this._events[e].length,e)}}else this._events[e]=t;return this};a.prototype.off=function(e,r){if("function"!=typeof r)throw new Error("removeListener only takes instances of Function");var i,o=[];if(this.wildcard){var a="string"==typeof e?e.split(this.delimiter):e.slice();o=s.call(this,null,a,this.listenerTree,0)}else{if(!this._events[e])return this;i=this._events[e];o.push({_listeners:i})}for(var u=0;u<o.length;u++){var l=o[u];i=l._listeners;if(n(i)){for(var c=-1,d=0,f=i.length;d<f;d++)if(i[d]===r||i[d].listener&&i[d].listener===r||i[d]._origin&&i[d]._origin===r){c=d;break}if(c<0)continue;this.wildcard?l._listeners.splice(c,1):this._events[e].splice(c,1);0===i.length&&(this.wildcard?delete l._listeners:delete this._events[e]);this.emit("removeListener",e,r);return this}if(i===r||i.listener&&i.listener===r||i._origin&&i._origin===r){this.wildcard?delete l._listeners:delete this._events[e];this.emit("removeListener",e,r)}}!function e(n){if(n!==t){var r=Object.keys(n);for(var i in r){var o=r[i],a=n[o];if(!(a instanceof Function||"object"!=typeof a||null===a)){Object.keys(a).length>0&&e(n[o]);0===Object.keys(a).length&&delete n[o]}}}}(this.listenerTree);return this};a.prototype.offAny=function(e){var t,n=0,r=0;if(e&&this._all&&this._all.length>0){for(n=0,r=(t=this._all).length;n<r;n++)if(e===t[n]){t.splice(n,1);this.emit("removeListenerAny",e);return this}}else{for(n=0,r=(t=this._all).length;n<r;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this};a.prototype.removeListener=a.prototype.off;a.prototype.removeAllListeners=function(e){if(0===arguments.length){!this._events||r.call(this);return this}if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),n=s.call(this,null,t,this.listenerTree,0),i=0;i<n.length;i++){var o=n[i];o._listeners=null}else this._events&&(this._events[e]=null);return this};a.prototype.listeners=function(e){if(this.wildcard){var t=[],i="string"==typeof e?e.split(this.delimiter):e.slice();s.call(this,t,i,this.listenerTree,0);return t}this._events||r.call(this);this._events[e]||(this._events[e]=[]);n(this._events[e])||(this._events[e]=[this._events[e]]);return this._events[e]};a.prototype.eventNames=function(){return Object.keys(this._events)};a.prototype.listenerCount=function(e){return this.listeners(e).length};a.prototype.listenersAny=function(){return this._all?this._all:[]};e.exports=a}()}(wn);function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kn="@all-features",On=function(){return Ge((function e(){Fe(this,e);Ue(this,"eventToValue",new Map);this.emitter=new wn.exports.EventEmitter2}),[{key:"onGateUpdated",value:function(e,t,n,r){var i=this,o=n(e,En(En({},r),{},{fireGateExposure:!1}));void 0===this.eventToValue.get(t)&&this.eventToValue.set(t,o);var a=function(){var o=n(e,En(En({},r),{},{fireGateExposure:!1}));if(i.eventToValue.get(t)!==o){i.eventToValue.set(t,o);t(o)}};this.emitter.on(e,a);return function(){i.emitter.off(e,a)}}},{key:"onExperimentValueUpdated",value:function(e,t,n,r,i,o){var a=this,s="".concat(e,".").concat(t),u=i(e,t,n,En(En({},o),{},{fireExperimentExposure:!1}));void 0===this.eventToValue.get(r)&&this.eventToValue.set(r,u);var l=function(){var s=i(e,t,n,En(En({},o),{},{fireExperimentExposure:!1}));if(a.eventToValue.get(r)!==s){a.eventToValue.set(r,s);r(s)}};this.emitter.on(s,l);return function(){a.emitter.off(s,l)}}},{key:"onAnyUpdated",value:function(e){var t=this;this.emitter.on(kn,e);return function(){t.emitter.off(kn,e)}}},{key:"anyUpdated",value:function(){var e=this;this.emitter.emit(kn);this.emitter.eventNames().filter((function(e){return e!==kn})).forEach((function(t){e.emitter.emit(t)}))}}])}(),Sn=function(e){e.Development="development";e.Staging="staging";e.Production="production";return e}({}),An=function(e){e.COMMERCIAL="commercial";e.FEDRAMP_MODERATE="fedramp-moderate";return e}({}),Cn="4.23.4";function In(e,t){if(t&&("object"==Ve(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Ln(e){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ln(e)}function Tn(e){var n="function"==typeof Map?new Map:void 0;return Tn=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return T(e,arguments,Ln(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t(r,e)},Tn(e)}function Pn(e,t,n){return t=Ln(t),In(e,Dn()?Reflect.construct(t,n||[],Ln(e).constructor):t.apply(e,n))}function Dn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dn=function(){return!!e})()}var Mn=function(e){function n(e){Fe(this,n);return Pn(this,n,[e])}!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&t(e,n)}(n,e);return Ge(n)}(Tn(Error));function jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jn(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Vn="https://api.atlassian.com/flags",Nn="https://api.stg.atlassian.com/flags",Rn="https://api.dev.atlassian.com/flags",Gn="https://api.stg.atlassian-us-gov-mod.com/flags",Un="https://api.atlassian-us-gov-mod.com/flags",Bn="/gateway/api/flags",zn=function(){function e(){Fe(this,e)}return Ge(e,null,[{key:"fetchClientSdk",value:(o=Je(rt.mark((function e(t){var n,r;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.targetApp;r="/api/v2/frontend/clientSdkKey/".concat(n);e.prev=2;e.next=5;return this.fetchRequest(r,"GET",t);case 5:return e.abrupt("return",e.sent);case 8:e.prev=8;e.t0=e.catch(2);if(!(e.t0 instanceof Error)){e.next=12;break}throw e.t0;case 12:throw Error("Failed to retrieve client sdk key");case 13:case"end":return e.stop()}}),e,this,[[2,8]])}))),function(e){return o.apply(this,arguments)})},{key:"fetchExperimentValues",value:(i=Je(rt.mark((function e(t,n,r){var i;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={identifiers:n,customAttributes:r,targetApp:t.targetApp};e.prev=1;e.next=4;return this.fetchRequest("/api/v2/frontend/experimentValues","POST",t,i);case 4:return e.abrupt("return",e.sent);case 7:e.prev=7;e.t0=e.catch(1);if(!(e.t0 instanceof Error)){e.next=11;break}throw e.t0;case 11:throw Error("Failed to retrieve experiment values");case 12:case"end":return e.stop()}}),e,this,[[1,7]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"handleResponseError",value:(r=Je(rt.mark((function e(t){var n;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.ok){e.next=5;break}e.next=3;return t.text();case 3:n=e.sent;throw new Mn("Non 2xx response status received, status: ".concat(t.status,", body: ").concat(JSON.stringify(n)));case 5:if(204!==t.status){e.next=7;break}throw new Mn("Unexpected 204 response");case 7:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"extractResponseBody",value:(n=Je(rt.mark((function e(t){var n;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;return t.text();case 2:n=e.sent;return e.abrupt("return",JSON.parse(n));case 4:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"getBaseUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;if(t)return Bn;if(n===An.FEDRAMP_MODERATE)switch(e){case Sn.Production:return Un;case Sn.Staging:return Gn;default:throw new Error('Invalid environment "'.concat(e,'" for "').concat(n,'" perimeter'))}else{if(n!==An.COMMERCIAL)throw new Error('Invalid perimeter "'.concat(n,'"'));switch(e){case Sn.Development:return Rn;case Sn.Staging:return Nn;default:return Vn}}}},{key:"fetchRequest",value:(t=Je(rt.mark((function t(n,r,i,o){var a,s,u,l,c;return rt.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.getBaseUrl(i.environment,i.useGatewayURL,i.perimeter);s=i.fetchTimeoutMs||5e3;if(AbortSignal.timeout)u=AbortSignal.timeout(s);else if(AbortController){l=new AbortController;u=l.signal;setTimeout((function(){return l.abort()}),s)}t.next=5;return fetch("".concat(a).concat(n),Fn({method:r,headers:{"Content-Type":"application/json","X-Client-Name":"feature-gate-js-client","X-Client-Version":Cn,"X-API-KEY":i.apiKey},signal:u},o&&{body:JSON.stringify(o)}));case 5:c=t.sent;t.next=8;return this.handleResponseError(c);case 8:t.next=10;return this.extractResponseBody(c);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)}))),function(e,n,r,i){return t.apply(this,arguments)})}]);var t,n,r,i,o}();function Kn(){var e,t=globalThis,n=t.MICROS_PERIMETER||t.UNSAFE_ATL_CONTEXT_BOUNDARY;if(n)return"fedramp-moderate"===n;var r=null===(e=t.location)||void 0===e||null===(e=e.hostname)||void 0===e?void 0:e.match(/atlassian-us-gov-mod\.(com|net)|atlassian-us-gov\.(com|net)|atlassian-fex\.(com|net)|atlassian-stg-fedm\.(com|net)/);return!!r&&r.length>0}var Jn=["sdkKey","updateUserCompletionCallback","perimeter"];function $n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$n(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$n(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var qn=function(e){return Wn({perimeter:Kn()?An.FEDRAMP_MODERATE:An.COMMERCIAL},e)},Hn=function(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;var n=Object.entries(e),r=Object.entries(t);if(n.length!==r.length)return!1;var i=function(e,t){var n=ze(e,1)[0],r=ze(t,1)[0];return n.localeCompare(r)};n.sort(i);r.sort(i);for(var o=0;o<n.length;o++){if(ze(n[o],2)[1]!==ze(r[o],2)[1])return!1}return!0},Xn=function(e,t){var n={customIDs:e,custom:t};e.atlassianAccountId&&(n.userID=e.atlassianAccountId);return n},Yn=function(e,t){e.sdkKey;e.updateUserCompletionCallback;e.perimeter;var n=function(e,t){if(null==e)return{};var n,r,i=O(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,Jn);return Wn(Wn({},n),{},{initializeValues:t,environment:{tier:e.environment},disableCurrentPageLogging:!0},e.updateUserCompletionCallback&&{updateUserCompletionCallback:Qn(e.updateUserCompletionCallback)})},Qn=function(e){return function(t,n,r){e(n,r)}};function Zn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function er(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zn(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var tr,nr="client-default-key",rr="https://xp.atlassian.com/v1/",ir=function(){return Ge((function e(){Fe(this,e);Ue(this,"initPromise",null);Ue(this,"initCompleted",!1);Ue(this,"initWithDefaults",!1);Ue(this,"hasCheckGateErrorOccurred",!1);Ue(this,"hasGetExperimentErrorOccurred",!1);Ue(this,"hasGetExperimentValueErrorOccurred",!1);Ue(this,"hasGetLayerErrorOccurred",!1);Ue(this,"hasGetLayerValueErrorOccurred",!1);Ue(this,"subscriptions",new On)}),[{key:"initialize",value:(c=Je(rt.mark((function e(t,n,r){var i,o,a=this;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=qn(t);if(!this.initPromise){e.next=4;break}Hn(i,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 4:o=performance.now();this.initOptions=i;this.initPromise=this.init(i,n,r).then((function(){a.initCompleted=!0;a.initWithDefaults=!0})).finally((function(){var e=performance.now()-o;a.fireClientEvent(o,e,"initialize",a.initCompleted,i.apiKey)}));return e.abrupt("return",this.initPromise);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return c.apply(this,arguments)})},{key:"initializeWithProvider",value:(l=Je(rt.mark((function e(t,n,r,i){var o,a,s=this;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=qn(t);if(!this.initPromise){e.next=4;break}Hn(o,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 4:a=performance.now();this.initOptions=o;this.provider=n;this.provider.setClientVersion(Cn);this.provider.setApplyUpdateCallback&&this.provider.setApplyUpdateCallback(this.applyUpdateCallback);this.initPromise=this.initWithProvider(o,n,r,i).then((function(){s.initCompleted=!0;s.initWithDefaults=!0})).finally((function(){var e=performance.now()-a;s.fireClientEvent(a,e,"initializeWithProvider",s.initCompleted,n.getApiKey?n.getApiKey():void 0)}));return e.abrupt("return",this.initPromise);case 11:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"applyUpdateCallback",value:function(e){try{if(this.initCompleted||this.initWithDefaults){bn.setInitializeValues(e.experimentValues);this.subscriptions.anyUpdated()}}catch(e){console.warn("Error when attempting to apply update",e)}}},{key:"fireClientEvent",value:function(e,t,n,r){var i,o=this,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;null===(i=this.initOptions.analyticsWebClient)||void 0===i||i.then((function(i){var s=er({targetApp:o.initOptions.targetApp,clientVersion:Cn,success:r,startTime:e,totalTime:t},a&&{apiKey:a});i.sendOperationalEvent({action:n,actionSubject:"featureGatesClient",attributes:s,tags:["measurement"],source:"@atlaskit/feature-gate-js-client"})})).catch((function(e){o.initOptions.environment!==Sn.Production&&console.error("Analytics web client promise did not resolve",e)}))}},{key:"initializeFromValues",value:(u=Je(rt.mark((function e(t,n,r){var i,o,a,s=this,u=arguments;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=u.length>3&&void 0!==u[3]?u[3]:{};o=qn(t);if(!this.initPromise){e.next=5;break}Hn(o,this.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied.");return e.abrupt("return",this.initPromise);case 5:a=performance.now();this.initOptions=o;this.initPromise=this.initFromValues(o,n,r,i).then((function(){s.initCompleted=!0;s.initWithDefaults=!0})).finally((function(){var e=performance.now()-a;s.fireClientEvent(a,e,"initializeFromValues",s.initCompleted)}));return e.abrupt("return",this.initPromise);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"updateUser",value:(s=Je(rt.mark((function e(t,n,r){var i,o;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=qn(t);o=function(){return zn.fetchExperimentValues(i,n,r).then((function(e){return{experimentValues:e.experimentValues,customAttributesFromFetch:e.customAttributes}}))};e.next=4;return this.updateUserUsingInitializeValuesProducer(o,n,r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"updateUserWithProvider",value:(a=Je(rt.mark((function e(t,n){var r=this;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.provider){e.next=2;break}throw new Error("Cannot update user using provider as the client was not initialised with a provider");case 2:e.next=4;return this.provider.setProfile(this.initOptions,t,n);case 4:e.next=6;return this.updateUserUsingInitializeValuesProducer((function(){return r.provider.getExperimentValues()}),t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"updateUserWithValues",value:(o=Je(rt.mark((function e(t,n){var r,i,o=arguments;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o.length>2&&void 0!==o[2]?o[2]:{};i=function(){return Promise.resolve({experimentValues:r,customAttributesFromFetch:n})};e.next=4;return this.updateUserUsingInitializeValuesProducer(i,t,n);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"initializeCalled",value:function(){return null!=this.initPromise}},{key:"initializeCompleted",value:function(){return this.initCompleted}},{key:"checkGate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireGateExposure,r=void 0===n||n,i=r?bn.checkGate.bind(bn):bn.checkGateWithExposureLoggingDisabled.bind(bn);return i(e)}catch(t){if(!this.hasCheckGateErrorOccurred){console.warn({msg:"An error has occurred checking the feature gate. Only the first occurrence of this error is logged.",gateName:e,error:t});this.hasCheckGateErrorOccurred=!0}return!1}}},{key:"isGateExist",value:function(e){try{return bn._getClientX()._getGateFromStore(e).evaluationDetails.reason!==it.EvaluationReason.Unrecognized}catch(e){console.error("Error occurred when trying to check FeatureGate: ".concat(e));return!0}}},{key:"isExperimentExist",value:function(e){try{return bn.getExperimentWithExposureLoggingDisabled(e)._evaluationDetails.reason!==it.EvaluationReason.Unrecognized}catch(e){console.error("Error occurred when trying to check Experiment: ".concat(e));return!0}}},{key:"manuallyLogGateExposure",value:function(e){bn.manuallyLogGateExposure(e)}},{key:"getExperiment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireExperimentExposure,r=void 0===n||n,i=r?bn.getExperiment.bind(bn):bn.getExperimentWithExposureLoggingDisabled.bind(bn);return i(e)}catch(t){if(!this.hasGetExperimentErrorOccurred){console.warn({msg:"An error has occurred getting the experiment. Only the first occurrence of this error is logged.",experimentName:e,error:t});this.hasGetExperimentErrorOccurred=!0}return new it.DynamicConfig(e,{},"",{time:Date.now(),reason:it.EvaluationReason.Error})}}},{key:"getExperimentValue",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getExperiment(e,r);try{var o=r.typeGuard;return i.get(t,n,o)}catch(t){if(!this.hasGetExperimentValueErrorOccurred){console.warn({msg:"An error has occurred getting the experiment value. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:n,options:r,error:t});this.hasGetExperimentValueErrorOccurred=!0}return n}}},{key:"manuallyLogExperimentExposure",value:function(e){bn.manuallyLogExperimentExposure(e)}},{key:"manuallyLogLayerExposure",value:function(e,t){bn.manuallyLogLayerParameterExposure(e,t)}},{key:"shutdownStatsig",value:function(){bn.shutdown()}},{key:"overrideGate",value:function(e,t){bn.overrideGate(e,t);this.subscriptions.anyUpdated()}},{key:"clearGateOverride",value:function(e){bn.overrideGate(e,null);this.subscriptions.anyUpdated()}},{key:"overrideConfig",value:function(e,t){bn.overrideConfig(e,t);this.subscriptions.anyUpdated()}},{key:"clearConfigOverride",value:function(e){bn.overrideConfig(e,null);this.subscriptions.anyUpdated()}},{key:"setOverrides",value:function(e){bn.setOverrides(er({gates:{},configs:{},layers:{}},e));this.subscriptions.anyUpdated()}},{key:"getOverrides",value:function(){return bn.getOverrides()}},{key:"clearAllOverrides",value:function(){bn.setOverrides(null);this.subscriptions.anyUpdated()}},{key:"isCurrentUser",value:function(e,t){return Hn(this.currentIdentifiers,e)&&Hn(this.currentAttributes,t)}},{key:"onGateUpdated",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=function(i){var o=r.fireGateExposure;(void 0===o||o)&&n.manuallyLogGateExposure(e);try{t(i)}catch(t){console.warn("Error calling callback for gate ".concat(e," with value ").concat(i),t)}};return this.subscriptions.onGateUpdated(e,i,this.checkGate.bind(this),r)}},{key:"onExperimentValueUpdated",value:function(e,t,n,r){var i=this,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=function(t){var n=o.fireExperimentExposure;(void 0===n||n)&&i.manuallyLogExperimentExposure(e);try{r(t)}catch(n){console.warn("Error calling callback for experiment ".concat(e," with value ").concat(t),n)}};return this.subscriptions.onExperimentValueUpdated(e,t,n,a,this.getExperimentValue,o)}},{key:"onAnyUpdated",value:function(e){return this.subscriptions.onAnyUpdated(e)}},{key:"init",value:(i=Je(rt.mark((function e(t,n,r){var i,o,a,s,u,l,c,d;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=er({},t);e.prev=1;s=zn.fetchClientSdk(t).then((function(e){return i.sdkKey=e.clientSdkKey}));u=zn.fetchExperimentValues(t,n,r);e.next=6;return Promise.all([s,u]);case 6:l=e.sent;c=ze(l,2);d=c[1];o=d.experimentValues;a=d.customAttributes;e.next=20;break;case 13:e.prev=13;e.t0=e.catch(1);e.t0 instanceof Error&&console.error("Error occurred when trying to fetch the Feature Gates client values, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client without values");e.next=19;return this.initFromValues(i,n,r);case 19:throw e.t0;case 20:return e.abrupt("return",this.initFromValues(i,n,a,o));case 21:case"end":return e.stop()}}),e,this,[[1,13]])}))),function(e,t,n){return i.apply(this,arguments)})},{key:"initWithProvider",value:(r=Je(rt.mark((function e(t,n,r,i){var o,a,s,u,l,c,d,f;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=er(er({},t),{},{disableCurrentPageLogging:!0});e.prev=1;e.next=4;return n.setProfile(t,r,i);case 4:u=n.getClientSdkKey().then((function(e){return o.sdkKey=e}));l=n.getExperimentValues();e.next=8;return Promise.all([u,l]);case 8:c=e.sent;d=ze(c,2);f=d[1];a=f.experimentValues;s=f.customAttributesFromFetch;e.next=22;break;case 15:e.prev=15;e.t0=e.catch(1);e.t0 instanceof Error&&console.error("Error occurred when trying to fetch the Feature Gates client values, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client without values");e.next=21;return this.initFromValues(o,r,i);case 21:throw e.t0;case 22:return e.abrupt("return",this.initFromValues(o,r,s,a));case 23:case"end":return e.stop()}}),e,this,[[1,15]])}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"initFromValues",value:(n=Je(rt.mark((function e(t,n,r){var i,o,a,s,u=arguments;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=u.length>3&&void 0!==u[3]?u[3]:{};o=Xn(n,r);this.currentIdentifiers=n;this.currentAttributes=r;t.sdkKey||(t.sdkKey=nr);t.eventLoggingApi||(t.eventLoggingApi=rr);t.perimeter===An.FEDRAMP_MODERATE&&(t.disableAllLogging=!0);a=t.sdkKey;s=Yn(t,i);e.prev=9;e.next=12;return bn.initialize(a,o,s);case 12:e.next=22;break;case 14:e.prev=14;e.t0=e.catch(9);e.t0 instanceof Error&&console.error("Error occurred when trying to initialise the Statsig client, error: ".concat(null===e.t0||void 0===e.t0?void 0:e.t0.message));console.warn("Initialising Statsig client with default sdk key and without values");e.next=20;return bn.initialize(nr,o,er(er({},s),{},{initializeValues:{}}));case 20:this.initWithDefaults=!0;throw e.t0;case 22:case"end":return e.stop()}}),e,this,[[9,14]])}))),function(e,t,r){return n.apply(this,arguments)})},{key:"updateUserUsingInitializeValuesProducer",value:(t=Je(rt.mark((function e(t,n,r){var i,o,a,s=this;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.initPromise){e.next=2;break}throw new Error("The client must be initialized before you can update the user.");case 2:if(!this.isCurrentUser(n,r)){e.next=4;break}return e.abrupt("return",this.initPromise);case 4:i=this.initPromise;e.prev=5;e.next=8;return this.initPromise;case 8:e.next=12;break;case 10:e.prev=10;e.t0=e.catch(5);case 12:o=t();a=this.updateStatsigClientUser(o,n,r);this.initPromise=a.catch(Je(rt.mark((function e(){return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.initPromise=i;if(!s.provider){e.next=4;break}e.next=4;return s.provider.setProfile(s.initOptions,s.currentIdentifiers,s.currentAttributes);case 4:case"end":return e.stop()}}),e)}))));return e.abrupt("return",a);case 16:case"end":return e.stop()}}),e,this,[[5,10]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"updateStatsigClientUser",value:(e=Je(rt.mark((function e(t,n,r){var i,o,a,s,u;return rt.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0;e.next=3;return t;case 3:i=e.sent;o=Xn(n,i.customAttributesFromFetch);e.next=12;break;case 7:e.prev=7;e.t0=e.catch(0);u=e.t0 instanceof Error?e.t0.message:JSON.stringify(e.t0);null===(a=(s=this.initOptions).updateUserCompletionCallback)||void 0===a||a.call(s,!1,u);throw e.t0;case 12:if(!bn.updateUserWithValues(o,i.experimentValues)){e.next=19;break}this.currentIdentifiers=n;this.currentAttributes=r;this.subscriptions.anyUpdated();e.next=20;break;case 19:throw new Error("Failed to update user. An unexpected error occured.");case 20:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(t,n,r){return e.apply(this,arguments)})},{key:"getPackageVersion",value:function(){return Cn}},{key:"getLayer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{var n=t.fireLayerExposure,r=void 0===n||n,i=r?bn.getLayer.bind(bn):bn.getLayerWithExposureLoggingDisabled.bind(bn);return i(e)}catch(t){if(!this.hasGetLayerErrorOccurred){console.warn({msg:"An error has occurred getting the layer. Only the first occurrence of this error is logged.",layerName:e,error:t});this.hasGetLayerErrorOccurred=!0}return it.Layer._create(e,{},"",{time:Date.now(),reason:it.EvaluationReason.Error})}}},{key:"getLayerValue",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=this.getLayer(e,r);try{var o=r.typeGuard;return i.get(t,n,o)}catch(t){if(!this.hasGetLayerValueErrorOccurred){console.warn({msg:"An error has occurred getting the layer value. Only the first occurrence of this error is logged.",layerName:e,defaultValue:n,options:r,error:t});this.hasGetLayerValueErrorOccurred=!0}return n}}}]);var e,t,n,r,i,o,a,s,u,l,c}(),or=function(){return Ge((function e(){Fe(this,e)}),null,[{key:"isGateExists",value:function(e){return this.client.isGateExist(e)}},{key:"isExperimentExists",value:function(e){return this.client.isExperimentExist(e)}}])}();tr=or;Ue(or,"client",new ir);Ue(or,"hasCheckGateErrorOccurred",!1);Ue(or,"hasGetExperimentValueErrorOccurred",!1);Ue(or,"checkGate",(function(e,t){try{if(window&&window.__CRITERION__&&"function"==typeof window.__CRITERION__.getFeatureFlagOverride){var n=window.__CRITERION__.getFeatureFlagOverride(e);if(void 0!==n)return n}}catch(t){if(!tr.hasCheckGateErrorOccurred){console.warn({msg:"An error has occurred checking the feature gate from criterion override. Only the first occurrence of this error is logged.",gateName:e,error:t});tr.hasCheckGateErrorOccurred=!0}}return tr.client.checkGate(e,t)}));Ue(or,"getExperimentValue",(function(e,t,n,r){try{if("undefined"!=typeof window&&window.__CRITERION__&&"function"==typeof window.__CRITERION__.getExperimentValueOverride){var i=window.__CRITERION__.getExperimentValueOverride(e,t);if(null!=i)return i}}catch(t){if(!tr.hasCheckGateErrorOccurred){if(!tr.hasGetExperimentValueErrorOccurred){console.warn({msg:"An error has occurred getting the experiment value from criterion override. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:n,options:r,error:t});tr.hasGetExperimentValueErrorOccurred=!0}return n}}return tr.client.getExperimentValue(e,t,n,r)}));Ue(or,"initializeCalled",tr.client.initializeCalled.bind(tr.client));Ue(or,"initializeCompleted",tr.client.initializeCompleted.bind(tr.client));Ue(or,"initialize",tr.client.initialize.bind(tr.client));Ue(or,"initializeWithProvider",tr.client.initializeWithProvider.bind(tr.client));Ue(or,"initializeFromValues",tr.client.initializeFromValues.bind(tr.client));Ue(or,"manuallyLogGateExposure",tr.client.manuallyLogGateExposure.bind(tr.client));Ue(or,"getExperiment",tr.client.getExperiment.bind(tr.client));Ue(or,"manuallyLogExperimentExposure",tr.client.manuallyLogExperimentExposure.bind(tr.client));Ue(or,"manuallyLogLayerExposure",tr.client.manuallyLogLayerExposure.bind(tr.client));Ue(or,"shutdownStatsig",tr.client.shutdownStatsig.bind(tr.client));Ue(or,"overrideGate",tr.client.overrideGate.bind(tr.client));Ue(or,"clearGateOverride",tr.client.clearGateOverride.bind(tr.client));Ue(or,"overrideConfig",tr.client.overrideConfig.bind(tr.client));Ue(or,"clearConfigOverride",tr.client.clearConfigOverride.bind(tr.client));Ue(or,"setOverrides",tr.client.setOverrides.bind(tr.client));Ue(or,"getOverrides",tr.client.getOverrides.bind(tr.client));Ue(or,"clearAllOverrides",tr.client.clearAllOverrides.bind(tr.client));Ue(or,"isCurrentUser",tr.client.isCurrentUser.bind(tr.client));Ue(or,"onGateUpdated",tr.client.onGateUpdated.bind(tr.client));Ue(or,"onExperimentValueUpdated",tr.client.onExperimentValueUpdated.bind(tr.client));Ue(or,"onAnyUpdated",tr.client.onAnyUpdated.bind(tr.client));Ue(or,"updateUser",tr.client.updateUser.bind(tr.client));Ue(or,"updateUserWithProvider",tr.client.updateUserWithProvider.bind(tr.client));Ue(or,"updateUserWithValues",tr.client.updateUserWithValues.bind(tr.client));Ue(or,"getPackageVersion",tr.client.getPackageVersion.bind(tr.client));Ue(or,"getLayer",tr.client.getLayer.bind(tr.client));Ue(or,"getLayerValue",tr.client.getLayerValue.bind(tr.client));var ar=or;if("undefined"!=typeof window)if(void 0===window.__FEATUREGATES_JS__)window.__FEATUREGATES_JS__=or;else{var sr,ur,lr=(null===(sr=ar=window.__FEATUREGATES_JS__)||void 0===sr||null===(ur=sr.getPackageVersion)||void 0===ur?void 0:ur.call(sr))||"4.10.0 or earlier";if(lr!==Cn){var cr="Multiple versions of FeatureGateClients found on the current page.\n      The currently bound version is ".concat(lr," when module version ").concat(Cn," was loading.");console.warn(cr)}}var dr=ar;function fr(e){if(dr.initializeCompleted()){var t=dr.checkGate(e);console.debug("[ACJS] Feature flag evaluated via SPA Statsig Client",{flagName:e,value:t});return t}console.warn("[ACJS] SPA Statsig Client not initialised.",{flagName:e});return"jira"===(U.guessIsJiraFromMetaTag()?"jira":"confluence")?function(e){try{var t=window.require("jira/featureflags/feature-manager").isFeatureEnabled(e);console.debug("[ACJS] Feature flag evaluated via Jira Legacy Feature Flag Manager",{flagName:e,value:t});return t}catch(t){console.error("[ACJS] Jira Legacy Feature Flag Manager not available. Default flag to false",{flagName:e,e:t});re.trackGasV3FeatureFlagDefaultFalse(e);return!1}}(e):function(e){if(!AJS.DarkFeatures){console.error("[ACJS] Confluence Dark Features not available. Default flag to false",{flagName:e});re.trackGasV3FeatureFlagDefaultFalse(e);return!1}var t=AJS.DarkFeatures.isEnabled(e);console.debug("[ACJS] Feature flag evaluated via Confluence Dark Features",{flagName:e,value:t});return t}(e)}var pr,hr,gr=!1,vr="com.codebarrel.addons.automation";!(void 0!==(null===globalThis||void 0===globalThis||null===(pr=globalThis.process)||void 0===pr||null===(pr=pr.env)||void 0===pr?void 0:pr.JEST_WORKER_ID))&&(null===globalThis||void 0===globalThis||null===(hr=globalThis.process)||void 0===hr||null===(hr=hr.env)||void 0===hr||hr.NODE_ENV);var yr="__PLATFORM_FEATURE_FLAGS__",_r=("undefined"!=typeof process&&process.env,{earlyResolvedFlags:new Map,booleanResolver:function(e){return!1}}),mr="undefined"!=typeof window?window:globalThis;mr[yr]=mr[yr]||_r;function br(e){false;try{var t,n,r;if(void 0===(null===(t=mr[yr])||void 0===t?void 0:t.booleanResolver)||null===(null===(n=mr[yr])||void 0===n?void 0:n.booleanResolver))return dr.checkGate(e);var i=null===(r=mr[yr])||void 0===r?void 0:r.booleanResolver(e);if("boolean"!=typeof i){console.warn("".concat(e," resolved to a non-boolean value, returning false for safety"));return!1}return i}catch(e){return!1}}var wr=["platform-visual-refresh-icons"];var xr=!1;function Er(){if(!xr){xr=!0;var e={getBooleanFeatureFlag:function(e){return new Promise((function(t,n){if(function(e){return wr.includes(e)}(e))t(br(e));else{if(!function(e){return 0===e.indexOf("acjs-iframe-allowlist")}(e)){n(new Error("Only allowlisted flags can be accessed from the iframe."));return}t(fr(e))}}))}};M.returnsPromise(e.getBooleanFeatureFlag);M.defineModule("_featureFlag",e)}}function kr(e){return{addon_key:e.addon_key,key:e.key,url:e.url,options:e.options}}var Or={createSimpleXdmExtension:function(e){var t=kr(e),n=je.get();e.options=t.options=U.extend({},t.options);e.options.globalOptions=n;!function(e){e===vr&&function(){if(!gr){gr=!0;var e={getPerformanceTiming:function(e){return new Promise((function(n,r){t(e)||r(new Error("This is a restricted API"));n(JSON.parse(JSON.stringify(window.performance.timing)))}))},getPerformanceNavigationTiming:function(e){return new Promise((function(n,r){t(e)||r(new Error("This is a restricted API"));window.PerformanceNavigationTiming||n(void 0);var i=window.performance.getEntriesByType("navigation");n(JSON.parse(JSON.stringify(i)))}))}};M.returnsPromise(e.getPerformanceTiming);M.returnsPromise(e.getPerformanceNavigationTiming);M.defineModule("_performance",e)}function t(e){return e._context.extension.addon_key===vr}}();Er()}(e.addon_key);var r=M.create(t,(function(){e.options.noDOM||(e.$el=m(document.getElementById(e.id)));oe.notifyBridgeEstablished(e.$el,e)}),(function(){oe.notifyUnloaded(e.$el,e)}));t.id=r.id;e.id=r.id;U.extend(r,Me(e.options));return{iframeAttributes:r,extension:e}},extensionConfigSanitizer:kr},Sr=new(function(){function e(){this._contentResolver=!1}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.resize=function(e,t,n){e=U.stringToDimension(e);t=U.stringToDimension(t);n.css({width:e,height:t});n.trigger("resized",{width:e,height:t})};t.simpleXdmExtension=function(e,t){!e.url||Le.hasJwt(e.url)&&Le.isJwtExpired(e.url)?this._contentResolver?Pe({extension:e,resolver:this._contentResolver,$container:t}):console.error("JWT is expired and no content resolver was specified"):this._appendExtension(t,this._simpleXdmCreate(e))};t._simpleXdmCreate=function(e){var t=Or.createSimpleXdmExtension(e);e.id=t.iframeAttributes.id;e.$el=this.render(t.iframeAttributes);return e};t._appendExtension=function(e,t){var n=e.find("iframe");n.length>0&&n.destroy();t.options.hideIframeUntilLoad&&t.$el.css({visibility:"hidden"}).load((function(){t.$el.css({visibility:""})}));e.prepend(t.$el);oe.notifyIframeCreated(t.$el,t)};t._appendExtensionError=function(e,t,n){var r=m('<div class="connect-resolve-error"></div>'),i=m("<p />").text(t);r.append('<p class="error">Error: The content resolver threw the following error:</p>');r.append(i);n&&r.append('<br><p class="error-trace-id">If this keeps happening, pass this information to your admin, who should contact support. Trace: '+n+".</p>");e.prepend(r)};t.resolverResponse=function(e){var t=this._simpleXdmCreate(e.extension);this._appendExtension(e.$container,t)};t.resolverFailResponse=function(e){this._appendExtensionError(e.$container,e.errorText,e.errorTraceId)};t.render=function(e){(e=e||{}).referrerpolicy="no-referrer";return m("<iframe />").attr(e).addClass("ap-iframe")};return e}());v.register("iframe-resize",(function(e){Sr.resize(e.width,e.height,e.$el)}));v.register("content-resolver-register-by-extension",(function(e){Sr.setContentResolver(e.callback)}));v.register("jwt-url-refreshed",(function(e){Sr.resolverResponse(e)}));v.register("jwt-url-refreshed-failed",(function(e){Sr.resolverFailResponse(e)}));v.register("after:iframe-bridge-established",(function(e){e.extension.options.noDom?e.extension.options.bridgeEstablished=!0:e.$el[0].bridgeEstablished=!0}));var Ar=function(e){v.dispatch("button-clicked",{$el:e})},Cr=function(e,t){v.dispatch("button-toggle",{$el:e,disabled:t})},Ir=function(e,t){v.dispatch("button-toggle-visibility",{$el:e,hidden:t})},Lr=["primary","link","secondary"],Tr=0,Pr=function(){function e(){this.AP_BUTTON_CLASS="ap-aui-button"}var t=e.prototype;t.setType=function(e,t){t&&Lr.indexOf(t)>=0&&e.addClass("aui-button-"+t);return e};t.setDisabled=function(e,t){void 0===t||e.data("immutable")||e.attr("aria-disabled",t);return e};t.setHidden=function(e,t){void 0===t||e.data("immutable")||e.toggle(!t);return e};t._setId=function(e,t){if(!t){t="ap-button-"+Tr;Tr++}e.attr("id",t);return e};t._additionalClasses=function(e,t){if(t){"string"!=typeof t&&(t=t.join(" "));e.addClass(t)}return e};t.getName=function(e){return m(e).data("name")};t.getText=function(e){return m(e).text()};t.getIdentifier=function(e){return m(e).data("identifier")};t.isVisible=function(e){return m(e).is(":visible")};t.isEnabled=function(e){return!("true"===m(e).attr("aria-disabled"))};t.render=function(e){var t=m("<button />");e=e||{};t.addClass("aui-button "+this.AP_BUTTON_CLASS);t.text(e.text);t.data(e.data);t.data({name:e.name||e.identifier,identifier:e.identifier||Q.randomIdentifier(),immutable:e.immutable||!1});this._additionalClasses(t,e.additionalClasses);this.setType(t,e.type);this.setDisabled(t,e.disabled||!1);this._setId(t,e.id);return t};return e}(),Dr=new Pr;m((function(){m("body").on("click","."+Dr.AP_BUTTON_CLASS,(function(e){var t=m(e.target).closest("."+Dr.AP_BUTTON_CLASS);"true"!==t.attr("aria-disabled")&&Ar(t)}))}));v.register("button-toggle",(function(e){Dr.setDisabled(e.$el,e.disabled)}));v.register("button-toggle-visibility",(function(e){Dr.setHidden(e.$el,e.hidden)}));var Mr=["ap-iframe-container"],jr=new(function(){function e(){}var t=e.prototype;t.createExtension=function(e,t){var n=this._renderContainer();t&&!1===t.loadingIndicator||n.append(this._renderLoadingIndicator());Sr.simpleXdmExtension(e,n);return n};t._renderContainer=function(e){var t=m("<div />").attr(e||{});t.addClass(Mr.join(" "));return t};t._renderLoadingIndicator=function(){return k.render()};return e}());v.register("iframe-create",(function(e){var t="embedded-"+e.extension.id;e.extension.$el.parents(".ap-iframe-container").attr("id",t)}));function Fr(e){return jr.createExtension(e)}var Vr=function(e,t){var n={};if(t){n.methods=t;n.name=e}else n.methods=e;v.dispatch("module-define-custom",n)},Nr=function(e,t){v.dispatch("analytics-deprecated-method-used",{methodUsed:e,extension:t})},Rr=function(e){v.dispatch("iframe-bridge-start",{extension:e})},Gr=function(e,t){v.dispatch("analytics-external-event-track",{eventName:e,values:t})},Ur=function(e,t){v.dispatch("analytics-content-resolver-track",{success:e,extra:t})},Br=function(e,t){e&&Object.getOwnPropertyNames(e).length>0&&v.dispatch("analytics-iframe-performance",{metrics:e,extension:t})},zr=function(e,t){e&&Object.keys(e).length>0&&v.dispatch("analytics-web-vitals",{metrics:e,extension:t})},Kr=function(e){v.dispatch("analytics-track-iframe-clicked",e)};function Jr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $r(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function $r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wr(e){var t=e?e.match(/ap-plugin-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}function qr(e){var t=e?e.match(/ap-module-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}function Hr(e){return Wr(e)+"__"+qr(e)}function Xr(e,t,n){var r=e+"Modules";if(window._AP&&window._AP[r]&&window._AP[r][t]&&window._AP[r][t][n])return U.extend({},window._AP[r][t][n].options)}function Yr(e,t){var n=Wr(t),r=function(e){var t=e?e.match(/ap-target-key-([^\s]*)/):null;return!!Array.isArray(t)&&t[1]}(t);return Xr(e,n,r)}function Qr(e,t,n){var r,i=n||e.attr("href"),o={};i||(i=e.find("a").attr("href"));if(i){var a=i.indexOf("#");if(a>=0){var s=i.substring(a+1);try{r=JSON.parse(decodeURI(s))}catch(e){console.error("ACJS: cannot decode webitem anchor")}r&&window._AP&&window._AP._convertConnectOptions?o=window._AP._convertConnectOptions(r):console.error("ACJS: cannot convert webitem url to connect iframe options")}else{var u=Hr(t),l=Zr(t)?"inlineDialog":"dialog",c=Yr(l,t);!c&&window._AP&&window._AP[l+"Options"]&&(c=U.extend({},window._AP[l+"Options"][u])||{});if(!c){c={};console.warn("no webitem "+l+"Options for "+u)}c.productContext=c.productContext||{};var d=ue.parse(ue.extract(i));U.extend(c.productContext,d);o={addon_key:Wr(t),key:qr(t),options:c}}}return o}function Zr(e){return!!e&&e.includes("ap-inline-dialog")}function ei(e,t){for(var n=[],r=e,i=0;r&&r!==document.body&&i++<1e3;){for(var o,a=Jr(t);!(o=a()).done;){var s=o.value,u=r.getAttribute(s);u&&n.push(u)}r=r.parentElement}return n}var ti={sanitizeTriggers:function(e){var t;Array.isArray(e)?t=e.join(" "):"string"==typeof e&&(t=e.trim());return t},uniqueId:function(){return"webitem-"+Math.floor(1e9*Math.random()).toString(16)},getExtensionKey:Wr,getKey:qr,getOptionsForWebItem:function(e,t,n){var r=Hr(t),i=Zr(t)?"inlineDialog":"dialog",o=Yr(i,t);!o&&window._AP&&window._AP[i+"Options"]&&(o=U.extend({},window._AP[i+"Options"][r])||{});if(!o){o={};console.warn("no webitem "+i+"Options for "+r)}o.productContext=o.productContext||{};o.structuredContext=o.structuredContext||{};var a=Qr(e,t,n);if(a&&a.options){U.extend(o.productContext,a.options.productContext);U.extend(o.structuredContext,a.options.structuredContext);o.contextJwt=a.options.contextJwt}return o},getModuleOptionsByAddonAndModuleKey:Xr,getConfigFromTarget:Qr},ni=new function(){var e=this;this._providers={};this.registerProvider=function(t,n){e._providers[t]=n};this.getProvider=function(t){return e._providers[t]}},ri=new(function(){function e(){this.moduleNamesToModules=new Map}e.prototype.registerModule=function(e,t){var n=e.getModuleRegistrationName();this.moduleNamesToModules.set(n,e)};e.prototype.getModuleByName=function(e){return this.moduleNamesToModules.get(e)};e.prototype.getProviderByModuleName=function(e){var t=this.moduleNamesToModules.get(e);return t&&t.isEnabled()?t.getProvider():void 0};return e}()),ii=function(e){var t;if(di.getWebItemsBySelector(e.selector))return!1;t=di.setWebItem(e);v.dispatch("webitem-added",{webitem:t})},oi=function(e,t){var n=e?"inline-dialog":"dialog";v.dispatch("webitem-invoked:"+n,t)},ai=new WeakSet,si=function(){function e(){this._webitems={};this._contentResolver=function(){}}var t=e.prototype;t.setContentResolver=function(e){this._contentResolver=e};t.requestContent=function(e){if(e.addon_key&&e.key)return this._contentResolver.call(null,U.extend({classifier:"json"},e))};t.getWebItemsBySelector=function(e){var t,n=this;Object.getOwnPropertyNames(this._webitems).some((function(r){var i=n._webitems[r];if(i.selector&&i.selector.trim()===e.trim()){t=i;return!0}return!1}));return t};t.setWebItem=function(e){return this._webitems[e.name]={name:e.name,selector:e.selector,triggers:e.triggers}};t._removeTriggers=function(e){var t=this,n=ti.sanitizeTriggers(e.triggers);m((function(){m("body").off(n,e.selector,t._webitems[e.name]._on)}));delete this._webitems[e.name]._on};t._addTriggers=function(e){var t=ti.sanitizeTriggers(e.triggers);e._on=function(t){if(!t.defaultPrevented){var n=m(t.target).closest(e.selector);if(!n.hasClass("ap-dialog-ignore")){t.preventDefault();ci(n,t.type)}}};m((function(){var n=function(n){if(!ai.has(n)){ai.add(n);m(n).on(t,e._on)}};document.querySelectorAll(e.selector).forEach((function(e){n(e)}));new MutationObserver((function(t,r){t.forEach((function(t){"childList"===t.type&&t.addedNodes.forEach((function(t){t.nodeType===Node.ELEMENT_NODE&&(t.matches(e.selector)?n(t):t.querySelectorAll(e.selector).forEach((function(e){n(e)})))}))}))})).observe(document.body,{childList:!0,subtree:!0});m("head").append('<style type="text/css">'+e.selector+".ap-link-webitem {pointer-events: auto;cursor: pointer;}</style>")}))};return e}();function ui(e,t,n,r){r=r||"click";var i=m(e);li(t=t||i.attr("class"))&&("mouseenter"!==r||Zr(t))&&ci(i,r,t,n,!0)}function li(e){return function(e){return!!e&&e.includes("ap-dialog")}(e)||Zr(e)}function ci(e,t,n,r,i){n=n||e.attr("class");i=i||!1;var o=ti.getConfigFromTarget(e,n,r),a=o&&o.url?o.url:void 0,s={addon_key:ti.getExtensionKey(n),key:ti.getKey(n),options:ti.getOptionsForWebItem(e,n,r),url:a};if("com.addonengine.analytics"!==s.addon_key||pi.isModuleDefined("analytics")){var u=Zr(n);i||v.dispatch("analytics-legacy-dialog-opened",{extension:s,eventType:t,parentIds:ei(e.get(0),["data-testid","data-component-selector","data-fullscreen-id"])});oi(u,{$target:e,eventType:t,extension:s})}else console.log("ACJS-1164 Dropping event "+t+" for plugin "+s.addon_key+" until AP.analytics loads...")}var di=new si;v.register("webitem-added",(function(e){di._addTriggers(e.webitem)}));v.register("content-resolver-register-by-extension",(function(e){di.setContentResolver(e.callback)}));document.addEventListener("aui-responsive-menu-item-created",(function(e){var t=e.detail.originalItem.querySelector('a[class*="ap-"]');if(t){var n=e.detail.newItem.querySelector("a");[].slice.call(t.classList).forEach((function(e){/^ap-/.test(e)&&n.classList.add(e)}))}}));var fi=function(){function e(){var e=this;this.targetSpecNoDialogs=F;this.triggerWebItem=ui;this.isDialogWebItem=li;this.create=function(e){return Fr(Or.extensionConfigSanitizer(e))};this.dialog={create:function(e,t){var n=ti.getModuleOptionsByAddonAndModuleKey("dialog",e.addon_key,e.key),r=U.extend({},n||{},t);z(e,r)},close:function(t,n){var r=e.getFrameworkAdaptor().getProviderByModuleName("dialog");if(r){ie.assertActiveDialogOrThrow(r,t);V("dialog.close",{addon_key:t},n);r.close()}else K()}};this.registerContentResolver={resolveByExtension:function(t){e._contentResolver=t;Te({callback:t})}};this.getContentResolver=function(){return e._contentResolver};this.registerProvider=function(e,t){ni.registerProvider(e,t)};this.getProvider=function(e){return ni.getProvider(e)};this.frameworkAdaptor=ri}var t=e.prototype;t.createExtension=function(e){e.options=e.options||{};e.options.noDom=!0;var t=Or.createSimpleXdmExtension(e);Rr(t.extension);return t};t.registerExistingExtension=function(e,t){return M.registerExistingExtension(e,t)};t.setFrameworkAdaptor=function(e){this.frameworkAdaptor=e};t.getFrameworkAdaptor=function(){return this.frameworkAdaptor};t._cleanExtension=function(e){return U.pick(e,["id","addon_key","key","options","url"])};t.onIframeEstablished=function(e){e._wrapper=function(t){e.call({},{$el:t.$el,extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:iframe-bridge-established",e._wrapper)};t.offIframeEstablished=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-bridge-established",e._wrapper)};t.onIframeUnload=function(e){var t=this;v.register("after:iframe-unload",(function(n){e.call({},{$el:n.$el,extension:t._cleanExtension(n.extension)})}))};t.onPublicEventDispatched=function(e){e._wrapper=function(t){e.call({},{type:t.type,event:t.event,extension:this._cleanExtension(t.sender)})}.bind(this);v.register("after:event-public-dispatch",e._wrapper)};t.offPublicEventDispatched=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:event-public-dispatch",e._wrapper)};t.onKeyEvent=function(e,t,n,r){W({extension_id:e,key:t,modifiers:n,callback:r})};t.offKeyEvent=function(e,t,n,r){q({extension_id:e,key:t,modifiers:n,callback:r})};t.onFrameClick=function(e){if("function"!=typeof e)throw new Error("handleIframeClick must be a function");X(e)};t.offFrameClick=function(){Y()};t.destroy=function(e){oe.notifyIframeDestroyed({id:e})};t.defineModule=function(e,t){Vr(e,t)};t.isModuleDefined=function(e){return M.isModuleDefined(e)};t.broadcastEvent=function(e,t,n){V(e,t,n)};t.getExtensions=function(e){return M.getExtensions(e)};t.trackDeprecatedMethodUsed=function(e,t){Nr(e,t)};t.trackAnalyticsEvent=function(e,t){Gr(e,t)};t.trackContentResolverEvent=function(e,t){Ur(e,t)};t.notifyContentResolverFailed=function(e){v.dispatch("notify-content-resolver-failed",e)};t.setJwtClockSkew=function(e){De(e)};t.isJwtExpired=function(e,t){return t?Ce.isJwtExpired(e):Le.isJwtExpired(e)};t.hasJwt=function(e){return Le.hasJwt(e)};t.getBooleanFeatureFlag=function(e){return fr(e)};t.setExtensionConfigurationOptions=function(e,t){je.set(e,t)};t.getExtensionConfigurationOption=function(e){return je.get(e)};t.onIframeTimeout=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:iframe-bridge-timeout",e._wrapper)};t.offIframeTimeout=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-bridge-timeout",e._wrapper)};t.onIframePerformanceTelemetry=function(e){e._wrapper=function(t){e.call({},{metrics:t.metrics,extension:this._cleanExtension(t.extension)})}.bind(this);v.register("after:analytics-iframe-performance",e._wrapper)};t.offIframePerformanceTelemetry=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:analytics-iframe-performance",e._wrapper)};t.onIframeVisible=function(e){e._wrapper=function(t){e.call({},{extension:this._cleanExtension(t)})}.bind(this);v.register("after:iframe-visible",e._wrapper)};t.offIframeVisible=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:iframe-visible",e._wrapper)};t.onContentResolverEvent=function(e){e._wrapper=function(t){e.call({},t)}.bind(this);v.register("after:analytics-content-resolver-track",e._wrapper)};t.offContentResolverEvent=function(e){if(!e._wrapper)throw new Error("cannot unregister event dispatch listener without _wrapper reference");v.unregister("after:analytics-content-resolver-track",e._wrapper)};t.onForwardAnalyticsEvent=function(e){e._wrapper=function(t,n){e.call({},t,n)}.bind(this);v.register("after:analytics-forward-event",e._wrapper)};return e}(),pi=new fi,hi="ap-dialog-",gi="ap-aui-dialog2",vi=new RegExp("^ap-dialog-[0-9A-Za-z]+$"),yi=["small","medium","large","xlarge","fullscreen","maximum"],_i="ap-aui-dialog-button",mi="aui-dialog2-footer-actions";function bi(){var e=AJS.LayerManager.global.getTopLayer();if(e&&vi.test(e.attr("id"))){var t=AJS.dialog2(e);t._id=t.$el.attr("id").replace(hi,"");return t}}function wi(e){var t=e.find(".header-control-panel");t.length||(t=e.find(".aui-dialog2-footer-actions"));return t}function xi(e,t){return wi(t).find(".aui-button").filter((function(){return Dr.getIdentifier(this)===e}))}var Ei=function(){function e(){}var t=e.prototype;t._renderHeaderCloseBtn=function(){var e=m("<a />").addClass("aui-dialog2-header-close"),t=m("<span />").addClass("aui-icon aui-icon-small aui-iconfont-close-dialog").text("Close");e.append(t);return e};t._renderFullScreenHeader=function(e,t){var n=m("<div />").addClass("header-title-container aui-item expanded"),r=m("<div />").append(m("<span />").addClass("header-title").text(t.header||""));n.append(r);e.append(n).append(this._renderHeaderActions(t.actions,t.extension));return e};t._renderHeader=function(e){var t=m("<header />").addClass("aui-dialog2-header");if("fullscreen"===e.size)return this._renderFullScreenHeader(t,e);if(e.header){var n=m("<h2 />").addClass("aui-dialog2-header-main").text(e.header);t.append(n)}t.append(this._renderHeaderCloseBtn());return t};t._renderHeaderActions=function(e,t){var n=m("<div />").addClass("aui-item header-control-panel");e[0].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-success"];e[1].additionalClasses=["aui-icon","aui-icon-small","aui-iconfont-close-dialog"];this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderContent=function(e){var t=m("<div />").addClass("aui-dialog2-content");e&&t.append(e);return t};t._renderFooter=function(e){var t=m("<footer />").addClass("aui-dialog2-footer");if("fullscreen"!==e.size){var n=this._renderFooterActions(e.actions,e.extension);t.append(n)}if(e.hint){var r=m("<div />").addClass("aui-dialog2-footer-hint").text(e.hint);t.append(r)}return t};t._renderActionButtons=function(e,t){var n=this,r=[];[].concat(e).forEach((function(e){r.push(n._renderDialogButton({text:e.text,name:e.name,type:e.type,additionalClasses:e.additionalClasses,custom:e.custom||!1,identifier:e.identifier,immutable:e.immutable,disabled:e.disabled||!1},t))}));return r};t._renderFooterActions=function(e,t){var n=m("<div />").addClass(mi);this._renderActionButtons(e,t).forEach((function(e){n.append(e)}));return n};t._renderDialogButton=function(e,t){e.additionalClasses=e.additionalClasses||[];e.additionalClasses.push(_i);e.custom&&e.additionalClasses.push("ap-dialog-custom-button");var n=Dr.render(e);n.extension=t;return n};t.render=function(e){var t=U.extend({},e),n=ie.sanitizeOptions(e),r=m("<section />").attr({role:"dialog",id:hi+n.id});r.attr("data-aui-modal","true");r.data({"aui-remove-on-hide":!0,extension:n.extension});r.addClass("aui-layer aui-dialog2 "+gi);yi.indexOf(n.size)>=0&&r.addClass("aui-dialog2-"+n.size);if("fullscreen"===n.size||"maximum"===n.size){n.chrome&&r.addClass("ap-header-controls");r.addClass("aui-dialog2-maximum")}r.append(this._renderContent(n.$content));if(n.chrome){r.prepend(this._renderHeader({header:n.header,actions:n.actions,size:n.size}));r.append(this._renderFooter({extension:n.extension,actions:n.actions,hint:n.hint,size:n.size}))}else r.addClass("aui-dialog2-chromeless");var i=AJS.dialog2(r);i._id=n.id;"fullscreen"===n.size&&(n.height=n.width="100%");n.size&&"fullscreen"!==n.size||AJS.layer(r).changeSize(n.width,n.height);n.onHide&&i.on("hide",n.onHide);i.show();i.$el.data("extension",n.extension);i.$el.data("originalOptions",t);return r};t.setIframeDimensions=function(e){Sr.resize("100%","100%",e)};t.getActive=function(){return bi()};t.buttonIsEnabled=function(e){var t=bi();if(t){var n=xi(e,t.$el);return Dr.isEnabled(n)}};t.buttonIsVisible=function(e){var t=bi();if(t){var n=xi(e,t.$el);return Dr.isVisible(n)}};t.getByExtension=function(e){var t;if("function"==typeof e)t=e;else{var n=Object.getOwnPropertyNames(e);t=function(t){var r=m(t).data("extension");return n.every((function(t){return r[t]===e[t]}))}}return m("."+gi).toArray().filter(t).map((function(e){return AJS.dialog2(e)}))};t.addButton=function(e,t){t.custom=!0;var n=this._renderDialogButton(t,e),r=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;wi(r).append(n);return r};t.renderErrorState=function(e){var t;if(pi.getBooleanFeatureFlag("acjs-iframe-allowlist-dialog-flexibility")){var n=this.getByExtension({addon_key:e.addon_key,key:e.key});if(0===n.length){var r=m("."+gi).toArray();if(0===r.length)return;t=AJS.dialog2(r[0]).$el}else t=n[0].$el;if(!t)return}else t=this.getByExtension({addon_key:e.addon_key,key:e.key})[0].$el;if(!t.hasClass("aui-dialog2-fullscreen")){if(t.hasClass("aui-dialog2-maximum")){t.removeClass("aui-dialog2-maximum");t.addClass("aui-dialog2-xlarge")}t.removeClass("aui-dialog2-chromeless");var i=t.find(".aui-dialog2-footer-actions");if(!(t.find("#dialog-error-close-btn").length>0)){var o={name:"close",id:"dialog-error-close-btn",text:"Close",type:"primary",disabled:!1};if(i.length){var a=this._renderDialogButton(o,e);i.append(a)}else t.append(this._renderFooter({extension:e,actions:[o]}))}}};return e}(),ki=new Ei;v.register("iframe-bridge-established",(function(e){if(e.extension.options.isDialog){var t,n=pi.getFrameworkAdaptor().getProviderByModuleName("dialog");if(n){t=n.close;n.setButtonDisabled("submit",!1)}else{$.toggleButton({identifier:"submit",enabled:!0});t=function(){$.close({dialog:bi(),extension:e.extension})}}if(!e.extension.options.preventDialogCloseOnEscape){W({extension_id:e.extension.id,key:27,callback:t});v.registerOnce("dialog-close",(function(t){q({extension_id:e.extension.id,key:27})}))}}}));v.register("dialog-close-active",(function(e){var t=bi();t&&$.close({customData:e.customData,dialog:t,extension:e.extension})}));v.register("dialog-close",(function(e){e.dialog&&e.dialog.hide()}));v.register("dialog-button-toggle",(function(e){var t=bi();if(t){var n=xi(e.identifier,t.$el);Cr(n,!e.enabled)}}));v.register("dialog-button-toggle-visibility",(function(e){var t=bi();if(t){var n=xi(e.identifier,t.$el);Ir(n,e.hidden)}}));v.register("button-clicked",(function(e){var t=e.$el;if(t.hasClass(_i)){var n=t.parents("."+gi),r=n.find("iframe");r.length&&r[0].bridgeEstablished?$.clickButton(Dr.getIdentifier(t),t,n.data("extension")):$.close({dialog:bi(),extension:t.extension})}}));if(m.fn){v.register("iframe-create",(function(e){e.extension.options&&e.extension.options.isDialog&&ki.setIframeDimensions(e.extension.$el)}));v.register("dialog-button-add",(function(e){ki.addButton(e.extension,e.button)}));v.register("host-window-resize",U.debounce((function(){m("."+gi).each((function(e,t){var n=m(t),r=ie.sanitizeOptions(n.data("originalOptions"));t.style.width=r.width;t.style.height=r.height}))}),100))}H({keyCode:27,callback:function(){$.closeActive({customData:{},extension:null})}});function Oi(t){var n;if(null!=t&&t.options&&null!=(n=AJS)&&null!=(n=n.Meta)&&n.get){var r=e({},t.options.productContext||{});AJS.Meta.get("space-key")&&(r["an.spaceKey"]=AJS.Meta.get("space-key"));return e({},t,{options:e({},t.options,{productContext:r})})}return t}var Si=new(function(){function e(){}var t=e.prototype;t.render=function(e,t){e.options=e.options||{};t=t||{};e.options.isDialog=!0;e.options.dialogId=t.id;e.options.callbackExtensionId=e.callback_extension_id;e.options.preventDialogCloseOnEscape=!1===t.closeOnEscape;e.options.hostFrameOffset=t.hostFrameOffset;e.options.hideIframeUntilLoad=!0;var n=jr.createExtension(e);return ki.render({extension:e,$content:n,chrome:t.chrome,width:t.width,height:t.height,size:t.size,header:t.header,hint:t.hint,submitText:t.submitText,cancelText:t.cancelText,buttons:t.buttons,onHide:t.onHide})};t.renderErrorState=function(e){ki.renderErrorState(e)};t.getActiveDialog=function(){return ki.getActive()};t.buttonIsEnabled=function(e){return ki.buttonIsEnabled(e)};t.buttonIsVisible=function(e){return ki.buttonIsVisible(e)};t.getByExtension=function(e){"string"==typeof e&&(e={id:e});return ki.getByExtension(e)};return e}());v.register("dialog-extension-open",(function(e){var t=Oi(e.extension),n=ie.sanitizeOptions(e.options),r=pi.getFrameworkAdaptor().getProviderByModuleName("dialog");if(r){var i=function(e){var n=t.key,r=t.addon_key,i={button:{identifier:e.identifier,name:e.identifier,text:e.text}};["submit","cancel"].indexOf(e.identifier)>=0&&V("dialog."+e.identifier,{addon_key:r,key:n},i);V("dialog.button.click",{addon_key:r,key:n},i)};t.options.preventDialogCloseOnEscape=!1===n.closeOnEscape;n.actions.map((function(e){return e.onClick=i.bind(null,e)}));r.create(n,t)}else Si.render(t,e.options)}));v.register("notify-content-resolver-failed",(function(e){Si.renderErrorState(e)}));var Ai={};v.register("dialog-close",(function(e){if(e.dialog&&e.extension){var t={addon_key:e.extension.addon_key,id:e.extension.options.callbackExtensionId};V("dialog.close",t,e.customData)}}));v.register("dialog-button-click",(function(e){var t={button:{name:Dr.getName(e.$el),identifier:Dr.getIdentifier(e.$el),text:Dr.getText(e.$el)}},n={addon_key:e.extension.addon_key,key:e.extension.key};n.id=e.extension.id;e.$el.hasClass("ap-dialog-custom-button")||V("dialog."+t.button.name,n,t);V("dialog.button.click",n,t)}));var Ci=function(){function e(e,t){t=U.last(arguments);var n=pi.getFrameworkAdaptor(),r=n.getProviderByModuleName("dialog");if(r){ie.assertActiveDialogOrThrow(r,t._context.extension.addon_key);this.name=e;this.identifier=e}else{if(!Si.getActiveDialog())throw new Error("Failed to find an active dialog.");this.name=e;this.identifier=e;this.enabled=Si.buttonIsEnabled(e);this.hidden=!Si.buttonIsVisible(e)}}var t=e.prototype;t.enable=function(){this.setState({enabled:!0})};t.disable=function(){this.setState({enabled:!1})};t.isEnabled=function(e){e=U.last(arguments);var t=pi.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?!n.isButtonDisabled(this.identifier):this.enabled)};t.toggle=function(){var e=pi.getFrameworkAdaptor().getProviderByModuleName("dialog");e?e.toggleButton(this.identifier):this.setState({enabled:!this.enabled})};t.setState=function(e){var t=pi.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonDisabled(this.identifier,!e.enabled);else{this.enabled=e.enabled;$.toggleButton({identifier:this.identifier,enabled:this.enabled})}};t.trigger=function(e){e=U.last(arguments);this.enabled&&$.dialogMessage({name:this.name,extension:e._context.extension})};t.isHidden=function(e){e=U.last(arguments);var t=pi.getFrameworkAdaptor(),n=t.getProviderByModuleName("dialog");e(n?n.isButtonHidden(this.identifier):this.hidden)};t.hide=function(){this.setHidden(!0)};t.show=function(){this.setHidden(!1)};t.setHidden=function(e){var t=pi.getFrameworkAdaptor().getProviderByModuleName("dialog");if(t)t.setButtonHidden(this.identifier,e);else{this.hidden=e;$.toggleButtonVisibility({identifier:this.identifier,hidden:this.hidden})}};return e}();function Ii(e){return Ai[e.extension.options.dialogId]}var Li={create:{constructor:function(e,t){var n=(t=U.last(arguments))._id,r=t._context.extension,i={addon_key:r.addon_key,key:e.key,options:U.pick(r.options,["customData","productContext"]),callback_extension_id:r.id};i.options.customData=e.customData;var o=ie.moduleOptionsFromGlobal(i.addon_key,i.key);"number"==typeof(o||{}).hostFrameOffset&&(i.options.hostFrameOffset=o.hostFrameOffset);(e=U.extend({},o||{},e)).id=n;ie.trackMultipleDialogOpening(i,e);z(i,e);this.customData=e.customData;Ai[n]=this}},close:function(e,t){t=U.last(arguments);var n=pi.getFrameworkAdaptor(),r=n.getProviderByModuleName("dialog");if(r){ie.assertActiveDialogOrThrow(r,t._context.extension.addon_key);V("dialog.close",{addon_key:t._context.extension.addon_key},e);r.close()}else{var i;i=t._context.extension.options.isDialog?Si.getByExtension(t._context.extension.id)[0]:Si.getActiveDialog();$.close({customData:e,dialog:i,extension:t._context.extension})}},getCustomData:function(e){var t=Ii((e=U.last(arguments))._context);e(t?t.customData:void 0)},getButton:{constructor:Ci,enable:Ci.prototype.enable,disable:Ci.prototype.disable,toggle:Ci.prototype.toggle,isEnabled:Ci.prototype.isEnabled,trigger:Ci.prototype.trigger,hide:Ci.prototype.hide,show:Ci.prototype.show,isHidden:Ci.prototype.isHidden},createButton:{constructor:function(e,t){t=U.last(arguments);var n=pi.getFrameworkAdaptor(),r=n.getProviderByModuleName("dialog");if(r){ie.assertActiveDialogOrThrow(r,t._context.extension.addon_key);r.createButton({identifier:e.identifier,text:e.text,hidden:!1,disabled:e.disabled||!1,onClick:function(){V("dialog.button.click",{addon_key:t._context.extension.addon_key,key:t._context.extension.key},{button:{identifier:e.identifier,text:e.text}})}})}else J({identifier:e.identifier,text:e.text},t._context.extension)}}};v.register("iframe-resize",(function(e){Sr.resize(e.width,e.height,e.$el)}));v.register("iframe-size-to-parent",(function(e){var t,n=U.getIframeByExtensionId(e.extensionId);t=m(window).height()-n.offset().top-1+"px";n.get(0).name.length>0&&"jiraProjectPages"===JSON.parse(n.get(0).name).options.moduleType&&(t="100%");v.dispatch("iframe-resize",{width:"100%",height:t,$el:n})}));v.register("hide-footer",(function(e){e&&m("#footer").css({display:"none"})}));window.addEventListener("resize",(function(e){v.dispatch("host-window-resize",e)}),!0);var Ti=function(e,t,n){var r;r=n.extension_id?U.getIframeByExtensionId(n.extension_id):n;v.dispatch("iframe-resize",{width:e,height:t,$el:r,extension:n.extension})},Pi=function(e,t){v.dispatch("iframe-size-to-parent",{hideFooter:t,extensionId:e})},Di=function(e){v.dispatch("hide-footer",e)},Mi=U.debounce,ji={},Fi=[],Vi={},Ni={getLocation:function(e){e=U.last(arguments);var t=ni.getProvider("get-location");e("function"==typeof t?t():window.location.href)},resize:function(e,t,n){n=U.last(arguments);var r=ni.getProvider("addon");if(r)r.resize(e,t,n._context);else{var i=n._context.extension.id,o=n._context.extension.options;if(-1!==Fi.indexOf(i)||o&&o.isDialog)return!1;ji[i]||(ji[i]=Mi((function(e,t,n){Ti(e,t,n._context)}),50));ji[i](e,t,n)}return!0},sizeToParent:Mi((function(e,t){t=U.last(arguments);var n=ni.getProvider("addon");if(n)n.sizeToParent(e,t._context);else if(t._context.extension.options.isFullPage){U.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page");U.getIframeByExtensionId(t._context.extension_id).addClass("sized-to-parent");Pi(t._context.extension_id,e);Vi[t._context.extension_id]={hideFooter:e}}else U.getIframeByExtensionId(t._context.extension_id).addClass("full-size-general-page-fail")})),hideFooter:function(e){e&&Di(e)}},Ri=function(e){delete ji[e];delete Vi[e];-1!==Fi.indexOf(e)&&Fi.splice(Fi.indexOf(e),1)};v.register("host-window-resize",(function(e){Object.getOwnPropertyNames(Vi).forEach((function(e){Pi(e,Vi[e].hideFooter)}))}));v.register("after:iframe-unload",(function(e){Ri(e.extension.id)}));v.register("after:iframe-destroyed",(function(e){Ri(e.extension.extension.id)}));v.register("before:iframe-size-to-parent",(function(e){-1===Fi.indexOf(e.extensionId)&&Fi.push(e.extensionId)}));var Gi=function(e){v.dispatch("inline-dialog-refresh",{$el:e})},Ui=function(){v.dispatch("inline-dialog-close",{})},Bi=function(e){v.dispatch("inline-dialog-opened",{$el:e.$el,trigger:e.trigger,extension:e.extension})},zi={hide:function(e){e=U.last(arguments);var t=pi.getFrameworkAdaptor(),n=t.getProviderByModuleName("inlineDialog");n?n.hide(e._context):Ui()}},Ki="ac-message-container",Ji=["generic","error","warning","success","info","hint"],$i="ap-message-",Wi=new RegExp("^ap-message-[0-9A-fa-f]+$"),qi={};function Hi(e){return Wi.test(e)}var Xi=!1;function Yi(e,t,n,r){if(!Xi){m(document).on("aui-message-close",(function(e,t){var n=t.attr("id").replace($i,"");if(qi[n]){m.isFunction(qi[n].onCloseTrigger)&&qi[n].onCloseTrigger();qi[n]._destroy()}}));Xi=!0}var i=function(){var e=m("#"+Ki);e.length<1&&(e=m('<div id="'+Ki+'" />').appendTo("body"));return e}();r=function(e){var t={};"object"==typeof e&&["closeable","fadeout","delay","duration","id"].forEach((function(n){n in e&&(t[n]=e[n])}));return t}(r);m.extend(r,{title:t,body:AJS.escapeHtml(n)});if(Ji.indexOf(e)<0)throw"Invalid message type. Must be: "+Ji.join(", ");if(Hi(r.id)){AJS.messages[e](i,r);i.css("margin-left","-"+i.innerWidth()/2+"px")}}function Qi(e,t,n,r,i){var o="AP.messages."+e;console.warn("DEPRECATED API - AP.messages."+e+" has been deprecated since ACJS 5.0 and will be removed in a future release. Use AP.flag.create instead.");Nr(o,i._context.extension);var a=pi.getFrameworkAdaptor().getProviderByModuleName("messages");if(a){var s=e,u=a[s];u||(a[s]=a.generic);u(t,n,r)}else Yi(e,t,n,r)}function Zi(e){return{constructor:function(t,n,r,i){var o=(i=U.last(arguments))._id;"string"!=typeof t&&(t="");"string"!=typeof n&&(n="");"object"!=typeof r&&(r={});r.id=$i+o;Qi(e,t,n,r,i);qi[o]=this}}}var eo={clear:function(e){var t=$i+e._id;if(Hi(t)){var n=pi.getFrameworkAdaptor().getProviderByModuleName("messages");n?n.clear(t):m("#"+t).closeMessage()}},onClose:function(e,t){t=U.last(arguments);var n=e._id,r=pi.getFrameworkAdaptor(),i=r.getProviderByModuleName("messages");if(i){var o=$i+e._id;i.onClose(o,t)}else qi[n]&&(qi[n].onCloseTrigger=t)},generic:Zi("generic"),error:Zi("error"),warning:Zi("warning"),success:Zi("success"),info:Zi("info"),hint:Zi("hint")},to={actionInvoked:function(e,t){v.dispatch("flag-action-invoked",{id:t,actionId:e})},open:function(e){v.dispatch("flag-open",{id:e})},close:function(e){v.dispatch("flag-close",{id:e})},closed:function(e){v.dispatch("flag-closed",{id:e})}},no="ap-flag-",ro="ac-flag-actions",io=function(){function e(){}var t=e.prototype;t.cleanKey=function(e){var t=new RegExp("^ap-flag-(.+)$"),n=e.match(t);return n&&n[1]?n[1]:null};t._toHtmlString=function(e){return"string"===m.type(e)?e:"object"===m.type(e)&&e instanceof m?e.html():void 0};t._renderBody=function(e){e=this._toHtmlString(e);var t=m("<div />").html(e);m("<p />").addClass(ro).appendTo(t);return t.html()};t._renderActions=function(e,t,n){var r,i=e.find(".ac-flag-actions");n=n||{};Object.getOwnPropertyNames(n).forEach((function(e){r=m("<a />").attr("href","#").data({key:e,flag_id:t}).text(n[e]);i.append(r)}),this);return e};t.render=function(e){!function(){if(ao)return;m(document).on("aui-flag-close",(function(e){var t=e.target.id,n=oo.cleanKey(t);to.closed(n)}));m(document).on("click",".ac-flag-actions",(function(e){var t=m(e.target),n=t.data("key"),r=t.data("flag_id");to.actionInvoked(n,r)}));ao=!0}();var t=no+e.id,n=AJS.flag({type:e.type,title:e.title,body:this._renderBody(e.body),close:e.close});n.setAttribute("id",t);var r=m(n);this._renderActions(r,e.id,e.actions);r.addClass("ac-aui-flag");r.close=n.close;return r};t.close=function(e){document.getElementById(e).close()};return e}(),oo=new io,ao=!1;v.register("flag-close",(function(e){oo.close(e.id)}));var so={},uo=function(){function e(e,t){t=U.last(arguments);if("object"==typeof e){var n=t._id,r=pi.getFrameworkAdaptor(),i=r.getProviderByModuleName("flag");if(i){var o=[];"object"==typeof e.actions&&(o=Object.getOwnPropertyNames(e.actions).map((function(t){return{actionKey:t,actionText:e.actions[t],executeAction:to.actionInvoked.bind(null,t,n)}})));var a=e.type||"info",s={id:n,title:e.title,body:e.body,actions:o,onClose:to.closed,close:e.close,type:a.toLowerCase()};this.flag=i.create(s);var u=ni.getProvider("addon");u&&u.registerUnmountCallback&&u.registerUnmountCallback(this.close.bind(this),t._context)}else{this.flag=oo.render({type:e.type,title:e.title,body:AJS.escapeHtml(e.body),actions:e.actions,close:e.close,id:n});to.open(this.flag.attr("id"))}this.onTriggers={};this.extension=t._context.extension;so[t._id]=this;t.call(null,t._id)}}e.prototype.close=function(){this.flag.close()};return e}();function lo(e,t,n){if(so[e]){var r=so[e].extension;(n=n||{}).flagIdentifier=e;var i={id:r.id};V(t,i,n)}}v.register("flag-closed",(function(e){lo(e.id,"flag.close");so[e.id]&&delete so[e.id]}));v.register("flag-action-invoked",(function(e){lo(e.id,"flag.action",{actionIdentifier:e.actionId})}));var co,fo,po={create:{constructor:uo,close:uo.prototype.close}},ho={trackDeprecatedMethodUsed:function(e,t){t=U.last(arguments);Nr(e,t._context.extension)},trackIframePerformanceMetrics:function(e,t){t=U.last(arguments);Br(e,t._context.extension)},trackWebVitals:function(e,t){t=U.last(arguments);zr(e,t._context.extension)}};v.register("iframe-bridge-established",(function(e){if(e.extension.options.isFullPage){window.addEventListener("scroll",vo);co=e.extension.id}}));v.register("iframe-destroyed",(function(e){go()}));v.register("iframe-unload",(function(e){go()}));function go(){window.removeEventListener("scroll",vo);co=void 0;fo=void 0}function vo(){var e=document.documentElement.scrollHeight,t=window.innerHeight,n=.1*e;window.pageYOffset<=n?yo("nearTop"):t+window.pageYOffset+n>=e?yo("nearBottom"):fo=void 0}function yo(e){if(fo!==e){V("scroll."+e,{id:co},{});fo=e}}var _o={getPosition:function(e){if((e=U.last(arguments))._context.extension.options.isFullPage){var t=U.getIframeByExtensionId(e._context.extension_id),n=t.offset(),r=m(window);e({scrollY:r.scrollTop()-n.top,scrollX:r.scrollLeft()-n.left,width:window.innerWidth,height:window.innerHeight})}},setVerticalPosition:function(e,t){if((t=U.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=U.getIframeByExtensionId(t._context.extension_id),r=n.offset();"number"==typeof e&&(document.documentElement.scrollTop=r.top+e)}}},mo=function(e,t,n){v.dispatch("dropdown-item-selected",{id:e,item:t,extension:n})};function bo(e){return e.map((function(e){if(e.list&&Array.isArray(e.list)){var t={heading:e.heading};t.items=e.list.map((function(e){return function(e){var t={};if("string"==typeof e)t.content=e;else{if(!e.text||"string"!=typeof e.text)throw new Error("Unknown dropdown list item format.");t.content=e.text;"boolean"==typeof e.disabled&&(t.disabled=e.disabled);void 0!==e.itemId&&(t.itemId=e.itemId)}return t}(e)}));return t}}))}var wo={create:function(e,t){t=U.last(arguments);if("object"==typeof e){var n=pi.getFrameworkAdaptor(),r=n.getProviderByModuleName("dropdown");if(r){var i=bo(e.list),o={dropdownId:e.dropdownId,dropdownGroups:i,dropdownItemNotifier:function(e){mo(e.dropdownId,e.item,t._context.extension)}};r.create(o,t._context);return o}}},showAt:function(e,t,n,r){var i=U.last(arguments),o={left:0,top:0},a=document.getElementById(i._context.extension_id);a?o=a.getBoundingClientRect():console.error("ACJS: no iframe found for dropdown");var s=pi.getFrameworkAdaptor(),u=s.getProviderByModuleName("dropdown");if(u){var l={dropdownId:e,x:t,y:n,width:r};u.showAt(l,{iframeDimensions:o,onItemSelection:function(e,t){mo(e,t,i._context.extension)}})}},hide:function(e){var t=pi.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.hide(e)},itemDisable:function(e,t){var n=pi.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemDisable(e,t)},itemEnable:function(e,t){var n=pi.getFrameworkAdaptor().getProviderByModuleName("dropdown");n&&n.itemEnable(e,t)}};v.register("dropdown-item-selected",(function(e){V("dropdown-item-selected",{addon_key:e.extension.addon_key,key:e.extension.key},{dropdownId:e.id,item:e.item})}));v.register("iframe-destroyed",(function(e){var t=pi.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));v.register("after:iframe-unload",(function(e){var t=pi.getFrameworkAdaptor().getProviderByModuleName("dropdown");t&&t.destroyByExtension(e.extension.extension_id)}));var xo,Eo,ko,Oo,So,Ao={focus:function(){window.document.querySelector("a").focus({preventScroll:!0});window.document.querySelector("a").blur()},getSelectedText:(xo=function(e){e("")},Eo="AP.host.getSelectedText()",So=!1,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!So&&"undefined"!=typeof console&&console.warn){So=!0;console.warn("DEPRECATED API - "+Eo+" has been deprecated "+(Oo?"since ACJS "+Oo:"in ACJS")+" and will be removed in a future release. "+(ko?"Use "+ko+" instead.":"No alternative will be provided."));var r=U.last(t);r&&r._context&&r._context.extension&&ho.trackDeprecatedMethodUsed(Eo,r)}return xo.apply(void 0,t)})},Co=["light","dark","auto"],Io=["light-increased-contrast","light","light-future","dark","dark-future","dark-increased-contrast","legacy-light","legacy-dark","spacing","shape","typography","typography-adg3","typography-modernized","typography-refreshed"],Lo="data-theme",To="data-color-mode",Po="--".concat("ds","-elevation-surface-current"),Do=["light","dark","spacing","typography","shape"],Mo="UNSAFE_themeOptions",jo=function(e){return e.split(" ").map((function(e){return e.split(/:([^]*)/)})).reduce((function(e,t){var n,r,i=ze(t,2),o=i[0],a=i[1];"colorMode"===o&&["light","dark","auto"].includes(a)&&(e[o]=a);(r=o,void 0!==Do.find((function(e){return e===r})))&&(n=a,void 0!==Io.find((function(e){return e===n})))&&(e[o]=a);if(o===Mo)try{e.UNSAFE_themeOptions=JSON.parse(a)}catch(e){}return e}),{})};function Fo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fo(Object(n),!0).forEach((function(t){Ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var No=function(){if("undefined"==typeof document)return{};var e=document.documentElement,t=e.getAttribute(To)||"",n=e.getAttribute(Lo)||"";return Vo(Vo({},jo(n)),function(e){return void 0!==Co.find((function(t){return t===e}))}(t)&&{colorMode:t})},Ro=function(){function e(t){Fe(this,e);Ue(this,"legacyObserver",null);this.callback=t;e.callbacks.add(t)}return Ge(e,[{key:"observe",value:function(){if(!e.observer){e.observer=new MutationObserver((function(){var t=No();e.callbacks.forEach((function(e){return e(t)}))}));e.observer.observe(document.documentElement,{attributeFilter:[Lo,To]})}}},{key:"disconnect",value:function(){this.callback&&e.callbacks.delete(this.callback);if(0===e.callbacks.size&&e.observer){e.observer.disconnect();e.observer=null}}}])}();Ue(Ro,"observer",null);Ue(Ro,"callbacks",new Set);var Go=function(e){var t=document.getElementById(e);if(t){var n=getComputedStyle(t),r=n.getPropertyValue(Po),i=n.getPropertyValue("--ds-surface-raised"),o=n.getPropertyValue("--ds-surface-overlay");return r===i?"raised":r===o?"overlay":void 0}};var Uo={extensionIds:[],themeObserver:new Ro((function(e){!function(e){var t={};Uo.extensionIds.length&&Uo.extensionIds.forEach((function(n){var r=Go(n);M.broadcast("theme_changed",{id:n},{newTheme:e,featureFlags:t,surface:r})}))}(e)}))},Bo={initializeTheming:function(){var e=U.last(arguments),t=1!==arguments.length&&arguments[0];if(e&&e._context&&e._context.extension_id){var n=e._context.extension_id;if(n){var r=No(),i=Go(n),o={};M.broadcast("theme_initialized",{id:n},{initialTheme:r,featureFlags:o,surface:i,forceNoCleanup:t});if(!Uo.extensionIds.includes(n)){Uo.extensionIds.push(n);Uo.themeObserver.observe(document.documentElement)}}}},_finishedInitTheming:function(){}},zo={setTitle:function(e,t){if((t=U.last(arguments))._context.extension.options&&t._context.extension.options.isFullPage){var n=" - "+U.guessProductFromModuleDefined(window.connectHost);document.title=e+n}}},Ko=function(e){v.dispatch("inline-dialog-extension",{$el:e.$el,extension:e.extension})},Jo=new(function(){function e(){}var t=e.prototype;t.resize=function(e){var t=U.stringToDimension(e.width),n=U.stringToDimension(e.height),r=e.$el.find(".contents");if(1===r.length){r.css({width:t,height:n});Gi(e.$el)}};t.refresh=function(e){e.is(":visible")&&e[0].popup.reset()};t._getInlineDialog=function(e){return AJS.InlineDialog(e)};t._renderContainer=function(){return m("<div />").addClass("aui-inline-dialog-contents")};t._displayInlineDialog=function(e){Bi({$el:e.$el,trigger:e.trigger,extension:e.extension})};t.hideInlineDialog=function(e){e.hide()};t.closeInlineDialog=function(){m(".aui-inline-dialog").filter((function(){return m(this).find(".ap-iframe-container").length>0})).hide()};t.render=function(e){var t=this,n=m(document.getElementById("inline-dialog-"+e.id));0!==n.length&&n.remove();var r=AJS.InlineDialog(e.bindTo,e.id,(function(n,r,i){n.append(e.$content);t._displayInlineDialog({extension:e.extension,$el:n,trigger:r});i()}),e.inlineDialogOptions);r.css("z-index",1e3);return r};return e}());v.register("iframe-resize",(function(e){var t=e.$el.parents(".aui-inline-dialog");1===t.length&&Jo.resize({width:e.width,height:e.height,$el:t})}));v.register("inline-dialog-refresh",(function(e){Jo.refresh(e.$el)}));v.register("inline-dialog-hide",(function(e){Jo.hideInlineDialog(e.$el)}));v.register("inline-dialog-close",(function(e){Jo.closeInlineDialog()}));var $o="inline-dialog-target-uid",Wo=new(function(){function e(){this._inlineDialogWebItemSpec={name:"inline-dialog",selector:".ap-inline-dialog",triggers:["mouseenter","click"]};this._inlineDialogWebItems={}}var t=e.prototype;t.getWebItem=function(){return this._inlineDialogWebItemSpec};t._createInlineDialog=function(e){return Jo.render({extension:e.extension,id:e.id,bindTo:e.$target,$content:m("<div />"),inlineDialogOptions:e.extension.options})};t.triggered=function(e){var t=e.eventType,n=e.extension.options.onHover;if("click"===t||n){var r=e.$target,i=r.data($o);v.dispatch("analytics-inline-dialog-opened",{extension:e.extension,eventType:t,onHover:n});if("click"===t&&!n){if("true"===r.attr("data-inline-created"))return;r.attr("data-inline-created","true")}this._createInlineDialog({id:i,extension:e.extension,$target:r,options:e.extension.options||{}}).show()}};t.opened=function(e){var t=e.$el.find("iframe");if(t&&1===t.length){var n=t.attr("src");if(n.length>0){var r=Le.hasJwt(n);if(r&&!Le.isJwtExpired(n)||!r)return!1}}var i=Oi(e.extension),o=di.requestContent(i);if(!o){console.warn("no content resolver found");return!1}o.then((function(t){t.options=t.options||{};U.extend(t.options,{autoresize:!0,widthinpx:!0});Ko({$el:e.$el,extension:t})}));return!0};t.addExtension=function(e){var t=Fr(e.extension);e.$el.empty().append(t)};t.createIfNotExists=function(e){var t=e.$target,n=t.data($o);if(!n){n=ti.uniqueId();t.data($o,n)}};return e}()),qo=Wo.getWebItem();v.register("before:webitem-invoked:"+qo.name,(function(e){Wo.createIfNotExists(e)}));v.register("webitem-invoked:"+qo.name,(function(e){Wo.triggered(e)}));v.register("inline-dialog-opened",(function(e){Wo.opened(e)}));v.register("inline-dialog-extension",(function(e){Wo.addExtension(e)}));ii(qo);var Ho=["click"],Xo="dialog-target-uid",Yo={chrome:!0},Qo=new(function(){function e(){this._dialogWebItem={name:"dialog",selector:".ap-dialog",triggers:Ho}}var t=e.prototype;t.getWebItem=function(){return this._dialogWebItem};t._dialogOptions=function(e){return U.extend({},Yo,e||{})};t.triggered=function(e){var t=e.$target.data(Xo),n=this._dialogOptions(e.extension.options);n.id=t;z(e.extension,n)};t.createIfNotExists=function(e){var t=e.$target,n=t.data(Xo);if(!n){n=ti.uniqueId();t.data(Xo,n)}};return e}()),Zo=Qo.getWebItem();v.register("webitem-invoked:"+Zo.name,(function(e){Qo.triggered(e)}));v.register("before:webitem-invoked:"+Zo.name,Qo.createIfNotExists);ii(Zo);window._AP||(window._AP={});window._AP.version||(window._AP.version="5.3.205");M.defineModule("messages",eo);M.defineModule("flag",po);M.defineModule("dialog",Li);M.defineModule("inlineDialog",zi);M.defineModule("env",Ni);M.defineModule("events",B);M.defineModule("_analytics",ho);M.defineModule("scrollPosition",_o);M.defineModule("dropdown",wo);M.defineModule("host",Ao);M.defineModule("theming",Bo);M.defineModule("page",zo);v.register("module-define-custom",(function(e){M.defineModule(e.name,e.methods)}));M.registerRequestNotifier((function(t){var n=function(){if("req"===t.type){var n=M.getExtensions((function(e){return e.extension_id===t.extension_id}))[0];if(n){var r=n.extension;v.dispatch("method-invoked",e({},t,{extension:r}))}}};"function"==typeof window.requestIdleCallback?window.requestIdleCallback(n,{timeout:1e3}):n()}));function ea(){!function(){var e=new MutationObserver((function(e){e.forEach((function(e){"childList"===e.type&&e.removedNodes.forEach((function(e){if(e.nodeType===Node.ELEMENT_NODE){var t=function(e){pi.destroy(e.id)};"IFRAME"===e.tagName&&e.id?t(e):e.querySelectorAll("iframe[id]").forEach((function(e){t(e)}))}}))}))}));e.observe(document.body,{childList:!0,subtree:!0})}()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",ea):ea();X((function(e,t){var n=JSON.parse(e.name||"{}").options||{},r={moduleLocation:n.moduleLocation,moduleType:n.moduleType,addonKey:t.addon_key,baseUrl:n.origin};Kr(r)}));M.setFeatureFlagGetter(fr);return pi}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-spa-context-v5', location = 'v5/js/spa-context/main.js' */
define("ac/spa-context",(function(){var n=null,i=null;return{provideContainerApi:function(i){n=i},provideNavigationApi:function(n){i=n},isInIframe:function(){return null!==n},canSpaTransition:function(){return null!==i},getContainerApi:function(){return n},getNavigationApi:function(){return i}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-navigator-v5', location = 'v5/js/iframe/host/_uritemplate.js' */
!function(e){"use strict";var t=function(){function e(e){this.options=e}e.prototype.toString=function(){return JSON&&JSON.stringify?JSON.stringify(this.options):this.options};return e}(),n=function(){function e(t){return"function"==typeof Object.freeze?function(t){if("object"!=typeof t||null===t)return t;Object.freeze(t);var n,r;for(r in t)t.hasOwnProperty(r)&&"object"==typeof(n=t[r])&&e(n);return t}(t):t}return{isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isString:function(e){return"[object String]"===Object.prototype.toString.apply(e)},isNumber:function(e){return"[object Number]"===Object.prototype.toString.apply(e)},isBoolean:function(e){return"[object Boolean]"===Object.prototype.toString.apply(e)},join:function(e,t){var n,r="",i=!0;for(n=0;n<e.length;n+=1){i?i=!1:r+=t;r+=e[n]}return r},map:function(e,t){for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n},filter:function(e,t){for(var n=[],r=0;r<e.length;r+=1)t(e[r])&&n.push(e[r]);return n},deepFreeze:e}}(),r=function(){function e(e){return e>="0"&&e<="9"}return{isAlpha:function(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"},isDigit:e,isHexDigit:function(t){return e(t)||t>="a"&&t<="f"||t>="A"&&t<="F"}}}(),i=function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return e<=127?1:194<=e&&e<=223?2:224<=e&&e<=239?3:240<=e&&e<=244?4:0},n=function(e){return 128<=e&&e<=191};function i(e,t){return"%"===e.charAt(t)&&r.isHexDigit(e.charAt(t+1))&&r.isHexDigit(e.charAt(t+2))}function o(e,t){return parseInt(e.substr(t,2),16)}return{encodeCharacter:function(t){var n,r,i="",o=e(t);for(r=0;r<o.length;r+=1)i+="%"+((n=o.charCodeAt(r))<16?"0":"")+n.toString(16).toUpperCase();return i},isPctEncoded:function(e){if(!i(e,0))return!1;var r=o(e,1),s=t(r);if(0===s)return!1;for(var a=1;a<s;a+=1)if(!i(e,3*a)||!n(o(e,3*a+1)))return!1;return!0},pctCharAt:function(e,r){var s=e.charAt(r);if(!i(e,r))return s;var a=o(e,r+1),u=t(a);if(0===u)return s;for(var f=1;f<u;f+=1)if(!i(e,r+3*f)||!n(o(e,r+3*f+1)))return s;return e.substr(r,3*u)}}}(),o={isVarchar:function(e){return r.isAlpha(e)||r.isDigit(e)||"_"===e||i.isPctEncoded(e)},isUnreserved:function(e){return r.isAlpha(e)||r.isDigit(e)||"-"===e||"."===e||"_"===e||"~"===e},isReserved:function(e){return":"===e||"/"===e||"?"===e||"#"===e||"["===e||"]"===e||"@"===e||"!"===e||"$"===e||"&"===e||"("===e||")"===e||"*"===e||"+"===e||","===e||";"===e||"="===e||"'"===e}},s=function(){function e(e,t){var n,r="",s="";"number"!=typeof e&&"boolean"!=typeof e||(e=e.toString());for(n=0;n<e.length;n+=s.length){s=e.charAt(n);r+=o.isUnreserved(s)||t&&o.isReserved(s)?s:i.encodeCharacter(s)}return r}return{encode:e,encodePassReserved:function(t){return e(t,!0)},encodeLiteral:function(e){var t,n="",r="";for(t=0;t<e.length;t+=r.length)(r=i.pctCharAt(e,t)).length>1?n+=r:n+=o.isReserved(r)||o.isUnreserved(r)?r:i.encodeCharacter(r);return n},encodeLiteralCharacter:function(e,t){var n=i.pctCharAt(e,t);return n.length>1||o.isReserved(n)||o.isUnreserved(n)?n:i.encodeCharacter(n)}}}(),a=function(){var e={};function t(t){e[t]={symbol:t,separator:"?"===t?"&":""===t||"+"===t||"#"===t?",":t,named:";"===t||"&"===t||"?"===t,ifEmpty:"&"===t||"?"===t?"=":"",first:"+"===t?"":t,encode:"+"===t||"#"===t?s.encodePassReserved:s.encode,toString:function(){return this.symbol}}}t("");t("+");t("#");t(".");t("/");t(";");t("?");t("&");return{valueOf:function(t){return e[t]?e[t]:"=,!@|".indexOf(t)>=0?null:e[""]}}}();function u(e){var t;if(null==e)return!1;if(n.isArray(e))return e.length>0;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return!0;for(t in e)if(e.hasOwnProperty(t)&&u(e[t]))return!0;return!1}var f=function(){function e(e){this.literal=s.encodeLiteral(e)}e.prototype.expand=function(){return this.literal};e.prototype.toString=e.prototype.expand;return e}(),p=function(){function e(e){var n,s,u=[],f=null,p=null,l=null,h="";function d(){var n=e.substring(p,s);if(0===n.length)throw new t({expressionText:e,message:"a varname must be specified",position:s});f={varname:n,exploded:!1,maxLength:null};p=null}function g(){if(l===s)throw new t({expressionText:e,message:"after a ':' you have to specify the length",position:s});f.maxLength=parseInt(e.substring(l,s),10);l=null}n=function(n){var r=a.valueOf(n);if(null===r)throw new t({expressionText:e,message:"illegal use of reserved operator",position:s,operator:n});return r}(e.charAt(0));s=n.symbol.length;p=s;for(;s<e.length;s+=h.length){h=i.pctCharAt(e,s);if(null!==p){if("."===h){if(p===s)throw new t({expressionText:e,message:"a varname MUST NOT start with a dot",position:s});continue}if(o.isVarchar(h))continue;d()}if(null!==l){if(s===l&&"0"===h)throw new t({expressionText:e,message:"A :prefix must not start with digit 0",position:s});if(r.isDigit(h)){if(s-l>=4)throw new t({expressionText:e,message:"A :prefix must have max 4 digits",position:s});continue}g()}if(":"!==h)if("*"!==h){if(","!==h)throw new t({expressionText:e,message:"illegal character",character:h,position:s});u.push(f);f=null;p=s+1}else{if(null===f)throw new t({expressionText:e,message:"exploded without varspec",position:s});if(f.exploded)throw new t({expressionText:e,message:"exploded twice",position:s});if(f.maxLength)throw new t({expressionText:e,message:"an explode (*) MUST NOT follow to a prefix",position:s});f.exploded=!0}else{if(null!==f.maxLength)throw new t({expressionText:e,message:"only one :maxLength is allowed per varspec",position:s});if(f.exploded)throw new t({expressionText:e,message:"an exploeded varspec MUST NOT be varspeced",position:s});l=s+1}}null!==p&&d();null!==l&&g();u.push(f);return new c(e,n,u)}return function(n){var r,i,o=[],s=null,a=0;for(r=0;r<n.length;r+=1){i=n.charAt(r);if(null===a){if(null===s)throw new Error("reached unreachable code");if("{"===i)throw new t({templateText:n,message:"brace already opened",position:r});if("}"===i){if(s+1===r)throw new t({templateText:n,message:"empty braces",position:s});try{o.push(e(n.substring(s+1,r)))}catch(e){if(e.prototype===t.prototype)throw new t({templateText:n,message:e.options.message,position:s+e.options.position,details:e.options});throw e}s=null;a=r+1}}else{if("}"===i)throw new t({templateText:n,message:"unopened brace closed",position:r});if("{"===i){a<r&&o.push(new f(n.substring(a,r)));a=null;s=r}}}if(null!==s)throw new t({templateText:n,message:"unclosed brace",position:s});a<n.length&&o.push(new f(n.substr(a)));return new l(n,o)}}(),c=function(){function e(e){return JSON&&JSON.stringify?JSON.stringify(e):e}function t(e){if(!u(e))return!0;if(n.isString(e))return""===e;if(n.isNumber(e)||n.isBoolean(e))return!1;if(n.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function r(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push({name:t,value:e[t]});return n}function i(e,t,n){this.templateText=e;this.operator=t;this.varspecs=n}i.prototype.toString=function(){return this.templateText};function o(e,t,n){var r="";n=n.toString();if(t.named){r+=s.encodeLiteral(e.varname);if(""===n)return r+=t.ifEmpty;r+="="}null!==e.maxLength&&(n=n.substr(0,e.maxLength));return r+=t.encode(n)}function a(e){return u(e.value)}function f(e,i,o){var f=[],p="";if(i.named){p+=s.encodeLiteral(e.varname);if(t(o))return p+=i.ifEmpty;p+="="}if(n.isArray(o)){f=o;f=n.filter(f,u);f=n.map(f,i.encode);p+=n.join(f,",")}else{f=r(o);f=n.filter(f,a);f=n.map(f,(function(e){return i.encode(e.name)+","+i.encode(e.value)}));p+=n.join(f,",")}return p}function p(e,i,o){var f=[];if(n.isArray(o)){f=o;f=n.filter(f,u);f=n.map(f,(function(n){var r=s.encodeLiteral(e.varname);t(n)?r+=i.ifEmpty:r+="="+i.encode(n);return r}))}else{f=r(o);f=n.filter(f,a);f=n.map(f,(function(e){var n=s.encodeLiteral(e.name);t(e.value)?n+=i.ifEmpty:n+="="+i.encode(e.value);return n}))}return n.join(f,i.separator)}function c(e,t){var i=[],o="";if(n.isArray(t)){i=t;i=n.filter(i,u);i=n.map(i,e.encode);o+=n.join(i,e.separator)}else{i=r(t);i=n.filter(i,(function(e){return u(e.value)}));i=n.map(i,(function(t){return e.encode(t.name)+"="+e.encode(t.value)}));o+=n.join(i,e.separator)}return o}i.prototype.expand=function(r){var i,s,a,l=[],h=this.operator;for(i=0;i<this.varspecs.length;i+=1)if(null!=(a=r[(s=this.varspecs[i]).varname])){s.exploded&&!0;n.isArray(a);if("string"==typeof a||"number"==typeof a||"boolean"==typeof a)l.push(o(s,h,a));else{if(s.maxLength&&u(a))throw new Error("Prefix modifiers are not applicable to variables that have composite values. You tried to expand "+this+" with "+e(a));s.exploded?u(a)&&(h.named?l.push(p(s,h,a)):l.push(c(h,a))):!h.named&&t(a)||l.push(f(s,h,a))}}return 0===l.length?"":h.first+n.join(l,h.separator)};return i}(),l=function(){function e(e,t){this.templateText=e;this.expressions=t;n.deepFreeze(this)}e.prototype.toString=function(){return this.templateText};e.prototype.expand=function(e){var t,n="";for(t=0;t<this.expressions.length;t+=1)n+=this.expressions[t].expand(e);return n};e.parse=p;e.UriTemplateError=t;return e}();!function(e){"function"==typeof define?define("_uritemplate",[],(function(){return e})):"undefined"!=typeof window?window.UriTemplate=e:global.UriTemplate=e}(l)}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-navigator-v5', location = 'v5/js/navigator/context.js' */
define("ac/navigator/context",(function(){var n;return{setContextFunction:function(t){n=t},getContextFunction:function(){return n}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-navigator-v5', location = 'v5/js/navigator/module.js' */
define("ac/navigator/module",["ac/navigator/utils","ac/navigator/routes","ac/navigator/context","ac/spa-context"],(function(t,o,e,n){return{getLocation:function(o){var n=e.getContextFunction();if("function"!=typeof n)console.error("no context function defined");else{context=n();if("object"!=typeof context||Array.isArray(context)||null===context)console.error("navigator context callback did not return an object");else{context.href=t.getTopmostSameOriginWindow(window).location.href;o(context)}}},go:function(e,n,a){e=e.toLowerCase();(n=n||{}).addonKey||(n.addonKey=a._context.extension.addon_key);if(t.isApiEnabled()){var r=o.getRoutes();o.hasRoutes()&&e in r?"function"==typeof r[e]?r[e](n,t.goToUrl):t.goToUrl(t.buildUrl(r[e],n)):console.error("The URL target "+e+" is not available. Valid targets are: "+Object.keys(r).toString())}else console.error("connect navigation api not yet implemented for this product")},_shouldThrottle:function(t,o){var e=Number(window.localStorage.getItem("lastReloadTimestamp")),n=Number(window.localStorage.getItem("reloadAttempts")),a=Date.now();a-e>t&&(n=0);if(n>=o){console.error("Reloads must be "+t+"ms apart after "+n+" reload attempts.");return!0}e=a;n+=1;window.localStorage.setItem("lastReloadTimestamp",e);window.localStorage.setItem("reloadAttempts",n);return!1},reload:function(){this._shouldThrottle(12e4,5)||(n.isInIframe()?t.getTopmostSameOriginWindow(window).location.reload():window.location.reload())}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-navigator-v5', location = 'v5/js/navigator/routes.js' */
define("ac/navigator/routes",(function(){var e={addonmodule:function(e,t){var o=e&&e.addonKey,n=e&&e.moduleKey;if(!o)throw new Error("Missing addonKey parameter in the context.");if(!n)throw new Error("Missing moduleKey parameter in the context.");var r=function(e){const t=e.map(encodeURIComponent).join("/");return new URL(t,window.location.origin).pathname.slice(1)}([o,n]),a=AJS.contextPath()+"/plugins/servlet/ac/"+r;if(null!=e.context){console.warn("DEPRECATED API - The context field has been deprecated in favor of customData.");connectHost.trackDeprecatedMethodUsed("AP.navigate-context",{addon_key:o,moduleKey:n})}var i,l=AJS.$.extend({},e.context||{},e.customData||{}),c=(i=l,Object.keys(i).map((function(e){return["ac."+e,i[e]].map(encodeURIComponent).join("=")})).join("&"));a=""!=c?a+"?"+c:a;t.apply(this,[a])},site:function(e,t){function o(e){if(-1!==new URL(e,document.baseURI).pathname.replace(/\/+/g,"/").toLowerCase().indexOf("plugins/servlet/ac-redirect"))throw new Error("Cannot use legacy redirect filter in Navigator API")}if(e.relativeUrl){if("string"!=typeof e.relativeUrl||"/"!==e.relativeUrl[0])throw new Error("Invalid relativeUrl passed in context");o(e.relativeUrl);var n=0===e.relativeUrl.indexOf(AJS.contextPath())?"":AJS.contextPath(),r=window.location.protocol+"//"+window.location.hostname+n+e.relativeUrl;t.apply(this,[r])}else{if(!e.absoluteUrl)throw new Error("No context supplied to Navigator API");var a=window.location.protocol+"//"+window.location.hostname+"/";if("string"!=typeof e.absoluteUrl||0!==e.absoluteUrl.indexOf(a))throw new Error("Invalid absoluteUrl passed in context");o(e.absoluteUrl);t.apply(this,[e.absoluteUrl])}}};return{hasRoutes:function(){return e&&0!==Object.getOwnPropertyNames(e).length},addRoutes:function(t){e=AJS.$.extend(e,t)},getRoutes:function(){return e}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-navigator-v5', location = 'v5/js/navigator/utils.js' */
define("ac/navigator/utils",["_uritemplate","ac/spa-context"],(function(n,t){var r=!1;return{enableApi:function(){r=!0},disableApi:function(){r=!1},isApiEnabled:function(){return r},buildUrl:function(t,r){"/"!==t[0]&&(t="/"+t);return AJS.contextPath()+n.parse(t).expand(r)},goToUrl:function(n){var r=function(){window.location.href=n};t.isInIframe()?t.getContainerApi().navigate(n,r):t.canSpaTransition()?t.getNavigationApi().navigate(n):r()},hasContext:function(n,t){if(!n[t]){AJS.error("Missing "+t+" in navigator context");return!1}return!0},appendQueryParam:function(n,t,r){return n+(n.indexOf("?")>-1?"&":"?")+t+"="+encodeURIComponent(r)},getTopmostSameOriginWindow:function(n){function t(n){try{if(null==n.location.href)return!1}catch(n){return!1}return!0}for(var r,e=n;!(r=e,r===r.parent)&&t(e.parent);)e=e.parent;return e}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-extensions-v5', location = 'v5/js/core/connect-host-cookie.js' */
!function(e,n){if("function"==typeof define&&define.amd)define(["exports"],n);else if("undefined"!=typeof exports)n(exports);else{var t={exports:{}};n(t.exports);e.connectHostCookie=t.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=void 0;e.erase=k;e.read=T;e.save=N;const n="AJS.conglomerate.cookie",t=/(\\|^"|"$)/g,o=/\|\|+/g,r=/"/g,i=/[.*+?|^$()[\]{\\]/g,c=encodeURIComponent("|"),f=encodeURIComponent("|").toLowerCase(),a="**PIPE**",s="**PIPE_PERCENT_ENCODED_UPPER**",u="**PIPE_PERCENT_ENCODED_LOWER**",g="**PERCENT**",l="**EQUALS**";function E(e){if("string"!=typeof e)return e;if(-1!==e.indexOf(a)||-1!==e.indexOf(s)||-1!==e.indexOf(u))throw new Error("Cannot use cookies that contain **PIPE** or **PIPE_PERCENT_ENCODED_UPPER****PIPE_PERCENT_ENCODED_LOWER**");if(-1!==e.indexOf(g))throw new Error("Cannot use cookies that contain **PERCENT**");if(-1!==e.indexOf(l))throw new Error("Cannot use cookies that contain **EQUALS**");return e=(e=(e=(e=(e=e.replace(new RegExp(d("|"),"g"),a)).replace(new RegExp(c,"g"),s)).replace(new RegExp(f,"g"),u)).replace(new RegExp("%","g"),g)).replace(new RegExp("=","g"),l)}function p(e){return"string"!=typeof e?e:e=(e=(e=(e=(e=e.replace(new RegExp(d(a),"g"),"|")).replace(new RegExp(d(s),"g"),c)).replace(new RegExp(d(u),"g"),f)).replace(new RegExp(d(g),"g"),"%")).replace(new RegExp(d(l),"g"),"=")}function d(e){return e.replace(i,"\\$&")}function x(e){const n=new RegExp("\\b"+d(e)+"=((?:[^\\\\;]+|\\\\.)*)(?:;|$)"),o=document.cookie.match(n);return o&&function(e){return e.replace(t,"")}(o[1])}function w(e,t,i){let c=x(n);c=function(e,n,t){const r=new RegExp("(\\s|\\|)*\\b"+d(e||"")+"=[^|]*[|]*");t=(t=t||"").replace(r,"|");if(""!==n){const o=e+"="+n;t.length+o.length<4020&&(t+="|"+o)}return t.replace(o,"|")}(e,t,c);!function(e,n,t){let o,i="";const c='"'+n.replace(r,'\\"')+'"';if(t){o=new Date;o.setTime(+o+24*t*60*60*1e3);i="; expires="+o.toUTCString()}document.cookie=e+"="+c+i+";path=/"}(n,c,i||365)}function R(e,t){const o=function(e,n){n=n||"";const t=new RegExp(d(e||"")+"=([^|]+)"),o=n.match(t);return o?o[1]:void 0}(e,x(n));return void 0!==o?o:t}function P(e){w(e,"")}function h(e,n){if(!e||0===e.length)throw new Error("addon key must be defined on cookies");if(!n||0===n.length)throw new Error("Name must be defined")}function m(e,n){h(e,n);return e+"$$"+n}function C(e,n){h(e,n);return`connect.cookie:${e}$$${n}`}function _(e){if(e&&e._context)return e._context.extension.addon_key;throw new Error("addon key not found in callback")}function y(e,n,t,o){const r=new Date;r.setTime(r.getTime()+24*(o||365)*60*60*1e3);const i={expiry:r.getTime(),value:t};localStorage.setItem(C(e,n),JSON.stringify(i))}function O(e,n){const t=localStorage.getItem(C(e,n));if(null===t)return;const o=JSON.parse(t);if(o.expiry&&(new Date).getTime()>o.expiry){localStorage.removeItem(n);return}const r=o.value;return"string"==typeof r?r:JSON.stringify(r)}function N(e,n,t,...o){const r=arguments[arguments.length-1],i=_(r);r._context&&y(i,e,n,t)}function T(e,n){const t=O(_(n=arguments[arguments.length-1]),e);if(void 0!==t){n(t);return t}const o=m(_(n),E(e)),r=p(R(o,void 0));n(r);return r}function k(e,...n){const t=arguments[arguments.length-1],o=m(_(t),E(e));P(o);localStorage.removeItem(C(_(t),e))}e.default={save:N,read:T,erase:k}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-extensions-v5', location = 'v5/js/core/connect-host-history.js' */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).connectHostHistory=t()}}((function(){return function t(e,n,r){function o(a,i){if(!n[a]){if(!e[a]){var h="function"==typeof require&&require;if(!i&&h)return h(a,!0);if(s)return s(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[a]={exports:{}};e[a][0].call(l.exports,(function(t){var n=e[a][1][t];return o(n||t)}),l,l.exports,t,e,n,r)}return n[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t("./constants"),o=t("./models"),s=t("./utils");function a(t,e){(0,s.callConnectHost)((function(n){(0,s.values)(n.getExtensions()).forEach((function(r){var s=r.extension.addon_key,a=new o.Current({url:window.location.href,state:e.state}),i=new o.Route(a);n.broadcastEvent(t,{addon_key:s},i.render(s))}))}))}var i=!1;function h(t){var e=t.state.render(),n=t.url.render();window.history.pushState((0,s.wrapState)(e),n.title,n.url)}function u(t){var e=t.state.render(),n=t.url.render();window.history.replaceState((0,s.wrapState)(e),n.title,n.url)}n.default={_registerWindowListeners:function(){!function(){if(!i){window.addEventListener("popstate",(function(t){var e=(0,s.createEvent)("ap_popstate");e.state=(0,s.unwrapState)(t.state);window.dispatchEvent(e)}));window.addEventListener("ap_popstate",(function(t){var e=(0,s.createEvent)("ap_changestate");e.state=t.state;window.dispatchEvent(e);a(r.HISTORY_POPSTATE,t)}));window.addEventListener("ap_pushstate",(function(t){var e=(0,s.createEvent)("ap_changestate");e.state=t.state;window.dispatchEvent(e);a(r.HISTORY_PUSHSTATE,t)}));window.addEventListener("ap_replacestate",(function(t){var e=(0,s.createEvent)("ap_changestate");e.state=t.state;window.dispatchEvent(e);a(r.HISTORY_REPLACESTATE,t)}));window.addEventListener("ap_changestate",(function(t){a(r.HISTORY_CHANGESTATE,t)}));i=!0}}()},back:function(t){t=arguments[arguments.length-1];this.go(-1,t)},forward:function(t){t=arguments[arguments.length-1];this.go(1,t)},go:function(t){var e=arguments[arguments.length-1];e._context.extension.options.isFullPage?window.history.go(t):(0,s.log)("History is only available to page modules")},getState:function(t,e){var n=(e=arguments[arguments.length-1])._context.extension.addon_key,r=new o.Current({url:window.location.href,state:(0,s.unwrapState)(window.history.state)}),a=new o.Route(r),i=a.render(n);if("hash"===(t=t&&"string"==typeof t?t:"hash"))e(i.hash);else{if("all"!==t)throw new Error("invalid type for getState");e(i)}},pushState:function(t,e){var n=(e=arguments[arguments.length-1])._context.extension.addon_key,r=new o.Current({url:window.location.href,state:(0,s.unwrapState)(window.history.state)}),a=new o.Route(r),i=new o.Change(t,n),l=new o.Route(i);if(e._context.extension.options.isFullPage){if(l.url.isURLEqual(a.url)){a.merge(l);u(a)}else if(l.url.isPathnameEqual(a.url)){a.merge(l);h(a)}else h(l);var f=(0,s.createEvent)("ap_pushstate");f.state=(0,s.unwrapState)(window.history.state);window.dispatchEvent(f)}else(0,s.log)("History is only available to page modules")},replaceState:function(t,e){var n=(e=arguments[arguments.length-1])._context.extension.addon_key,r=new o.Current({url:window.location.href,state:(0,s.unwrapState)(window.history.state)}),a=new o.Route(r),i=new o.Change(t,n),h=new o.Route(i);if(e._context.extension.options.isFullPage){if(h.url.isURLEqual(a.url)){a.merge(h);u(a)}else if(h.url.isPathnameEqual(a.url)){a.merge(h);u(a)}else u(h);var l=(0,s.createEvent)("ap_replacestate");l.state=(0,s.unwrapState)(window.history.state);window.dispatchEvent(l)}else(0,s.log)("History is only available to page modules")}};e.exports=n.default},{"./constants":7,"./models":8,"./utils":9}],2:[function(t,e,n){(function(t){!function(r){var o="object"==typeof n&&n,s="object"==typeof e&&e&&e.exports==o&&e,a="object"==typeof t&&t;a.global!==a&&a.window!==a||(r=a);var i,h,u=2147483647,l=36,f=/^xn--/,c=/[^ -~]/,p=/\x2E|\u3002|\uFF0E|\uFF61/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=Math.floor,m=String.fromCharCode;function v(t){throw RangeError(d[t])}function w(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function g(t,e){return w(t.split(p),e).join(".")}function E(t){for(var e,n,r=[],o=0,s=t.length;o<s;)if((e=t.charCodeAt(o++))>=55296&&e<=56319&&o<s)if(56320==(64512&(n=t.charCodeAt(o++))))r.push(((1023&e)<<10)+(1023&n)+65536);else{r.push(e);o--}else r.push(e);return r}function _(t){return w(t,(function(t){var e="";if(t>65535){e+=m((t-=65536)>>>10&1023|55296);t=56320|1023&t}return e+=m(t)})).join("")}function b(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function A(t,e,n){var r=0;t=n?y(t/700):t>>1;t+=y(t/e);for(;t>455;r+=l)t=y(t/35);return y(r+36*t/(t+38))}function x(t){var e,n,r,o,s,a,i,h,f,c,p,d=[],m=t.length,w=0,g=128,E=72;(n=t.lastIndexOf("-"))<0&&(n=0);for(r=0;r<n;++r){t.charCodeAt(r)>=128&&v("not-basic");d.push(t.charCodeAt(r))}for(o=n>0?n+1:0;o<m;){for(s=w,a=1,i=l;;i+=l){o>=m&&v("invalid-input");((h=(p=t.charCodeAt(o++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:l)>=l||h>y((u-w)/a))&&v("overflow");w+=h*a;if(h<(f=i<=E?1:i>=E+26?26:i-E))break;a>y(u/(c=l-f))&&v("overflow");a*=c}E=A(w-s,e=d.length+1,0==s);y(w/e)>u-g&&v("overflow");g+=y(w/e);w%=e;d.splice(w++,0,g)}return _(d)}function R(t){var e,n,r,o,s,a,i,h,f,c,p,d,w,g,_,x=[];d=(t=E(t)).length;e=128;n=0;s=72;for(a=0;a<d;++a)(p=t[a])<128&&x.push(m(p));r=o=x.length;o&&x.push("-");for(;r<d;){for(i=u,a=0;a<d;++a)(p=t[a])>=e&&p<i&&(i=p);i-e>y((u-n)/(w=r+1))&&v("overflow");n+=(i-e)*w;e=i;for(a=0;a<d;++a){(p=t[a])<e&&++n>u&&v("overflow");if(p==e){for(h=n,f=l;!(h<(c=f<=s?1:f>=s+26?26:f-s));f+=l){_=h-c;g=l-c;x.push(m(b(c+_%g,0)));h=y(_/g)}x.push(m(b(h,0)));s=A(n,w,r==o);n=0;++r}}++n;++e}return x.join("")}i={version:"1.2.4",ucs2:{decode:E,encode:_},decode:x,encode:R,toASCII:function(t){return g(t,(function(t){return c.test(t)?"xn--"+R(t):t}))},toUnicode:function(t){return g(t,(function(t){return f.test(t)?x(t.slice(4).toLowerCase()):t}))}};if(o&&!o.nodeType)if(s)s.exports=i;else for(h in i)i.hasOwnProperty(h)&&(o[h]=i[h]);else r.punycode=i}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,e,n){var r=t("punycode");n.parse=v;n.resolve=function(t,e){return v(t,!1,!0).resolve(e)};n.resolveObject=function(t,e){return t?v(t,!1,!0).resolveObject(e):e};n.format=function(t){w(t)&&(t=v(t));return t instanceof o?t.format():o.prototype.format.call(t)};n.Url=o;function o(){this.protocol=null;this.slashes=null;this.auth=null;this.host=null;this.port=null;this.hostname=null;this.hash=null;this.search=null;this.query=null;this.pathname=null;this.path=null;this.href=null}var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,i=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),h=["'"].concat(i),u=["%","/","?",";","#"].concat(h),l=["/","?","#"],f=/^[a-z0-9A-Z_-]{0,63}$/,c=/^([a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},d={javascript:!0,"javascript:":!0},y={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=t("querystring");function v(t,e,n){if(t&&g(t)&&t instanceof o)return t;var r=new o;r.parse(t,e,n);return r}o.prototype.parse=function(t,e,n){if(!w(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t;o=o.trim();var a=s.exec(o);if(a){var i=(a=a[0]).toLowerCase();this.protocol=i;o=o.substr(a.length)}if(n||a||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===o.substr(0,2);if(v&&(!a||!d[a])){o=o.substr(2);this.slashes=!0}}if(!d[a]&&(v||a&&!y[a])){for(var g,E,_=-1,b=0;b<l.length;b++){-1!==(A=o.indexOf(l[b]))&&(-1===_||A<_)&&(_=A)}if(-1!==(E=-1===_?o.lastIndexOf("@"):o.lastIndexOf("@",_))){g=o.slice(0,E);o=o.slice(E+1);this.auth=decodeURIComponent(g)}_=-1;for(b=0;b<u.length;b++){var A;-1!==(A=o.indexOf(u[b]))&&(-1===_||A<_)&&(_=A)}-1===_&&(_=o.length);this.host=o.slice(0,_);o=o.slice(_);this.parseHost();this.hostname=this.hostname||"";var x="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!x)for(var R=this.hostname.split(/\./),O=(b=0,R.length);b<O;b++){var j=R[b];if(j&&!j.match(f)){for(var q="",S=0,C=j.length;S<C;S++)j.charCodeAt(S)>127?q+="x":q+=j[S];if(!q.match(f)){var P=R.slice(0,b),I=R.slice(b+1),T=j.match(c);if(T){P.push(T[1]);I.unshift(T[2])}I.length&&(o="/"+I.join(".")+o);this.hostname=P.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase();if(!x){var k=this.hostname.split("."),H=[];for(b=0;b<k.length;++b){var U=k[b];H.push(U.match(/[^A-Za-z0-9_-]/)?"xn--"+r.encode(U):U)}this.hostname=H.join(".")}var Y=this.port?":"+this.port:"",Q=this.hostname||"";this.host=Q+Y;this.href+=this.host;if(x){this.hostname=this.hostname.substr(1,this.hostname.length-2);"/"!==o[0]&&(o="/"+o)}}if(!p[i])for(b=0,O=h.length;b<O;b++){var L=h[b],K=encodeURIComponent(L);K===L&&(K=escape(L));o=o.split(L).join(K)}var F=o.indexOf("#");if(-1!==F){this.hash=o.substr(F);o=o.slice(0,F)}var M=o.indexOf("?");if(-1!==M){this.search=o.substr(M);this.query=o.substr(M+1);e&&(this.query=m.parse(this.query));o=o.slice(0,M)}else if(e){this.search="";this.query={}}o&&(this.pathname=o);y[i]&&this.hostname&&!this.pathname&&(this.pathname="/");if(this.pathname||this.search){Y=this.pathname||"",U=this.search||"";this.path=Y+U}this.href=this.format();return this};o.prototype.format=function(){var t=this.auth||"";if(t){t=(t=encodeURIComponent(t)).replace(/%3A/i,":");t+="@"}var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",o=!1,s="";if(this.host)o=t+this.host;else if(this.hostname){o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]");this.port&&(o+=":"+this.port)}this.query&&g(this.query)&&Object.keys(this.query).length&&(s=m.stringify(this.query));var a=this.search||s&&"?"+s||"";e&&":"!==e.substr(-1)&&(e+=":");if(this.slashes||(!e||y[e])&&!1!==o){o="//"+(o||"");n&&"/"!==n.charAt(0)&&(n="/"+n)}else o||(o="");r&&"#"!==r.charAt(0)&&(r="#"+r);a&&"?"!==a.charAt(0)&&(a="?"+a);return e+o+(n=n.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})))+(a=a.replace("#","%23"))+r};o.prototype.resolve=function(t){return this.resolveObject(v(t,!1,!0)).format()};o.prototype.resolveObject=function(t){if(w(t)){var e=new o;e.parse(t,!1,!0);t=e}var n=new o;Object.keys(this).forEach((function(t){n[t]=this[t]}),this);n.hash=t.hash;if(""===t.href){n.href=n.format();return n}if(t.slashes&&!t.protocol){Object.keys(t).forEach((function(e){"protocol"!==e&&(n[e]=t[e])}));y[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/");n.href=n.format();return n}if(t.protocol&&t.protocol!==n.protocol){if(!y[t.protocol]){Object.keys(t).forEach((function(e){n[e]=t[e]}));n.href=n.format();return n}n.protocol=t.protocol;if(t.host||d[t.protocol])n.pathname=t.pathname;else{for(var r=(t.pathname||"").split("/");r.length&&!(t.host=r.shift()););t.host||(t.host="");t.hostname||(t.hostname="");""!==r[0]&&r.unshift("");r.length<2&&r.unshift("");n.pathname=r.join("/")}n.search=t.search;n.query=t.query;n.host=t.host||"";n.auth=t.auth;n.hostname=t.hostname||t.host;n.port=t.port;if(n.pathname||n.search){var s=n.pathname||"",a=n.search||"";n.path=s+a}n.slashes=n.slashes||t.slashes;n.href=n.format();return n}var i,h=n.pathname&&"/"===n.pathname.charAt(0),u=t.host||t.pathname&&"/"===t.pathname.charAt(0),l=u||h||n.host&&t.pathname,f=l,c=n.pathname&&n.pathname.split("/")||[],p=(r=t.pathname&&t.pathname.split("/")||[],n.protocol&&!y[n.protocol]);if(p){n.hostname="";n.port=null;n.host&&(""===c[0]?c[0]=n.host:c.unshift(n.host));n.host="";if(t.protocol){t.hostname=null;t.port=null;t.host&&(""===r[0]?r[0]=t.host:r.unshift(t.host));t.host=null}l=l&&(""===r[0]||""===c[0])}if(u){n.host=t.host||""===t.host?t.host:n.host;n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname;n.search=t.search;n.query=t.query;c=r}else if(r.length){c||(c=[]);c.pop();c=c.concat(r);n.search=t.search;n.query=t.query}else if(!(i=t.search,null==i)){if(p){n.hostname=n.host=c.shift();if(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@")){n.auth=A.shift();n.host=n.hostname=A.shift()}}n.search=t.search;n.query=t.query;E(n.pathname)&&E(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:""));n.href=n.format();return n}if(!c.length){n.pathname=null;n.search?n.path="/"+n.search:n.path=null;n.href=n.format();return n}for(var m=c.slice(-1)[0],v=(n.host||t.host)&&("."===m||".."===m)||""===m,g=0,_=c.length;_>=0;_--)if("."==(m=c[_]))c.splice(_,1);else if(".."===m){c.splice(_,1);g++}else if(g){c.splice(_,1);g--}if(!l&&!f)for(;g--;g)c.unshift("..");!l||""===c[0]||c[0]&&"/"===c[0].charAt(0)||c.unshift("");v&&"/"!==c.join("/").substr(-1)&&c.push("");var b=""===c[0]||c[0]&&"/"===c[0].charAt(0);if(p){n.hostname=n.host=b?"":c.length?c.shift():"";var A;if(A=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@")){n.auth=A.shift();n.host=n.hostname=A.shift()}}(l=l||n.host&&c.length)&&!b&&c.unshift("");if(c.length)n.pathname=c.join("/");else{n.pathname=null;n.path=null}E(n.pathname)&&E(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:""));n.auth=t.auth||n.auth;n.slashes=n.slashes||t.slashes;n.href=n.format();return n};o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);if(e){":"!==(e=e[0])&&(this.port=e.substr(1));t=t.substr(0,t.length-e.length)}t&&(this.hostname=t)};function w(t){return"string"==typeof t}function g(t){return"object"==typeof t&&null!==t}function E(t){return null===t}},{punycode:2,querystring:6}],4:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,s){e=e||"&";n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var i=/\+/g;t=t.split(e);var h=1e3;s&&"number"==typeof s.maxKeys&&(h=s.maxKeys);var u=t.length;h>0&&u>h&&(u=h);for(var l=0;l<u;++l){var f,c,p,d,y=t[l].replace(i,"%20"),m=y.indexOf(n);if(m>=0){f=y.substr(0,m);c=y.substr(m+1)}else{f=y;c=""}p=decodeURIComponent(f);d=decodeURIComponent(c);r(a,p)?o(a[p])?a[p].push(d):a[p]=[a[p],d]:a[p]=d}return a};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],5:[function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,i){e=e||"&";n=n||"=";null===t&&(t=void 0);return"object"==typeof t?s(a(t),(function(a){var i=encodeURIComponent(r(a))+n;return o(t[a])?s(t[a],(function(t){return i+encodeURIComponent(r(t))})).join(e):i+encodeURIComponent(r(t[a]))})).join(e):i?encodeURIComponent(r(i))+n+encodeURIComponent(r(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],6:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode");n.encode=n.stringify=t("./encode")},{"./decode":4,"./encode":5}],7:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.STATE_AP_KEY="_AP";n.QUERY_KEY_PREFIX="ac";n.QUERY_KEY_DELIMITER=".";n.ANCHOR_PREFIX="!";n.HISTORY_POPSTATE="history_popstate";n.HISTORY_PUSHSTATE="history_pushstate";n.HISTORY_REPLACESTATE="history_replacestate";n.HISTORY_CHANGESTATE="history_changestate"},{}],8:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.Addon=i;n.Addons=h;n.Current=function(t){if(!(t=t||{}).url)throw new Error("missing url");var e=s.default.parse(t.url),n=new h,r=(0,a.parseQuery)(e.query).map(a.stripAddonQueryPrefix),o=(0,a.normalizeQueryByAddons)(r),f=o.filter((function(t){return t.key})),c=o.filter((function(t){return!t.key}));f.forEach((function(t){var e=new i(t);n.add(e)}));this.url=new l({url:t.url,addons:n,global:c});this.state=new u(t.state);return this};n.Change=function(t,e){var n=typeof t,r=s.default.parse(window.location.href),o={},f={};if("string"===n){o.protocol=r.protocol;o.slashes=r.slashes;o.hostname=r.hostname;o.pathname=r.pathname;o.port=r.port;o.search=r.search;o.query=r.query;o.hash=(0,a.addHash)((0,a.addHashPrefix)(t))}else{if("object"!==n)throw new Error("invalid option type");var c=t.href?s.default.parse(t.href):r;o.protocol=r.protocol;o.slashes=r.slashes;o.hostname=r.hostname;o.port=r.port;o.pathname=c.pathname||r.pathname;o.search=null;o.query=null;o.hash=t.hash?(0,a.addHash)((0,a.addHashPrefix)(t.hash)):null;f.state=t.state;f.query=t.query}var p=new h,d=new h;if(f.state){var y=new i({key:e,state:f.state});p.add(y)}if(f.query){var m=new i({key:e,query:f.query});d.add(m)}var v=new u({addons:p}),w=new l({url:s.default.format(o),addons:d});this.state=v;this.url=w;return this};n.State=u;n.URL=l;n.Route=f;var r,o=t("url"),s=(r=o)&&r.__esModule?r:{default:r},a=t("./utils");function i(t){if(!(t=t||{}).key)throw new Error("missing key for addon");this.key=t.key;this.state=t.state;this.query=t.query||{};return this}function h(t){(t=t||{}).models=t.models||[];t.models instanceof Array||(t.models=[t.models]);t.models=t.models.map((function(t){return t instanceof i?t:new i(t)}));this.models=t.models;return this}h.prototype.add=function(t){this.models.push(t)};h.prototype.remove=function(t){this.models.splice(this.models.indexOf(t),1)};h.prototype.find=function(t){return(0,a.find)(this.models,(function(e){return e.key===t}))};h.prototype.merge=function(t){var e=this.find(t.key);e&&this.remove(e);this.add(t)};function u(t){(t=t||{}).addons=t.addons||[];t.addons instanceof h||(t.addons=new h(t.addons));this.addons=t.addons;return this}u.prototype.merge=function(t){var e=this;t.addons.models.forEach((function(t){e.addons.merge(t)}))};u.prototype.render=function(){return(0,a.deepCopy)(this)};function l(t){(t=t||{}).addons=t.addons||[];t.global=t.global||[];t.parsed instanceof s.default.Url||(t.parsed=s.default.parse(t.url));t.addons instanceof h||(t.addons=new h(t.addons));this.parsed=t.parsed;this.addons=t.addons;this.global=t.global;this.title=t.title||window.document.title}l.prototype.isURLEqual=function(t){return this.render().url===t.render().url};l.prototype.isPathnameEqual=function(t){var e=this.parsed.protocol===t.parsed.protocol,n=this.parsed.slashes===t.parsed.slashes,r=this.parsed.hostname===t.parsed.hostname,o=this.parsed.pathname===t.parsed.pathname;return e&&n&&r&&o};l.prototype.merge=function(t){var e=this;e.parsed.hash=t.parsed.hash;t.addons.models.forEach((function(t){e.addons.merge(t)}))};l.prototype.render=function(){var t=(0,a.deepCopy)(this),e=t.parsed,n=(0,a.denormalizeQueryByAddons)(this.addons.models),r=(0,a.denormalizeQueryByAddons)(this.global),o=n.concat(r).map(a.addAddonQueryPrefix),i=(0,a.formatQuery)(o);e.query=i;e.search=e.query?"?"+e.query:null;t.url=s.default.format(e);return t};function f(t){if(!(t=t||{}).url)throw new Error("missing url option");t.url instanceof l||(t.url=new l(t.url));if(!t.state)throw new Error("missing state option");t.state instanceof u||(t.state=new u(t.state));this.url=t.url;this.state=t.state}f.prototype.merge=function(t){this.url.merge(t.url);this.state.merge(t.state)};f.prototype.render=function(t){return(0,a.deepCopy)({key:t,hash:(0,a.stripHashPrefix)((0,a.stripHash)(this.url.parsed.hash)),query:this.url.addons.find(t)?this.url.addons.find(t).query:null,title:this.url.title,href:this.url.parsed.href,state:this.state.addons.find(t)?this.state.addons.find(t).state:null})}},{"./utils":9,url:3}],9:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.find=function(t,e){for(var n=0,r=t.length;n<r;n+=1)if(e(t[n]))return t[n]};n.values=function(t){var e=[];if(!t)return e;for(var n in t)e.push(t[n]);return e};n.stripHash=function(t){return t?t.slice(t.search("#")+1):null};n.stripHashPrefix=s;n.addHash=function(t){return"#"+t};n.addHashPrefix=function(t){if(null==t)throw"You must supply text to prefix";return o.ANCHOR_PREFIX+s(t)};n.splitQueryParam=a;n.joinQueryParam=i;n.parseQuery=function(t){return(t?t.split("&"):[]).map((function(t){return a(t)})).filter((function(t){return t}))};n.formatQuery=function(t){var e=t.map((function(t){return i(t)})).filter((function(t){return t}));return e.length?e.join("&"):null};n.stripAddonQueryPrefix=function(t){var e=t.key?t.key.split(o.QUERY_KEY_DELIMITER):[],n=o.QUERY_KEY_PREFIX;if(e.length>=3){if(n===e[0]){var r=e.slice(1,e.length-1).join(o.QUERY_KEY_DELIMITER),s=e.slice(e.length-1).join(o.QUERY_KEY_DELIMITER);return{addonKey:r,key:s,value:t.value}}return t}return t};n.addAddonQueryPrefix=function(t){var e=o.QUERY_KEY_PREFIX;if("addonKey"in t&&t.addonKey){return{key:[e,t.addonKey,t.key].join(o.QUERY_KEY_DELIMITER),value:t.value}}return t};n.normalizeQueryByAddons=function(t){var e=[];t.forEach((function(t){var n=t.key,o=t.value,s=t.addonKey,a=e.filter((function(t){return t.key===s}));if(a&&a.length){a[0].query[n]=o}else e.push({key:s,query:r({},n,o)})}));return e};n.denormalizeQueryByAddons=function(t){var e=[];t.forEach((function(t){var n=t.key;Object.keys(t.query).forEach((function(r){var o=t.query[r];e.push({addonKey:n,key:r,value:o})}))}));return e};n.deepCopy=function(t){return JSON.parse(JSON.stringify(t))};n.wrapState=function(t){var e={};e[o.STATE_AP_KEY]=t;return e};n.unwrapState=function(t){return t&&t[o.STATE_AP_KEY]?t[o.STATE_AP_KEY]:null};n.createEvent=function(t){if("function"==typeof Event){return e=new Event(t)}var e;(e=document.createEvent("Event")).initEvent(t,!1,!1);return e};n.callConnectHost=function(e){t&&t.amd?t(["connect-host"],(function(t){e(t)})):e(window.connectHost)};n.log=function(t,e){e||(e="log");console[e].call(null,"Atlassian Connect JS History: ",t)};function r(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}var o=t("./constants");function s(t){return null==t||""===t?"":t.toString().replace(new RegExp("^"+o.ANCHOR_PREFIX),"")}function a(t){var e=t?t.split("="):[];e[0],e[1];if(2===e.length){return{key:e[0],value:e[1]}}return null}function i(t){return"key"in t&&"value"in t?[t.key,"=",t.value].join(""):null}},{"./constants":7}]},{},[1])(1)}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-extensions-v5', location = 'v5/js/core/connect-host-request.js' */
!function(e,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var a={exports:{}};t(a.exports);e.connectHostRequest=a.exports}}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,(function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.addRequestMarshal=function(e){if("function"!=typeof e)throw new Error("ACJS request marshal must be a function");o=e};e.default=void 0;e.removeRequestMarshal=function(){o=void 0};e.stripJWTUrls=r;const t=["status","statusText","responseText"],a=["status","statusText","response"],n=["Content-Type","ETag","Link","X-RateLimit-NearLimit","X-RateLimit-Reset","Retry-After"],s=["If-Match","If-None-Match","X-Atlassian-Force-Account-ID","X-Force-Accept-Language","Accept-Language","X-B3-TraceId","X-B3-SpanId","X-B3-Sampled"];let o;function r(e){return e.replace(/(http[s]?:\/\/[^"]*?&jwt=[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*.*?)\\"/gi,'\\"')}function c(e,s){const o={headers:{}};s?a.forEach((function(t){o[t]=e[t];if("response"===t)try{JSON.parse(e[t]);o[t]=r(e[t])}catch(e){}}),this):t.forEach((function(t){o[t]=e[t];if("responseText"===t)try{JSON.parse(e[t]);o[t]=r(e[t])}catch(e){}}),this);n.forEach((function(t){o.headers[t]=e.getResponseHeader(t)}),this);return o}function i(e,t,a){a._isBlob&&a.blob&&a.name?e.append(t,a.blob,a.name):e.append(t,a);return e}e.default={request(e,t){const a=function(){if(window.AJS&&window.AJS.contextPath)return window.AJS.contextPath();const e=document.querySelector("meta[name=ajs-context-path]");return e?e.getAttribute("content"):""}(),n={};t=arguments[arguments.length-1];const{addon_key:r,key:d,options:{allowPathTraversal:u,tracing:p},url:f}=t._context.extension;"string"==typeof e&&(e={url:e});const h=a+e.url;if(!u){if(!new URL(h,document.baseURI).pathname.startsWith(a)){window.connectHost&&window.connectHost.trackAnalyticsEvent&&window.connectHost.trackAnalyticsEvent("jsapi.request.prevent-path-traversal",{addonKey:r,moduleKey:d,url:h});return t(`Request url must include context path '${a}'`,{})}}e.headers=e.headers||{};Object.getOwnPropertyNames(e.headers).forEach((function(t){n[t.toLowerCase()]=e.headers[t]}),this);function l(e,a,n){t(!1,c(n,x),e)}function y(e,a,n){t(n,c(e,x),n)}let m={url:h,type:e.type||"GET",data:e.data,dataType:"text",contentType:e.contentType,cache:void 0!==e.cache?!!e.cache:void 0,headers:{Accept:n.accept||"*/*","AP-Client-Key":r,"x-ecosystem-user-agent":"connect"}};const T="connect--".concat(d);m.headers["X-Atlassian-Capability"]=T;"multipart/form-data"===m.contentType&&(m=function(e){e.contentType=!1;e.processData=!1;if(!e.data||"object"!=typeof e.data)throw new Error("For a Multipart request, data must to be an Object");{let t=new FormData;Object.keys(e.data).forEach((function(a){const n=e.data[a];Array.isArray(n)?n.forEach((function(e,n){t=i(t,`${a}[${n}]`,e)})):t=i(t,a,n)}));e.data=t;e.headers["X-Atlassian-Token"]="no-check"}return e}(m));m.data&&"object"==typeof m.data&&"GET"===m.type.toUpperCase()&&Object.keys(m.data).forEach((function(e){m.url+=`${(m.url.indexOf("?")>=0?"&":"?")+encodeURIComponent(e)}=${encodeURIComponent(m.data[e])}`}));!0===e.experimental&&(m.headers["X-ExperimentalApi"]="opt-in");if(p){const{traceId:e,spanId:t,sampled:a}=p;m.headers["X-B3-TraceId"]=e;m.headers["X-B3-SpanId"]=t;m.headers["X-B3-Sampled"]=a}else if(f)try{const e=new URL(f),t=e.searchParams.get("traceId"),a=e.searchParams.get("spanId"),n=e.searchParams.get("traceSampled");m.headers["X-B3-TraceId"]=t;m.headers["X-B3-SpanId"]=a;m.headers["X-B3-Sampled"]=n}catch(e){}s.forEach((function(e){n[e.toLowerCase()]&&(m.headers[e]=n[e.toLowerCase()])}),this);m.cache||(m.url+=`${m.url.indexOf("?")>=0?"&":"?"}_r=${(new Date).getTime()}`);const w=new XMLHttpRequest;w.open(m.type,m.url,!0);var x=!1;if(e.binaryAttachment){x=!0;w.responseType="arraybuffer"}m.contentType&&(m.headers["Content-type"]=m.contentType);Object.getOwnPropertyNames(m.headers).forEach((e=>{w.setRequestHeader(e,m.headers[e])}));w.onload=function(){this.status>=200&&this.status<300?l(x?w.response:w.responseText,w.statusText,w):y(w,w.statusText,x?w.response:w.responseText)};w.onerror=function(){y(w,w.statusText,x?w.response:w.responseText)};try{let e=!0;o&&(e=o.call(null,m));if(!0===e)w.send(m.data||null);else{w.abort();y(w,0,e)}}catch(e){w.abort();y(w,0,e);console.error("ACJS Request: ",e.message,e)}}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-user-v5', location = 'v5/js/iframe/host/user.js' */
define("ac/user",(function(){return{getUser:function(e){var t=e._context.extension.options.user;e({fullName:void 0===t.uid&&void 0===t.ukey?null:AJS.Meta.get("remote-user-fullname")||AJS.Meta.get("current-user-fullname")||null,id:t.uid,key:t.ukey})},getCurrentUser:function(e){e({atlassianAccountId:AJS.Meta.get("atlassian-account-id")||null,accountType:AJS.Meta.get("account-type")||null})},getTimeZone:function(e){e(e._context.extension.options.user.timeZone)},getLocale:function(e){e(AJS.Meta.get("user-locale"))}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:content-resolver-v5', location = 'v5/js/iframe/host/content-resolver.js' */
!function(){function e(e){var t={};_.keys(e).forEach((function(n){t["ac."+n]=e[n]}));return t}function t(e){var t,n=e.getResponseHeader("Date"),o=Math.round(Date.parse(n)/1e3),r=Math.round(Date.now()/1e3);if(!isNaN(o)){t=Math.abs(r-o);window.connectHost.setJwtClockSkew(t+60)}}function n(n,o){return AJS.$.Deferred((function(r){var i=function(e){var t=e.addon_key+"__"+e.key;if(window._AP&&window._AP.cacheableIframeUrls&&window._AP.cacheableIframeUrls[t])return window._AP.cacheableIframeUrls[t]}(n);if(!i||o){var a={"plugin-key":n.addon_key,"product-context":JSON.stringify(n.options.productContext||{}),key:n.key,width:n.width||"100%",height:n.height||"100%",classifier:n.classifier||"raw"};n.options.contentClassifier&&(a.classifier=[n.options.contentClassifier,a.classifier]);var s,c,d=function(e,t){var n={};_.keys(e).forEach((function(o){t(o,e[o])&&(n[o]=e[o])}));return n}(n.options.customData||{},(function(e,t){return!_.isObject(t)&&(!("string"==typeof t||t instanceof String)||t.length<255)})),l=window.connectHost&&window.connectHost.trackContentResolverEvent,f=(s=n.addon_key,c=n.key,AJS.contextPath()+"/plugins/servlet/ac/"+encodeURIComponent(s)+"/"+encodeURIComponent(c));AJS.$.ajax(f,{dataType:"json"===n.classifier?"json":"html",data:AJS.$.extend({},a,e(d)),type:"POST"}).then((function(e,n,i){t(i);o?r.resolve(window._AP._convertConnectOptions(e)):require(["ac/create"],(function(t){r.resolve(window._AP._convertConnectOptions(e))}))})).fail((function(e,o,i){t(e);if(l&&e.status){var a={extension:n,attrs:{contentResolverUrl:f,httpStatusCode:e.status,errorText:i||e.statusText,responseText:"string"==typeof e.responseText?e.responseText.substring(0,1e3):"",traceId:e.getResponseHeader("atl-traceid")}};window.connectHost.trackContentResolverEvent(!1,a)}window.connectHost.getBooleanFeatureFlag("acjs_handle_dialog_content_resolver_errors",!0)&&window.connectHost.notifyContentResolverFailed(n);r.reject({addon_key:n.addon_key,key:n.key,options:n.options},{text:"Unable to retrieve addon module URL. Please check your specified module key.",traceId:e.getResponseHeader("atl-traceid")})}))}else r.resolve(window._AP._convertConnectOptions({addon_key:n.addon_key,key:n.key,url:i,productCtx:JSON.stringify(n.options.productContext||{})}))})).promise()}function o(e){return function(t){if("set_inner_iframe_url"===t.data.type){t.data.iframeData.classifier="json";return n(t.data.iframeData,!0).then((function(n){n.id=t.data.extension_id;e.registerExistingExtension(n.id,{extension:n});t.source.location=n.url}))}}}define("ac/content-resolver",(function(){return{resolveByExtension:n,getIframeUrlSetter:o}}));_AP.util.awaitGlobal("connectHost",(function(e){e.registerContentResolver.resolveByExtension(n);window.addEventListener("message",o(e))}))}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-context-v5', location = 'v5/js/context/util.js' */
define("ac/context/util",(function(){return{isValidExtensionOptionsForCache:function(t){var e=(!t.contextJwt||!connectHost.isJwtExpired(t.contextJwt,!0))&&!!t.structuredContext;if(e){var n=t.productContext&&Object.getOwnPropertyNames(t.productContext).length>0,o=Object.getOwnPropertyNames(t.structuredContext).length>0;!n||o||(e=!1)}return e},isLiveDoc:function(){return document.querySelectorAll('[data-content-subtype="live"]').length>0}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-context-v5', location = 'v5/js/context/main.js' */
define("ac/context",["ac/content-resolver","ac/context/util"],(function(t,n){var e={};function o(t){if(t.id&&t.id.length>1)return t.id;throw new Error("ACJS: cannot generate cache key for extension")}function i(t,n){var o=e[t].context.contextObj;o.confluence&&o.confluence.content&&(o.confluence.content.subtype=n?"live":"");return o}function c(t,n){return{cachedAt:Date.now(),contextJwt:n,contextObj:t}}function r(n){var i=o(n);if(!e[i]||!e[i].promise&&e[i].context&&3e4+e[i].context.cachedAt<Date.now()){n.classifier="json";e[i]=e[i]||{};e[i].promise=t.resolveByExtension(n,!0).done((function(t){t&&(e[i].context=c(t.options.structuredContext,t.options.contextJwt))}))}}function s(t){if(!t||t.length<2)throw new Error("ACJS: Cannot get token. Add-on does not support JWT authentication")}function x(t){if(n.isValidExtensionOptionsForCache(t.extension.options)){var i=o(t.extension);e[i]={context:c(t.extension.options.structuredContext,t.extension.options.contextJwt)}}else r(t.extension)}_AP.util.awaitGlobal("connectHost",(function(t){t.onIframeEstablished(x);t.onIframeUnload((function(t){delete e[o(t.extension)]}))}));var a={getToken:function(t){return new Promise((function(n,i){var c=o(t._context.extension);r(t._context.extension);if(e[c].promise)e[c].promise.done(function(t){s(t.options.contextJwt);try{n(t.options.contextJwt)}catch(t){}}.bind(this)).fail((function(){i("ACJS: content resolver failed to get context jwt token")})).always(function(){delete e[c].promise}.bind(this));else{s(e[c].context.contextJwt);n(e[c].context.contextJwt)}}))},getContext:function(t){return new Promise((function(c,s){var x=n.isLiveDoc(),a=o(t._context.extension);t._context.extension.addon_key;r(t._context.extension);e[a].promise?e[a].promise.done(function(t){try{c(i(a,x))}catch(t){}}.bind(this)).fail((function(){s("ACJS: content resolver failed to get context")})).always(function(){delete e[a].promise}.bind(this)):c(i(a,x))}))}};a.getContext.returnsPromise=!0;a.getToken.returnsPromise=!0;return a}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:module-loader-v5', location = 'v5/js/iframe/host/module-loader.js' */
_AP.util.awaitGlobal("connectHost",(function(e){e.defineModule("cookie",connectHostCookie);e.defineModule("history",connectHostHistory);e.defineModule(connectHostRequest.default);e.defineModule("navigator",require("ac/navigator/module"));e.defineModule("user",require("ac/user"));e.defineModule("context",require("ac/context"))}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-insertion-v5', location = 'v5/js/iframe/combined/iframe-insertion.js' */
!function(){var e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,50)},t=function(e,o,n){try{var i=require(e);o(i)}catch(i){if(n<=0){console.error("Unable to load module: "+e);o(null)}else setTimeout((function(){t(e,o,n-1)}),500)}},o=function(e,t,n,i,a){void 0===i&&(i=20);a=a||500;!e.isModuleDefined||i<=0?n():e.isModuleDefined(t)?n(!0):setTimeout((function(){o(e,t,n,i-1,a)}),a)};function n(e){var t;if("string"==typeof e&&e.length>1)try{t=JSON.parse(e)}catch(t){console.error("ACJS: failed to decode context",e)}"object"!=typeof t&&(t={});return t}window._AP=window._AP||{};window._AP.addonAttemptCounter=window._AP.addonAttemptCounter||{};window._AP._convertConnectOptions=function(e){var t={url:e.url,ns:e.uniqueKey,addon_key:e.addon_key,key:e.key,containerId:"embedded-"+e.uniqueKey,options:{history:{state:""},uniqueKey:e.uniqueKey,origin:e.origin,hostOrigin:e.hostOrigin,moduleType:e.moduleType,moduleLocation:e.moduleLocation,isFullPage:"1"===e.general,autoresize:!0,user:{timeZone:e.timeZone,fullName:e.fullName,uid:e.uid,ukey:e.ukey},productContext:n(e.productCtx),structuredContext:n(e.structuredContext),contextJwt:e.contextJwt,contextPath:e.cp,width:e.w||e.width,height:e.h||e.height,sandbox:e.sandbox,pearApp:e.pearApp,noSub:e.noSub,allowPathTraversal:e.allowPathTraversal,targets:{env:{resize:"both"}}}};"string"==typeof e.contentClassifier&&(t.options.contentClassifier=e.contentClassifier);"number"==typeof e.hostFrameOffset&&(t.options.hostFrameOffset=e.hostFrameOffset+1);window._AP.isSubHost||(t.options.history.state=window.location.hash?window.location.hash.substr(2):"");return t};window._AP._createSub=function(e){var t=document.createElement("iframe"),o=(window.connectHost||window.AP).subCreate(e);o.width=e.options.width||"";o.height=e.options.height||"";o.style="border:0;";o.class="ap-iframe";o["data-addon-key"]=e.addon_key;o["data-key"]=e.key;delete o.src;Object.getOwnPropertyNames(o).forEach((function(e){t.setAttribute(e,o[e])}));return t};function i(e){return void 0!==window[e]}function a(e,t,o){o=o||100;if(i(e))t(window[e]);else var n=setInterval((function(){if(i(e)){clearInterval(n);t(window[e])}}),o)}function d(e){window._AP.isSubHost=function(e,t){if("number"!=typeof e)return window.top;for(var o=t||window,n=0;n<e;n++)o=o.parent;return o}(e.hostFrameOffset)!==window;var t=window._AP._convertConnectOptions(e);window._AP.addonAttemptCounter[t.containerId]=0;if(window._AP.isSubHost){window.AP&&window.AP._data&&window.AP._data.options&&window.AP._data.options.globalOptions&&(t.options.globalOptions=window.AP._data.options.globalOptions);const e=window.AP&&window.AP._data&&window.AP._data.options&&window.AP._data.options.productContext?window.AP._data.options.productContext:{};t.options.productContext=function(e,t){const o={};["content.id","issue.id","issue.key","page.id","project.id","project.key","space.id","space.key"].forEach((t=>{e[t]&&(o[t]=e[t])}));return Object.assign({},o,t)}(e,t.options.productContext);r(window._AP._createSub(t),t)}else a("connectHost",(function(e){var o,n;(o=e,n={addon_key:t.addon_key,key:t.key},o.getExtensions(n).filter((function(e){return Boolean(document.getElementById(e.extension_id))}))).forEach((function(o){if(o.extension.options.uniqueKey===t.options.uniqueKey){var n=document.getElementById(o.extension_id);e.destroy(o.extension_id);n&&AJS.$(n).closest(".ap-iframe-container").remove()}}),this);r(e.create(t),t)}))}function r(t,o){var n=document.getElementById(o.containerId);window._AP.addonAttemptCounter[o.containerId]++;if(n){delete window._AP.addonAttemptCounter[o.containerId];if(window._AP.isSubHost){n.appendChild(t);!function(e,t){var o=e.contentDocument,n={type:"set_inner_iframe_url",iframeData:t,extension_id:JSON.parse(e.name).extension_id},i="(function(){ var w = window; for (var i=0; i<"+t.options.hostFrameOffset+"; i++){w = w.parent; } w.postMessage("+JSON.stringify(n)+', "*");}());';o.open();o.write("<script>"+i+"<\/script>");o.close()}(t,o)}else{var i=n.querySelector(".ap-iframe-container");if(i){i.parentNode.removeChild(i);AJS.log&&AJS.log("AJS: duplicate iframe removed",o,n)}t.appendTo(n);t.data("addon-key",o.addon_key);t.data("key",o.key)}}else window._AP.addonAttemptCounter[o.containerId]<=10&&e((function(){r(t,o)}))}window._AP.appendConnectAddon=function(e){var n=!1;try{window.top.karma&&(n=!0)}catch(e){}void 0===e.hostFrameOffset&&void 0!==window.connectHostFrameOffset&&(e.hostFrameOffset=window.connectHostFrameOffset);window.AJS&&window.AJS.Confluence?-1!==window.name.indexOf("embedded-confluence-iframe")&&(e.hostFrameOffset=0):window.connectHost&&!window.AP&&(e.hostFrameOffset=0);if(window===window.top||n||void 0!==e.hostFrameOffset){/^com\.atlassian\.(jira|confluence)\.emcee($|\.local|\.staging|\.development\..*)/g.test(e.addon_key)?t("ac/marketplace",(function(t){t&&a("connectHost",(function(e){e.defineModule("marketplace",t)}));d(e)}),20):"com.addonengine.analytics"===e.addon_key?a("connectHost",(function(t){o(t,"analytics",(function(){d(e)}))})):d(e)}else{var i=function(t){if(t.source===window.top&&t.data&&void 0!==t.data.hostFrameOffset){window.removeEventListener("message",i);e.hostFrameOffset=t.data.hostFrameOffset;d(e)}};window.addEventListener("message",i);window.top.postMessage({type:"get_host_offset"},"*")}}}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js-v5', location = 'v5/js/iframe/host/main.js' */
_AP.addonAttemptCounter={};_AP.util.awaitGlobal("connectHost",(function(n){n.setExtensionConfigurationOptions("crev",window._AP.allJsVersion);n.setExtensionConfigurationOptions("resolve_inner_iframe_url",!0);n.onIframeEstablished((function(n){n.$el.closest(".ap-iframe-container").addClass("iframe-init")}));n.onFrameClick((function(n){n.click()}))}));define("ac/create",(function(){return{appendConnectAddon:function(n){return window._AP.appendConnectAddon(n)}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-content-property-api-v5', location = 'v5/js/confluence/contentproperty/content-property.js' */
!function(t,e){"use strict";e("ac/confluence/content-property",["confluence/root","ajs"],(function(t,e){function n(e){return"/rest/api/content/"+t.getContentId()+"/property/"+e}function o(t){e.log(t);e.flag({type:"error",title:t,body:"<p>There was a problem communicating with the server. Please refresh the page and try again</p>"})}function r(t,e){const r=n(t),c=function(n,r){let c;try{c=JSON.parse(r.responseText)}catch(t){n=t}n?404===r.status?e(null):o("Unable to check item state: "+t):e(c)};c._context=e._context;window.connectHostRequest.default.request({url:r},c)}function c(t,n){e.trigger("contentProperty.update",{contentProperty:t,extension:n})}return{getContentProperty:function(t,e){r(t,e)},syncPropertyFromServer:function(t,e){const n=function(t){c(t,e._context.extension);e(t)};n._context=e._context;r(t,n)},setContentProperty:function(t,r){c(t,r._context.extension);!function(t,r){var c=t.key,s={url:n(c),contentType:"application/json",data:JSON.stringify(t)};t.version&&t.version.number&&t.version.number>1?s.type="PUT":s.type="POST";const i=function(t,n){let i;try{i=JSON.parse(n.responseText)}catch(e){t=e}if(t){r({error:n.statusText});o("Unable to "+s.type+" item: "+c)}else{e.log("contentProperty "+c+" "+s.type+" successful");r(i)}};i._context=r._context;window.connectHostRequest.default.request(s,i)}(t,r)}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/utils.js' */
define("ac/confluence/utils",["document"],(function(t){"use strict";return{isFabricEditor:function(){return t.querySelectorAll("[data-fabric-mode]").length>0},getContentType:function(t,n,e){var o=JSON.stringify({contentIds:[n]});t.ajax({url:AJS.contextPath()+"/api/v2/content/convert-ids-to-types",method:"POST",contentType:"application/json",data:o}).done((function(t){t.results&&t.results[n]?e(t.results[n]):AJS.error("Content type not found for content ID: "+n)})).fail((function(){AJS.error("Failed to get content type for content ID: "+n)}))},isCustomContent:function(t){return/^(ac:|forge:)/.test(t)}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-api-v5', location = 'v5/js/confluence/macro/macro.js' */
define("ac/confluence/macro",["confluence/root","ajs","ac/confluence/utils"],(function(o,e,r){const a=e.$;var t=void 0,n={};function c(){var o=require("confluence-macro-browser/macro-browser");void 0===o&&(o={getMacroName:function(o){},getMacroParams:function(o){},getMacroBody:function(){throw new Error("confluence-macro-browser/macro-browser is unavailable")}});return o}function i(o){const e=o.indexOf("=");if(e>0){return{key:o.slice(0,e),value:o.slice(e+1)}}return{}}function s(o){return o.split("|").reduce((function(o,e){const r=i(e);r.key&&(o[r.key]=r.value);return o}),{})}return{convertRawParamToObject:i,convertRawParamSeriesToObject:s,getMacroBody:function(o){var r=o._context.extension.options.productContext["macro.id"],t=a('[data-macro-body][data-fabric-macro="'+r+'"]');if(t.length)o(t.attr("data-macro-body")||"");else if(!n||"string"!=typeof n.body&&!Array.isArray(n.body))try{var i=c().getMacroBody(),s=a(a.parseXML('<root xmlns:ac="guid">'+i+"</root>")).find("[ac\\:macro-id='"+r+"']");if(1==s.length){o(s.html().replace('xmlns:ac="guid"',""));return}o(i);return}catch(a){var u=o._context.extension.options.productContext;if("false"===u["macro.truncated"]){o(u["macro.body"]);return}var d=u["page.id"],m=u["page.version"];e.$.ajax({url:e.contextPath()+"/rest/api/content/"+d+"/history/"+m+"/macro/id/"+r,dataType:"json",success:function(e){o(e.body)}})}else o(n.body)},closeCurrentMacroPropertyPanel:function(){e.Confluence.PropertyPanel.destroy()},setLastSelectedConnectMacroNode:function(o){n.locationToInsert=void 0;n.params=void 0;n.body=void 0;n.name=void 0;var e=c().getMacroName(o);t=void 0!==e?o:void 0},setUnsavedMacroData:function(o,e,r,a){n.body=e;n.params=r;n.locationToInsert=a;n.name=o},clearMacroDataParams:function(){n.params=null},getMacroData:function(o){var e=o._context.extension.options.productContext["macro.id"],r=a('[data-fabric-macro="'+e+'"]');if(r.length)o(JSON.parse(r.attr("data-macro-parameters")||"{}"));else if(void 0===t&&n.params)o(n.params);else if(t)o(c().getMacroParams(t));else{o(s(o._context.extension.options.productContext[": = | RAW | = :"]||""))}},getCurrentMacroParameters:function(){return void 0===t?n.params:c().getMacroParams(t)},saveMacro:function(){return tinymce.confluence.MacroUtils.updateMacro.apply(this,arguments)},saveCurrentMacro:function(a,i){if(r.isFabricEditor()){return require("confluence-macro-browser/macro-browser-facade").insert({name:n.name,params:a,body:i})}if(void 0===t){n.params=a;n.body=i;var s={contentId:o.getContentId(),macro:{name:n.name,params:n.params,body:null===n.body?"":n.body}};e.Rte.getEditor().selection.moveToBookmark(n.locationToInsert);return tinymce.confluence.MacroUtils.insertMacro(s).done((function(o){t=o}))}var u=c().getMacroName(t);if(void 0!==u)return tinymce.confluence.MacroUtils.updateMacro(a,i,u,t).done((function(o){t=o}))}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-v5', location = 'v5/js/confluence/macro/bookmark.js' */
!function(o,e){e("ac/confluence/macro/bookmark",["ajs"],(function(o){var e;return{createBookmark:function(){return e=o.Rte.getEditor().selection.getBookmark()},destroyBookmark:function(){if(e){e.keep=!1;o.Rte.getEditor().selection.moveToBookmark(e);e=null}}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-v5', location = 'v5/js/confluence/macro/editor.js' */
!function(e,t){t("ac/confluence/macro/editor",["ac/confluence/macro","ac/confluence/macro/bookmark","ajs","ac/confluence/utils"],(function(t,o,a,n){var r;return{close:function(){connectHost.dialog.close()},getMacroData:function(e){const o=t.getCurrentMacroParameters();if(o)return e(o);var a=e._context.extension.options.productContext["macro.id"];return e(t.getMacroData(a))},getMacroBody:function(e){return e(r)},openCustomEditor:function(c,i){var d;if(!n.isFabricEditor()){a.Rte.getEditor().focus();var s=a.Rte.getEditor().selection.getNode();d=o.createBookmark();t.setLastSelectedConnectMacroNode(s)}t.setUnsavedMacroData(c.name,c.body?c.body:"",c.params,d);r=c.body;var u=a.Meta.get("page-id")||"undefined";"undefined"===u&&(u="0");var l=e.extend(c.productContext||{},{"page.id":u}),f={addon_key:i.addonKey,key:c.name,options:{productContext:l}},m=i.width||null,g=i.height||null,p={header:c.params?i.editTitle:i.insertTitle,submitText:c.params?"Save":"Insert",width:m,height:g,onHide:function(){o.destroyBookmark();t.clearMacroDataParams()}};"100%"!==m&&"100%"!==g&&(p.chrome=!0);connectHost.dialog.create(f,p)}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-v5', location = 'v5/js/confluence/macro/property-panel-iframe.js' */
!function(e,n){n("ac/confluence/macro/property-panel-iframe",["ac/confluence/macro","ajs"],(function(n,a){return function(t){return{propertyPanelIFrameInjector:function(o){var c={classifier:"property-panel","page.id":a.Meta.get("page-id")},r=a.Rte.getEditor().selection;n.setLastSelectedConnectMacroNode(r.getNode());e.ajax(t,{data:c}).done((function(n){var a=e(n);a.css("display","none");o.panel.append(a)}))}}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-v5', location = 'v5/js/confluence/macro/property-panel-controls.js' */
!function(n,t){t("ac/confluence/macro/property-panel-controls",["underscore"],(function(n){return function(t){var c;return{getControls:function(r){r(c=c||function(c){try{return n.first(n.filter(n.pluck(c,t),n.isObject))}catch(n){return null}}(WRM.data.claim("com.atlassian.plugins.atlassian-connect-plugin:confluence-macro.property-panel-controls")))}}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-macro-v5', location = 'v5/js/confluence/macro/property-panel-event.js' */
!function(n,e){e("ac/confluence/macro/property-panel-event",[],(function(){var e,t=[],r=function(n,e,t){connectHost.broadcastEvent(n,(function(n){return-1!==n.extension_id.indexOf(e)}));t()};return{waitForPropertyPanelEventBindings:function(){e=!1;t=[]},propertyPanelEventsBound:function(){e=!0;for(;t.length>0;){var n=t.shift();r(n.eventKey,n.macroName,n.doneCallback)}},handlePropertyPanelEvent:function(o,c,a){var i=n.Deferred();if("click"===o){var u=function(n,e){return"click."+n+"."+e+".macro.property-panel"}(c,a);e?r(u,a,i.resolve):function(n,e,r){t.length<10&&t.push({eventKey:n,macroName:e,doneCallback:r})}(u,a,i.resolve)}return i},_getQueueLength:function(){return t.length}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-navigator-routes-v5', location = 'v5/js/confluence/navigator/routes.js' */
!function(e,t){"use strict";t(["ac/navigator/routes","ac/navigator/utils","ac/confluence/utils"],(function(t,n,o){var a=["page","blogpost","whiteboard"],r={page:"/api/v2/pages/",blogpost:"/api/v2/blogposts/",whiteboard:"/api/v2/whiteboards/",database:"/api/v2/databases/",embed:"/api/v2/embeds/",folder:"/api/v2/folders/"},i=AJS.contextPath(),s=(AJS.Meta.get("enabled-dark-features"),n.hasContext),c=n.appendQueryParam,d={dashboard:"",contentedit:function(e,t){s(e,"contentId")&&p(e.contentId,(function(e){var n=e.contentType;u(n)?t(i+"/display/"+e.space.key+"/customcontent/edit/"+e.id):!function(e){return-1!==a.indexOf(e)}(n)?AJS.error('Cannot navigate to "contentedit" target for content (ID='+e.id+"). Content type <"+n+"> is not supported."):t(i+e._links.editui)}))},spacetools:"/spaces/viewspacesummary.action?key={spaceKey}",spaceview:"/spaces/{spaceKey}",userprofile:function(e,t){var n;s(e,"userAccountId")?n="/people/"+e.userAccountId:s(e,"username")&&(n=i+"/display/~"+e.username);n&&t(n)},contentview:function(e,t){s(e,"contentId")&&p(e.contentId,(function(n){!function(e,t,n){var o=i+e._links.webui;s(t,"versionOverride")&&(o=c(o,"versionOverride",t.versionOverride));s(t,"embeddedContentRender")&&(o=c(o,"embeddedContentRender",t.embeddedContentRender));o&&n(o)}(n,e,t)}))},contentlist:function(e,t){var n=encodeURIComponent(e.spaceKey),o=e.contentType;"page"===o?t(i+"/spaces/"+n+"/pages"):"blogpost"===o?t(i+"/spaces/"+n+"/blog"):u(o)?t(i+"/display/"+n+"/customcontent/list/"+encodeURIComponent(o)):AJS.error('Cannot navigate to "contentlist" target for content type <'+o+">")}};t.addRoutes(d);n.enableApi();function p(t,n){try{o.getContentType(e,t,(function(o){var a;if(u(o))a=i+"/api/v2/custom-content/"+t+"/";else{if(!r[o]){AJS.error("Unsupported content type for V2 API: "+o);return}a=i+r[o]+t+"/"}e.ajax({url:a,dataType:"json"}).done((function(e){e.contentType=o;n(e)})).fail((function(){AJS.error("Content not found (ID="+t+")")}))}))}catch(e){AJS.error("Error getting content type for V2 API: "+e.message)}}function u(e){return/^(ac:|forge:)/.test(e)}}))}(AJS.$,require);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-navigator-routes-v5', location = 'v5/js/confluence/navigator/context.js' */
!function(t,n){"use strict";n(["ac/navigator/context","confluence/api/navigator-context"],(function(t,n){t.setContextFunction(n.getCurrent)}))}(AJS.$,require);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-content-property2-api-v5', location = 'v5/js/confluence/contentproperty/content-property-v2.js' */
!function(t,e){"use strict";e("ac/confluence/content-property-v2",["confluence/root","ajs","ac/confluence/utils"],(function(e,n,o){function r(r){var c=e.getContentId();try{o.getContentType(t,c,(function(t){var e;e=o.isCustomContent&&o.isCustomContent(t)?"/api/v2/custom-content/"+c+"/properties":"/api/v2/"+t+"s/"+c+"/properties";r(e)}))}catch(t){n.error("Error getting content type for V2 API: "+t.message);r(null)}}function c(t){n.log(t);n.flag({type:"error",title:t,body:"<p>There was a problem communicating with the server. Please refresh the page and try again</p>"})}function s(t,e){r((function(n){if(!n){e(null);return}const o=function(n,o){let r;try{r=JSON.parse(o.responseText)}catch(t){n=t}n?404===o.status?e(null):c("Unable to check item state: "+t):e(r)};o._context=e._context;window.connectHostRequest.default.request({url:n+"/"+t},o)}))}function i(t,e){n.trigger("contentProperty.update",{contentProperty:t,extension:e})}return{getContentPropertyV2:function(t,e){s(t,e)},syncPropertyFromServerV2:function(t,e){const n=function(t){i(t,e._context.extension);e(t)};n._context=e._context;s(t,n)},postPropertyToServerV2:function(t,e){!function(t,e){r((function(o){if(!o){e({error:"Unable to get property URL"});return}var r={url:o,contentType:"application/json",data:JSON.stringify(t),type:"POST"};const s=function(o,s){let i;try{i=JSON.parse(s.responseText)}catch(t){o=t}if(o){e({error:s.statusText});c("Unable to "+r.type+" item: "+t.key)}else{n.log("contentProperty "+t.key+" "+r.type+" successful");e(i)}};s._context=e._context;window.connectHostRequest.default.request(r,s)}))}(t,e);i(t,e._context.extension)},updatePropertyToServerV2:function(t,e,o){!function(t,e,o){r((function(r){if(!r){o({error:"Unable to get property URL"});return}var s={url:r+"/"+t,contentType:"application/json",data:JSON.stringify(e),type:"PUT"};const i=function(e,r){let i;try{i=JSON.parse(r.responseText)}catch(t){e=t}if(e){o({error:r.statusText});c("Unable to "+s.type+" item: "+t)}else{n.log("contentProperty "+t+" "+s.type+" successful");o(i)}};i._context=o._context;window.connectHostRequest.default.request(s,i)}))}(t,e,o);i(e,o._context.extension)}}}))}(AJS.$,define);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-customcontent-v5', location = 'v5/js/confluence/customcontent/custom-content-api.js' */
define("ac/confluence/custom-content-api",[],(function(){var e="confluence.customcontent.submit",t={},n={};function o(e){return function(o,c){if(t[e]&&n[e]){var r,u=n[e];clearTimeout(u.timeout);delete n[e];try{!1===o?u.reject((r=c,"[object String]"===Object.prototype.toString.call(r)?c:"")):u.proceed(o)}finally{u.done&&u.done()}}else AJS.error("Event callback for "+e+" has been invoked before a event happens.")}}function c(){}c.prototype.intercept=function(e){t[e]=!0};c.prototype.submitCallback=o(e);c.prototype.submitErrorCallback=o("confluence.customcontent.submitError");c.prototype.submitSuccessCallback=o("confluence.customcontent.submitSuccess");c.prototype.cancelCallback=o("confluence.customcontent.cancel");return{trigger:function(o,c,r,u,i){if(!t[o]){if(o===e)throw new Error("Add-on must intercept confluence.customcontent.submit event");return r()}n[o]&&clearTimeout(n[o].timeout);n[o]={proceed:r,reject:u,done:i,timeout:setTimeout((function(){delete n[o];AJS.error("Event handler for "+o+" did not call callback function in 10000ms.");u("Timed out when waiting for callback of "+o+" event.")}),1e4)};connectHost.broadcastEvent(o,{},c)},EditComponent:c}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-spa-inlinedialog-cleanup', location = 'v5/js/iframe/host/spa-inline-dialog-cleanup.js' */
require(["skate"],(function(e){e("ap-inline-dialog",{type:function(){var i;(i=e&&e.types&&e.types.CLASS)||(i=e&&e.type&&e.type.CLASSNAME);return i}(),detached:function(e){var i=document.querySelectorAll('iframe[id^="'+window._AP.util.escapeSelector(e.id)+'"]');[].forEach.call(i,(function(e){AJS.$(e).parents(".aui-inline-dialog").remove()}))}})}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-request-marshal-v5', location = 'v5/js/confluence/request-marshal/request-marshal.js' */
define("ac/confluence/request-marshal",(function(){var n=["/api/","/rest/","/rpc/","/download/","/images/","/plugins/"];return{getWhitelist:function(){return n},marshal:function(t){var e=!1;n.forEach((function(n){0===t.url.indexOf(AJS.contextPath()+n)&&(e=!0)}),this);if(!e){let n="";try{n=new window.URL(t.url,window.location.origin).pathname}catch(n){}window.connectHost.trackAnalyticsEvent("jsapi.request.filter",{value:e,url:n})}return!0}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-request-marshal-v5', location = 'v5/js/confluence/request-marshal/request-marshal-loader.js' */
require(["ac/confluence/request-marshal"],(function(e){connectHostRequest.addRequestMarshal(e.marshal)}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-product-extensions-v5', location = 'v5/js/confluence/main.js' */
define("ac/confluence",["ac/confluence/macro/editor","ac/confluence/macro","ac/confluence/macro/property-panel-event","ac/confluence/content-property","ac/confluence/content-property-v2"],(function(e,r,o,t,n){return{saveMacro:r.saveCurrentMacro,closeMacroEditor:e.close,getMacroData:r.getMacroData,getMacroBody:r.getMacroBody,onMacroPropertyPanelEvent:o.propertyPanelEventsBound,closeMacroPropertyPanel:r.closeCurrentMacroPropertyPanel,getContentProperty:t.getContentProperty,setContentProperty:t.setContentProperty,syncPropertyFromServer:t.syncPropertyFromServer,getContentPropertyV2:n.getContentPropertyV2,syncPropertyFromServerV2:n.syncPropertyFromServerV2,postPropertyToServerV2:n.postPropertyToServerV2,updatePropertyToServerV2:n.updatePropertyToServerV2}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-product-extensions-v5', location = 'v5/js/confluence/custom-content.js' */
define("ac/customContent",["ac/confluence/custom-content-api"],(function(t){return{getEditComponent:{constructor:t.EditComponent,intercept:t.EditComponent.prototype.intercept,submitCallback:t.EditComponent.prototype.submitCallback,submitErrorCallback:t.EditComponent.prototype.submitErrorCallback,submitSuccessCallback:t.EditComponent.prototype.submitSuccessCallback,cancelCallback:t.EditComponent.prototype.cancelCallback}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:confluence-module-loader-v5', location = 'v5/js/confluence/module-loader.js' */
_AP.util.awaitGlobal("connectHost",(function(e){e.defineModule("confluence",require("ac/confluence"));e.defineModule("custom-content",require("ac/customContent"));e.defineModule("customContent",require("ac/customContent"))}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5', location = 'v5/js/confluence/macro/metadata-cache.js' */
define("ac/confluence/macro/metadata-cache",[],(function(){var a={};return{getMetaData:function(t){if(a.hasOwnProperty(t))return a[t];var e=WRM.data.claim(t);a[t]=e;return e},setMetaData:function(t,e){a[t]=e}}}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5', location = 'v5/js/confluence/macro/macro-preview-override-no-transformer.js' */
AJS.bind("init.rte",(function(){require(["ac/confluence/macro/editor","confluence/macro-js-overrides","ac/confluence/macro/metadata-cache","ajs"],(function(e,a,r,n){const t=n.$;function c(e){var a=document.createElement("div");a.innerHTML=e;var r=a.getElementsByClassName("ap-container");if(r.length)return r[0].outerHTML}var o=r.getMetaData("com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5.macroPreviewData"),i=r.getMetaData("com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5.editorData");for(var s in o)o.hasOwnProperty(s)&&a.assignFunction(s,{updateMacroPreviewIframe:function(e){return function(a,r,o){var s=t(r).parent(),u=c(o);if(u){s.empty();s.html(i.hasOwnProperty(e)?"":u);s.find(".ap-container").addClass("ac-macro-preview-override");n.trigger("macro-browser.preview-ready");return!0}return!1}}(s)})}))}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5', location = 'v5/js/confluence/macro/property-panel-override-no-transformer.js' */
require(["ac/confluence/macro/property-panel-controls","ac/confluence/macro/property-panel-iframe","ac/confluence/macro/property-panel-event","confluence/macro-js-overrides","ac/confluence/macro/metadata-cache"],(function(n,a,e,c,o){AJS.bind("init.rte",(function(){var r=o.getMetaData("com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5.propertyPanelData");for(var t in r)if(r.hasOwnProperty(t)){!function(o,r){c.assignFunction(o,a(r));c.assignFunction(o,n(o));c.assignFunction(o,e)}(t,AJS.params.contextPath+r[t].URL)}}))}));
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5', location = 'v5/js/confluence/macro/editor-override-no-transformer.js' */
!function(){function e(e){e=e||{};require(["wrm","ac/confluence/macro/editor","confluence/macro-js-overrides","ac/confluence/macro/metadata-cache"],(function(t,n,r,i){var a="com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5.editorData";function o(){var t=i.getMetaData(a);for(var o in t)if(t.hasOwnProperty(o)){var c=t[o];!function(e,t){r.assignFunction(e,{opener:function(r){r=Object.assign({name:e},r);n.openCustomEditor(r,t)}})}(o,{width:c.WIDTH,height:c.HEIGHT,addonKey:c.ADDON_KEY,editTitle:c.EDIT_TITLE,insertTitle:c.INSERT_TITLE,url:AJS.params.contextPath+c.URL})}e.trigger&&"function"==typeof e.trigger&&e.trigger()}if(e.forceRequire){t.forceRequire("wr!com.atlassian.plugins.atlassian-connect-plugin:macro-editor-resources-v5",{contexts:["editor"]},(function(e){try{var n=JSON.parse(t._unparsedData[a]);i.setMetaData(a,n)}catch(e){console.warn(e)}o()}))}else o()}))}AJS.bind("init.rte",(function(){e()}));AJS.bind("reset.rte",(function(t){e({forceRequire:!0,trigger:function(){AJS.trigger("reset.complete")}})}))}();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:moment', location = 'includes/js/dist/moment.js' */
(function(h,A){"object"===typeof exports&&"undefined"!==typeof module?module.exports=A():"function"===typeof define&&define.amd?define(A):h.moment=A()})(this,function(){function h(){return rb.apply(null,arguments)}function A(a){return a instanceof Array||"[object Array]"===Object.prototype.toString.call(a)}function ba(a){return null!=a&&"[object Object]"===Object.prototype.toString.call(a)}function r(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function Pa(a){if(Object.getOwnPropertyNames)return 0===
Object.getOwnPropertyNames(a).length;for(var b in a)if(r(a,b))return!1;return!0}function C(a){return void 0===a}function W(a){return"number"===typeof a||"[object Number]"===Object.prototype.toString.call(a)}function na(a){return a instanceof Date||"[object Date]"===Object.prototype.toString.call(a)}function sb(a,b){var c=[],d,e=a.length;for(d=0;d<e;++d)c.push(b(a[d],d));return c}function X(a,b){for(var c in b)r(b,c)&&(a[c]=b[c]);r(b,"toString")&&(a.toString=b.toString);r(b,"valueOf")&&(a.valueOf=
b.valueOf);return a}function K(a,b,c,d){return tb(a,b,c,d,!0).utc()}function m(a){null==a._pf&&(a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1});return a._pf}function Qa(a){var b=null,c=!1;if(c=a._d&&!isNaN(a._d.getTime()))b=m(a),c=ub.call(b.parsedDateParts,function(a){return null!=a}),c=0>b.overflow&&!b.empty&&
!b.invalidEra&&!b.invalidMonth&&!b.invalidWeekday&&!b.weekdayMismatch&&!b.nullInput&&!b.invalidFormat&&!b.userInvalidated&&(!b.meridiem||b.meridiem&&c),a._strict&&(c=c&&0===b.charsLeftOver&&0===b.unusedTokens.length&&void 0===b.bigHour);if(null!=Object.isFrozen&&Object.isFrozen(a))return c;a._isValid=c;return a._isValid}function xa(a){var b=K(NaN);null!=a?X(m(b),a):m(b).userInvalidated=!0;return b}function Ra(a,b){var c,d,e,n=vb.length;C(b._isAMomentObject)||(a._isAMomentObject=b._isAMomentObject);
C(b._i)||(a._i=b._i);C(b._f)||(a._f=b._f);C(b._l)||(a._l=b._l);C(b._strict)||(a._strict=b._strict);C(b._tzm)||(a._tzm=b._tzm);C(b._isUTC)||(a._isUTC=b._isUTC);C(b._offset)||(a._offset=b._offset);C(b._pf)||(a._pf=m(b));C(b._locale)||(a._locale=b._locale);if(0<n)for(c=0;c<n;c++)d=vb[c],e=b[d],C(e)||(a[d]=e);return a}function oa(a){Ra(this,a);this._d=new Date(null!=a._d?a._d.getTime():NaN);this.isValid()||(this._d=new Date(NaN));!1===Sa&&(Sa=!0,h.updateOffset(this),Sa=!1)}function H(a){return a instanceof
oa||null!=a&&null!=a._isAMomentObject}function wb(a){!1===h.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+a)}function E(a,b){var c=!0;return X(function(){null!=h.deprecationHandler&&h.deprecationHandler(null,a);if(c){var d=[],e,n,q,f=arguments.length;for(n=0;n<f;n++){e="";if("object"===typeof arguments[n]){e+="\n["+n+"] ";for(q in arguments[0])r(arguments[0],q)&&(e+=q+": "+arguments[0][q]+", ");e=e.slice(0,-2)}else e=arguments[n];d.push(e)}wb(a+
"\nArguments: "+Array.prototype.slice.call(d).join("")+"\n"+Error().stack);c=!1}return b.apply(this,arguments)},b)}function xb(a,b){null!=h.deprecationHandler&&h.deprecationHandler(a,b);yb[a]||(wb(b),yb[a]=!0)}function L(a){return"undefined"!==typeof Function&&a instanceof Function||"[object Function]"===Object.prototype.toString.call(a)}function Ta(a,b){var c=X({},a),d;for(d in b)r(b,d)&&(ba(a[d])&&ba(b[d])?(c[d]={},X(c[d],a[d]),X(c[d],b[d])):null!=b[d]?c[d]=b[d]:delete c[d]);for(d in a)r(a,d)&&
!r(b,d)&&ba(a[d])&&(c[d]=X({},c[d]));return c}function Ua(a){null!=a&&this.set(a)}function M(a,b,c){var d=""+Math.abs(a);return(0<=a?c?"+":"":"-")+Math.pow(10,Math.max(0,b-d.length)).toString().substr(1)+d}function k(a,b,c,d){var e=d;"string"===typeof d&&(e=function(){return this[d]()});a&&(fa[a]=e);b&&(fa[b[0]]=function(){return M(e.apply(this,arguments),b[1],b[2])});c&&(fa[c]=function(){return this.localeData().ordinal(e.apply(this,arguments),a)})}function pc(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,
""):a.replace(/\\/g,"")}function qc(a){var b=a.match(Va),c,d;c=0;for(d=b.length;c<d;c++)b[c]=fa[b[c]]?fa[b[c]]:pc(b[c]);return function(c){var e="",q;for(q=0;q<d;q++)e+=L(b[q])?b[q].call(c,a):b[q];return e}}function ya(a,b){if(!a.isValid())return a.localeData().invalidDate();b=zb(b,a.localeData());Wa[b]=Wa[b]||qc(b);return Wa[b](a)}function zb(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(za.lastIndex=0;0<=d&&za.test(a);)a=a.replace(za,c),za.lastIndex=0,--d;return a}function F(a){return"string"===
typeof a?Ab[a]||Ab[a.toLowerCase()]:void 0}function Xa(a){var b={},c,d;for(d in a)r(a,d)&&(c=F(d))&&(b[c]=a[d]);return b}function rc(a){var b=[],c;for(c in a)r(a,c)&&b.push({unit:c,priority:sc[c]});b.sort(function(a,b){return a.priority-b.priority});return b}function g(a,b,c){Aa[a]=L(b)?b:function(a,e){return a&&c?c:b}}function tc(a,b){return r(Aa,a)?Aa[a](b._strict,b._locale):new RegExp(uc(a))}function uc(a){return O(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,c,d,
e,n){return c||d||e||n}))}function O(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$\x26")}function G(a){return 0>a?Math.ceil(a)||0:Math.floor(a)}function l(a){a=+a;var b=0;0!==a&&isFinite(a)&&(b=G(a));return b}function u(a,b){var c,d=b,e;"string"===typeof a&&(a=[a]);W(b)&&(d=function(a,c){c[b]=l(a)});e=a.length;for(c=0;c<e;c++)Ya[a[c]]=d}function pa(a,b){u(a,function(a,d,e,n){e._w=e._w||{};b(a,e._w,e,n)})}function Y(a){return 0===a%4&&0!==a%100||0===a%400}function ga(a,b){return function(c){return null!=
c?(Bb(this,a,c),h.updateOffset(this,b),this):qa(this,a)}}function qa(a,b){if(!a.isValid())return NaN;var c=a._d;a=a._isUTC;switch(b){case "Milliseconds":return a?c.getUTCMilliseconds():c.getMilliseconds();case "Seconds":return a?c.getUTCSeconds():c.getSeconds();case "Minutes":return a?c.getUTCMinutes():c.getMinutes();case "Hours":return a?c.getUTCHours():c.getHours();case "Date":return a?c.getUTCDate():c.getDate();case "Day":return a?c.getUTCDay():c.getDay();case "Month":return a?c.getUTCMonth():
c.getMonth();case "FullYear":return a?c.getUTCFullYear():c.getFullYear();default:return NaN}}function Bb(a,b,c){var d,e;if(a.isValid()&&!isNaN(c)){d=a._d;e=a._isUTC;switch(b){case "Milliseconds":return void(e?d.setUTCMilliseconds(c):d.setMilliseconds(c));case "Seconds":return void(e?d.setUTCSeconds(c):d.setSeconds(c));case "Minutes":return void(e?d.setUTCMinutes(c):d.setMinutes(c));case "Hours":return void(e?d.setUTCHours(c):d.setHours(c));case "Date":return void(e?d.setUTCDate(c):d.setDate(c));case "FullYear":break;
default:return}b=a.month();a=a.date();a=29!==a||1!==b||Y(c)?a:28;void(e?d.setUTCFullYear(c,b,a):d.setFullYear(c,b,a))}}function Za(a,b){if(isNaN(a)||isNaN(b))return NaN;var c=(b%12+12)%12;return 1===c?Y(a+(b-c)/12)?29:28:31-c%7%2}function Cb(a,b){if(!a.isValid())return a;if("string"===typeof b)if(/^\d+$/.test(b))b=l(b);else if(b=a.localeData().monthsParse(b),!W(b))return a;var c=a.date(),c=29>c?c:Math.min(c,Za(a.year(),b));void(a._isUTC?a._d.setUTCMonth(b,c):a._d.setMonth(b,c));return a}function Db(a){return null!=
a?(Cb(this,a),h.updateOffset(this,!0),this):qa(this,"Month")}function Eb(){function a(a,b){return b.length-a.length}var b=[],c=[],d=[],e,n,q;for(e=0;12>e;e++)n=K([2E3,e]),q=O(this.monthsShort(n,"")),n=O(this.months(n,"")),b.push(q),c.push(n),d.push(n),d.push(q);b.sort(a);c.sort(a);d.sort(a);this._monthsShortRegex=this._monthsRegex=new RegExp("^("+d.join("|")+")","i");this._monthsStrictRegex=new RegExp("^("+c.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+b.join("|")+")","i")}function vc(a,
b,c,d,e,n,q){100>a&&0<=a?(b=new Date(a+400,b,c,d,e,n,q),isFinite(b.getFullYear())&&b.setFullYear(a)):b=new Date(a,b,c,d,e,n,q);return b}function ra(a){var b;100>a&&0<=a?(b=Array.prototype.slice.call(arguments),b[0]=a+400,b=new Date(Date.UTC.apply(null,b)),isFinite(b.getUTCFullYear())&&b.setUTCFullYear(a)):b=new Date(Date.UTC.apply(null,arguments));return b}function Ba(a,b,c){c=7+b-c;return-((7+ra(a,0,c).getUTCDay()-b)%7)+c-1}function Fb(a,b,c,d,e){c=(7+c-d)%7;d=Ba(a,d,e);d=1+7*(b-1)+c+d;0>=d?(b=a-
1,a=(Y(b)?366:365)+d):d>(Y(a)?366:365)?(b=a+1,a=d-(Y(a)?366:365)):(b=a,a=d);return{year:b,dayOfYear:a}}function sa(a,b,c){var d=Ba(a.year(),b,c),d=Math.floor((a.dayOfYear()-d-1)/7)+1;1>d?(a=a.year()-1,b=d+P(a,b,c)):d>P(a.year(),b,c)?(b=d-P(a.year(),b,c),a=a.year()+1):(a=a.year(),b=d);return{week:b,year:a}}function P(a,b,c){var d=Ba(a,b,c);b=Ba(a+1,b,c);return((Y(a)?366:365)-d+b)/7}function $a(a,b){return a.slice(b,7).concat(a.slice(0,b))}function wc(a,b,c){var d,e;a=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=
[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],d=0;7>d;++d)e=K([2E3,1]).day(d),this._minWeekdaysParse[d]=this.weekdaysMin(e,"").toLocaleLowerCase(),this._shortWeekdaysParse[d]=this.weekdaysShort(e,"").toLocaleLowerCase(),this._weekdaysParse[d]=this.weekdays(e,"").toLocaleLowerCase();if(c)b="dddd"===b?y.call(this._weekdaysParse,a):"ddd"===b?y.call(this._shortWeekdaysParse,a):y.call(this._minWeekdaysParse,a);else if("dddd"===b){b=y.call(this._weekdaysParse,a);if(-1!==b)return b;b=y.call(this._shortWeekdaysParse,
a);if(-1!==b)return b;b=y.call(this._minWeekdaysParse,a)}else if("ddd"===b){b=y.call(this._shortWeekdaysParse,a);if(-1!==b)return b;b=y.call(this._weekdaysParse,a);if(-1!==b)return b;b=y.call(this._minWeekdaysParse,a)}else{b=y.call(this._minWeekdaysParse,a);if(-1!==b)return b;b=y.call(this._weekdaysParse,a);if(-1!==b)return b;b=y.call(this._shortWeekdaysParse,a)}return-1!==b?b:null}function ab(){function a(a,b){return b.length-a.length}var b=[],c=[],d=[],e=[],n,q,f,h;for(n=0;7>n;n++)q=K([2E3,1]).day(n),
f=O(this.weekdaysMin(q,"")),h=O(this.weekdaysShort(q,"")),q=O(this.weekdays(q,"")),b.push(f),c.push(h),d.push(q),e.push(f),e.push(h),e.push(q);b.sort(a);c.sort(a);d.sort(a);e.sort(a);this._weekdaysMinRegex=this._weekdaysShortRegex=this._weekdaysRegex=new RegExp("^("+e.join("|")+")","i");this._weekdaysStrictRegex=new RegExp("^("+d.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+b.join("|")+")","i")}function bb(){return this.hours()%
12||12}function Gb(a,b){k(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),b)})}function Hb(a,b){return b._meridiemParse}function Ib(a){return a?a.toLowerCase().replace("_","-"):a}function Ca(a){var b=null,c;if(void 0===x[a]&&"undefined"!==typeof module&&module&&module.exports&&a&&a.match("^[^/\\\\]*$"))try{b=ta._abbr,c=require,c("./locale/"+a),Z(b)}catch(d){x[a]=null}return x[a]}function Z(a,b){a&&((b=C(b)?Q(a):cb(a,b))?ta=b:"undefined"!==typeof console&&console.warn&&
console.warn("Locale "+a+" not found. Did you forget to load it?"));return ta._abbr}function cb(a,b){if(null!==b){var c;c=Jb;b.abbr=a;if(null!=x[a])xb("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),c=x[a]._config;else if(null!=b.parentLocale)if(null!=x[b.parentLocale])c=x[b.parentLocale]._config;
else if(c=Ca(b.parentLocale),null!=c)c=c._config;else return ua[b.parentLocale]||(ua[b.parentLocale]=[]),ua[b.parentLocale].push({name:a,config:b}),null;x[a]=new Ua(Ta(c,b));ua[a]&&ua[a].forEach(function(a){cb(a.name,a.config)});Z(a);return x[a]}delete x[a];return null}function Q(a){var b;a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr);if(!a)return ta;if(!A(a)){if(b=Ca(a))return b;a=[a]}a:{b=0;for(var c,d,e,n;b<a.length;){n=Ib(a[b]).split("-");c=n.length;for(d=(d=Ib(a[b+1]))?d.split("-"):null;0<
c;){if(e=Ca(n.slice(0,c).join("-"))){a=e;break a}if(e=d&&d.length>=c){b:{var f=Math.min(n.length,d.length);for(e=0;e<f;e+=1)if(n[e]!==d[e])break b;e=f}e=e>=c-1}if(e)break;c--}b++}a=ta}return a}function db(a){var b;(b=a._a)&&-2===m(a).overflow&&(b=0>b[R]||11<b[R]?R:1>b[N]||b[N]>Za(b[B],b[R])?N:0>b[z]||24<b[z]||24===b[z]&&(0!==b[I]||0!==b[S]||0!==b[ca])?z:0>b[I]||59<b[I]?I:0>b[S]||59<b[S]?S:0>b[ca]||999<b[ca]?ca:-1,m(a)._overflowDayOfYear&&(b<B||b>N)&&(b=N),m(a)._overflowWeeks&&-1===b&&(b=xc),m(a)._overflowWeekday&&
-1===b&&(b=yc),m(a).overflow=b);return a}function Kb(a){var b,c;b=a._i;var d=zc.exec(b)||Ac.exec(b),e,n,f,h;c=Da.length;var g=eb.length;if(d){m(a).iso=!0;for(b=0;b<c;b++)if(Da[b][1].exec(d[1])){n=Da[b][0];e=!1!==Da[b][2];break}if(null==n)a._isValid=!1;else{if(d[3]){b=0;for(c=g;b<c;b++)if(eb[b][1].exec(d[3])){f=(d[2]||" ")+eb[b][0];break}if(null==f){a._isValid=!1;return}}if(e||null==f){if(d[4])if(Bc.exec(d[4]))h="Z";else{a._isValid=!1;return}a._f=n+(f||"")+(h||"");fb(a)}else a._isValid=!1}}else a._isValid=
!1}function Lb(a){var b=Cc.exec(a._i.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(b){var c=b[3],d=b[2],e=b[5],n=b[6],f=b[7],h=parseInt(b[4],10),c=[49>=h?2E3+h:999>=h?1900+h:h,Mb.indexOf(c),parseInt(d,10),parseInt(e,10),parseInt(n,10)];f&&c.push(parseInt(f,10));a:{if(f=b[1])if(f=Nb.indexOf(f),d=(new Date(c[0],c[1],c[2])).getDay(),f!==d){m(a).weekdayMismatch=!0;f=a._isValid=!1;break a}f=!0}f&&(a._a=c,(f=b[8])?b=Dc[f]:b[9]?b=0:(b=parseInt(b[10],
10),f=b%100,b=(b-f)/100*60+f),a._tzm=b,a._d=ra.apply(null,a._a),a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),m(a).rfc2822=!0)}else a._isValid=!1}function Ec(a){var b=Fc.exec(a._i);null!==b?a._d=new Date(+b[1]):(Kb(a),!1===a._isValid&&(delete a._isValid,Lb(a),!1===a._isValid&&(delete a._isValid,a._strict?a._isValid=!1:h.createFromInputFallback(a))))}function ha(a,b,c){return null!=a?a:null!=b?b:c}function gb(a){var b,c=[],d;if(!a._d){d=new Date(h.now());d=a._useUTC?[d.getUTCFullYear(),d.getUTCMonth(),
d.getUTCDate()]:[d.getFullYear(),d.getMonth(),d.getDate()];if(a._w&&null==a._a[N]&&null==a._a[R]){var e,f,q,g,k,l;e=a._w;if(null!=e.GG||null!=e.W||null!=e.E){if(k=1,l=4,f=ha(e.GG,a._a[B],sa(v(),1,4).year),q=ha(e.W,1),g=ha(e.E,1),1>g||7<g)b=!0}else if(k=a._locale._week.dow,l=a._locale._week.doy,q=sa(v(),k,l),f=ha(e.gg,a._a[B],q.year),q=ha(e.w,q.week),null!=e.d){if(g=e.d,0>g||6<g)b=!0}else if(null!=e.e){if(g=e.e+k,0>e.e||6<e.e)b=!0}else g=k;1>q||q>P(f,k,l)?m(a)._overflowWeeks=!0:null!=b?m(a)._overflowWeekday=
!0:(b=Fb(f,q,g,k,l),a._a[B]=b.year,a._dayOfYear=b.dayOfYear)}if(null!=a._dayOfYear){b=ha(a._a[B],d[B]);if(a._dayOfYear>(Y(b)?366:365)||0===a._dayOfYear)m(a)._overflowDayOfYear=!0;b=ra(b,0,a._dayOfYear);a._a[R]=b.getUTCMonth();a._a[N]=b.getUTCDate()}for(b=0;3>b&&null==a._a[b];++b)a._a[b]=c[b]=d[b];for(;7>b;b++)a._a[b]=c[b]=null==a._a[b]?2===b?1:0:a._a[b];24===a._a[z]&&0===a._a[I]&&0===a._a[S]&&0===a._a[ca]&&(a._nextDay=!0,a._a[z]=0);a._d=(a._useUTC?ra:vc).apply(null,c);c=a._useUTC?a._d.getUTCDay():
a._d.getDay();null!=a._tzm&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm);a._nextDay&&(a._a[z]=24);a._w&&"undefined"!==typeof a._w.d&&a._w.d!==c&&(m(a).weekdayMismatch=!0)}}function fb(a){if(a._f===h.ISO_8601)Kb(a);else if(a._f===h.RFC_2822)Lb(a);else{a._a=[];m(a).empty=!0;var b=""+a._i,c,d,e,f,g,k=b.length,l=0,p;e=zb(a._f,a._locale).match(Va)||[];p=e.length;for(c=0;c<p;c++){f=e[c];if(d=(b.match(tc(f,a))||[])[0])g=b.substr(0,b.indexOf(d)),0<g.length&&m(a).unusedInput.push(g),b=b.slice(b.indexOf(d)+
d.length),l+=d.length;if(fa[f]){if(d?m(a).empty=!1:m(a).unusedTokens.push(f),g=a,null!=d&&r(Ya,f))Ya[f](d,g._a,g,f)}else a._strict&&!d&&m(a).unusedTokens.push(f)}m(a).charsLeftOver=k-l;0<b.length&&m(a).unusedInput.push(b);12>=a._a[z]&&!0===m(a).bigHour&&0<a._a[z]&&(m(a).bigHour=void 0);m(a).parsedDateParts=a._a.slice(0);m(a).meridiem=a._meridiem;b=a._a;c=z;k=a._locale;e=a._a[z];l=a._meridiem;null!=l&&(null!=k.meridiemHour?e=k.meridiemHour(e,l):null!=k.isPM&&((k=k.isPM(l))&&12>e&&(e+=12),k||12!==e||
(e=0)));b[c]=e;b=m(a).era;null!==b&&(a._a[B]=a._locale.erasConvertYear(b,a._a[B]));gb(a);db(a)}}function Gc(a){if(!a._d){var b=Xa(a._i);a._a=sb([b.year,b.month,void 0===b.day?b.date:b.day,b.hour,b.minute,b.second,b.millisecond],function(a){return a&&parseInt(a,10)});gb(a)}}function Ob(a){var b=a._i,c=a._f;a._locale=a._locale||Q(a._l);if(null===b||void 0===c&&""===b)return xa({nullInput:!0});"string"===typeof b&&(a._i=b=a._locale.preparse(b));if(H(b))return new oa(db(b));if(na(b))a._d=b;else if(A(c)){var d,
e,f,h,g=!1,k=a._f.length;if(0===k)m(a).invalidFormat=!0,a._d=new Date(NaN);else{for(b=0;b<k;b++)if(c=0,h=!1,d=Ra({},a),null!=a._useUTC&&(d._useUTC=a._useUTC),d._f=a._f[b],fb(d),Qa(d)&&(h=!0),c+=m(d).charsLeftOver,c+=10*m(d).unusedTokens.length,m(d).score=c,g)c<f&&(f=c,e=d);else if(null==f||c<f||h)f=c,e=d,h&&(g=!0);X(a,e||d)}}else c?fb(a):Hc(a);Qa(a)||(a._d=null);return a}function Hc(a){var b=a._i;C(b)?a._d=new Date(h.now()):na(b)?a._d=new Date(b.valueOf()):"string"===typeof b?Ec(a):A(b)?(a._a=sb(b.slice(0),
function(a){return parseInt(a,10)}),gb(a)):ba(b)?Gc(a):W(b)?a._d=new Date(b):h.createFromInputFallback(a)}function tb(a,b,c,d,e){var f={};if(!0===b||!1===b)d=b,b=void 0;if(!0===c||!1===c)d=c,c=void 0;if(ba(a)&&Pa(a)||A(a)&&0===a.length)a=void 0;f._isAMomentObject=!0;f._useUTC=f._isUTC=e;f._l=c;f._i=a;f._f=b;f._strict=d;a=new oa(db(Ob(f)));a._nextDay&&(a.add(1,"d"),a._nextDay=void 0);return a}function v(a,b,c,d){return tb(a,b,c,d,!1)}function Pb(a,b){var c,d;1===b.length&&A(b[0])&&(b=b[0]);if(!b.length)return v();
c=b[0];for(d=1;d<b.length;++d)if(!b[d].isValid()||b[d][a](c))c=b[d];return c}function Ic(a){var b,c=!1,d=va.length;for(b in a)if(r(a,b)&&(-1===y.call(va,b)||null!=a[b]&&isNaN(a[b])))return!1;for(b=0;b<d;++b)if(a[va[b]]){if(c)return!1;parseFloat(a[va[b]])!==l(a[va[b]])&&(c=!0)}return!0}function Ea(a){a=Xa(a);var b=a.year||0,c=a.quarter||0,d=a.month||0,e=a.week||a.isoWeek||0,f=a.day||0,h=a.hour||0,g=a.minute||0,k=a.second||0,l=a.millisecond||0;this._isValid=Ic(a);this._milliseconds=+l+1E3*k+6E4*g+36E5*
h;this._days=+f+7*e;this._months=+d+3*c+12*b;this._data={};this._locale=Q();this._bubble()}function Fa(a){return a instanceof Ea}function hb(a){return 0>a?-1*Math.round(-1*a):Math.round(a)}function Qb(a,b){k(a,0,0,function(){var a=this.utcOffset(),d="+";0>a&&(a=-a,d="-");return d+M(~~(a/60),2)+b+M(~~a%60,2)})}function ib(a,b){a=(b||"").match(a);if(null===a)return null;a=((a[a.length-1]||[])+"").match(Jc)||["-",0,0];b=+(60*a[1])+l(a[2]);return 0===b?0:"+"===a[0]?b:-b}function jb(a,b){return b._isUTC?
(b=b.clone(),a=(H(a)||na(a)?a.valueOf():v(a).valueOf())-b.valueOf(),b._d.setTime(b._d.valueOf()+a),h.updateOffset(b,!1),b):v(a).local()}function Rb(){return this.isValid()?this._isUTC&&0===this._offset:!1}function J(a,b){var c=a;Fa(a)?c={ms:a._milliseconds,d:a._days,M:a._months}:W(a)||!isNaN(+a)?(c={},b?c[b]=+a:c.milliseconds=+a):(b=Kc.exec(a))?(c="-"===b[1]?-1:1,c={y:0,d:l(b[N])*c,h:l(b[z])*c,m:l(b[I])*c,s:l(b[S])*c,ms:l(hb(1E3*b[ca]))*c}):(b=Lc.exec(a))?(c="-"===b[1]?-1:1,c={y:da(b[2],c),M:da(b[3],
c),w:da(b[4],c),d:da(b[5],c),h:da(b[6],c),m:da(b[7],c),s:da(b[8],c)}):null==c?c={}:"object"===typeof c&&("from"in c||"to"in c)&&(b=v(c.from),c=v(c.to),b.isValid()&&c.isValid()?(c=jb(c,b),b.isBefore(c)?c=Sb(b,c):(c=Sb(c,b),c.milliseconds=-c.milliseconds,c.months=-c.months),b=c):b={milliseconds:0,months:0},c={},c.ms=b.milliseconds,c.M=b.months);c=new Ea(c);Fa(a)&&r(a,"_locale")&&(c._locale=a._locale);Fa(a)&&r(a,"_isValid")&&(c._isValid=a._isValid);return c}function da(a,b){a=a&&parseFloat(a.replace(",",
"."));return(isNaN(a)?0:a)*b}function Sb(a,b){var c={};c.months=b.month()-a.month()+12*(b.year()-a.year());a.clone().add(c.months,"M").isAfter(b)&&--c.months;c.milliseconds=+b-+a.clone().add(c.months,"M");return c}function Tb(a,b){return function(c,d){var e;null===d||isNaN(+d)||(xb(b,"moment()."+b+"(period, number) is deprecated. Please use moment()."+b+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),e=c,c=d,d=e);c=J(c,d);Ub(this,c,a);return this}}
function Ub(a,b,c,d){var e=b._milliseconds,f=hb(b._days);b=hb(b._months);a.isValid()&&(d=null==d?!0:d,b&&Cb(a,qa(a,"Month")+b*c),f&&Bb(a,"Date",qa(a,"Date")+f*c),e&&a._d.setTime(a._d.valueOf()+e*c),d&&h.updateOffset(a,f||b))}function Vb(a){return"string"===typeof a||a instanceof String}function Mc(a){var b=A(a),c=!1;b&&(c=0===a.filter(function(b){return!W(b)&&Vb(a)}).length);return b&&c}function Ga(a,b){if(a.date()<b.date())return-Ga(b,a);var c=12*(b.year()-a.year())+(b.month()-a.month()),d=a.clone().add(c,
"months");0>b-d?(a=a.clone().add(c-1,"months"),b=(b-d)/(d-a)):(a=a.clone().add(c+1,"months"),b=(b-d)/(a-d));return-(c+b)||0}function Wb(a){if(void 0===a)return this._locale._abbr;a=Q(a);null!=a&&(this._locale=a);return this}function Xb(){return this._locale}function ia(a,b){return(a%b+b)%b}function Yb(a,b,c){return 100>a&&0<=a?new Date(a+400,b,c)-126227808E5:(new Date(a,b,c)).valueOf()}function Zb(a,b,c){return 100>a&&0<=a?Date.UTC(a+400,b,c)-126227808E5:Date.UTC(a,b,c)}function kb(a,b){return b.erasAbbrRegex(a)}
function lb(){var a=[],b=[],c=[],d=[],e,f,h,g,k,l=this.eras();e=0;for(f=l.length;e<f;++e)h=O(l[e].name),g=O(l[e].abbr),k=O(l[e].narrow),b.push(h),a.push(g),c.push(k),d.push(h),d.push(g),d.push(k);this._erasRegex=new RegExp("^("+d.join("|")+")","i");this._erasNameRegex=new RegExp("^("+b.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+a.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+c.join("|")+")","i")}function Ha(a,b){k(0,[a,a.length],0,b)}function $b(a,b,c,d,e){var f;if(null==a)return sa(this,
d,e).year;f=P(a,d,e);b>f&&(b=f);a=Fb(a,b,c,d,e);a=ra(a.year,0,a.dayOfYear);this.year(a.getUTCFullYear());this.month(a.getUTCMonth());this.date(a.getUTCDate());return this}function Nc(a,b){b[ca]=l(1E3*("0."+a))}function ac(a){return a}function Ia(a,b,c,d){var e=Q();b=K().set(d,b);return e[c](b,a)}function bc(a,b,c){W(a)&&(b=a,a=void 0);a=a||"";if(null!=b)return Ia(a,b,c,"month");var d=[];for(b=0;12>b;b++)d[b]=Ia(a,b,c,"month");return d}function mb(a,b,c,d){"boolean"!==typeof a&&(c=b=a,a=!1);W(b)&&
(c=b,b=void 0);b=b||"";var e=Q();a=a?e._week.dow:0;e=[];if(null!=c)return Ia(b,(c+a)%7,d,"day");for(c=0;7>c;c++)e[c]=Ia(b,(c+a)%7,d,"day");return e}function cc(a,b,c,d){b=J(b,c);a._milliseconds+=d*b._milliseconds;a._days+=d*b._days;a._months+=d*b._months;return a._bubble()}function dc(a){return 0>a?Math.floor(a):Math.ceil(a)}function T(a){return function(){return this.as(a)}}function ea(a){return function(){return this.isValid()?this._data[a]:NaN}}function Oc(a,b,c,d,e){return e.relativeTime(b||1,
!!c,a,d)}function ja(a){return(0<a)-(0>a)||+a}function Ja(){if(!this.isValid())return this.localeData().invalidDate();var a=nb(this._milliseconds)/1E3,b=nb(this._days),c=nb(this._months),d,e,f,h,g=this.asSeconds(),k,l,m;if(!g)return"P0D";d=G(a/60);e=G(d/60);a%=60;d%=60;f=G(c/12);c%=12;h=a?a.toFixed(3).replace(/\.?0+$/,""):"";k=0>g?"-":"";l=ja(this._months)!==ja(g)?"-":"";m=ja(this._days)!==ja(g)?"-":"";g=ja(this._milliseconds)!==ja(g)?"-":"";return k+"P"+(f?l+f+"Y":"")+(c?l+c+"M":"")+(b?m+b+"D":"")+
(e||d||a?"T":"")+(e?g+e+"H":"")+(d?g+d+"M":"")+(a?g+h+"S":"")}var rb,ub;ub=Array.prototype.some?Array.prototype.some:function(a){var b=Object(this),c=b.length>>>0,d;for(d=0;d<c;d++)if(d in b&&a.call(this,b[d],d,b))return!0;return!1};var vb=h.momentProperties=[],Sa=!1,yb={};h.suppressDeprecationWarnings=!1;h.deprecationHandler=null;var ec;ec=Object.keys?Object.keys:function(a){var b,c=[];for(b in a)r(a,b)&&c.push(b);return c};var Va=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
za=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Wa={},fa={},Ab={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",
quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"},sc={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1},fc=/\d/,D=/\d\d/,gc=/\d{3}/,ob=
/\d{4}/,Ka=/[+-]?\d{6}/,w=/\d\d?/,hc=/\d\d\d\d?/,ic=/\d\d\d\d\d\d?/,La=/\d{1,3}/,pb=/\d{1,4}/,Ma=/[+-]?\d{1,6}/,ka=/\d+/,Na=/[+-]?\d+/,Pc=/Z|[+-]\d\d:?\d\d/gi,Oa=/Z|[+-]\d\d(?::?\d\d)?/gi,wa=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,la=/^[1-9]\d?/,qb=/^([1-9]\d|\d)/,Aa;Aa={};var Ya={},B=0,R=1,N=2,z=3,I=4,S=5,ca=6,xc=7,yc=8;k("Y",0,0,function(){var a=this.year();return 9999>=a?M(a,4):"+"+a});
k(0,["YY",2],0,function(){return this.year()%100});k(0,["YYYY",4],0,"year");k(0,["YYYYY",5],0,"year");k(0,["YYYYYY",6,!0],0,"year");g("Y",Na);g("YY",w,D);g("YYYY",pb,ob);g("YYYYY",Ma,Ka);g("YYYYYY",Ma,Ka);u(["YYYYY","YYYYYY"],B);u("YYYY",function(a,b){b[B]=2===a.length?h.parseTwoDigitYear(a):l(a)});u("YY",function(a,b){b[B]=h.parseTwoDigitYear(a)});u("Y",function(a,b){b[B]=parseInt(a,10)});h.parseTwoDigitYear=function(a){return l(a)+(68<l(a)?1900:2E3)};var jc=ga("FullYear",!0),y;y=Array.prototype.indexOf?
Array.prototype.indexOf:function(a){var b;for(b=0;b<this.length;++b)if(this[b]===a)return b;return-1};k("M",["MM",2],"Mo",function(){return this.month()+1});k("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)});k("MMMM",0,0,function(a){return this.localeData().months(this,a)});g("M",w,la);g("MM",w,D);g("MMM",function(a,b){return b.monthsShortRegex(a)});g("MMMM",function(a,b){return b.monthsRegex(a)});u(["M","MM"],function(a,b){b[R]=l(a)-1});u(["MMM","MMMM"],function(a,b,c,d){d=c._locale.monthsParse(a,
d,c._strict);null!=d?b[R]=d:m(c).invalidMonth=a});var Mb="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),kc=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/;k("w",["ww",2],"wo","week");k("W",["WW",2],"Wo","isoWeek");g("w",w,la);g("ww",w,D);g("W",w,la);g("WW",w,D);pa(["w","ww","W","WW"],function(a,b,c,d){b[d.substr(0,1)]=l(a)});k("d",0,"do","day");k("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)});k("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)});k("dddd",0,0,
function(a){return this.localeData().weekdays(this,a)});k("e",0,0,"weekday");k("E",0,0,"isoWeekday");g("d",w);g("e",w);g("E",w);g("dd",function(a,b){return b.weekdaysMinRegex(a)});g("ddd",function(a,b){return b.weekdaysShortRegex(a)});g("dddd",function(a,b){return b.weekdaysRegex(a)});pa(["dd","ddd","dddd"],function(a,b,c,d){d=c._locale.weekdaysParse(a,d,c._strict);null!=d?b.d=d:m(c).invalidWeekday=a});pa(["d","e","E"],function(a,b,c,d){b[d]=l(a)});var Nb="Sun Mon Tue Wed Thu Fri Sat".split(" ");
k("H",["HH",2],0,"hour");k("h",["hh",2],0,bb);k("k",["kk",2],0,function(){return this.hours()||24});k("hmm",0,0,function(){return""+bb.apply(this)+M(this.minutes(),2)});k("hmmss",0,0,function(){return""+bb.apply(this)+M(this.minutes(),2)+M(this.seconds(),2)});k("Hmm",0,0,function(){return""+this.hours()+M(this.minutes(),2)});k("Hmmss",0,0,function(){return""+this.hours()+M(this.minutes(),2)+M(this.seconds(),2)});Gb("a",!0);Gb("A",!1);g("a",Hb);g("A",Hb);g("H",w,qb);g("h",w,la);g("k",w,la);g("HH",
w,D);g("hh",w,D);g("kk",w,D);g("hmm",hc);g("hmmss",ic);g("Hmm",hc);g("Hmmss",ic);u(["H","HH"],z);u(["k","kk"],function(a,b,c){a=l(a);b[z]=24===a?0:a});u(["a","A"],function(a,b,c){c._isPm=c._locale.isPM(a);c._meridiem=a});u(["h","hh"],function(a,b,c){b[z]=l(a);m(c).bigHour=!0});u("hmm",function(a,b,c){var d=a.length-2;b[z]=l(a.substr(0,d));b[I]=l(a.substr(d));m(c).bigHour=!0});u("hmmss",function(a,b,c){var d=a.length-4,e=a.length-2;b[z]=l(a.substr(0,d));b[I]=l(a.substr(d,2));b[S]=l(a.substr(e));m(c).bigHour=
!0});u("Hmm",function(a,b,c){c=a.length-2;b[z]=l(a.substr(0,c));b[I]=l(a.substr(c))});u("Hmmss",function(a,b,c){c=a.length-4;var d=a.length-2;b[z]=l(a.substr(0,c));b[I]=l(a.substr(c,2));b[S]=l(a.substr(d))});var Qc=ga("Hours",!0),Jb={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},
invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:"January February March April May June July August September October November December".split(" "),monthsShort:Mb,week:{dow:0,doy:6},weekdays:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
weekdaysMin:"Su Mo Tu We Th Fr Sa".split(" "),weekdaysShort:Nb,meridiemParse:/[ap]\.?m?\.?/i},x={},ua={},ta,zc=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ac=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Bc=/Z|[+-]\d\d(?::?\d\d)?/,Da=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],
["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],eb=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",
/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Fc=/^\/?Date\((-?\d+)/i,Cc=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Dc={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};h.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",
function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});h.ISO_8601=function(){};h.RFC_2822=function(){};var Rc=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=v.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:xa()}),Sc=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=v.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:
a:xa()}),va="year quarter month week day hour minute second millisecond".split(" ");Qb("Z",":");Qb("ZZ","");g("Z",Oa);g("ZZ",Oa);u(["Z","ZZ"],function(a,b,c){c._useUTC=!0;c._tzm=ib(Oa,a)});var Jc=/([\+\-]|\d\d)/gi;h.updateOffset=function(){};var Kc=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Lc=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;J.fn=Ea.prototype;J.invalid=
function(){return J(NaN)};var Tc=Tb(1,"add"),Uc=Tb(-1,"subtract");h.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";h.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lc=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return void 0===a?this.localeData():this.locale(a)});k("N",0,0,"eraAbbr");k("NN",0,0,"eraAbbr");k("NNN",0,0,"eraAbbr");k("NNNN",0,0,"eraName");k("NNNNN",0,0,"eraNarrow");k("y",["y",1],"yo",
"eraYear");k("y",["yy",2],0,"eraYear");k("y",["yyy",3],0,"eraYear");k("y",["yyyy",4],0,"eraYear");g("N",kb);g("NN",kb);g("NNN",kb);g("NNNN",function(a,b){return b.erasNameRegex(a)});g("NNNNN",function(a,b){return b.erasNarrowRegex(a)});u(["N","NN","NNN","NNNN","NNNNN"],function(a,b,c,d){(b=c._locale.erasParse(a,d,c._strict))?m(c).era=b:m(c).invalidEra=a});g("y",ka);g("yy",ka);g("yyy",ka);g("yyyy",ka);g("yo",function(a,b){return b._eraYearOrdinalRegex||ka});u(["y","yy","yyy","yyyy"],B);u(["yo"],function(a,
b,c,d){var e;c._locale._eraYearOrdinalRegex&&(e=a.match(c._locale._eraYearOrdinalRegex));b[B]=c._locale.eraYearOrdinalParse?c._locale.eraYearOrdinalParse(a,e):parseInt(a,10)});k(0,["gg",2],0,function(){return this.weekYear()%100});k(0,["GG",2],0,function(){return this.isoWeekYear()%100});Ha("gggg","weekYear");Ha("ggggg","weekYear");Ha("GGGG","isoWeekYear");Ha("GGGGG","isoWeekYear");g("G",Na);g("g",Na);g("GG",w,D);g("gg",w,D);g("GGGG",pb,ob);g("gggg",pb,ob);g("GGGGG",Ma,Ka);g("ggggg",Ma,Ka);pa(["gggg",
"ggggg","GGGG","GGGGG"],function(a,b,c,d){b[d.substr(0,2)]=l(a)});pa(["gg","GG"],function(a,b,c,d){b[d]=h.parseTwoDigitYear(a)});k("Q",0,"Qo","quarter");g("Q",fc);u("Q",function(a,b){b[R]=3*(l(a)-1)});k("D",["DD",2],"Do","date");g("D",w,la);g("DD",w,D);g("Do",function(a,b){return a?b._dayOfMonthOrdinalParse||b._ordinalParse:b._dayOfMonthOrdinalParseLenient});u(["D","DD"],N);u("Do",function(a,b){b[N]=l(a.match(w)[0])});var mc=ga("Date",!0);k("DDD",["DDDD",3],"DDDo","dayOfYear");g("DDD",La);g("DDDD",
gc);u(["DDD","DDDD"],function(a,b,c){c._dayOfYear=l(a)});k("m",["mm",2],0,"minute");g("m",w,qb);g("mm",w,D);u(["m","mm"],I);var Vc=ga("Minutes",!1);k("s",["ss",2],0,"second");g("s",w,qb);g("ss",w,D);u(["s","ss"],S);var Wc=ga("Seconds",!1);k("S",0,0,function(){return~~(this.millisecond()/100)});k(0,["SS",2],0,function(){return~~(this.millisecond()/10)});k(0,["SSS",3],0,"millisecond");k(0,["SSSS",4],0,function(){return 10*this.millisecond()});k(0,["SSSSS",5],0,function(){return 100*this.millisecond()});
k(0,["SSSSSS",6],0,function(){return 1E3*this.millisecond()});k(0,["SSSSSSS",7],0,function(){return 1E4*this.millisecond()});k(0,["SSSSSSSS",8],0,function(){return 1E5*this.millisecond()});k(0,["SSSSSSSSS",9],0,function(){return 1E6*this.millisecond()});g("S",La,fc);g("SS",La,D);g("SSS",La,gc);var aa,nc;for(aa="SSSS";9>=aa.length;aa+="S")g(aa,ka);for(aa="S";9>=aa.length;aa+="S")u(aa,Nc);nc=ga("Milliseconds",!1);k("z",0,0,"zoneAbbr");k("zz",0,0,"zoneName");var f=oa.prototype;f.add=Tc;f.calendar=function(a,
b){if(1===arguments.length)if(arguments[0]){var c=arguments[0],d;if(!(d=H(c)||na(c)||Vb(c)||W(c)||Mc(c))){d=ba(c)&&!Pa(c);var e=!1,f="years year y months month M days day d dates date D hours hour h minutes minute m seconds second s milliseconds millisecond ms".split(" "),g,k,l=f.length;for(g=0;g<l;g+=1)k=f[g],e=e||r(c,k);d=d&&e}if(d||null===c||void 0===c)a=arguments[0],b=void 0;else{c=arguments[0];d=ba(c)&&!Pa(c);e=!1;f="sameDay nextDay lastDay nextWeek lastWeek sameElse".split(" ");for(g=0;g<f.length;g+=
1)k=f[g],e=e||r(c,k);d&&e&&(b=arguments[0],a=void 0)}}else b=a=void 0;c=a||v();d=jb(c,this).startOf("day");d=h.calendarFormat(this,d)||"sameElse";e=b&&(L(b[d])?b[d].call(this,c):b[d]);return this.format(e||this.localeData().calendar(d,this,v(c)))};f.clone=function(){return new oa(this)};f.diff=function(a,b,c){var d;if(!this.isValid())return NaN;a=jb(a,this);if(!a.isValid())return NaN;d=6E4*(a.utcOffset()-this.utcOffset());b=F(b);switch(b){case "year":b=Ga(this,a)/12;break;case "month":b=Ga(this,a);
break;case "quarter":b=Ga(this,a)/3;break;case "second":b=(this-a)/1E3;break;case "minute":b=(this-a)/6E4;break;case "hour":b=(this-a)/36E5;break;case "day":b=(this-a-d)/864E5;break;case "week":b=(this-a-d)/6048E5;break;default:b=this-a}return c?b:G(b)};f.endOf=function(a){var b,c;a=F(a);if(void 0===a||"millisecond"===a||!this.isValid())return this;c=this._isUTC?Zb:Yb;switch(a){case "year":b=c(this.year()+1,0,1)-1;break;case "quarter":b=c(this.year(),this.month()-this.month()%3+3,1)-1;break;case "month":b=
c(this.year(),this.month()+1,1)-1;break;case "week":b=c(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case "isoWeek":b=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case "day":case "date":b=c(this.year(),this.month(),this.date()+1)-1;break;case "hour":b=this._d.valueOf();b+=36E5-ia(b+(this._isUTC?0:6E4*this.utcOffset()),36E5)-1;break;case "minute":b=this._d.valueOf();b+=6E4-ia(b,6E4)-1;break;case "second":b=this._d.valueOf(),b+=1E3-ia(b,1E3)-1}this._d.setTime(b);
h.updateOffset(this,!0);return this};f.format=function(a){a||(a=this.isUtc()?h.defaultFormatUtc:h.defaultFormat);a=ya(this,a);return this.localeData().postformat(a)};f.from=function(a,b){return this.isValid()&&(H(a)&&a.isValid()||v(a).isValid())?J({to:this,from:a}).locale(this.locale()).humanize(!b):this.localeData().invalidDate()};f.fromNow=function(a){return this.from(v(),a)};f.to=function(a,b){return this.isValid()&&(H(a)&&a.isValid()||v(a).isValid())?J({from:this,to:a}).locale(this.locale()).humanize(!b):
this.localeData().invalidDate()};f.toNow=function(a){return this.to(v(),a)};f.get=function(a){a=F(a);return L(this[a])?this[a]():this};f.invalidAt=function(){return m(this).overflow};f.isAfter=function(a,b){a=H(a)?a:v(a);if(!this.isValid()||!a.isValid())return!1;b=F(b)||"millisecond";return"millisecond"===b?this.valueOf()>a.valueOf():a.valueOf()<this.clone().startOf(b).valueOf()};f.isBefore=function(a,b){a=H(a)?a:v(a);if(!this.isValid()||!a.isValid())return!1;b=F(b)||"millisecond";return"millisecond"===
b?this.valueOf()<a.valueOf():this.clone().endOf(b).valueOf()<a.valueOf()};f.isBetween=function(a,b,c,d){a=H(a)?a:v(a);b=H(b)?b:v(b);if(!(this.isValid()&&a.isValid()&&b.isValid()))return!1;d=d||"()";return("("===d[0]?this.isAfter(a,c):!this.isBefore(a,c))&&(")"===d[1]?this.isBefore(b,c):!this.isAfter(b,c))};f.isSame=function(a,b){a=H(a)?a:v(a);if(!this.isValid()||!a.isValid())return!1;b=F(b)||"millisecond";if("millisecond"===b)return this.valueOf()===a.valueOf();a=a.valueOf();return this.clone().startOf(b).valueOf()<=
a&&a<=this.clone().endOf(b).valueOf()};f.isSameOrAfter=function(a,b){return this.isSame(a,b)||this.isAfter(a,b)};f.isSameOrBefore=function(a,b){return this.isSame(a,b)||this.isBefore(a,b)};f.isValid=function(){return Qa(this)};f.lang=lc;f.locale=Wb;f.localeData=Xb;f.max=Sc;f.min=Rc;f.parsingFlags=function(){return X({},m(this))};f.set=function(a,b){if("object"===typeof a){a=Xa(a);b=rc(a);var c,d=b.length;for(c=0;c<d;c++)this[b[c].unit](a[b[c].unit])}else if(a=F(a),L(this[a]))return this[a](b);return this};
f.startOf=function(a){var b,c;a=F(a);if(void 0===a||"millisecond"===a||!this.isValid())return this;c=this._isUTC?Zb:Yb;switch(a){case "year":b=c(this.year(),0,1);break;case "quarter":b=c(this.year(),this.month()-this.month()%3,1);break;case "month":b=c(this.year(),this.month(),1);break;case "week":b=c(this.year(),this.month(),this.date()-this.weekday());break;case "isoWeek":b=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case "day":case "date":b=c(this.year(),this.month(),this.date());
break;case "hour":b=this._d.valueOf();b-=ia(b+(this._isUTC?0:6E4*this.utcOffset()),36E5);break;case "minute":b=this._d.valueOf();b-=ia(b,6E4);break;case "second":b=this._d.valueOf(),b-=ia(b,1E3)}this._d.setTime(b);h.updateOffset(this,!0);return this};f.subtract=Uc;f.toArray=function(){return[this.year(),this.month(),this.date(),this.hour(),this.minute(),this.second(),this.millisecond()]};f.toObject=function(){return{years:this.year(),months:this.month(),date:this.date(),hours:this.hours(),minutes:this.minutes(),
seconds:this.seconds(),milliseconds:this.milliseconds()}};f.toDate=function(){return new Date(this.valueOf())};f.toISOString=function(a){if(!this.isValid())return null;var b=(a=!0!==a)?this.clone().utc():this;return 0>b.year()||9999<b.year()?ya(b,a?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):L(Date.prototype.toISOString)?a?this.toDate().toISOString():(new Date(this.valueOf()+6E4*this.utcOffset())).toISOString().replace("Z",ya(b,"Z")):ya(b,a?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")};
f.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",b="",c;this.isLocal()||(a=0===this.utcOffset()?"moment.utc":"moment.parseZone",b="Z");a="["+a+'("]';c=0<=this.year()&&9999>=this.year()?"YYYY":"YYYYYY";return this.format(a+c+"-MM-DD[T]HH:mm:ss.SSS"+(b+'[")]'))};"undefined"!==typeof Symbol&&null!=Symbol.for&&(f[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment\x3c"+this.format()+"\x3e"});f.toJSON=function(){return this.isValid()?this.toISOString():
null};f.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")};f.unix=function(){return Math.floor(this.valueOf()/1E3)};f.valueOf=function(){return this._d.valueOf()-6E4*(this._offset||0)};f.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}};f.eraName=function(){var a,b,c,d=this.localeData().eras();a=0;for(b=d.length;a<b;++a)if(c=this.clone().startOf("day").valueOf(),d[a].since<=c&&c<=d[a].until||
d[a].until<=c&&c<=d[a].since)return d[a].name;return""};f.eraNarrow=function(){var a,b,c,d=this.localeData().eras();a=0;for(b=d.length;a<b;++a)if(c=this.clone().startOf("day").valueOf(),d[a].since<=c&&c<=d[a].until||d[a].until<=c&&c<=d[a].since)return d[a].narrow;return""};f.eraAbbr=function(){var a,b,c,d=this.localeData().eras();a=0;for(b=d.length;a<b;++a)if(c=this.clone().startOf("day").valueOf(),d[a].since<=c&&c<=d[a].until||d[a].until<=c&&c<=d[a].since)return d[a].abbr;return""};f.eraYear=function(){var a,
b,c,d,e=this.localeData().eras();a=0;for(b=e.length;a<b;++a)if(c=e[a].since<=e[a].until?1:-1,d=this.clone().startOf("day").valueOf(),e[a].since<=d&&d<=e[a].until||e[a].until<=d&&d<=e[a].since)return(this.year()-h(e[a].since).year())*c+e[a].offset;return this.year()};f.year=jc;f.isLeapYear=function(){return Y(this.year())};f.weekYear=function(a){return $b.call(this,a,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)};f.isoWeekYear=function(a){return $b.call(this,
a,this.isoWeek(),this.isoWeekday(),1,4)};f.quarter=f.quarters=function(a){return null==a?Math.ceil((this.month()+1)/3):this.month(3*(a-1)+this.month()%3)};f.month=Db;f.daysInMonth=function(){return Za(this.year(),this.month())};f.week=f.weeks=function(a){var b=this.localeData().week(this);return null==a?b:this.add(7*(a-b),"d")};f.isoWeek=f.isoWeeks=function(a){var b=sa(this,1,4).week;return null==a?b:this.add(7*(a-b),"d")};f.weeksInYear=function(){var a=this.localeData()._week;return P(this.year(),
a.dow,a.doy)};f.weeksInWeekYear=function(){var a=this.localeData()._week;return P(this.weekYear(),a.dow,a.doy)};f.isoWeeksInYear=function(){return P(this.year(),1,4)};f.isoWeeksInISOWeekYear=function(){return P(this.isoWeekYear(),1,4)};f.date=mc;f.day=f.days=function(a){if(!this.isValid())return null!=a?this:NaN;var b=qa(this,"Day");if(null!=a){var c=this.localeData();"string"===typeof a&&(isNaN(a)?(a=c.weekdaysParse(a),a="number"===typeof a?a:null):a=parseInt(a,10));return this.add(a-b,"d")}return b};
f.weekday=function(a){if(!this.isValid())return null!=a?this:NaN;var b=(this.day()+7-this.localeData()._week.dow)%7;return null==a?b:this.add(a-b,"d")};f.isoWeekday=function(a){if(!this.isValid())return null!=a?this:NaN;if(null!=a){var b=this.localeData();a="string"===typeof a?b.weekdaysParse(a)%7||7:isNaN(a)?null:a;return this.day(this.day()%7?a:a-7)}return this.day()||7};f.dayOfYear=function(a){var b=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864E5)+1;return null==a?b:
this.add(a-b,"d")};f.hour=f.hours=Qc;f.minute=f.minutes=Vc;f.second=f.seconds=Wc;f.millisecond=f.milliseconds=nc;f.utcOffset=function(a,b,c){var d=this._offset||0,e;if(!this.isValid())return null!=a?this:NaN;if(null!=a){if("string"===typeof a){if(a=ib(Oa,a),null===a)return this}else 16>Math.abs(a)&&!c&&(a*=60);!this._isUTC&&b&&(e=-Math.round(this._d.getTimezoneOffset()));this._offset=a;this._isUTC=!0;null!=e&&this.add(e,"m");d!==a&&(!b||this._changeInProgress?Ub(this,J(a-d,"m"),1,!1):this._changeInProgress||
(this._changeInProgress=!0,h.updateOffset(this,!0),this._changeInProgress=null));return this}return this._isUTC?d:-Math.round(this._d.getTimezoneOffset())};f.utc=function(a){return this.utcOffset(0,a)};f.local=function(a){this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(-Math.round(this._d.getTimezoneOffset()),"m"));return this};f.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var a=ib(Pc,this._i);null!=a?this.utcOffset(a):
this.utcOffset(0,!0)}return this};f.hasAlignedHourOffset=function(a){if(!this.isValid())return!1;a=a?v(a).utcOffset():0;return 0===(this.utcOffset()-a)%60};f.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()};f.isLocal=function(){return this.isValid()?!this._isUTC:!1};f.isUtcOffset=function(){return this.isValid()?this._isUTC:!1};f.isUtc=Rb;f.isUTC=Rb;f.zoneAbbr=function(){return this._isUTC?"UTC":""};f.zoneName=function(){return this._isUTC?
"Coordinated Universal Time":""};f.dates=E("dates accessor is deprecated. Use date instead.",mc);f.months=E("months accessor is deprecated. Use month instead",Db);f.years=E("years accessor is deprecated. Use year instead",jc);f.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(a,b){return null!=a?("string"!==typeof a&&(a=-a),this.utcOffset(a,b),this):-this.utcOffset()});f.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",
function(){if(!C(this._isDSTShifted))return this._isDSTShifted;var a={},b;Ra(a,this);a=Ob(a);if(a._a){b=a._isUTC?K(a._a):v(a._a);var c;if(c=this.isValid()){a=a._a;b=b.toArray();c=Math.min(a.length,b.length);var d=Math.abs(a.length-b.length),e=0,f;for(f=0;f<c;f++)l(a[f])!==l(b[f])&&e++;c=0<e+d}this._isDSTShifted=c}else this._isDSTShifted=!1;return this._isDSTShifted});var t=Ua.prototype;t.calendar=function(a,b,c){a=this._calendar[a]||this._calendar.sameElse;return L(a)?a.call(b,c):a};t.longDateFormat=
function(a){var b=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];if(b||!c)return b;this._longDateFormat[a]=c.match(Va).map(function(a){return"MMMM"===a||"MM"===a||"DD"===a||"dddd"===a?a.slice(1):a}).join("");return this._longDateFormat[a]};t.invalidDate=function(){return this._invalidDate};t.ordinal=function(a){return this._ordinal.replace("%d",a)};t.preparse=ac;t.postformat=ac;t.relativeTime=function(a,b,c,d){var e=this._relativeTime[c];return L(e)?e(a,b,c,d):e.replace(/%d/i,a)};
t.pastFuture=function(a,b){a=this._relativeTime[0<a?"future":"past"];return L(a)?a(b):a.replace(/%s/i,b)};t.set=function(a){var b,c;for(c in a)r(a,c)&&(b=a[c],L(b)?this[c]=b:this["_"+c]=b);this._config=a;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)};t.eras=function(a,b){var c,d=this._eras||Q("en")._eras;a=0;for(b=d.length;a<b;++a){switch(typeof d[a].since){case "string":c=h(d[a].since).startOf("day"),d[a].since=
c.valueOf()}switch(typeof d[a].until){case "undefined":d[a].until=Infinity;break;case "string":c=h(d[a].until).startOf("day").valueOf(),d[a].until=c.valueOf()}}return d};t.erasParse=function(a,b,c){var d,e,f=this.eras(),g,h,k;a=a.toUpperCase();d=0;for(e=f.length;d<e;++d)if(g=f[d].name.toUpperCase(),h=f[d].abbr.toUpperCase(),k=f[d].narrow.toUpperCase(),c)switch(b){case "N":case "NN":case "NNN":if(h===a)return f[d];break;case "NNNN":if(g===a)return f[d];break;case "NNNNN":if(k===a)return f[d]}else if(0<=
[g,h,k].indexOf(a))return f[d]};t.erasConvertYear=function(a,b){var c=a.since<=a.until?1:-1;return void 0===b?h(a.since).year():h(a.since).year()+(b-a.offset)*c};t.erasAbbrRegex=function(a){r(this,"_erasAbbrRegex")||lb.call(this);return a?this._erasAbbrRegex:this._erasRegex};t.erasNameRegex=function(a){r(this,"_erasNameRegex")||lb.call(this);return a?this._erasNameRegex:this._erasRegex};t.erasNarrowRegex=function(a){r(this,"_erasNarrowRegex")||lb.call(this);return a?this._erasNarrowRegex:this._erasRegex};
t.months=function(a,b){return a?A(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||kc).test(b)?"format":"standalone"][a.month()]:A(this._months)?this._months:this._months.standalone};t.monthsShort=function(a,b){return a?A(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[kc.test(b)?"format":"standalone"][a.month()]:A(this._monthsShort)?this._monthsShort:this._monthsShort.standalone};t.monthsParse=function(a,b,c){var d,e;if(this._monthsParseExact){a:{a=a.toLocaleLowerCase();
if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],d=0;12>d;++d)e=K([2E3,d]),this._shortMonthsParse[d]=this.monthsShort(e,"").toLocaleLowerCase(),this._longMonthsParse[d]=this.months(e,"").toLocaleLowerCase();if(c)b="MMM"===b?y.call(this._shortMonthsParse,a):y.call(this._longMonthsParse,a);else if("MMM"===b){b=y.call(this._shortMonthsParse,a);if(-1!==b)break a;b=y.call(this._longMonthsParse,a)}else{b=y.call(this._longMonthsParse,a);if(-1!==b)break a;
b=y.call(this._shortMonthsParse,a)}b=-1!==b?b:null}return b}this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]);for(d=0;12>d;d++)if(e=K([2E3,d]),c&&!this._longMonthsParse[d]&&(this._longMonthsParse[d]=new RegExp("^"+this.months(e,"").replace(".","")+"$","i"),this._shortMonthsParse[d]=new RegExp("^"+this.monthsShort(e,"").replace(".","")+"$","i")),c||this._monthsParse[d]||(e="^"+this.months(e,"")+"|^"+this.monthsShort(e,""),this._monthsParse[d]=new RegExp(e.replace(".",
""),"i")),c&&"MMMM"===b&&this._longMonthsParse[d].test(a)||c&&"MMM"===b&&this._shortMonthsParse[d].test(a)||!c&&this._monthsParse[d].test(a))return d};t.monthsRegex=function(a){if(this._monthsParseExact)return r(this,"_monthsRegex")||Eb.call(this),a?this._monthsStrictRegex:this._monthsRegex;r(this,"_monthsRegex")||(this._monthsRegex=wa);return this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex};t.monthsShortRegex=function(a){if(this._monthsParseExact)return r(this,"_monthsRegex")||
Eb.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex;r(this,"_monthsShortRegex")||(this._monthsShortRegex=wa);return this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex};t.week=function(a){return sa(a,this._week.dow,this._week.doy).week};t.firstDayOfYear=function(){return this._week.doy};t.firstDayOfWeek=function(){return this._week.dow};t.weekdays=function(a,b){b=A(this._weekdays)?this._weekdays:this._weekdays[a&&!0!==a&&this._weekdays.isFormat.test(b)?
"format":"standalone"];return!0===a?$a(b,this._week.dow):a?b[a.day()]:b};t.weekdaysMin=function(a){return!0===a?$a(this._weekdaysMin,this._week.dow):a?this._weekdaysMin[a.day()]:this._weekdaysMin};t.weekdaysShort=function(a){return!0===a?$a(this._weekdaysShort,this._week.dow):a?this._weekdaysShort[a.day()]:this._weekdaysShort};t.weekdaysParse=function(a,b,c){var d,e;if(this._weekdaysParseExact)return wc.call(this,a,b,c);this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=
[],this._fullWeekdaysParse=[]);for(d=0;7>d;d++)if(e=K([2E3,1]).day(d),c&&!this._fullWeekdaysParse[d]&&(this._fullWeekdaysParse[d]=new RegExp("^"+this.weekdays(e,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[d]=new RegExp("^"+this.weekdaysShort(e,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[d]=new RegExp("^"+this.weekdaysMin(e,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[d]||(e="^"+this.weekdays(e,"")+"|^"+this.weekdaysShort(e,"")+"|^"+this.weekdaysMin(e,""),this._weekdaysParse[d]=
new RegExp(e.replace(".",""),"i")),c&&"dddd"===b&&this._fullWeekdaysParse[d].test(a)||c&&"ddd"===b&&this._shortWeekdaysParse[d].test(a)||c&&"dd"===b&&this._minWeekdaysParse[d].test(a)||!c&&this._weekdaysParse[d].test(a))return d};t.weekdaysRegex=function(a){if(this._weekdaysParseExact)return r(this,"_weekdaysRegex")||ab.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex;r(this,"_weekdaysRegex")||(this._weekdaysRegex=wa);return this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex};
t.weekdaysShortRegex=function(a){if(this._weekdaysParseExact)return r(this,"_weekdaysRegex")||ab.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex;r(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=wa);return this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex};t.weekdaysMinRegex=function(a){if(this._weekdaysParseExact)return r(this,"_weekdaysRegex")||ab.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex;r(this,"_weekdaysMinRegex")||
(this._weekdaysMinRegex=wa);return this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex};t.isPM=function(a){return"p"===(a+"").toLowerCase().charAt(0)};t.meridiem=function(a,b,c){return 11<a?c?"pm":"PM":c?"am":"AM"};Z("en",{eras:[{since:"0001-01-01",until:Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var b=
a%10,b=1===l(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+b}});h.lang=E("moment.lang is deprecated. Use moment.locale instead.",Z);h.langData=E("moment.langData is deprecated. Use moment.localeData instead.",Q);var U=Math.abs,oc=T("ms"),Xc=T("s"),Yc=T("m"),Zc=T("h"),$c=T("d"),ad=T("w"),bd=T("M"),cd=T("Q"),dd=T("y"),ed=ea("milliseconds"),fd=ea("seconds"),gd=ea("minutes"),hd=ea("hours"),id=ea("days"),jd=ea("months"),kd=ea("years"),V=Math.round,ma={ss:44,s:45,m:45,h:22,d:26,w:null,M:11},
nb=Math.abs,p=Ea.prototype;p.isValid=function(){return this._isValid};p.abs=function(){var a=this._data;this._milliseconds=U(this._milliseconds);this._days=U(this._days);this._months=U(this._months);a.milliseconds=U(a.milliseconds);a.seconds=U(a.seconds);a.minutes=U(a.minutes);a.hours=U(a.hours);a.months=U(a.months);a.years=U(a.years);return this};p.add=function(a,b){return cc(this,a,b,1)};p.subtract=function(a,b){return cc(this,a,b,-1)};p.as=function(a){if(!this.isValid())return NaN;var b,c=this._milliseconds;
a=F(a);if("month"===a||"quarter"===a||"year"===a)switch(b=this._days+c/864E5,b=this._months+4800*b/146097,a){case "month":return b;case "quarter":return b/3;case "year":return b/12}else switch(b=this._days+Math.round(146097*this._months/4800),a){case "week":return b/7+c/6048E5;case "day":return b+c/864E5;case "hour":return 24*b+c/36E5;case "minute":return 1440*b+c/6E4;case "second":return 86400*b+c/1E3;case "millisecond":return Math.floor(864E5*b)+c;default:throw Error("Unknown unit "+a);}};p.asMilliseconds=
oc;p.asSeconds=Xc;p.asMinutes=Yc;p.asHours=Zc;p.asDays=$c;p.asWeeks=ad;p.asMonths=bd;p.asQuarters=cd;p.asYears=dd;p.valueOf=oc;p._bubble=function(){var a=this._milliseconds,b=this._days,c=this._months,d=this._data;0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c||(a+=864E5*dc(146097*c/4800+b),c=b=0);d.milliseconds=a%1E3;a=G(a/1E3);d.seconds=a%60;a=G(a/60);d.minutes=a%60;a=G(a/60);d.hours=a%24;b+=G(a/24);a=G(4800*b/146097);c+=a;b-=dc(146097*a/4800);a=G(c/12);d.days=b;d.months=c%12;d.years=a;return this};p.clone=
function(){return J(this)};p.get=function(a){a=F(a);return this.isValid()?this[a+"s"]():NaN};p.milliseconds=ed;p.seconds=fd;p.minutes=gd;p.hours=hd;p.days=id;p.weeks=function(){return G(this.days()/7)};p.months=jd;p.years=kd;p.humanize=function(a,b){if(!this.isValid())return this.localeData().invalidDate();var c=!1,d=ma;"object"===typeof a&&(b=a,a=!1);"boolean"===typeof a&&(c=a);"object"===typeof b&&(d=Object.assign({},ma,b),null!=b.s&&null==b.ss&&(d.ss=b.s-1));a=this.localeData();b=!c;var e=J(this).abs(),
f=V(e.as("s")),g=V(e.as("m")),h=V(e.as("h")),k=V(e.as("d")),l=V(e.as("M")),m=V(e.as("w")),e=V(e.as("y")),f=f<=d.ss&&["s",f]||f<d.s&&["ss",f]||1>=g&&["m"]||g<d.m&&["mm",g]||1>=h&&["h"]||h<d.h&&["hh",h]||1>=k&&["d"]||k<d.d&&["dd",k];null!=d.w&&(f=f||1>=m&&["w"]||m<d.w&&["ww",m]);f=f||1>=l&&["M"]||l<d.M&&["MM",l]||1>=e&&["y"]||["yy",e];f[2]=b;f[3]=0<+this;f[4]=a;b=Oc.apply(null,f);c&&(b=a.pastFuture(+this,b));return a.postformat(b)};p.toISOString=Ja;p.toString=Ja;p.toJSON=Ja;p.locale=Wb;p.localeData=
Xb;p.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Ja);p.lang=lc;k("X",0,0,"unix");k("x",0,0,"valueOf");g("x",Na);g("X",/[+-]?\d+(\.\d{1,3})?/);u("X",function(a,b,c){c._d=new Date(1E3*parseFloat(a))});u("x",function(a,b,c){c._d=new Date(l(a))});h.version="2.30.1";rb=v;h.fn=f;h.min=function(){var a=[].slice.call(arguments,0);return Pb("isBefore",a)};h.max=function(){var a=[].slice.call(arguments,0);return Pb("isAfter",a)};h.now=function(){return Date.now?
Date.now():+new Date};h.utc=K;h.unix=function(a){return v(1E3*a)};h.months=function(a,b){return bc(a,b,"months")};h.isDate=na;h.locale=Z;h.invalid=xa;h.duration=J;h.isMoment=H;h.weekdays=function(a,b,c){return mb(a,b,c,"weekdays")};h.parseZone=function(){return v.apply(null,arguments).parseZone()};h.localeData=Q;h.isDuration=Fa;h.monthsShort=function(a,b){return bc(a,b,"monthsShort")};h.weekdaysMin=function(a,b,c){return mb(a,b,c,"weekdaysMin")};h.defineLocale=cb;h.updateLocale=function(a,b){if(null!=
b){var c,d=Jb;null!=x[a]&&null!=x[a].parentLocale?x[a].set(Ta(x[a]._config,b)):(c=Ca(a),null!=c&&(d=c._config),b=Ta(d,b),null==c&&(b.abbr=a),b=new Ua(b),b.parentLocale=x[a],x[a]=b);Z(a)}else null!=x[a]&&(null!=x[a].parentLocale?(x[a]=x[a].parentLocale,a===Z()&&Z(a)):null!=x[a]&&delete x[a]);return x[a]};h.locales=function(){return ec(x)};h.weekdaysShort=function(a,b,c){return mb(a,b,c,"weekdaysShort")};h.normalizeUnits=F;h.relativeTimeRounding=function(a){return void 0===a?V:"function"===typeof a?
(V=a,!0):!1};h.relativeTimeThreshold=function(a,b){if(void 0===ma[a])return!1;if(void 0===b)return ma[a];ma[a]=b;"s"===a&&(ma.ss=b-1);return!0};h.calendarFormat=function(a,b){a=a.diff(b,"days",!0);return-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse"};h.prototype=f;h.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",
TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return h});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:moment', location = 'includes/js/amd/shim/moment-amd.js' */
define("moment",function(){return moment});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:collaborative-helper', location = 'loader/collaborative-helper.js' */
define("confluence-editor/loader/collaborative-helper",["jquery","ajs","confluence/meta","confluence/api/event","confluence/get-content-id"],function(c,g,r,f,k){function h(){var b=k();b!==l&&(i=c.Deferred(),l=b,c.when(i,m).done(function(){d.load()}));return i}function n(){e()?(h().resolve(),o.resolve(g.Rte.getEditor())):p("off")}function p(b){c('meta[name="ajs-collaborative-editor-status"]').attr("content",b)}function e(b){var a=b||{},b=a.id||k(),a=a.type||r.get("content-type");return("page"===a||
"blogpost"===a)&&"0"!==b}var d,m=c.Deferred(),l,i,q=c.Deferred(),j=c.Deferred(),o=c.Deferred();return{_init:function(){f.bind("rte-loaded",function(b,a){a.editPermission&&e(a)&&h().resolve()});f.bind("rte-quick-edit-init rte-initial-raw-content-ready",function(b,a){h().done(function(){if(e(a)){if(a){var b=a.syncRevSource&&!("synchrony"===a.syncRevSource||"synchrony-ack"===a.syncRevSource)?"unreconciled-recovery":c("<div>"+a.editorContent+"</div>").find(".fatal-render-error").length?"render":!1;b?
j.reject(b):j.resolve(a)}q.resolve()}})});f.bind("rte-quick-edit-ready",function(){n()});f.bind("rte-ready",function(){g.Rte.isQuickEdit||n()})},registerPlugin:function(b){d=b;m.resolve();q.done(function(){d.edit(j.promise(),o.promise())})},setStatus:p,isCollaborativeEditingAvailable:e,getEditorContent:function(){return e()&&"fake"!==c('meta[name="ajs-collaborative-editor-status"]').attr("content")?d.getSynchronisedEditorContent():{content:g.Rte.getEditor().getContent()}},hasUnsavedChanges:function(){return d.hasUnsavedChanges()}}});
require("confluence/module-exporter").safeRequire("confluence-editor/loader/collaborative-helper",function(c){c._init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:cql-user-information', location = '/js/cql-user-information.js' */
define("confluence-collaborative-editor-plugin/cql-user-information",["jquery","confluence/meta","confluence/api/constants"],function(l,b,m){function g(a){return a.map(function(c){var a=e.ACCOUNT_IDS[c.accountId||i]||e.USERNAMES[c.username||i]||n,c=Object.assign({},c);c.displayName=a.displayName;c.fullname=a.displayName;c.avatarURL=a.avatarURL;c.sub=c.sub||a.sub;return c})}function j(a){return a.map(function(a){return'"'+a+'"'})}var i="__UNDEFINED_OBJECT_KEY__",k=b.get("static-resource-url-prefix")+
"/images/icons/profilepics/default.png",n={sub:0,avatarURL:k,displayName:"Current User"},f=[],e={ACCOUNT_IDS:{},USERNAMES:{}},o=b.get("atlassian-account-id"),d=b.get("current-user-fullname"),d={displayName:d,displayname:d,fullName:d,fullname:d,avatarURL:b.get("current-user-avatar-uri-reference"),sub:0};e.ACCOUNT_IDS[o]=d;(b=b.get("remote-user"))&&(e.USERNAMES[b]=d);return function(a){Array.isArray(a)||(a=[a]);return!a.length?Promise.resolve([]):new Promise(function(c){var b=a.filter(function(a){return a.accountId&&
!e.ACCOUNT_IDS[a.accountId]&&"anonymous"!==a.accountId}).map(function(a){return a.accountId}),d=a.filter(function(a){return a.username&&!e.USERNAMES[a.username]&&"anonymous"!==a.username}).map(function(a){return a.username});if(!b.length&&!d.length)return c(g(a));var h=[];b.length&&h.push("user.accountid in ("+j(b).join(",")+")");d.length&&h.push("user in ("+j(d).join(",")+")");b="?cql="+encodeURIComponent(h.join(" or "));l.ajax({url:m.CONTEXT_PATH+"/rest/api/search/user"+b,dataType:"json",type:"GET",
contentType:"application/json",success:function(b){(b.results||[]).forEach(function(a){var a=(a||{}).user||{},b=f.indexOf(a.accountId);-1===f.indexOf(a.accountId)&&(f.push(a.accountId),b=f.length-1);b={sub:b,displayName:a.displayName||"anonymous",avatarURL:(a.profilePicture||{}).path||k};a.accountId&&"anonymous"!==a.accountId&&(e.ACCOUNT_IDS[a.accountId]=b);a.username&&"anonymous"!==a.username&&(e.USERNAMES[a.username]=b)});c(g(a))},failure:function(){c(g(a))}})})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-collaborative-editor-plugin:user-information', location = '/js/user-information.js' */
define("confluence-collaborative-editor-plugin/user-information",["jquery","confluence/meta","confluence/api/constants"],function(i,b,j){function e(a){return a.map(function(a){a=d[a]||k;return{avatarURL:a.avatarURL,displayName:a.displayName,fullname:a.fullname,sub:a.sub}})}var g=b.get("static-resource-url-prefix")+"/images/icons/profilepics/default.png",f=[],l=b.get("atlassian-account-id"),h=b.get("current-user-fullname"),b={displayName:h,fullname:h,avatarURL:b.get("current-user-avatar-uri-reference"),
sub:0},d={};d[l]=b;var k={avatarURL:g,displayName:"Current User",fullname:"Current User",sub:0};return function(a){if(!a)return Promise.resolve([]);Array.isArray(a)||(a=[a]);return new Promise(function(b){var c=a.filter(function(a){return a&&"anonymous"!==a&&!d[a]});if(!c.length)return b(e(a));c="?accountId="+c.join(",");i.ajax({url:j.CONTEXT_PATH+"/rest/api/user/bulk"+c,dataType:"json",type:"GET",contentType:"application/json",success:function(c){(c.results||[]).forEach(function(a){if(a){var b=f.indexOf(a.accountId);
-1===b&&(f.push(a.accountId),b=f.length-1);b={sub:b,displayName:a.displayName||"anonymous",fullname:a.displayName||"anonymous",avatarURL:(a.profilePicture||{}).path||g};a.accountId&&"anonymous"!==a.accountId&&(d[a.accountId]=b)}});b(e(a))},error:function(c){console.error("Failed to fetch user data: "+c.statusText);b(e(a))}})})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-quit-dialog', location = 'editor/page-editor-quit-dialog.js' */
define("confluence-editor/editor/page-editor-quit-dialog","jquery confluence/templates ajs confluence/meta window document confluence-editor/editor/page-editor-message confluence/api/constants underscore confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/dark-features confluence-collaborative-editor-plugin/cql-user-information confluence-collaborative-editor-plugin/user-information".split(" "),function(d,s,c,e,k,N,l,m,B,f,O,P,C){function D(a){a.stopPropagation();a.preventDefault();c.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.quit-dialog.show-diff-clicked"});b.showDiffButton.hide();w(false);b.hideDiffButton.show()}function E(a){a.stopPropagation();a.preventDefault();c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.hide-diff-clicked"});b.hideDiffButton.hide();b.closeButton.show();b.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");n(i)}function F(a){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard"});c.trigger("confluence.legacy-editor.discard-changes.started");
a.stopPropagation();a.preventDefault();f.UI.setButtonsState(false,b.buttonsAll);var o=e.get("content-id"),a=c.contextPath(),a=g?a+"/rest/synchrony/1.0/content/"+o+"/changes/unpublished":a+"/rest/api/content/"+o+"?status=draft";if(g){l.suppressMessage("editor.synchrony.revert-page");d(k).trigger("revert.tinymce",{pageVersion:c.params.pageVersion||"null"})}else d(k).trigger("delete.tinymce");d.ajax({url:a,type:"DELETE",data:{draftId:o},contentType:"application/json",dataType:"json"}).done(function(){g&&
l.handleMessage("collaborative-editor-discard-error",{type:"success",close:"auto",message:"Successfully reverted to the last published version"});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-success",data:{contentId:o}});c.trigger("confluence.legacy-editor.discard-changes.succeeded");x()}).fail(function(a){var d=JSON.parse(a.responseText),e="There were errors discarding your draft.",a=a.errors||"An unknown error has occurred. Please check your logs.";if(d.data&&
d.data.errors&&d.data.errors[0]&&d.data.errors[0].message.key==="content.delete.published"){e="This page has already been published";a="You can no longer discard this draft because its not a draft anymore!"}l.handleMessage("collaborative-editor-discard-error",{type:"error",title:g?"Can\'t revert to last published version":e,message:g?"We can\'t get the last published version of the page at the moment. Give it a few moments then try discarding the draft again.":a});c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.discard-error",
data:{contentId:o}});c.trigger("confluence.legacy-editor.discard-changes.failed");b.dialog.hide();f.UI.setButtonsState(true,b.buttonsAll)})}function x(){b.editorForm.append(s.Editor.Page.hiddenInputCancel()).submit()}function y(a){if(a){a.stopPropagation();a.preventDefault()}c.trigger("confluence.legacy-editor.close.succeeded");x()}function G(a){f.UI.setButtonsState(false,b.buttonsAll);t.save(a).done(function(){q.resolve()})}function H(a){a.stopPropagation();a.preventDefault();i=null;c.trigger("analyticsEvent",
{name:"confluence.synchrony.editor.draft-status-indicator.click"});b.closeButton.show();w(true)}function I(a){a.stopPropagation();a.preventDefault();b.closeButton.show();e.get("new-page")?n(h.DELETE):n(h.REVERT)}function J(a){a.stopPropagation();a.preventDefault();f.Drafts.isDraftDirty()?r(z):z()}function z(){var a=e.get("content-id"),b=e.get("space-key"),c=m.CONTEXT_PATH+"/spaces/"+b+"/pages/edit-v2/"+a;d.ajax({url:m.CONTEXT_PATH+"/rest/api/content/"+a+"?status=draft&expand=body.atlas_doc_format,metadata.properties.editor",
type:"GET"}).success(function(b){b.body.atlas_doc_format.value.includes('"extensionKey":"__confluenceADFMigrationUnsupportedContentInternalExtension__"')?l.handleMessage("collaborative-editor-discard-error",{type:"error",title:"Your page is not migratable to Fabric Editor!",message:"Your page contains content, that is not migratable to Fabric Editor."}):b.metadata.properties.editor?d.ajax({url:m.CONTEXT_PATH+"/rest/api/content/"+a+"/property/editor",type:"PUT",data:JSON.stringify({key:"editor",value:"v2",
version:{number:b.metadata.properties.editor.version.number+1,minorEdit:false}}),contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(){k.location.href=c}).fail(function(){u()}):d.ajax({url:m.CONTEXT_PATH+"/rest/api/content/"+a+"/property",type:"POST",data:JSON.stringify({key:"editor",value:"v2",version:{number:1,minorEdit:false}}),contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(){k.location.href=c}).fail(function(){u()})}).fail(function(){u()})}
function u(){l.handleMessage("collaborative-editor-discard-error",{type:"error",title:"Something went wrong migrating page to Fabric Editor!",message:"Please reload your editor and try again."})}function K(a){a.stopPropagation();a.preventDefault();b.dialog.hide()}function w(a){function c(){d.ajax({url:m.CONTEXT_PATH+"/rest/tinymce/1/content/"+e.get("page-id")+"/draft/diff",type:"GET"}).success(function(a){d(".diff-spinner").hide();b.dialogContent.find(".wiki-content").html(a).children().first().hasClass("diff-context-placeholder")&&
b.dialogContent.find("hr").hide()})}b.dialogEl.removeClass("aui-dialog2-medium").addClass("aui-dialog2-xlarge");n(h.SHOW_DIFF);d(".diff-spinner").show();a?r(c):c()}function n(a){function c(){return a===h.SHOW_DIFF&&(i===h.REVERT||i===h.DELETE)}var f=j.requireSynchronyPresence();p=p.map(function(a){if(f)a.active=f.isUserActive(a.accountId);return a}).sort(function(a,b){return a.active&&!b.active?false:!a.active&&b.active?true:a.lastModification<b.lastModification});var g=a;c()&&(g=i);C(p.map(function(a){return a.accountId})).then(function(f){b.dialogHeader.html(s.Editor.Page.quitDialogHeader({dialogType:g,
contentType:e.get("content-type"),newPage:e.get("new-page")}));b.dialogContent.html(s.Editor.Page.quitDialogContent({dialogType:a,contributors:f,contentType:e.get("content-type"),newDialog:i==null}));b.hideDiffButton=d("#qed-hide-diff-button").click(E);if(!e.get("new-page")){a!==h.SHOW_DIFF&&(i=a);b.showDiffButton=d("#qed-show-diff-button").click(D);b.showDiffButton.show();b.buttonsAll.push(b.showDiffButton)}if(a===h.DELETE||a===h.REVERT||c()){b.discardButton.show();b.dialogEl.addClass("aui-dialog2-warning")}else b.dialogEl.removeClass("aui-dialog2-warning");
b.closeButton.show();b.dialogFooter.find("."+a).show();b.dialog.show()})}function L(){c.trigger("analyticsEvent",{name:"confluence.synchrony.editor.quit-dialog.dialog-closed"});b.dialogEl.removeClass("aui-dialog2-xlarge").addClass("aui-dialog2-medium");f.UI.toggleSavebarBusy(false);b.dialogFooter.find(".aui-button").hide();b.dialogContent.empty()}function M(a,b){b&&b.contributors&&(p=B.reject(b.contributors,function(a){return a.accountId===e.get("atlassian-account-id")||a.name===e.get("remote-user")}))}
function r(a){f.Drafts.save({forceSave:g,skipErrorHandler:true,onSuccessHandler:a||d.noop})}var j={},b={},g,A,h={DELETE:"delete",REVERT:"revert",PUBLISH:"publish",UPDATE:"update",SHOW_DIFF:"diff"},p=[],v=false,t={},i,q;j.init=function(a){if(A=e.get("content-type")==="page"||e.get("content-type")==="blogpost"){if(!v){g=!e.get("new-page");b.discardButton=d("#qed-discard-button").tooltip({gravity:"s",className:"quit-editor-dialog"});b.discardButton.click(F);b.saveExitButton=d("#qed-save-exit-button").click(y);
b.publishButton=d("#qed-publish-button");b.closeButton=d("#qed-close-button").click(K);b.buttonsAll=[b.discardButton,b.saveExitButton,b.hideDiffButton,b.publishButton];b.dialog=c.dialog2("#quit-editor-dialog");b.dialogEl=b.dialog.$el;b.dialogHeader=b.dialogEl.find(".aui-dialog2-header");b.dialogContent=b.dialogEl.find(".aui-dialog2-content");b.dialogFooter=b.dialogEl.find(".aui-dialog2-footer");b.editorForm=d("#wysiwyg").closest("form");d("#rte-show-changes").on("click",H);d("#rte-show-revert").on("click",
I);d("#rte-show-migrate").on("click",J);b.dialog.on("hide",L);c.bind("editor-heartbeat",M);v=true}if(a){t.save=a.saveHandler;b.publishButton.click(G)}}};j.process=function(a){if(A){a.stopPropagation();a.preventDefault();d(k).one("editor-heartbeat",function(){switch(a.target.id){case f.UI.saveButton.attr("id"):case f.UI.versionCommentInput.attr("id"):f.UI.toggleSavebarBusy(true);if(p.length===0)t.save().done(function(){q.resolve()});else{r();n(g?h.UPDATE:h.PUBLISH)}break;case f.UI.cancelButton.attr("id"):f.Drafts.isDraftDirty()&&
r();y()}});f.heartbeat();q=d.Deferred();return q.promise()}var b=d.Deferred();b.fail();return b.promise()};j.requireSynchronyPresence=function(){return require("confluence-collaborative-editor-plugin/synchrony-presence")};j._destroy=function(){v=false};return j});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-soy', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" data-test-id="tiny-publish-button" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item aui-button-light" id="rte-button-preview" data-test-id="tiny-preview-button" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost' || opt_data.contentType == 'page') ? soy.$$escapeHtml('Publish') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" data-test-id="tiny-cancel-button" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<button class="toolbar-item-link aui-button aui-button-link" type="submit" id="rte-button-cancel" data-test-id="tiny-cancel-button" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish the page?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made, since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('You\x27ll also be publishing changes made by these people:') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div><span class="aui-icon aui-icon-wait diff-spinner"></span></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList147 = opt_data.contributors;
  var contributorListLen147 = contributorList147.length;
  for (var contributorIndex147 = 0; contributorIndex147 < contributorListLen147; contributorIndex147++) {
    var contributorData147 = contributorList147[contributorIndex147];
    output += '<li data-username="' + soy.$$escapeHtml(contributorData147.name) + '" data-account-id="' + soy.$$escapeHtml(contributorData147.accountId) + '"><div class="contributor-avatar ' + ((contributorData147.active) ? 'active' : '') + '"><img src="' + soy.$$escapeHtml(contributorData147.avatarURL) + '"></div><div class="contributor-detail"><p class="contributor-detail-name"><span>' + soy.$$escapeHtml(contributorData147.fullname) + '</span></p><p class="contributor-detail-last-modification"><span>' + soy.$$escapeHtml('Last edited') + ' ' + soy.$$escapeHtml(contributorData147.formattedLastModification) + '</span></p></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:editor-notifications', location = 'includes/js/editor-notifications.js' */
define("confluence/editor-notifications",[],function(){var a;return{notify:function(b,d,c){var e=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();void 0===c&&(c="error"===b?"manual":"auto");a=e({type:b,body:d,close:c})}}});require("confluence/module-exporter").safeRequire("confluence/editor-notifications",function(a){var b=require("ajs");b.bind("init.rte",function(){b.Confluence.EditorNotification=a})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-location', location = 'includes/js/page-location.js' */
define("confluence/page-location",["ajs","confluence/meta"],function(d,b){var c=null;return{get:function(){return c?c:{spaceName:b.get("space-name"),spaceKey:b.get("space-key"),parentPageTitle:b.get("parent-page-title")}},set:function(a){a&&(b.set("space-name",a.spaceName),b.set("space-key",a.spaceKey),a.hasOwnProperty("parentPageTitle")&&b.set("parent-page-title",a.parentPageTitle),a.hasOwnProperty("parentPageId")&&b.set("parent-page-id",a.parentPageId));c=a}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:breadcrumbs-js', location = 'includes/js/breadcrumbs.js' */
define("confluence/breadcrumbs",["jquery","ajs","document","confluence/templates"],function(b,c,e,f){function d(a){return b.ajax({type:"GET",dataType:"json",data:a,url:c.contextPath()+"/pages/breadcrumb.action",error:function(){},success:function(a){a&&a.breadcrumbs&&b("ol#breadcrumbs").html(f.Breadcrumbs.render({breadcrumbs:a.breadcrumbs,ellipsisIndex:a.ellipsisIndex,ellipsisLength:a.ellipsisLength}))}})}return{init:function(){b(e).on("click","#ellipsis",function(){try{b("#breadcrumbs .hidden-crumb").removeClass("hidden-crumb"),
b(this).addClass("hidden-crumb"),c.trigger("breadcrumbs.expanded")}catch(a){c.log(a)}})},updateWithPageId:function(a){return d({pageId:a})},update:function(a,b){return d({spaceKey:a,title:b})}}});require("confluence/module-exporter").safeRequire("confluence/breadcrumbs",function(b){require("ajs").toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-object', location = 'js/link-object.js' */
define("confluence-link-browser/link-object",["jquery","ajs","confluence-rest/confluence-rest"],function(d,h,p){function l(a){return d.nodeName(a,"img")?a:a.hasChildNodes()&&1===a.childNodes.length&&d.nodeName(a,"a")&&d.nodeName(a.firstChild,"img")?a.firstChild:null}function m(a){return a?d(a).attr("data-linked-resource-default-alias")||d(a).attr("src"):""}function n(a){var b={};"A"===a.nodeName&&d(a.attributes).each(function(){b[this.name]=this.value});return b}function k(a,b){for(;a&&a!=b;){if(3!=
a.nodeType)return!1;a=a.nextSibling}return 3===b.nodeType}var e={isLink:function(a){return a&&!!a.fillNode}},f=function(a){if(e.isLink(a))return a;var b={insert:function(){return require("confluence-link-browser/link-adapter").setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!d.isFunction(this[b])&&
(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&this.body.jquery?1===this.body.length&&this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==
a},isCustomAtlassianContentLink:function(){return this.classes&&this.classes.length?-1!=d.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},
isHrefValid:function(){return this.attrs.href&&"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return d.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},showsBreadcrumbs:function(){return!0}};if(a&&a.attrs){var f={},g=null;d.each(a.attrs,function(a,b){"class"==a?g=b:f[a]=b});a.attrs=f;if(g){var c=g.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(c):c}}d.extend(b,a);return b};e.fromData=function(a){return f(a)};
e.fromNode=function(a,b){f({attrs:{},body:{html:b,text:b}});return f({attrs:n(a),body:{html:b,text:b}})};e.fromSelectedAnchor=function(a,b){var e=d(a),g=l(a),c=!g&&k(a.firstChild,a.lastChild);return f({attrs:n(a),body:{isEditable:c,isImage:!!g,html:e.html(),imgName:m(g),text:b}})};e.fromSelection=function(a,b,d,e){b=l(b);var c;if(c=!b)if(a.collapsed)c=!0;else if(c=a.startContainer,c==a.endContainer)c=3===c.nodeType?!0:k(c.childNodes[a.startOffset],c.childNodes[a.endOffset-1]);else{var g=require("tinymce").activeEditor.dom;
c=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=c&&a&&c.parentNode==a.parentNode?{start:c,end:a}:null;c=!!a&&k(a.start,a.end)}return f({attrs:{},body:{isEditable:c,isImage:!!b,html:d,imgName:m(b),text:e}})};e.fromREST=function(a){var b=f({attrs:{"data-base-url":h.Confluence.getBaseUrl(),"data-linked-resource-id":a.id||a.content&&a.content.id||"","data-linked-resource-type":a.type||
a.content&&a.content.type||"","data-linked-resource-content-type":a.contentType||a.content&&a.content.type||"",href:p.REST.findLink(a.link)||a.url,"data-linked-resource-default-alias":a.title},body:{html:h.escapeHtml(a.title),text:h.escapeHtml(a.title)},classes:["confluence-link"]});"user"===a.type&&(b.attrs["data-linked-resource-type"]="userinfo");return b};e.createLinkToNewPage=function(a,b){return f({attrs:{"data-space-key":b,"data-content-title":a,href:h.contextPath()+"/pages/createpage.action?spaceKey\x3d"+
b+"\x26title\x3d"+a+"\x26atl_token\x3d"+h.Meta.get("atl-token")},body:{html:h.escapeEntities(a),text:a},classes:["createlink","confluence-link"]})};e.makeExternalLink=function(a){return f({attrs:{href:a},body:{html:a,text:a}})};e.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))};return e});require("confluence/module-exporter").exportModuleAsGlobal("confluence-link-browser/link-object","Confluence.Link");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-adapter', location = 'js/link-adapter.js' */
define("confluence-link-browser/link-adapter",["ajs","jquery","confluence-link-browser/link-object"],function(d,e,f){return{setLink:function(a){var b=d.Rte.getEditor(),b=e(b.dom.create("a"),b.getDoc());a.fillNode(b);a=require("tinymce").confluence.NodeUtils.replaceSelection(b);e("#comments-section").length&&d.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=d.Rte.getEditor().selection;var g=a.getNode();if(c=e(g).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),
f.fromSelectedAnchor(c,b);c=a.getRng(!0);b=a.getContent({format:"text"});a=a.getContent();return f.fromSelection(c,g,a,b)}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("conf/confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore","confluence/meta"],function(e,b,f){return{triggerEvent:function(c,a,d,b){a&&a.length&&(a={contentType:f.get("content-type"),multiple:1<a.length,number:a.length,isAllImage:void 0===d?this._isAllImages(a):d,source:b},e.trigger("analyticsEvent",{name:c,data:a}))},_isAllImages:function(c){return b.every(c,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:file-types-utils-resources', location = 'utils/file-types-utils.js' */
define("confluence-editor/utils/file-types-utils",[],function(){var e={"content-type-attachment-image":"image/gif image/jpeg image/pjpeg image/png image/tiff image/bmp".split(" "),"content-type-attachment-pdf":["application/pdf"],"content-type-attachment-multimedia-video":"audio/mpeg audio/x-wav audio/mp3 audio/mp4 video/mpeg video/quicktime video/mp4 video/x-m4v video/x-flv video/x-ms-wmv video/avi video/webm video/vnd.rn-realvideo".split(" "),"content-type-attachment-code":"text/html text/xml text/javascript application/javascript application/x-javascript text/css text/x-java-source".split(" "),
"content-type-attachment-text":["application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain"],"content-type-attachment-spreadsheet":["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],"content-type-attachment-powerpoint":["application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"],"content-type-attachment-zip":["application/zip","application/java-archive"]},
b={},c;for(c in e)for(var f=e[c],d=0,g=f.length;d<g;d++)b[f[d]]=c;return{getAUIIconFromMime:function(a){return b[a]||"content-type-attachment-file"},isImage:function(a){return b[a]&&0===a.indexOf("image/")}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/utils/file-types-utils","AJS.Confluence.FileTypesUtils");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:plupload', location = 'includes/js/third-party/plupload.js' */
(function(){function x(){this.returnValue=!1}function y(){this.cancelBubble=!0}var z=0,n=[],u={},v={},t={},w={"\x3c":"lt","\x3e":"gt","\x26":"amp",'"':"quot","'":"#39"},A=/[<>&\"\']/g,p=window.setTimeout,l={},h;(function(a){a=a.split(/,/);var b,d,c;for(b=0;b<a.length;b+=2)for(c=a[b+1].split(/ /),d=0;d<c.length;d++){v[c[d]]=a[b];var g=t[a[b]]||[];g.push(c[d]);t[a[b]]=g}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/java-archive,jar,application/java-archive,war,application/java-archive,ear,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.spreadsheetml.template,xltx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,audio/mpeg,mpga mpega mp2 mp3,audio/mp3,mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/xml,xml,text/javascript,js,text/css,css,text/rtf,rtf,text/x-java-source,java,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,text/csv,csv,text/plain,asc txt text diff log,application/octet-stream,exe");
var c={VERSION:"@@version@@",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:v,mineTypeToExtensionsMap:t,ua:function(){var a=navigator,b=a.userAgent,d=a.vendor,c,g;g=(c=/WebKit/.test(b))&&-1!==d.indexOf("Apple");d=window.opera&&window.opera.buildNumber;return{windows:-1!==navigator.platform.indexOf("Win"),
ie:!c&&!d&&/MSIE/gi.test(b)&&/Explorer/gi.test(a.appName),webkit:c,gecko:!c&&/Gecko/.test(b),safari:g,opera:!!d}}(),extend:function(a){c.each(arguments,function(b,d){0<d&&c.each(b,function(b,c){a[c]=b})});return a},getElement:function(a){return a&&1===a.nodeType?a:document.getElementById(a)},cleanName:function(a){var b,c;c=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,
"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);a=a.replace(/\s+/g,"_");return a=a.replace(/[^a-z0-9_\-\.]+/gi,"")},addRuntime:function(a,b){b.name=a;n[a]=b;n.push(b);return b},guid:function(){var a=(new Date).getTime().toString(32),b;for(b=0;5>b;b++)a+=Math.floor(65535*Math.random()).toString(32);return(c.guidPrefix||"p")+a+(z++).toString(32)},buildUrl:function(a,b){var d="";c.each(b,function(a,b){d+=(d?"\x26":"")+encodeURIComponent(b)+
"\x3d"+encodeURIComponent(a)});d&&(a+=(0<a.indexOf("?")?"\x26":"?")+d);return a},each:function(a,b){var c,e;if(a)if(c=a.length,void 0===c)for(e in a){if(a.hasOwnProperty(e)&&!1===b(a[e],e))break}else for(e=0;e<c&&!1!==b(a[e],e);e++);},formatSize:function(a){return void 0===a||/\D/.test(a)?c.translate("N/A"):1073741824<a?Math.round(a/1073741824,1)+" GB":1048576<a?Math.round(a/1048576,1)+" MB":1024<a?Math.round(a/1024,1)+" KB":a+" b"},getPos:function(a,b){function c(a){var b,c=0;b=0;a&&(b=a.getBoundingClientRect(),
a="CSS1Compat"===h.compatMode?h.documentElement:h.body,c=b.left+a.scrollLeft,b=b.top+a.scrollTop);return{x:c,y:b}}var e=0,g=0,f,h=document;b=b||h.body;if(a&&a.getBoundingClientRect&&0<navigator.userAgent.indexOf("MSIE")&&8!==h.documentMode)return a=c(a),b=c(b),{x:a.x-b.x,y:a.y-b.y};for(f=a;f&&f!=b&&f.nodeType;)e+=f.offsetLeft||0,g+=f.offsetTop||0,f=f.offsetParent;for(f=a.parentNode;f&&f!=b&&f.nodeType;)e-=f.scrollLeft||0,g-=f.scrollTop||0,f=f.parentNode;return{x:e,y:g}},getSize:function(a){return{w:a.offsetWidth||
a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(a){var b;"string"==typeof a&&(a=/^([0-9]+)([mgk]?)$/.exec(a.toLowerCase().replace(/[^0-9mkg]/g,"")),b=a[2],a=+a[1],"g"==b&&(a*=1073741824),"m"==b&&(a*=1048576),"k"==b&&(a*=1024));return a},xmlEncode:function(a){return a?(""+a).replace(A,function(a){return w[a]?"\x26"+w[a]+";":a}):a},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++)c[b]=a[b];return c},addI18n:function(a){return c.extend(u,a)},translate:function(a){return u[a]||
a},isEmptyObj:function(a){if(void 0===a)return!0;for(var b in a)return!1;return!0},hasClass:function(a,b){return""==a.className?!1:(new RegExp("(^|\\s+)"+b+"(\\s+|$)")).test(a.className)},addClass:function(a,b){c.hasClass(a,b)||(a.className=""==a.className?b:a.className.replace(/\s+$/,"")+" "+b)},removeClass:function(a,b){a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)"),function(a,b,c){return" "===b&&" "===c?" ":""})},getStyle:function(a,b){if(a.currentStyle)return a.currentStyle[b];
if(window.getComputedStyle)return window.getComputedStyle(a,null)[b]},addEvent:function(a,b,d,e){var g;b=b.toLowerCase();void 0===h&&(h="Plupload_"+c.guid());a.addEventListener?(g=d,a.addEventListener(b,g,!1)):a.attachEvent&&(g=function(){var a=window.event;a.target||(a.target=a.srcElement);a.preventDefault=x;a.stopPropagation=y;d(a)},a.attachEvent("on"+b,g));void 0===a[h]&&(a[h]=c.guid());l.hasOwnProperty(a[h])||(l[a[h]]={});a=l[a[h]];a.hasOwnProperty(b)||(a[b]=[]);a[b].push({func:g,orig:d,key:e})},
removeEvent:function(a,b,d){var e,g;"function"==typeof d?e=d:g=d;b=b.toLowerCase();if(a[h]&&l[a[h]]&&l[a[h]][b]){d=l[a[h]][b];for(var f=d.length-1;0<=f;f--)if(d[f].key===g||d[f].orig===e)if(a.detachEvent?a.detachEvent("on"+b,d[f].func):a.removeEventListener&&a.removeEventListener(b,d[f].func,!1),d[f].orig=null,d[f].func=null,d.splice(f,1),void 0!==e)break;d.length||delete l[a[h]][b];if(c.isEmptyObj(l[a[h]])){delete l[a[h]];try{delete a[h]}catch(B){a[h]=void 0}}}},removeAllEvents:function(a,b){void 0!==
a[h]&&a[h]&&c.each(l[a[h]],function(d,e){c.removeEvent(a,e,b)})},Uploader:function(a){function b(){var a,b=0,d;if(this.state==c.STARTED){for(d=0;d<f.length;d++)a||f[d].status!=c.QUEUED?b++:(a=f[d],a.status=c.UPLOADING,this.trigger("BeforeUpload",a)&&this.trigger("UploadFile",a));b==f.length&&(this.stop(),this.trigger("UploadComplete",f))}}function d(){var a,b;g.reset();for(a=0;a<f.length;a++)b=f[a],void 0!==b.size?(g.size+=b.size,g.loaded+=b.loaded):g.size=void 0,b.status==c.DONE?g.uploaded++:b.status==
c.FAILED?g.failed++:g.queued++;void 0===g.size?g.percent=0<f.length?Math.ceil(g.uploaded/f.length*100):0:(g.bytesPerSec=Math.ceil(g.loaded/((+new Date-h||1)/1E3)),g.percent=0<g.size?Math.ceil(g.loaded/g.size*100):0)}var e={},g,f=[],h;g=new c.QueueProgress;a=c.extend({chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",filters:[]},a);c.extend(this,{state:c.STOPPED,runtime:"",features:{},files:f,settings:a,total:g,id:c.guid(),init:function(){function m(){var a=q[l++],b,d,f;if(a){b=a.getFeatures();
if(d=k.settings.required_features)for(d=d.split(","),f=0;f<d.length;f++)if(!b[d[f]]){m();return}a.init(k,function(c){c&&c.success?(k.features=b,k.runtime=a.name,k.trigger("Init",{runtime:a.name}),k.trigger("PostInit"),k.refresh()):m()})}else k.trigger("Error",{code:c.INIT_ERROR,message:c.translate("Init error.")})}var k=this,e,q,l=0,r;"function"==typeof a.preinit?a.preinit(k):c.each(a.preinit,function(a,b){k.bind(b,a)});a.page_url=a.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");/^(\w+:\/\/|\/)/.test(a.url)||
(a.url=a.page_url+a.url);a.chunk_size=c.parseSize(a.chunk_size);a.max_file_size=c.parseSize(a.max_file_size);k.bind("FilesAdded",function(b,d){b.trigger("Started",d);var g,e,m=0,h;(g=a.filters)&&g.length&&(h=[],c.each(g,function(a){c.each(a.extensions.split(/,/),function(a){/^\s*\*\s*$/.test(a)?h.push("\\.*"):h.push("\\."+a.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$\x26")+"]","g"),"\\$\x26"))})}),h=new RegExp(h.join("|")+"$","i"));for(g=0;g<d.length;g++)e=d[g],e.loaded=0,e.percent=
0,e.status=c.QUEUED,h&&!h.test(e.name)?b.trigger("Error",{code:c.FILE_EXTENSION_ERROR,message:c.translate("File extension error."),file:e}):void 0!==e.size&&e.size>a.max_file_size?b.trigger("Error",{code:c.FILE_SIZE_ERROR,message:c.translate("File size error."),file:e}):(f.push(e),m++);if(m)p(function(){k.trigger("QueueChanged");k.refresh()},1);else return!1});a.unique_names&&k.bind("UploadFile",function(a,b){a=b.name.match(/\.([^.]+)$/);var c="tmp";a&&(c=a[1]);b.target_name=b.id+"."+c});k.bind("UploadProgress",
function(a,b){b.percent=0<b.size?Math.ceil(b.loaded/b.size*100):100;d()});k.bind("StateChanged",function(a){if(a.state==c.STARTED)h=+new Date;else if(a.state==c.STOPPED)for(e=a.files.length-1;0<=e;e--)a.files[e].status==c.UPLOADING&&(a.files[e].status=c.QUEUED,d())});k.bind("QueueChanged",d);k.bind("Error",function(a,e){e.file&&(e.file.status=c.FAILED,d(),a.state==c.STARTED&&(g.queued||p(function(){b.call(k)},1)))});k.bind("FileUploaded",function(a,d){d.status=c.DONE;d.loaded=d.size;a.trigger("UploadProgress",
d);p(function(){b.call(k)},1)});if(a.runtimes)for(q=[],r=a.runtimes.split(/\s?,\s?/),e=0;e<r.length;e++)n[r[e]]&&q.push(n[r[e]]);else q=n;m();"function"==typeof a.init?a.init(k):c.each(a.init,function(a,b){k.bind(b,a)})},refresh:function(){this.trigger("Refresh")},start:function(){this.state!=c.STARTED&&(this.state=c.STARTED,this.trigger("StateChanged"),b.call(this))},stop:function(){this.state!=c.STOPPED&&(this.state=c.STOPPED,this.trigger("CancelUpload"),this.trigger("StateChanged"))},getFile:function(a){var b;
for(b=f.length-1;0<=b;b--)if(f[b].id===a)return f[b]},removeFile:function(a){var b;for(b=f.length-1;0<=b;b--)if(f[b].id===a.id)return this.splice(b,1)[0]},splice:function(a,b){a=f.splice(void 0===a?0:a,void 0===b?f.length:b);this.trigger("FilesRemoved",a);this.trigger("QueueChanged");a[0].status==c.UPLOADING&&this.state==c.STARTED&&this.trigger("CancelUpload");if(!g.queued){var d=this;p(function(){d.trigger("UploadComplete")})}return a},trigger:function(a){var b=e[a.toLowerCase()],c,d;if(b)for(d=
Array.prototype.slice.call(arguments),d[0]=this,c=0;c<b.length;c++)if(!1===b[c].func.apply(b[c].scope,d))return!1;return!0},hasEventListener:function(a){return!!e[a.toLowerCase()]},bind:function(a,b,c){var d;a=a.toLowerCase();d=e[a]||[];d.push({func:b,scope:c||this});e[a]=d},unbind:function(a,b){a=a.toLowerCase();var c=e[a],d;if(c){if(void 0!==b)for(d=c.length-1;0<=d;d--){if(c[d].func===b){c.splice(d,1);break}}else c=[];c.length||delete e[a]}},unbindAll:function(){var a=this;c.each(e,function(b,c){a.unbind(c)})},
destroy:function(){this.trigger("Destroy");this.unbindAll()}})},File:function(a,b,c){this.id=a;this.name=b;this.size=c;this.status=this.percent=this.loaded=0},Runtime:function(){this.getFeatures=function(){};this.init=function(a,b){}},QueueProgress:function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}},runtimes:{}};window.plupload=c})();
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:plupload', location = 'includes/js/third-party/plupload.html5.js' */
(function(u,m,e,r){function E(e,g){var f;if("FileReader"in u)f=new FileReader,f.readAsDataURL(e),f.onload=function(){g(f.result)};else return g(e.getAsDataURL())}function F(e,g,k,h){var c,a,b,v,q=this;E(x[e.id],function(d){c=m.createElement("canvas");c.style.display="none";m.body.appendChild(c);a=c.getContext("2d");b=new Image;b.onerror=b.onabort=function(){h({success:!1})};b.onload=function(){var f,p,l,n;g.width||(g.width=b.width);g.height||(g.height=b.height);v=Math.min(g.width/b.width,g.height/
b.height);if(1>v||1===v&&"image/jpeg"===k){f=Math.round(b.width*v);p=Math.round(b.height*v);c.width=f;c.height=p;a.drawImage(b,0,0,f,p);if("image/jpeg"===k){if(l=new B(atob(d.substring(d.indexOf("base64,")+7))),l.headers&&l.headers.length&&(n=new G,n.init(l.get("exif")[0])&&(n.setExif("PixelXDimension",f),n.setExif("PixelYDimension",p),l.set("exif",n.getBinary()),q.hasEventListener("ExifData")&&q.trigger("ExifData",e,n.EXIF()),q.hasEventListener("GpsData")&&q.trigger("GpsData",e,n.GPS()))),g.quality)try{d=
c.toDataURL(k,g.quality/100)}catch(t){d=c.toDataURL(k)}}else d=c.toDataURL(k);d=d.substring(d.indexOf("base64,")+7);d=atob(d);l&&l.headers&&l.headers.length&&(d=l.restore(d),l.purge());c.parentNode.removeChild(c);h({success:!0,data:d})}else h({success:!1})};b.src=d})}function C(){function e(c,a){var b=k?0:-8*(a-1),e=0,q;for(q=0;q<a;q++)e|=h.charCodeAt(c+q)<<Math.abs(b+8*q);return e}function g(c,a,b){b=3===arguments.length?b:h.length-a-1;h=h.substr(0,a)+c+h.substr(b+a)}var k=!1,h;return{II:function(c){if(c===
r)return k;k=c},init:function(c){k=!1;h=c},SEGMENT:function(c,a,b){switch(arguments.length){case 1:return h.substr(c,h.length-c-1);case 2:return h.substr(c,a);case 3:g(b,c,a);break;default:return h}},BYTE:function(c){return e(c,1)},SHORT:function(c){return e(c,2)},LONG:function(c,a){if(a===r)return e(c,4);var b="",h=k?0:-24,q;for(q=0;4>q;q++)b+=String.fromCharCode(a>>Math.abs(h+8*q)&255);g(b,c,4)},SLONG:function(c){c=e(c,4);return 2147483647<c?c-4294967296:c},STRING:function(c,a){var b="";for(a+=
c;c<a;c++)b+=String.fromCharCode(e(c,1));return b}}}function B(e){var g={65505:{app:"EXIF",name:"APP1",signature:"Exif\x00"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\x00"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\x00"}},f=[],h,c,a=r,b=0;h=new C;h.init(e);if(65496===h.SHORT(0)){c=2;for(e=Math.min(1048576,e.length);c<=e;)if(a=h.SHORT(c),65488<=a&&65495>=a)c+=2;else{if(65498===a||65497===a)break;b=h.SHORT(c+2)+2;g[a]&&h.STRING(c+4,g[a].signature.length)===g[a].signature&&f.push({hex:a,
app:g[a].app.toUpperCase(),name:g[a].name.toUpperCase(),start:c,length:b,segment:h.SEGMENT(c,b)});c+=b}h.init(null);return{headers:f,restore:function(a){h.init(a);var b=new B(a);if(!b.headers)return!1;for(a=b.headers.length;0<a;a--){var d=b.headers[a-1];h.SEGMENT(d.start,d.length,"")}b.purge();c=65504==h.SHORT(2)?4+h.SHORT(4):2;a=0;for(b=f.length;a<b;a++)h.SEGMENT(c,0,f[a].segment),c+=f[a].length;return h.SEGMENT()},get:function(a){for(var b=[],d=0,c=f.length;d<c;d++)f[d].app===a.toUpperCase()&&b.push(f[d].segment);
return b},set:function(a,b){var d=[];"string"===typeof b?d.push(b):d=b;b=ii=0;for(var c=f.length;b<c&&!(f[b].app===a.toUpperCase()&&(f[b].segment=d[ii],f[b].length=d[ii].length,ii++),ii>=d.length);b++);},purge:function(){f=[];h.init(null)}}}}function G(){function e(a,b){var e=g.SHORT(a),f,d,k,p,l,n,m={};for(f=0;f<e;f++)if(l=a+12*f+2,k=b[g.SHORT(l)],k!==r){d=g.SHORT(l+=2);p=g.LONG(l+=2);l+=4;n=[];switch(d){case 1:case 7:4<p&&(l=g.LONG(l)+h.tiffHeader);for(d=0;d<p;d++)n[d]=g.BYTE(l+d);break;case 2:4<
p&&(l=g.LONG(l)+h.tiffHeader);m[k]=g.STRING(l,p-1);continue;case 3:2<p&&(l=g.LONG(l)+h.tiffHeader);for(d=0;d<p;d++)n[d]=g.SHORT(l+2*d);break;case 4:1<p&&(l=g.LONG(l)+h.tiffHeader);for(d=0;d<p;d++)n[d]=g.LONG(l+4*d);break;case 5:l=g.LONG(l)+h.tiffHeader;for(d=0;d<p;d++)n[d]=g.LONG(l+4*d)/g.LONG(l+4*d+4);break;case 9:l=g.LONG(l)+h.tiffHeader;for(d=0;d<p;d++)n[d]=g.SLONG(l+4*d);break;case 10:l=g.LONG(l)+h.tiffHeader;for(d=0;d<p;d++)n[d]=g.SLONG(l+4*d)/g.SLONG(l+4*d+4);break;default:continue}p=1==p?n[0]:
n;c.hasOwnProperty(k)&&"object"!=typeof p?m[k]=c[k][p]:m[k]=p}return m}var g,k,h={},c;g=new C;k={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",
41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",
14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",
16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",
79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},
Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};return{init:function(a){h={tiffHeader:10};if(a===r||!a.length)return!1;g.init(a);return 65505===g.SHORT(0)&&"EXIF\x00"===g.STRING(4,5).toUpperCase()?(a=h.tiffHeader,g.II(18761==g.SHORT(a)),42!==g.SHORT(a+=2)?a=!1:(h.IFD0=h.tiffHeader+g.LONG(a+2),
a=e(h.IFD0,k.tiff),h.exifIFD="ExifIFDPointer"in a?h.tiffHeader+a.ExifIFDPointer:r,h.gpsIFD="GPSInfoIFDPointer"in a?h.tiffHeader+a.GPSInfoIFDPointer:r,a=!0),a):!1},EXIF:function(){var a;a=e(h.exifIFD,k.exif);a.ExifVersion&&(a.ExifVersion=String.fromCharCode(a.ExifVersion[0],a.ExifVersion[1],a.ExifVersion[2],a.ExifVersion[3]));return a},GPS:function(){var a;a=e(h.gpsIFD,k.gps);a.GPSVersionID&&(a.GPSVersionID=a.GPSVersionID.join("."));return a},setExif:function(a,b){if("PixelXDimension"!==a&&"PixelYDimension"!==
a)return!1;var c,e,d,f=0;if("string"===typeof a)for(hex in c=k.exif,c)if(c[hex]===a){a=hex;break}c=h.exifIFD;e=g.SHORT(c);for(i=0;i<e;i++)if(d=c+12*i+2,g.SHORT(d)==a){f=d+8;break}f?(g.LONG(f,b),b=!0):b=!1;return b},getBinary:function(){return g.SEGMENT()}}}var x={},D;e.runtimes.Html5=e.addRuntime("html5",{getFeatures:function(){var f,g,k,h,c,a;g=k=c=a=!1;u.XMLHttpRequest&&(f=new XMLHttpRequest,k=!!f.upload,g=!(!f.sendAsBinary&&!f.upload));g&&(h=!!(f.sendAsBinary||u.Uint8Array&&u.ArrayBuffer),c=!(!File||
!File.prototype.getAsDataURL&&!u.FileReader||!h),a=!(!File||!(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)));D=e.ua.safari&&e.ua.windows&&navigator.userAgent&&0<navigator.userAgent.indexOf("Version/4");f=g;g=m.createElement("div");return{html5:f,dragdrop:"draggable"in g||"ondragstart"in g&&"ondrop"in g,jpgresize:c,pngresize:c,multipart:c||!!u.FileReader||!!u.FormData,canSendBinary:h,cantSendBlobInFormData:!(!(e.ua.gecko&&u.FormData&&u.FileReader)||FileReader.prototype.readAsArrayBuffer),
progress:k,chunks:a,multi_selection:!(e.ua.safari&&e.ua.windows),triggerDialog:e.ua.gecko&&u.FormData||e.ua.webkit||e.ua.windows}},init:function(f,g){function k(a){var b,c,g=[],d,h={};for(c=0;c<a.length;c++)b=a[c],h[b.name]||(h[b.name]=!0,d=e.guid(),x[d]=b,d=new e.File(d,b.fileName||b.name,b.fileSize||b.size),d.nativeFile=b,g.push(d));g.length&&f.trigger("FilesAdded",g)}var h,c;h=this.getFeatures();h.html5?(f.upload=function(a){k(a)},f.bind("Init",function(a){var b,c,g=[],d,h,p=a.settings.filters,
l,n;d=m.body;var t;b=m.createElement("div");b.id=a.id+"_html5_container";e.extend(b.style,{position:"absolute",background:f.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99999,opacity:f.settings.shim_bgcolor?"":0});b.className="plupload html5";f.settings.container&&(d=m.getElementById(f.settings.container),"static"===e.getStyle(d,"position")&&(d.style.position="relative"));d.appendChild(b);d=0;a:for(;d<p.length;d++)for(l=p[d].extensions.split(/,/),h=0;h<
l.length;h++){if("*"===l[h]){g=[];break a}(n=e.mimeTypes[l[h]])&&g.push(n)}b.innerHTML='\x3cinput id\x3d"'+f.id+'_html5"  style\x3d"font-size:999px" type\x3d"file" accept\x3d"'+g.join(",")+'" '+(f.settings.multi_selection&&f.features.multi_selection?'multiple\x3d"multiple"':"")+" /\x3e";b.scrollTop=100;t=m.getElementById(f.id+"_html5");f.settings.inputFileClazz&&(t.className+=" "+f.settings.inputFileClazz);a.features.triggerDialog?e.extend(t.style,{position:"absolute",width:"100%",height:"100%"}):
e.extend(t.style,{cssFloat:"right",styleFloat:"right"});var u=function(){k(this.files);-1===navigator.appVersion.indexOf("MSIE10")?(t=this.cloneNode(!0),t.onchange=u,this.parentNode.replaceChild(t,this)):this.value=""};t.onchange=u;if(c="string"===typeof a.settings.browse_button?m.getElementById(a.settings.browse_button):a.settings.browse_button){var r=a.settings.browse_button_hover,y=a.settings.browse_button_active;b=a.features.triggerDialog?c:b;r&&(e.addEvent(b,"mouseover",function(){e.addClass(c,
r)},a.id),e.addEvent(b,"mouseout",function(){e.removeClass(c,r)},a.id));y&&(e.addEvent(b,"mousedown",function(){e.addClass(c,y)},a.id),e.addEvent(m.body,"mouseup",function(){e.removeClass(c,y)},a.id));a.features.triggerDialog&&e.addEvent(c,"click",function(b){m.getElementById(a.id+"_html5").click();b.preventDefault()},a.id)}}),f.bind("PostInit",function(){var a=e.getElement(f.settings.drop_element),b,c=!1;a&&(D?(e.addEvent(a,"dragenter",function(b){var d;d=m.getElementById(f.id+"_drop");d||(d=m.createElement("input"),
d.setAttribute("type","file"),d.setAttribute("id",f.id+"_drop"),d.setAttribute("multiple","multiple"),e.addEvent(d,"change",function(){k(this.files);e.removeEvent(d,"change",f.id);d.parentNode.removeChild(d)},f.id),a.appendChild(d),c=!0);e.getPos(a,m.getElementById(f.settings.container));b=e.getSize(a);"static"===e.getStyle(a,"position")&&e.extend(a.style,{position:"relative"});e.extend(d.style,{position:"absolute",display:"block",top:0,left:0,width:b.w+"px",height:b.h+"px",opacity:0})},f.id),e.addEvent(a,
"dragleave",function(a){c||(b&&b.parentElement.removeChild(b),b=null);c=!1})):(e.addEvent(a,"dragover",function(a){a.preventDefault()},f.id),e.addEvent(a,"drop",function(a){if(!$(".disable-attachment-uploader").length){var c=a.dataTransfer;c&&c.files&&k(c.files)}b&&b.parentElement.removeChild(b);b=null;a.preventDefault();f.settings.stop_propagation&&(a.cancelBubble?a.cancelBubble=!0:a.stopPropagation())},f.id)))}),f.bind("Refresh",function(a){var b,c,h;if(b=m.getElementById(f.settings.browse_button))c=
e.getPos(b,m.getElementById(a.settings.container)),h=e.getSize(b),a=m.getElementById(f.id+"_html5_container"),e.extend(a.style,{top:c.y+"px",left:c.x+"px",width:h.w+"px",height:h.h+"px"}),f.features.triggerDialog&&("static"===e.getStyle(b,"position")&&e.extend(b.style,{position:"relative"}),c=parseInt(e.getStyle(b,"z-index"),10),isNaN(c)&&(c=0),e.extend(b.style,{zIndex:c}),e.extend(a.style,{zIndex:c-1}))}),f.bind("CancelUpload",function(){c&&c.abort&&c.abort()}),f.bind("UploadFile",function(a,b){function g(a,
b,c){var d;if(File.prototype.slice)try{return a.slice(),a.slice(b,c)}catch(H){return a.slice(b,c-b)}else return(d=File.prototype.webkitSlice||File.prototype.mozSlice)?d.call(a,b,c):null}function f(f){function l(){function n(d){var f=0,g="----pluploadboundary"+e.guid(),m,n="";c=new XMLHttpRequest;c.upload&&(c.upload.onprogress=function(c){b.loaded=Math.min(b.size,p+c.loaded-f);a.trigger("UploadProgress",b)});c.onreadystatechange=function(){var f,g;if(4==c.readyState){try{f=c.status}catch(I){f=0}if(400<=
f)a.trigger("Error",{code:e.HTTP_ERROR,message:e.translate("HTTP Error."),file:b,status:f,response:c.responseText||""});else{if(r){g={chunk:k,chunks:r,response:c.responseText,status:f};a.trigger("ChunkUploaded",b,g);p+=v;if(g.cancelled){b.status=e.FAILED;return}b.loaded=Math.min(b.size,(k+1)*w)}else b.loaded=b.size;a.trigger("UploadProgress",b);d=q=m=n=null;!r||++k>=r?(b.status=e.DONE,a.trigger("FileUploaded",b,{response:c.responseText,status:f})):l()}}};if(a.settings.multipart&&h.multipart){t.name=
b.target_name||b.name;c.open("post",A,!0);e.each(a.settings.headers,function(a,b){c.setRequestHeader(b,a)});c.setRequestHeader("X-Atlassian-Token","no-check");if("string"!==typeof d&&u.FormData){m=new FormData;e.each(e.extend(t,a.settings.multipart_params),function(a,b){m.append(b,a)});m.append(a.settings.file_data_name,d);c.send(m);return}if("string"===typeof d){c.setRequestHeader("Content-Type","multipart/form-data; boundary\x3d"+g);e.each(e.extend(t,a.settings.multipart_params),function(a,b){n+=
"--"+g+'\r\nContent-Disposition: form-data; name\x3d"'+b+'"\r\n\r\n';n+=unescape(encodeURIComponent(a))+"\r\n"});x=e.mimeTypes[b.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";n+="--"+g+'\r\nContent-Disposition: form-data; name\x3d"'+a.settings.file_data_name+'"; filename\x3d"'+unescape(encodeURIComponent(b.name))+'"\r\nContent-Type: '+x+"\r\n\r\n"+d+"\r\n--"+g+"--\r\n";f=n.length-d.length;d=n;if(c.sendAsBinary)c.sendAsBinary(d);else if(h.canSendBinary){for(var y=new Uint8Array(d.length),
z=0;z<d.length;z++)y[z]=d.charCodeAt(z)&255;c.send(y.buffer)}return}}A=e.buildUrl(a.settings.url,e.extend(t,a.settings.multipart_params));c.open("post",A,!0);c.setRequestHeader("Content-Type","application/octet-stream");c.setRequestHeader("X-Atlassian-Token","no-check");d.encoding&&c.setRequestHeader("Content-Encoding",d.encoding);e.each(a.settings.headers,function(a,b){c.setRequestHeader(b,a)});c.send(d.getData?d.getData():d)}var q,r,t,w,v,x,A=a.settings.url;b.status!=e.DONE&&b.status!=e.FAILED&&
a.state!=e.STOPPED&&(t={name:b.target_name||b.name},d.chunk_size&&b.size>d.chunk_size&&(h.chunks||"string"==typeof f)?(w=d.chunk_size,r=Math.ceil(b.size/w),v=Math.min(w,b.size-k*w),q="string"==typeof f?f.substring(k*w,k*w+v):g(f,k*w,k*w+v),t.chunk=k,t.chunks=r):(v=b.size,q=f),"string"!==typeof q&&m&&h.cantSendBlobInFormData&&h.chunks&&a.settings.chunk_size?(m.onload=function(){n(m.result)},m.readAsBinaryString(q)):n(q))}var k=0,p=0,m="FileReader"in u?new FileReader:null;l()}var d=a.settings,k;k=x[b.id];
h.jpgresize&&a.settings.resize&&/\.(png|jpg|jpeg)$/i.test(b.name)?F.call(a,b,a.settings.resize,/\.png$/i.test(b.name)?"image/png":"image/jpeg",function(a){a.success?(b.size=a.data.length,f(a.data)):f(k)}):f(k)}),f.bind("Destroy",function(a){var b,c,f=m.body,d={inputContainer:a.id+"_html5_container",inputFile:a.id+"_html5",browseButton:a.settings.browse_button,dropElm:a.settings.drop_element};for(b in d)(c=m.getElementById(d[b]))&&e.removeAllEvents(c,a.id);e.removeAllEvents(m.body,a.id);a.settings.container&&
(f=m.getElementById(a.settings.container));f.removeChild(m.getElementById(d.inputContainer))}),g({success:!0})):g({success:!1})}})})(window,document,plupload);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:plupload', location = 'includes/js/amd/shim/plupload-amd.js' */
define("plupload",function(){return plupload});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:jsUri', location = 'includes/js/third-party/jsUri.js' */
(function(l){function g(a){a=decodeURIComponent(a);return a=a.replace("+"," ")}function k(a){var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@\/]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a||""),b={};"source protocol authority userInfo user password host port relative path directory file query anchor".split(" ").forEach(function(a,e){b[a]=c[e]||""});return b}function h(a){var c,b,f,e,
d=[];if("undefined"===typeof a||null===a||""===a)return d;0===a.indexOf("?")&&(a=a.substring(1));c=a.toString().split(/[&;]/);for(a=0;a<c.length;a++)b=c[a],f=b.split("\x3d"),e=f[0],b=-1===b.indexOf("\x3d")?null:null===f[1]?"":f[1],d.push([e,b]);return d}function d(a){this.uriParts=k(a);this.queryPairs=h(this.uriParts.query);this.hasAuthorityPrefixUserPref=null}Array.prototype.forEach||(Array.prototype.forEach=function(a,c){for(var b=0,f=this.length;b<f;++b)a.call(c||this,this[b],b,this)});"protocol userInfo host port path anchor".split(" ").forEach(function(a){d.prototype[a]=
function(c){"undefined"!==typeof c&&(this.uriParts[a]=c);return this.uriParts[a]}});d.prototype.hasAuthorityPrefix=function(a){"undefined"!==typeof a&&(this.hasAuthorityPrefixUserPref=a);return null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref};d.prototype.query=function(a){var c="",b;"undefined"!==typeof a&&(this.queryPairs=h(a));for(a=0;a<this.queryPairs.length;a++)b=this.queryPairs[a],0<c.length&&(c+="\x26"),c=null===b[1]?c+b[0]:c+b.join("\x3d");
return 0<c.length?"?"+c:c};d.prototype.getQueryParamValue=function(a){var c,b;for(b=0;b<this.queryPairs.length;b++)if(c=this.queryPairs[b],g(a)===g(c[0]))return c[1]};d.prototype.getQueryParamValues=function(a){var c=[],b,f;for(b=0;b<this.queryPairs.length;b++)f=this.queryPairs[b],g(a)===g(f[0])&&c.push(f[1]);return c};d.prototype.deleteQueryParam=function(a,c){var b=[],f,e,d,h;for(f=0;f<this.queryPairs.length;f++)e=this.queryPairs[f],d=g(e[0])===g(a),h=g(e[1])===g(c),(1===arguments.length&&!d||2===
arguments.length&&!d&&!h)&&b.push(e);this.queryPairs=b;return this};d.prototype.addQueryParam=function(a,c,b){3===arguments.length&&-1!==b?(b=Math.min(b,this.queryPairs.length),this.queryPairs.splice(b,0,[a,c])):0<arguments.length&&this.queryPairs.push([a,c]);return this};d.prototype.replaceQueryParam=function(a,c,b){var d=-1,e,h;if(3===arguments.length){for(e=0;e<this.queryPairs.length;e++)if(h=this.queryPairs[e],g(h[0])===g(a)&&decodeURIComponent(h[1])===g(b)){d=e;break}this.deleteQueryParam(a,
b).addQueryParam(a,c,d)}else{for(e=0;e<this.queryPairs.length;e++)if(h=this.queryPairs[e],g(h[0])===g(a)){d=e;break}this.deleteQueryParam(a);this.addQueryParam(a,c,d)}return this};"protocol hasAuthorityPrefix userInfo host port path query anchor".split(" ").forEach(function(a){var c="set"+a.charAt(0).toUpperCase()+a.slice(1);d.prototype[c]=function(b){this[a](b);return this}});d.prototype.scheme=function(){var a="";this.protocol()?(a+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-
1&&(a+=":"),a+="//"):this.hasAuthorityPrefix()&&this.host()&&(a+="//");return a};d.prototype.origin=function(){var a=this.scheme();this.userInfo()&&this.host()&&(a+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(a+="@"));this.host()&&(a+=this.host(),this.port()&&(a+=":"+this.port()));return a};d.prototype.toString=function(){var a=this.origin();this.path()?a+=this.path():this.host()&&(this.query().toString()||this.anchor())&&(a+="/");this.query().toString()&&(0!==this.query().toString().indexOf("?")&&
(a+="?"),a+=this.query().toString());this.anchor()&&(0!==this.anchor().indexOf("#")&&(a+="#"),a+=this.anchor());return a};d.prototype.clone=function(){return new d(this.toString())};define("confluence/jsUri",function(){return d})})(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-owner-id="' + soy.$$escapeHtml(opt_data.file.ownerId) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.tooltip) + '">' + ((opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<i class="abs-icon select">Select</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedImageNameContent) + '</span>' + ((opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + soy.$$filterNoAutoescape(opt_data.highlightedParentTitleContent) + '</span>' : '') + '</li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItem.soyTemplateName = 'Confluence.Templates.File.fileDialogListItem';
}


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_ignored) {
  return '<li class="attached-file loading" data-attachment-id="' + soy.$$escapeHtml(opt_data.file.id) + '" data-file-name="' + soy.$$escapeHtml(opt_data.file.fileName) + '"><div class="file-container" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + ((opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>') + '<div id="docs-progress-bar-' + soy.$$escapeHtml(opt_data.file.fileId) + '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="' + soy.$$escapeHtml(opt_data.file.fileName) + '">' + soy.$$escapeHtml(opt_data.file.fileName) + '</span><span class="caption owner-title hidden" title=""></span></li>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.fileDialogListItemPlaceHolder.soyTemplateName = 'Confluence.Templates.File.fileDialogListItemPlaceHolder';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
define("confluence-editor/files/file-item/file-item-model","backbone ajs underscore plupload confluence-editor/utils/file-types-utils confluence-rest/confluence-rest confluence/api/constants".split(" "),function(e,f,g,c,h,i,d){return e.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:false,isFilePlaceHolder:false,isSelect:false,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.set("fileName",this.getFileName());
this.set("nonceUrl",this.getNonceUrl());this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("attachmentId")&&this.set("id",this.get("attachmentId"));this.get("isFilePlaceHolder")&&this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?true:!!this.get("thumbnailUrl")},
isPreviewable:function(){return(this.get("niceType")||"").toLocaleLowerCase()==="pdf document"||this.isImage()},getFileName:function(){return this.get("fileName")||this.get("name")||""},getDestinationUrl:function(){return i.REST.wikiLink(this.attributes).destination},getNonceUrl:function(){var a=this.get("thumbnailUrl");if(a.indexOf("modificationDate")>=0)return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);if(a){b=(a.indexOf("?")+1?"&":"?")+"nonce="+b;a=a+b}return a},
getRelativeUrl:function(a){if(!a)return a;if(a.indexOf(d.BASE_URL)===0){a=a.replace(d.BASE_URL,"");a=f.contextPath()+a}return a},_findThumbnailUrl:function(){!this.get("thumbnailUrl")&&this.get("thumbnailLink")&&this.set("thumbnailUrl",this.getRelativeUrl(this.get("thumbnailLink").href))},_findDownloadUrl:function(){var a=this.get("link");if(!this.get("downloadUrl")&&a){a=g.findWhere(a,{rel:"download"}).href;this.set("downloadUrl",this.getRelativeUrl(a))}},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+
1)},_parseFileNameToAuiIconClass:function(a){a=typeof c!=="undefined"?c.mimeTypes[this._getFileExtension(a)]:"";return h.getAUIIconFromMime(a)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-model","Confluence.Editor.FileDialog.FileItemModel");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
define("confluence-editor/files/file-item/file-item-view","backbone confluence/templates confluence/highlighter raphael underscore wrm jquery".split(" "),function(f,g,h,i,e,j,d){return f.View.extend({template:g.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},
render:function(){var a=this.highlighter||new h,b=this.model.get("space"),c=this.model.getFileName(),a={file:this.model.attributes,tooltip:this.showContainerInfo&&b?c+" ("+b.name+")":c,highlightedImageNameContent:a.highlight(c),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.attributes.parentTitle):null};this.$el=d(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:true});this.$el.attr("data-destination",this.model.getDestinationUrl());
this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",e.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("version")};
this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b={viewMode:"simple",openPreviewCallback:function(){d("#insert-image-dialog").hide();d(".aui-blanket").hide()},closePreviewCallback:function(){d("#insert-image-dialog").show();d(".aui-blanket").show()}},c=e.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},
this);this.dfd?this.dfd.done(e.partial(c,a,b)):this.dfd=j.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources",e.partial(c,a,b))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=i.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-item-view","Confluence.Editor.FileDialog.FileItemView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
define("confluence-editor/files/file-item/file-placeholder-view",["backbone","confluence/templates","underscore","ajs","jquery"],function(b,d,e,f,g){return b.View.extend({model:null,template:d.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",e.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=g(this.template({file:this.model.attributes}));
this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),f.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-item/file-placeholder-view","Confluence.Editor.FileDialog.FilePlaceHolderView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
define("confluence-editor/files/file-list/file-list-collection",["backbone","confluence-editor/files/file-item/file-item-model","underscore"],function(c,d,e){return c.Collection.extend({model:d,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){e.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();
for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-collection","Confluence.Editor.FileDialog.FileListCollection");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
define("confluence-editor/files/file-list/file-list-view","backbone confluence-editor/files/file-item/file-item-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-item/file-placeholder-view ajs jquery".split(" "),function(f,g,h,i,j,c){return f.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;if(a.eventListener){this.eventListener=
a.eventListener;this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile);this.listenTo(this.eventListener,"uploadingfile.cancelled",this._cancelUploadingFile)}this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",function(){this.context.setSelectItems(this.collection.getAllSelectItems())});
this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var d=this,e=j.contextPath()+"/rest/prototype/1/attachment/"+b+".json";c.get(e).done(function(b){var b=new h(b),c=d.collection.get(a);c||(c=d.collection.findWhere({fileName:b.get("fileName")}));c?d.collection.replaceFile(c,b):d.collection.addFile(b)})},_cancelUploadingFile:function(a){(a=
this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);this.collection.length===0&&this.$fileList.before(c("<p></p>").addClass("no-files").text(this.noFileMessage));b.shouldClearSelection&&this.collection.clearSelection();
this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new i({model:a,eventListener:this.eventListener})).render():(new g({model:a,showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||a.set("isSelect",true)}},_removeItem:function(a){if(this.$fileList&&
this.$fileList.length)(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=this._getViewFromModel(b),e=this._getDomElementByFileName(a.get("fileName"));e&&e.length?e.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",true)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var d=c(this);d.attr("data-file-name")===a&&(b=d)});return b},updatePanelContext:function(a){if(a){this.panelContext=
a;this.errors=this.panelContext.errors||[];this.$el=this.fileContainer=this.panelContext.fileContainer;this.el=this.$el[0];this.$fileList=this.$el.find(".file-list");this.delegateEvents();this.noFileMessage=this.panelContext.noFileMessage;this.showContainerInfo=this.panelContext.showContainerInfo;this.highlighter=this.panelContext.highlighter;this.displayErrors=this.panelContext.displayErrors}},updateDialogContext:function(a){if(a){this.context=a;this.contextOptions=this.context.options}},_checkError:function(a){(a=
a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&c(a.target);if(!a||!a.hasClass("close-tip")){this.collection.clearSelection();this.$el.find(".current").removeClass("current")}},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=c(a.target);if(!b.closest(".zoom").length){a.isTrigger||this.$fileList.find(".current").removeClass("current");a=b.closest("li").attr("data-attachment-id");(a=this.collection.get(a))&&
!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect"))}},_doubleClickItem:function(a){var a=c(a.target).closest("li"),b=a.attr("data-attachment-id");if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder")){a.click();this.context.insert()}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-list/file-list-view","Confluence.Editor.FileDialog.FileListView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
define("confluence-editor/files/base-panel/base-panel-view",["backbone","ajs","jquery"],function(b,a,c){return b.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(d){this.context=
d;this.render();var a=this;if(d=this.context.getPanel(this.panelId))d.onselect=function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return c(this.cssPanel,this.context.baseElement)},getContainer:function(){return c(this.cssContainer)},getForm:function(){return c("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},
displayErrors:function(a){this.uploader.displayErrors(a);this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}})});
require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/base-panel/base-panel-view","Confluence.Editor.FileDialog.BasePanel",function(){var b=require("underscore"),a=require("backbone");Confluence.Editor.FileDialog.eventListener=b.extend({},a.Events)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_ignored) {
  return '' + ((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("/wiki") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon">' + soy.$$escapeHtml('Upload files') + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml('Upload files') + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml('Image uploading...') + '</div>' : '') + '</div>' : '') + ((opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.File.uploadFileForm.soyTemplateName = 'Confluence.Templates.File.uploadFileForm';
}


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_ignored) {
  return '<div id="attached-files" class="scroll-wrapper">' + aui.message.warning({title: '', closeable: 'true', content: ''}) + '<div class="loading-message hidden">' + soy.$$escapeHtml('Loading\u2026') + '</div><ul class="file-list"></ul></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.attachedFilesPanel.soyTemplateName = 'Confluence.Templates.File.attachedFilesPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
define("confluence-editor/files/attachments-panel/attachments-panel-view","confluence-editor/files/file-list/file-list-view confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates ajs confluence/meta underscore window jquery confluence/attachment-uploader confluence-editor/utils/file-types-utils confluence-rest/confluence-rest".split(" "),function(m,i,n,j,k,f,h,l,e,g,o,p,q){return j.extend({id:"attachments",
panelId:"",cssPanel:".attachments-panel",cssContainer:"#attached-files",textNoFileMessage:"There are no files attached to this content.",textPanelTitle:"Attached to this content",initialize:function(a){j.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;this.collection=new n;this.fileListView=new m({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",
this);this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=g(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:this.textNoFileMessage,showContainerInfo:false,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);
this.messenger=this.uploader.getMessageHandler();this.collection.reset();this._canAttachFiles()?this.refresh({shouldClearSelection:true}):this.refresh({errors:["You\'ll need to ask permission to insert files here."],shouldClearSelection:true});return this},getPanel:function(){return k.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),atlToken:h.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+k.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=
this;return{onUploadSuccess:function(b){for(var d=0;d<b.length;d++){var c=b[d].id,e=a.collection.get(c);e&&a.collection.removeFile(e);c=f.contextPath()+"/rest/prototype/1/attachment/"+c+".json";g.get(c).done(function(b){b=new i(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);
a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return o({baseElement:this.getPanelElement()},l.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,d=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):false,c=this.xhrCount=this.xhrCount+1;f.getJSONWrap({url:this._getUrlREST(),messageHandler:this.messenger,loadingElement:d,errorMessage:this.textErrorRetrieving,successCallback:function(d){if(c===b.xhrCount){a.data=
d;b._onSuccessLoadFiles(a)}},errorCallback:l.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.attachment?a.data.attachment:a.data.images,a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",a.find("li").length===1);a.closest(".aui-message").append("<span class='aui-icon icon-warning'></span>")},setUploadInProgress:function(a,
b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,b;try{a=new XMLHttpRequest;b=!(!a.sendAsBinary&&!a.upload)&&!(g.browser.mozilla&&g.browser.version.indexOf("1.9.1")>-1)}catch(d){b=false}return b},addPreviewImage:function(a){var b=require("tinymce");if(e.File&&e.FileReader&&
e.FileList&&e.Blob){var d=this,b=b.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<b){var c=new FileReader;c.onload=function(){d._addFilePlaceHolderToCollection(a,c.result)};c.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,null)}},_addFilePlaceHolderToCollection:function(a,b){var d=null,c=this.collection.findWhere({fileName:a.name});if(c){this.collection.removeFile(c);c.get("isFilePlaceHolder")?
c.get("previousUploadedFile")&&(d=c.get("previousUploadedFile")):d=c}d=new i({isFilePlaceHolder:true,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b?b:"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b?b:"",previousUploadedFile:d});this.collection.addFile(d)},_isImageType:function(a){return p.isImage(a)},_canAttachFiles:function(){return h.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(h.get("attachment-source-content-id"),
10);return q.REST.makeUrl("content/"+a+"/attachments.json")},focus:function(){this.collection.clearSelection()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/attachments-panel/attachments-panel-view","Confluence.Editor.FileDialog.AttachmentsPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_ignored) {
  return '<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">' + soy.$$escapeHtml('Image URL:') + '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="' + soy.$$escapeHtml('Preview') + '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">' + soy.$$escapeHtml('This image couldn\x27t be loaded for preview. Please check the URL.') + '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.webPanel.soyTemplateName = 'Confluence.Templates.File.webPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
define("confluence-editor/files/external-panel/external-panel-view",["confluence-editor/files/base-panel/base-panel-view","confluence/templates","jquery","raphael","ajs"],function(c,e,d,f,g){return c.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:e.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert",
"blur input.image-url":"_checkAllowInsert"},initialize:function(){c.prototype.initialize.call(this);this.context=null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();
this._checkAllowInsert()},getPanel:function(){this.$el=d(e.File.webPanel());this.el=this.$el[0];this.delegateEvents();return this.el},_getImageInput:function(){return d("input.image-url",this.context.baseElement)},_submit:function(b){b.preventDefault();b.stopPropagation();var a=this,b=this._getImageInput().val();if("http://"===b)return!1;this.token++;var c=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=f.spinner(this.throbber[0],
60,"#666"));this.error.addClass("hidden");d("<img>").load(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.preview.removeClass("faraway");a._checkAllowInsert()}}).error(function(){if(c===a.token){a.killSpinner();a.killSpinner=null;a.throbber.addClass("hidden");a.error.removeClass("hidden");a._checkAllowInsert()}}).appendTo(this.preview).attr("src",b)},_checkAllowInsert:function(){var b=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==
b&&"http://"!==b?b:[])}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/external-panel/external-panel-view","Confluence.Editor.FileDialog.ExternalPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_ignored) {
  return '<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">' + soy.$$escapeHtml('Search') + '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">' + soy.$$escapeHtml('All Spaces') + '</option><option value="' + soy.$$escapeHtml(opt_data.spaceKey) + '">' + soy.$$escapeHtml(opt_data.spaceName) + '</option></select><button type="submit" class="aui-button search-button">' + soy.$$escapeHtml('Search') + '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">' + soy.$$escapeHtml('Searching\u2026') + '</div><ul class="file-list"></ul></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.searchPanel.soyTemplateName = 'Confluence.Templates.File.searchPanel';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
define("confluence-editor/files/search-panel/search-panel-view","confluence-editor/files/file-item/file-item-model confluence-editor/files/file-list/file-list-view confluence-editor/files/file-list/file-list-collection confluence-editor/files/base-panel/base-panel-view confluence/templates confluence/meta confluence/defaults confluence/highlighter underscore ajs jquery confluence-rest/confluence-rest confluence/api/event".split(" "),function(n,g,h,e,i,c,j,k,f,d,b,l,m){return e.extend({id:"search",
panelId:"",cssPanel:".search-panel",cssContainer:"#searched-images",template:i.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){e.prototype.initialize.call(this);this.context=null;this.collection=new h;this.fileListView=new g({collection:this.collection})},getPanel:function(){this.$el=b(this.template({spaceKey:c.get("space-key"),spaceName:c.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);
this.panelId=this.context.addPanel("Search other content",this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:true})},_submit:function(a){a.preventDefault();a.stopPropagation();if(this._getQuery()){m.trigger("analyticsEvent",{name:"confluence.insert-files-dialog.search",data:{contentType:c.get("content-type")}});this.clearContainer();this.collection.reset();
this._loadImages().then(f.bind(this._onSuccessLoadFiles,this),f.bind(this._onErrorLoadFiles,this))}},_loadImages:function(){return b.ajax({type:"GET",dataType:"json",url:d.contextPath()+l.REST.getBaseUrl()+"search.json",data:{spaceKey:this.getForm().find(".search-space").val(),query:this._getQuery(),search:"name",type:"attachment",attachmentType:[],groupResults:true,maxResultsPerGroup:50,searchParentName:true,pageSize:j.maxResults}})},_onSuccessLoadFiles:function(a){var b={result:[]};a.result&&a.result.length>
0?b=a:a.group&&a.group[0]&&(b=a.group[0]);this.fileListView.highlighter=new k(this._getQuery().split(" "));this.fileListView.resetFileList(b.result,{shouldClearSelection:true})},_onErrorLoadFiles:function(){var a=this.getContainer();a.find(".loading-message").addClass("hidden");a.append(b("<p class='warning'>"+b(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return b("input.search-image-text",this.getForm())},_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();
this._getSearchText().focus()}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/search-panel/search-panel-view","Confluence.Editor.FileDialog.SearchPanelView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.File.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_ignored) {
  return '<div class="dialog-help-link"><a href="' + soy.$$escapeHtml("https://confluence.atlassian.com/display/ConfCloud/Display+Files+and+Images") + '" target="_blank">' + soy.$$escapeHtml('Help') + '</a></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.File.helpLink.soyTemplateName = 'Confluence.Templates.File.helpLink';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
define("confluence-editor/files/file-dialog/file-dialog-view","backbone ajs confluence/templates underscore jquery document window".split(" "),function(j,e,l,f,d,i,m){return j.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;this.beforeShowListeners=a.beforeShowListeners;this.panelComponents=a.panelComponents},render:function(){this._createDialog();
this.clearSelection();d(i).on("keydown.insert-image",f.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=new e.Dialog(this.width,this.height,this.dialogId),n="Insert files and images",b="Insert";this.dialog=a;a.addHeader(n);a.addButton(b,f.bind(this._submitDialog,this),"insert");a.addCancel("Close",f.bind(this._killDialog,this));this.el=a.popup.element;this.$el=d(this.el);this.baseElement=this.el;
this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");d("#"+this.dialogId+" .dialog-components .dialog-title").prepend(l.File.helpLink());this.$el.find(".dialog-button-panel").append(d("<div></div>").addClass("dialog-tip").html("Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" in the Editor to insert attached images."));this._createPanels();d(i).on("hideLayer",f.bind(function(b,e,d){if(e==="popup"&&d===a.popup){d.remove();this.teardown();typeof this.cancelCallback==="function"&&this.cancelCallback()}},
this));e.bind("remove.dialog",f.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},this));a.show();return a},_createPanels:function(){var a=this;d.each(this.panelComponents,function(){this&&typeof this.createPanel==="function"&&this.createPanel(a)});e.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");d.each(this.beforeShowListeners,function(){typeof this==="function"&&this()})},teardown:function(){d(i).unbind(".insert-image");d(".tipsy").remove();this.undelegateEvents()},
_killDialog:function(){this.dialog.remove();this.clearSelection();typeof this.cancelCallback==="function"&&this.cancelCallback()},_submitDialog:function(){var a=e.Meta.get("attachment-source-content-id"),d=function(b){e.trigger("createGASv3Event",{type:"sendTrackEvent",data:{action:"inserted",actionSubject:"media",source:"legacyEditor",attributes:{contentId:a,imageSourceType:b}}})},b={url:this.urlExternalImg,contentId:a,selectItems:this.selectItems};this.dialog.remove();if(typeof this.submitCallback===
"function"){this.submitCallback(b);if(this.urlExternalImg)d("url");else if(this.selectItems&&this.selectItems.length>0)for(b=0;b<this.selectItems.length;b++){var c=this.selectItems[b];c&&(c.attributes&&c.attributes.ownerId)&&(c.attributes.ownerId===a?d("thisPage"):d("otherPage"))}}},setSelectItems:function(a){if(typeof a==="string"){this.urlExternalImg=a;this.selectItems=[]}else{this.urlExternalImg="";this.selectItems=a}a=this.selectItems.length>0||this.urlExternalImg;if(this.$insertButton){this.$insertButton.prop("disabled",
!a);this.$insertButton.attr("aria-disabled",!a)}},clearSelection:function(){this.setSelectItems([])},insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!d("#"+this.dialog.id).is(":hidden")){var f=this.dialog.getCurrentPanel().body,
b=f.find(".attached-file");if(!(b.length===0||d(i.activeElement).is("input[type=text], select, button"))){var c=m.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var k=a.which,g;g=b.filter(".current");g.length||(g=b.filter(".selected"));if(g.length){g=b.index(g);var j=b.length,h={};h[c.LEFT]=-1;h[c.RIGHT]=1;h[c.UP]=-4;h[c.DOWN]=4;c=g+(h[k]?h[k]:0);b=b.eq(c<0||c>=j?g:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");b.addClass("current");
b.length&&f.find(".scroll-wrapper").simpleScrollTo(b);return e.stopEvent(a);case c.SPACEBAR:f.find("li.attached-file.current").click();return e.stopEvent(a);case c.ENTER:this.insert();return e.stopEvent(a)}}}}})});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/files/file-dialog/file-dialog-view","Confluence.Editor.FileDialog.FileDialogView");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-loading-indicator', location = 'includes/js/page-loading-indicator.js' */
define("confluence/page-loading-indicator",["jquery","ajs"],function(b,a){return function(c){function e(){return b(".confluence-page-loading-blanket",c)}function f(){return b(".confluence-loading-indicator",c)}return{show:function(){0===e().length&&b(c).append('\x3cdiv class\x3d"confluence-page-loading-errors"\x3e\x3c/div\x3e\x3cdiv class\x3d"confluence-page-loading-blanket aui-blanket" aria-hidden\x3d"false"\x3e\x3cdiv class\x3d"confluence-loading-indicator"\x3e\x3c/div\x3e\x3c/div\x3e');e().show();
f().spin({lines:12,length:8,width:4,radius:10,trail:60,speed:1.5,color:"#F0F0F0"})},hide:function(){f().stop();e().hide()},showUntilResolved:function(b,d){this.show();b.always(this.hide.bind(this));d&&b.fail(function(){a.messages.error(".confluence-page-loading-errors",{body:d})})},showUntilDialogVisible:function(c,d){var g=this,e=d||"An error has occurred connecting to the server. Please try again.";d=b(".aui-dialog:visible");var f=b(".aui-dialog2:visible");d.length||f.length||g.show();c.always(g.hide).fail(function(){a.messages.error(".confluence-page-loading-errors",
{body:e})});a.bind("show.dialog",function h(){a.unbind("show.dialog",h);g.hide()});if(null!=a.dialog2&&void 0!=a.dialog2)a.dialog2.on("show",function k(){a.dialog2.off("show",k);g.hide()})},destroy:function(){c.remove(".confluence-page-loading-blanket")}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence/page-loading-indicator","Confluence.PageLoadingIndicator");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.web.resources:page-loading-indicator', location = 'includes/soy/page-loading-indicator.soy' */
// This file was automatically generated from page-loading-indicator.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }


Confluence.Templates.pageLoadingIndicator = function(opt_data, opt_ignored) {
  return '<div class="confluence-page-loading-errors"></div><div class="confluence-page-loading-blanket aui-blanket" aria-hidden="false"><div class="confluence-loading-indicator"></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.pageLoadingIndicator.soyTemplateName = 'Confluence.Templates.pageLoadingIndicator';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-trigger', location = 'src/js/aui/trigger.js' */
("undefined"===typeof window?global:window).__ffe6b3593a7ecf12fcdeabb2f7a616a2=function(){function e(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){if(a.isEnabled()){var c=document.getElementById(a.getAttribute("aria-controls"));c&&c.message&&c.message(b)}}"use strict";var g=e(__9be3f454a87dfa12e64a40a8f483ace3),h=e(__f9ed23d9bdbeaa8add4713d890e930be),f=e(__3fc3683fc4aae94d9d5e29d2ae00dbae);(0,f.default)("data-aui-trigger",{type:f.default.type.ATTRIBUTE,events:{click:function(a,b){var c=
b.target,c=(0,g.default)(c).closest("a[href]",a);c.length&&c[0]!==a||(d(a,b),b.preventDefault())},mouseenter:function(a,b){d(a,b)},mouseleave:function(a,b){d(a,b)},focus:function(a,b){d(a,b)},blur:function(a,b){d(a,b)}},prototype:{disable:function(){this.setAttribute("aria-disabled","true")},enable:function(){this.setAttribute("aria-disabled","false")},isEnabled:function(){return"true"!==this.getAttribute("aria-disabled")}}});(0,h.default)("aui/trigger");return{}}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:aui-trigger', location = 'src/soy/trigger.soy' */
// This file was automatically generated from trigger.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.trigger.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.trigger == 'undefined') { aui.trigger = {}; }


aui.trigger.trigger = function(opt_data, opt_ignored) {
  return '<' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a') + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '" ' : '') + ' class="' + aui.renderExtraClasses(opt_data) + '" aria-controls="' + soy.$$escapeHtml(opt_data.menu.id) + '" aria-haspopup="true" role="button"' + ((opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '') + ((opt_data.container) ? ' data-container="' + soy.$$escapeHtml(opt_data.container) + '"' : '') + (((! opt_data.tagName || opt_data.tagName == 'a') && (! opt_data.extraAttributes || Object.prototype.toString.call(opt_data.extraAttributes) === '[object Object]' && ! opt_data.extraAttributes.href && ! opt_data.extraAttributes.tabindex || (! opt_data.extraAttributes.href || ! opt_data.extraAttributes.tabindex))) ? ' tabindex="0"' : '') + ' data-aui-trigger' + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + ((opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '') + ((! (opt_data.showIcon == false)) ? '<span class="icon ' + soy.$$escapeHtml(opt_data.iconClasses ? opt_data.iconClasses : 'aui-icon-dropdown') + '">' + ((opt_data.iconText) ? soy.$$escapeHtml(opt_data.iconText) : '') + '</span>' : '') + '</' + soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'a') + '>';
};
if (goog.DEBUG) {
  aui.trigger.trigger.soyTemplateName = 'aui.trigger.trigger';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-internal-attributes', location = 'src/js/aui/internal/attributes.js' */
("undefined"===typeof window?global:window).__97a6ea05c8b9d33d3bc19ce6f2eb3e59=function(){function d(a){return null!==a}function e(a,b,c){c?a.setAttribute(b,""):a.removeAttribute(b)}function f(a,b){var c=function(a){return a.toLowerCase()===b.toLowerCase()},d=null===b,e=!d&&!a.values.filter(c).length;return d?a.hasOwnProperty("missingDefault")?a.missingDefault:null:e?a.hasOwnProperty("invalidDefault")?a.invalidDefault:a.hasOwnProperty("missingDefault")?a.missingDefault:null:a.values.length?a.values.filter(c)[0]:
null}function g(a,b,c){a.setAttribute(b.attribute,c)}var b={};"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.computeBooleanValue=d;b.setBooleanAttribute=e;b.computeEnumValue=f;b.setEnumAttribute=g;b.default={computeBooleanValue:d,setBooleanAttribute:e,computeEnumValue:f,setEnumAttribute:g};return b}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-internal-enforcer', location = 'src/js/aui/internal/enforcer.js' */
("undefined"===typeof window?global:window).__b251c17133fb0142f04d1c23d86fbc74=function(){var c={};"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d;var a=__076604ba6d64084987ea5ab9807be73e;if(a&&a.__esModule)d=a;else{var b={};if(null!=a)for(var e in a)Object.prototype.hasOwnProperty.call(a,e)&&(b[e]=a[e]);b.default=a;d=b}c.default=function(a){function c(b){return e(function(){return a.hasAttribute(b)},b+" wasn't defined")}function b(d){if(!c(d,a))return!1;var f=a.getAttribute(d);
return e(function(){return document.getElementById(f)},'an element with id set to "'+f+'" was not found')}function e(b,c){return!b()?(a?d.error(c,a):d.error(c),!1):!0}return{attributeExists:c,refersTo:b,satisfiesRules:e,ariaControls:function(){return b("aria-controls")},ariaOwns:function(){return b("aria-owns")}}};return c=c["default"]}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:internal-src-js-aui-inline-dialog2', location = 'src/js/aui/inline-dialog2.js' */
("undefined"===typeof window?global:window).__44be98cf74984e8ecbe0a7f7fa485627=function(){function c(a){return a&&a.__esModule?a:{"default":a}}function l(a,b){var d=document.querySelector('[aria-controls="'+a.id+'"]');d&&b(d)}function n(a){a=a.target;(0,e.default)(a).set("mouse-inside",!0);a.message({type:"mouseenter"})}function o(a){a=a.target;(0,e.default)(a).set("mouse-inside",!1);a.message({type:"mouseleave"})}function m(a){(0,e.default)(a).set("mouse-inside",void 0);a.removeEventListener("mouseenter",
n);a.removeEventListener("mouseleave",o);"hover"===a.respondsTo&&((0,e.default)(a).set("mouse-inside",!1),a.addEventListener("mouseenter",n),a.addEventListener("mouseleave",o))}function j(a){var b=!a.hasAttribute("aria-hidden"),d=a.hasAttribute("open");if(b||a.open!==d)d?((0,e.default)(a).set("is-processing-show",!0),(0,f.default)(a).show(),(0,f.default)(a).isVisible()?l(a,function(b){a._auiAlignment||(a._auiAlignment=new p.default(a,b));a._auiAlignment.enable();b.setAttribute("aria-expanded","true")}):
a.open=!1,(0,e.default)(a).set("is-processing-show",!1)):((0,f.default)(a).hide(),(0,f.default)(a).isVisible()?a.open=!0:l(a,function(b){a._auiAlignment||(a._auiAlignment=new p.default(a,b));a._auiAlignment.disable();b.setAttribute("aria-expanded","false")}))}var k={};"use strict";Object.defineProperty(k,"__esModule",{value:!0});var q=c(__9be3f454a87dfa12e64a40a8f483ace3),p=c(__b93afee45d23f65f7779d093cffa7c86),r=c(__f9ed23d9bdbeaa8add4713d890e930be),g=c(__97a6ea05c8b9d33d3bc19ce6f2eb3e59),s=c(__b251c17133fb0142f04d1c23d86fbc74),
t=c(__02a4a9c5c584764bed5640044440c14c),f=c(__784ecffbbfc29dc92e960cda029d964a),h=c(__3fc3683fc4aae94d9d5e29d2ae00dbae),e=c(__24b8f731191e335161423917f0476ec5),u={click:function(a){if(a.open){if(!(0,f.default)(a).isPersistent())a.open=!1}else a.open=!0},mouseenter:function(a){a.open||(a.open=!0);a._clearMouseleaveTimeout&&a._clearMouseleaveTimeout()},mouseleave:function(a){if(!(0,f.default)(a).isPersistent()&&a.open){a._clearMouseleaveTimeout&&a._clearMouseleaveTimeout();var b=setTimeout(function(){if(!(0,
e.default)(a).get("mouse-inside"))a.open=!1},1E3);a._clearMouseleaveTimeout=function(){clearTimeout(b);a._clearMouseleaveTimeout=null}}},focus:function(a){a.open||(a.open=!0)},blur:function(a){if(!(0,f.default)(a).isPersistent()&&a.open)a.open=!1}},i={attribute:"responds-to",values:["toggle","hover"],missingDefault:"toggle",invalidDefault:"toggle"},h=(0,h.default)("aui-inline-dialog",{prototype:{get open(){return(0,f.default)(this).isVisible()},set open(a){g.default.setBooleanAttribute(this,"open",
a);j(this)},get persistent(){return this.hasAttribute("persistent")},set persistent(a){g.default.setBooleanAttribute(this,"persistent",a)},get respondsTo(){return g.default.computeEnumValue(i,this.getAttribute(i.attribute))},set respondsTo(a){var b=this.respondsTo;g.default.setEnumAttribute(this,i,a);b!==this.respondsTo&&m(this)},message:function(a){var b={toggle:["click"],hover:["mouseenter","mouseleave","focus","blur"]}[this.respondsTo];if(b&&-1<b.indexOf(a.type))u[a.type](this,a);return this}},
created:function(a){(0,e.default)(a).set("is-processing-show",!1);l(a,function(b){b.setAttribute("aria-expanded",a.open);b.setAttribute("aria-haspopup","true")})},attributes:{"aria-hidden":function(a,b){if("true"===b.newValue){var d=document.querySelector('[aria-controls="'+a.id+'"]');d&&d.setAttribute("aria-expanded","false")}g.default.setBooleanAttribute(a,"open","false"===b.newValue)},open:function(a){document.body.contains(a)&&j(a)},"responds-to":function(a,b){var d=g.default.computeEnumValue(i,
b.oldValue),c=g.default.computeEnumValue(i,b.newValue);d!==c&&m(a)}},attached:function(a){(0,s.default)(a).attributeExists("id");a.hasAttribute("open")?(0,e.default)(a).get("is-processing-show")||j(a):j(a);m(a)},detached:function(a){a._auiAlignment&&a._auiAlignment.destroy()},template:function(a){var b=(0,q.default)('<div class="aui-inline-dialog-contents"></div>').append(a.childNodes);(0,q.default)(a).addClass("aui-layer").html(b)}});(0,r.default)("aui/inline-dialog2",h);(0,t.default)("InlineDialog2",
h);k.default=h;return k=k["default"]}.call(this);
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.auiplugin:aui-inline-dialog2', location = 'src/soy/inline-dialog2.soy' */
// This file was automatically generated from inline-dialog2.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace aui.inlineDialog2.
 */

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.inlineDialog2 == 'undefined') { aui.inlineDialog2 = {}; }


aui.inlineDialog2.inlineDialog2 = function(opt_data, opt_ignored) {
  return '<aui-inline-dialog' + ((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '') + ' class="' + aui.renderExtraClasses(opt_data) + '"' + ((opt_data.alignment) ? ' alignment="' + soy.$$escapeHtml(opt_data.alignment) + '"' : '') + ((opt_data.open) ? ' open' : '') + ((opt_data.persistent) ? ' persistent' : '') + ((opt_data.respondsTo) ? ' responds-to="' + soy.$$escapeHtml(opt_data.respondsTo) + '"' : '') + aui.renderExtraAttributes(opt_data) + '>' + ((opt_data.content) ? soy.$$filterNoAutoescape(opt_data.content) : '') + '</aui-inline-dialog>';
};
if (goog.DEBUG) {
  aui.inlineDialog2.inlineDialog2.soyTemplateName = 'aui.inlineDialog2.inlineDialog2';
}


aui.inlineDialog2.trigger = function(opt_data, opt_ignored) {
  return '' + aui.trigger.trigger(soy.$$augmentMap(opt_data, {showIcon: opt_data.showIcon ? opt_data.showIcon : false}));
};
if (goog.DEBUG) {
  aui.inlineDialog2.trigger.soyTemplateName = 'aui.inlineDialog2.trigger';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview-support.js' */
define("cp/confluence/preview-support",["ajs"],function(b){var g=function(j){j.bridgeId=""+a(window);var h=window.location;var i=h.origin;if(!i){i=h.protocol+"//"+h.hostname+(h.port?":"+h.port:"")}window.parent.postMessage(j,i)};var d=function(i){var j=i.frameElement&&i.frameElement.getAttribute("name");var h=i.frameElement&&i.frameElement.getAttribute("data-is-fallback-mode-iframe")==="true";return j&&j==="fallback-mode-iframe"||h};var a=function(h){return h.frameElement&&h.frameElement.getAttribute("data-bridge-id")};var f=function(){var h=c.SELECTOR_STRINGS.IMAGE+", "+c.SELECTOR_STRINGS.LINK_IMAGE+", "+c.SELECTOR_STRINGS.EXTERNAL_IMAGE;if(c.isPDFSupported()){h+=", "+c.SELECTOR_STRINGS.PDF+", "+c.SELECTOR_STRINGS.LINK_PDF}return h};var e=function(){return c.SELECTOR_STRINGS.IMAGE+", "+c.SELECTOR_STRINGS.EXTERNAL_IMAGE+", "+c.SELECTOR_STRINGS.FILE+", "+c.SELECTOR_STRINGS.LINK_FILE+", "+c.SELECTOR_STRINGS.ATTACHMENT_MACRO};var c={SELECTOR_STRINGS:{IMAGE:"img.confluence-embedded-image[data-linked-resource-id]",EXTERNAL_IMAGE:"img.confluence-embedded-image.confluence-external-resource",PDF:"a.confluence-embedded-file[data-nice-type='PDF Document']",LINK_IMAGE:"a[data-linked-resource-type='attachment'][data-nice-type='Image']",LINK_PDF:"a[data-linked-resource-type='attachment'][data-nice-type='PDF Document']",FILE:"a.confluence-embedded-file",LINK_FILE:"a[data-linked-resource-type='attachment']",FILE_OVERLAY:"span.confluence-embedded-file-wrapper .file-type-desc-overlay, span.confluence-embedded-file-wrapper .comment-count-overlay",ATTACHMENT_MACRO:".plugin_attachments_container a.previewAttachmentLink"},VIEW_MODE:{FULL:"full",COMMENT:"comment",SIMPLE:"simple",EDIT:"edit"},isPDFSupported:function(){return b.DarkFeatures.isEnabled("pdf-preview")},areFilesSafe:function(h){var i=true;h.forEach(function(j){Object.keys(j).forEach(function(l){var k=typeof j[l];if(!(k==="string"||k==="number"||k==="boolean")){i=false}})});return i},getFileSelectorString:function(){if(b.DarkFeatures.isEnabled("previews.trigger-all-file-types")){return e()}else{return f()}},sendPreviewerToParent:function(j,i,h,k){var l=c.areFilesSafe(j||[]);g({type:"openPreviewOnParent",files:l?j:[],viewMode:i,fileQuery:h,analyticsSource:k})},autoShowAnnotationsOnParent:function(){g({type:"autoShowAnnotationsOnParent"})},isFallbackModeIframe:window.top!==window.self&&d(window)};return c});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/preview.js' */
define("cp/confluence/preview",["underscore","jquery","cp/confluence/preview-support","ajs","confluence/jsUri"],function(m,g,h,k,d){var l,n,b=false;var c=g("#confluence-ui").length>0;g(document).ready(i);function i(){var q=g(h.getFileSelectorString());q.off("click.fb");var r=g(document.body);r.off("click.filePreviews");r.on("click.filePreviews",h.getFileSelectorString(),p);r.on("click.filePreviews",h.SELECTOR_STRINGS.FILE_OVERLAY,j);g(window).on("popstate",function(){if(!n&&k.DarkFeatures.isEnabled("previews.sharing.pushstate")){a()}});if(!c){a()}}function p(q){if(!q.altKey&&!q.ctrlKey&&!q.metaKey&&!g(this).parent().closest("a, #draft-changes-dialog, #cp-annotations").length){q.preventDefault();o(this,g(q.currentTarget).data("preview-view-mode"))}}function j(r){r.preventDefault();var q=g(r.target);var s=q.closest("span.confluence-embedded-file-wrapper");o(s.find(h.SELECTOR_STRINGS.IMAGE+","+h.SELECTOR_STRINGS.FILE),undefined,undefined,q.closest(".comment-count-overlay").length>0)}function o(s,t,q,z){if(!n){var u="confluence-previews-css";var r="media-viewer";WRM.require("wr!com.atlassian.confluence.plugins.confluence-previews:"+u);var A=g.Deferred(),w=A.promise();var v=setInterval(function(){for(var D=0;D<document.styleSheets.length;D++){var E=document.styleSheets[D];if(E.href&&(E.href.indexOf(u)!==-1||E.href.indexOf(r)!==-1)){y();return}}},100);var y=function(){A.resolve();clearInterval(v)};var C=k.Meta.get("static-resource-url-prefix");var B="com.atlassian.confluence.plugins.confluence-previews:mediaviewer-chunks";var x=C+"/download/resources/"+B+"/";n=g.when(WRM.require(["wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-js","wrc!media-viewer"]),w);n.done(function(){l=require("cp/confluence/file-preview-loader");if(!c||s&&!b){b=true;f(s,t,q,z)}k.bind("reset-file-list.filePreviews",l.resetPreviewFileList)});if(!h.isFallbackModeIframe){Confluence.PageLoadingIndicator(g("body")).showUntilResolved(n,"We were unable to load the file previewer")}}else{n.done(m.partial(f,s,t,q,z))}return n}var f=function(u,v,q,x){var s=g("#content");var r=g(u).closest(".comment,.comment-content,.cq-content,.ic-content");if(!v){var y=k.Meta.get("content-type");var t=s.hasClass("page")||y==="page";var w=s.hasClass("blogpost")||y==="blogpost";var z=g(".files-tab-identifier").length;if(!t&&!w&&!z){v=h.VIEW_MODE.SIMPLE}else{if(r.length){v=h.VIEW_MODE.COMMENT}}}if(v===h.VIEW_MODE.COMMENT){l.showPreviewerForComment(u,r,v,x)}else{if(v===h.VIEW_MODE.SIMPLE){l.showPreviewerForSingleFile(u,v,q)}else{if(v===h.VIEW_MODE.EDIT){l.fetchAndShowPreviewerForSingleFile(u,h.VIEW_MODE.SIMPLE,q)}else{v=h.VIEW_MODE.FULL;l.showPreviewer(undefined,u,v,x)}}}};function a(){if(e()){var u=new d(window.location.href);var s=window.history.pushState&&k.DarkFeatures.isEnabled("previews.sharing.pushstate");var r=window.history.replaceState;var t=u.getQueryParamValue("preview");if(t&&!s){var v="#!/preview"+t;var q=decodeURIComponent(u.deleteQueryParam("preview").setAnchor(v).toString());if(r){r({},"",q)}else{window.location=q}}else{if(u.anchor().indexOf("!/preview")===0&&s){var q;if(t){q=u.setAnchor("")}else{q=u.addQueryParam("preview",u.anchor().substr("!/preview".length,u.anchor().length)).setAnchor("")}r({},"",q)}}o()}}function e(){var q=new d(window.location.href);return k.DarkFeatures.isEnabled("previews.sharing")&&(q.getQueryParamValue("preview")||(q.anchor()&&q.anchor().indexOf("!/preview")===0))}return{loadConfluencePreviews:o}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-previews:confluence-previews-jquery', location = '/js/confluence/jquery-previewer.js' */
require(["cp/confluence/preview","jquery"],function(b,a){a.fn.previewer=function(c){if(!a(this).length){return this}var d=a.extend({},c);return this.each(function(){var f=a(this);var e=f.closest("li");var g=d.src||f.attr("data-image-src")||f.attr("src");if(g){f.click(function(j){var i={src:g,type:d.type,thumbnail:g,title:d.title||e.attr("data-file-name")||g,id:e.attr("data-attachment-id"),ownerId:e.attr("data-owner-id")};var h=b.loadConfluencePreviews([i],d.viewMode||"simple",d.from||"custom");d.zindex&&h.done(function(){a(".cp-container").css({"z-index":d.zindex})})})}})}});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
define("confluence-editor/editor/page-editor","ajs jquery document window confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/analytics-support confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/get-content-id confluence/api/event confluence/dark-features".split(" "),function(d,b,i,o,e,x,k,S,c,y,h){function z(){return e.get("content-type")==="page"||e.get("content-type")==="blogpost"}function A(a){b("#editpageform").find("input[name='atl_token']").val(a);
e.set("atl-token",a);e.set("atlassian-token",a);b("#atlassian-token").attr("content",a)}function M(a){if(!z()&&a){A(a.atlToken);h.trigger("rte.heartbeat",a)}else if(!a||!a.atlToken){if(a.status==="unauthorised")if(options.movedBy){k.closeMessages(["heartbeat-error"]);k.handleMessage("heartbeat-error",{type:"error",title:"Permissions have changed",message:"You can\'t publish due to a page move or change in restrictions. You will be redirected in 10 seconds."})}else{k.closeMessages(["heartbeat-error"]);
k.handleMessage("heartbeat-error",{type:"error",title:"No access to this content",message:"This content has been moved, restricted, or deleted. You will be redirected in 10 seconds."})}h.trigger("rte.heartbeat-error","Invalid server response");d.logError("Unexpected server response for heartbeat:");d.log(a);setTimeout(function(){var a=e.get("base-url")+"/pages/viewpage.action?pageId="+e.get("content-id");o.location=a},1E4)}else{e.set("contributors-hash",a.contributorsHash);A(a.atlToken);
c.heartbeatType.normal();h.trigger("rte.heartbeat",a);b(i).trigger("resize.resizeplugin");h.trigger("editor-heartbeat",a)}}function N(a,b,f){(a.status>=500||a.status===0)&&c.heartbeatType.recovery();if(a.status===403||a.status===401)d.logError("Heartbeat error: Unauthorized");else{d.logError("Server error on heartbeat request:");d.log(f)}h.trigger("rte.heartbeat-error",a)}var m=[],l=[],n=[],B=false,p,C=function(a){c.UI.setButtonState(a,c.UI.saveButton);c.UI.setButtonState(a,c.UI.previewButton);c.UI.setButtonState(a,
c.UI.cancelButton)},r=function(a){var a=a||{},b=a.messageKey||"editor-error-message",c=a.message||"Something went wrong with the editor. Copy your unsaved changes and refresh to keep editing.";k.handleMessage(b,{title:a.title,type:"error",message:c},function(){a.disablePublish&&C(false)})},D=function(){h.trigger("analytics",{name:"confluence.editor.update",data:{contentId:e.get("content-id"),notifiedWatchers:b("#notifyWatchers").is(":checked"),addedVersionComment:b("#versionComment").val()!=null&&b("#versionComment").val().length>0,contentType:e.get("content-type"),
isTitleChanged:e.get("latest-published-page-title")!==b("#content-title").val(),spaceKey:e.get("space-key"),isNeverPublished:e.get("page-id")==="0"}})},P=function(a){var b=true;k.closeMessages(["offline-before-save-error"]);for(var c=0;c<l.length;c++){l[c](a)===false&&(b=false);if(a.isImmediatePropagationStopped())break}if(!b||a.isDefaultPrevented()||a.isPropagationStopped())return false;a.preventDefault();E(a).done(function(a){a=F(a);if(a==null){d.warn("Expected deferred object not returned by save handler");
D()}else a.done(D)}).fail(O)},O=function(a){var b=a||{};r({messageKey:b.messageKey||"offline-before-save-error",message:b.disablePublish?"Something went wrong with the editor. Copy your unsaved changes and refresh to keep editing.":"Unable to communicate with server. Saving is not possible at the moment.",disablePublish:b.disablePublish});a&&h.trigger("analytics",{name:"editor.save.error."+a.origin+"."+a.cause});c.UI.toggleSavebarBusy(false);c.Drafts.bindUnloadMessage()},E=function(a){var j=b.Deferred();j.resolve(a);return j.promise()},F=function(){b(c.getCurrentForm()).submit()};
h.bind("rte-ready",function(){c.UI.saveButton.bind("click",P)});h.bind("editor.error.message",function(a,b){r(b)});h.bind("dismiss.editor.error.message",function(a,b){k.closeMessages([b.messageKey]);b.enablePublish&&C(true)});var Q=function(){var a;for(a=0;a<m.length;a++)c.UI.cancelButton.click(m[a]);var j=b(c.getCurrentForm());for(a=0;a<n.length;a++)j.submit(n[a]);b.unbind("init.rte",this)},G=function(a,c,f,e){e.push(f);if(d.Rte&&d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())a.bind(c,
f);else if(!B){B=true;b.bind("init.rte",Q)}},t=function(a,b,c){var e=null;d.Rte&&(d.Rte.BootstrapManager&&d.Rte.BootstrapManager.isInitComplete())&&(e=function(a,b,c){a.unbind(b,c)});for(var i=c.pop();i;){e&&e(a,b,i);i=c.pop()}},H=function(a){if(g!==a){g&&g.clear();a.start(c.heartbeat);g=a}},g,I=e.getNumber("heartbeat-interval")||6E4,u,J;u={start:function(a){d.debug("Changing heartbeat to the normal scheduler");J=setInterval(a,I)},clear:function(){clearInterval(J)}};var K,L=Math.max(I/5,5E3),v,w;
K={start:function(a){d.debug("Changing heartbeat to the recovery scheduler");w=0;var b=function(){a();var c=L*Math.pow(2,w);v=setTimeout(b,Math.min(c,3E5));w++};v=setTimeout(b,L)},clear:function(){clearTimeout(v)}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_SOURCE:"source",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:false,sourceInitialValue:false,isSubmitting:false,isCancelling:false,overrideBeforeSave:function(a){E=a},overrideSave:function(a){F=
a},addCancelHandler:function(a){G(c.UI.cancelButton,"click",a,m)},addSaveHandler:function(a){l.push(a)},addSubmitHandler:function(a){G(b(c.getCurrentForm()),"submit",a,n)},removeAllCancelHandlers:function(){t(c.UI.cancelButton,"click",m)},removeAllSaveHandlers:function(){t(c.UI.saveButton,"click",l)},removeAllSubmitHandlers:function(){t(b(c.getCurrentForm()),"submit",n)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?false:this.editorHasContentChanged()},
editorHasContentChanged:function(){if(d.Rte.getEditor()==null){d.debug("Editor: editorHasContentChanged - No active editor present. Returning false.");return false}return d.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(d.Rte.getEditor().getContent()).text();return!b.trim(a)},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){b(".editable-title #content-title").prop("disabled",true);return true},metadataSyncRequired:z,
heartbeat:function(a){var a=a||{},c={dataType:"json",contentId:e.get("content-id"),draftType:e.get("content-type"),collabService:"synchrony",editorVersion:"v1"};p=b.ajax({url:x.CONTEXT_PATH+"/api/v2/editor/heartbeat/start",type:"POST",data:JSON.stringify(c),dataType:"json",headers:{Accept:"application/json","Content-Type":"application/json"},async:a.synchronousHeartbeat!==true}).done(M.bind(this)).fail(N.bind(this))},heartbeatType:{normal:function(){H(u)},recovery:function(){H(K)},reset:function(){g&&
g.clear();g=u;g.start(c.heartbeat)},cleanup:function(){if(g){g.clear();g=null}p&&p.abort&&p.abort()}},disableFrame:function(a){b("form",a).each(function(){b(this).unbind();this.onsubmit=function(){return false}});b("a",a).each(function(){b(this).attr("target","_top").unbind()});b("input, img",a).each(function(){b(this).unbind()})},previewFrameOnload:function(a,j){var f=require("tinymce");c.setMode(c.MODE_PREVIEW);f.activeEditor.setProgressState(false);c.disableFrame(a);var q=b("#main",a)[0];if(e.get("content-type")!==
"comment"&&b(q).find("#main-header").length===0){var h=b("#title-heading"),g=h.attr("class");b(q).prepend('<div id="preview-header"><div id="title-heading" class="'+g+'">'+h.html()+"</div></div>")}if(b(d.Rte.getEditor().getBody()).hasClass("resizable")){var s=b(j||"#previewArea iframe"),k=0,m=0,l,n=s.height();q&&function R(){var a=b(q).outerHeight(true);if(k!==a){a!==s.height()&&s.height(0).height(Math.max(a,n));k=a;m=0}else m++;m<500&&(l=setTimeout(R,500))}();b(i).one("mode-changed.resize-editor",
function(a,b){b!==c.MODE_PREVIEW&&l&&clearTimeout(l)})}else if(f.isIE||f.isOpera){f=b(o).height();h=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height();g=b("#savebar-container").height();b("#preview iframe").height(f-h-g-4);b("#content.edit").height("auto")}},showRichText:function(a){var j=require("tinymce");d.setVisible("#wysiwyg",a);b(".toolbar-group-edit").toggleClass("assistive",a);b(".toolbar-group-preview").toggleClass("assistive",!a);b("#main").toggleClass("active-richtext",
a);j.isGecko&&a&&d.Rte.fixEditorFocus(c.bookmark)},showPreview:function(a){if(e.get("content-type")!=="comment"){var c=b("#content-title");if(c.hasClass("placeholded")){b("#preview-title-text").text("");b("#title-text").text("")}else{b("#preview-title-text").text(c.val());b("#title-text").text(c.val())}}d.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main, .editor-container").toggleClass("active-preview",a);
e.get("content-type")!=="comment"&&b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},showSource:function(a){a?this.showSourceArea():this.hideSourceArea();b("#main")[a?"addClass":"removeClass"]("active-source")},setMode:function(a){d.debug("Set mode: "+a);if(a===c.MODE_RICHTEXT){this.showRichText(true);this.showPreview(false);this.showSource(false)}else if(a===c.MODE_SOURCE){this.showSource(true);this.showRichText(false);this.showPreview(false)}else if(a===
c.MODE_PREVIEW){this.showPreview(true);this.showRichText(false);this.showSource(false);c.UI.spinner.removeClass("aui-icon-wait")}setTimeout(function(){var a=b(".toolbar-group-preview");a.height(0);a.height();a.height("auto");a.height("")},1);this.currentEditMode=a;b(i).trigger("mode-changed",[a])},getContentId:function(){return y()},addErrorMessage:function(a,c,f){var e=b("#"+a),f=f?"#all-messages":"#editor-messages";e.length?e.empty():e=b("<div></div>").attr("id",a).appendTo(f);d.messages.error(e,
{closeable:true,body:c})},changeMode:function(a,j){var f=require("tinymce");d.debug("Change mode: "+a);j=j||{};if(this.inRichTextMode()&&!d.Rte.BootstrapManager.isInitComplete()||this.currentEditMode===a)return false;var g=this.currentEditMode;h.trigger("rte-changeMode",a);if(a===c.MODE_PREVIEW){var m=d.Rte.getEditor();g===c.MODE_SOURCE&&c.transferSourceToEditor();if(f.isGecko&&g===c.MODE_RICHTEXT&&!c.bookmark)c.bookmark=f.activeEditor.selection.getBookmark();this.currentEditMode=a;f=function(a){typeof a!==
"object"&&(a={draftId:y()});a={contentId:a.draftId,contentType:e.get("content-type"),spaceKey:e.get("space-key"),XHTML:m.getContent(),outputType:c.PREVIEW_OUTPUT_TYPE};d.safe.ajax({type:"POST",url:x.CONTEXT_PATH+"/pages/rendercontent.action",data:a,success:c.replysetPreviewArea,timeout:2E4,error:function(){h.trigger("rte.preview.error",{status:0});k.closeMessages(["server-offline"]);r({messageKey:"server-offline",message:"Can\'t reach the server. Check you\'re connected to the internet and Confluence is up and running.",disablePublish:false});c.currentEditMode=
g;j.errorCallback&&j.errorCallback()}})};e.get("content-type")==="comment"?f():c.Drafts.save({forceSave:true,onSuccessHandler:f,onErrorHandler:f})}else this.setMode(a);a===c.MODE_RICHTEXT&&b(i).trigger("resize.resizeplugin");if(g===c.MODE_PREVIEW)if(f=i.getElementById("editor-preview-iframe")){var l=f.contentDocument||f.contentWindow.document;l.removeChild(l.documentElement);b(f).remove()}return false},replysetPreviewArea:function(a){var c=require("tinymce");b("#preview-error").remove();c.activeEditor.setProgressState(true);
var d=b("#previewArea"),c=b('<iframe id="editor-preview-iframe" src="about:blank" scrolling="yes" frameborder="0"></iframe>');d.html(c);(d=(d=i.querySelector("script[nonce]"))&&d.nonce)&&(a=a.replace(/nonce="[a-zA-Z0-9]{32}"/gi,'nonce="'+d+'"'));c=c[0].contentDocument||c[0].contentWindow.document;c.open();c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode===c.MODE_RICHTEXT},isNewPage:function(){return b("#createpageform, #createpagetemplate").length>0},onInit:function(){var a=
require("tinymce");c.setMode(c.MODE_RICHTEXT);a.activeEditor.onClick.add(function(){var a=c.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=true},getCurrentForm:function(){return require("tinymce").activeEditor.formElement},transferSourceToEditor:function(){var a=c;if(a.sourceInitialValue){var b=a.getSourceAreaVal();if(b!==a.sourceInitialValue){var d=require("tinymce").activeEditor;d.setContent(b);d.setDirty(b)}}a.sourceInitialValue=false},hideSourceArea:function(){b("#editor-html-source-container").addClass("hidden");
this.setToolBarInactive(false);this.transferSourceToEditor();b("#rte-button-source-mode").removeClass("active");b("#rte-button-publish").unbind("click.source-save")},showSourceArea:function(){var a=require("tinymce");b("#editor-html-source-container").removeClass("hidden");this.setSourceAreaHeight();this.setToolBarInactive(true);this.sourceInitialValue=a.activeEditor.getContent();this.setSourceAreaVal(this.sourceInitialValue);b("#rte-button-source-mode").addClass("active");b("#rte-button-publish").bind("click.source-save",
c.transferSourceToEditor)},getSourceAreaVal:function(){return b("#editor-html-source").val()},setSourceAreaVal:function(a){b("#editor-html-source").val(a)},setSourceAreaHeight:function(){var a=d.Rte.getTinyMceEditorMinHeight();d.debug("HTML source height= "+a);var c=b("#editor-html-source")[0].scrollHeight;if(c>a){a=c;d.debug("ACTUAL HEIGHT "+c)}b("#editor-html-source-container").height(a+"px")},setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},isVisible:function(){return b("#wysiwyg:visible").length>
0||b("#editor-html-source-container:visible").length>0||b("#preview:visible").length>0}}});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor",function(d){var b=require("jquery"),i=require("ajs"),o=require("confluence/api/event");i.Editor=i.Editor||{};Confluence.Editor=b.extend(Confluence.Editor||{},i.Editor,d);i.toInit(function(){o.bind("init.rte",Confluence.Editor.onInit)});i.Editor=Confluence.Editor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
define("confluence-editor/editor/page-editor-ui","jquery confluence/templates ajs confluence/meta window moment document confluence/api/constants confluence-editor/editor/page-editor-message confluence-editor/editor/page-editor-quit-dialog confluence/analytics-support confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/editor-notifications confluence/api/event".split(" "),function(b,f,e,d,k,r,g,v,w,n,s,c,t,u){return function(){var a={},j=function(b,c){for(var c=c||a.buttons,d=0;d<c.length;d++)o(b,
c[d])},o=function(a,b){if(b)if(a){b.removeAttr("aria-disabled");b.removeAttr("disabled");b.removeClass("disabled")}else{b.attr("aria-disabled","true");b.attr("disabled","disabled");b.addClass("disabled")}},p=function(a){return a.length&&a.attr("aria-disabled")!=="true"},h=function(){return d.get("new-page")},q=function(){var a="";h()||(a="Edit"+" - ");return a};a.spinner=b("#rte-spinner");var l;l=f.Editor.Page.saveButton({contentType:d.get("content-type"),isNewPage:h()});b("#rte-button-publish").replaceWith(l);
l=b("#rte-button-publish");a.saveButton=l;a.editButton=b("#rte-button-edit");a.previewButton=b("#rte-button-preview");a.cancelButton=b("#rte-button-cancel");a.versionCommentInput=b("#versionComment");a.watchPageCheckbox=b("#watchPage");a.watchPageToolbarGroup=b(".toolbar-group-watch-page");a.buttons=[a.saveButton,a.editButton,a.cancelButton,a.previewButton];e.bind("editor-shared-drafts-published",function(){var b=/\(.+\)/g.exec(a.saveButton.data("tooltip"))[0];a.saveButton.text(f.Editor.Page.saveButtonText({contentType:d.get("content-type"),
isNewPage:h()})).attr("title",f.Editor.Page.saveButtonTitle({contentType:d.get("content-type"),isNewPage:h()})+b).tooltip({gravity:"s"})});a.setButtonsState=j;a.setButtonState=o;a.isButtonEnabled=p;a.registerFormButton=function(b,c){a[b]=c;a.buttons.push(c)};a.postingDatePicker=null;a.isFormEnabled=function(){for(var b=0;b<a.buttons.length;b++)if(p(a.buttons[b]))return true;return false};a.toggleSavebarBusy=function(b){if(b){if(!a.isFormEnabled())return false;a.spinner.addClass("aui-icon-wait");j(false)}else{a.spinner.removeClass("aui-icon-wait");
j(true)}return true};a.init=function(){function f(){b("#rte-ellipsis-menu").is(":visible")&&b("#rte-button-ellipsis").trigger("aui-button-invoke")}n.init();c.addSaveHandler(function(b){if(a.isButtonEnabled(a.saveButton)){a.toggleSavebarBusy(true);e.trigger("confluence.editor.on.save")}else{b.stopImmediatePropagation();b.preventDefault()}});e.trigger("rte.init.ui");c.isNewPage()&&b("#content-title").focus().select();c.addCancelHandler(function(a){n.process(a)});d.get("content-type")==="comment"&&c.addSaveHandler(function(){if(e.Rte.Content.isEmpty()){t.notify("warning",
"Comment text is empty. Cannot create empty comments.");a.toggleSavebarBusy(false);return false}});(d.get("content-type")==="comment"||d.get("content-type")==="template")&&c.addCancelHandler(function(b){if(a.isFormEnabled()&&c.hasContentChanged()&&!c.isEmpty()){var m=d.get("content-type")==="comment"?"Your comment will be lost.":"Your unsaved template changes will be lost.";if(!k.confirm(m)){b.stopImmediatePropagation();return false}}});a.versionCommentInput.on("keypress",function(a){a.keyCode===13&&n.process(a).done(function(){u.trigger("analytics",
{name:"confluence.editor.update",data:{contentId:d.get("content-id"),notifiedWatchers:b("#notifyWatchers").is(":checked"),addedVersionComment:b("#versionComment").val()!=null&&b("#versionComment").val().length>0,contentType:d.get("content-type"),isTitleChanged:d.get("latest-published-page-title")!==b("#content-title").val(),spaceKey:d.get("space-key"),isNeverPublished:d.get("page-id")==="0"}})})});c.addSubmitHandler(function(a){return c.contentFormSubmit(a)});this.currentEditMode=this.MODE_RICHTEXT;
a.editButton.click(function(b){var d=require("tinymce");if(a.isFormEnabled()){c.changeMode(c.MODE_RICHTEXT);setTimeout(function(){e.Rte.getEditor().focus();d.isGecko&&c.bookmark&&e.Rte.getEditor().selection.moveToBookmark(c.bookmark)},0);a.cancelButton.enable()}b.preventDefault()});a.previewButton.click(function(d){var m=require("tinymce");if(a.isFormEnabled()&&c.currentEditMode!==c.MODE_PREVIEW){f();j(false);a.spinner.addClass("aui-icon-wait");if(m.isGecko&&!c.bookmark)c.bookmark=m.activeEditor.selection.getBookmark();
c.changeMode(c.MODE_PREVIEW,{errorCallback:function(){j(true);a.spinner.removeClass("aui-icon-wait")}});a.cancelButton.disable();s.publish("confluence.editor.preview",{contentId:e.params.contentId,pageVersion:e.params.pageVersion||"null"});b(k).trigger("preview.tinymce",{pageVersion:e.params.pageVersion||"null"})}d.preventDefault()});b("#editor-html-source").change(c.setSourceAreaHeight).keyup(c.setSourceAreaHeight);b("#rte-button-labels").bind("updateLabel",function(){var a=+d.get("num-labels")||
0,c="Labels";a===1?c=e.format("{0} Label",a):a>1&&(c=e.format("{0} Labels",a));b("#rte-button-labels").attr("data-tooltip",c)});var i=b("#PostingDate");if(i.length){i.attr("max",r().format("YYYY-MM-DD"));a.postingDatePicker=i.datePicker({overrideBrowserDefault:true});a.postingDatePicker.hide()}b("#wysiwygTextarea_parent .mceProgress, #wysiwygTextarea_parent .mceBlocker").on("click",function(){e.Rte.getEditor().focus()});b(k).bind("render-content-loaded",
function(d,e){var f=b("#previewArea iframe");if(f.contents().find("body")[0]==e){c.previewFrameOnload(e,f);[a.saveButton,a.editButton,a.previewButton].forEach(function(a){o(true,a)});f.focus();k.focus();b(g).trigger("iframeAppended",f)}});if(d.get("heartbeat")){c.heartbeat();c.heartbeatType.normal();e.bind("rte-destroyed",c.heartbeatType.cleanup)}e.bind("watchpage.pageoperation",function(){a.toggleWatchPage(false)});e.bind("unwatchpage.pageoperation",function(){a.toggleWatchPage(true)});var h=g.title,
i=require("tinymce");if(!i||i.majorVersion<4){if(d.get("new-page")&&d.get("form-name")==="inlinecommentform"){g.title="Edit"+g.title;h=g.title}if(d.get("new-page")&&b.trim(b("input#content-title").val()))g.title=q()+b("input#content-title").val()+" - "+d.get("space-name")+" - "+d.get("site-title")}b("input#content-title").on("change input",function(){if(d.get("content-type")!=="template"){var a=q();g.title=b.trim(this.value)?a+this.value+" - "+d.get("space-name")+" - "+d.get("site-title"):
h}});b("body",b("#wysiwygTextarea_ifr").contents()).click(f);e.trigger("init.rte-control")};a.toggleWatchPage=function(b){if(b&&d.get("content-type")==="comment"){a.watchPageToolbarGroup.show();if(a.watchPageCheckbox.length)a.watchPageCheckbox[0].checked=false}else a.watchPageToolbarGroup.hide()};return a}});require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-ui",function(b){require("ajs").bind("init.rte",function(){var f=b();Confluence.Editor.UI=f;f.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.InsertWiki.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog';
}


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_ignored) {
  return '<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.previewWikiIframeContent.soyTemplateName = 'Confluence.Templates.InsertWiki.previewWikiIframeContent';
}


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_ignored) {
  return '<p id="insert-wiki-info-title">' + soy.$$escapeHtml('Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page.') + '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">' + soy.$$escapeHtml('Insert') + '</span><span id="insert-wiki-preview-title">' + soy.$$escapeHtml('Preview') + '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'></textarea><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiMarkupDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiMarkupDialog';
}


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_ignored) {
  return '<p class=\'warning\'>' + soy.$$escapeHtml(opt_data.warningMessage) + '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>' + soy.$$escapeHtml(opt_data.exceptionMessage) + '</span></p>';
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiErrorSubDialog.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiErrorSubDialog';
}


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_ignored) {
  var output = '<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="' + soy.$$escapeHtml(opt_data.DEFAULT.val) + '">' + soy.$$escapeHtml(opt_data.DEFAULT.label) + '</option>';
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output += (opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '';
  }
  output += '</select></form></span>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.InsertWiki.wikiParserSelector.soyTemplateName = 'Confluence.Templates.InsertWiki.wikiParserSelector';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.Editor.Page.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_ignored) {
  return '<button id="rte-button-publish" data-test-id="tiny-publish-button" class="aui-button aui-button-primary default-submit" type="submit" name="confirm" value="Save" title="' + Confluence.Templates.Editor.Page.saveButtonTitle(opt_data) + '" tabindex="101">' + Confluence.Templates.Editor.Page.saveButtonText(opt_data) + '</button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButton.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButton';
}


Confluence.Templates.Editor.Page.saveButtonTitle = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish your blog post') : (opt_data.contentType == 'page') ? (opt_data.isNewPage) ? soy.$$escapeHtml('Publish changes') : soy.$$escapeHtml('Update the published page') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonTitle.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonTitle';
}


Confluence.Templates.Editor.Page.previewButton = function(opt_data, opt_ignored) {
  return '<button class="aui-button toolbar-item aui-button-light" id="rte-button-preview" data-test-id="tiny-preview-button" title="' + soy.$$escapeHtml('Preview') + '" type="button"><span class="trigger-text">' + soy.$$escapeHtml('Preview') + '</span></button>';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.previewButton.soyTemplateName = 'Confluence.Templates.Editor.Page.previewButton';
}


Confluence.Templates.Editor.Page.saveButtonText = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'blogpost' || opt_data.contentType == 'page') ? soy.$$escapeHtml('Publish') : (opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Publish') : soy.$$escapeHtml('Save'));
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.saveButtonText.soyTemplateName = 'Confluence.Templates.Editor.Page.saveButtonText';
}


Confluence.Templates.Editor.Page.cancelButton = function(opt_data, opt_ignored) {
  return '' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? '<ul class="aui-buttons rte-toolbar-group-done close"><button class="aui-button shared-drafts" type="submit" id="rte-button-cancel" data-test-id="tiny-cancel-button" name="cancel" value="cancel"><span class="icon aui-icon aui-icon-small aui-iconfont-close-dialog"></span></button></ul>' : '<button class="toolbar-item-link aui-button aui-button-link" type="submit" id="rte-button-cancel" data-test-id="tiny-cancel-button" name="cancel" value="cancel"><span class="trigger-text">' + ((opt_data.contentType == 'page' || opt_data.contentType == 'blogpost') ? soy.$$escapeHtml('Close') : soy.$$escapeHtml('Cancel')) + '</span></button>');
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.cancelButton.soyTemplateName = 'Confluence.Templates.Editor.Page.cancelButton';
}


Confluence.Templates.Editor.Page.quitDialogHeader = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'delete':
    case 'revert':
      output += (opt_data.newPage) ? (opt_data.contentType == 'blogpost') ? '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished blog post?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Delete unpublished page?') + '</h2>' : '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Revert to last published version?') + '</h2>';
      break;
    case 'publish':
    case 'update':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Publish the page?') + '</h2>';
      break;
    case 'diff':
      output += '<h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Unpublished changes') + '</h2>';
      break;
  }
  output += '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml('Close') + '</span></a>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogHeader.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogHeader';
}


Confluence.Templates.Editor.Page.quitDialogContent = function(opt_data, opt_ignored) {
  var output = '';
  switch (opt_data.dialogType) {
    case 'revert':
      output += (opt_data.contributors.length == 0) ? ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this blog post was last published') : soy.$$filterNoAutoescape('This will permanently delete all the changes you made since this page was last published.')) + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' : soy.$$filterNoAutoescape('This will permanently delete all the changes that the following people have made, since this page was last published.') + '<div class="aui-dialog2-footer-hint"><a id="qed-show-diff-button" class="aui-button aui-button-link">' + soy.$$escapeHtml('Show changes') + '</a></div>' + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'delete':
      output += (opt_data.contributors.length == 0) ? (opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('Once you delete an unpublished blog post, it\x27s gone for good.') : soy.$$filterNoAutoescape('If you delete an unpublished page, it\x27s gone for good.') : ((opt_data.contentType == 'blogpost') ? soy.$$filterNoAutoescape('This will permanently delete this blog post, which you and these other people have worked on.') : soy.$$filterNoAutoescape('This will permanently delete this page, which you and these other people have worked on.')) + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'publish':
    case 'update':
      output += soy.$$filterNoAutoescape('You\x27ll also be publishing changes made by these people:') + Confluence.Templates.Editor.Page.contributorList(opt_data);
      break;
    case 'diff':
      output += '<div><div class="legend"><span class="legend-title">' + soy.$$escapeHtml('Key') + ': </span><span class="diff-html-added">' + soy.$$escapeHtml('This line was added.') + '</span><span class="diff-html-removed">' + soy.$$escapeHtml('This line was removed.') + '</span><span class="diff-html-changed">' + soy.$$escapeHtml('Formatting was changed.') + '</span></div>' + ((! opt_data.newDialog) ? '<a class="aui-button aui-button-link" id="qed-hide-diff-button">' + soy.$$escapeHtml('Show contributors') + '</a>' : '') + '<hr/><div class="wiki-content"></div><span class="aui-icon aui-icon-wait diff-spinner"></span></div>';
      break;
  }
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.quitDialogContent.soyTemplateName = 'Confluence.Templates.Editor.Page.quitDialogContent';
}


Confluence.Templates.Editor.Page.hiddenInputCancel = function(opt_data, opt_ignored) {
  return '<input type="hidden" name="cancel" value="cancel">';
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.hiddenInputCancel.soyTemplateName = 'Confluence.Templates.Editor.Page.hiddenInputCancel';
}


Confluence.Templates.Editor.Page.contributorList = function(opt_data, opt_ignored) {
  var output = '<ul class="contributor-list">';
  var contributorList147 = opt_data.contributors;
  var contributorListLen147 = contributorList147.length;
  for (var contributorIndex147 = 0; contributorIndex147 < contributorListLen147; contributorIndex147++) {
    var contributorData147 = contributorList147[contributorIndex147];
    output += '<li data-username="' + soy.$$escapeHtml(contributorData147.name) + '" data-account-id="' + soy.$$escapeHtml(contributorData147.accountId) + '"><div class="contributor-avatar ' + ((contributorData147.active) ? 'active' : '') + '"><img src="' + soy.$$escapeHtml(contributorData147.avatarURL) + '"></div><div class="contributor-detail"><p class="contributor-detail-name"><span>' + soy.$$escapeHtml(contributorData147.fullname) + '</span></p><p class="contributor-detail-last-modification"><span>' + soy.$$escapeHtml('Last edited') + ' ' + soy.$$escapeHtml(contributorData147.formattedLastModification) + '</span></p></div></li>';
  }
  output += '</ul>';
  return output;
};
if (goog.DEBUG) {
  Confluence.Templates.Editor.Page.contributorList.soyTemplateName = 'Confluence.Templates.Editor.Page.contributorList';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
define("confluence-editor/insert-image-dialog/insert-image-dialog","jquery ajs underscore confluence-link-browser/link-object confluence-link-browser/link-adapter confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/meta".split(" "),function(b,f,k,h,l,g,m){var e={beforeShowListeners:[],panelComponent:[],sizeToFit:function(){this.each(function(){var a=this,c=b(this).parent(),d=c.height();c.children().each(function(){this!==a&&b(this).is(":visible")&&(d=d-b(this).outerHeight())});c=b(this).outerHeight()-
b(this).height();b(this).css("height",Math.max(0,d-c)+"px")});return this},defaultInsertImageDialog:function(){f.Rte.BookmarkManager.storeBookmark();e.insertImageDialog(function(a){var c=require("tinymce");f.Rte.BookmarkManager.restoreBookmark();var d={},i=null,g=true;if(a.url){d={url:a.url,filename:a.url,contentId:a.contentId};i="fromWeb";c.confluence.ImageUtils.insertFromProperties(d)}else{var h=a.selectItems.length>1;k.each(a.selectItems,function(a,b){var j=a.get("ownerId");b===0&&(i=j===m.get("content-id")?
"thisPage":"otherPage");if(a.isImage()){d={filename:a.getFileName(),contentId:j};c.confluence.ImageUtils.insertFromProperties(d,h)}else{g=false;f.MacroBrowser.getMacroMetadata("view-file")?e._insertFilePlaceholderToEditor(a):e._insertLinkToEditor(a)}})}require(["conf/confluence-drag-and-drop/analytics/files-upload-analytics"],function(c){c.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,g,i)});b("#comments-section").length&&f.Rte.fixEditorFocus()},function(){f.Rte.BookmarkManager.restoreBookmark()})},
findPanelComponentById:function(a){for(var c=g.ImageDialog.panelComponent,d=0,b=c.length;d<b;d++)if(c[d].id==a)return c[d]},insertImageDialog:function(a,c){var b=new g.FileDialog.FileDialogView({submitCallback:a,cancelCallback:c,beforeShowListeners:e.beforeShowListeners,panelComponents:e.panelComponent});b.render();return b},_insertLinkToEditor:function(a){var b=h.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");l.setLink(b)},_insertFilePlaceholderToEditor:function(a){var b=
{name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert-utils"],function(a){a.insertFilePlaceholder(b)})}};return e});
require("confluence/module-exporter").safeRequire("confluence-editor/insert-image-dialog/insert-image-dialog",function(b){require("jquery").fn.sizeToFit=b.sizeToFit;Confluence.Editor.ImageDialog=b;Confluence.Editor.defaultInsertImageDialog=b.defaultInsertImageDialog;Confluence.Editor.ImageDialog.findPanelComponentById=b.findPanelComponentById;Confluence.Editor.insertImageDialog=b.insertImageDialog;Confluence.Editor.ImageDialog._insertLinkToEditor=b._insertLinkToEditor;Confluence.Editor.ImageDialog._insertFilePlaceholderToEditor=
b._insertFilePlaceholderToEditor});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
define("confluence-editor/panel-components/panel-components-init",["confluence/legacy-editor-global-AVOID-IF-POSSIBLE","ajs"],function(a,d){return function(){if(a&&a.ImageDialog&&a.ImageDialog.panelComponent){var b=a.FileDialog.eventListener,e=a.FileDialog.ExternalPanelView,f=a.FileDialog.SearchPanelView,g=a.FileDialog.AttachmentsPanelView,c=a.ImageDialog.panelComponent;"template"!==d.Meta.get("content-type")&&(b=new g({eventListener:b}),c.push(b));c.push(new e);c.push(new f)}}});
require("confluence/module-exporter").safeRequire("confluence-editor/panel-components/panel-components-init",function(a){require("ajs").toInit(a)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
define("confluence-editor/page-editor-drafts","jquery ajs confluence/meta confluence/api/constants confluence-editor/editor/page-editor-message confluence/analytics-support confluence/legacy-editor-global-AVOID-IF-POSSIBLE confluence/api/event confluence/dark-features confluence/api/ajax confluence-editor/loader/collaborative-helper".split(" "),function(b,f,e,s,v,n,c,o,k,w,l){function r(){var a=p();if(g!==a){g=a;return true}return false}function p(){var a=b("#content-title");return a.hasClass("placeholded")?
"":a.val()}var q=false,m=false,g="",t=e.get("remote-user")!=="",u=k.isEnabled("editor.ajax.save")&&!k.isEnabled("editor.ajax.save.disable");o.bind("editor-shared-drafts-published editor-shared-drafts-discarded",function(){m=q=false});o.bind("rte-ready",function(){g=p()});return{isDraftSaved:function(){return q},isDraftManuallySaved:function(){return m},isDraftBlank:function(){return f.Rte.Content.isEmpty()&&!b.trim(c.getCurrentTitle())},isNewContent:function(){return f.Rte.getEditor()&&e.getBoolean("new-page")===
true},isDraftDirty:function(){return c.hasContentChanged()||c.Drafts.isDraftSaved()&&!c.Drafts.isDraftManuallySaved()},unloadMessage:function(a){if(a&&(a.srcElement&&a.srcElement.activeElement instanceof HTMLIFrameElement)&&(e.get("content-type")==="page"||e.get("content-type")==="blogpost"))n.publish("confluence.editor.close",{source:"closeWindow",contentId:e.get("content-id"),currentVersion:e.get("page-version")||"null"});a=function(a,b){c.Drafts.save({skipErrorHandler:true,forceSave:a,manualSave:b,
async:false})};if(typeof seleniumAlert!=="undefined")a();else{a(r());if(l.isCollaborativeEditingAvailable()&&l.hasUnsavedChanges())return "We haven\'t finished saving your changes. If you leave before seeing the \'Draft saved\' message, you might lose your changes."}},bindUnloadMessage:function(){b(window).bind("beforeunload",c.Drafts.unloadMessage)},unBindUnloadMessage:function(){b(window).unbind("beforeunload")},save:function(a){a=a||{};if(c.isSubmitting||!c.hasContentChanged()&&!r()&&!a.forceSave)f.debug("skipping draft save");else{f.debug("preparing to save editor draft");
var h=b("#newSpaceKey"),g=b("#originalVersion"),k=c.inRichTextMode(),n=a.async===void 0?true:a.async,h={draftId:e.get("draft-id"),pageId:e.get("page-id"),type:f.params.draftType,title:p(),spaceKey:h.length?h.val():encodeURIComponent(e.get("space-key"))};b.extend(h,l.getEditorContent());if(g.length)h.pageVersion=parseInt(g.val(),10);b.ajax({type:"POST",url:s.CONTEXT_PATH+"/rest/tinymce/1/drafts",data:JSON.stringify(h),contentType:"application/json",dataType:"text json",success:function(j){if(j!=null&&
(!(t&&j.draftId===0)||!u)){c.contentHasChangedSinceLastSave=false;k&&f.Rte.Content.editorResetContentChanged();q=true;m=!!a.manualSave;e.set("draft-id",j.draftId+"");b("#draftId",c.getCurrentForm()).val(j.draftId);b("#draft-error").remove();if(!l.isCollaborativeEditingAvailable()){var g=b("#draft-status"),d;if(!(d=j.time)){var i=new Date;d=i.getHours();var i=i.getMinutes(),h=d>11?"PM":"AM";d=d%12;d=(d==0?"12":d)+":"+(i<10?"0":"")+i+" "+h}i=m?f.format("Draft saved at {0}",d):f.format("Draft autosaved at {0}",
d);g.attr("data-tooltip",i);g.html(i)}if(b.isFunction(a.onSuccessHandler))a.onSuccessHandler(j);c.Drafts.lastSaveTime=d;o.trigger("rte-draft-saved",{draftId:j.draftId})}},error:function(b,c){if(!a.skipErrorHandler&&typeof a!=="undefined"&&typeof a.onErrorHandler==="function")a.onErrorHandler(c)},timeout:3E4,async:n})}}}});require("confluence/module-exporter").exportModuleAsGlobal("confluence-editor/page-editor-drafts","Confluence.Editor.Drafts");
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
define("confluence-editor/editor/page-editor-permissions",["ajs","jquery"],function(b,d){var c={updateEditPageRestrictions:function(c,a,e,g){var f=d("#rte-button-restrictions"),i=f.find(".icon"),h="";c||a?(i.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass(c?"aui-iconfont-locked icon-red":"aui-iconfont-unlocked icon-red"),h="Restrictions apply"):(i.removeClass("aui-iconfont-locked aui-iconfont-unlocked icon-red").addClass("aui-iconfont-unlocked"),h=e?
"Restrictions apply":"Unrestricted");f.attr("data-tooltip",h);f.data("explicit-restrictions",c);f.data("inherited-restrictions",a);f.data("restrictionsHash",g)},handleHeartbeat:function(j,a){if("undefined"!==typeof a.restrictionsHash){var e=d("#rte-button-restrictions");if(e.data("restrictionsHash")!==a.restrictionsHash)if(d("#update-page-restrictions-dialog").is(":visible")&&b.PagePermissions.updateRestrictionsDialog)b.PagePermissions.updateRestrictionsDialog(),
e.data("restrictionsHash",a.restrictionsHash);else{var g=""!==a.restrictionsHash,f=a.hasViewRestrictions,e=!!e.data("inherited-restrictions");c.updateEditPageRestrictions(f,e,g,a.restrictionsHash)}}},init:function(){b.bind("editor-heartbeat",c.handleHeartbeat);b.bind("edit-page-restrictions-updated",function(b,a){c.updateEditPageRestrictions(a.hasExplicitRestrictions,a.hasInheritedRestrictions,a.hasAnyExplicitRestrictions,a.restrictionsHash)})}};return c});
require("confluence/module-exporter").safeRequire("confluence-editor/editor/page-editor-permissions",function(b){var d=require("ajs"),c=require("jquery");d.PagePermissions=d.PagePermissions||{};c.extend(d.PagePermissions,{updateEditPageRestrictions:b.updateEditPageRestrictions});d.toInit(b.init)});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-editor', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.JiraRoadmapMacro.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.JiraRoadmapMacro == 'undefined') { Confluence.Templates.JiraRoadmapMacro = {}; }


Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<section id="confluence-jira-roadmap-dialog" class="jiraroadmap jiraroadmap-dialog" class="aui-dialog2 aui-dialog2-xlarge aui-layer" role="dialog" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Jira timeline') + '</h2></header><div class="aui-dialog2-content"><div class="dialog-content"><form action="" class="aui"><div class="field-group select-tenant"><div class="field-label">' + soy.$$escapeHtml('Paste a Jira instance URL') + '</div><input id="tenant-url" type="text" class="text" /></div><div class="field-group select-project"><div class="field-label">' + soy.$$escapeHtml('Project') + '</div><input id="project-select" /></div><div class="field-group select-board"><div class="field-label">' + soy.$$escapeHtml('Board') + '</div><input id="board-select" /></div></form><div class="field-error" id="field-error"></div><div tabindex="-1" id="roadmap-preview" class="jiraroadmap-iframe-container"></div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form class="aui"><a tabindex="0" id="insert-jira-roadmap-dialog" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Save') + '</a><a tabindex="0" class="close-jira-roadmap-dialog aui-button aui-button-link">' + soy.$$escapeHtml('Cancel') + '</a></form></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel';
}


Confluence.Templates.JiraRoadmapMacro.roadmapError = function(opt_data, opt_ignored) {
  return '<div class="error-screen"><div class="message" id="preview-error-message">' + ((opt_data.type == 'permission') ? '<h2>' + soy.$$escapeHtml('You don\x27t have permission to view this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check the project settings in Jira.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/adminjiracloud/managing-project-permissions-776636362.html" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>' : (opt_data.type == 'validation' || opt_data.type == 'not-available') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/jirasoftwarecloud/roadmap-957979308.html#Roadmap-TroubleshootyourRoadmap" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>' : (opt_data.type == 'invalid-url') ? '<h2>' + soy.$$escapeHtml('This doesn\x27t look like a URL of Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/>' : (opt_data.type == 'inconsistent-env') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('This Jira timeline is in a different environment.') + '</p>' : (opt_data.type == 'project-type') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('This macro only supports team-managed software projects.') + '</p>' : (opt_data.type == 'service-unavailable') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Try again later, or contact Atlassian Support if this keeps happening.') + '</p><br/><a href="https://support.atlassian.com/contact/#/" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Atlassian Support') + '</a>' : '<h2>' + soy.$$escapeHtml('This Jira timeline is not currently active.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/jirasoftwarecloud/roadmap-957979308.html" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapError.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapError';
}


Confluence.Templates.JiraRoadmapMacro.roadmapIframe = function(opt_data, opt_ignored) {
  return ((opt_data.roadmapUrl != '') ? '<div class="preview-header"><div class="warning-content"><span class="warning-icon"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill-rule="evenodd"><path fill="currentcolor" d="M12.938 4.967c-.518-.978-1.36-.974-1.876 0L3.938 18.425c-.518.978-.045 1.771 1.057 1.771h14.01c1.102 0 1.573-.797 1.057-1.771z"></path><path fill="inherit" d="M12 15a1 1 0 0 1-1-1V9a1 1 0 0 1 2 0v5a1 1 0 0 1-1 1m0 3a1 1 0 0 1 0-2 1 1 0 0 1 0 2"></path></g></svg></span><span class="warning-text">This timeline uses the <strong>Jira Timeline </strong> macro, which will stop working in October. To keep viewing this timeline on your page, replace this macro with a link to your project timeline, and select <strong> Embed.</strong><a id="sunsetLink" href="https://support.atlassian.com/jira-software-cloud/docs/smart-links-for-your-timeline/" target="_blank" tabindex="0"> More about smart links.</a></span></div></div>' : '') + '<iframe id="roadmap-iframe" src="' + soy.$$escapeHtml(opt_data.iframeSrc) + '" width="100%" frameBorder="0" ></iframe>' + ((opt_data.roadmapUrl != '') ? '<div class="preview-footer"><a class="aui-button aui-button-link" target="_blank" href="' + soy.$$escapeHtml(opt_data.roadmapUrl) + '">' + soy.$$escapeHtml('View in Jira') + '</a></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapIframe.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapIframe';
}


Confluence.Templates.JiraRoadmapMacro.roadmapLoading = function(opt_data, opt_ignored) {
  return '<div class="jiraroadmap-loading"><div class="spinner-container"><div class="spinner"><svg focusable="false" size="50" height="50" width="50" viewBox="0 0 50 50"><circle cx="25" cy="25" r="22.5"></circle></svg></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapLoading.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapLoading';
}


Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage = function(opt_data, opt_ignored) {
  return '<div class="error-screen"><div class="message" id="preview-error-message"><p>' + soy.$$escapeHtml(opt_data.message) + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a>' + ((opt_data.docUrl != '' && opt_data.buttonText != '') ? '<a href="' + soy.$$escapeHtml(opt_data.docUrl) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml(opt_data.buttonText) + '</a>' : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-editor', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/jiraroadmap-helper.js' */
define("confluence-advanced-macros/jiraroadmap-helper",["jquery","confluence/templates","confluence/legacy-message-queue"],function(h,i,j){var d={getIsTinyMce:function(){try{return 0<document.querySelectorAll('[data-testid="TinyMCEClientRendererTestId"]').length||0<document.querySelectorAll('[data-test-id="tinymce-editor-loaded"]').length}catch(c){return!0}},makeGetRequest:function(c,b){var a=new XMLHttpRequest;a.open("GET",c);a.withCredentials=!0;a.onload=function(){if(200===a.status){var c=JSON.parse(a.responseText);
b({data:c,status:a.status})}else try{b({data:null,error:JSON.parse(a.responseText),status:a.status})}catch(d){b({data:null,error:null,status:a.status})}};a.onerror=function(){b({data:null,error:null,status:a.status})};a.send()},convertParamsToFragmentUrl:function(c,b,a){var d=/[\w][\w]+/g.exec(b);return d&&d[0]?c+"/rest/greenhopper/1.0/roadmap/fragment/confluenceMacro/"+b+"?fragmentHost="+window.location.protocol+"//"+window.location.hostname+(a?"&boardId="+a:""):null},convertParamsToRoadmapUrl:function(c,
b,a,d){return d?c+"/jira/software/c/projects/"+b+"/boards/"+a+"/timeline":c+"/jira/software/projects/"+b+"/boards/"+a+"/timeline"},convertRoadmapUrlToParams:function(c){var b=document.createElement("a");b.href=-1<c.indexOf("://")?c:"https://"+c;var a=/(?:\?|&)projectKey=([\w][\w]+)(?:&rapidView=(\d+))?/g,d=/(?:.+)\/jira\/software\/?c?\/projects\/([\w][\w]+)\/boards\/(\d+|null|undefined)\/(roadmap|timeline)/g,a=-1<b.href.indexOf("Roadmap.jspa")?a.exec(b.search):d.exec(b.href);return{tenant:"https://"+
b.hostname,project:a&&a[1]?a[1]:null,boardId:a&&a[2]&&"undefined"!==a[2]&&"null"!==a[2]?a[2]:null,isClassic:-1<c.indexOf("software/c/projects")}},matchHostEnvironment:function(c){var b=["jira-dev.com","localhost","atl-test.space"],a=window.location.hostname,d=b.filter(function(a){return-1<c.indexOf(a)}),b=b.filter(function(b){return-1<a.indexOf(b)});return 0<d.length===0<b.length},showCustomErrorScreen:function(c,b,a){c=i.JiraRoadmapMacro.roadmapErrorWithCustomMessage({link:c,buttonText:a.buttonText||
"",docUrl:a.docUrl||"",message:a.message});b.empty();h(c).appendTo(b);j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"showed",actionSubject:"jiraRoadmapMacroError",attributes:{errorType:"custom",isTinyMce:d.getIsTinyMce()}}})},showGenericErrorScreen:function(c,b,a){c=i.JiraRoadmapMacro.roadmapError({link:c,type:a});b.empty();h(c).appendTo(b);j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"showed",actionSubject:"jiraRoadmapMacroError",
attributes:{errorType:a,isTinyMce:d.getIsTinyMce()}}})},showLoadingScreen:function(c){c.empty();var b=i.JiraRoadmapMacro.roadmapLoading();h(b).appendTo(c)},renderPreview:function(c,b,a,l,f,g){d.makeGetRequest(b+"/rest/greenhopper/1.0/roadmap/fragment/configuration/?projectKey="+a+"&fragmentHost="+(window.location.protocol+"//"+window.location.hostname)+(l?"&boardId="+l:""),function(e){f.empty();if(e&&e.data&&e.data.hasActiveJiraSoftwareLicense)if(e.data.isValidRoadmap&&e.data.isRoadmapEnabled&&!e.data.isCrossProject){var k=
l||e.data.boardId,m=d.convertParamsToFragmentUrl(b,a,k),k=d.convertParamsToRoadmapUrl(b,a,k,e.data.isClassic),m=i.JiraRoadmapMacro.roadmapIframe({iframeSrc:m+"&hideHeader="+!c,roadmapUrl:k});h(m).appendTo(f);f.find("#sunsetLink").on("click",function(a){a.preventDefault();j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"validated",actionSubject:"jiraRoadmapMacro",attributes:{sunsetLinkClicked:!0,isTinyMce:d.getIsTinyMce(),isEditPreview:!c}}});window.open(h(this).attr("href"),
"_blank")});g&&g({success:!0,boardId:e.data.boardId,isClassic:e.data.isClassic});j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"validated",actionSubject:"jiraRoadmapMacro",attributes:{isTinyMce:d.getIsTinyMce(),isEditPreview:!c}}})}else e.data.isRoadmapEnabled?d.showGenericErrorScreen(b+"/projects/"+a+"/settings",f,"validation"):d.showGenericErrorScreen(b,f,"not-available"),g&&g({success:!1,boardId:e.data.boardId,isClassic:e.data.isClassic});else{if(e.error&&
null!==e.error.message)d.showCustomErrorScreen(b,f,e.error);else if(503===e.status)d.showGenericErrorScreen(b,f,"service-unavailable");else if(e.error&&e.error.errorMessages)switch(0<e.error.errorMessages.length?e.error.errorMessages[0]:""){case "You must have the browse project permission to view this project.":d.showGenericErrorScreen(b,f,"permission");break;default:d.showGenericErrorScreen(b,f,"not-available")}else d.showGenericErrorScreen(b,f,"not-available");g&&g({success:!1,boardId:null,isClassic:!1})}})}};
return d});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-editor', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/jiraroadmap-editor.js' */
define("confluence-advanced-macros/jiraroadmap-editor","jquery ajs aui/dialog2 confluence/templates confluence/macro-js-overrides confluence-macro-browser/macro-browser-facade confluence-advanced-macros/jiraroadmap-helper".split(" "),function(c,m,r,z,s,A,h){return{overrideOpener:function(i){function o(a){var b="";switch(a){case "invalid-url":b="This doesn\'t look like a URL of Jira timeline.";break;case "inconsistent-env":b="This Jira timeline is in a different environment.";
break;case "service-unavailable":b="Try again later, or contact Atlassian Support if this keeps happening.";break;default:b=""}n.html(b)}function v(a){var b=/[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/g;if(a&&a.url&&a.url!==""&&a.url.match(b)!==null)if((b=h.convertRoadmapUrlToParams(a.url))&&b.tenant){var f=h.convertParamsToFragmentUrl(b.tenant,b.project,b.boardId);return{url:a.url,iframeUrl:f,tenant:b.tenant,project:b.project,boardId:b.boardId,isClassic:b.isClassic}}return null}
var t=z.JiraRoadmapMacro.roadmapPopupPanel(),s=window.location.protocol+"//"+window.location.hostname,a,u,g,p,k,e,l,n,y=function(d,b,f){g.attr("disabled",true);h.makeGetRequest(d+"/rest/greenhopper/1.0/roadmap/fragment/cloudId?fragmentHost="+s,function(d){if(d&&d.data&&d.data.cloudId){u=d.data.cloudId;var q="/gateway/api/ex/jira/"+u;n.html("");w(k,"query",q+"/rest/api/3/project/search?typeKey=software",function(a){return a.values?{results:a.values.map(function(a){return{id:a.key,text:a.name+" ("+
a.key+")"}})}:{results:[]}},function(b){a.project=b;if(a.tenant&&b){n.html("");x(q,b,null)}});if(a.tenant&&b){k.val(b).auiSelect2("data",{id:b,text:b});x(q,b,f)}else j(e)}else{j(k);j(e);l.empty();d.status===503?o("service-unavailable"):o("invalid-url")}})},w=function(a,b,f,e,q){a.val(null);a.auiSelect2("destroy");a.prop("disabled",false);a.unbind().change(function(){q(a.auiSelect2("val"))});a.auiSelect2({minimumResultsForSearch:b?0:-1,minimumInputLength:0,multiple:false,placeholder:"Select",
ajax:{data:function(a){var d={};b&&(d[b]=a);return d},dataType:"json",url:f,results:e,params:{xhrFields:{withCredentials:true},error:function(){var a=c(".select2-drop-active > .select2-results"),b="No result found.";a.html('<li class="select2-no-results">'+b+"</li>")}},cache:true,quietMillis:300},dropdownCssClass:"jiraroadmap-macro-dropdown"})},j=function(a){a.val(null);a.auiSelect2("destroy");a.auiSelect2({data:[],placeholder:"Select"});
a.prop("disabled",true)},x=function(d,b,f){var d=d+"/rest/agile/1.0/board?negateLocationFiltering=false&orderBy=name&projectLocation="+b,c=function(b){e.prop("disabled",true);a.boardId=b;if(a.tenant&&a.boardId){h.showLoadingScreen(l);n.html("");h.renderPreview(false,a.tenant,a.project,a.boardId,l,function(b){e.prop("disabled",false);if(b){a.boardId=b.boardId;a.isClassic=b.isClassic;b.success?g.removeAttr("disabled"):g.attr("disabled",true)}})}};l.empty();g.attr("disabled",true);w(e,null,d,function(a){return a.values?
{results:a.values.map(function(a){return{id:a.id,text:a.name}})}:{results:[]}},c);if(b&&f){e.val(f).auiSelect2("data",{id:f,text:f});h.makeGetRequest("/gateway/api/ex/jira/"+u+"/rest/agile/1.0/board/"+f,function(a){if(a&&a.data){e.auiSelect2("data",{id:f,text:a.data.name});k.auiSelect2("data",{id:b,text:a.data.location.displayName})}});c(f)}else{e.auiSelect2("data",null);g.prop("disabled",true)}};c("#confluence-jira-roadmap-dialog").length>0&&c("#confluence-jira-roadmap-dialog").remove();a=v(i.params);
i=c(t).appendTo(c("body"));r("#confluence-jira-roadmap-dialog").show();g=c("#insert-jira-roadmap-dialog",i);t=c(".close-jira-roadmap-dialog",i);p=c("#tenant-url",i);k=c("#project-select",i);e=c("#board-select",i);l=c("#roadmap-preview",i);n=c("#field-error",i);c("#confluence-jira-roadmap-dialog").find("form").unbind().submit(function(a){a.preventDefault()});g.unbind().click(function(){if(a&&a.tenant&&a.project){A.insert({name:"jiraroadmap",params:{url:h.convertParamsToRoadmapUrl(a.tenant,a.project,
a.boardId,a.isClassic)}});r("#confluence-jira-roadmap-dialog").hide()}});t.unbind().click(function(){r("#confluence-jira-roadmap-dialog").hide()});p.unbind().keyup(function(a,b){var c;return function(){var e=this,g=arguments;if(c){clearTimeout(c);c=void 0}c=setTimeout(function(){a.apply(e,g);c=void 0},b)}}(function(){n.html("");var d=c(this).val(),b=v({url:d});if(!b||d===""||!b.tenant){b&&b.tenant&&!h.matchHostEnvironment(b.tenant)?o("inconsistent-env"):d!==""&&o("invalid-url");l.empty();j(k);j(e);
g.attr("disabled",true);a=null}else if(!a||b.tenant!==a.tenant||b.project!==a.project||b.boardId!==a.boardId){a={tenant:b.tenant,project:b.project,boardId:b.boardId};l.empty();y(a.tenant,a.project,a.boardId);p.val(a.tenant)}},500));if(a&&a.url&&a.tenant){p.val(a.tenant);if(h.matchHostEnvironment(a.tenant))y(a.tenant,a.project,a.boardId);else{o("inconsistent-env");j(k);j(e);g.attr("disabled",true);a=null}}else{g.removeAttr("disabled");p.focus();(!a||!a.project)&&j(k);(!a||!a.boardId)&&j(e)}},init:function(){s.put("jiraroadmap",
{opener:this.overrideOpener})}}});require("confluence/module-exporter").safeRequire("confluence-advanced-macros/jiraroadmap-editor",function(c){require("ajs").toInit(function(){c.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-preview', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.JiraRoadmapMacro.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.JiraRoadmapMacro == 'undefined') { Confluence.Templates.JiraRoadmapMacro = {}; }


Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel = function(opt_data, opt_ignored) {
  return '<section id="confluence-jira-roadmap-dialog" class="jiraroadmap jiraroadmap-dialog" class="aui-dialog2 aui-dialog2-xlarge aui-layer" role="dialog" aria-hidden="true"><header class="aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Jira timeline') + '</h2></header><div class="aui-dialog2-content"><div class="dialog-content"><form action="" class="aui"><div class="field-group select-tenant"><div class="field-label">' + soy.$$escapeHtml('Paste a Jira instance URL') + '</div><input id="tenant-url" type="text" class="text" /></div><div class="field-group select-project"><div class="field-label">' + soy.$$escapeHtml('Project') + '</div><input id="project-select" /></div><div class="field-group select-board"><div class="field-label">' + soy.$$escapeHtml('Board') + '</div><input id="board-select" /></div></form><div class="field-error" id="field-error"></div><div tabindex="-1" id="roadmap-preview" class="jiraroadmap-iframe-container"></div></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form class="aui"><a tabindex="0" id="insert-jira-roadmap-dialog" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Save') + '</a><a tabindex="0" class="close-jira-roadmap-dialog aui-button aui-button-link">' + soy.$$escapeHtml('Cancel') + '</a></form></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapPopupPanel';
}


Confluence.Templates.JiraRoadmapMacro.roadmapError = function(opt_data, opt_ignored) {
  return '<div class="error-screen"><div class="message" id="preview-error-message">' + ((opt_data.type == 'permission') ? '<h2>' + soy.$$escapeHtml('You don\x27t have permission to view this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check the project settings in Jira.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/adminjiracloud/managing-project-permissions-776636362.html" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>' : (opt_data.type == 'validation' || opt_data.type == 'not-available') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/jirasoftwarecloud/roadmap-957979308.html#Roadmap-TroubleshootyourRoadmap" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>' : (opt_data.type == 'invalid-url') ? '<h2>' + soy.$$escapeHtml('This doesn\x27t look like a URL of Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/>' : (opt_data.type == 'inconsistent-env') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('This Jira timeline is in a different environment.') + '</p>' : (opt_data.type == 'project-type') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('This macro only supports team-managed software projects.') + '</p>' : (opt_data.type == 'service-unavailable') ? '<h2>' + soy.$$escapeHtml('We can\x27t display this Jira timeline.') + '</h2><p>' + soy.$$escapeHtml('Try again later, or contact Atlassian Support if this keeps happening.') + '</p><br/><a href="https://support.atlassian.com/contact/#/" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Atlassian Support') + '</a>' : '<h2>' + soy.$$escapeHtml('This Jira timeline is not currently active.') + '</h2><p>' + soy.$$escapeHtml('Please check with your system administrator.') + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a><a href="https://confluence.atlassian.com/jirasoftwarecloud/roadmap-957979308.html" target="_blank" tabindex="0" class="aui-button aui-button-link">' + soy.$$escapeHtml('Learn more') + '</a>') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapError.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapError';
}


Confluence.Templates.JiraRoadmapMacro.roadmapIframe = function(opt_data, opt_ignored) {
  return ((opt_data.roadmapUrl != '') ? '<div class="preview-header"><div class="warning-content"><span class="warning-icon"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill-rule="evenodd"><path fill="currentcolor" d="M12.938 4.967c-.518-.978-1.36-.974-1.876 0L3.938 18.425c-.518.978-.045 1.771 1.057 1.771h14.01c1.102 0 1.573-.797 1.057-1.771z"></path><path fill="inherit" d="M12 15a1 1 0 0 1-1-1V9a1 1 0 0 1 2 0v5a1 1 0 0 1-1 1m0 3a1 1 0 0 1 0-2 1 1 0 0 1 0 2"></path></g></svg></span><span class="warning-text">This timeline uses the <strong>Jira Timeline </strong> macro, which will stop working in October. To keep viewing this timeline on your page, replace this macro with a link to your project timeline, and select <strong> Embed.</strong><a id="sunsetLink" href="https://support.atlassian.com/jira-software-cloud/docs/smart-links-for-your-timeline/" target="_blank" tabindex="0"> More about smart links.</a></span></div></div>' : '') + '<iframe id="roadmap-iframe" src="' + soy.$$escapeHtml(opt_data.iframeSrc) + '" width="100%" frameBorder="0" ></iframe>' + ((opt_data.roadmapUrl != '') ? '<div class="preview-footer"><a class="aui-button aui-button-link" target="_blank" href="' + soy.$$escapeHtml(opt_data.roadmapUrl) + '">' + soy.$$escapeHtml('View in Jira') + '</a></div>' : '');
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapIframe.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapIframe';
}


Confluence.Templates.JiraRoadmapMacro.roadmapLoading = function(opt_data, opt_ignored) {
  return '<div class="jiraroadmap-loading"><div class="spinner-container"><div class="spinner"><svg focusable="false" size="50" height="50" width="50" viewBox="0 0 50 50"><circle cx="25" cy="25" r="22.5"></circle></svg></div></div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapLoading.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapLoading';
}


Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage = function(opt_data, opt_ignored) {
  return '<div class="error-screen"><div class="message" id="preview-error-message"><p>' + soy.$$escapeHtml(opt_data.message) + '</p><br/><a href="' + soy.$$escapeHtml(opt_data.link) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml('Go to Jira') + '</a>' + ((opt_data.docUrl != '' && opt_data.buttonText != '') ? '<a href="' + soy.$$escapeHtml(opt_data.docUrl) + '" target="_blank" tabindex="0" class="aui-button aui-button-primary">' + soy.$$escapeHtml(opt_data.buttonText) + '</a>' : '') + '</div></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage.soyTemplateName = 'Confluence.Templates.JiraRoadmapMacro.roadmapErrorWithCustomMessage';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-preview', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/jiraroadmap-helper.js' */
define("confluence-advanced-macros/jiraroadmap-helper",["jquery","confluence/templates","confluence/legacy-message-queue"],function(h,i,j){var d={getIsTinyMce:function(){try{return 0<document.querySelectorAll('[data-testid="TinyMCEClientRendererTestId"]').length||0<document.querySelectorAll('[data-test-id="tinymce-editor-loaded"]').length}catch(c){return!0}},makeGetRequest:function(c,b){var a=new XMLHttpRequest;a.open("GET",c);a.withCredentials=!0;a.onload=function(){if(200===a.status){var c=JSON.parse(a.responseText);
b({data:c,status:a.status})}else try{b({data:null,error:JSON.parse(a.responseText),status:a.status})}catch(d){b({data:null,error:null,status:a.status})}};a.onerror=function(){b({data:null,error:null,status:a.status})};a.send()},convertParamsToFragmentUrl:function(c,b,a){var d=/[\w][\w]+/g.exec(b);return d&&d[0]?c+"/rest/greenhopper/1.0/roadmap/fragment/confluenceMacro/"+b+"?fragmentHost="+window.location.protocol+"//"+window.location.hostname+(a?"&boardId="+a:""):null},convertParamsToRoadmapUrl:function(c,
b,a,d){return d?c+"/jira/software/c/projects/"+b+"/boards/"+a+"/timeline":c+"/jira/software/projects/"+b+"/boards/"+a+"/timeline"},convertRoadmapUrlToParams:function(c){var b=document.createElement("a");b.href=-1<c.indexOf("://")?c:"https://"+c;var a=/(?:\?|&)projectKey=([\w][\w]+)(?:&rapidView=(\d+))?/g,d=/(?:.+)\/jira\/software\/?c?\/projects\/([\w][\w]+)\/boards\/(\d+|null|undefined)\/(roadmap|timeline)/g,a=-1<b.href.indexOf("Roadmap.jspa")?a.exec(b.search):d.exec(b.href);return{tenant:"https://"+
b.hostname,project:a&&a[1]?a[1]:null,boardId:a&&a[2]&&"undefined"!==a[2]&&"null"!==a[2]?a[2]:null,isClassic:-1<c.indexOf("software/c/projects")}},matchHostEnvironment:function(c){var b=["jira-dev.com","localhost","atl-test.space"],a=window.location.hostname,d=b.filter(function(a){return-1<c.indexOf(a)}),b=b.filter(function(b){return-1<a.indexOf(b)});return 0<d.length===0<b.length},showCustomErrorScreen:function(c,b,a){c=i.JiraRoadmapMacro.roadmapErrorWithCustomMessage({link:c,buttonText:a.buttonText||
"",docUrl:a.docUrl||"",message:a.message});b.empty();h(c).appendTo(b);j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"showed",actionSubject:"jiraRoadmapMacroError",attributes:{errorType:"custom",isTinyMce:d.getIsTinyMce()}}})},showGenericErrorScreen:function(c,b,a){c=i.JiraRoadmapMacro.roadmapError({link:c,type:a});b.empty();h(c).appendTo(b);j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"showed",actionSubject:"jiraRoadmapMacroError",
attributes:{errorType:a,isTinyMce:d.getIsTinyMce()}}})},showLoadingScreen:function(c){c.empty();var b=i.JiraRoadmapMacro.roadmapLoading();h(b).appendTo(c)},renderPreview:function(c,b,a,l,f,g){d.makeGetRequest(b+"/rest/greenhopper/1.0/roadmap/fragment/configuration/?projectKey="+a+"&fragmentHost="+(window.location.protocol+"//"+window.location.hostname)+(l?"&boardId="+l:""),function(e){f.empty();if(e&&e.data&&e.data.hasActiveJiraSoftwareLicense)if(e.data.isValidRoadmap&&e.data.isRoadmapEnabled&&!e.data.isCrossProject){var k=
l||e.data.boardId,m=d.convertParamsToFragmentUrl(b,a,k),k=d.convertParamsToRoadmapUrl(b,a,k,e.data.isClassic),m=i.JiraRoadmapMacro.roadmapIframe({iframeSrc:m+"&hideHeader="+!c,roadmapUrl:k});h(m).appendTo(f);f.find("#sunsetLink").on("click",function(a){a.preventDefault();j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"validated",actionSubject:"jiraRoadmapMacro",attributes:{sunsetLinkClicked:!0,isTinyMce:d.getIsTinyMce(),isEditPreview:!c}}});window.open(h(this).attr("href"),
"_blank")});g&&g({success:!0,boardId:e.data.boardId,isClassic:e.data.isClassic});j.push({type:"ATLASSIAN_CONFLUENCE_ANALYTICS_NEXT_TRACK",payload:{source:"macro",action:"validated",actionSubject:"jiraRoadmapMacro",attributes:{isTinyMce:d.getIsTinyMce(),isEditPreview:!c}}})}else e.data.isRoadmapEnabled?d.showGenericErrorScreen(b+"/projects/"+a+"/settings",f,"validation"):d.showGenericErrorScreen(b,f,"not-available"),g&&g({success:!1,boardId:e.data.boardId,isClassic:e.data.isClassic});else{if(e.error&&
null!==e.error.message)d.showCustomErrorScreen(b,f,e.error);else if(503===e.status)d.showGenericErrorScreen(b,f,"service-unavailable");else if(e.error&&e.error.errorMessages)switch(0<e.error.errorMessages.length?e.error.errorMessages[0]:""){case "You must have the browse project permission to view this project.":d.showGenericErrorScreen(b,f,"permission");break;default:d.showGenericErrorScreen(b,f,"not-available")}else d.showGenericErrorScreen(b,f,"not-available");g&&g({success:!1,boardId:null,isClassic:!1})}})}};
return d});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:jiraroadmap-preview', location = 'com/atlassian/confluence/plugins/macros/advanced/jiraroadmap/jiraroadmap-preview.js' */
define("confluence-advanced-macros/jiraroadmap-preview",["jquery","skate","confluence-advanced-macros/jiraroadmap-helper"],function(b,c,d){return{init:function(){(!window.__skate||!window.__skate.registry||!window.__skate.registry["jiraroadmap-preview"])&&c("jiraroadmap-preview",{type:c.types.CLASS,attached:function(e){var a=b(e).attr("data-src");if((a=d.convertRoadmapUrlToParams(a))&&a.tenant){var c=d.matchHostEnvironment(a.tenant);a.project&&c?d.renderPreview(!0,a.tenant,a.project,a.boardId,b("#roadmap-preview",
e)):c?d.showGenericErrorScreen(a.tenant,b("#roadmap-preview",e),"invalid-url"):d.showGenericErrorScreen(a.tenant,b("#roadmap-preview",e),"inconsistent-env")}}})}}});require("confluence/module-exporter").safeRequire("confluence-advanced-macros/jiraroadmap-preview",function(b){b.init()});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:portfolioforjiraplan-editor', location = 'com/atlassian/confluence/plugins/macros/advanced/portfolioforjiraplan/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

/**
 * @fileoverview Templates in namespace Confluence.Templates.JPOS.
 */

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.JPOS == 'undefined') { Confluence.Templates.JPOS = {}; }


Confluence.Templates.JPOS.jposMacroDialog = function(opt_data, opt_ignored) {
  return '<section class="jpos__macro-dialog aui-dialog2 aui-dialog2-xlarge aui-layer" role="dialog" aria-hidden="true" data-aui-remove-on-hide="true"><header class="jpos__macro-dialog-header aui-dialog2-header"><h2 class="aui-dialog2-header-main">' + soy.$$escapeHtml('Add a plan to your page') + '</h2></header><div class="jpos__macro-dialog-content aui-dialog2-content"><form action="" class="aui jpos__form"><p><div class="jpos__warning-box"><div class="jpos__warning-icon"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill-rule="evenodd"><path fill="currentcolor" d="M12.938 4.967c-.518-.978-1.36-.974-1.876 0L3.938 18.425c-.518.978-.045 1.771 1.057 1.771h14.01c1.102 0 1.573-.797 1.057-1.771z"></path><path fill="inherit" d="M12 15a1 1 0 0 1-1-1V9a1 1 0 0 1 2 0v5a1 1 0 0 1-1 1m0 3a1 1 0 0 1 0-2 1 1 0 0 1 0 2"></path></g></svg></div><div class="jpos__warning-text-box"><h3 class="jpos__warning-header"></h3><p class="jpos__warning-text"></p><a class="jpos__learn-more" href="https://support.atlassian.com/jira-software-cloud/docs/embed-your-advanced-roadmap-plan-in-a-confluence-page/" target="_blank" rel="noopener noreferrer">' + soy.$$escapeHtml('See how to embed your plan in a Confluence page') + '</a></div></div><div class="jpos__intro">' + soy.$$escapeHtml('Insert plans that you\x27ve created in Jira into your page.') + '<a class="jpos__learn-more" href="https://www.atlassian.com/software/jira/features/roadmaps?tab=advanced" target="_blank" rel="noopener noreferrer">' + soy.$$escapeHtml('Learn more about Jira Premium\x27s advanced planning capabilities.') + '</a></div></p><div class="jpos__form-fields"><div class="jpos__field-group jpos__field-group--url"><label for="url" class="jpos__field-label">' + soy.$$escapeHtml('URL') + '</label><div class="jpos__field-group jpos__field-group--flex"><input id="url" type="text" class="jpos__url-input text" /><button tabindex="0" class="jpos__preview-btn aui-button aui-button-primary">' + soy.$$escapeHtml('Preview') + '</button></div><div class="jpos__field-label jpos__field-label--inline">' + soy.$$escapeHtml('On your plan, select Share as \x3e Confluence, then paste that link here.') + '<a class="jpos__learn-more" href="https://support.atlassian.com/jira-software-cloud/docs/share-and-export-your-advanced-roadmaps-plan/" target="_blank" rel="noopener noreferrer">' + soy.$$escapeHtml('Learn other ways to share your plans.') + '</a></div><div class="jpos__field-error jpos__field-error--url"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('It looks like you\x27ve entered an invalid URL. Check the Confluence sharing link in Jira plans, then try again') + '</div></div><div class="jpos__field-group jpos__field-group--height"><label for="height" class="jpos__field-label">' + soy.$$escapeHtml('Height') + '</label><div class="jpos__field-group jpos__field-group--flex"><div class="aui-buttons"><button tabindex="0" class="jpos__button-base aui-button" title="small"><div class="jpos__size-button" data-value="700"></div></button><button tabindex="0" class="jpos__button-base aui-button" title="medium"><div class="jpos__size-button jpos__size-button--medium" data-value="900"></div></button><button tabindex="0" class="jpos__button-base aui-button" title="large"><div class="jpos__size-button jpos__size-button--large" data-value="1100"></div></button></div><input id="height" type="number" step="10" min="300" class="jpos__height-input text" /><span class="jpos__height-unit">px</span></div><div class="jpos__field-label">' + soy.$$escapeHtml('Choose the height to display on your page') + '</div><div class="jpos__field-error jpos__field-error--height">' + soy.$$escapeHtml('Height must be at least 300px') + '</div></div></div></form><div tabindex="-1" class="jpos__preview-container"></div></div><footer class="jpos__macro-dialog-footer aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><form class="aui"><button tabindex="0" class="jpos__close-dialog aui-button aui-button-link">' + soy.$$escapeHtml('Cancel') + '</button><button tabindex="0" class="jpos__insert-macro aui-button aui-button-primary">' + soy.$$escapeHtml('Insert') + '</button></form></div></footer></section>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroDialog.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroDialog';
}


Confluence.Templates.JPOS.jposMacroIframe = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-container"><iframe class="jpos__iframe" frameborder="none" src="' + soy.$$escapeHtml(opt_data.url) + '" width="100%" height="' + soy.$$escapeHtml(opt_data.height) + '"></iframe></div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposMacroIframe.soyTemplateName = 'Confluence.Templates.JPOS.jposMacroIframe';
}


Confluence.Templates.JPOS.jposIframeTimeout = function(opt_data, opt_ignored) {
  return '<div class="jpos__iframe-load-timeout"><span class="aui-icon aui-icon-small aui-iconfont-error"></span>' + soy.$$escapeHtml('Your preview couldn\x27t be rendered. Please check the url and try again') + '</div>';
};
if (goog.DEBUG) {
  Confluence.Templates.JPOS.jposIframeTimeout.soyTemplateName = 'Confluence.Templates.JPOS.jposIframeTimeout';
}

}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:portfolioforjiraplan-editor', location = 'com/atlassian/confluence/plugins/macros/advanced/portfolioforjiraplan/editor.js' */
define("confluence-advanced-macros/portfolioforjiraplan-editor","jquery ajs confluence/api/constants aui/dialog2 confluence/meta confluence/templates confluence/macro-js-overrides confluence-macro-browser/macro-browser-facade".split(" "),function(f,e,k,l,m,g,n,o){return{_validateUrl:function(a){return a.match(RegExp(/^https?:\/\/.+\/secure\/PortfolioRoadmapConfluence\.jspa\?r=[a-zA-Z0-9]{0,30}$/))},_validateHeight:function(a){return a.length>0&&parseInt(a,10)>=300},_renderPreview:function(){var a=
this,c=a.previewContainer.offsetHeight,d=k.CONTEXT_PATH+"/rest/tinymce/1/macro/preview",c={contentId:m.get("page-id"),macro:{name:a.macro.name,params:{url:a.urlInput.value,planHeight:c}}};a._disablePreviewBtn.call(a,"Loading...");a._clearPreview.call(a);f.ajax({url:d,type:"POST",contentType:"application/json",data:JSON.stringify(c)}).done(function(b){a.previewContainer.innerHTML=g.JPOS.jposMacroIframe({height:a.heightInput.value});var c=document.querySelector(".jpos__iframe"),d=c.contentWindow.document;
if(c){a.iframeLoadTimeout=setTimeout(a._iframeLoadTimeout.bind(a),2E4);c.addEventListener("load",function(){clearTimeout(a.iframeLoadTimeout);a._enablePreviewBtn.call(a);d.querySelector("#main").setAttribute("style","padding: 0px; overflow: hidden");d.querySelector("body").style.overflow="hidden"})}b=b.replace("window.onload","var preventPreviewOnloadFnTrigger");b=b.replace("2px solid #efefef","none");d.open();d.write(b);d.close()})},_iframeLoadTimeout:function(){this.previewContainer.innerHTML=g.JPOS.jposIframeTimeout();
this._enablePreviewBtn.call(this)},_clearPreview:function(){this.previewContainer.innerHTML="";clearTimeout(this.iframeLoadTimeout)},_enablePreviewBtn:function(){this.previewBtn.innerHTML="Preview";this.previewBtn.removeAttribute("disabled")},_disablePreviewBtn:function(a){this.previewBtn.innerHTML=e.I18n.getText(a);this.previewBtn.setAttribute("disabled",true)},_addListeners:function(){function a(a){b.heightInput.value=a.target.dataset.value;i.style.display="none";b._validateUrl(b.urlInput.value)&&
b.insertBtn.removeAttribute("disabled")}function c(a,b){var c;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){a.apply(d,e)},b)}}function d(){b.urlInput.value=b.urlInput.value.replace(/(%20|\s)/g,"")}for(var b=this,e=document.querySelectorAll(".jpos__size-button"),h=document.querySelector(".jpos__close-dialog"),g=document.querySelector(".jpos__field-error--url"),i=document.querySelector(".jpos__field-error--height"),j=0;j<e.length;j++)e[j].addEventListener("click",
a);f(b.dialogContainer).find("form").submit(function(a){a.preventDefault()});b.previewBtn.addEventListener("click",function(){d();b._renderPreview()});h.addEventListener("click",function(){b.dialog.hide()});b.insertBtn.addEventListener("click",function(){d();o.insert({name:b.macro.name,params:{url:b.urlInput.value,planHeight:b.heightInput.value}});b.dialog.hide()});b.urlInput.addEventListener("keydown",function(a){a.key===" "&&a.preventDefault()});b.urlInput.addEventListener("input",c(function(){d();
b._clearPreview();if(!b._validateUrl(this.value)){g.style.display="block";b._disablePreviewBtn.call(b,"Preview");b.insertBtn.setAttribute("disabled",true);return false}g.style.display="none";b.disableNewMacros||b._enablePreviewBtn.call(b);b._validateHeight(b.heightInput.value)&&!b.disableNewMacros&&b.insertBtn.removeAttribute("disabled")},500));b.heightInput.addEventListener("input",c(function(a){if(!b._validateHeight(a.target.value)){i.style.display="block";b.insertBtn.setAttribute("disabled",true);
return false}i.style.display="none";b._validateUrl(b.urlInput.value)&&!b.disableNewMacros&&b.insertBtn.removeAttribute("disabled")},500))},init:function(){var a=this;n.put("portfolioforjiraplan",{opener:function(c){a.disableNewMacros=e.DarkFeatures.isEnabled("jira_premium_plans_macro_prevent_new_macros");var d=document.createElement("div");d.innerHTML=g.JPOS.jposMacroDialog();document.body.appendChild(d.firstChild);a.macro=c;a.dialog=l(".jpos__macro-dialog");a.dialog.show();a.dialogContainer=document.querySelector(".jpos__macro-dialog");
a.urlInput=document.querySelector(".jpos__url-input");a.heightInput=document.querySelector(".jpos__height-input");a.insertBtn=document.querySelector(".jpos__insert-macro");a.previewBtn=document.querySelector(".jpos__preview-btn");a.previewContainer=document.querySelector(".jpos__preview-container");a._addListeners();if(a.disableNewMacros){var d=document.querySelector(".jpos__warning-box"),b=document.querySelector(".jpos__intro"),f=document.querySelector(".jpos__warning-text"),h=document.querySelector(".jpos__warning-header");
d.style.display="flex";b.style.display="none";a.insertBtn.setAttribute("disabled","true");if(c.params){f.innerHTML="Embedding a plan in Confluence is now done using links. You can still view plans on pages that use this macro, but they can no longer be updated.\u003cbr/\u003eTo change or update how this plan is embedded, use \u003cb\u003eOpen in Plans\u003c/b\u003e below to get the most up-to-date link, paste it into body section of this page, then select \u003cb\u003eEmbed\u003c/b\u003e from the view options.";h.innerHTML="You can no longer edit this macro"}else{f.innerHTML="To embed it on this page, paste your plan\'s link into the body section and select \u003cb\u003eEmbed\u003c/b\u003e from the view options. You can still view plans on pages that use this macro, but they can no longer be updated.";h.innerHTML="You don\'t need this macro to embed a plan anymore";a.previewBtn.setAttribute("disabled",
"true")}a.urlInput.setAttribute("disabled","true");a.heightInput.setAttribute("disabled","true")}if(c.params){a.urlInput.value=c.params.url;a.heightInput.value=c.params.planHeight||"700";a.previewBtn.focus()}else{a.heightInput.value="700";a._disablePreviewBtn.call(a,"Preview");a.insertBtn.setAttribute("disabled",true);a.disableNewMacros||a.urlInput.focus()}}})}}});require("confluence/module-exporter").safeRequire("confluence-advanced-macros/portfolioforjiraplan-editor",function(f){require("ajs").toInit(function(){f.init()})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:excerpt-include-macro-browser-resources', location = 'com/atlassian/confluence/plugins/macros/advanced/js/excerpt-include-macro-fields.js' */
AJS.toInit(function(d){function i(a,c){var b=d("<option disabled selected hidden></option>").text(c);a.append(b)}function n(a,c,b,f,e){c||(a.empty(),i(a,"Select excerpt by name"),a.prop("disabled",!0));i(a,"Searching page for excerpts...");a.prop("disabled",!0);d("#macro-param-div-name").spin("small");var j=AJS.Meta.get("space-key"),g=c.split(":");1<g.length&&(j=g[0],c=g.slice(1).join(":"));o=
c;AJS.safeAjax({url:AJS.contextPath()+"/rest/api/content?expand=body.atlas_doc_format&limit=1&title="+encodeURIComponent(c)+"&spaceKey="+encodeURIComponent(j),type:"GET",data:{},success:function(j){if(o===c){var h=[],g=null;_.each(j.results,function(a){g=a.id;var a=JSON.parse(a.body.atlas_doc_format.value),b=function(a){a.type==="bodiedExtension"&&a.attrs.extensionKey==="excerpt"&&(a.attrs.parameters.macroParams.name?h.push(a.attrs.parameters.macroParams.name.value):h.push(""));a.content&&_.each(a.content,
b)};b(a)});h.sort(function(a,b){return b===""?-1:a===""?1:a.localeCompare(b)});a.empty();a.prop("disabled",false);if(h.length===0){i(a,"No excerpts found");a.prop("disabled",true)}d("#macro-param-div-name").spinStop();var k=false,l=false,m={};_.each(h,function(b){var c,e=!!m[b];if(e){c="<option disabled></option>";b===""?k=true:l=true}else{c="<option></option>";m[b]=true}var f=b===""?"Untitled excerpt":
b;c=d(c).text(f);e||c.val(b);a.append(c)});b!==void 0&&m[b]&&a.val(b);d(e).find(".link").attr("href","/wiki/pages/resumedraft.action?draftId="+g);l&&k?d(e).find(".title").text("You have untitled/duplicate excerpts"):l?d(e).find(".title").text("You have duplicate excerpt names"):k&&d(e).find(".title").text("You have multiple untitled excerpts");l||k?d(e).removeClass("hidden"):
d(e).addClass("hidden");f&&b&&f()}}})}var o=null;AJS.MacroBrowser.setMacroJsOverride("excerpt-include",{fields:{"confluence-content":{"":function(a,c){c=c||{};c.truncateTitle=!1;var b=AJS.MacroBrowser.ParameterFields["confluence-content"](a,c),f=b.input.val(),e=function(){var a=b.input.val();if(a!==f&&AJS.MacroBrowser.fields.name)try{n(AJS.MacroBrowser.fields.name.input,a,void 0,function(){AJS.MacroBrowser.paramChanged();AJS.MacroBrowser.previewMacro(AJS.MacroBrowser.dialog.activeMetadata)},d(AJS.MacroBrowser.fields.name.paramDiv).find(".error-field"))}catch(c){}f=
a};b.input.bind("selected.autocomplete-content",e);b.input.blur(e);b.input.attr("placeholder"," ");b.input.after(d("<div class='macro-param-page-placeholder'></div>").append('<span class="aui-icon aui-icon-small aui-iconfont-search" role="img" /> ').append("Search and select page with excerpt"));return b}},string:{name:function(a,c){var b=AJS.MacroBrowser.ParameterFields["enum"](a,c),f=d(['<div class="error-field hidden"><div style="display: flex; background: var(--ds-background-warning, #FFF7D6); padding: 8px; border: 1px solid var(--ds-border-warning, #E2B203); border-radius: 4px; margin-top: 8px;"><div style="margin-right: 8px; font-family: emoji">\u26a0\ufe0f</div><div><p class="title" style="font-weight: var(--ds-font-weight-bold, bold);"></p>',
"<p>"+"To select the excerpt you want, give it a unique name on the source page."+"</p>",'<p><a class="link" href="#">'+"Go to source page"+"</a></p>","</div></div></div>"].join(""));b.paramDiv.append(f);b.input.empty();i(b.input,"Select excerpt by name");b.input.prop("disabled",!0);return b}}},beforeParamsSet:function(a){var c=d("label[for='macro-param-name']"),b=d("<span />").addClass("require-asterisk").text("*");
c.append(b);c=d("#macro-param-name");if(!a[""])return a;try{n(c,a[""],a.name||"",function(){AJS.MacroBrowser.paramChanged();AJS.MacroBrowser.previewMacro(AJS.MacroBrowser.dialog.activeMetadata)},d("#macro-param-div-name .error-field"))}catch(f){}return a},beforeDialogShow:function(a){AJS.MacroBrowser.UI.updateButtonText("");AJS.MacroBrowser.dialog.gotoPage(1).addHeader(a)}})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.macros.advanced:contentbylabel-macro-browser-resources', location = 'com/atlassian/confluence/plugins/macros/advanced/contentbylabel/contentbylabel-fields.js' */
AJS.toInit(function(){var e={displayName:"Display full list",description:"",pluginKey:"confluence.macros.advanced",type:{name:"boolean"},macroName:"contentbylabel",name:"maxCheckbox",options:{}},f="cql title sort excerptType maxCheckbox max showLabels showSpace reverse".split(" ");AJS.MacroBrowser.setMacroJsOverride("contentbylabel",{parameters:function(a){a[2].hidden="true";a.push(e);var b=[];f.forEach(function(c){b.push(a.find(function(a){return a.name===
c}))});return b},fields:{"enum":{excerptType:function(a,b){a.displayName="Display preview";a.description="";a.enumValues=[{value:"none",label:"None"},{value:"rich content",label:"Page preview"},{value:"simple",label:"Excerpt preview"}];var c=b?b:{};c.auiSelect={minimumResultsForSearch:-1};
c.setValue=function(a){AJS.MacroBrowser.fields.excerptType.input.val(a).trigger("change")};return AJS.MacroBrowser.ParameterFields["enum"](a,c)},sort:function(a,b){a.displayName="Sort order";a.enumValues=[{label:"Title",items:[{value:"title",label:"A &#8594; Z"},{value:"title.true",label:"Z &#8594; A"}]},
{label:"Created",items:[{value:"creation.true",label:"Newest &#8594; Oldest"},{value:"creation",label:"Oldest &#8594; Newest"}]},{label:"Modified",items:[{value:"modified.true",label:"Recent &#8594; Old"},{value:"modified",label:"Old &#8594; Recent"}]}];
var c={placeholder:"Select",minimumResultsForSearch:-1},d=b?b:{};d.auiSelect=c;d.setValue=function(a){AJS.MacroBrowser.fields.sort.input.val(a).trigger("change")};return AJS.MacroBrowser.ParameterFields["enum"](a,d)}},string:{title:function(a,b){a.displayName="List title";var c=AJS.MacroBrowser.ParameterFields.string(a,b);c.input.attr("placeholder","Give this list a title (optional)");return c}},"int":{max:function(a,
b){a.displayName="Max number in list";return AJS.MacroBrowser.ParameterFields.string(a,b)}},"boolean":{maxCheckbox:function(a,b){var c=AJS.MacroBrowser.ParameterFields["boolean"](a,b);c.input.on("change",function(){var a=!!c.input.prop("checked");AJS.MacroBrowser.fields.max.paramDiv.toggleClass("hidden",a);AJS.MacroBrowser.fields.max.setValue(a?500:15)});return c},showLabels:function(a,b){a.displayName="Display labels";
return AJS.MacroBrowser.ParameterFields["boolean"](a,b)},showSpace:function(a,b){a.displayName="Display space name";return AJS.MacroBrowser.ParameterFields["boolean"](a,b)}}},beforeParamsSet:function(a){"true"===a.maxCheckbox&&AJS.MacroBrowser.fields.max.paramDiv.addClass("hidden");var b="";a.sort&&(b=a.sort);"true"===a.reverse&&(b+=".true");a.sort=b;return a},beforeDialogShow:function(){AJS.MacroBrowser.UI.updateButtonText("");AJS.MacroBrowser.dialog.gotoPage(1).addHeader("Filter by label")},
beforeParamsRetrieved:function(a){if(a.sort){var b=a.sort.split(".");a.sort=b[0];a.reverse=2===b.length}return a},hideHelpLink:!0,showDescriptionHelp:!0})});
}catch(e){WRMCB(e)};
;
try {
/* module-key = 'confluence.extra.masterdetail:details-summary-resources', location = 'com/atlassian/confluence/extra/masterdetail/js/detailssummary-fields.js' */
AJS.toInit(function(e){function a(){return AJS.DarkFeatures.isEnabled("confluence_live_pages_open_beta_trait_opted_in")}var g={fields:{string:{id:function c(i,h){if(a()){i.displayName="Content properties ID (optional)";i.description="If you have multiple content properties macros on a page or live doc and want to report on a specific one, enter the ID of that macro. Leave blank to include all macros."}return AJS.MacroBrowser.ParameterFields.string(i,h)},firstcolumn:function b(i,h){if(a()){i.description="Change the heading of the Title column which contains links to content (max 35 characters)."}return AJS.MacroBrowser.ParameterFields.string(i,h)},headings:function d(i,h){if(a()){i.description="Comma separated list of columns to include in the table. Title is always shown."}return AJS.MacroBrowser.ParameterFields.string(i,h)}}},beforeDialogShow:function f(h){AJS.MacroBrowser.dialog.gotoPage(1).addHeader(h)}};AJS.MacroBrowser.setMacroJsOverride("detailssummary",g)});
}catch(e){WRMCB(e)};